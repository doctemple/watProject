function ucfirst(str){return(str+="").charAt(0).toUpperCase()+str.substr(1)}!function(root,factory){"function"==typeof define&&define.amd?define(factory):"object"==typeof exports&&"string"!=typeof exports.nodeName?module.exports=factory():root.Croppie=factory()}("undefined"!=typeof self?self:this,function(){function b(a,b){return function(){a.apply(b,arguments)}}function c(a){if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");if("function"!=typeof a)throw new TypeError("not a function");this._state=null,this._value=null,this._deferreds=[],i(a,b(e,this),b(f,this))}function d(a){var b=this;return null===this._state?void this._deferreds.push(a):void k(function(){var c=b._state?a.onFulfilled:a.onRejected;if(null!==c){var d;try{d=c(b._value)}catch(e){return void a.reject(e)}a.resolve(d)}else(b._state?a.resolve:a.reject)(b._value)})}function e(a){try{if(a===this)throw new TypeError("A promise cannot be resolved with itself.");if(a&&("object"==typeof a||"function"==typeof a)){var c=a.then;if("function"==typeof c)return void i(b(c,a),b(e,this),b(f,this))}this._state=!0,this._value=a,g.call(this)}catch(d){f.call(this,d)}}function f(a){this._state=!1,this._value=a,g.call(this)}function g(){for(var a=0,b=this._deferreds.length;a<b;a++)d.call(this,this._deferreds[a]);this._deferreds=null}function h(a,b,c,d){this.onFulfilled="function"==typeof a?a:null,this.onRejected="function"==typeof b?b:null,this.resolve=c,this.reject=d}function i(a,b,c){var d=!1;try{a(function(a){d||(d=!0,b(a))},function(a){d||(d=!0,c(a))})}catch(e){if(d)return;d=!0,c(e)}}var a,j,k,l;"function"!=typeof Promise&&(a=this,j=setTimeout,k="function"==typeof setImmediate&&setImmediate||function(a){j(a,1)},l=Array.isArray||function(a){return"[object Array]"===Object.prototype.toString.call(a)},c.prototype.catch=function(a){return this.then(null,a)},c.prototype.then=function(a,b){var e=this;return new c(function(c,f){d.call(e,new h(a,b,c,f))})},c.all=function(){var a=Array.prototype.slice.call(1===arguments.length&&l(arguments[0])?arguments[0]:arguments);return new c(function(b,c){function d(f,g){try{if(g&&("object"==typeof g||"function"==typeof g)){var h=g.then;if("function"==typeof h)return void h.call(g,function(a){d(f,a)},c)}a[f]=g,0==--e&&b(a)}catch(i){c(i)}}if(0===a.length)return b([]);for(var e=a.length,f=0;f<a.length;f++)d(f,a[f])})},c.resolve=function(a){return a&&"object"==typeof a&&a.constructor===c?a:new c(function(b){b(a)})},c.reject=function(a){return new c(function(b,c){c(a)})},c.race=function(a){return new c(function(b,c){for(var d=0,e=a.length;d<e;d++)a[d].then(b,c)})},c._setImmediateFn=function(a){k=a},"undefined"!=typeof module&&module.exports?module.exports=c:a.Promise||(a.Promise=c)),"function"!=typeof window.CustomEvent&&function(){function CustomEvent(event,params){params=params||{bubbles:!1,cancelable:!1,detail:void 0};var evt=document.createEvent("CustomEvent");return evt.initCustomEvent(event,params.bubbles,params.cancelable,params.detail),evt}CustomEvent.prototype=window.Event.prototype,window.CustomEvent=CustomEvent}(),HTMLCanvasElement.prototype.toBlob||Object.defineProperty(HTMLCanvasElement.prototype,"toBlob",{value:function(callback,type,quality){for(var binStr=atob(this.toDataURL(type,quality).split(",")[1]),len=binStr.length,arr=new Uint8Array(len),i=0;i<len;i++)arr[i]=binStr.charCodeAt(i);callback(new Blob([arr],{type:type||"image/png"}))}});var CSS_TRANS_ORG,CSS_TRANSFORM,CSS_USERSELECT,cssPrefixes=["Webkit","Moz","ms"],emptyStyles=document.createElement("div").style,EXIF_NORM=[1,8,3,6],EXIF_FLIP=[2,7,4,5];function vendorPrefix(prop){if(prop in emptyStyles)return prop;for(var capProp=prop[0].toUpperCase()+prop.slice(1),i=cssPrefixes.length;i--;)if((prop=cssPrefixes[i]+capProp)in emptyStyles)return prop}function deepExtend(destination,source){for(var property in destination=destination||{},source)source[property]&&source[property].constructor&&source[property].constructor===Object?(destination[property]=destination[property]||{},deepExtend(destination[property],source[property])):destination[property]=source[property];return destination}function clone(object){return deepExtend({},object)}function dispatchChange(element){if("createEvent"in document){var evt=document.createEvent("HTMLEvents");evt.initEvent("change",!1,!0),element.dispatchEvent(evt)}else element.fireEvent("onchange")}function css(el,styles,val){if("string"==typeof styles){var tmp=styles;(styles={})[tmp]=val}for(var prop in styles)el.style[prop]=styles[prop]}function addClass(el,c){el.classList?el.classList.add(c):el.className+=" "+c}function setAttributes(el,attrs){for(var key in attrs)el.setAttribute(key,attrs[key])}function num(v){return parseInt(v,10)}function naturalImageDimensions(img,ornt){var w=img.naturalWidth,h=img.naturalHeight,orient=ornt||getExifOrientation(img);if(orient&&5<=orient){var x=w;w=h,h=x}return{width:w,height:h}}CSS_TRANSFORM=vendorPrefix("transform"),CSS_TRANS_ORG=vendorPrefix("transformOrigin"),CSS_USERSELECT=vendorPrefix("userSelect");var TRANSLATE_OPTS={translate3d:{suffix:", 0px"},translate:{suffix:""}},Transform=function(x,y,scale){this.x=parseFloat(x),this.y=parseFloat(y),this.scale=parseFloat(scale)};Transform.parse=function(v){return v.style?Transform.parse(v.style[CSS_TRANSFORM]):-1<v.indexOf("matrix")||-1<v.indexOf("none")?Transform.fromMatrix(v):Transform.fromString(v)},Transform.fromMatrix=function(v){var vals=v.substring(7).split(",");return vals.length&&"none"!==v||(vals=[1,0,0,1,0,0]),new Transform(num(vals[4]),num(vals[5]),parseFloat(vals[0]))},Transform.fromString=function(v){var values=v.split(") "),translate=values[0].substring(Croppie.globals.translate.length+1).split(","),scale=1<values.length?values[1].substring(6):1,x=1<translate.length?translate[0]:0,y=1<translate.length?translate[1]:0;return new Transform(x,y,scale)},Transform.prototype.toString=function(){var suffix=TRANSLATE_OPTS[Croppie.globals.translate].suffix||"";return Croppie.globals.translate+"("+this.x+"px, "+this.y+"px"+suffix+") scale("+this.scale+")"};var TransformOrigin=function(el){if(!el||!el.style[CSS_TRANS_ORG])return this.x=0,void(this.y=0);var css=el.style[CSS_TRANS_ORG].split(" ");this.x=parseFloat(css[0]),this.y=parseFloat(css[1])};function getExifOrientation(img){return img.exifdata&&img.exifdata.Orientation?num(img.exifdata.Orientation):1}function drawCanvas(canvas,img,orientation){var width=img.width,height=img.height,ctx=canvas.getContext("2d");switch(canvas.width=img.width,canvas.height=img.height,ctx.save(),orientation){case 2:ctx.translate(width,0),ctx.scale(-1,1);break;case 3:ctx.translate(width,height),ctx.rotate(180*Math.PI/180);break;case 4:ctx.translate(0,height),ctx.scale(1,-1);break;case 5:canvas.width=height,canvas.height=width,ctx.rotate(90*Math.PI/180),ctx.scale(1,-1);break;case 6:canvas.width=height,canvas.height=width,ctx.rotate(90*Math.PI/180),ctx.translate(0,-height);break;case 7:canvas.width=height,canvas.height=width,ctx.rotate(-90*Math.PI/180),ctx.translate(-width,height),ctx.scale(1,-1);break;case 8:canvas.width=height,canvas.height=width,ctx.translate(0,width),ctx.rotate(-90*Math.PI/180)}ctx.drawImage(img,0,0,width,height),ctx.restore()}function _create(){var boundary,img,viewport,overlay,bw,bh,customViewportClass=this.options.viewport.type?"cr-vp-"+this.options.viewport.type:null;this.options.useCanvas=this.options.enableOrientation||_hasExif.call(this),this.data={},this.elements={},boundary=this.elements.boundary=document.createElement("div"),viewport=this.elements.viewport=document.createElement("div"),img=this.elements.img=document.createElement("img"),overlay=this.elements.overlay=document.createElement("div"),this.options.useCanvas?(this.elements.canvas=document.createElement("canvas"),this.elements.preview=this.elements.canvas):this.elements.preview=img,addClass(boundary,"cr-boundary"),boundary.setAttribute("aria-dropeffect","none"),bw=this.options.boundary.width,bh=this.options.boundary.height,css(boundary,{width:bw+(isNaN(bw)?"":"px"),height:bh+(isNaN(bh)?"":"px")}),addClass(viewport,"cr-viewport"),customViewportClass&&addClass(viewport,customViewportClass),css(viewport,{width:this.options.viewport.width+"px",height:this.options.viewport.height+"px"}),viewport.setAttribute("tabindex",0),addClass(this.elements.preview,"cr-image"),setAttributes(this.elements.preview,{alt:"preview","aria-grabbed":"false"}),addClass(overlay,"cr-overlay"),this.element.appendChild(boundary),boundary.appendChild(this.elements.preview),boundary.appendChild(viewport),boundary.appendChild(overlay),addClass(this.element,"croppie-container"),this.options.customClass&&addClass(this.element,this.options.customClass),function(){var originalX,originalY,originalDistance,vpRect,transform,self=this,isDragging=!1;function assignTransformCoordinates(deltaX,deltaY){var imgRect=self.elements.preview.getBoundingClientRect(),top=transform.y+deltaY,left=transform.x+deltaX;self.options.enforceBoundary?(vpRect.top>imgRect.top+deltaY&&vpRect.bottom<imgRect.bottom+deltaY&&(transform.y=top),vpRect.left>imgRect.left+deltaX&&vpRect.right<imgRect.right+deltaX&&(transform.x=left)):(transform.y=top,transform.x=left)}function toggleGrabState(isDragging){self.elements.preview.setAttribute("aria-grabbed",isDragging),self.elements.boundary.setAttribute("aria-dropeffect",isDragging?"move":"none")}function mouseDown(ev){if((void 0===ev.button||0===ev.button)&&(ev.preventDefault(),!isDragging)){if(isDragging=!0,originalX=ev.pageX,originalY=ev.pageY,ev.touches){var touches=ev.touches[0];originalX=touches.pageX,originalY=touches.pageY}toggleGrabState(isDragging),transform=Transform.parse(self.elements.preview),window.addEventListener("mousemove",mouseMove),window.addEventListener("touchmove",mouseMove),window.addEventListener("mouseup",mouseUp),window.addEventListener("touchend",mouseUp),document.body.style[CSS_USERSELECT]="none",vpRect=self.elements.viewport.getBoundingClientRect()}}function mouseMove(ev){ev.preventDefault();var pageX=ev.pageX,pageY=ev.pageY;if(ev.touches){var touches=ev.touches[0];pageX=touches.pageX,pageY=touches.pageY}var deltaX=pageX-originalX,deltaY=pageY-originalY,newCss={};if("touchmove"===ev.type&&1<ev.touches.length){var touch1=ev.touches[0],touch2=ev.touches[1],dist=Math.sqrt((touch1.pageX-touch2.pageX)*(touch1.pageX-touch2.pageX)+(touch1.pageY-touch2.pageY)*(touch1.pageY-touch2.pageY));return originalDistance=originalDistance||dist/self._currentZoom,_setZoomerVal.call(self,dist/originalDistance),void dispatchChange(self.elements.zoomer)}assignTransformCoordinates(deltaX,deltaY),newCss[CSS_TRANSFORM]=transform.toString(),css(self.elements.preview,newCss),_updateOverlay.call(self),originalY=pageY,originalX=pageX}function mouseUp(){toggleGrabState(isDragging=!1),window.removeEventListener("mousemove",mouseMove),window.removeEventListener("touchmove",mouseMove),window.removeEventListener("mouseup",mouseUp),window.removeEventListener("touchend",mouseUp),document.body.style[CSS_USERSELECT]="",_updateCenterPoint.call(self),_triggerUpdate.call(self),originalDistance=0}self.elements.overlay.addEventListener("mousedown",mouseDown),self.elements.viewport.addEventListener("keydown",function(ev){var zoom;if(!ev.shiftKey||38!==ev.keyCode&&40!==ev.keyCode){if(self.options.enableKeyMovement&&37<=ev.keyCode&&ev.keyCode<=40){ev.preventDefault();var movement=function(key){switch(key){case 37:return[1,0];case 38:return[0,1];case 39:return[-1,0];case 40:return[0,-1]}}(ev.keyCode);transform=Transform.parse(self.elements.preview),document.body.style[CSS_USERSELECT]="none",vpRect=self.elements.viewport.getBoundingClientRect(),function(movement){var deltaX=movement[0],deltaY=movement[1],newCss={};assignTransformCoordinates(deltaX,deltaY),newCss[CSS_TRANSFORM]=transform.toString(),css(self.elements.preview,newCss),_updateOverlay.call(self),document.body.style[CSS_USERSELECT]="",_updateCenterPoint.call(self),_triggerUpdate.call(self),originalDistance=0}(movement)}}else zoom=38===ev.keyCode?parseFloat(self.elements.zoomer.value)+parseFloat(self.elements.zoomer.step):parseFloat(self.elements.zoomer.value)-parseFloat(self.elements.zoomer.step),self.setZoom(zoom)}),self.elements.overlay.addEventListener("touchstart",mouseDown)}.call(this),this.options.enableZoom&&function(){var self=this,wrap=self.elements.zoomerWrap=document.createElement("div"),zoomer=self.elements.zoomer=document.createElement("input");function change(){(function(ui){var self=this,transform=ui?ui.transform:Transform.parse(self.elements.preview),vpRect=ui?ui.viewportRect:self.elements.viewport.getBoundingClientRect(),origin=ui?ui.origin:new TransformOrigin(self.elements.preview);function applyCss(){var transCss={};transCss[CSS_TRANSFORM]=transform.toString(),transCss[CSS_TRANS_ORG]=origin.toString(),css(self.elements.preview,transCss)}if(self._currentZoom=ui?ui.value:self._currentZoom,transform.scale=self._currentZoom,self.elements.zoomer.setAttribute("aria-valuenow",self._currentZoom),applyCss(),self.options.enforceBoundary){var boundaries=function(viewport){var scale=this._currentZoom,vpWidth=viewport.width,vpHeight=viewport.height,centerFromBoundaryX=this.elements.boundary.clientWidth/2,centerFromBoundaryY=this.elements.boundary.clientHeight/2,imgRect=this.elements.preview.getBoundingClientRect(),curImgWidth=imgRect.width,curImgHeight=imgRect.height,halfWidth=vpWidth/2,halfHeight=vpHeight/2,maxX=-1*(halfWidth/scale-centerFromBoundaryX),maxY=-1*(halfHeight/scale-centerFromBoundaryY),originMinX=1/scale*halfWidth,originMinY=1/scale*halfHeight;return{translate:{maxX:maxX,minX:maxX-(curImgWidth*(1/scale)-vpWidth*(1/scale)),maxY:maxY,minY:maxY-(curImgHeight*(1/scale)-vpHeight*(1/scale))},origin:{maxX:curImgWidth*(1/scale)-originMinX,minX:originMinX,maxY:curImgHeight*(1/scale)-originMinY,minY:originMinY}}}.call(self,vpRect),transBoundaries=boundaries.translate,oBoundaries=boundaries.origin;transform.x>=transBoundaries.maxX&&(origin.x=oBoundaries.minX,transform.x=transBoundaries.maxX),transform.x<=transBoundaries.minX&&(origin.x=oBoundaries.maxX,transform.x=transBoundaries.minX),transform.y>=transBoundaries.maxY&&(origin.y=oBoundaries.minY,transform.y=transBoundaries.maxY),transform.y<=transBoundaries.minY&&(origin.y=oBoundaries.maxY,transform.y=transBoundaries.minY)}applyCss(),_debouncedOverlay.call(self),_triggerUpdate.call(self)}).call(self,{value:parseFloat(zoomer.value),origin:new TransformOrigin(self.elements.preview),viewportRect:self.elements.viewport.getBoundingClientRect(),transform:Transform.parse(self.elements.preview)})}function scroll(ev){var delta,targetZoom;if("ctrl"===self.options.mouseWheelZoom&&!0!==ev.ctrlKey)return 0;delta=ev.wheelDelta?ev.wheelDelta/1200:ev.deltaY?ev.deltaY/1060:ev.detail?ev.detail/-60:0,targetZoom=self._currentZoom+delta*self._currentZoom,ev.preventDefault(),_setZoomerVal.call(self,targetZoom),change.call(self)}addClass(wrap,"cr-slider-wrap"),addClass(zoomer,"cr-slider"),zoomer.type="range",zoomer.step="0.0001",zoomer.value="1",zoomer.style.display=self.options.showZoomer?"":"none",zoomer.setAttribute("aria-label","zoom"),self.element.appendChild(wrap),wrap.appendChild(zoomer),self._currentZoom=1,self.elements.zoomer.addEventListener("input",change),self.elements.zoomer.addEventListener("change",change),self.options.mouseWheelZoom&&(self.elements.boundary.addEventListener("mousewheel",scroll),self.elements.boundary.addEventListener("DOMMouseScroll",scroll))}.call(this),this.options.enableResize&&function(){var direction,originalX,originalY,maxWidth,maxHeight,vr,hr,self=this,wrap=document.createElement("div"),isDragging=!1,minSize=50;addClass(wrap,"cr-resizer"),css(wrap,{width:this.options.viewport.width+"px",height:this.options.viewport.height+"px"}),this.options.resizeControls.height&&(addClass(vr=document.createElement("div"),"cr-resizer-vertical"),wrap.appendChild(vr));this.options.resizeControls.width&&(addClass(hr=document.createElement("div"),"cr-resizer-horisontal"),wrap.appendChild(hr));function mouseDown(ev){if((void 0===ev.button||0===ev.button)&&(ev.preventDefault(),!isDragging)){var overlayRect=self.elements.overlay.getBoundingClientRect();if(isDragging=!0,originalX=ev.pageX,originalY=ev.pageY,direction=-1!==ev.currentTarget.className.indexOf("vertical")?"v":"h",maxWidth=overlayRect.width,maxHeight=overlayRect.height,ev.touches){var touches=ev.touches[0];originalX=touches.pageX,originalY=touches.pageY}window.addEventListener("mousemove",mouseMove),window.addEventListener("touchmove",mouseMove),window.addEventListener("mouseup",mouseUp),window.addEventListener("touchend",mouseUp),document.body.style[CSS_USERSELECT]="none"}}function mouseMove(ev){var pageX=ev.pageX,pageY=ev.pageY;if(ev.preventDefault(),ev.touches){var touches=ev.touches[0];pageX=touches.pageX,pageY=touches.pageY}var deltaX=pageX-originalX,deltaY=pageY-originalY,newHeight=self.options.viewport.height+deltaY,newWidth=self.options.viewport.width+deltaX;"v"===direction&&minSize<=newHeight&&newHeight<=maxHeight?(css(wrap,{height:newHeight+"px"}),self.options.boundary.height+=deltaY,css(self.elements.boundary,{height:self.options.boundary.height+"px"}),self.options.viewport.height+=deltaY,css(self.elements.viewport,{height:self.options.viewport.height+"px"})):"h"===direction&&minSize<=newWidth&&newWidth<=maxWidth&&(css(wrap,{width:newWidth+"px"}),self.options.boundary.width+=deltaX,css(self.elements.boundary,{width:self.options.boundary.width+"px"}),self.options.viewport.width+=deltaX,css(self.elements.viewport,{width:self.options.viewport.width+"px"})),_updateOverlay.call(self),_updateZoomLimits.call(self),_updateCenterPoint.call(self),_triggerUpdate.call(self),originalY=pageY,originalX=pageX}function mouseUp(){isDragging=!1,window.removeEventListener("mousemove",mouseMove),window.removeEventListener("touchmove",mouseMove),window.removeEventListener("mouseup",mouseUp),window.removeEventListener("touchend",mouseUp),document.body.style[CSS_USERSELECT]=""}vr&&(vr.addEventListener("mousedown",mouseDown),vr.addEventListener("touchstart",mouseDown));hr&&(hr.addEventListener("mousedown",mouseDown),hr.addEventListener("touchstart",mouseDown));this.elements.boundary.appendChild(wrap)}.call(this)}function _hasExif(){return this.options.enableExif&&window.EXIF}function _setZoomerVal(v){if(this.options.enableZoom){var z=this.elements.zoomer,val=fix(v,4);z.value=Math.max(parseFloat(z.min),Math.min(parseFloat(z.max),val)).toString()}}function _updateCenterPoint(rotate){var scale=this._currentZoom,data=this.elements.preview.getBoundingClientRect(),vpData=this.elements.viewport.getBoundingClientRect(),transform=Transform.parse(this.elements.preview.style[CSS_TRANSFORM]),pc=new TransformOrigin(this.elements.preview),top=vpData.top-data.top+vpData.height/2,left=vpData.left-data.left+vpData.width/2,center={},adj={};if(rotate){var cx=pc.x,cy=pc.y,tx=transform.x,ty=transform.y;center.y=cx,center.x=cy,transform.y=tx,transform.x=ty}else center.y=top/scale,center.x=left/scale,adj.y=(center.y-pc.y)*(1-scale),adj.x=(center.x-pc.x)*(1-scale),transform.x-=adj.x,transform.y-=adj.y;var newCss={};newCss[CSS_TRANS_ORG]=center.x+"px "+center.y+"px",newCss[CSS_TRANSFORM]=transform.toString(),css(this.elements.preview,newCss)}function _updateOverlay(){if(this.elements){var boundRect=this.elements.boundary.getBoundingClientRect(),imgData=this.elements.preview.getBoundingClientRect();css(this.elements.overlay,{width:imgData.width+"px",height:imgData.height+"px",top:imgData.top-boundRect.top+"px",left:imgData.left-boundRect.left+"px"})}}TransformOrigin.prototype.toString=function(){return this.x+"px "+this.y+"px"};var func,wait,immediate,timeout,_debouncedOverlay=(func=_updateOverlay,wait=500,function(){var context=this,args=arguments,callNow=immediate&&!timeout;clearTimeout(timeout),timeout=setTimeout(function(){timeout=null,immediate||func.apply(context,args)},wait),callNow&&func.apply(context,args)});function _triggerUpdate(){var ev,data=this.get();_isVisible.call(this)&&(this.options.update.call(this,data),this.$&&"undefined"==typeof Prototype?this.$(this.element).trigger("update.croppie",data):(window.CustomEvent?ev=new CustomEvent("update",{detail:data}):(ev=document.createEvent("CustomEvent")).initCustomEvent("update",!0,!0,data),this.element.dispatchEvent(ev)))}function _isVisible(){return 0<this.elements.preview.offsetHeight&&0<this.elements.preview.offsetWidth}function _updatePropertiesFromImage(){var imgData,cssReset={},img=this.elements.preview,transformReset=new Transform(0,0,1),originReset=new TransformOrigin;_isVisible.call(this)&&!this.data.bound&&(this.data.bound=!0,cssReset[CSS_TRANSFORM]=transformReset.toString(),cssReset[CSS_TRANS_ORG]=originReset.toString(),cssReset.opacity=1,css(img,cssReset),imgData=this.elements.preview.getBoundingClientRect(),this._originalImageWidth=imgData.width,this._originalImageHeight=imgData.height,this.data.orientation=getExifOrientation(this.elements.img),this.options.enableZoom?_updateZoomLimits.call(this,!0):this._currentZoom=1,transformReset.scale=this._currentZoom,cssReset[CSS_TRANSFORM]=transformReset.toString(),css(img,cssReset),this.data.points.length?function(points){if(4!==points.length)throw"Croppie - Invalid number of points supplied: "+points;var pointsWidth=points[2]-points[0],vpData=this.elements.viewport.getBoundingClientRect(),boundRect=this.elements.boundary.getBoundingClientRect(),vpOffset_left=vpData.left-boundRect.left,vpOffset_top=vpData.top-boundRect.top,scale=vpData.width/pointsWidth,originTop=points[1],originLeft=points[0],transformTop=-1*points[1]+vpOffset_top,transformLeft=-1*points[0]+vpOffset_left,newCss={};newCss[CSS_TRANS_ORG]=originLeft+"px "+originTop+"px",newCss[CSS_TRANSFORM]=new Transform(transformLeft,transformTop,scale).toString(),css(this.elements.preview,newCss),_setZoomerVal.call(this,scale),this._currentZoom=scale}.call(this,this.data.points):function(){var imgDim=this.elements.preview.getBoundingClientRect(),vpDim=this.elements.viewport.getBoundingClientRect(),boundDim=this.elements.boundary.getBoundingClientRect(),vpLeft=vpDim.left-boundDim.left,vpTop=vpDim.top-boundDim.top,w=vpLeft-(imgDim.width-vpDim.width)/2,h=vpTop-(imgDim.height-vpDim.height)/2,transform=new Transform(w,h,this._currentZoom);css(this.elements.preview,CSS_TRANSFORM,transform.toString())}.call(this),_updateCenterPoint.call(this),_updateOverlay.call(this))}function _updateZoomLimits(initial){var initialZoom,defaultInitialZoom,minW,minH,minZoom=Math.max(this.options.minZoom,0)||0,maxZoom=this.options.maxZoom||1.5,zoomer=this.elements.zoomer,scale=parseFloat(zoomer.value),boundaryData=this.elements.boundary.getBoundingClientRect(),imgData=naturalImageDimensions(this.elements.img,this.data.orientation),vpData=this.elements.viewport.getBoundingClientRect();this.options.enforceBoundary&&(minW=vpData.width/imgData.width,minH=vpData.height/imgData.height,minZoom=Math.max(minW,minH)),maxZoom<=minZoom&&(maxZoom=minZoom+1),zoomer.min=fix(minZoom,4),zoomer.max=fix(maxZoom,4),!initial&&(scale<zoomer.min||scale>zoomer.max)?_setZoomerVal.call(this,scale<zoomer.min?zoomer.min:zoomer.max):initial&&(defaultInitialZoom=Math.max(boundaryData.width/imgData.width,boundaryData.height/imgData.height),initialZoom=null!==this.data.boundZoom?this.data.boundZoom:defaultInitialZoom,_setZoomerVal.call(this,initialZoom)),dispatchChange(zoomer)}function _getCanvas(data){var points=data.points,left=num(points[0]),top=num(points[1]),width=num(points[2])-left,height=num(points[3])-top,circle=data.circle,canvas=document.createElement("canvas"),ctx=canvas.getContext("2d"),canvasWidth=data.outputWidth||width,canvasHeight=data.outputHeight||height;canvas.width=canvasWidth,canvas.height=canvasHeight,data.backgroundColor&&(ctx.fillStyle=data.backgroundColor,ctx.fillRect(0,0,canvasWidth,canvasHeight));var sx=left,sy=top,sWidth=width,sHeight=height,dx=0,dy=0,dWidth=canvasWidth,dHeight=canvasHeight;return left<0&&(sx=0,dx=Math.abs(left)/width*canvasWidth),sWidth+sx>this._originalImageWidth&&(dWidth=(sWidth=this._originalImageWidth-sx)/width*canvasWidth),top<0&&(sy=0,dy=Math.abs(top)/height*canvasHeight),sHeight+sy>this._originalImageHeight&&(dHeight=(sHeight=this._originalImageHeight-sy)/height*canvasHeight),ctx.drawImage(this.elements.preview,sx,sy,sWidth,sHeight,dx,dy,dWidth,dHeight),circle&&(ctx.fillStyle="#fff",ctx.globalCompositeOperation="destination-in",ctx.beginPath(),ctx.arc(canvas.width/2,canvas.height/2,canvas.width/2,0,2*Math.PI,!0),ctx.closePath(),ctx.fill()),canvas}function _bind(options,cb){var url,self=this,points=[],zoom=null,hasExif=_hasExif.call(self);if("string"==typeof options)url=options,options={};else if(Array.isArray(options))points=options.slice();else{if(void 0===options&&self.data.url)return _updatePropertiesFromImage.call(self),_triggerUpdate.call(self),null;url=options.url,points=options.points||[],zoom=void 0===options.zoom?null:options.zoom}return self.data.bound=!1,self.data.url=url||self.data.url,self.data.boundZoom=zoom,function(src,doExif){var img=new Image;return img.style.opacity="0",new Promise(function(resolve,reject){function _resolve(){img.style.opacity="1",setTimeout(function(){resolve(img)},1)}img.removeAttribute("crossOrigin"),src.match(/^https?:\/\/|^\/\//)&&img.setAttribute("crossOrigin","anonymous"),img.onload=function(){doExif?EXIF.getData(img,function(){_resolve()}):_resolve()},img.onerror=function(ev){img.style.opacity=1,setTimeout(function(){reject(ev)},1)},img.src=src})}(url,hasExif).then(function(img){if(function(img){this.elements.img.parentNode&&(Array.prototype.forEach.call(this.elements.img.classList,function(c){img.classList.add(c)}),this.elements.img.parentNode.replaceChild(img,this.elements.img),this.elements.preview=img),this.elements.img=img}.call(self,img),points.length)self.options.relative&&(points=[points[0]*img.naturalWidth/100,points[1]*img.naturalHeight/100,points[2]*img.naturalWidth/100,points[3]*img.naturalHeight/100]);else{var width,height,natDim=naturalImageDimensions(img),rect=self.elements.viewport.getBoundingClientRect(),aspectRatio=rect.width/rect.height;aspectRatio<natDim.width/natDim.height?width=(height=natDim.height)*aspectRatio:(width=natDim.width,height=natDim.height/aspectRatio);var x0=(natDim.width-width)/2,y0=(natDim.height-height)/2,x1=x0+width,y1=y0+height;self.data.points=[x0,y0,x1,y1]}self.data.points=points.map(function(p){return parseFloat(p)}),self.options.useCanvas&&function(customOrientation){var canvas=this.elements.canvas,img=this.elements.img;canvas.getContext("2d").clearRect(0,0,canvas.width,canvas.height),canvas.width=img.width,canvas.height=img.height,drawCanvas(canvas,img,this.options.enableOrientation&&customOrientation||getExifOrientation(img))}.call(self,options.orientation),_updatePropertiesFromImage.call(self),_triggerUpdate.call(self),cb&&cb()})}function fix(v,decimalPoints){return parseFloat(v).toFixed(decimalPoints||0)}function _get(){var imgData=this.elements.preview.getBoundingClientRect(),vpData=this.elements.viewport.getBoundingClientRect(),x1=vpData.left-imgData.left,y1=vpData.top-imgData.top,widthDiff=(vpData.width-this.elements.viewport.offsetWidth)/2,heightDiff=(vpData.height-this.elements.viewport.offsetHeight)/2,x2=x1+this.elements.viewport.offsetWidth+widthDiff,y2=y1+this.elements.viewport.offsetHeight+heightDiff,scale=this._currentZoom;scale!==1/0&&!isNaN(scale)||(scale=1);var max=this.options.enforceBoundary?0:Number.NEGATIVE_INFINITY;return x1=Math.max(max,x1/scale),y1=Math.max(max,y1/scale),x2=Math.max(max,x2/scale),y2=Math.max(max,y2/scale),{points:[fix(x1),fix(y1),fix(x2),fix(y2)],zoom:scale,orientation:this.data.orientation}}var RESULT_DEFAULTS={type:"canvas",format:"png",quality:1},RESULT_FORMATS=["jpeg","webp","png"];function _result(options){var self=this,data=_get.call(self),opts=deepExtend(clone(RESULT_DEFAULTS),clone(options)),resultType="string"==typeof options?options:opts.type||"base64",size=opts.size||"viewport",format=opts.format,quality=opts.quality,backgroundColor=opts.backgroundColor,circle="boolean"==typeof opts.circle?opts.circle:"circle"===self.options.viewport.type,vpRect=self.elements.viewport.getBoundingClientRect(),ratio=vpRect.width/vpRect.height;return"viewport"===size?(data.outputWidth=vpRect.width,data.outputHeight=vpRect.height):"object"==typeof size&&(size.width&&size.height?(data.outputWidth=size.width,data.outputHeight=size.height):size.width?(data.outputWidth=size.width,data.outputHeight=size.width/ratio):size.height&&(data.outputWidth=size.height*ratio,data.outputHeight=size.height)),-1<RESULT_FORMATS.indexOf(format)&&(data.format="image/"+format,data.quality=quality),data.circle=circle,data.url=self.data.url,data.backgroundColor=backgroundColor,new Promise(function(resolve){switch(resultType.toLowerCase()){case"rawcanvas":resolve(_getCanvas.call(self,data));break;case"canvas":case"base64":resolve(function(data){return _getCanvas.call(this,data).toDataURL(data.format,data.quality)}.call(self,data));break;case"blob":(function(data){var self=this;return new Promise(function(resolve){_getCanvas.call(self,data).toBlob(function(blob){resolve(blob)},data.format,data.quality)})}).call(self,data).then(resolve);break;default:resolve(function(data){var points=data.points,div=document.createElement("div"),img=document.createElement("img"),width=points[2]-points[0],height=points[3]-points[1];return addClass(div,"croppie-result"),div.appendChild(img),css(img,{left:-1*points[0]+"px",top:-1*points[1]+"px"}),img.src=data.url,css(div,{width:width+"px",height:height+"px"}),div}.call(self,data))}})}function _rotate(deg){if(!this.options.useCanvas||!this.options.enableOrientation)throw"Croppie: Cannot rotate without enableOrientation && EXIF.js included";var canvas=this.elements.canvas;this.data.orientation=function(ornt,rotate){var arr=-1<EXIF_NORM.indexOf(ornt)?EXIF_NORM:EXIF_FLIP,index=arr.indexOf(ornt),offset=rotate/90%arr.length;return arr[(arr.length+index+offset%arr.length)%arr.length]}(this.data.orientation,deg),drawCanvas(canvas,this.elements.img,this.data.orientation),_updateCenterPoint.call(this,!0),_updateZoomLimits.call(this)}function _destroy(){this.element.removeChild(this.elements.boundary),function(el,c){el.classList?el.classList.remove(c):el.className=el.className.replace(c,"")}(this.element,"croppie-container"),this.options.enableZoom&&this.element.removeChild(this.elements.zoomerWrap),delete this.elements}if(window.jQuery){var $=window.jQuery;$.fn.croppie=function(opts){if("string"!=typeof opts)return this.each(function(){var i=new Croppie(this,opts);(i.$=$)(this).data("croppie",i)});var args=Array.prototype.slice.call(arguments,1),singleInst=$(this).data("croppie");return"get"===opts?singleInst.get():"result"===opts?singleInst.result.apply(singleInst,args):"bind"===opts?singleInst.bind.apply(singleInst,args):this.each(function(){var i=$(this).data("croppie");if(i){var method=i[opts];if(!$.isFunction(method))throw"Croppie "+opts+" method not found";method.apply(i,args),"destroy"===opts&&$(this).removeData("croppie")}})}}function Croppie(element,opts){if(-1<element.className.indexOf("croppie-container"))throw new Error("Croppie: Can't initialize croppie more than once");if(this.element=element,this.options=deepExtend(clone(Croppie.defaults),opts),"img"===this.element.tagName.toLowerCase()){var origImage=this.element;addClass(origImage,"cr-original-image"),setAttributes(origImage,{"aria-hidden":"true",alt:""});var replacementDiv=document.createElement("div");this.element.parentNode.appendChild(replacementDiv),replacementDiv.appendChild(origImage),this.element=replacementDiv,this.options.url=this.options.url||origImage.src}if(_create.call(this),this.options.url){var bindOpts={url:this.options.url,points:this.options.points};delete this.options.url,delete this.options.points,_bind.call(this,bindOpts)}}return Croppie.defaults={viewport:{width:100,height:100,type:"square"},boundary:{},orientationControls:{enabled:!0,leftClass:"",rightClass:""},resizeControls:{width:!0,height:!0},customClass:"",showZoomer:!0,enableZoom:!0,enableResize:!1,mouseWheelZoom:!0,enableExif:!1,enforceBoundary:!0,enableOrientation:!1,enableKeyMovement:!0,update:function(){}},Croppie.globals={translate:"translate3d"},deepExtend(Croppie.prototype,{bind:function(options,cb){return _bind.call(this,options,cb)},get:function(){var data=_get.call(this),points=data.points;return this.options.relative&&(points[0]/=this.elements.img.naturalWidth/100,points[1]/=this.elements.img.naturalHeight/100,points[2]/=this.elements.img.naturalWidth/100,points[3]/=this.elements.img.naturalHeight/100),data},result:function(type){return _result.call(this,type)},refresh:function(){return function(){_updatePropertiesFromImage.call(this)}.call(this)},setZoom:function(v){_setZoomerVal.call(this,v),dispatchChange(this.elements.zoomer)},rotate:function(deg){_rotate.call(this,deg)},destroy:function(){return _destroy.call(this)}}),Croppie}),function(global,factory){"object"==typeof exports&&"undefined"!=typeof module?module.exports=factory():"function"==typeof define&&define.amd?define(factory):(global=global||self).Chart=factory()}(this,function(){"use strict";function commonjsRequire(){throw new Error("Dynamic requires are not currently supported by rollup-plugin-commonjs")}function createCommonjsModule(fn,module){return fn(module={exports:{}},module.exports),module.exports}var colorName={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]},conversions=createCommonjsModule(function(module){var reverseKeywords={};for(var key in colorName)colorName.hasOwnProperty(key)&&(reverseKeywords[colorName[key]]=key);var convert=module.exports={rgb:{channels:3,labels:"rgb"},hsl:{channels:3,labels:"hsl"},hsv:{channels:3,labels:"hsv"},hwb:{channels:3,labels:"hwb"},cmyk:{channels:4,labels:"cmyk"},xyz:{channels:3,labels:"xyz"},lab:{channels:3,labels:"lab"},lch:{channels:3,labels:"lch"},hex:{channels:1,labels:["hex"]},keyword:{channels:1,labels:["keyword"]},ansi16:{channels:1,labels:["ansi16"]},ansi256:{channels:1,labels:["ansi256"]},hcg:{channels:3,labels:["h","c","g"]},apple:{channels:3,labels:["r16","g16","b16"]},gray:{channels:1,labels:["gray"]}};for(var model in convert)if(convert.hasOwnProperty(model)){if(!("channels"in convert[model]))throw new Error("missing channels property: "+model);if(!("labels"in convert[model]))throw new Error("missing channel labels property: "+model);if(convert[model].labels.length!==convert[model].channels)throw new Error("channel and label counts mismatch: "+model);var channels=convert[model].channels,labels=convert[model].labels;delete convert[model].channels,delete convert[model].labels,Object.defineProperty(convert[model],"channels",{value:channels}),Object.defineProperty(convert[model],"labels",{value:labels})}convert.rgb.hsl=function(rgb){var h,l,r=rgb[0]/255,g=rgb[1]/255,b=rgb[2]/255,min=Math.min(r,g,b),max=Math.max(r,g,b),delta=max-min;return max===min?h=0:r===max?h=(g-b)/delta:g===max?h=2+(b-r)/delta:b===max&&(h=4+(r-g)/delta),(h=Math.min(60*h,360))<0&&(h+=360),l=(min+max)/2,[h,100*(max===min?0:l<=.5?delta/(max+min):delta/(2-max-min)),100*l]},convert.rgb.hsv=function(rgb){function diffc(c){return(v-c)/6/diff+.5}var rdif,gdif,bdif,h,s,r=rgb[0]/255,g=rgb[1]/255,b=rgb[2]/255,v=Math.max(r,g,b),diff=v-Math.min(r,g,b);return 0==diff?h=s=0:(s=diff/v,rdif=diffc(r),gdif=diffc(g),bdif=diffc(b),r===v?h=bdif-gdif:g===v?h=1/3+rdif-bdif:b===v&&(h=2/3+gdif-rdif),h<0?h+=1:1<h&&(h-=1)),[360*h,100*s,100*v]},convert.rgb.hwb=function(rgb){var r=rgb[0],g=rgb[1],b=rgb[2];return[convert.rgb.hsl(rgb)[0],100*(1/255*Math.min(r,Math.min(g,b))),100*(b=1-1/255*Math.max(r,Math.max(g,b)))]},convert.rgb.cmyk=function(rgb){var k,r=rgb[0]/255,g=rgb[1]/255,b=rgb[2]/255;return[100*((1-r-(k=Math.min(1-r,1-g,1-b)))/(1-k)||0),100*((1-g-k)/(1-k)||0),100*((1-b-k)/(1-k)||0),100*k]},convert.rgb.keyword=function(rgb){var reversed=reverseKeywords[rgb];if(reversed)return reversed;var currentClosestKeyword,x,y,currentClosestDistance=1/0;for(var keyword in colorName)if(colorName.hasOwnProperty(keyword)){var value=colorName[keyword],distance=(x=rgb,y=value,Math.pow(x[0]-y[0],2)+Math.pow(x[1]-y[1],2)+Math.pow(x[2]-y[2],2));distance<currentClosestDistance&&(currentClosestDistance=distance,currentClosestKeyword=keyword)}return currentClosestKeyword},convert.keyword.rgb=function(keyword){return colorName[keyword]},convert.rgb.xyz=function(rgb){var r=rgb[0]/255,g=rgb[1]/255,b=rgb[2]/255;return[100*(.4124*(r=.04045<r?Math.pow((r+.055)/1.055,2.4):r/12.92)+.3576*(g=.04045<g?Math.pow((g+.055)/1.055,2.4):g/12.92)+.1805*(b=.04045<b?Math.pow((b+.055)/1.055,2.4):b/12.92)),100*(.2126*r+.7152*g+.0722*b),100*(.0193*r+.1192*g+.9505*b)]},convert.rgb.lab=function(rgb){var xyz=convert.rgb.xyz(rgb),x=xyz[0],y=xyz[1],z=xyz[2];return y/=100,z/=108.883,x=.008856<(x/=95.047)?Math.pow(x,1/3):7.787*x+16/116,[116*(y=.008856<y?Math.pow(y,1/3):7.787*y+16/116)-16,500*(x-y),200*(y-(z=.008856<z?Math.pow(z,1/3):7.787*z+16/116))]},convert.hsl.rgb=function(hsl){var t1,t2,t3,rgb,val,h=hsl[0]/360,s=hsl[1]/100,l=hsl[2]/100;if(0==s)return[val=255*l,val,val];t1=2*l-(t2=l<.5?l*(1+s):l+s-l*s),rgb=[0,0,0];for(var i=0;i<3;i++)(t3=h+1/3*-(i-1))<0&&t3++,1<t3&&t3--,val=6*t3<1?t1+6*(t2-t1)*t3:2*t3<1?t2:3*t3<2?t1+(t2-t1)*(2/3-t3)*6:t1,rgb[i]=255*val;return rgb},convert.hsl.hsv=function(hsl){var h=hsl[0],s=hsl[1]/100,l=hsl[2]/100,smin=s,lmin=Math.max(l,.01);return s*=(l*=2)<=1?l:2-l,smin*=lmin<=1?lmin:2-lmin,[h,100*(0===l?2*smin/(lmin+smin):2*s/(l+s)),100*((l+s)/2)]},convert.hsv.rgb=function(hsv){var h=hsv[0]/60,s=hsv[1]/100,v=hsv[2]/100,hi=Math.floor(h)%6,f=h-Math.floor(h),p=255*v*(1-s),q=255*v*(1-s*f),t=255*v*(1-s*(1-f));switch(v*=255,hi){case 0:return[v,t,p];case 1:return[q,v,p];case 2:return[p,v,t];case 3:return[p,q,v];case 4:return[t,p,v];case 5:return[v,p,q]}},convert.hsv.hsl=function(hsv){var lmin,sl,l,h=hsv[0],s=hsv[1]/100,v=hsv[2]/100,vmin=Math.max(v,.01);return l=(2-s)*v,sl=s*vmin,[h,100*(sl=(sl/=(lmin=(2-s)*vmin)<=1?lmin:2-lmin)||0),100*(l/=2)]},convert.hwb.rgb=function(hwb){var i,v,f,n,r,g,b,h=hwb[0]/360,wh=hwb[1]/100,bl=hwb[2]/100,ratio=wh+bl;switch(1<ratio&&(wh/=ratio,bl/=ratio),f=6*h-(i=Math.floor(6*h)),0!=(1&i)&&(f=1-f),n=wh+f*((v=1-bl)-wh),i){default:case 6:case 0:r=v,g=n,b=wh;break;case 1:r=n,g=v,b=wh;break;case 2:r=wh,g=v,b=n;break;case 3:r=wh,g=n,b=v;break;case 4:r=n,g=wh,b=v;break;case 5:r=v,g=wh,b=n}return[255*r,255*g,255*b]},convert.cmyk.rgb=function(cmyk){var c=cmyk[0]/100,m=cmyk[1]/100,y=cmyk[2]/100,k=cmyk[3]/100;return[255*(1-Math.min(1,c*(1-k)+k)),255*(1-Math.min(1,m*(1-k)+k)),255*(1-Math.min(1,y*(1-k)+k))]},convert.xyz.rgb=function(xyz){var r,g,b,x=xyz[0]/100,y=xyz[1]/100,z=xyz[2]/100;return g=-.9689*x+1.8758*y+.0415*z,b=.0557*x+-.204*y+1.057*z,r=.0031308<(r=3.2406*x+-1.5372*y+-.4986*z)?1.055*Math.pow(r,1/2.4)-.055:12.92*r,g=.0031308<g?1.055*Math.pow(g,1/2.4)-.055:12.92*g,b=.0031308<b?1.055*Math.pow(b,1/2.4)-.055:12.92*b,[255*(r=Math.min(Math.max(0,r),1)),255*(g=Math.min(Math.max(0,g),1)),255*(b=Math.min(Math.max(0,b),1))]},convert.xyz.lab=function(xyz){var x=xyz[0],y=xyz[1],z=xyz[2];return y/=100,z/=108.883,x=.008856<(x/=95.047)?Math.pow(x,1/3):7.787*x+16/116,[116*(y=.008856<y?Math.pow(y,1/3):7.787*y+16/116)-16,500*(x-y),200*(y-(z=.008856<z?Math.pow(z,1/3):7.787*z+16/116))]},convert.lab.xyz=function(lab){var x,y,z,l=lab[0];x=lab[1]/500+(y=(l+16)/116),z=y-lab[2]/200;var y2=Math.pow(y,3),x2=Math.pow(x,3),z2=Math.pow(z,3);return y=.008856<y2?y2:(y-16/116)/7.787,x=.008856<x2?x2:(x-16/116)/7.787,z=.008856<z2?z2:(z-16/116)/7.787,[x*=95.047,y*=100,z*=108.883]},convert.lab.lch=function(lab){var h,l=lab[0],a=lab[1],b=lab[2];return(h=360*Math.atan2(b,a)/2/Math.PI)<0&&(h+=360),[l,Math.sqrt(a*a+b*b),h]},convert.lch.lab=function(lch){var hr,l=lch[0],c=lch[1];return hr=lch[2]/360*2*Math.PI,[l,c*Math.cos(hr),c*Math.sin(hr)]},convert.rgb.ansi16=function(args){var r=args[0],g=args[1],b=args[2],value=1 in arguments?arguments[1]:convert.rgb.hsv(args)[2];if(0===(value=Math.round(value/50)))return 30;var ansi=30+(Math.round(b/255)<<2|Math.round(g/255)<<1|Math.round(r/255));return 2===value&&(ansi+=60),ansi},convert.hsv.ansi16=function(args){return convert.rgb.ansi16(convert.hsv.rgb(args),args[2])},convert.rgb.ansi256=function(args){var r=args[0],g=args[1],b=args[2];return r===g&&g===b?r<8?16:248<r?231:Math.round((r-8)/247*24)+232:16+36*Math.round(r/255*5)+6*Math.round(g/255*5)+Math.round(b/255*5)},convert.ansi16.rgb=function(args){var color=args%10;if(0===color||7===color)return 50<args&&(color+=3.5),[color=color/10.5*255,color,color];var mult=.5*(1+~~(50<args));return[(1&color)*mult*255,(color>>1&1)*mult*255,(color>>2&1)*mult*255]},convert.ansi256.rgb=function(args){if(232<=args){var c=10*(args-232)+8;return[c,c,c]}var rem;return args-=16,[Math.floor(args/36)/5*255,Math.floor((rem=args%36)/6)/5*255,rem%6/5*255]},convert.rgb.hex=function(args){var string=(((255&Math.round(args[0]))<<16)+((255&Math.round(args[1]))<<8)+(255&Math.round(args[2]))).toString(16).toUpperCase();return"000000".substring(string.length)+string},convert.hex.rgb=function(args){var match=args.toString(16).match(/[a-f0-9]{6}|[a-f0-9]{3}/i);if(!match)return[0,0,0];var colorString=match[0];3===match[0].length&&(colorString=colorString.split("").map(function(char){return char+char}).join(""));var integer=parseInt(colorString,16);return[integer>>16&255,integer>>8&255,255&integer]},convert.rgb.hcg=function(rgb){var hue,r=rgb[0]/255,g=rgb[1]/255,b=rgb[2]/255,max=Math.max(Math.max(r,g),b),min=Math.min(Math.min(r,g),b),chroma=max-min;return hue=chroma<=0?0:max===r?(g-b)/chroma%6:max===g?2+(b-r)/chroma:4+(r-g)/chroma+4,hue/=6,[360*(hue%=1),100*chroma,100*(chroma<1?min/(1-chroma):0)]},convert.hsl.hcg=function(hsl){var s=hsl[1]/100,l=hsl[2]/100,c=1,f=0;return(c=l<.5?2*s*l:2*s*(1-l))<1&&(f=(l-.5*c)/(1-c)),[hsl[0],100*c,100*f]},convert.hsv.hcg=function(hsv){var s=hsv[1]/100,v=hsv[2]/100,c=s*v,f=0;return c<1&&(f=(v-c)/(1-c)),[hsv[0],100*c,100*f]},convert.hcg.rgb=function(hcg){var h=hcg[0]/360,c=hcg[1]/100,g=hcg[2]/100;if(0==c)return[255*g,255*g,255*g];var mg,pure=[0,0,0],hi=h%1*6,v=hi%1,w=1-v;switch(Math.floor(hi)){case 0:pure[0]=1,pure[1]=v,pure[2]=0;break;case 1:pure[0]=w,pure[1]=1,pure[2]=0;break;case 2:pure[0]=0,pure[1]=1,pure[2]=v;break;case 3:pure[0]=0,pure[1]=w,pure[2]=1;break;case 4:pure[0]=v,pure[1]=0,pure[2]=1;break;default:pure[0]=1,pure[1]=0,pure[2]=w}return mg=(1-c)*g,[255*(c*pure[0]+mg),255*(c*pure[1]+mg),255*(c*pure[2]+mg)]},convert.hcg.hsv=function(hcg){var c=hcg[1]/100,v=c+hcg[2]/100*(1-c),f=0;return 0<v&&(f=c/v),[hcg[0],100*f,100*v]},convert.hcg.hsl=function(hcg){var c=hcg[1]/100,l=hcg[2]/100*(1-c)+.5*c,s=0;return 0<l&&l<.5?s=c/(2*l):.5<=l&&l<1&&(s=c/(2*(1-l))),[hcg[0],100*s,100*l]},convert.hcg.hwb=function(hcg){var c=hcg[1]/100,v=c+hcg[2]/100*(1-c);return[hcg[0],100*(v-c),100*(1-v)]},convert.hwb.hcg=function(hwb){var w=hwb[1]/100,v=1-hwb[2]/100,c=v-w,g=0;return c<1&&(g=(v-c)/(1-c)),[hwb[0],100*c,100*g]},convert.apple.rgb=function(apple){return[apple[0]/65535*255,apple[1]/65535*255,apple[2]/65535*255]},convert.rgb.apple=function(rgb){return[rgb[0]/255*65535,rgb[1]/255*65535,rgb[2]/255*65535]},convert.gray.rgb=function(args){return[args[0]/100*255,args[0]/100*255,args[0]/100*255]},convert.gray.hsl=convert.gray.hsv=function(args){return[0,0,args[0]]},convert.gray.hwb=function(gray){return[0,100,gray[0]]},convert.gray.cmyk=function(gray){return[0,0,0,gray[0]]},convert.gray.lab=function(gray){return[gray[0],0,0]},convert.gray.hex=function(gray){var val=255&Math.round(gray[0]/100*255),string=((val<<16)+(val<<8)+val).toString(16).toUpperCase();return"000000".substring(string.length)+string},convert.rgb.gray=function(rgb){return[(rgb[0]+rgb[1]+rgb[2])/3/255*100]}});conversions.rgb,conversions.hsl,conversions.hsv,conversions.hwb,conversions.cmyk,conversions.xyz,conversions.lab,conversions.lch,conversions.hex,conversions.keyword,conversions.ansi16,conversions.ansi256,conversions.hcg,conversions.apple,conversions.gray;function deriveBFS(fromModel){var graph=function(){for(var graph={},models=Object.keys(conversions),len=models.length,i=0;i<len;i++)graph[models[i]]={distance:-1,parent:null};return graph}(),queue=[fromModel];for(graph[fromModel].distance=0;queue.length;)for(var current=queue.pop(),adjacents=Object.keys(conversions[current]),len=adjacents.length,i=0;i<len;i++){var adjacent=adjacents[i],node=graph[adjacent];-1===node.distance&&(node.distance=graph[current].distance+1,node.parent=current,queue.unshift(adjacent))}return graph}function link(from,to){return function(args){return to(from(args))}}function wrapConversion(toModel,graph){for(var path=[graph[toModel].parent,toModel],fn=conversions[graph[toModel].parent][toModel],cur=graph[toModel].parent;graph[cur].parent;)path.unshift(graph[cur].parent),fn=link(conversions[graph[cur].parent][cur],fn),cur=graph[cur].parent;return fn.conversion=path,fn}var convert={};function wrapRaw(fn){function wrappedFn(args){return null==args?args:(1<arguments.length&&(args=Array.prototype.slice.call(arguments)),fn(args))}return"conversion"in fn&&(wrappedFn.conversion=fn.conversion),wrappedFn}function wrapRounded(fn){function wrappedFn(args){if(null==args)return args;1<arguments.length&&(args=Array.prototype.slice.call(arguments));var result=fn(args);if("object"==typeof result)for(var len=result.length,i=0;i<len;i++)result[i]=Math.round(result[i]);return result}return"conversion"in fn&&(wrappedFn.conversion=fn.conversion),wrappedFn}Object.keys(conversions).forEach(function(fromModel){convert[fromModel]={},Object.defineProperty(convert[fromModel],"channels",{value:conversions[fromModel].channels}),Object.defineProperty(convert[fromModel],"labels",{value:conversions[fromModel].labels});var routes=function(fromModel){for(var graph=deriveBFS(fromModel),conversion={},models=Object.keys(graph),len=models.length,i=0;i<len;i++){var toModel=models[i];null!==graph[toModel].parent&&(conversion[toModel]=wrapConversion(toModel,graph))}return conversion}(fromModel);Object.keys(routes).forEach(function(toModel){var fn=routes[toModel];convert[fromModel][toModel]=wrapRounded(fn),convert[fromModel][toModel].raw=wrapRaw(fn)})});var colorConvert=convert,colorName$1={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]},colorString={getRgba:getRgba,getHsla:getHsla,getRgb:function(string){var rgba=getRgba(string);return rgba&&rgba.slice(0,3)},getHsl:function(string){var hsla=getHsla(string);return hsla&&hsla.slice(0,3)},getHwb:getHwb,getAlpha:function(string){var vals=getRgba(string);{if(vals)return vals[3];if(vals=getHsla(string))return vals[3];if(vals=getHwb(string))return vals[3]}},hexString:function(rgba,a){a=void 0!==a&&3===rgba.length?a:rgba[3];return"#"+hexDouble(rgba[0])+hexDouble(rgba[1])+hexDouble(rgba[2])+(0<=a&&a<1?hexDouble(Math.round(255*a)):"")},rgbString:function(rgba,alpha){if(alpha<1||rgba[3]&&rgba[3]<1)return rgbaString(rgba,alpha);return"rgb("+rgba[0]+", "+rgba[1]+", "+rgba[2]+")"},rgbaString:rgbaString,percentString:function(rgba,alpha){if(alpha<1||rgba[3]&&rgba[3]<1)return percentaString(rgba,alpha);var r=Math.round(rgba[0]/255*100),g=Math.round(rgba[1]/255*100),b=Math.round(rgba[2]/255*100);return"rgb("+r+"%, "+g+"%, "+b+"%)"},percentaString:percentaString,hslString:function(hsla,alpha){if(alpha<1||hsla[3]&&hsla[3]<1)return hslaString(hsla,alpha);return"hsl("+hsla[0]+", "+hsla[1]+"%, "+hsla[2]+"%)"},hslaString:hslaString,hwbString:function(hwb,alpha){void 0===alpha&&(alpha=void 0!==hwb[3]?hwb[3]:1);return"hwb("+hwb[0]+", "+hwb[1]+"%, "+hwb[2]+"%"+(void 0!==alpha&&1!==alpha?", "+alpha:"")+")"},keyword:function(rgb){return reverseNames[rgb.slice(0,3)]}};function getRgba(string){if(string){var rgb=[0,0,0],a=1,match=string.match(/^#([a-fA-F0-9]{3,4})$/i),hexAlpha="";if(match){hexAlpha=(match=match[1])[3];for(var i=0;i<rgb.length;i++)rgb[i]=parseInt(match[i]+match[i],16);hexAlpha&&(a=Math.round(parseInt(hexAlpha+hexAlpha,16)/255*100)/100)}else if(match=string.match(/^#([a-fA-F0-9]{6}([a-fA-F0-9]{2})?)$/i)){hexAlpha=match[2],match=match[1];for(i=0;i<rgb.length;i++)rgb[i]=parseInt(match.slice(2*i,2*i+2),16);hexAlpha&&(a=Math.round(parseInt(hexAlpha,16)/255*100)/100)}else if(match=string.match(/^rgba?\(\s*([+-]?\d+)\s*,\s*([+-]?\d+)\s*,\s*([+-]?\d+)\s*(?:,\s*([+-]?[\d\.]+)\s*)?\)$/i)){for(i=0;i<rgb.length;i++)rgb[i]=parseInt(match[i+1]);a=parseFloat(match[4])}else if(match=string.match(/^rgba?\(\s*([+-]?[\d\.]+)\%\s*,\s*([+-]?[\d\.]+)\%\s*,\s*([+-]?[\d\.]+)\%\s*(?:,\s*([+-]?[\d\.]+)\s*)?\)$/i)){for(i=0;i<rgb.length;i++)rgb[i]=Math.round(2.55*parseFloat(match[i+1]));a=parseFloat(match[4])}else if(match=string.match(/(\w+)/)){if("transparent"==match[1])return[0,0,0,0];if(!(rgb=colorName$1[match[1]]))return}for(i=0;i<rgb.length;i++)rgb[i]=scale(rgb[i],0,255);return a=a||0==a?scale(a,0,1):1,rgb[3]=a,rgb}}function getHsla(string){if(string){var match=string.match(/^hsla?\(\s*([+-]?\d+)(?:deg)?\s*,\s*([+-]?[\d\.]+)%\s*,\s*([+-]?[\d\.]+)%\s*(?:,\s*([+-]?[\d\.]+)\s*)?\)/);if(match){var alpha=parseFloat(match[4]);return[scale(parseInt(match[1]),0,360),scale(parseFloat(match[2]),0,100),scale(parseFloat(match[3]),0,100),scale(isNaN(alpha)?1:alpha,0,1)]}}}function getHwb(string){if(string){var match=string.match(/^hwb\(\s*([+-]?\d+)(?:deg)?\s*,\s*([+-]?[\d\.]+)%\s*,\s*([+-]?[\d\.]+)%\s*(?:,\s*([+-]?[\d\.]+)\s*)?\)/);if(match){var alpha=parseFloat(match[4]);return[scale(parseInt(match[1]),0,360),scale(parseFloat(match[2]),0,100),scale(parseFloat(match[3]),0,100),scale(isNaN(alpha)?1:alpha,0,1)]}}}function rgbaString(rgba,alpha){return void 0===alpha&&(alpha=void 0!==rgba[3]?rgba[3]:1),"rgba("+rgba[0]+", "+rgba[1]+", "+rgba[2]+", "+alpha+")"}function percentaString(rgba,alpha){return"rgba("+Math.round(rgba[0]/255*100)+"%, "+Math.round(rgba[1]/255*100)+"%, "+Math.round(rgba[2]/255*100)+"%, "+(alpha||rgba[3]||1)+")"}function hslaString(hsla,alpha){return void 0===alpha&&(alpha=void 0!==hsla[3]?hsla[3]:1),"hsla("+hsla[0]+", "+hsla[1]+"%, "+hsla[2]+"%, "+alpha+")"}function scale(num,min,max){return Math.min(Math.max(min,num),max)}function hexDouble(num){var str=num.toString(16).toUpperCase();return str.length<2?"0"+str:str}var reverseNames={};for(var name in colorName$1)reverseNames[colorName$1[name]]=name;var Color=function(obj){return obj instanceof Color?obj:this instanceof Color?(this.valid=!1,this.values={rgb:[0,0,0],hsl:[0,0,0],hsv:[0,0,0],hwb:[0,0,0],cmyk:[0,0,0,0],alpha:1},void("string"==typeof obj?(vals=colorString.getRgba(obj))?this.setValues("rgb",vals):(vals=colorString.getHsla(obj))?this.setValues("hsl",vals):(vals=colorString.getHwb(obj))&&this.setValues("hwb",vals):"object"==typeof obj&&(void 0!==(vals=obj).r||void 0!==vals.red?this.setValues("rgb",vals):void 0!==vals.l||void 0!==vals.lightness?this.setValues("hsl",vals):void 0!==vals.v||void 0!==vals.value?this.setValues("hsv",vals):void 0!==vals.w||void 0!==vals.whiteness?this.setValues("hwb",vals):void 0===vals.c&&void 0===vals.cyan||this.setValues("cmyk",vals)))):new Color(obj);var vals};Color.prototype={isValid:function(){return this.valid},rgb:function(){return this.setSpace("rgb",arguments)},hsl:function(){return this.setSpace("hsl",arguments)},hsv:function(){return this.setSpace("hsv",arguments)},hwb:function(){return this.setSpace("hwb",arguments)},cmyk:function(){return this.setSpace("cmyk",arguments)},rgbArray:function(){return this.values.rgb},hslArray:function(){return this.values.hsl},hsvArray:function(){return this.values.hsv},hwbArray:function(){var values=this.values;return 1!==values.alpha?values.hwb.concat([values.alpha]):values.hwb},cmykArray:function(){return this.values.cmyk},rgbaArray:function(){var values=this.values;return values.rgb.concat([values.alpha])},hslaArray:function(){var values=this.values;return values.hsl.concat([values.alpha])},alpha:function(val){return void 0===val?this.values.alpha:(this.setValues("alpha",val),this)},red:function(val){return this.setChannel("rgb",0,val)},green:function(val){return this.setChannel("rgb",1,val)},blue:function(val){return this.setChannel("rgb",2,val)},hue:function(val){return val=val&&((val%=360)<0?360+val:val),this.setChannel("hsl",0,val)},saturation:function(val){return this.setChannel("hsl",1,val)},lightness:function(val){return this.setChannel("hsl",2,val)},saturationv:function(val){return this.setChannel("hsv",1,val)},whiteness:function(val){return this.setChannel("hwb",1,val)},blackness:function(val){return this.setChannel("hwb",2,val)},value:function(val){return this.setChannel("hsv",2,val)},cyan:function(val){return this.setChannel("cmyk",0,val)},magenta:function(val){return this.setChannel("cmyk",1,val)},yellow:function(val){return this.setChannel("cmyk",2,val)},black:function(val){return this.setChannel("cmyk",3,val)},hexString:function(){return colorString.hexString(this.values.rgb)},rgbString:function(){return colorString.rgbString(this.values.rgb,this.values.alpha)},rgbaString:function(){return colorString.rgbaString(this.values.rgb,this.values.alpha)},percentString:function(){return colorString.percentString(this.values.rgb,this.values.alpha)},hslString:function(){return colorString.hslString(this.values.hsl,this.values.alpha)},hslaString:function(){return colorString.hslaString(this.values.hsl,this.values.alpha)},hwbString:function(){return colorString.hwbString(this.values.hwb,this.values.alpha)},keyword:function(){return colorString.keyword(this.values.rgb,this.values.alpha)},rgbNumber:function(){var rgb=this.values.rgb;return rgb[0]<<16|rgb[1]<<8|rgb[2]},luminosity:function(){for(var rgb=this.values.rgb,lum=[],i=0;i<rgb.length;i++){var chan=rgb[i]/255;lum[i]=chan<=.03928?chan/12.92:Math.pow((.055+chan)/1.055,2.4)}return.2126*lum[0]+.7152*lum[1]+.0722*lum[2]},contrast:function(color2){var lum1=this.luminosity(),lum2=color2.luminosity();return lum2<lum1?(lum1+.05)/(lum2+.05):(lum2+.05)/(lum1+.05)},level:function(color2){var contrastRatio=this.contrast(color2);return 7.1<=contrastRatio?"AAA":4.5<=contrastRatio?"AA":""},dark:function(){var rgb=this.values.rgb;return(299*rgb[0]+587*rgb[1]+114*rgb[2])/1e3<128},light:function(){return!this.dark()},negate:function(){for(var rgb=[],i=0;i<3;i++)rgb[i]=255-this.values.rgb[i];return this.setValues("rgb",rgb),this},lighten:function(ratio){var hsl=this.values.hsl;return hsl[2]+=hsl[2]*ratio,this.setValues("hsl",hsl),this},darken:function(ratio){var hsl=this.values.hsl;return hsl[2]-=hsl[2]*ratio,this.setValues("hsl",hsl),this},saturate:function(ratio){var hsl=this.values.hsl;return hsl[1]+=hsl[1]*ratio,this.setValues("hsl",hsl),this},desaturate:function(ratio){var hsl=this.values.hsl;return hsl[1]-=hsl[1]*ratio,this.setValues("hsl",hsl),this},whiten:function(ratio){var hwb=this.values.hwb;return hwb[1]+=hwb[1]*ratio,this.setValues("hwb",hwb),this},blacken:function(ratio){var hwb=this.values.hwb;return hwb[2]+=hwb[2]*ratio,this.setValues("hwb",hwb),this},greyscale:function(){var rgb=this.values.rgb,val=.3*rgb[0]+.59*rgb[1]+.11*rgb[2];return this.setValues("rgb",[val,val,val]),this},clearer:function(ratio){var alpha=this.values.alpha;return this.setValues("alpha",alpha-alpha*ratio),this},opaquer:function(ratio){var alpha=this.values.alpha;return this.setValues("alpha",alpha+alpha*ratio),this},rotate:function(degrees){var hsl=this.values.hsl,hue=(hsl[0]+degrees)%360;return hsl[0]=hue<0?360+hue:hue,this.setValues("hsl",hsl),this},mix:function(mixinColor,weight){var color2=mixinColor,p=void 0===weight?.5:weight,w=2*p-1,a=this.alpha()-color2.alpha(),w1=(1+(w*a==-1?w:(w+a)/(1+w*a)))/2,w2=1-w1;return this.rgb(w1*this.red()+w2*color2.red(),w1*this.green()+w2*color2.green(),w1*this.blue()+w2*color2.blue()).alpha(this.alpha()*p+color2.alpha()*(1-p))},toJSON:function(){return this.rgb()},clone:function(){var value,type,result=new Color,source=this.values,target=result.values;for(var prop in source)source.hasOwnProperty(prop)&&(value=source[prop],"[object Array]"===(type={}.toString.call(value))?target[prop]=value.slice(0):"[object Number]"===type?target[prop]=value:console.error("unexpected color value:",value));return result}},Color.prototype.spaces={rgb:["red","green","blue"],hsl:["hue","saturation","lightness"],hsv:["hue","saturation","value"],hwb:["hue","whiteness","blackness"],cmyk:["cyan","magenta","yellow","black"]},Color.prototype.maxes={rgb:[255,255,255],hsl:[360,100,100],hsv:[360,100,100],hwb:[360,100,100],cmyk:[100,100,100,100]},Color.prototype.getValues=function(space){for(var values=this.values,vals={},i=0;i<space.length;i++)vals[space.charAt(i)]=values[space][i];return 1!==values.alpha&&(vals.a=values.alpha),vals},Color.prototype.setValues=function(space,vals){var i,capped,values=this.values,spaces=this.spaces,maxes=this.maxes,alpha=1;if(this.valid=!0,"alpha"===space)alpha=vals;else if(vals.length)values[space]=vals.slice(0,space.length),alpha=vals[space.length];else if(void 0!==vals[space.charAt(0)]){for(i=0;i<space.length;i++)values[space][i]=vals[space.charAt(i)];alpha=vals.a}else if(void 0!==vals[spaces[space][0]]){var chans=spaces[space];for(i=0;i<space.length;i++)values[space][i]=vals[chans[i]];alpha=vals.alpha}if(values.alpha=Math.max(0,Math.min(1,void 0===alpha?values.alpha:alpha)),"alpha"===space)return!1;for(i=0;i<space.length;i++)capped=Math.max(0,Math.min(maxes[space][i],values[space][i])),values[space][i]=Math.round(capped);for(var sname in spaces)sname!==space&&(values[sname]=colorConvert[space][sname](values[space]));return!0},Color.prototype.setSpace=function(space,args){var vals=args[0];return void 0===vals?this.getValues(space):("number"==typeof vals&&(vals=Array.prototype.slice.call(args)),this.setValues(space,vals),this)},Color.prototype.setChannel=function(space,index,val){var svalues=this.values[space];return void 0===val?svalues[index]:(val===svalues[index]||(svalues[index]=val,this.setValues(space,svalues)),this)},"undefined"!=typeof window&&(window.Color=Color);var id,chartjsColor=Color,helpers={noop:function(){},uid:(id=0,function(){return id++}),isNullOrUndef:function(value){return null==value},isArray:function(value){if(Array.isArray&&Array.isArray(value))return!0;var type=Object.prototype.toString.call(value);return"[object"===type.substr(0,7)&&"Array]"===type.substr(-6)},isObject:function(value){return null!==value&&"[object Object]"===Object.prototype.toString.call(value)},isFinite:function(value){return("number"==typeof value||value instanceof Number)&&isFinite(value)},valueOrDefault:function(value,defaultValue){return void 0===value?defaultValue:value},valueAtIndexOrDefault:function(value,index,defaultValue){return helpers.valueOrDefault(helpers.isArray(value)?value[index]:value,defaultValue)},callback:function(fn,args,thisArg){if(fn&&"function"==typeof fn.call)return fn.apply(thisArg,args)},each:function(loopable,fn,thisArg,reverse){var i,len,keys;if(helpers.isArray(loopable))if(len=loopable.length,reverse)for(i=len-1;0<=i;i--)fn.call(thisArg,loopable[i],i);else for(i=0;i<len;i++)fn.call(thisArg,loopable[i],i);else if(helpers.isObject(loopable))for(len=(keys=Object.keys(loopable)).length,i=0;i<len;i++)fn.call(thisArg,loopable[keys[i]],keys[i])},arrayEquals:function(a0,a1){var i,ilen,v0,v1;if(!a0||!a1||a0.length!==a1.length)return!1;for(i=0,ilen=a0.length;i<ilen;++i)if(v0=a0[i],v1=a1[i],v0 instanceof Array&&v1 instanceof Array){if(!helpers.arrayEquals(v0,v1))return!1}else if(v0!==v1)return!1;return!0},clone:function(source){if(helpers.isArray(source))return source.map(helpers.clone);if(helpers.isObject(source)){for(var target={},keys=Object.keys(source),klen=keys.length,k=0;k<klen;++k)target[keys[k]]=helpers.clone(source[keys[k]]);return target}return source},_merger:function(key,target,source,options){var tval=target[key],sval=source[key];helpers.isObject(tval)&&helpers.isObject(sval)?helpers.merge(tval,sval,options):target[key]=helpers.clone(sval)},_mergerIf:function(key,target,source){var tval=target[key],sval=source[key];helpers.isObject(tval)&&helpers.isObject(sval)?helpers.mergeIf(tval,sval):target.hasOwnProperty(key)||(target[key]=helpers.clone(sval))},merge:function(target,source,options){var merge,i,keys,klen,k,sources=helpers.isArray(source)?source:[source],ilen=sources.length;if(!helpers.isObject(target))return target;for(merge=(options=options||{}).merger||helpers._merger,i=0;i<ilen;++i)if(source=sources[i],helpers.isObject(source))for(k=0,klen=(keys=Object.keys(source)).length;k<klen;++k)merge(keys[k],target,source,options);return target},mergeIf:function(target,source){return helpers.merge(target,source,{merger:helpers._mergerIf})},extend:Object.assign||function(target){return helpers.merge(target,[].slice.call(arguments,1),{merger:function(key,dst,src){dst[key]=src[key]}})},inherits:function(extensions){function Surrogate(){this.constructor=ChartElement}var me=this,ChartElement=extensions&&extensions.hasOwnProperty("constructor")?extensions.constructor:function(){return me.apply(this,arguments)};return Surrogate.prototype=me.prototype,ChartElement.prototype=new Surrogate,ChartElement.extend=helpers.inherits,extensions&&helpers.extend(ChartElement.prototype,extensions),ChartElement.__super__=me.prototype,ChartElement},_deprecated:function(scope,value,previous,current){void 0!==value&&console.warn(scope+': "'+previous+'" is deprecated. Please use "'+current+'" instead')}},helpers_core=helpers;helpers.callCallback=helpers.callback,helpers.indexOf=function(array,item,fromIndex){return Array.prototype.indexOf.call(array,item,fromIndex)},helpers.getValueOrDefault=helpers.valueOrDefault,helpers.getValueAtIndexOrDefault=helpers.valueAtIndexOrDefault;var effects={linear:function(t){return t},easeInQuad:function(t){return t*t},easeOutQuad:function(t){return-t*(t-2)},easeInOutQuad:function(t){return(t/=.5)<1?.5*t*t:-.5*(--t*(t-2)-1)},easeInCubic:function(t){return t*t*t},easeOutCubic:function(t){return(t-=1)*t*t+1},easeInOutCubic:function(t){return(t/=.5)<1?.5*t*t*t:.5*((t-=2)*t*t+2)},easeInQuart:function(t){return t*t*t*t},easeOutQuart:function(t){return-((t-=1)*t*t*t-1)},easeInOutQuart:function(t){return(t/=.5)<1?.5*t*t*t*t:-.5*((t-=2)*t*t*t-2)},easeInQuint:function(t){return t*t*t*t*t},easeOutQuint:function(t){return(t-=1)*t*t*t*t+1},easeInOutQuint:function(t){return(t/=.5)<1?.5*t*t*t*t*t:.5*((t-=2)*t*t*t*t+2)},easeInSine:function(t){return 1-Math.cos(t*(Math.PI/2))},easeOutSine:function(t){return Math.sin(t*(Math.PI/2))},easeInOutSine:function(t){return-.5*(Math.cos(Math.PI*t)-1)},easeInExpo:function(t){return 0===t?0:Math.pow(2,10*(t-1))},easeOutExpo:function(t){return 1===t?1:1-Math.pow(2,-10*t)},easeInOutExpo:function(t){return 0===t?0:1===t?1:(t/=.5)<1?.5*Math.pow(2,10*(t-1)):.5*(2-Math.pow(2,-10*--t))},easeInCirc:function(t){return 1<=t?t:-(Math.sqrt(1-t*t)-1)},easeOutCirc:function(t){return Math.sqrt(1-(t-=1)*t)},easeInOutCirc:function(t){return(t/=.5)<1?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1)},easeInElastic:function(t){var s=1.70158,p=0,a=1;return 0===t?0:1===t?1:(p=p||.3,s=a<1?(a=1,p/4):p/(2*Math.PI)*Math.asin(1/a),-a*Math.pow(2,10*(t-=1))*Math.sin((t-s)*(2*Math.PI)/p))},easeOutElastic:function(t){var s=1.70158,p=0,a=1;return 0===t?0:1===t?1:(p=p||.3,s=a<1?(a=1,p/4):p/(2*Math.PI)*Math.asin(1/a),a*Math.pow(2,-10*t)*Math.sin((t-s)*(2*Math.PI)/p)+1)},easeInOutElastic:function(t){var s=1.70158,p=0,a=1;return 0===t?0:2==(t/=.5)?1:(p=p||.45,s=a<1?(a=1,p/4):p/(2*Math.PI)*Math.asin(1/a),t<1?a*Math.pow(2,10*(t-=1))*Math.sin((t-s)*(2*Math.PI)/p)*-.5:a*Math.pow(2,-10*(t-=1))*Math.sin((t-s)*(2*Math.PI)/p)*.5+1)},easeInBack:function(t){var s=1.70158;return t*t*((1+s)*t-s)},easeOutBack:function(t){var s=1.70158;return(t-=1)*t*((1+s)*t+s)+1},easeInOutBack:function(t){var s=1.70158;return(t/=.5)<1?t*t*((1+(s*=1.525))*t-s)*.5:.5*((t-=2)*t*((1+(s*=1.525))*t+s)+2)},easeInBounce:function(t){return 1-effects.easeOutBounce(1-t)},easeOutBounce:function(t){return t<1/2.75?7.5625*t*t:t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375},easeInOutBounce:function(t){return t<.5?.5*effects.easeInBounce(2*t):.5*effects.easeOutBounce(2*t-1)+.5}},helpers_easing={effects:effects};helpers_core.easingEffects=effects;var PI=Math.PI,RAD_PER_DEG=PI/180,DOUBLE_PI=2*PI,HALF_PI=PI/2,QUARTER_PI=PI/4,TWO_THIRDS_PI=2*PI/3,exports$1={clear:function(chart){chart.ctx.clearRect(0,0,chart.width,chart.height)},roundedRect:function(ctx,x,y,width,height,radius){if(radius){var r=Math.min(radius,height/2,width/2),left=x+r,top=y+r,right=x+width-r,bottom=y+height-r;ctx.moveTo(x,top),left<right&&top<bottom?(ctx.arc(left,top,r,-PI,-HALF_PI),ctx.arc(right,top,r,-HALF_PI,0),ctx.arc(right,bottom,r,0,HALF_PI),ctx.arc(left,bottom,r,HALF_PI,PI)):left<right?(ctx.moveTo(left,y),ctx.arc(right,top,r,-HALF_PI,HALF_PI),ctx.arc(left,top,r,HALF_PI,PI+HALF_PI)):top<bottom?(ctx.arc(left,top,r,-PI,0),ctx.arc(left,bottom,r,0,PI)):ctx.arc(left,top,r,-PI,PI),ctx.closePath(),ctx.moveTo(x,y)}else ctx.rect(x,y,width,height)},drawPoint:function(ctx,style,radius,x,y,rotation){var type,xOffset,yOffset,size,cornerRadius,rad=(rotation||0)*RAD_PER_DEG;if(style&&"object"==typeof style&&("[object HTMLImageElement]"===(type=style.toString())||"[object HTMLCanvasElement]"===type))return ctx.save(),ctx.translate(x,y),ctx.rotate(rad),ctx.drawImage(style,-style.width/2,-style.height/2,style.width,style.height),void ctx.restore();if(!(isNaN(radius)||radius<=0)){switch(ctx.beginPath(),style){default:ctx.arc(x,y,radius,0,DOUBLE_PI),ctx.closePath();break;case"triangle":ctx.moveTo(x+Math.sin(rad)*radius,y-Math.cos(rad)*radius),rad+=TWO_THIRDS_PI,ctx.lineTo(x+Math.sin(rad)*radius,y-Math.cos(rad)*radius),rad+=TWO_THIRDS_PI,ctx.lineTo(x+Math.sin(rad)*radius,y-Math.cos(rad)*radius),ctx.closePath();break;case"rectRounded":size=radius-(cornerRadius=.516*radius),xOffset=Math.cos(rad+QUARTER_PI)*size,yOffset=Math.sin(rad+QUARTER_PI)*size,ctx.arc(x-xOffset,y-yOffset,cornerRadius,rad-PI,rad-HALF_PI),ctx.arc(x+yOffset,y-xOffset,cornerRadius,rad-HALF_PI,rad),ctx.arc(x+xOffset,y+yOffset,cornerRadius,rad,rad+HALF_PI),ctx.arc(x-yOffset,y+xOffset,cornerRadius,rad+HALF_PI,rad+PI),ctx.closePath();break;case"rect":if(!rotation){size=Math.SQRT1_2*radius,ctx.rect(x-size,y-size,2*size,2*size);break}rad+=QUARTER_PI;case"rectRot":xOffset=Math.cos(rad)*radius,yOffset=Math.sin(rad)*radius,ctx.moveTo(x-xOffset,y-yOffset),ctx.lineTo(x+yOffset,y-xOffset),ctx.lineTo(x+xOffset,y+yOffset),ctx.lineTo(x-yOffset,y+xOffset),ctx.closePath();break;case"crossRot":rad+=QUARTER_PI;case"cross":xOffset=Math.cos(rad)*radius,yOffset=Math.sin(rad)*radius,ctx.moveTo(x-xOffset,y-yOffset),ctx.lineTo(x+xOffset,y+yOffset),ctx.moveTo(x+yOffset,y-xOffset),ctx.lineTo(x-yOffset,y+xOffset);break;case"star":xOffset=Math.cos(rad)*radius,yOffset=Math.sin(rad)*radius,ctx.moveTo(x-xOffset,y-yOffset),ctx.lineTo(x+xOffset,y+yOffset),ctx.moveTo(x+yOffset,y-xOffset),ctx.lineTo(x-yOffset,y+xOffset),rad+=QUARTER_PI,xOffset=Math.cos(rad)*radius,yOffset=Math.sin(rad)*radius,ctx.moveTo(x-xOffset,y-yOffset),ctx.lineTo(x+xOffset,y+yOffset),ctx.moveTo(x+yOffset,y-xOffset),ctx.lineTo(x-yOffset,y+xOffset);break;case"line":xOffset=Math.cos(rad)*radius,yOffset=Math.sin(rad)*radius,ctx.moveTo(x-xOffset,y-yOffset),ctx.lineTo(x+xOffset,y+yOffset);break;case"dash":ctx.moveTo(x,y),ctx.lineTo(x+Math.cos(rad)*radius,y+Math.sin(rad)*radius)}ctx.fill(),ctx.stroke()}},_isPointInArea:function(point,area){return point.x>area.left-1e-6&&point.x<area.right+1e-6&&point.y>area.top-1e-6&&point.y<area.bottom+1e-6},clipArea:function(ctx,area){ctx.save(),ctx.beginPath(),ctx.rect(area.left,area.top,area.right-area.left,area.bottom-area.top),ctx.clip()},unclipArea:function(ctx){ctx.restore()},lineTo:function(ctx,previous,target,flip){var stepped=target.steppedLine;if(stepped){if("middle"===stepped){var midpoint=(previous.x+target.x)/2;ctx.lineTo(midpoint,flip?target.y:previous.y),ctx.lineTo(midpoint,flip?previous.y:target.y)}else"after"===stepped&&!flip||"after"!==stepped&&flip?ctx.lineTo(previous.x,target.y):ctx.lineTo(target.x,previous.y);ctx.lineTo(target.x,target.y)}else target.tension?ctx.bezierCurveTo(flip?previous.controlPointPreviousX:previous.controlPointNextX,flip?previous.controlPointPreviousY:previous.controlPointNextY,flip?target.controlPointNextX:target.controlPointPreviousX,flip?target.controlPointNextY:target.controlPointPreviousY,target.x,target.y):ctx.lineTo(target.x,target.y)}},helpers_canvas=exports$1;helpers_core.clear=exports$1.clear,helpers_core.drawRoundedRectangle=function(ctx){ctx.beginPath(),exports$1.roundedRect.apply(exports$1,arguments)};var defaults={_set:function(scope,values){return helpers_core.merge(this[scope]||(this[scope]={}),values)}};defaults._set("global",{defaultColor:"rgba(0,0,0,0.1)",defaultFontColor:"#666",defaultFontFamily:"'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",defaultFontSize:12,defaultFontStyle:"normal",defaultLineHeight:1.2,showLines:!0});var core_defaults=defaults,valueOrDefault=helpers_core.valueOrDefault;var helpers_options={toLineHeight:function(value,size){var matches=(""+value).match(/^(normal|(\d+(?:\.\d+)?)(px|em|%)?)$/);if(!matches||"normal"===matches[1])return 1.2*size;switch(value=+matches[2],matches[3]){case"px":return value;case"%":value/=100}return size*value},toPadding:function(value){var t,r,b,l;return helpers_core.isObject(value)?(t=+value.top||0,r=+value.right||0,b=+value.bottom||0,l=+value.left||0):t=r=b=l=+value||0,{top:t,right:r,bottom:b,left:l,height:t+b,width:l+r}},_parseFont:function(options){var globalDefaults=core_defaults.global,size=valueOrDefault(options.fontSize,globalDefaults.defaultFontSize),font={family:valueOrDefault(options.fontFamily,globalDefaults.defaultFontFamily),lineHeight:helpers_core.options.toLineHeight(valueOrDefault(options.lineHeight,globalDefaults.defaultLineHeight),size),size:size,style:valueOrDefault(options.fontStyle,globalDefaults.defaultFontStyle),weight:null,string:""};return font.string=function(font){return!font||helpers_core.isNullOrUndef(font.size)||helpers_core.isNullOrUndef(font.family)?null:(font.style?font.style+" ":"")+(font.weight?font.weight+" ":"")+font.size+"px "+font.family}(font),font},resolve:function(inputs,context,index,info){var i,ilen,value,cacheable=!0;for(i=0,ilen=inputs.length;i<ilen;++i)if(void 0!==(value=inputs[i])&&(void 0!==context&&"function"==typeof value&&(value=value(context),cacheable=!1),void 0!==index&&helpers_core.isArray(value)&&(value=value[index],cacheable=!1),void 0!==value))return info&&!cacheable&&(info.cacheable=!1),value}},exports$2={_factorize:function(value){var i,result=[],sqrt=Math.sqrt(value);for(i=1;i<sqrt;i++)value%i==0&&(result.push(i),result.push(value/i));return sqrt===(0|sqrt)&&result.push(sqrt),result.sort(function(a,b){return a-b}).pop(),result},log10:Math.log10||function(x){var exponent=Math.log(x)*Math.LOG10E,powerOf10=Math.round(exponent);return x===Math.pow(10,powerOf10)?powerOf10:exponent}},helpers_math=exports$2;helpers_core.log10=exports$2.log10;var helpers$1=helpers_core,easing=helpers_easing,canvas=helpers_canvas,options=helpers_options,math=helpers_math,rtl={getRtlAdapter:function(rtl,rectX,width){return rtl?function(rectX,width){return{x:function(x){return rectX+rectX+width-x},setWidth:function(w){width=w},textAlign:function(align){return"center"===align?align:"right"===align?"left":"right"},xPlus:function(x,value){return x-value},leftForLtr:function(x,itemWidth){return x-itemWidth}}}(rectX,width):{x:function(x){return x},setWidth:function(w){},textAlign:function(align){return align},xPlus:function(x,value){return x+value},leftForLtr:function(x,_itemWidth){return x}}},overrideTextDirection:function(ctx,direction){var style,original;"ltr"!==direction&&"rtl"!==direction||(original=[(style=ctx.canvas.style).getPropertyValue("direction"),style.getPropertyPriority("direction")],style.setProperty("direction",direction,"important"),ctx.prevTextDirection=original)},restoreTextDirection:function(ctx){var original=ctx.prevTextDirection;void 0!==original&&(delete ctx.prevTextDirection,ctx.canvas.style.setProperty("direction",original[0],original[1]))}};helpers$1.easing=easing,helpers$1.canvas=canvas,helpers$1.options=options,helpers$1.math=math,helpers$1.rtl=rtl;function Element(configuration){helpers$1.extend(this,configuration),this.initialize.apply(this,arguments)}helpers$1.extend(Element.prototype,{_type:void 0,initialize:function(){this.hidden=!1},pivot:function(){var me=this;return me._view||(me._view=helpers$1.extend({},me._model)),me._start={},me},transition:function(ease){var me=this,model=me._model,start=me._start,view=me._view;return model&&1!==ease?(view=view||(me._view={}),function(start,view,model,ease){var i,ilen,key,actual,origin,target,type,c0,c1,keys=Object.keys(model);for(i=0,ilen=keys.length;i<ilen;++i)if(target=model[key=keys[i]],view.hasOwnProperty(key)||(view[key]=target),(actual=view[key])!==target&&"_"!==key[0]){if(start.hasOwnProperty(key)||(start[key]=actual),(type=typeof target)==typeof(origin=start[key]))if("string"==type){if((c0=chartjsColor(origin)).valid&&(c1=chartjsColor(target)).valid){view[key]=c1.mix(c0,ease).rgbString();continue}}else if(helpers$1.isFinite(origin)&&helpers$1.isFinite(target)){view[key]=origin+(target-origin)*ease;continue}view[key]=target}}(start=start||(me._start={}),view,model,ease)):(me._view=helpers$1.extend({},model),me._start=null),me},tooltipPosition:function(){return{x:this._model.x,y:this._model.y}},hasValue:function(){return helpers$1.isNumber(this._model.x)&&helpers$1.isNumber(this._model.y)}}),Element.extend=helpers$1.inherits;var core_element=Element,exports$3=core_element.extend({chart:null,currentStep:0,numSteps:60,easing:"",render:null,onAnimationProgress:null,onAnimationComplete:null}),core_animation=exports$3;Object.defineProperty(exports$3.prototype,"animationObject",{get:function(){return this}}),Object.defineProperty(exports$3.prototype,"chartInstance",{get:function(){return this.chart},set:function(value){this.chart=value}}),core_defaults._set("global",{animation:{duration:1e3,easing:"easeOutQuart",onProgress:helpers$1.noop,onComplete:helpers$1.noop}});var core_animations={animations:[],request:null,addAnimation:function(chart,animation,duration,lazy){var i,ilen,animations=this.animations;for(animation.chart=chart,animation.startTime=Date.now(),animation.duration=duration,lazy||(chart.animating=!0),i=0,ilen=animations.length;i<ilen;++i)if(animations[i].chart===chart)return void(animations[i]=animation);animations.push(animation),1===animations.length&&this.requestAnimationFrame()},cancelAnimation:function(chart){var index=helpers$1.findIndex(this.animations,function(animation){return animation.chart===chart});-1!==index&&(this.animations.splice(index,1),chart.animating=!1)},requestAnimationFrame:function(){var me=this;null===me.request&&(me.request=helpers$1.requestAnimFrame.call(window,function(){me.request=null,me.startDigest()}))},startDigest:function(){this.advance(),0<this.animations.length&&this.requestAnimationFrame()},advance:function(){for(var animation,chart,numSteps,nextStep,animations=this.animations,i=0;i<animations.length;)chart=(animation=animations[i]).chart,numSteps=animation.numSteps,nextStep=Math.floor((Date.now()-animation.startTime)/animation.duration*numSteps)+1,animation.currentStep=Math.min(nextStep,numSteps),helpers$1.callback(animation.render,[chart,animation],chart),helpers$1.callback(animation.onAnimationProgress,[animation],chart),animation.currentStep>=numSteps?(helpers$1.callback(animation.onAnimationComplete,[animation],chart),chart.animating=!1,animations.splice(i,1)):++i}},resolve=helpers$1.options.resolve,arrayEvents=["push","pop","shift","splice","unshift"];function unlistenArrayEvents(array,listener){var stub=array._chartjs;if(stub){var listeners=stub.listeners,index=listeners.indexOf(listener);-1!==index&&listeners.splice(index,1),0<listeners.length||(arrayEvents.forEach(function(key){delete array[key]}),delete array._chartjs)}}function DatasetController(chart,datasetIndex){this.initialize(chart,datasetIndex)}helpers$1.extend(DatasetController.prototype,{datasetElementType:null,dataElementType:null,_datasetElementOptions:["backgroundColor","borderCapStyle","borderColor","borderDash","borderDashOffset","borderJoinStyle","borderWidth"],_dataElementOptions:["backgroundColor","borderColor","borderWidth","pointStyle"],initialize:function(chart,datasetIndex){var me=this;me.chart=chart,me.index=datasetIndex,me.linkScales(),me.addElements(),me._type=me.getMeta().type},updateIndex:function(datasetIndex){this.index=datasetIndex},linkScales:function(){var meta=this.getMeta(),chart=this.chart,scales=chart.scales,dataset=this.getDataset(),scalesOpts=chart.options.scales;null!==meta.xAxisID&&meta.xAxisID in scales&&!dataset.xAxisID||(meta.xAxisID=dataset.xAxisID||scalesOpts.xAxes[0].id),null!==meta.yAxisID&&meta.yAxisID in scales&&!dataset.yAxisID||(meta.yAxisID=dataset.yAxisID||scalesOpts.yAxes[0].id)},getDataset:function(){return this.chart.data.datasets[this.index]},getMeta:function(){return this.chart.getDatasetMeta(this.index)},getScaleForId:function(scaleID){return this.chart.scales[scaleID]},_getValueScaleId:function(){return this.getMeta().yAxisID},_getIndexScaleId:function(){return this.getMeta().xAxisID},_getValueScale:function(){return this.getScaleForId(this._getValueScaleId())},_getIndexScale:function(){return this.getScaleForId(this._getIndexScaleId())},reset:function(){this._update(!0)},destroy:function(){this._data&&unlistenArrayEvents(this._data,this)},createMetaDataset:function(){var type=this.datasetElementType;return type&&new type({_chart:this.chart,_datasetIndex:this.index})},createMetaData:function(index){var type=this.dataElementType;return type&&new type({_chart:this.chart,_datasetIndex:this.index,_index:index})},addElements:function(){var i,ilen,meta=this.getMeta(),data=this.getDataset().data||[],metaData=meta.data;for(i=0,ilen=data.length;i<ilen;++i)metaData[i]=metaData[i]||this.createMetaData(i);meta.dataset=meta.dataset||this.createMetaDataset()},addElementAndReset:function(index){var element=this.createMetaData(index);this.getMeta().data.splice(index,0,element),this.updateElement(element,index,!0)},buildOrUpdateElements:function(){var me=this,dataset=me.getDataset(),data=dataset.data||(dataset.data=[]);me._data!==data&&(me._data&&unlistenArrayEvents(me._data,me),data&&Object.isExtensible(data)&&function(array,listener){array._chartjs?array._chartjs.listeners.push(listener):(Object.defineProperty(array,"_chartjs",{configurable:!0,enumerable:!1,value:{listeners:[listener]}}),arrayEvents.forEach(function(key){var method="onData"+key.charAt(0).toUpperCase()+key.slice(1),base=array[key];Object.defineProperty(array,key,{configurable:!0,enumerable:!1,value:function(){var args=Array.prototype.slice.call(arguments),res=base.apply(this,args);return helpers$1.each(array._chartjs.listeners,function(object){"function"==typeof object[method]&&object[method].apply(object,args)}),res}})}))}(data,me),me._data=data),me.resyncElements()},_configure:function(){this._config=helpers$1.merge({},[this.chart.options.datasets[this._type],this.getDataset()],{merger:function(key,target,source){"_meta"!==key&&"data"!==key&&helpers$1._merger(key,target,source)}})},_update:function(reset){this._configure(),this._cachedDataOpts=null,this.update(reset)},update:helpers$1.noop,transition:function(easingValue){for(var meta=this.getMeta(),elements=meta.data||[],ilen=elements.length,i=0;i<ilen;++i)elements[i].transition(easingValue);meta.dataset&&meta.dataset.transition(easingValue)},draw:function(){var meta=this.getMeta(),elements=meta.data||[],ilen=elements.length,i=0;for(meta.dataset&&meta.dataset.draw();i<ilen;++i)elements[i].draw()},getStyle:function(index){var style,meta=this.getMeta(),dataset=meta.dataset;return this._configure(),!1!==(style=dataset&&void 0===index?this._resolveDatasetElementOptions(dataset||{}):(index=index||0,this._resolveDataElementOptions(meta.data[index]||{},index))).fill&&null!==style.fill||(style.backgroundColor=style.borderColor),style},_resolveDatasetElementOptions:function(element,hover){var i,ilen,key,readKey,me=this,chart=me.chart,datasetOpts=me._config,custom=element.custom||{},options=chart.options.elements[me.datasetElementType.prototype._type]||{},elementOptions=me._datasetElementOptions,values={},context={chart:chart,dataset:me.getDataset(),datasetIndex:me.index,hover:hover};for(i=0,ilen=elementOptions.length;i<ilen;++i)key=elementOptions[i],readKey=hover?"hover"+key.charAt(0).toUpperCase()+key.slice(1):key,values[key]=resolve([custom[readKey],datasetOpts[readKey],options[readKey]],context);return values},_resolveDataElementOptions:function(element,index){var me=this,custom=element&&element.custom,cached=me._cachedDataOpts;if(cached&&!custom)return cached;var keys,i,ilen,key,chart=me.chart,datasetOpts=me._config,options=chart.options.elements[me.dataElementType.prototype._type]||{},elementOptions=me._dataElementOptions,values={},context={chart:chart,dataIndex:index,dataset:me.getDataset(),datasetIndex:me.index},info={cacheable:!custom};if(custom=custom||{},helpers$1.isArray(elementOptions))for(i=0,ilen=elementOptions.length;i<ilen;++i)values[key=elementOptions[i]]=resolve([custom[key],datasetOpts[key],options[key]],context,index,info);else for(i=0,ilen=(keys=Object.keys(elementOptions)).length;i<ilen;++i)values[key=keys[i]]=resolve([custom[key],datasetOpts[elementOptions[key]],datasetOpts[key],options[key]],context,index,info);return info.cacheable&&(me._cachedDataOpts=Object.freeze(values)),values},removeHoverStyle:function(element){helpers$1.merge(element._model,element.$previousStyle||{}),delete element.$previousStyle},setHoverStyle:function(element){var dataset=this.chart.data.datasets[element._datasetIndex],index=element._index,custom=element.custom||{},model=element._model,getHoverColor=helpers$1.getHoverColor;element.$previousStyle={backgroundColor:model.backgroundColor,borderColor:model.borderColor,borderWidth:model.borderWidth},model.backgroundColor=resolve([custom.hoverBackgroundColor,dataset.hoverBackgroundColor,getHoverColor(model.backgroundColor)],void 0,index),model.borderColor=resolve([custom.hoverBorderColor,dataset.hoverBorderColor,getHoverColor(model.borderColor)],void 0,index),model.borderWidth=resolve([custom.hoverBorderWidth,dataset.hoverBorderWidth,model.borderWidth],void 0,index)},_removeDatasetHoverStyle:function(){var element=this.getMeta().dataset;element&&this.removeHoverStyle(element)},_setDatasetHoverStyle:function(){var i,ilen,key,keys,hoverOptions,model,element=this.getMeta().dataset,prev={};if(element){for(model=element._model,hoverOptions=this._resolveDatasetElementOptions(element,!0),i=0,ilen=(keys=Object.keys(hoverOptions)).length;i<ilen;++i)prev[key=keys[i]]=model[key],model[key]=hoverOptions[key];element.$previousStyle=prev}},resyncElements:function(){var meta=this.getMeta(),data=this.getDataset().data,numMeta=meta.data.length,numData=data.length;numData<numMeta?meta.data.splice(numData,numMeta-numData):numMeta<numData&&this.insertElements(numMeta,numData-numMeta)},insertElements:function(start,count){for(var i=0;i<count;++i)this.addElementAndReset(start+i)},onDataPush:function(){var count=arguments.length;this.insertElements(this.getDataset().data.length-count,count)},onDataPop:function(){this.getMeta().data.pop()},onDataShift:function(){this.getMeta().data.shift()},onDataSplice:function(start,count){this.getMeta().data.splice(start,count),this.insertElements(start,arguments.length-2)},onDataUnshift:function(){this.insertElements(0,arguments.length)}}),DatasetController.extend=helpers$1.inherits;var core_datasetController=DatasetController,TAU=2*Math.PI;function clipArc(ctx,arc){var startAngle=arc.startAngle,endAngle=arc.endAngle,pixelMargin=arc.pixelMargin,angleMargin=pixelMargin/arc.outerRadius,x=arc.x,y=arc.y;ctx.beginPath(),ctx.arc(x,y,arc.outerRadius,startAngle-angleMargin,endAngle+angleMargin),arc.innerRadius>pixelMargin?(angleMargin=pixelMargin/arc.innerRadius,ctx.arc(x,y,arc.innerRadius-pixelMargin,endAngle+angleMargin,startAngle-angleMargin,!0)):ctx.arc(x,y,pixelMargin,endAngle+Math.PI/2,startAngle-Math.PI/2),ctx.closePath(),ctx.clip()}function drawBorder(ctx,vm,arc){var inner="inner"===vm.borderAlign;inner?(ctx.lineWidth=2*vm.borderWidth,ctx.lineJoin="round"):(ctx.lineWidth=vm.borderWidth,ctx.lineJoin="bevel"),arc.fullCircles&&function(ctx,vm,arc,inner){var i,endAngle=arc.endAngle;for(inner&&(arc.endAngle=arc.startAngle+TAU,clipArc(ctx,arc),arc.endAngle=endAngle,arc.endAngle===arc.startAngle&&arc.fullCircles&&(arc.endAngle+=TAU,arc.fullCircles--)),ctx.beginPath(),ctx.arc(arc.x,arc.y,arc.innerRadius,arc.startAngle+TAU,arc.startAngle,!0),i=0;i<arc.fullCircles;++i)ctx.stroke();for(ctx.beginPath(),ctx.arc(arc.x,arc.y,vm.outerRadius,arc.startAngle,arc.startAngle+TAU),i=0;i<arc.fullCircles;++i)ctx.stroke()}(ctx,vm,arc,inner),inner&&clipArc(ctx,arc),ctx.beginPath(),ctx.arc(arc.x,arc.y,vm.outerRadius,arc.startAngle,arc.endAngle),ctx.arc(arc.x,arc.y,arc.innerRadius,arc.endAngle,arc.startAngle,!0),ctx.closePath(),ctx.stroke()}core_defaults._set("global",{elements:{arc:{backgroundColor:core_defaults.global.defaultColor,borderColor:"#fff",borderWidth:2,borderAlign:"center"}}});var element_arc=core_element.extend({_type:"arc",inLabelRange:function(mouseX){var vm=this._view;return!!vm&&Math.pow(mouseX-vm.x,2)<Math.pow(vm.radius+vm.hoverRadius,2)},inRange:function(chartX,chartY){var vm=this._view;if(vm){for(var pointRelativePosition=helpers$1.getAngleFromPoint(vm,{x:chartX,y:chartY}),angle=pointRelativePosition.angle,distance=pointRelativePosition.distance,startAngle=vm.startAngle,endAngle=vm.endAngle;endAngle<startAngle;)endAngle+=TAU;for(;endAngle<angle;)angle-=TAU;for(;angle<startAngle;)angle+=TAU;var betweenAngles=startAngle<=angle&&angle<=endAngle,withinRadius=distance>=vm.innerRadius&&distance<=vm.outerRadius;return betweenAngles&&withinRadius}return!1},getCenterPoint:function(){var vm=this._view,halfAngle=(vm.startAngle+vm.endAngle)/2,halfRadius=(vm.innerRadius+vm.outerRadius)/2;return{x:vm.x+Math.cos(halfAngle)*halfRadius,y:vm.y+Math.sin(halfAngle)*halfRadius}},getArea:function(){var vm=this._view;return Math.PI*((vm.endAngle-vm.startAngle)/(2*Math.PI))*(Math.pow(vm.outerRadius,2)-Math.pow(vm.innerRadius,2))},tooltipPosition:function(){var vm=this._view,centreAngle=vm.startAngle+(vm.endAngle-vm.startAngle)/2,rangeFromCentre=(vm.outerRadius-vm.innerRadius)/2+vm.innerRadius;return{x:vm.x+Math.cos(centreAngle)*rangeFromCentre,y:vm.y+Math.sin(centreAngle)*rangeFromCentre}},draw:function(){var i,ctx=this._chart.ctx,vm=this._view,pixelMargin="inner"===vm.borderAlign?.33:0,arc={x:vm.x,y:vm.y,innerRadius:vm.innerRadius,outerRadius:Math.max(vm.outerRadius-pixelMargin,0),pixelMargin:pixelMargin,startAngle:vm.startAngle,endAngle:vm.endAngle,fullCircles:Math.floor(vm.circumference/TAU)};if(ctx.save(),ctx.fillStyle=vm.backgroundColor,ctx.strokeStyle=vm.borderColor,arc.fullCircles){for(arc.endAngle=arc.startAngle+TAU,ctx.beginPath(),ctx.arc(arc.x,arc.y,arc.outerRadius,arc.startAngle,arc.endAngle),ctx.arc(arc.x,arc.y,arc.innerRadius,arc.endAngle,arc.startAngle,!0),ctx.closePath(),i=0;i<arc.fullCircles;++i)ctx.fill();arc.endAngle=arc.startAngle+vm.circumference%TAU}ctx.beginPath(),ctx.arc(arc.x,arc.y,arc.outerRadius,arc.startAngle,arc.endAngle),ctx.arc(arc.x,arc.y,arc.innerRadius,arc.endAngle,arc.startAngle,!0),ctx.closePath(),ctx.fill(),vm.borderWidth&&drawBorder(ctx,vm,arc),ctx.restore()}}),valueOrDefault$1=helpers$1.valueOrDefault,defaultColor=core_defaults.global.defaultColor;core_defaults._set("global",{elements:{line:{tension:.4,backgroundColor:defaultColor,borderWidth:3,borderColor:defaultColor,borderCapStyle:"butt",borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",capBezierPoints:!0,fill:!0}}});var element_line=core_element.extend({_type:"line",draw:function(){var index,previous,currentVM,me=this,vm=me._view,ctx=me._chart.ctx,spanGaps=vm.spanGaps,points=me._children.slice(),globalDefaults=core_defaults.global,globalOptionLineElements=globalDefaults.elements.line,lastDrawnIndex=-1,closePath=me._loop;if(points.length){if(me._loop){for(index=0;index<points.length;++index)if(previous=helpers$1.previousItem(points,index),!points[index]._view.skip&&previous._view.skip){points=points.slice(index).concat(points.slice(0,index)),closePath=spanGaps;break}closePath&&points.push(points[0])}for(ctx.save(),ctx.lineCap=vm.borderCapStyle||globalOptionLineElements.borderCapStyle,ctx.setLineDash&&ctx.setLineDash(vm.borderDash||globalOptionLineElements.borderDash),ctx.lineDashOffset=valueOrDefault$1(vm.borderDashOffset,globalOptionLineElements.borderDashOffset),ctx.lineJoin=vm.borderJoinStyle||globalOptionLineElements.borderJoinStyle,ctx.lineWidth=valueOrDefault$1(vm.borderWidth,globalOptionLineElements.borderWidth),ctx.strokeStyle=vm.borderColor||globalDefaults.defaultColor,ctx.beginPath(),(currentVM=points[0]._view).skip||(ctx.moveTo(currentVM.x,currentVM.y),lastDrawnIndex=0),index=1;index<points.length;++index)currentVM=points[index]._view,previous=-1===lastDrawnIndex?helpers$1.previousItem(points,index):points[lastDrawnIndex],currentVM.skip||(lastDrawnIndex!==index-1&&!spanGaps||-1===lastDrawnIndex?ctx.moveTo(currentVM.x,currentVM.y):helpers$1.canvas.lineTo(ctx,previous._view,currentVM),lastDrawnIndex=index);closePath&&ctx.closePath(),ctx.stroke(),ctx.restore()}}}),valueOrDefault$2=helpers$1.valueOrDefault,defaultColor$1=core_defaults.global.defaultColor;function xRange(mouseX){var vm=this._view;return!!vm&&Math.abs(mouseX-vm.x)<vm.radius+vm.hitRadius}core_defaults._set("global",{elements:{point:{radius:3,pointStyle:"circle",backgroundColor:defaultColor$1,borderColor:defaultColor$1,borderWidth:1,hitRadius:1,hoverRadius:4,hoverBorderWidth:1}}});var element_point=core_element.extend({_type:"point",inRange:function(mouseX,mouseY){var vm=this._view;return!!vm&&Math.pow(mouseX-vm.x,2)+Math.pow(mouseY-vm.y,2)<Math.pow(vm.hitRadius+vm.radius,2)},inLabelRange:xRange,inXRange:xRange,inYRange:function(mouseY){var vm=this._view;return!!vm&&Math.abs(mouseY-vm.y)<vm.radius+vm.hitRadius},getCenterPoint:function(){var vm=this._view;return{x:vm.x,y:vm.y}},getArea:function(){return Math.PI*Math.pow(this._view.radius,2)},tooltipPosition:function(){var vm=this._view;return{x:vm.x,y:vm.y,padding:vm.radius+vm.borderWidth}},draw:function(chartArea){var vm=this._view,ctx=this._chart.ctx,pointStyle=vm.pointStyle,rotation=vm.rotation,radius=vm.radius,x=vm.x,y=vm.y,globalDefaults=core_defaults.global,defaultColor=globalDefaults.defaultColor;vm.skip||void 0!==chartArea&&!helpers$1.canvas._isPointInArea(vm,chartArea)||(ctx.strokeStyle=vm.borderColor||defaultColor,ctx.lineWidth=valueOrDefault$2(vm.borderWidth,globalDefaults.elements.point.borderWidth),ctx.fillStyle=vm.backgroundColor||defaultColor,helpers$1.canvas.drawPoint(ctx,pointStyle,radius,x,y,rotation))}}),defaultColor$2=core_defaults.global.defaultColor;function isVertical(vm){return vm&&void 0!==vm.width}function getBarBounds(vm){var x1,x2,y1,y2,half;return y2=isVertical(vm)?(half=vm.width/2,x1=vm.x-half,x2=vm.x+half,y1=Math.min(vm.y,vm.base),Math.max(vm.y,vm.base)):(half=vm.height/2,x1=Math.min(vm.x,vm.base),x2=Math.max(vm.x,vm.base),y1=vm.y-half,vm.y+half),{left:x1,top:y1,right:x2,bottom:y2}}function swap(orig,v1,v2){return orig===v1?v2:orig===v2?v1:orig}function parseBorderWidth(vm,maxW,maxH){var t,r,b,l,value=vm.borderWidth,skip=function(vm){var edge=vm.borderSkipped,res={};return edge&&(vm.horizontal?vm.base>vm.x&&(edge=swap(edge,"left","right")):vm.base<vm.y&&(edge=swap(edge,"bottom","top")),res[edge]=!0),res}(vm);return helpers$1.isObject(value)?(t=+value.top||0,r=+value.right||0,b=+value.bottom||0,l=+value.left||0):t=r=b=l=+value||0,{t:skip.top||t<0?0:maxH<t?maxH:t,r:skip.right||r<0?0:maxW<r?maxW:r,b:skip.bottom||b<0?0:maxH<b?maxH:b,l:skip.left||l<0?0:maxW<l?maxW:l}}function inRange(vm,x,y){var skipX=null===x,skipY=null===y,bounds=!(!vm||skipX&&skipY)&&getBarBounds(vm);return bounds&&(skipX||x>=bounds.left&&x<=bounds.right)&&(skipY||y>=bounds.top&&y<=bounds.bottom)}core_defaults._set("global",{elements:{rectangle:{backgroundColor:defaultColor$2,borderColor:defaultColor$2,borderSkipped:"bottom",borderWidth:0}}});var element_rectangle=core_element.extend({_type:"rectangle",draw:function(){var ctx=this._chart.ctx,vm=this._view,rects=function(vm){var bounds=getBarBounds(vm),width=bounds.right-bounds.left,height=bounds.bottom-bounds.top,border=parseBorderWidth(vm,width/2,height/2);return{outer:{x:bounds.left,y:bounds.top,w:width,h:height},inner:{x:bounds.left+border.l,y:bounds.top+border.t,w:width-border.l-border.r,h:height-border.t-border.b}}}(vm),outer=rects.outer,inner=rects.inner;ctx.fillStyle=vm.backgroundColor,ctx.fillRect(outer.x,outer.y,outer.w,outer.h),outer.w===inner.w&&outer.h===inner.h||(ctx.save(),ctx.beginPath(),ctx.rect(outer.x,outer.y,outer.w,outer.h),ctx.clip(),ctx.fillStyle=vm.borderColor,ctx.rect(inner.x,inner.y,inner.w,inner.h),ctx.fill("evenodd"),ctx.restore())},height:function(){var vm=this._view;return vm.base-vm.y},inRange:function(mouseX,mouseY){return inRange(this._view,mouseX,mouseY)},inLabelRange:function(mouseX,mouseY){var vm=this._view;return isVertical(vm)?inRange(vm,mouseX,null):inRange(vm,null,mouseY)},inXRange:function(mouseX){return inRange(this._view,mouseX,null)},inYRange:function(mouseY){return inRange(this._view,null,mouseY)},getCenterPoint:function(){var x,y,vm=this._view;return y=isVertical(vm)?(x=vm.x,(vm.y+vm.base)/2):(x=(vm.x+vm.base)/2,vm.y),{x:x,y:y}},getArea:function(){var vm=this._view;return isVertical(vm)?vm.width*Math.abs(vm.y-vm.base):vm.height*Math.abs(vm.x-vm.base)},tooltipPosition:function(){var vm=this._view;return{x:vm.x,y:vm.y}}}),elements={},Arc=element_arc,Line=element_line,Point=element_point,Rectangle=element_rectangle;elements.Arc=Arc,elements.Line=Line,elements.Point=Point,elements.Rectangle=Rectangle;var deprecated=helpers$1._deprecated,valueOrDefault$3=helpers$1.valueOrDefault;function computeFitCategoryTraits(index,ruler,options){var size,ratio,thickness=options.barThickness,count=ruler.stackCount,curr=ruler.pixels[index],min=helpers$1.isNullOrUndef(thickness)?function(scale,pixels){var prev,curr,i,ilen,min=scale._length;for(i=1,ilen=pixels.length;i<ilen;++i)min=Math.min(min,Math.abs(pixels[i]-pixels[i-1]));for(i=0,ilen=scale.getTicks().length;i<ilen;++i)curr=scale.getPixelForTick(i),min=0<i?Math.min(min,Math.abs(curr-prev)):min,prev=curr;return min}(ruler.scale,ruler.pixels):-1;return ratio=helpers$1.isNullOrUndef(thickness)?(size=min*options.categoryPercentage,options.barPercentage):(size=thickness*count,1),{chunk:size/count,ratio:ratio,start:curr-size/2}}core_defaults._set("bar",{hover:{mode:"label"},scales:{xAxes:[{type:"category",offset:!0,gridLines:{offsetGridLines:!0}}],yAxes:[{type:"linear"}]}}),core_defaults._set("global",{datasets:{bar:{categoryPercentage:.8,barPercentage:.9}}});var controller_bar=core_datasetController.extend({dataElementType:elements.Rectangle,_dataElementOptions:["backgroundColor","borderColor","borderSkipped","borderWidth","barPercentage","barThickness","categoryPercentage","maxBarThickness","minBarLength"],initialize:function(){var meta,scaleOpts,me=this;core_datasetController.prototype.initialize.apply(me,arguments),(meta=me.getMeta()).stack=me.getDataset().stack,meta.bar=!0,scaleOpts=me._getIndexScale().options,deprecated("bar chart",scaleOpts.barPercentage,"scales.[x/y]Axes.barPercentage","dataset.barPercentage"),deprecated("bar chart",scaleOpts.barThickness,"scales.[x/y]Axes.barThickness","dataset.barThickness"),deprecated("bar chart",scaleOpts.categoryPercentage,"scales.[x/y]Axes.categoryPercentage","dataset.categoryPercentage"),deprecated("bar chart",me._getValueScale().options.minBarLength,"scales.[x/y]Axes.minBarLength","dataset.minBarLength"),deprecated("bar chart",scaleOpts.maxBarThickness,"scales.[x/y]Axes.maxBarThickness","dataset.maxBarThickness")},update:function(reset){var i,ilen,rects=this.getMeta().data;for(this._ruler=this.getRuler(),i=0,ilen=rects.length;i<ilen;++i)this.updateElement(rects[i],i,reset)},updateElement:function(rectangle,index,reset){var me=this,meta=me.getMeta(),dataset=me.getDataset(),options=me._resolveDataElementOptions(rectangle,index);rectangle._xScale=me.getScaleForId(meta.xAxisID),rectangle._yScale=me.getScaleForId(meta.yAxisID),rectangle._datasetIndex=me.index,rectangle._index=index,rectangle._model={backgroundColor:options.backgroundColor,borderColor:options.borderColor,borderSkipped:options.borderSkipped,borderWidth:options.borderWidth,datasetLabel:dataset.label,label:me.chart.data.labels[index]},helpers$1.isArray(dataset.data[index])&&(rectangle._model.borderSkipped=null),me._updateElementGeometry(rectangle,index,reset,options),rectangle.pivot()},_updateElementGeometry:function(rectangle,index,reset,options){var me=this,model=rectangle._model,vscale=me._getValueScale(),base=vscale.getBasePixel(),horizontal=vscale.isHorizontal(),ruler=me._ruler||me.getRuler(),vpixels=me.calculateBarValuePixels(me.index,index,options),ipixels=me.calculateBarIndexPixels(me.index,index,ruler,options);model.horizontal=horizontal,model.base=reset?base:vpixels.base,model.x=horizontal?reset?base:vpixels.head:ipixels.center,model.y=horizontal?ipixels.center:reset?base:vpixels.head,model.height=horizontal?ipixels.size:void 0,model.width=horizontal?void 0:ipixels.size},_getStacks:function(last){var i,meta,scale=this._getIndexScale(),metasets=scale._getMatchingVisibleMetas(this._type),stacked=scale.options.stacked,ilen=metasets.length,stacks=[];for(i=0;i<ilen&&(meta=metasets[i],(!1===stacked||-1===stacks.indexOf(meta.stack)||void 0===stacked&&void 0===meta.stack)&&stacks.push(meta.stack),meta.index!==last);++i);return stacks},getStackCount:function(){return this._getStacks().length},getStackIndex:function(datasetIndex,name){var stacks=this._getStacks(datasetIndex),index=void 0!==name?stacks.indexOf(name):-1;return-1===index?stacks.length-1:index},getRuler:function(){var i,ilen,scale=this._getIndexScale(),pixels=[];for(i=0,ilen=this.getMeta().data.length;i<ilen;++i)pixels.push(scale.getPixelForValue(null,i,this.index));return{pixels:pixels,start:scale._startPixel,end:scale._endPixel,stackCount:this.getStackCount(),scale:scale}},calculateBarValuePixels:function(datasetIndex,index,options){var i,imeta,ivalue,base,head,size,stackLength,chart=this.chart,scale=this._getValueScale(),isHorizontal=scale.isHorizontal(),datasets=chart.data.datasets,metasets=scale._getMatchingVisibleMetas(this._type),value=scale._parseValue(datasets[datasetIndex].data[index]),minBarLength=options.minBarLength,stacked=scale.options.stacked,stack=this.getMeta().stack,start=void 0===value.start?0:0<=value.max&&0<=value.min?value.min:value.max,length=void 0===value.start?value.end:0<=value.max&&0<=value.min?value.max-value.min:value.min-value.max,ilen=metasets.length;if(stacked||void 0===stacked&&void 0!==stack)for(i=0;i<ilen&&(imeta=metasets[i]).index!==datasetIndex;++i)imeta.stack===stack&&(ivalue=void 0===(stackLength=scale._parseValue(datasets[imeta.index].data[index])).start?stackLength.end:0<=stackLength.min&&0<=stackLength.max?stackLength.max:stackLength.min,(value.min<0&&ivalue<0||0<=value.max&&0<ivalue)&&(start+=ivalue));return base=scale.getPixelForValue(start),size=(head=scale.getPixelForValue(start+length))-base,void 0!==minBarLength&&Math.abs(size)<minBarLength&&(size=minBarLength,head=0<=length&&!isHorizontal||length<0&&isHorizontal?base-minBarLength:base+minBarLength),{size:size,base:base,head:head,center:head+size/2}},calculateBarIndexPixels:function(datasetIndex,index,ruler,options){var range="flex"===options.barThickness?function(index,ruler,options){var start,pixels=ruler.pixels,curr=pixels[index],prev=0<index?pixels[index-1]:null,next=index<pixels.length-1?pixels[index+1]:null,percent=options.categoryPercentage;return null===prev&&(prev=curr-(null===next?ruler.end-ruler.start:next-curr)),null===next&&(next=curr+curr-prev),start=curr-(curr-Math.min(prev,next))/2*percent,{chunk:Math.abs(next-prev)/2*percent/ruler.stackCount,ratio:options.barPercentage,start:start}}(index,ruler,options):computeFitCategoryTraits(index,ruler,options),stackIndex=this.getStackIndex(datasetIndex,this.getMeta().stack),center=range.start+range.chunk*stackIndex+range.chunk/2,size=Math.min(valueOrDefault$3(options.maxBarThickness,1/0),range.chunk*range.ratio);return{base:center-size/2,head:center+size/2,center:center,size:size}},draw:function(){var chart=this.chart,scale=this._getValueScale(),rects=this.getMeta().data,dataset=this.getDataset(),ilen=rects.length,i=0;for(helpers$1.canvas.clipArea(chart.ctx,chart.chartArea);i<ilen;++i){var val=scale._parseValue(dataset.data[i]);isNaN(val.min)||isNaN(val.max)||rects[i].draw()}helpers$1.canvas.unclipArea(chart.ctx)},_resolveDataElementOptions:function(){var values=helpers$1.extend({},core_datasetController.prototype._resolveDataElementOptions.apply(this,arguments)),indexOpts=this._getIndexScale().options,valueOpts=this._getValueScale().options;return values.barPercentage=valueOrDefault$3(indexOpts.barPercentage,values.barPercentage),values.barThickness=valueOrDefault$3(indexOpts.barThickness,values.barThickness),values.categoryPercentage=valueOrDefault$3(indexOpts.categoryPercentage,values.categoryPercentage),values.maxBarThickness=valueOrDefault$3(indexOpts.maxBarThickness,values.maxBarThickness),values.minBarLength=valueOrDefault$3(valueOpts.minBarLength,values.minBarLength),values}}),valueOrDefault$4=helpers$1.valueOrDefault,resolve$1=helpers$1.options.resolve;core_defaults._set("bubble",{hover:{mode:"single"},scales:{xAxes:[{type:"linear",position:"bottom",id:"x-axis-0"}],yAxes:[{type:"linear",position:"left",id:"y-axis-0"}]},tooltips:{callbacks:{title:function(){return""},label:function(item,data){var datasetLabel=data.datasets[item.datasetIndex].label||"",dataPoint=data.datasets[item.datasetIndex].data[item.index];return datasetLabel+": ("+item.xLabel+", "+item.yLabel+", "+dataPoint.r+")"}}}});var controller_bubble=core_datasetController.extend({dataElementType:elements.Point,_dataElementOptions:["backgroundColor","borderColor","borderWidth","hoverBackgroundColor","hoverBorderColor","hoverBorderWidth","hoverRadius","hitRadius","pointStyle","rotation"],update:function(reset){var me=this,points=me.getMeta().data;helpers$1.each(points,function(point,index){me.updateElement(point,index,reset)})},updateElement:function(point,index,reset){var me=this,meta=me.getMeta(),custom=point.custom||{},xScale=me.getScaleForId(meta.xAxisID),yScale=me.getScaleForId(meta.yAxisID),options=me._resolveDataElementOptions(point,index),data=me.getDataset().data[index],dsIndex=me.index,x=reset?xScale.getPixelForDecimal(.5):xScale.getPixelForValue("object"==typeof data?data:NaN,index,dsIndex),y=reset?yScale.getBasePixel():yScale.getPixelForValue(data,index,dsIndex);point._xScale=xScale,point._yScale=yScale,point._options=options,point._datasetIndex=dsIndex,point._index=index,point._model={backgroundColor:options.backgroundColor,borderColor:options.borderColor,borderWidth:options.borderWidth,hitRadius:options.hitRadius,pointStyle:options.pointStyle,rotation:options.rotation,radius:reset?0:options.radius,skip:custom.skip||isNaN(x)||isNaN(y),x:x,y:y},point.pivot()},setHoverStyle:function(point){var model=point._model,options=point._options,getHoverColor=helpers$1.getHoverColor;point.$previousStyle={backgroundColor:model.backgroundColor,borderColor:model.borderColor,borderWidth:model.borderWidth,radius:model.radius},model.backgroundColor=valueOrDefault$4(options.hoverBackgroundColor,getHoverColor(options.backgroundColor)),model.borderColor=valueOrDefault$4(options.hoverBorderColor,getHoverColor(options.borderColor)),model.borderWidth=valueOrDefault$4(options.hoverBorderWidth,options.borderWidth),model.radius=options.radius+options.hoverRadius},_resolveDataElementOptions:function(point,index){var me=this,chart=me.chart,dataset=me.getDataset(),custom=point.custom||{},data=dataset.data[index]||{},values=core_datasetController.prototype._resolveDataElementOptions.apply(me,arguments),context={chart:chart,dataIndex:index,dataset:dataset,datasetIndex:me.index};return me._cachedDataOpts===values&&(values=helpers$1.extend({},values)),values.radius=resolve$1([custom.radius,data.r,me._config.radius,chart.options.elements.point.radius],context,index),values}}),valueOrDefault$5=helpers$1.valueOrDefault,PI$1=Math.PI,DOUBLE_PI$1=2*PI$1,HALF_PI$1=PI$1/2;core_defaults._set("doughnut",{animation:{animateRotate:!0,animateScale:!1},hover:{mode:"single"},legendCallback:function(chart){var i,ilen,listItem,list=document.createElement("ul"),data=chart.data,datasets=data.datasets,labels=data.labels;if(list.setAttribute("class",chart.id+"-legend"),datasets.length)for(ilen=datasets[i=0].data.length;i<ilen;++i)(listItem=list.appendChild(document.createElement("li"))).appendChild(document.createElement("span")).style.backgroundColor=datasets[0].backgroundColor[i],labels[i]&&listItem.appendChild(document.createTextNode(labels[i]));return list.outerHTML},legend:{labels:{generateLabels:function(chart){var data=chart.data;return data.labels.length&&data.datasets.length?data.labels.map(function(label,i){var meta=chart.getDatasetMeta(0),style=meta.controller.getStyle(i);return{text:label,fillStyle:style.backgroundColor,strokeStyle:style.borderColor,lineWidth:style.borderWidth,hidden:isNaN(data.datasets[0].data[i])||meta.data[i].hidden,index:i}}):[]}},onClick:function(e,legendItem){var i,ilen,meta,index=legendItem.index,chart=this.chart;for(i=0,ilen=(chart.data.datasets||[]).length;i<ilen;++i)(meta=chart.getDatasetMeta(i)).data[index]&&(meta.data[index].hidden=!meta.data[index].hidden);chart.update()}},cutoutPercentage:50,rotation:-HALF_PI$1,circumference:DOUBLE_PI$1,tooltips:{callbacks:{title:function(){return""},label:function(tooltipItem,data){var dataLabel=data.labels[tooltipItem.index],value=": "+data.datasets[tooltipItem.datasetIndex].data[tooltipItem.index];return helpers$1.isArray(dataLabel)?(dataLabel=dataLabel.slice())[0]+=value:dataLabel+=value,dataLabel}}}});var controller_doughnut=core_datasetController.extend({dataElementType:elements.Arc,linkScales:helpers$1.noop,_dataElementOptions:["backgroundColor","borderColor","borderWidth","borderAlign","hoverBackgroundColor","hoverBorderColor","hoverBorderWidth"],getRingIndex:function(datasetIndex){for(var ringIndex=0,j=0;j<datasetIndex;++j)this.chart.isDatasetVisible(j)&&++ringIndex;return ringIndex},update:function(reset){var maxWidth,maxHeight,i,ilen,me=this,chart=me.chart,chartArea=chart.chartArea,opts=chart.options,ratioX=1,ratioY=1,offsetX=0,offsetY=0,meta=me.getMeta(),arcs=meta.data,cutout=opts.cutoutPercentage/100||0,circumference=opts.circumference,chartWeight=me._getRingWeight(me.index);if(circumference<DOUBLE_PI$1){var startAngle=opts.rotation%DOUBLE_PI$1,endAngle=(startAngle+=PI$1<=startAngle?-DOUBLE_PI$1:startAngle<-PI$1?DOUBLE_PI$1:0)+circumference,startX=Math.cos(startAngle),startY=Math.sin(startAngle),endX=Math.cos(endAngle),endY=Math.sin(endAngle),contains0=startAngle<=0&&0<=endAngle||DOUBLE_PI$1<=endAngle,contains90=startAngle<=HALF_PI$1&&HALF_PI$1<=endAngle||DOUBLE_PI$1+HALF_PI$1<=endAngle,contains270=startAngle<=-HALF_PI$1&&-HALF_PI$1<=endAngle||PI$1+HALF_PI$1<=endAngle,minX=startAngle===-PI$1||PI$1<=endAngle?-1:Math.min(startX,startX*cutout,endX,endX*cutout),minY=contains270?-1:Math.min(startY,startY*cutout,endY,endY*cutout),maxX=contains0?1:Math.max(startX,startX*cutout,endX,endX*cutout),maxY=contains90?1:Math.max(startY,startY*cutout,endY,endY*cutout);ratioX=(maxX-minX)/2,ratioY=(maxY-minY)/2,offsetX=-(maxX+minX)/2,offsetY=-(maxY+minY)/2}for(i=0,ilen=arcs.length;i<ilen;++i)arcs[i]._options=me._resolveDataElementOptions(arcs[i],i);for(chart.borderWidth=me.getMaxBorderWidth(),maxWidth=(chartArea.right-chartArea.left-chart.borderWidth)/ratioX,maxHeight=(chartArea.bottom-chartArea.top-chart.borderWidth)/ratioY,chart.outerRadius=Math.max(Math.min(maxWidth,maxHeight)/2,0),chart.innerRadius=Math.max(chart.outerRadius*cutout,0),chart.radiusLength=(chart.outerRadius-chart.innerRadius)/(me._getVisibleDatasetWeightTotal()||1),chart.offsetX=offsetX*chart.outerRadius,chart.offsetY=offsetY*chart.outerRadius,meta.total=me.calculateTotal(),me.outerRadius=chart.outerRadius-chart.radiusLength*me._getRingWeightOffset(me.index),me.innerRadius=Math.max(me.outerRadius-chart.radiusLength*chartWeight,0),i=0,ilen=arcs.length;i<ilen;++i)me.updateElement(arcs[i],i,reset)},updateElement:function(arc,index,reset){var me=this,chart=me.chart,chartArea=chart.chartArea,opts=chart.options,animationOpts=opts.animation,centerX=(chartArea.left+chartArea.right)/2,centerY=(chartArea.top+chartArea.bottom)/2,startAngle=opts.rotation,endAngle=opts.rotation,dataset=me.getDataset(),circumference=reset&&animationOpts.animateRotate?0:arc.hidden?0:me.calculateCircumference(dataset.data[index])*(opts.circumference/DOUBLE_PI$1),innerRadius=reset&&animationOpts.animateScale?0:me.innerRadius,outerRadius=reset&&animationOpts.animateScale?0:me.outerRadius,options=arc._options||{};helpers$1.extend(arc,{_datasetIndex:me.index,_index:index,_model:{backgroundColor:options.backgroundColor,borderColor:options.borderColor,borderWidth:options.borderWidth,borderAlign:options.borderAlign,x:centerX+chart.offsetX,y:centerY+chart.offsetY,startAngle:startAngle,endAngle:endAngle,circumference:circumference,outerRadius:outerRadius,innerRadius:innerRadius,label:helpers$1.valueAtIndexOrDefault(dataset.label,index,chart.data.labels[index])}});var model=arc._model;reset&&animationOpts.animateRotate||(model.startAngle=0===index?opts.rotation:me.getMeta().data[index-1]._model.endAngle,model.endAngle=model.startAngle+model.circumference),arc.pivot()},calculateTotal:function(){var value,dataset=this.getDataset(),meta=this.getMeta(),total=0;return helpers$1.each(meta.data,function(element,index){value=dataset.data[index],isNaN(value)||element.hidden||(total+=Math.abs(value))}),total},calculateCircumference:function(value){var total=this.getMeta().total;return 0<total&&!isNaN(value)?DOUBLE_PI$1*(Math.abs(value)/total):0},getMaxBorderWidth:function(arcs){var i,ilen,meta,arc,controller,options,borderWidth,hoverWidth,max=0,chart=this.chart;if(!arcs)for(i=0,ilen=chart.data.datasets.length;i<ilen;++i)if(chart.isDatasetVisible(i)){arcs=(meta=chart.getDatasetMeta(i)).data,i!==this.index&&(controller=meta.controller);break}if(!arcs)return 0;for(i=0,ilen=arcs.length;i<ilen;++i)arc=arcs[i],"inner"!==(options=controller?(controller._configure(),controller._resolveDataElementOptions(arc,i)):arc._options).borderAlign&&(max=(max=max<(borderWidth=options.borderWidth)?borderWidth:max)<(hoverWidth=options.hoverBorderWidth)?hoverWidth:max);return max},setHoverStyle:function(arc){var model=arc._model,options=arc._options,getHoverColor=helpers$1.getHoverColor;arc.$previousStyle={backgroundColor:model.backgroundColor,borderColor:model.borderColor,borderWidth:model.borderWidth},model.backgroundColor=valueOrDefault$5(options.hoverBackgroundColor,getHoverColor(options.backgroundColor)),model.borderColor=valueOrDefault$5(options.hoverBorderColor,getHoverColor(options.borderColor)),model.borderWidth=valueOrDefault$5(options.hoverBorderWidth,options.borderWidth)},_getRingWeightOffset:function(datasetIndex){for(var ringWeightOffset=0,i=0;i<datasetIndex;++i)this.chart.isDatasetVisible(i)&&(ringWeightOffset+=this._getRingWeight(i));return ringWeightOffset},_getRingWeight:function(dataSetIndex){return Math.max(valueOrDefault$5(this.chart.data.datasets[dataSetIndex].weight,1),0)},_getVisibleDatasetWeightTotal:function(){return this._getRingWeightOffset(this.chart.data.datasets.length)}});core_defaults._set("horizontalBar",{hover:{mode:"index",axis:"y"},scales:{xAxes:[{type:"linear",position:"bottom"}],yAxes:[{type:"category",position:"left",offset:!0,gridLines:{offsetGridLines:!0}}]},elements:{rectangle:{borderSkipped:"left"}},tooltips:{mode:"index",axis:"y"}}),core_defaults._set("global",{datasets:{horizontalBar:{categoryPercentage:.8,barPercentage:.9}}});var controller_horizontalBar=controller_bar.extend({_getValueScaleId:function(){return this.getMeta().xAxisID},_getIndexScaleId:function(){return this.getMeta().yAxisID}}),valueOrDefault$6=helpers$1.valueOrDefault,resolve$2=helpers$1.options.resolve,isPointInArea=helpers$1.canvas._isPointInArea;function scaleClip(scale,halfBorderWidth){var tickOpts=scale&&scale.options.ticks||{},reverse=tickOpts.reverse,min=void 0===tickOpts.min?halfBorderWidth:0,max=void 0===tickOpts.max?halfBorderWidth:0;return{start:reverse?max:min,end:reverse?min:max}}core_defaults._set("line",{showLines:!0,spanGaps:!1,hover:{mode:"label"},scales:{xAxes:[{type:"category",id:"x-axis-0"}],yAxes:[{type:"linear",id:"y-axis-0"}]}});var controller_line=core_datasetController.extend({datasetElementType:elements.Line,dataElementType:elements.Point,_datasetElementOptions:["backgroundColor","borderCapStyle","borderColor","borderDash","borderDashOffset","borderJoinStyle","borderWidth","cubicInterpolationMode","fill"],_dataElementOptions:{backgroundColor:"pointBackgroundColor",borderColor:"pointBorderColor",borderWidth:"pointBorderWidth",hitRadius:"pointHitRadius",hoverBackgroundColor:"pointHoverBackgroundColor",hoverBorderColor:"pointHoverBorderColor",hoverBorderWidth:"pointHoverBorderWidth",hoverRadius:"pointHoverRadius",pointStyle:"pointStyle",radius:"pointRadius",rotation:"pointRotation"},update:function(reset){var i,ilen,me=this,meta=me.getMeta(),line=meta.dataset,points=meta.data||[],options=me.chart.options,config=me._config,showLine=me._showLine=valueOrDefault$6(config.showLine,options.showLines);for(me._xScale=me.getScaleForId(meta.xAxisID),me._yScale=me.getScaleForId(meta.yAxisID),showLine&&(void 0!==config.tension&&void 0===config.lineTension&&(config.lineTension=config.tension),line._scale=me._yScale,line._datasetIndex=me.index,line._children=points,line._model=me._resolveDatasetElementOptions(line),line.pivot()),i=0,ilen=points.length;i<ilen;++i)me.updateElement(points[i],i,reset);for(showLine&&0!==line._model.tension&&me.updateBezierControlPoints(),i=0,ilen=points.length;i<ilen;++i)points[i].pivot()},updateElement:function(point,index,reset){var x,y,me=this,meta=me.getMeta(),custom=point.custom||{},dataset=me.getDataset(),datasetIndex=me.index,value=dataset.data[index],xScale=me._xScale,yScale=me._yScale,lineModel=meta.dataset._model,options=me._resolveDataElementOptions(point,index);x=xScale.getPixelForValue("object"==typeof value?value:NaN,index,datasetIndex),y=reset?yScale.getBasePixel():me.calculatePointY(value,index,datasetIndex),point._xScale=xScale,point._yScale=yScale,point._options=options,point._datasetIndex=datasetIndex,point._index=index,point._model={x:x,y:y,skip:custom.skip||isNaN(x)||isNaN(y),radius:options.radius,pointStyle:options.pointStyle,rotation:options.rotation,backgroundColor:options.backgroundColor,borderColor:options.borderColor,borderWidth:options.borderWidth,tension:valueOrDefault$6(custom.tension,lineModel?lineModel.tension:0),steppedLine:!!lineModel&&lineModel.steppedLine,hitRadius:options.hitRadius}},_resolveDatasetElementOptions:function(element){var me=this,config=me._config,custom=element.custom||{},options=me.chart.options,lineOptions=options.elements.line,values=core_datasetController.prototype._resolveDatasetElementOptions.apply(me,arguments);return values.spanGaps=valueOrDefault$6(config.spanGaps,options.spanGaps),values.tension=valueOrDefault$6(config.lineTension,lineOptions.tension),values.steppedLine=resolve$2([custom.steppedLine,config.steppedLine,lineOptions.stepped]),values.clip=function(value){var t,r,b,l;return helpers$1.isObject(value)?(t=value.top,r=value.right,b=value.bottom,l=value.left):t=r=b=l=value,{top:t,right:r,bottom:b,left:l}}(valueOrDefault$6(config.clip,function(xScale,yScale,borderWidth){var halfBorderWidth=borderWidth/2,x=scaleClip(xScale,halfBorderWidth),y=scaleClip(yScale,halfBorderWidth);return{top:y.end,right:x.end,bottom:y.start,left:x.start}}(me._xScale,me._yScale,values.borderWidth))),values},calculatePointY:function(value,index,datasetIndex){var i,ds,dsMeta,stackedRightValue,rightValue,metasets,ilen,chart=this.chart,yScale=this._yScale,sumPos=0,sumNeg=0;if(yScale.options.stacked){for(rightValue=+yScale.getRightValue(value),ilen=(metasets=chart._getSortedVisibleDatasetMetas()).length,i=0;i<ilen&&(dsMeta=metasets[i]).index!==datasetIndex;++i)ds=chart.data.datasets[dsMeta.index],"line"===dsMeta.type&&dsMeta.yAxisID===yScale.id&&((stackedRightValue=+yScale.getRightValue(ds.data[index]))<0?sumNeg+=stackedRightValue||0:sumPos+=stackedRightValue||0);return rightValue<0?yScale.getPixelForValue(sumNeg+rightValue):yScale.getPixelForValue(sumPos+rightValue)}return yScale.getPixelForValue(value)},updateBezierControlPoints:function(){var i,ilen,model,controlPoints,chart=this.chart,meta=this.getMeta(),lineModel=meta.dataset._model,area=chart.chartArea,points=meta.data||[];function capControlPoint(pt,min,max){return Math.max(Math.min(pt,max),min)}if(lineModel.spanGaps&&(points=points.filter(function(pt){return!pt._model.skip})),"monotone"===lineModel.cubicInterpolationMode)helpers$1.splineCurveMonotone(points);else for(i=0,ilen=points.length;i<ilen;++i)model=points[i]._model,controlPoints=helpers$1.splineCurve(helpers$1.previousItem(points,i)._model,model,helpers$1.nextItem(points,i)._model,lineModel.tension),model.controlPointPreviousX=controlPoints.previous.x,model.controlPointPreviousY=controlPoints.previous.y,model.controlPointNextX=controlPoints.next.x,model.controlPointNextY=controlPoints.next.y;if(chart.options.elements.line.capBezierPoints)for(i=0,ilen=points.length;i<ilen;++i)model=points[i]._model,isPointInArea(model,area)&&(0<i&&isPointInArea(points[i-1]._model,area)&&(model.controlPointPreviousX=capControlPoint(model.controlPointPreviousX,area.left,area.right),model.controlPointPreviousY=capControlPoint(model.controlPointPreviousY,area.top,area.bottom)),i<points.length-1&&isPointInArea(points[i+1]._model,area)&&(model.controlPointNextX=capControlPoint(model.controlPointNextX,area.left,area.right),model.controlPointNextY=capControlPoint(model.controlPointNextY,area.top,area.bottom)))},draw:function(){var clip,chart=this.chart,meta=this.getMeta(),points=meta.data||[],area=chart.chartArea,canvas=chart.canvas,i=0,ilen=points.length;for(this._showLine&&(clip=meta.dataset._model.clip,helpers$1.canvas.clipArea(chart.ctx,{left:!1===clip.left?0:area.left-clip.left,right:!1===clip.right?canvas.width:area.right+clip.right,top:!1===clip.top?0:area.top-clip.top,bottom:!1===clip.bottom?canvas.height:area.bottom+clip.bottom}),meta.dataset.draw(),helpers$1.canvas.unclipArea(chart.ctx));i<ilen;++i)points[i].draw(area)},setHoverStyle:function(point){var model=point._model,options=point._options,getHoverColor=helpers$1.getHoverColor;point.$previousStyle={backgroundColor:model.backgroundColor,borderColor:model.borderColor,borderWidth:model.borderWidth,radius:model.radius},model.backgroundColor=valueOrDefault$6(options.hoverBackgroundColor,getHoverColor(options.backgroundColor)),model.borderColor=valueOrDefault$6(options.hoverBorderColor,getHoverColor(options.borderColor)),model.borderWidth=valueOrDefault$6(options.hoverBorderWidth,options.borderWidth),model.radius=valueOrDefault$6(options.hoverRadius,options.radius)}}),resolve$3=helpers$1.options.resolve;core_defaults._set("polarArea",{scale:{type:"radialLinear",angleLines:{display:!1},gridLines:{circular:!0},pointLabels:{display:!1},ticks:{beginAtZero:!0}},animation:{animateRotate:!0,animateScale:!0},startAngle:-.5*Math.PI,legendCallback:function(chart){var i,ilen,listItem,list=document.createElement("ul"),data=chart.data,datasets=data.datasets,labels=data.labels;if(list.setAttribute("class",chart.id+"-legend"),datasets.length)for(ilen=datasets[i=0].data.length;i<ilen;++i)(listItem=list.appendChild(document.createElement("li"))).appendChild(document.createElement("span")).style.backgroundColor=datasets[0].backgroundColor[i],labels[i]&&listItem.appendChild(document.createTextNode(labels[i]));return list.outerHTML},legend:{labels:{generateLabels:function(chart){var data=chart.data;return data.labels.length&&data.datasets.length?data.labels.map(function(label,i){var meta=chart.getDatasetMeta(0),style=meta.controller.getStyle(i);return{text:label,fillStyle:style.backgroundColor,strokeStyle:style.borderColor,lineWidth:style.borderWidth,hidden:isNaN(data.datasets[0].data[i])||meta.data[i].hidden,index:i}}):[]}},onClick:function(e,legendItem){var i,ilen,meta,index=legendItem.index,chart=this.chart;for(i=0,ilen=(chart.data.datasets||[]).length;i<ilen;++i)(meta=chart.getDatasetMeta(i)).data[index].hidden=!meta.data[index].hidden;chart.update()}},tooltips:{callbacks:{title:function(){return""},label:function(item,data){return data.labels[item.index]+": "+item.yLabel}}}});var controller_polarArea=core_datasetController.extend({dataElementType:elements.Arc,linkScales:helpers$1.noop,_dataElementOptions:["backgroundColor","borderColor","borderWidth","borderAlign","hoverBackgroundColor","hoverBorderColor","hoverBorderWidth"],_getIndexScaleId:function(){return this.chart.scale.id},_getValueScaleId:function(){return this.chart.scale.id},update:function(reset){var i,ilen,angle,me=this,dataset=me.getDataset(),meta=me.getMeta(),start=me.chart.options.startAngle||0,starts=me._starts=[],angles=me._angles=[],arcs=meta.data;for(me._updateRadius(),meta.count=me.countVisibleElements(),i=0,ilen=dataset.data.length;i<ilen;i++)starts[i]=start,angle=me._computeAngle(i),start+=angles[i]=angle;for(i=0,ilen=arcs.length;i<ilen;++i)arcs[i]._options=me._resolveDataElementOptions(arcs[i],i),me.updateElement(arcs[i],i,reset)},_updateRadius:function(){var me=this,chart=me.chart,chartArea=chart.chartArea,opts=chart.options,minSize=Math.min(chartArea.right-chartArea.left,chartArea.bottom-chartArea.top);chart.outerRadius=Math.max(minSize/2,0),chart.innerRadius=Math.max(opts.cutoutPercentage?chart.outerRadius/100*opts.cutoutPercentage:1,0),chart.radiusLength=(chart.outerRadius-chart.innerRadius)/chart.getVisibleDatasetCount(),me.outerRadius=chart.outerRadius-chart.radiusLength*me.index,me.innerRadius=me.outerRadius-chart.radiusLength},updateElement:function(arc,index,reset){var me=this,chart=me.chart,dataset=me.getDataset(),opts=chart.options,animationOpts=opts.animation,scale=chart.scale,labels=chart.data.labels,centerX=scale.xCenter,centerY=scale.yCenter,datasetStartAngle=opts.startAngle,distance=arc.hidden?0:scale.getDistanceFromCenterForValue(dataset.data[index]),startAngle=me._starts[index],endAngle=startAngle+(arc.hidden?0:me._angles[index]),resetRadius=animationOpts.animateScale?0:scale.getDistanceFromCenterForValue(dataset.data[index]),options=arc._options||{};helpers$1.extend(arc,{_datasetIndex:me.index,_index:index,_scale:scale,_model:{backgroundColor:options.backgroundColor,borderColor:options.borderColor,borderWidth:options.borderWidth,borderAlign:options.borderAlign,x:centerX,y:centerY,innerRadius:0,outerRadius:reset?resetRadius:distance,startAngle:reset&&animationOpts.animateRotate?datasetStartAngle:startAngle,endAngle:reset&&animationOpts.animateRotate?datasetStartAngle:endAngle,label:helpers$1.valueAtIndexOrDefault(labels,index,labels[index])}}),arc.pivot()},countVisibleElements:function(){var dataset=this.getDataset(),meta=this.getMeta(),count=0;return helpers$1.each(meta.data,function(element,index){isNaN(dataset.data[index])||element.hidden||count++}),count},setHoverStyle:function(arc){var model=arc._model,options=arc._options,getHoverColor=helpers$1.getHoverColor,valueOrDefault=helpers$1.valueOrDefault;arc.$previousStyle={backgroundColor:model.backgroundColor,borderColor:model.borderColor,borderWidth:model.borderWidth},model.backgroundColor=valueOrDefault(options.hoverBackgroundColor,getHoverColor(options.backgroundColor)),model.borderColor=valueOrDefault(options.hoverBorderColor,getHoverColor(options.borderColor)),model.borderWidth=valueOrDefault(options.hoverBorderWidth,options.borderWidth)},_computeAngle:function(index){var me=this,count=this.getMeta().count,dataset=me.getDataset(),meta=me.getMeta();if(isNaN(dataset.data[index])||meta.data[index].hidden)return 0;var context={chart:me.chart,dataIndex:index,dataset:dataset,datasetIndex:me.index};return resolve$3([me.chart.options.elements.arc.angle,2*Math.PI/count],context,index)}});core_defaults._set("pie",helpers$1.clone(core_defaults.doughnut)),core_defaults._set("pie",{cutoutPercentage:0});var controller_pie=controller_doughnut,valueOrDefault$7=helpers$1.valueOrDefault;core_defaults._set("radar",{spanGaps:!1,scale:{type:"radialLinear"},elements:{line:{fill:"start",tension:0}}});var controller_radar=core_datasetController.extend({datasetElementType:elements.Line,dataElementType:elements.Point,linkScales:helpers$1.noop,_datasetElementOptions:["backgroundColor","borderWidth","borderColor","borderCapStyle","borderDash","borderDashOffset","borderJoinStyle","fill"],_dataElementOptions:{backgroundColor:"pointBackgroundColor",borderColor:"pointBorderColor",borderWidth:"pointBorderWidth",hitRadius:"pointHitRadius",hoverBackgroundColor:"pointHoverBackgroundColor",hoverBorderColor:"pointHoverBorderColor",hoverBorderWidth:"pointHoverBorderWidth",hoverRadius:"pointHoverRadius",pointStyle:"pointStyle",radius:"pointRadius",rotation:"pointRotation"},_getIndexScaleId:function(){return this.chart.scale.id},_getValueScaleId:function(){return this.chart.scale.id},update:function(reset){var i,ilen,me=this,meta=me.getMeta(),line=meta.dataset,points=meta.data||[],scale=me.chart.scale,config=me._config;for(void 0!==config.tension&&void 0===config.lineTension&&(config.lineTension=config.tension),line._scale=scale,line._datasetIndex=me.index,line._children=points,line._loop=!0,line._model=me._resolveDatasetElementOptions(line),line.pivot(),i=0,ilen=points.length;i<ilen;++i)me.updateElement(points[i],i,reset);for(me.updateBezierControlPoints(),i=0,ilen=points.length;i<ilen;++i)points[i].pivot()},updateElement:function(point,index,reset){var me=this,custom=point.custom||{},dataset=me.getDataset(),scale=me.chart.scale,pointPosition=scale.getPointPositionForValue(index,dataset.data[index]),options=me._resolveDataElementOptions(point,index),lineModel=me.getMeta().dataset._model,x=reset?scale.xCenter:pointPosition.x,y=reset?scale.yCenter:pointPosition.y;point._scale=scale,point._options=options,point._datasetIndex=me.index,point._index=index,point._model={x:x,y:y,skip:custom.skip||isNaN(x)||isNaN(y),radius:options.radius,pointStyle:options.pointStyle,rotation:options.rotation,backgroundColor:options.backgroundColor,borderColor:options.borderColor,borderWidth:options.borderWidth,tension:valueOrDefault$7(custom.tension,lineModel?lineModel.tension:0),hitRadius:options.hitRadius}},_resolveDatasetElementOptions:function(){var config=this._config,options=this.chart.options,values=core_datasetController.prototype._resolveDatasetElementOptions.apply(this,arguments);return values.spanGaps=valueOrDefault$7(config.spanGaps,options.spanGaps),values.tension=valueOrDefault$7(config.lineTension,options.elements.line.tension),values},updateBezierControlPoints:function(){var i,ilen,model,controlPoints,meta=this.getMeta(),area=this.chart.chartArea,points=meta.data||[];function capControlPoint(pt,min,max){return Math.max(Math.min(pt,max),min)}for(meta.dataset._model.spanGaps&&(points=points.filter(function(pt){return!pt._model.skip})),i=0,ilen=points.length;i<ilen;++i)model=points[i]._model,controlPoints=helpers$1.splineCurve(helpers$1.previousItem(points,i,!0)._model,model,helpers$1.nextItem(points,i,!0)._model,model.tension),model.controlPointPreviousX=capControlPoint(controlPoints.previous.x,area.left,area.right),model.controlPointPreviousY=capControlPoint(controlPoints.previous.y,area.top,area.bottom),model.controlPointNextX=capControlPoint(controlPoints.next.x,area.left,area.right),model.controlPointNextY=capControlPoint(controlPoints.next.y,area.top,area.bottom)},setHoverStyle:function(point){var model=point._model,options=point._options,getHoverColor=helpers$1.getHoverColor;point.$previousStyle={backgroundColor:model.backgroundColor,borderColor:model.borderColor,borderWidth:model.borderWidth,radius:model.radius},model.backgroundColor=valueOrDefault$7(options.hoverBackgroundColor,getHoverColor(options.backgroundColor)),model.borderColor=valueOrDefault$7(options.hoverBorderColor,getHoverColor(options.borderColor)),model.borderWidth=valueOrDefault$7(options.hoverBorderWidth,options.borderWidth),model.radius=valueOrDefault$7(options.hoverRadius,options.radius)}});core_defaults._set("scatter",{hover:{mode:"single"},scales:{xAxes:[{id:"x-axis-1",type:"linear",position:"bottom"}],yAxes:[{id:"y-axis-1",type:"linear",position:"left"}]},tooltips:{callbacks:{title:function(){return""},label:function(item){return"("+item.xLabel+", "+item.yLabel+")"}}}}),core_defaults._set("global",{datasets:{scatter:{showLine:!1}}});var controllers={bar:controller_bar,bubble:controller_bubble,doughnut:controller_doughnut,horizontalBar:controller_horizontalBar,line:controller_line,polarArea:controller_polarArea,pie:controller_pie,radar:controller_radar,scatter:controller_line};function getRelativePosition(e,chart){return e.native?{x:e.x,y:e.y}:helpers$1.getRelativePosition(e,chart)}function parseVisibleItems(chart,handler){var metadata,i,j,ilen,jlen,element,metasets=chart._getSortedVisibleDatasetMetas();for(i=0,ilen=metasets.length;i<ilen;++i)for(j=0,jlen=(metadata=metasets[i].data).length;j<jlen;++j)(element=metadata[j])._view.skip||handler(element)}function getIntersectItems(chart,position){var elements=[];return parseVisibleItems(chart,function(element){element.inRange(position.x,position.y)&&elements.push(element)}),elements}function getNearestItems(chart,position,intersect,distanceMetric){var minDistance=Number.POSITIVE_INFINITY,nearestItems=[];return parseVisibleItems(chart,function(element){if(!intersect||element.inRange(position.x,position.y)){var center=element.getCenterPoint(),distance=distanceMetric(position,center);distance<minDistance?(nearestItems=[element],minDistance=distance):distance===minDistance&&nearestItems.push(element)}}),nearestItems}function getDistanceMetricForAxis(axis){var useX=-1!==axis.indexOf("x"),useY=-1!==axis.indexOf("y");return function(pt1,pt2){var deltaX=useX?Math.abs(pt1.x-pt2.x):0,deltaY=useY?Math.abs(pt1.y-pt2.y):0;return Math.sqrt(Math.pow(deltaX,2)+Math.pow(deltaY,2))}}function indexMode(chart,e,options){var position=getRelativePosition(e,chart);options.axis=options.axis||"x";var distanceMetric=getDistanceMetricForAxis(options.axis),items=options.intersect?getIntersectItems(chart,position):getNearestItems(chart,position,!1,distanceMetric),elements=[];return items.length?(chart._getSortedVisibleDatasetMetas().forEach(function(meta){var element=meta.data[items[0]._index];element&&!element._view.skip&&elements.push(element)}),elements):[]}var core_interaction={modes:{single:function(chart,e){var position=getRelativePosition(e,chart),elements=[];return parseVisibleItems(chart,function(element){if(element.inRange(position.x,position.y))return elements.push(element),elements}),elements.slice(0,1)},label:indexMode,index:indexMode,dataset:function(chart,e,options){var position=getRelativePosition(e,chart);options.axis=options.axis||"xy";var distanceMetric=getDistanceMetricForAxis(options.axis),items=options.intersect?getIntersectItems(chart,position):getNearestItems(chart,position,!1,distanceMetric);return 0<items.length&&(items=chart.getDatasetMeta(items[0]._datasetIndex).data),items},"x-axis":function(chart,e){return indexMode(chart,e,{intersect:!1})},point:function(chart,e){return getIntersectItems(chart,getRelativePosition(e,chart))},nearest:function(chart,e,options){var position=getRelativePosition(e,chart);options.axis=options.axis||"xy";var distanceMetric=getDistanceMetricForAxis(options.axis);return getNearestItems(chart,position,options.intersect,distanceMetric)},x:function(chart,e,options){var position=getRelativePosition(e,chart),items=[],intersectsItem=!1;return parseVisibleItems(chart,function(element){element.inXRange(position.x)&&items.push(element),element.inRange(position.x,position.y)&&(intersectsItem=!0)}),options.intersect&&!intersectsItem&&(items=[]),items},y:function(chart,e,options){var position=getRelativePosition(e,chart),items=[],intersectsItem=!1;return parseVisibleItems(chart,function(element){element.inYRange(position.y)&&items.push(element),element.inRange(position.x,position.y)&&(intersectsItem=!0)}),options.intersect&&!intersectsItem&&(items=[]),items}}},extend=helpers$1.extend;function filterByPosition(array,position){return helpers$1.where(array,function(v){return v.pos===position})}function sortByWeight(array,reverse){return array.sort(function(a,b){var v0=reverse?b:a,v1=reverse?a:b;return v0.weight===v1.weight?v0.index-v1.index:v0.weight-v1.weight})}function buildLayoutBoxes(boxes){var layoutBoxes=function(boxes){var i,ilen,box,layoutBoxes=[];for(i=0,ilen=(boxes||[]).length;i<ilen;++i)box=boxes[i],layoutBoxes.push({index:i,box:box,pos:box.position,horizontal:box.isHorizontal(),weight:box.weight});return layoutBoxes}(boxes),left=sortByWeight(filterByPosition(layoutBoxes,"left"),!0),right=sortByWeight(filterByPosition(layoutBoxes,"right")),top=sortByWeight(filterByPosition(layoutBoxes,"top"),!0),bottom=sortByWeight(filterByPosition(layoutBoxes,"bottom"));return{leftAndTop:left.concat(top),rightAndBottom:right.concat(bottom),chartArea:filterByPosition(layoutBoxes,"chartArea"),vertical:left.concat(right),horizontal:top.concat(bottom)}}function getCombinedMax(maxPadding,chartArea,a,b){return Math.max(maxPadding[a],chartArea[a])+Math.max(maxPadding[b],chartArea[b])}function updateDims(chartArea,params,layout){var newWidth,newHeight,box=layout.box,maxPadding=chartArea.maxPadding;if(layout.size&&(chartArea[layout.pos]-=layout.size),layout.size=layout.horizontal?box.height:box.width,chartArea[layout.pos]+=layout.size,box.getPadding){var boxPadding=box.getPadding();maxPadding.top=Math.max(maxPadding.top,boxPadding.top),maxPadding.left=Math.max(maxPadding.left,boxPadding.left),maxPadding.bottom=Math.max(maxPadding.bottom,boxPadding.bottom),maxPadding.right=Math.max(maxPadding.right,boxPadding.right)}if(newWidth=params.outerWidth-getCombinedMax(maxPadding,chartArea,"left","right"),newHeight=params.outerHeight-getCombinedMax(maxPadding,chartArea,"top","bottom"),newWidth!==chartArea.w||newHeight!==chartArea.h)return chartArea.w=newWidth,chartArea.h=newHeight,layout.horizontal?newWidth!==chartArea.w:newHeight!==chartArea.h}function getMargins(horizontal,chartArea){var maxPadding=chartArea.maxPadding;function marginForPositions(positions){var margin={left:0,top:0,right:0,bottom:0};return positions.forEach(function(pos){margin[pos]=Math.max(chartArea[pos],maxPadding[pos])}),margin}return marginForPositions(horizontal?["left","right"]:["top","bottom"])}function fitBoxes(boxes,chartArea,params){var i,ilen,layout,box,refit,changed,refitBoxes=[];for(i=0,ilen=boxes.length;i<ilen;++i)(box=(layout=boxes[i]).box).update(layout.width||chartArea.w,layout.height||chartArea.h,getMargins(layout.horizontal,chartArea)),updateDims(chartArea,params,layout)&&(changed=!0,refitBoxes.length&&(refit=!0)),box.fullWidth||refitBoxes.push(layout);return refit&&fitBoxes(refitBoxes,chartArea,params)||changed}function placeBoxes(boxes,chartArea,params){var i,ilen,layout,box,userPadding=params.padding,x=chartArea.x,y=chartArea.y;for(i=0,ilen=boxes.length;i<ilen;++i)box=(layout=boxes[i]).box,layout.horizontal?(box.left=box.fullWidth?userPadding.left:chartArea.left,box.right=box.fullWidth?params.outerWidth-userPadding.right:chartArea.left+chartArea.w,box.top=y,box.bottom=y+box.height,box.width=box.right-box.left,y=box.bottom):(box.left=x,box.right=x+box.width,box.top=chartArea.top,box.bottom=chartArea.top+chartArea.h,box.height=box.bottom-box.top,x=box.right);chartArea.x=x,chartArea.y=y}core_defaults._set("global",{layout:{padding:{top:0,right:0,bottom:0,left:0}}});var n,core_layouts={defaults:{},addBox:function(chart,item){chart.boxes||(chart.boxes=[]),item.fullWidth=item.fullWidth||!1,item.position=item.position||"top",item.weight=item.weight||0,item._layers=item._layers||function(){return[{z:0,draw:function(){item.draw.apply(item,arguments)}}]},chart.boxes.push(item)},removeBox:function(chart,layoutItem){var index=chart.boxes?chart.boxes.indexOf(layoutItem):-1;-1!==index&&chart.boxes.splice(index,1)},configure:function(chart,item,options){for(var prop,props=["fullWidth","position","weight"],ilen=props.length,i=0;i<ilen;++i)prop=props[i],options.hasOwnProperty(prop)&&(item[prop]=options[prop])},update:function(chart,width,height){if(chart){var layoutOptions=chart.options.layout||{},padding=helpers$1.options.toPadding(layoutOptions.padding),availableWidth=width-padding.width,availableHeight=height-padding.height,boxes=buildLayoutBoxes(chart.boxes),verticalBoxes=boxes.vertical,horizontalBoxes=boxes.horizontal,params=Object.freeze({outerWidth:width,outerHeight:height,padding:padding,availableWidth:availableWidth,vBoxMaxWidth:availableWidth/2/verticalBoxes.length,hBoxMaxHeight:availableHeight/2}),chartArea=extend({maxPadding:extend({},padding),w:availableWidth,h:availableHeight,x:padding.left,y:padding.top},padding);!function(layouts,params){var i,ilen,layout;for(i=0,ilen=layouts.length;i<ilen;++i)(layout=layouts[i]).width=layout.horizontal?layout.box.fullWidth&&params.availableWidth:params.vBoxMaxWidth,layout.height=layout.horizontal&&params.hBoxMaxHeight}(verticalBoxes.concat(horizontalBoxes),params),fitBoxes(verticalBoxes,chartArea,params),fitBoxes(horizontalBoxes,chartArea,params)&&fitBoxes(verticalBoxes,chartArea,params),function(chartArea){var maxPadding=chartArea.maxPadding;function updatePos(pos){var change=Math.max(maxPadding[pos]-chartArea[pos],0);return chartArea[pos]+=change,change}chartArea.y+=updatePos("top"),chartArea.x+=updatePos("left"),updatePos("right"),updatePos("bottom")}(chartArea),placeBoxes(boxes.leftAndTop,chartArea,params),chartArea.x+=chartArea.w,chartArea.y+=chartArea.h,placeBoxes(boxes.rightAndBottom,chartArea,params),chart.chartArea={left:chartArea.left,top:chartArea.top,right:chartArea.left+chartArea.w,bottom:chartArea.top+chartArea.h},helpers$1.each(boxes.chartArea,function(layout){var box=layout.box;extend(box,chart.chartArea),box.update(chartArea.w,chartArea.h)})}}},stylesheet=(n=Object.freeze({__proto__:null,default:"/*\n * DOM element rendering detection\n * https://davidwalsh.name/detect-node-insertion\n */\n@keyframes chartjs-render-animation {\n\tfrom { opacity: 0.99; }\n\tto { opacity: 1; }\n}\n\n.chartjs-render-monitor {\n\tanimation: chartjs-render-animation 0.001s;\n}\n\n/*\n * DOM element resizing detection\n * https://github.com/marcj/css-element-queries\n */\n.chartjs-size-monitor,\n.chartjs-size-monitor-expand,\n.chartjs-size-monitor-shrink {\n\tposition: absolute;\n\tdirection: ltr;\n\tleft: 0;\n\ttop: 0;\n\tright: 0;\n\tbottom: 0;\n\toverflow: hidden;\n\tpointer-events: none;\n\tvisibility: hidden;\n\tz-index: -1;\n}\n\n.chartjs-size-monitor-expand > div {\n\tposition: absolute;\n\twidth: 1000000px;\n\theight: 1000000px;\n\tleft: 0;\n\ttop: 0;\n}\n\n.chartjs-size-monitor-shrink > div {\n\tposition: absolute;\n\twidth: 200%;\n\theight: 200%;\n\tleft: 0;\n\ttop: 0;\n}\n"}))&&n.default||n,EXPANDO_KEY="$chartjs",CSS_SIZE_MONITOR="chartjs-size-monitor",CSS_RENDER_MONITOR="chartjs-render-monitor",CSS_RENDER_ANIMATION="chartjs-render-animation",ANIMATION_START_EVENTS=["animationstart","webkitAnimationStart"],EVENT_TYPES={touchstart:"mousedown",touchmove:"mousemove",touchend:"mouseup",pointerenter:"mouseenter",pointerdown:"mousedown",pointermove:"mousemove",pointerup:"mouseup",pointerleave:"mouseout",pointerout:"mouseout"};function readUsedSize(element,property){var value=helpers$1.getStyle(element,property),matches=value&&value.match(/^(\d+)(\.\d+)?px$/);return matches?Number(matches[1]):void 0}var eventListenerOptions=!!function(){var supports=!1;try{var options=Object.defineProperty({},"passive",{get:function(){supports=!0}});window.addEventListener("e",null,options)}catch(e){}return supports}()&&{passive:!0};function addListener(node,type,listener){node.addEventListener(type,listener,eventListenerOptions)}function removeListener(node,type,listener){node.removeEventListener(type,listener,eventListenerOptions)}function createEvent(type,chart,x,y,nativeEvent){return{type:type,chart:chart,native:nativeEvent||null,x:void 0!==x?x:null,y:void 0!==y?y:null}}function createDiv(cls){var el=document.createElement("div");return el.className=cls||"",el}function addResizeListener(node,listener,chart){var expando=node[EXPANDO_KEY]||(node[EXPANDO_KEY]={}),resizer=expando.resizer=function(handler){var resizer=createDiv(CSS_SIZE_MONITOR),expand=createDiv(CSS_SIZE_MONITOR+"-expand"),shrink=createDiv(CSS_SIZE_MONITOR+"-shrink");function onScroll(){resizer._reset(),handler()}return expand.appendChild(createDiv()),shrink.appendChild(createDiv()),resizer.appendChild(expand),resizer.appendChild(shrink),resizer._reset=function(){expand.scrollLeft=1e6,expand.scrollTop=1e6,shrink.scrollLeft=1e6,shrink.scrollTop=1e6},addListener(expand,"scroll",onScroll.bind(expand,"expand")),addListener(shrink,"scroll",onScroll.bind(shrink,"shrink")),resizer}(function(fn,thisArg){var ticking=!1,args=[];return function(){args=Array.prototype.slice.call(arguments),thisArg=thisArg||this,ticking||(ticking=!0,helpers$1.requestAnimFrame.call(window,function(){ticking=!1,fn.apply(thisArg,args)}))}}(function(){if(expando.resizer){var container=chart.options.maintainAspectRatio&&node.parentNode,w=container?container.clientWidth:0;listener(createEvent("resize",chart)),container&&container.clientWidth<w&&chart.canvas&&listener(createEvent("resize",chart))}}));!function(node,handler){var expando=node[EXPANDO_KEY]||(node[EXPANDO_KEY]={}),proxy=expando.renderProxy=function(e){e.animationName===CSS_RENDER_ANIMATION&&handler()};helpers$1.each(ANIMATION_START_EVENTS,function(type){addListener(node,type,proxy)}),expando.reflow=!!node.offsetParent,node.classList.add(CSS_RENDER_MONITOR)}(node,function(){if(expando.resizer){var container=node.parentNode;container&&container!==resizer.parentNode&&container.insertBefore(resizer,container.firstChild),resizer._reset()}})}function removeResizeListener(node){var expando=node[EXPANDO_KEY]||{},resizer=expando.resizer;delete expando.resizer,function(node){var expando=node[EXPANDO_KEY]||{},proxy=expando.renderProxy;proxy&&(helpers$1.each(ANIMATION_START_EVENTS,function(type){removeListener(node,type,proxy)}),delete expando.renderProxy),node.classList.remove(CSS_RENDER_MONITOR)}(node),resizer&&resizer.parentNode&&resizer.parentNode.removeChild(resizer)}var platform_dom$2={disableCSSInjection:!1,_enabled:"undefined"!=typeof window&&"undefined"!=typeof document,_ensureLoaded:function(canvas){if(!this.disableCSSInjection){var root=canvas.getRootNode?canvas.getRootNode():document;!function(rootNode,css){var expando=rootNode[EXPANDO_KEY]||(rootNode[EXPANDO_KEY]={});if(!expando.containsStyles){expando.containsStyles=!0,css="/* Chart.js */\n"+css;var style=document.createElement("style");style.setAttribute("type","text/css"),style.appendChild(document.createTextNode(css)),rootNode.appendChild(style)}}(root.host?root:document.head,stylesheet)}},acquireContext:function(item,config){"string"==typeof item?item=document.getElementById(item):item.length&&(item=item[0]),item&&item.canvas&&(item=item.canvas);var context=item&&item.getContext&&item.getContext("2d");return context&&context.canvas===item?(this._ensureLoaded(item),function(canvas,config){var style=canvas.style,renderHeight=canvas.getAttribute("height"),renderWidth=canvas.getAttribute("width");if(canvas[EXPANDO_KEY]={initial:{height:renderHeight,width:renderWidth,style:{display:style.display,height:style.height,width:style.width}}},style.display=style.display||"block",null===renderWidth||""===renderWidth){var displayWidth=readUsedSize(canvas,"width");void 0!==displayWidth&&(canvas.width=displayWidth)}if(null===renderHeight||""===renderHeight)if(""===canvas.style.height)canvas.height=canvas.width/(config.options.aspectRatio||2);else{var displayHeight=readUsedSize(canvas,"height");void 0!==displayWidth&&(canvas.height=displayHeight)}}(item,config),context):null},releaseContext:function(context){var canvas=context.canvas;if(canvas[EXPANDO_KEY]){var initial=canvas[EXPANDO_KEY].initial;["height","width"].forEach(function(prop){var value=initial[prop];helpers$1.isNullOrUndef(value)?canvas.removeAttribute(prop):canvas.setAttribute(prop,value)}),helpers$1.each(initial.style||{},function(value,key){canvas.style[key]=value}),canvas.width=canvas.width,delete canvas[EXPANDO_KEY]}},addEventListener:function(chart,type,listener){var canvas=chart.canvas;if("resize"!==type){var expando=listener[EXPANDO_KEY]||(listener[EXPANDO_KEY]={});addListener(canvas,type,(expando.proxies||(expando.proxies={}))[chart.id+"_"+type]=function(event){listener(function(event,chart){var type=EVENT_TYPES[event.type]||event.type,pos=helpers$1.getRelativePosition(event,chart);return createEvent(type,chart,pos.x,pos.y,event)}(event,chart))})}else addResizeListener(canvas,listener,chart)},removeEventListener:function(chart,type,listener){var canvas=chart.canvas;if("resize"!==type){var proxy=((listener[EXPANDO_KEY]||{}).proxies||{})[chart.id+"_"+type];proxy&&removeListener(canvas,type,proxy)}else removeResizeListener(canvas)}};helpers$1.addEvent=addListener,helpers$1.removeEvent=removeListener;var implementation=platform_dom$2._enabled?platform_dom$2:{acquireContext:function(item){return item&&item.canvas&&(item=item.canvas),item&&item.getContext("2d")||null}},platform=helpers$1.extend({initialize:function(){},acquireContext:function(){},releaseContext:function(){},addEventListener:function(){},removeEventListener:function(){}},implementation);core_defaults._set("global",{plugins:{}});var core_plugins={_plugins:[],_cacheId:0,register:function(plugins){var p=this._plugins;[].concat(plugins).forEach(function(plugin){-1===p.indexOf(plugin)&&p.push(plugin)}),this._cacheId++},unregister:function(plugins){var p=this._plugins;[].concat(plugins).forEach(function(plugin){var idx=p.indexOf(plugin);-1!==idx&&p.splice(idx,1)}),this._cacheId++},clear:function(){this._plugins=[],this._cacheId++},count:function(){return this._plugins.length},getAll:function(){return this._plugins},notify:function(chart,hook,args){var i,descriptor,plugin,params,method,descriptors=this.descriptors(chart),ilen=descriptors.length;for(i=0;i<ilen;++i)if("function"==typeof(method=(plugin=(descriptor=descriptors[i]).plugin)[hook])&&((params=[chart].concat(args||[])).push(descriptor.options),!1===method.apply(plugin,params)))return!1;return!0},descriptors:function(chart){var cache=chart.$plugins||(chart.$plugins={});if(cache.id===this._cacheId)return cache.descriptors;var plugins=[],descriptors=[],config=chart&&chart.config||{},options=config.options&&config.options.plugins||{};return this._plugins.concat(config.plugins||[]).forEach(function(plugin){if(-1===plugins.indexOf(plugin)){var id=plugin.id,opts=options[id];!1!==opts&&(!0===opts&&(opts=helpers$1.clone(core_defaults.global.plugins[id])),plugins.push(plugin),descriptors.push({plugin:plugin,options:opts||{}}))}}),cache.descriptors=descriptors,cache.id=this._cacheId,descriptors},_invalidate:function(chart){delete chart.$plugins}},core_scaleService={constructors:{},defaults:{},registerScaleType:function(type,scaleConstructor,scaleDefaults){this.constructors[type]=scaleConstructor,this.defaults[type]=helpers$1.clone(scaleDefaults)},getScaleConstructor:function(type){return this.constructors.hasOwnProperty(type)?this.constructors[type]:void 0},getScaleDefaults:function(type){return this.defaults.hasOwnProperty(type)?helpers$1.merge({},[core_defaults.scale,this.defaults[type]]):{}},updateScaleDefaults:function(type,additions){this.defaults.hasOwnProperty(type)&&(this.defaults[type]=helpers$1.extend(this.defaults[type],additions))},addScalesToLayout:function(chart){helpers$1.each(chart.scales,function(scale){scale.fullWidth=scale.options.fullWidth,scale.position=scale.options.position,scale.weight=scale.options.weight,core_layouts.addBox(chart,scale)})}},valueOrDefault$8=helpers$1.valueOrDefault,getRtlHelper=helpers$1.rtl.getRtlAdapter;core_defaults._set("global",{tooltips:{enabled:!0,custom:null,mode:"nearest",position:"average",intersect:!0,backgroundColor:"rgba(0,0,0,0.8)",titleFontStyle:"bold",titleSpacing:2,titleMarginBottom:6,titleFontColor:"#fff",titleAlign:"left",bodySpacing:2,bodyFontColor:"#fff",bodyAlign:"left",footerFontStyle:"bold",footerSpacing:2,footerMarginTop:6,footerFontColor:"#fff",footerAlign:"left",yPadding:6,xPadding:6,caretPadding:2,caretSize:5,cornerRadius:6,multiKeyBackground:"#fff",displayColors:!0,borderColor:"rgba(0,0,0,0)",borderWidth:0,callbacks:{beforeTitle:helpers$1.noop,title:function(tooltipItems,data){var title="",labels=data.labels,labelCount=labels?labels.length:0;if(0<tooltipItems.length){var item=tooltipItems[0];item.label?title=item.label:item.xLabel?title=item.xLabel:0<labelCount&&item.index<labelCount&&(title=labels[item.index])}return title},afterTitle:helpers$1.noop,beforeBody:helpers$1.noop,beforeLabel:helpers$1.noop,label:function(tooltipItem,data){var label=data.datasets[tooltipItem.datasetIndex].label||"";return label&&(label+=": "),helpers$1.isNullOrUndef(tooltipItem.value)?label+=tooltipItem.yLabel:label+=tooltipItem.value,label},labelColor:function(tooltipItem,chart){var view=chart.getDatasetMeta(tooltipItem.datasetIndex).data[tooltipItem.index]._view;return{borderColor:view.borderColor,backgroundColor:view.backgroundColor}},labelTextColor:function(){return this._options.bodyFontColor},afterLabel:helpers$1.noop,afterBody:helpers$1.noop,beforeFooter:helpers$1.noop,footer:helpers$1.noop,afterFooter:helpers$1.noop}}});var positioners={average:function(elements){if(!elements.length)return!1;var i,len,x=0,y=0,count=0;for(i=0,len=elements.length;i<len;++i){var el=elements[i];if(el&&el.hasValue()){var pos=el.tooltipPosition();x+=pos.x,y+=pos.y,++count}}return{x:x/count,y:y/count}},nearest:function(elements,eventPosition){var i,len,nearestElement,x=eventPosition.x,y=eventPosition.y,minDistance=Number.POSITIVE_INFINITY;for(i=0,len=elements.length;i<len;++i){var el=elements[i];if(el&&el.hasValue()){var center=el.getCenterPoint(),d=helpers$1.distanceBetweenPoints(eventPosition,center);d<minDistance&&(minDistance=d,nearestElement=el)}}if(nearestElement){var tp=nearestElement.tooltipPosition();x=tp.x,y=tp.y}return{x:x,y:y}}};function pushOrConcat(base,toPush){return toPush&&(helpers$1.isArray(toPush)?Array.prototype.push.apply(base,toPush):base.push(toPush)),base}function splitNewlines(str){return("string"==typeof str||str instanceof String)&&-1<str.indexOf("\n")?str.split("\n"):str}function getBaseModel(tooltipOpts){var globalDefaults=core_defaults.global;return{xPadding:tooltipOpts.xPadding,yPadding:tooltipOpts.yPadding,xAlign:tooltipOpts.xAlign,yAlign:tooltipOpts.yAlign,rtl:tooltipOpts.rtl,textDirection:tooltipOpts.textDirection,bodyFontColor:tooltipOpts.bodyFontColor,_bodyFontFamily:valueOrDefault$8(tooltipOpts.bodyFontFamily,globalDefaults.defaultFontFamily),_bodyFontStyle:valueOrDefault$8(tooltipOpts.bodyFontStyle,globalDefaults.defaultFontStyle),_bodyAlign:tooltipOpts.bodyAlign,bodyFontSize:valueOrDefault$8(tooltipOpts.bodyFontSize,globalDefaults.defaultFontSize),bodySpacing:tooltipOpts.bodySpacing,titleFontColor:tooltipOpts.titleFontColor,_titleFontFamily:valueOrDefault$8(tooltipOpts.titleFontFamily,globalDefaults.defaultFontFamily),_titleFontStyle:valueOrDefault$8(tooltipOpts.titleFontStyle,globalDefaults.defaultFontStyle),titleFontSize:valueOrDefault$8(tooltipOpts.titleFontSize,globalDefaults.defaultFontSize),_titleAlign:tooltipOpts.titleAlign,titleSpacing:tooltipOpts.titleSpacing,titleMarginBottom:tooltipOpts.titleMarginBottom,footerFontColor:tooltipOpts.footerFontColor,_footerFontFamily:valueOrDefault$8(tooltipOpts.footerFontFamily,globalDefaults.defaultFontFamily),_footerFontStyle:valueOrDefault$8(tooltipOpts.footerFontStyle,globalDefaults.defaultFontStyle),footerFontSize:valueOrDefault$8(tooltipOpts.footerFontSize,globalDefaults.defaultFontSize),_footerAlign:tooltipOpts.footerAlign,footerSpacing:tooltipOpts.footerSpacing,footerMarginTop:tooltipOpts.footerMarginTop,caretSize:tooltipOpts.caretSize,cornerRadius:tooltipOpts.cornerRadius,backgroundColor:tooltipOpts.backgroundColor,opacity:0,legendColorBackground:tooltipOpts.multiKeyBackground,displayColors:tooltipOpts.displayColors,borderColor:tooltipOpts.borderColor,borderWidth:tooltipOpts.borderWidth}}function getTooltipSize(tooltip,model){var ctx=tooltip._chart.ctx,height=2*model.yPadding,width=0,body=model.body,combinedBodyLength=body.reduce(function(count,bodyItem){return count+bodyItem.before.length+bodyItem.lines.length+bodyItem.after.length},0);combinedBodyLength+=model.beforeBody.length+model.afterBody.length;var titleLineCount=model.title.length,footerLineCount=model.footer.length,titleFontSize=model.titleFontSize,bodyFontSize=model.bodyFontSize,footerFontSize=model.footerFontSize;height+=titleLineCount*titleFontSize,height+=titleLineCount?(titleLineCount-1)*model.titleSpacing:0,height+=titleLineCount?model.titleMarginBottom:0,height+=combinedBodyLength*bodyFontSize,height+=combinedBodyLength?(combinedBodyLength-1)*model.bodySpacing:0,height+=footerLineCount?model.footerMarginTop:0,height+=footerLineCount*footerFontSize,height+=footerLineCount?(footerLineCount-1)*model.footerSpacing:0;function maxLineWidth(line){width=Math.max(width,ctx.measureText(line).width+widthPadding)}var widthPadding=0;return ctx.font=helpers$1.fontString(titleFontSize,model._titleFontStyle,model._titleFontFamily),helpers$1.each(model.title,maxLineWidth),ctx.font=helpers$1.fontString(bodyFontSize,model._bodyFontStyle,model._bodyFontFamily),helpers$1.each(model.beforeBody.concat(model.afterBody),maxLineWidth),widthPadding=model.displayColors?bodyFontSize+2:0,helpers$1.each(body,function(bodyItem){helpers$1.each(bodyItem.before,maxLineWidth),helpers$1.each(bodyItem.lines,maxLineWidth),helpers$1.each(bodyItem.after,maxLineWidth)}),widthPadding=0,ctx.font=helpers$1.fontString(footerFontSize,model._footerFontStyle,model._footerFontFamily),helpers$1.each(model.footer,maxLineWidth),{width:width+=2*model.xPadding,height:height}}function getAlignedX(vm,align){return"center"===align?vm.x+vm.width/2:"right"===align?vm.x+vm.width-vm.xPadding:vm.x+vm.xPadding}function getBeforeAfterBodyLines(callback){return pushOrConcat([],splitNewlines(callback))}var exports$4=core_element.extend({initialize:function(){this._model=getBaseModel(this._options),this._lastActive=[]},getTitle:function(){var callbacks=this._options.callbacks,beforeTitle=callbacks.beforeTitle.apply(this,arguments),title=callbacks.title.apply(this,arguments),afterTitle=callbacks.afterTitle.apply(this,arguments),lines=[];return lines=pushOrConcat(lines,splitNewlines(beforeTitle)),lines=pushOrConcat(lines,splitNewlines(title)),lines=pushOrConcat(lines,splitNewlines(afterTitle))},getBeforeBody:function(){return getBeforeAfterBodyLines(this._options.callbacks.beforeBody.apply(this,arguments))},getBody:function(tooltipItems,data){var me=this,callbacks=me._options.callbacks,bodyItems=[];return helpers$1.each(tooltipItems,function(tooltipItem){var bodyItem={before:[],lines:[],after:[]};pushOrConcat(bodyItem.before,splitNewlines(callbacks.beforeLabel.call(me,tooltipItem,data))),pushOrConcat(bodyItem.lines,callbacks.label.call(me,tooltipItem,data)),pushOrConcat(bodyItem.after,splitNewlines(callbacks.afterLabel.call(me,tooltipItem,data))),bodyItems.push(bodyItem)}),bodyItems},getAfterBody:function(){return getBeforeAfterBodyLines(this._options.callbacks.afterBody.apply(this,arguments))},getFooter:function(){var callbacks=this._options.callbacks,beforeFooter=callbacks.beforeFooter.apply(this,arguments),footer=callbacks.footer.apply(this,arguments),afterFooter=callbacks.afterFooter.apply(this,arguments),lines=[];return lines=pushOrConcat(lines,splitNewlines(beforeFooter)),lines=pushOrConcat(lines,splitNewlines(footer)),lines=pushOrConcat(lines,splitNewlines(afterFooter))},update:function(changed){var i,len,element,xScale,yScale,index,datasetIndex,controller,indexScale,valueScale,me=this,opts=me._options,existingModel=me._model,model=me._model=getBaseModel(opts),active=me._active,data=me._data,alignment={xAlign:existingModel.xAlign,yAlign:existingModel.yAlign},backgroundPoint={x:existingModel.x,y:existingModel.y},tooltipSize={width:existingModel.width,height:existingModel.height},tooltipPosition={x:existingModel.caretX,y:existingModel.caretY};if(active.length){model.opacity=1;var labelColors=[],labelTextColors=[];tooltipPosition=positioners[opts.position].call(me,active,me._eventPosition);var tooltipItems=[];for(i=0,len=active.length;i<len;++i)tooltipItems.push((element=active[i],valueScale=indexScale=controller=yScale=xScale=void 0,xScale=element._xScale,yScale=element._yScale||element._scale,index=element._index,datasetIndex=element._datasetIndex,controller=element._chart.getDatasetMeta(datasetIndex).controller,indexScale=controller._getIndexScale(),valueScale=controller._getValueScale(),{xLabel:xScale?xScale.getLabelForIndex(index,datasetIndex):"",yLabel:yScale?yScale.getLabelForIndex(index,datasetIndex):"",label:indexScale?""+indexScale.getLabelForIndex(index,datasetIndex):"",value:valueScale?""+valueScale.getLabelForIndex(index,datasetIndex):"",index:index,datasetIndex:datasetIndex,x:element._model.x,y:element._model.y}));opts.filter&&(tooltipItems=tooltipItems.filter(function(a){return opts.filter(a,data)})),opts.itemSort&&(tooltipItems=tooltipItems.sort(function(a,b){return opts.itemSort(a,b,data)})),helpers$1.each(tooltipItems,function(tooltipItem){labelColors.push(opts.callbacks.labelColor.call(me,tooltipItem,me._chart)),labelTextColors.push(opts.callbacks.labelTextColor.call(me,tooltipItem,me._chart))}),model.title=me.getTitle(tooltipItems,data),model.beforeBody=me.getBeforeBody(tooltipItems,data),model.body=me.getBody(tooltipItems,data),model.afterBody=me.getAfterBody(tooltipItems,data),model.footer=me.getFooter(tooltipItems,data),model.x=tooltipPosition.x,model.y=tooltipPosition.y,model.caretPadding=opts.caretPadding,model.labelColors=labelColors,model.labelTextColors=labelTextColors,model.dataPoints=tooltipItems,backgroundPoint=function(vm,size,alignment,chart){var x=vm.x,y=vm.y,caretSize=vm.caretSize,caretPadding=vm.caretPadding,cornerRadius=vm.cornerRadius,xAlign=alignment.xAlign,yAlign=alignment.yAlign,paddingAndSize=caretSize+caretPadding,radiusAndPadding=cornerRadius+caretPadding;return"right"===xAlign?x-=size.width:"center"===xAlign&&((x-=size.width/2)+size.width>chart.width&&(x=chart.width-size.width),x<0&&(x=0)),"top"===yAlign?y+=paddingAndSize:y-="bottom"===yAlign?size.height+paddingAndSize:size.height/2,"center"===yAlign?"left"===xAlign?x+=paddingAndSize:"right"===xAlign&&(x-=paddingAndSize):"left"===xAlign?x-=radiusAndPadding:"right"===xAlign&&(x+=radiusAndPadding),{x:x,y:y}}(model,tooltipSize=getTooltipSize(this,model),alignment=function(tooltip,size){var lf,rf,olf,orf,yf,model=tooltip._model,chart=tooltip._chart,chartArea=tooltip._chart.chartArea,xAlign="center",yAlign="center";model.y<size.height?yAlign="top":model.y>chart.height-size.height&&(yAlign="bottom");var midX=(chartArea.left+chartArea.right)/2,midY=(chartArea.top+chartArea.bottom)/2;rf="center"===yAlign?(lf=function(x){return x<=midX},function(x){return midX<x}):(lf=function(x){return x<=size.width/2},function(x){return x>=chart.width-size.width/2}),olf=function(x){return x+size.width+model.caretSize+model.caretPadding>chart.width},orf=function(x){return x-size.width-model.caretSize-model.caretPadding<0},yf=function(y){return y<=midY?"top":"bottom"},lf(model.x)?(xAlign="left",olf(model.x)&&(xAlign="center",yAlign=yf(model.y))):rf(model.x)&&(xAlign="right",orf(model.x)&&(xAlign="center",yAlign=yf(model.y)));var opts=tooltip._options;return{xAlign:opts.xAlign?opts.xAlign:xAlign,yAlign:opts.yAlign?opts.yAlign:yAlign}}(this,tooltipSize),me._chart)}else model.opacity=0;return model.xAlign=alignment.xAlign,model.yAlign=alignment.yAlign,model.x=backgroundPoint.x,model.y=backgroundPoint.y,model.width=tooltipSize.width,model.height=tooltipSize.height,model.caretX=tooltipPosition.x,model.caretY=tooltipPosition.y,me._model=model,changed&&opts.custom&&opts.custom.call(me,model),me},drawCaret:function(tooltipPoint,size){var ctx=this._chart.ctx,vm=this._view,caretPosition=this.getCaretPosition(tooltipPoint,size,vm);ctx.lineTo(caretPosition.x1,caretPosition.y1),ctx.lineTo(caretPosition.x2,caretPosition.y2),ctx.lineTo(caretPosition.x3,caretPosition.y3)},getCaretPosition:function(tooltipPoint,size,vm){var x1,x2,x3,y1,y2,y3,caretSize=vm.caretSize,cornerRadius=vm.cornerRadius,xAlign=vm.xAlign,yAlign=vm.yAlign,ptX=tooltipPoint.x,ptY=tooltipPoint.y,width=size.width,height=size.height;if("center"===yAlign)y2=ptY+height/2,y3="left"===xAlign?(x2=(x1=ptX)-caretSize,x3=x1,y1=y2+caretSize,y2-caretSize):(x2=(x1=ptX+width)+caretSize,x3=x1,y1=y2-caretSize,y2+caretSize);else if(x3=(x1="left"===xAlign?(x2=ptX+cornerRadius+caretSize)-caretSize:"right"===xAlign?(x2=ptX+width-cornerRadius-caretSize)-caretSize:(x2=vm.caretX)-caretSize,x2+caretSize),"top"===yAlign)y2=(y1=ptY)-caretSize,y3=y1;else{y2=(y1=ptY+height)+caretSize,y3=y1;var tmp=x3;x3=x1,x1=tmp}return{x1:x1,x2:x2,x3:x3,y1:y1,y2:y2,y3:y3}},drawTitle:function(pt,vm,ctx){var titleFontSize,titleSpacing,i,title=vm.title,length=title.length;if(length){var rtlHelper=getRtlHelper(vm.rtl,vm.x,vm.width);for(pt.x=getAlignedX(vm,vm._titleAlign),ctx.textAlign=rtlHelper.textAlign(vm._titleAlign),ctx.textBaseline="middle",titleFontSize=vm.titleFontSize,titleSpacing=vm.titleSpacing,ctx.fillStyle=vm.titleFontColor,ctx.font=helpers$1.fontString(titleFontSize,vm._titleFontStyle,vm._titleFontFamily),i=0;i<length;++i)ctx.fillText(title[i],rtlHelper.x(pt.x),pt.y+titleFontSize/2),pt.y+=titleFontSize+titleSpacing,i+1===length&&(pt.y+=vm.titleMarginBottom-titleSpacing)}},drawBody:function(pt,vm,ctx){function fillLineOfText(line){ctx.fillText(line,rtlHelper.x(pt.x+xLinePadding),pt.y+bodyFontSize/2),pt.y+=bodyFontSize+bodySpacing}var bodyItem,textColor,labelColors,lines,i,j,ilen,jlen,bodyFontSize=vm.bodyFontSize,bodySpacing=vm.bodySpacing,bodyAlign=vm._bodyAlign,body=vm.body,drawColorBoxes=vm.displayColors,xLinePadding=0,colorX=drawColorBoxes?getAlignedX(vm,"left"):0,rtlHelper=getRtlHelper(vm.rtl,vm.x,vm.width),bodyAlignForCalculation=rtlHelper.textAlign(bodyAlign);for(ctx.textAlign=bodyAlign,ctx.textBaseline="middle",ctx.font=helpers$1.fontString(bodyFontSize,vm._bodyFontStyle,vm._bodyFontFamily),pt.x=getAlignedX(vm,bodyAlignForCalculation),ctx.fillStyle=vm.bodyFontColor,helpers$1.each(vm.beforeBody,fillLineOfText),xLinePadding=drawColorBoxes&&"right"!==bodyAlignForCalculation?"center"===bodyAlign?bodyFontSize/2+1:bodyFontSize+2:0,i=0,ilen=body.length;i<ilen;++i){for(bodyItem=body[i],textColor=vm.labelTextColors[i],labelColors=vm.labelColors[i],ctx.fillStyle=textColor,helpers$1.each(bodyItem.before,fillLineOfText),j=0,jlen=(lines=bodyItem.lines).length;j<jlen;++j){if(drawColorBoxes){var rtlColorX=rtlHelper.x(colorX);ctx.fillStyle=vm.legendColorBackground,ctx.fillRect(rtlHelper.leftForLtr(rtlColorX,bodyFontSize),pt.y,bodyFontSize,bodyFontSize),ctx.lineWidth=1,ctx.strokeStyle=labelColors.borderColor,ctx.strokeRect(rtlHelper.leftForLtr(rtlColorX,bodyFontSize),pt.y,bodyFontSize,bodyFontSize),ctx.fillStyle=labelColors.backgroundColor,ctx.fillRect(rtlHelper.leftForLtr(rtlHelper.xPlus(rtlColorX,1),bodyFontSize-2),pt.y+1,bodyFontSize-2,bodyFontSize-2),ctx.fillStyle=textColor}fillLineOfText(lines[j])}helpers$1.each(bodyItem.after,fillLineOfText)}xLinePadding=0,helpers$1.each(vm.afterBody,fillLineOfText),pt.y-=bodySpacing},drawFooter:function(pt,vm,ctx){var footerFontSize,i,footer=vm.footer,length=footer.length;if(length){var rtlHelper=getRtlHelper(vm.rtl,vm.x,vm.width);for(pt.x=getAlignedX(vm,vm._footerAlign),pt.y+=vm.footerMarginTop,ctx.textAlign=rtlHelper.textAlign(vm._footerAlign),ctx.textBaseline="middle",footerFontSize=vm.footerFontSize,ctx.fillStyle=vm.footerFontColor,ctx.font=helpers$1.fontString(footerFontSize,vm._footerFontStyle,vm._footerFontFamily),i=0;i<length;++i)ctx.fillText(footer[i],rtlHelper.x(pt.x),pt.y+footerFontSize/2),pt.y+=footerFontSize+vm.footerSpacing}},drawBackground:function(pt,vm,ctx,tooltipSize){ctx.fillStyle=vm.backgroundColor,ctx.strokeStyle=vm.borderColor,ctx.lineWidth=vm.borderWidth;var xAlign=vm.xAlign,yAlign=vm.yAlign,x=pt.x,y=pt.y,width=tooltipSize.width,height=tooltipSize.height,radius=vm.cornerRadius;ctx.beginPath(),ctx.moveTo(x+radius,y),"top"===yAlign&&this.drawCaret(pt,tooltipSize),ctx.lineTo(x+width-radius,y),ctx.quadraticCurveTo(x+width,y,x+width,y+radius),"center"===yAlign&&"right"===xAlign&&this.drawCaret(pt,tooltipSize),ctx.lineTo(x+width,y+height-radius),ctx.quadraticCurveTo(x+width,y+height,x+width-radius,y+height),"bottom"===yAlign&&this.drawCaret(pt,tooltipSize),ctx.lineTo(x+radius,y+height),ctx.quadraticCurveTo(x,y+height,x,y+height-radius),"center"===yAlign&&"left"===xAlign&&this.drawCaret(pt,tooltipSize),ctx.lineTo(x,y+radius),ctx.quadraticCurveTo(x,y,x+radius,y),ctx.closePath(),ctx.fill(),0<vm.borderWidth&&ctx.stroke()},draw:function(){var ctx=this._chart.ctx,vm=this._view;if(0!==vm.opacity){var tooltipSize={width:vm.width,height:vm.height},pt={x:vm.x,y:vm.y},opacity=Math.abs(vm.opacity<.001)?0:vm.opacity,hasTooltipContent=vm.title.length||vm.beforeBody.length||vm.body.length||vm.afterBody.length||vm.footer.length;this._options.enabled&&hasTooltipContent&&(ctx.save(),ctx.globalAlpha=opacity,this.drawBackground(pt,vm,ctx,tooltipSize),pt.y+=vm.yPadding,helpers$1.rtl.overrideTextDirection(ctx,vm.textDirection),this.drawTitle(pt,vm,ctx),this.drawBody(pt,vm,ctx),this.drawFooter(pt,vm,ctx),helpers$1.rtl.restoreTextDirection(ctx,vm.textDirection),ctx.restore())}},handleEvent:function(e){var changed,me=this,options=me._options;return me._lastActive=me._lastActive||[],"mouseout"===e.type?me._active=[]:(me._active=me._chart.getElementsAtEventForMode(e,options.mode,options),options.reverse&&me._active.reverse()),(changed=!helpers$1.arrayEquals(me._active,me._lastActive))&&(me._lastActive=me._active,(options.enabled||options.custom)&&(me._eventPosition={x:e.x,y:e.y},me.update(!0),me.pivot())),changed}}),positioners_1=positioners,core_tooltip=exports$4;core_tooltip.positioners=positioners_1;var valueOrDefault$9=helpers$1.valueOrDefault;function mergeScaleConfig(){return helpers$1.merge({},[].slice.call(arguments),{merger:function(key,target,source,options){if("xAxes"===key||"yAxes"===key){var i,type,scale,slen=source[key].length;for(target[key]||(target[key]=[]),i=0;i<slen;++i)scale=source[key][i],type=valueOrDefault$9(scale.type,"xAxes"===key?"category":"linear"),i>=target[key].length&&target[key].push({}),!target[key][i].type||scale.type&&scale.type!==target[key][i].type?helpers$1.merge(target[key][i],[core_scaleService.getScaleDefaults(type),scale]):helpers$1.merge(target[key][i],scale)}else helpers$1._merger(key,target,source,options)}})}function mergeConfig(){return helpers$1.merge({},[].slice.call(arguments),{merger:function(key,target,source,options){var tval=target[key]||{},sval=source[key];"scales"===key?target[key]=mergeScaleConfig(tval,sval):"scale"===key?target[key]=helpers$1.merge(tval,[core_scaleService.getScaleDefaults(sval.type),sval]):helpers$1._merger(key,target,source,options)}})}function nextAvailableScaleId(axesOpts,prefix,index){for(var id,hasId=function(obj){return obj.id===id};id=prefix+index++,0<=helpers$1.findIndex(axesOpts,hasId););return id}function positionIsHorizontal(position){return"top"===position||"bottom"===position}function compare2Level(l1,l2){return function(a,b){return a[l1]===b[l1]?a[l2]-b[l2]:a[l1]-b[l1]}}core_defaults._set("global",{elements:{},events:["mousemove","mouseout","click","touchstart","touchmove"],hover:{onHover:null,mode:"nearest",intersect:!0,animationDuration:400},onClick:null,maintainAspectRatio:!0,responsive:!0,responsiveAnimationDuration:0});function Chart(item,config){return this.construct(item,config),this}helpers$1.extend(Chart.prototype,{construct:function(item,config){var me=this;config=function(config){var data=(config=config||{}).data=config.data||{};return data.datasets=data.datasets||[],data.labels=data.labels||[],config.options=mergeConfig(core_defaults.global,core_defaults[config.type],config.options||{}),config}(config);var context=platform.acquireContext(item,config),canvas=context&&context.canvas,height=canvas&&canvas.height,width=canvas&&canvas.width;me.id=helpers$1.uid(),me.ctx=context,me.canvas=canvas,me.config=config,me.width=width,me.height=height,me.aspectRatio=height?width/height:null,me.options=config.options,me._bufferedRender=!1,me._layers=[],(me.chart=me).controller=me,Chart.instances[me.id]=me,Object.defineProperty(me,"data",{get:function(){return me.config.data},set:function(value){me.config.data=value}}),context&&canvas?(me.initialize(),me.update()):console.error("Failed to create chart: can't acquire context from the given item")},initialize:function(){var me=this;return core_plugins.notify(me,"beforeInit"),helpers$1.retinaScale(me,me.options.devicePixelRatio),me.bindEvents(),me.options.responsive&&me.resize(!0),me.initToolTip(),core_plugins.notify(me,"afterInit"),me},clear:function(){return helpers$1.canvas.clear(this),this},stop:function(){return core_animations.cancelAnimation(this),this},resize:function(silent){var me=this,options=me.options,canvas=me.canvas,aspectRatio=options.maintainAspectRatio&&me.aspectRatio||null,newWidth=Math.max(0,Math.floor(helpers$1.getMaximumWidth(canvas))),newHeight=Math.max(0,Math.floor(aspectRatio?newWidth/aspectRatio:helpers$1.getMaximumHeight(canvas)));if((me.width!==newWidth||me.height!==newHeight)&&(canvas.width=me.width=newWidth,canvas.height=me.height=newHeight,canvas.style.width=newWidth+"px",canvas.style.height=newHeight+"px",helpers$1.retinaScale(me,options.devicePixelRatio),!silent)){var newSize={width:newWidth,height:newHeight};core_plugins.notify(me,"resize",[newSize]),options.onResize&&options.onResize(me,newSize),me.stop(),me.update({duration:options.responsiveAnimationDuration})}},ensureScalesHaveIDs:function(){var options=this.options,scalesOptions=options.scales||{},scaleOptions=options.scale;helpers$1.each(scalesOptions.xAxes,function(xAxisOptions,index){xAxisOptions.id||(xAxisOptions.id=nextAvailableScaleId(scalesOptions.xAxes,"x-axis-",index))}),helpers$1.each(scalesOptions.yAxes,function(yAxisOptions,index){yAxisOptions.id||(yAxisOptions.id=nextAvailableScaleId(scalesOptions.yAxes,"y-axis-",index))}),scaleOptions&&(scaleOptions.id=scaleOptions.id||"scale")},buildOrUpdateScales:function(){var me=this,options=me.options,scales=me.scales||{},items=[],updated=Object.keys(scales).reduce(function(obj,id){return obj[id]=!1,obj},{});options.scales&&(items=items.concat((options.scales.xAxes||[]).map(function(xAxisOptions){return{options:xAxisOptions,dtype:"category",dposition:"bottom"}}),(options.scales.yAxes||[]).map(function(yAxisOptions){return{options:yAxisOptions,dtype:"linear",dposition:"left"}}))),options.scale&&items.push({options:options.scale,dtype:"radialLinear",isDefault:!0,dposition:"chartArea"}),helpers$1.each(items,function(item){var scaleOptions=item.options,id=scaleOptions.id,scaleType=valueOrDefault$9(scaleOptions.type,item.dtype);positionIsHorizontal(scaleOptions.position)!==positionIsHorizontal(item.dposition)&&(scaleOptions.position=item.dposition),updated[id]=!0;var scale=null;if(id in scales&&scales[id].type===scaleType)(scale=scales[id]).options=scaleOptions,scale.ctx=me.ctx,scale.chart=me;else{var scaleClass=core_scaleService.getScaleConstructor(scaleType);if(!scaleClass)return;scale=new scaleClass({id:id,type:scaleType,options:scaleOptions,ctx:me.ctx,chart:me}),scales[scale.id]=scale}scale.mergeTicksOptions(),item.isDefault&&(me.scale=scale)}),helpers$1.each(updated,function(hasUpdated,id){hasUpdated||delete scales[id]}),me.scales=scales,core_scaleService.addScalesToLayout(this)},buildOrUpdateControllers:function(){var i,ilen,me=this,newControllers=[],datasets=me.data.datasets;for(i=0,ilen=datasets.length;i<ilen;i++){var dataset=datasets[i],meta=me.getDatasetMeta(i),type=dataset.type||me.config.type;if(meta.type&&meta.type!==type&&(me.destroyDatasetMeta(i),meta=me.getDatasetMeta(i)),meta.type=type,meta.order=dataset.order||0,meta.index=i,meta.controller)meta.controller.updateIndex(i),meta.controller.linkScales();else{var ControllerClass=controllers[meta.type];if(void 0===ControllerClass)throw new Error('"'+meta.type+'" is not a chart type.');meta.controller=new ControllerClass(me,i),newControllers.push(meta.controller)}}return newControllers},resetElements:function(){var me=this;helpers$1.each(me.data.datasets,function(dataset,datasetIndex){me.getDatasetMeta(datasetIndex).controller.reset()},me)},reset:function(){this.resetElements(),this.tooltip.initialize()},update:function(config){var i,ilen,me=this;if(config&&"object"==typeof config||(config={duration:config,lazy:arguments[1]}),function(chart){var newOptions=chart.options;helpers$1.each(chart.scales,function(scale){core_layouts.removeBox(chart,scale)}),newOptions=mergeConfig(core_defaults.global,core_defaults[chart.config.type],newOptions),chart.options=chart.config.options=newOptions,chart.ensureScalesHaveIDs(),chart.buildOrUpdateScales(),chart.tooltip._options=newOptions.tooltips,chart.tooltip.initialize()}(me),core_plugins._invalidate(me),!1!==core_plugins.notify(me,"beforeUpdate")){me.tooltip._data=me.data;var newControllers=me.buildOrUpdateControllers();for(i=0,ilen=me.data.datasets.length;i<ilen;i++)me.getDatasetMeta(i).controller.buildOrUpdateElements();me.updateLayout(),me.options.animation&&me.options.animation.duration&&helpers$1.each(newControllers,function(controller){controller.reset()}),me.updateDatasets(),me.tooltip.initialize(),me.lastActive=[],core_plugins.notify(me,"afterUpdate"),me._layers.sort(compare2Level("z","_idx")),me._bufferedRender?me._bufferedRequest={duration:config.duration,easing:config.easing,lazy:config.lazy}:me.render(config)}},updateLayout:function(){var me=this;!1!==core_plugins.notify(me,"beforeLayout")&&(core_layouts.update(this,this.width,this.height),me._layers=[],helpers$1.each(me.boxes,function(box){box._configure&&box._configure(),me._layers.push.apply(me._layers,box._layers())},me),me._layers.forEach(function(item,index){item._idx=index}),core_plugins.notify(me,"afterScaleUpdate"),core_plugins.notify(me,"afterLayout"))},updateDatasets:function(){if(!1!==core_plugins.notify(this,"beforeDatasetsUpdate")){for(var i=0,ilen=this.data.datasets.length;i<ilen;++i)this.updateDataset(i);core_plugins.notify(this,"afterDatasetsUpdate")}},updateDataset:function(index){var meta=this.getDatasetMeta(index),args={meta:meta,index:index};!1!==core_plugins.notify(this,"beforeDatasetUpdate",[args])&&(meta.controller._update(),core_plugins.notify(this,"afterDatasetUpdate",[args]))},render:function(config){var me=this;config&&"object"==typeof config||(config={duration:config,lazy:arguments[1]});var animationOptions=me.options.animation,duration=valueOrDefault$9(config.duration,animationOptions&&animationOptions.duration),lazy=config.lazy;if(!1!==core_plugins.notify(me,"beforeRender")){var onComplete=function(animation){core_plugins.notify(me,"afterRender"),helpers$1.callback(animationOptions&&animationOptions.onComplete,[animation],me)};if(animationOptions&&duration){var animation=new core_animation({numSteps:duration/16.66,easing:config.easing||animationOptions.easing,render:function(chart,animationObject){var easingFunction=helpers$1.easing.effects[animationObject.easing],currentStep=animationObject.currentStep,stepDecimal=currentStep/animationObject.numSteps;chart.draw(easingFunction(stepDecimal),stepDecimal,currentStep)},onAnimationProgress:animationOptions.onProgress,onAnimationComplete:onComplete});core_animations.addAnimation(me,animation,duration,lazy)}else me.draw(),onComplete(new core_animation({numSteps:0,chart:me}));return me}},draw:function(easingValue){var i,layers,me=this;if(me.clear(),helpers$1.isNullOrUndef(easingValue)&&(easingValue=1),me.transition(easingValue),!(me.width<=0||me.height<=0)&&!1!==core_plugins.notify(me,"beforeDraw",[easingValue])){for(layers=me._layers,i=0;i<layers.length&&layers[i].z<=0;++i)layers[i].draw(me.chartArea);for(me.drawDatasets(easingValue);i<layers.length;++i)layers[i].draw(me.chartArea);me._drawTooltip(easingValue),core_plugins.notify(me,"afterDraw",[easingValue])}},transition:function(easingValue){for(var i=0,ilen=(this.data.datasets||[]).length;i<ilen;++i)this.isDatasetVisible(i)&&this.getDatasetMeta(i).controller.transition(easingValue);this.tooltip.transition(easingValue)},_getSortedDatasetMetas:function(filterVisible){var i,ilen,result=[];for(i=0,ilen=(this.data.datasets||[]).length;i<ilen;++i)filterVisible&&!this.isDatasetVisible(i)||result.push(this.getDatasetMeta(i));return result.sort(compare2Level("order","index")),result},_getSortedVisibleDatasetMetas:function(){return this._getSortedDatasetMetas(!0)},drawDatasets:function(easingValue){var metasets,i;if(!1!==core_plugins.notify(this,"beforeDatasetsDraw",[easingValue])){for(i=(metasets=this._getSortedVisibleDatasetMetas()).length-1;0<=i;--i)this.drawDataset(metasets[i],easingValue);core_plugins.notify(this,"afterDatasetsDraw",[easingValue])}},drawDataset:function(meta,easingValue){var args={meta:meta,index:meta.index,easingValue:easingValue};!1!==core_plugins.notify(this,"beforeDatasetDraw",[args])&&(meta.controller.draw(easingValue),core_plugins.notify(this,"afterDatasetDraw",[args]))},_drawTooltip:function(easingValue){var tooltip=this.tooltip,args={tooltip:tooltip,easingValue:easingValue};!1!==core_plugins.notify(this,"beforeTooltipDraw",[args])&&(tooltip.draw(),core_plugins.notify(this,"afterTooltipDraw",[args]))},getElementAtEvent:function(e){return core_interaction.modes.single(this,e)},getElementsAtEvent:function(e){return core_interaction.modes.label(this,e,{intersect:!0})},getElementsAtXAxis:function(e){return core_interaction.modes["x-axis"](this,e,{intersect:!0})},getElementsAtEventForMode:function(e,mode,options){var method=core_interaction.modes[mode];return"function"==typeof method?method(this,e,options):[]},getDatasetAtEvent:function(e){return core_interaction.modes.dataset(this,e,{intersect:!0})},getDatasetMeta:function(datasetIndex){var dataset=this.data.datasets[datasetIndex];dataset._meta||(dataset._meta={});var meta=dataset._meta[this.id];return meta=meta||(dataset._meta[this.id]={type:null,data:[],dataset:null,controller:null,hidden:null,xAxisID:null,yAxisID:null,order:dataset.order||0,index:datasetIndex})},getVisibleDatasetCount:function(){for(var count=0,i=0,ilen=this.data.datasets.length;i<ilen;++i)this.isDatasetVisible(i)&&count++;return count},isDatasetVisible:function(datasetIndex){var meta=this.getDatasetMeta(datasetIndex);return"boolean"==typeof meta.hidden?!meta.hidden:!this.data.datasets[datasetIndex].hidden},generateLegend:function(){return this.options.legendCallback(this)},destroyDatasetMeta:function(datasetIndex){var id=this.id,dataset=this.data.datasets[datasetIndex],meta=dataset._meta&&dataset._meta[id];meta&&(meta.controller.destroy(),delete dataset._meta[id])},destroy:function(){var i,ilen,me=this,canvas=me.canvas;for(me.stop(),i=0,ilen=me.data.datasets.length;i<ilen;++i)me.destroyDatasetMeta(i);canvas&&(me.unbindEvents(),helpers$1.canvas.clear(me),platform.releaseContext(me.ctx),me.canvas=null,me.ctx=null),core_plugins.notify(me,"destroy"),delete Chart.instances[me.id]},toBase64Image:function(){return this.canvas.toDataURL.apply(this.canvas,arguments)},initToolTip:function(){var me=this;me.tooltip=new core_tooltip({_chart:me,_chartInstance:me,_data:me.data,_options:me.options.tooltips},me)},bindEvents:function(){var me=this,listeners=me._listeners={},listener=function(){me.eventHandler.apply(me,arguments)};helpers$1.each(me.options.events,function(type){platform.addEventListener(me,type,listener),listeners[type]=listener}),me.options.responsive&&(listener=function(){me.resize()},platform.addEventListener(me,"resize",listener),listeners.resize=listener)},unbindEvents:function(){var me=this,listeners=me._listeners;listeners&&(delete me._listeners,helpers$1.each(listeners,function(listener,type){platform.removeEventListener(me,type,listener)}))},updateHoverStyle:function(elements,mode,enabled){var element,i,ilen,prefix=enabled?"set":"remove";for(i=0,ilen=elements.length;i<ilen;++i)(element=elements[i])&&this.getDatasetMeta(element._datasetIndex).controller[prefix+"HoverStyle"](element);"dataset"===mode&&this.getDatasetMeta(elements[0]._datasetIndex).controller["_"+prefix+"DatasetHoverStyle"]()},eventHandler:function(e){var me=this,tooltip=me.tooltip;if(!1!==core_plugins.notify(me,"beforeEvent",[e])){me._bufferedRender=!0,me._bufferedRequest=null;var changed=me.handleEvent(e);tooltip&&(changed=tooltip._start?tooltip.handleEvent(e):changed|tooltip.handleEvent(e)),core_plugins.notify(me,"afterEvent",[e]);var bufferedRequest=me._bufferedRequest;return bufferedRequest?me.render(bufferedRequest):changed&&!me.animating&&(me.stop(),me.render({duration:me.options.hover.animationDuration,lazy:!0})),me._bufferedRender=!1,me._bufferedRequest=null,me}},handleEvent:function(e){var changed,me=this,options=me.options||{},hoverOptions=options.hover;return me.lastActive=me.lastActive||[],"mouseout"===e.type?me.active=[]:me.active=me.getElementsAtEventForMode(e,hoverOptions.mode,hoverOptions),helpers$1.callback(options.onHover||options.hover.onHover,[e.native,me.active],me),"mouseup"!==e.type&&"click"!==e.type||options.onClick&&options.onClick.call(me,e.native,me.active),me.lastActive.length&&me.updateHoverStyle(me.lastActive,hoverOptions.mode,!1),me.active.length&&hoverOptions.mode&&me.updateHoverStyle(me.active,hoverOptions.mode,!0),changed=!helpers$1.arrayEquals(me.active,me.lastActive),me.lastActive=me.active,changed}}),Chart.instances={};var core_controller=Chart;(Chart.Controller=Chart).types={},helpers$1.configMerge=mergeConfig,helpers$1.scaleMerge=mergeScaleConfig;function abstract(){throw new Error("This method is not implemented: either no adapter can be found or an incomplete integration was provided.")}function DateAdapter(options){this.options=options||{}}helpers$1.extend(DateAdapter.prototype,{formats:abstract,parse:abstract,format:abstract,add:abstract,diff:abstract,startOf:abstract,endOf:abstract,_create:function(value){return value}}),DateAdapter.override=function(members){helpers$1.extend(DateAdapter.prototype,members)};var core_adapters={_date:DateAdapter},core_ticks={formatters:{values:function(value){return helpers$1.isArray(value)?value:""+value},linear:function(tickValue,index,ticks){var delta=3<ticks.length?ticks[2]-ticks[1]:ticks[1]-ticks[0];1<Math.abs(delta)&&tickValue!==Math.floor(tickValue)&&(delta=tickValue-Math.floor(tickValue));var logDelta=helpers$1.log10(Math.abs(delta)),tickString="";if(0!==tickValue)if(Math.max(Math.abs(ticks[0]),Math.abs(ticks[ticks.length-1]))<1e-4){var logTick=helpers$1.log10(Math.abs(tickValue)),numExponential=Math.floor(logTick)-Math.floor(logDelta);numExponential=Math.max(Math.min(numExponential,20),0),tickString=tickValue.toExponential(numExponential)}else{var numDecimal=-1*Math.floor(logDelta);numDecimal=Math.max(Math.min(numDecimal,20),0),tickString=tickValue.toFixed(numDecimal)}else tickString="0";return tickString},logarithmic:function(tickValue,index,ticks){var remain=tickValue/Math.pow(10,Math.floor(helpers$1.log10(tickValue)));return 0===tickValue?"0":1==remain||2==remain||5==remain||0===index||index===ticks.length-1?tickValue.toExponential():""}}},isArray=helpers$1.isArray,isNullOrUndef=helpers$1.isNullOrUndef,valueOrDefault$a=helpers$1.valueOrDefault,valueAtIndexOrDefault=helpers$1.valueAtIndexOrDefault;function getPixelForGridLine(scale,index,offsetGridLines){var offset,length=scale.getTicks().length,validIndex=Math.min(index,length-1),lineValue=scale.getPixelForTick(validIndex),start=scale._startPixel,end=scale._endPixel;if(!(offsetGridLines&&(offset=1===length?Math.max(lineValue-start,end-lineValue):0===index?(scale.getPixelForTick(1)-lineValue)/2:(lineValue-scale.getPixelForTick(validIndex-1))/2,(lineValue+=validIndex<index?offset:-offset)<start-1e-6||end+1e-6<lineValue)))return lineValue}function computeLabelSizes(ctx,tickFonts,ticks,caches){var i,j,jlen,label,tickFont,fontString,cache,lineHeight,width,height,nestedLabel,widest,highest,length=ticks.length,widths=[],heights=[],offsets=[];for(i=0;i<length;++i){if(label=ticks[i].label,tickFont=ticks[i].major?tickFonts.major:tickFonts.minor,ctx.font=fontString=tickFont.string,cache=caches[fontString]=caches[fontString]||{data:{},gc:[]},lineHeight=tickFont.lineHeight,width=height=0,isNullOrUndef(label)||isArray(label)){if(isArray(label))for(j=0,jlen=label.length;j<jlen;++j)nestedLabel=label[j],isNullOrUndef(nestedLabel)||isArray(nestedLabel)||(width=helpers$1.measureText(ctx,cache.data,cache.gc,width,nestedLabel),height+=lineHeight)}else width=helpers$1.measureText(ctx,cache.data,cache.gc,width,label),height=lineHeight;widths.push(width),heights.push(height),offsets.push(lineHeight/2)}function valueAt(idx){return{width:widths[idx]||0,height:heights[idx]||0,offset:offsets[idx]||0}}return function(caches,length){helpers$1.each(caches,function(cache){var i,gc=cache.gc,gcLen=gc.length/2;if(length<gcLen){for(i=0;i<gcLen;++i)delete cache.data[gc[i]];gc.splice(0,gcLen)}})}(caches,length),widest=widths.indexOf(Math.max.apply(null,widths)),highest=heights.indexOf(Math.max.apply(null,heights)),{first:valueAt(0),last:valueAt(length-1),widest:valueAt(widest),highest:valueAt(highest)}}function getTickMarkLength(options){return options.drawTicks?options.tickMarkLength:0}function getScaleLabelHeight(options){var font,padding;return options.display?(font=helpers$1.options._parseFont(options),padding=helpers$1.options.toPadding(options.padding),font.lineHeight+padding.height):0}function parseFontOptions(options,nestedOpts){return helpers$1.extend(helpers$1.options._parseFont({fontFamily:valueOrDefault$a(nestedOpts.fontFamily,options.fontFamily),fontSize:valueOrDefault$a(nestedOpts.fontSize,options.fontSize),fontStyle:valueOrDefault$a(nestedOpts.fontStyle,options.fontStyle),lineHeight:valueOrDefault$a(nestedOpts.lineHeight,options.lineHeight)}),{color:helpers$1.options.resolve([nestedOpts.fontColor,options.fontColor,core_defaults.global.defaultFontColor])})}function parseTickFontOptions(options){var minor=parseFontOptions(options,options.minor);return{minor:minor,major:options.major.enabled?parseFontOptions(options,options.major):minor}}function nonSkipped(ticksToFilter){var item,index,len,filtered=[];for(index=0,len=ticksToFilter.length;index<len;++index)void 0!==(item=ticksToFilter[index])._index&&filtered.push(item);return filtered}function calculateSpacing(majorIndices,ticks,axisLength,ticksLimit){var factors,factor,i,ilen,evenMajorSpacing=function(arr){var i,diff,len=arr.length;if(len<2)return!1;for(diff=arr[0],i=1;i<len;++i)if(arr[i]-arr[i-1]!==diff)return!1;return diff}(majorIndices),spacing=(ticks.length-1)/ticksLimit;if(!evenMajorSpacing)return Math.max(spacing,1);for(i=0,ilen=(factors=helpers$1.math._factorize(evenMajorSpacing)).length-1;i<ilen;i++)if(spacing<(factor=factors[i]))return factor;return Math.max(spacing,1)}function skip(ticks,spacing,majorStart,majorEnd){var length,i,tick,next,start=valueOrDefault$a(majorStart,0),end=Math.min(valueOrDefault$a(majorEnd,ticks.length),ticks.length),count=0;for(spacing=Math.ceil(spacing),majorEnd&&(spacing=(length=majorEnd-majorStart)/Math.floor(length/spacing)),next=start;next<0;)count++,next=Math.round(start+count*spacing);for(i=Math.max(start,0);i<end;i++)tick=ticks[i],i===next?(tick._index=i,count++,next=Math.round(start+count*spacing)):delete tick.label}core_defaults._set("scale",{display:!0,position:"left",offset:!1,gridLines:{display:!0,color:"rgba(0,0,0,0.1)",lineWidth:1,drawBorder:!0,drawOnChartArea:!0,drawTicks:!0,tickMarkLength:10,zeroLineWidth:1,zeroLineColor:"rgba(0,0,0,0.25)",zeroLineBorderDash:[],zeroLineBorderDashOffset:0,offsetGridLines:!1,borderDash:[],borderDashOffset:0},scaleLabel:{display:!1,labelString:"",padding:{top:4,bottom:4}},ticks:{beginAtZero:!1,minRotation:0,maxRotation:50,mirror:!1,padding:0,reverse:!1,display:!0,autoSkip:!0,autoSkipPadding:0,labelOffset:0,callback:core_ticks.formatters.values,minor:{},major:{}}});var Scale=core_element.extend({zeroLineIndex:0,getPadding:function(){return{left:this.paddingLeft||0,top:this.paddingTop||0,right:this.paddingRight||0,bottom:this.paddingBottom||0}},getTicks:function(){return this._ticks},_getLabels:function(){var data=this.chart.data;return this.options.labels||(this.isHorizontal()?data.xLabels:data.yLabels)||data.labels||[]},mergeTicksOptions:function(){},beforeUpdate:function(){helpers$1.callback(this.options.beforeUpdate,[this])},update:function(maxWidth,maxHeight,margins){var i,ilen,labels,ticks,samplingEnabled,me=this,tickOpts=me.options.ticks,sampleSize=tickOpts.sampleSize;if(me.beforeUpdate(),me.maxWidth=maxWidth,me.maxHeight=maxHeight,me.margins=helpers$1.extend({left:0,right:0,top:0,bottom:0},margins),me._ticks=null,me.ticks=null,me._labelSizes=null,me._maxLabelLines=0,me.longestLabelWidth=0,me.longestTextCache=me.longestTextCache||{},me._gridLineItems=null,me._labelItems=null,me.beforeSetDimensions(),me.setDimensions(),me.afterSetDimensions(),me.beforeDataLimits(),me.determineDataLimits(),me.afterDataLimits(),me.beforeBuildTicks(),ticks=me.buildTicks()||[],(!(ticks=me.afterBuildTicks(ticks)||ticks)||!ticks.length)&&me.ticks)for(ticks=[],i=0,ilen=me.ticks.length;i<ilen;++i)ticks.push({value:me.ticks[i],major:!1});return samplingEnabled=sampleSize<(me._ticks=ticks).length,labels=me._convertTicksToLabels(samplingEnabled?function(arr,numItems){for(var result=[],increment=arr.length/numItems,i=0,len=arr.length;i<len;i+=increment)result.push(arr[Math.floor(i)]);return result}(ticks,sampleSize):ticks),me._configure(),me.beforeCalculateTickRotation(),me.calculateTickRotation(),me.afterCalculateTickRotation(),me.beforeFit(),me.fit(),me.afterFit(),me._ticksToDraw=tickOpts.display&&(tickOpts.autoSkip||"auto"===tickOpts.source)?me._autoSkip(ticks):ticks,samplingEnabled&&(labels=me._convertTicksToLabels(me._ticksToDraw)),me.ticks=labels,me.afterUpdate(),me.minSize},_configure:function(){var startPixel,endPixel,me=this,reversePixels=me.options.ticks.reverse;me.isHorizontal()?(startPixel=me.left,endPixel=me.right):(startPixel=me.top,endPixel=me.bottom,reversePixels=!reversePixels),me._startPixel=startPixel,me._endPixel=endPixel,me._reversePixels=reversePixels,me._length=endPixel-startPixel},afterUpdate:function(){helpers$1.callback(this.options.afterUpdate,[this])},beforeSetDimensions:function(){helpers$1.callback(this.options.beforeSetDimensions,[this])},setDimensions:function(){var me=this;me.isHorizontal()?(me.width=me.maxWidth,me.left=0,me.right=me.width):(me.height=me.maxHeight,me.top=0,me.bottom=me.height),me.paddingLeft=0,me.paddingTop=0,me.paddingRight=0,me.paddingBottom=0},afterSetDimensions:function(){helpers$1.callback(this.options.afterSetDimensions,[this])},beforeDataLimits:function(){helpers$1.callback(this.options.beforeDataLimits,[this])},determineDataLimits:helpers$1.noop,afterDataLimits:function(){helpers$1.callback(this.options.afterDataLimits,[this])},beforeBuildTicks:function(){helpers$1.callback(this.options.beforeBuildTicks,[this])},buildTicks:helpers$1.noop,afterBuildTicks:function(ticks){var me=this;return isArray(ticks)&&ticks.length?helpers$1.callback(me.options.afterBuildTicks,[me,ticks]):(me.ticks=helpers$1.callback(me.options.afterBuildTicks,[me,me.ticks])||me.ticks,ticks)},beforeTickToLabelConversion:function(){helpers$1.callback(this.options.beforeTickToLabelConversion,[this])},convertTicksToLabels:function(){var tickOpts=this.options.ticks;this.ticks=this.ticks.map(tickOpts.userCallback||tickOpts.callback,this)},afterTickToLabelConversion:function(){helpers$1.callback(this.options.afterTickToLabelConversion,[this])},beforeCalculateTickRotation:function(){helpers$1.callback(this.options.beforeCalculateTickRotation,[this])},calculateTickRotation:function(){var labelSizes,maxLabelWidth,maxLabelHeight,maxWidth,tickWidth,maxHeight,maxLabelDiagonal,me=this,options=me.options,tickOpts=options.ticks,numTicks=me.getTicks().length,minRotation=tickOpts.minRotation||0,maxRotation=tickOpts.maxRotation,labelRotation=minRotation;!me._isVisible()||!tickOpts.display||maxRotation<=minRotation||numTicks<=1||!me.isHorizontal()?me.labelRotation=minRotation:(maxLabelWidth=(labelSizes=me._getLabelSizes()).widest.width,maxLabelHeight=labelSizes.highest.height-labelSizes.highest.offset,maxWidth=Math.min(me.maxWidth,me.chart.width-maxLabelWidth),(tickWidth=options.offset?me.maxWidth/numTicks:maxWidth/(numTicks-1))<maxLabelWidth+6&&(tickWidth=maxWidth/(numTicks-(options.offset?.5:1)),maxHeight=me.maxHeight-getTickMarkLength(options.gridLines)-tickOpts.padding-getScaleLabelHeight(options.scaleLabel),maxLabelDiagonal=Math.sqrt(maxLabelWidth*maxLabelWidth+maxLabelHeight*maxLabelHeight),labelRotation=helpers$1.toDegrees(Math.min(Math.asin(Math.min((labelSizes.highest.height+6)/tickWidth,1)),Math.asin(Math.min(maxHeight/maxLabelDiagonal,1))-Math.asin(maxLabelHeight/maxLabelDiagonal))),labelRotation=Math.max(minRotation,Math.min(maxRotation,labelRotation))),me.labelRotation=labelRotation)},afterCalculateTickRotation:function(){helpers$1.callback(this.options.afterCalculateTickRotation,[this])},beforeFit:function(){helpers$1.callback(this.options.beforeFit,[this])},fit:function(){var me=this,minSize=me.minSize={width:0,height:0},chart=me.chart,opts=me.options,tickOpts=opts.ticks,scaleLabelOpts=opts.scaleLabel,gridLineOpts=opts.gridLines,display=me._isVisible(),isBottom="bottom"===opts.position,isHorizontal=me.isHorizontal();if(isHorizontal?minSize.width=me.maxWidth:display&&(minSize.width=getTickMarkLength(gridLineOpts)+getScaleLabelHeight(scaleLabelOpts)),isHorizontal?display&&(minSize.height=getTickMarkLength(gridLineOpts)+getScaleLabelHeight(scaleLabelOpts)):minSize.height=me.maxHeight,tickOpts.display&&display){var tickFonts=parseTickFontOptions(tickOpts),labelSizes=me._getLabelSizes(),firstLabelSize=labelSizes.first,lastLabelSize=labelSizes.last,widestLabelSize=labelSizes.widest,highestLabelSize=labelSizes.highest,lineSpace=.4*tickFonts.minor.lineHeight,tickPadding=tickOpts.padding;if(isHorizontal){var isRotated=0!==me.labelRotation,angleRadians=helpers$1.toRadians(me.labelRotation),cosRotation=Math.cos(angleRadians),sinRotation=Math.sin(angleRadians),labelHeight=sinRotation*widestLabelSize.width+cosRotation*(highestLabelSize.height-(isRotated?highestLabelSize.offset:0))+(isRotated?0:lineSpace);minSize.height=Math.min(me.maxHeight,minSize.height+labelHeight+tickPadding);var paddingLeft,paddingRight,offsetLeft=me.getPixelForTick(0)-me.left,offsetRight=me.right-me.getPixelForTick(me.getTicks().length-1);paddingRight=isRotated?(paddingLeft=isBottom?cosRotation*firstLabelSize.width+sinRotation*firstLabelSize.offset:sinRotation*(firstLabelSize.height-firstLabelSize.offset),isBottom?sinRotation*(lastLabelSize.height-lastLabelSize.offset):cosRotation*lastLabelSize.width+sinRotation*lastLabelSize.offset):(paddingLeft=firstLabelSize.width/2,lastLabelSize.width/2),me.paddingLeft=Math.max((paddingLeft-offsetLeft)*me.width/(me.width-offsetLeft),0)+3,me.paddingRight=Math.max((paddingRight-offsetRight)*me.width/(me.width-offsetRight),0)+3}else{var labelWidth=tickOpts.mirror?0:widestLabelSize.width+tickPadding+lineSpace;minSize.width=Math.min(me.maxWidth,minSize.width+labelWidth),me.paddingTop=firstLabelSize.height/2,me.paddingBottom=lastLabelSize.height/2}}me.handleMargins(),isHorizontal?(me.width=me._length=chart.width-me.margins.left-me.margins.right,me.height=minSize.height):(me.width=minSize.width,me.height=me._length=chart.height-me.margins.top-me.margins.bottom)},handleMargins:function(){var me=this;me.margins&&(me.margins.left=Math.max(me.paddingLeft,me.margins.left),me.margins.top=Math.max(me.paddingTop,me.margins.top),me.margins.right=Math.max(me.paddingRight,me.margins.right),me.margins.bottom=Math.max(me.paddingBottom,me.margins.bottom))},afterFit:function(){helpers$1.callback(this.options.afterFit,[this])},isHorizontal:function(){var pos=this.options.position;return"top"===pos||"bottom"===pos},isFullWidth:function(){return this.options.fullWidth},getRightValue:function(rawValue){if(isNullOrUndef(rawValue))return NaN;if(("number"==typeof rawValue||rawValue instanceof Number)&&!isFinite(rawValue))return NaN;if(rawValue)if(this.isHorizontal()){if(void 0!==rawValue.x)return this.getRightValue(rawValue.x)}else if(void 0!==rawValue.y)return this.getRightValue(rawValue.y);return rawValue},_convertTicksToLabels:function(ticks){var labels,i,ilen,me=this;for(me.ticks=ticks.map(function(tick){return tick.value}),me.beforeTickToLabelConversion(),labels=me.convertTicksToLabels(ticks)||me.ticks,me.afterTickToLabelConversion(),i=0,ilen=ticks.length;i<ilen;++i)ticks[i].label=labels[i];return labels},_getLabelSizes:function(){var me=this,labelSizes=me._labelSizes;return labelSizes||(me._labelSizes=labelSizes=computeLabelSizes(me.ctx,parseTickFontOptions(me.options.ticks),me.getTicks(),me.longestTextCache),me.longestLabelWidth=labelSizes.widest.width),labelSizes},_parseValue:function(value){var start,end,min,max;return max=isArray(value)?(start=+this.getRightValue(value[0]),end=+this.getRightValue(value[1]),min=Math.min(start,end),Math.max(start,end)):(start=void 0,min=end=value=+this.getRightValue(value)),{min:min,max:max,start:start,end:end}},_getScaleLabel:function(rawValue){var v=this._parseValue(rawValue);return void 0!==v.start?"["+v.start+", "+v.end+"]":+this.getRightValue(rawValue)},getLabelForIndex:helpers$1.noop,getPixelForValue:helpers$1.noop,getValueForPixel:helpers$1.noop,getPixelForTick:function(index){var offset=this.options.offset,numTicks=this._ticks.length,tickWidth=1/Math.max(numTicks-(offset?0:1),1);return index<0||numTicks-1<index?null:this.getPixelForDecimal(index*tickWidth+(offset?tickWidth/2:0))},getPixelForDecimal:function(decimal){return this._reversePixels&&(decimal=1-decimal),this._startPixel+decimal*this._length},getDecimalForPixel:function(pixel){var decimal=(pixel-this._startPixel)/this._length;return this._reversePixels?1-decimal:decimal},getBasePixel:function(){return this.getPixelForValue(this.getBaseValue())},getBaseValue:function(){var min=this.min,max=this.max;return this.beginAtZero?0:min<0&&max<0?max:0<min&&0<max?min:0},_autoSkip:function(ticks){var i,ilen,spacing,avgMajorSpacing,tickOpts=this.options.ticks,axisLength=this._length,ticksLimit=tickOpts.maxTicksLimit||axisLength/this._tickSize()+1,majorIndices=tickOpts.major.enabled?function(ticks){var i,ilen,result=[];for(i=0,ilen=ticks.length;i<ilen;i++)ticks[i].major&&result.push(i);return result}(ticks):[],numMajorIndices=majorIndices.length,first=majorIndices[0],last=majorIndices[numMajorIndices-1];if(ticksLimit<numMajorIndices)return function(ticks,majorIndices,spacing){var i,tick,count=0,next=majorIndices[0];for(spacing=Math.ceil(spacing),i=0;i<ticks.length;i++)tick=ticks[i],i===next?(tick._index=i,next=majorIndices[++count*spacing]):delete tick.label}(ticks,majorIndices,numMajorIndices/ticksLimit),nonSkipped(ticks);if(spacing=calculateSpacing(majorIndices,ticks,0,ticksLimit),0<numMajorIndices){for(i=0,ilen=numMajorIndices-1;i<ilen;i++)skip(ticks,spacing,majorIndices[i],majorIndices[i+1]);return avgMajorSpacing=1<numMajorIndices?(last-first)/(numMajorIndices-1):null,skip(ticks,spacing,helpers$1.isNullOrUndef(avgMajorSpacing)?0:first-avgMajorSpacing,first),skip(ticks,spacing,last,helpers$1.isNullOrUndef(avgMajorSpacing)?ticks.length:last+avgMajorSpacing),nonSkipped(ticks)}return skip(ticks,spacing),nonSkipped(ticks)},_tickSize:function(){var optionTicks=this.options.ticks,rot=helpers$1.toRadians(this.labelRotation),cos=Math.abs(Math.cos(rot)),sin=Math.abs(Math.sin(rot)),labelSizes=this._getLabelSizes(),padding=optionTicks.autoSkipPadding||0,w=labelSizes?labelSizes.widest.width+padding:0,h=labelSizes?labelSizes.highest.height+padding:0;return this.isHorizontal()?w*sin<h*cos?w/cos:h/sin:h*sin<w*cos?h/cos:w/sin},_isVisible:function(){var i,ilen,meta,chart=this.chart,display=this.options.display;if("auto"!==display)return!!display;for(i=0,ilen=chart.data.datasets.length;i<ilen;++i)if(chart.isDatasetVisible(i)&&((meta=chart.getDatasetMeta(i)).xAxisID===this.id||meta.yAxisID===this.id))return!0;return!1},_computeGridLineItems:function(chartArea){function alignBorderValue(pixel){return alignPixel(chart,pixel,axisWidth)}var borderValue,i,tick,lineValue,alignedLineValue,tx1,ty1,tx2,ty2,x1,y1,x2,y2,lineWidth,lineColor,borderDash,borderDashOffset,me=this,chart=me.chart,options=me.options,gridLines=options.gridLines,position=options.position,offsetGridLines=gridLines.offsetGridLines,isHorizontal=me.isHorizontal(),ticks=me._ticksToDraw,ticksLength=ticks.length+(offsetGridLines?1:0),tl=getTickMarkLength(gridLines),items=[],axisWidth=gridLines.drawBorder?valueAtIndexOrDefault(gridLines.lineWidth,0,0):0,axisHalfWidth=axisWidth/2,alignPixel=helpers$1._alignPixel;for("top"===position?(borderValue=alignBorderValue(me.bottom),ty1=me.bottom-tl,ty2=borderValue-axisHalfWidth,y1=alignBorderValue(chartArea.top)+axisHalfWidth,y2=chartArea.bottom):"bottom"===position?(borderValue=alignBorderValue(me.top),y1=chartArea.top,y2=alignBorderValue(chartArea.bottom)-axisHalfWidth,ty1=borderValue+axisHalfWidth,ty2=me.top+tl):"left"===position?(borderValue=alignBorderValue(me.right),tx1=me.right-tl,tx2=borderValue-axisHalfWidth,x1=alignBorderValue(chartArea.left)+axisHalfWidth,x2=chartArea.right):(borderValue=alignBorderValue(me.left),x1=chartArea.left,x2=alignBorderValue(chartArea.right)-axisHalfWidth,tx1=borderValue+axisHalfWidth,tx2=me.left+tl),i=0;i<ticksLength;++i)tick=ticks[i]||{},isNullOrUndef(tick.label)&&i<ticks.length||(borderDashOffset=i===me.zeroLineIndex&&options.offset===offsetGridLines?(lineWidth=gridLines.zeroLineWidth,lineColor=gridLines.zeroLineColor,borderDash=gridLines.zeroLineBorderDash||[],gridLines.zeroLineBorderDashOffset||0):(lineWidth=valueAtIndexOrDefault(gridLines.lineWidth,i,1),lineColor=valueAtIndexOrDefault(gridLines.color,i,"rgba(0,0,0,0.1)"),borderDash=gridLines.borderDash||[],gridLines.borderDashOffset||0),void 0!==(lineValue=getPixelForGridLine(me,tick._index||i,offsetGridLines))&&(alignedLineValue=alignPixel(chart,lineValue,lineWidth),isHorizontal?tx1=tx2=x1=x2=alignedLineValue:ty1=ty2=y1=y2=alignedLineValue,items.push({tx1:tx1,ty1:ty1,tx2:tx2,ty2:ty2,x1:x1,y1:y1,x2:x2,y2:y2,width:lineWidth,color:lineColor,borderDash:borderDash,borderDashOffset:borderDashOffset})));return items.ticksLength=ticksLength,items.borderValue=borderValue,items},_computeLabelItems:function(){var i,ilen,tick,label,x,y,textAlign,pixel,font,lineHeight,lineCount,textOffset,me=this,options=me.options,optionTicks=options.ticks,position=options.position,isMirrored=optionTicks.mirror,isHorizontal=me.isHorizontal(),ticks=me._ticksToDraw,fonts=parseTickFontOptions(optionTicks),tickPadding=optionTicks.padding,tl=getTickMarkLength(options.gridLines),rotation=-helpers$1.toRadians(me.labelRotation),items=[];for(textAlign="top"===position?(y=me.bottom-tl-tickPadding,rotation?"left":"center"):"bottom"===position?(y=me.top+tl+tickPadding,rotation?"right":"center"):"left"===position?(x=me.right-(isMirrored?0:tl)-tickPadding,isMirrored?"left":"right"):(x=me.left+(isMirrored?0:tl)+tickPadding,isMirrored?"right":"left"),i=0,ilen=ticks.length;i<ilen;++i)label=(tick=ticks[i]).label,isNullOrUndef(label)||(pixel=me.getPixelForTick(tick._index||i)+optionTicks.labelOffset,lineHeight=(font=tick.major?fonts.major:fonts.minor).lineHeight,lineCount=isArray(label)?label.length:1,textOffset=isHorizontal?(x=pixel,"top"===position?((rotation?1:.5)-lineCount)*lineHeight:(rotation?0:.5)*lineHeight):(y=pixel,(1-lineCount)*lineHeight/2),items.push({x:x,y:y,rotation:rotation,label:label,font:font,textOffset:textOffset,textAlign:textAlign}));return items},_drawGrid:function(chartArea){var me=this,gridLines=me.options.gridLines;if(gridLines.display){var width,color,i,ilen,item,ctx=me.ctx,chart=me.chart,alignPixel=helpers$1._alignPixel,axisWidth=gridLines.drawBorder?valueAtIndexOrDefault(gridLines.lineWidth,0,0):0,items=me._gridLineItems||(me._gridLineItems=me._computeGridLineItems(chartArea));for(i=0,ilen=items.length;i<ilen;++i)width=(item=items[i]).width,color=item.color,width&&color&&(ctx.save(),ctx.lineWidth=width,ctx.strokeStyle=color,ctx.setLineDash&&(ctx.setLineDash(item.borderDash),ctx.lineDashOffset=item.borderDashOffset),ctx.beginPath(),gridLines.drawTicks&&(ctx.moveTo(item.tx1,item.ty1),ctx.lineTo(item.tx2,item.ty2)),gridLines.drawOnChartArea&&(ctx.moveTo(item.x1,item.y1),ctx.lineTo(item.x2,item.y2)),ctx.stroke(),ctx.restore());if(axisWidth){var x1,x2,y1,y2,firstLineWidth=axisWidth,lastLineWidth=valueAtIndexOrDefault(gridLines.lineWidth,items.ticksLength-1,1),borderValue=items.borderValue;me.isHorizontal()?(x1=alignPixel(chart,me.left,firstLineWidth)-firstLineWidth/2,x2=alignPixel(chart,me.right,lastLineWidth)+lastLineWidth/2,y1=y2=borderValue):(y1=alignPixel(chart,me.top,firstLineWidth)-firstLineWidth/2,y2=alignPixel(chart,me.bottom,lastLineWidth)+lastLineWidth/2,x1=x2=borderValue),ctx.lineWidth=axisWidth,ctx.strokeStyle=valueAtIndexOrDefault(gridLines.color,0),ctx.beginPath(),ctx.moveTo(x1,y1),ctx.lineTo(x2,y2),ctx.stroke()}}},_drawLabels:function(){var me=this;if(me.options.ticks.display){var i,j,ilen,jlen,item,tickFont,label,y,ctx=me.ctx,items=me._labelItems||(me._labelItems=me._computeLabelItems());for(i=0,ilen=items.length;i<ilen;++i){if(tickFont=(item=items[i]).font,ctx.save(),ctx.translate(item.x,item.y),ctx.rotate(item.rotation),ctx.font=tickFont.string,ctx.fillStyle=tickFont.color,ctx.textBaseline="middle",ctx.textAlign=item.textAlign,label=item.label,y=item.textOffset,isArray(label))for(j=0,jlen=label.length;j<jlen;++j)ctx.fillText(""+label[j],0,y),y+=tickFont.lineHeight;else ctx.fillText(label,0,y);ctx.restore()}}},_drawTitle:function(){var me=this,ctx=me.ctx,options=me.options,scaleLabel=options.scaleLabel;if(scaleLabel.display){var scaleLabelX,scaleLabelY,scaleLabelFontColor=valueOrDefault$a(scaleLabel.fontColor,core_defaults.global.defaultFontColor),scaleLabelFont=helpers$1.options._parseFont(scaleLabel),scaleLabelPadding=helpers$1.options.toPadding(scaleLabel.padding),halfLineHeight=scaleLabelFont.lineHeight/2,position=options.position,rotation=0;if(me.isHorizontal())scaleLabelX=me.left+me.width/2,scaleLabelY="bottom"===position?me.bottom-halfLineHeight-scaleLabelPadding.bottom:me.top+halfLineHeight+scaleLabelPadding.top;else{var isLeft="left"===position;scaleLabelX=isLeft?me.left+halfLineHeight+scaleLabelPadding.top:me.right-halfLineHeight-scaleLabelPadding.top,scaleLabelY=me.top+me.height/2,rotation=isLeft?-.5*Math.PI:.5*Math.PI}ctx.save(),ctx.translate(scaleLabelX,scaleLabelY),ctx.rotate(rotation),ctx.textAlign="center",ctx.textBaseline="middle",ctx.fillStyle=scaleLabelFontColor,ctx.font=scaleLabelFont.string,ctx.fillText(scaleLabel.labelString,0,0),ctx.restore()}},draw:function(chartArea){this._isVisible()&&(this._drawGrid(chartArea),this._drawTitle(),this._drawLabels())},_layers:function(){var me=this,opts=me.options,tz=opts.ticks&&opts.ticks.z||0,gz=opts.gridLines&&opts.gridLines.z||0;return me._isVisible()&&tz!==gz&&me.draw===me._draw?[{z:gz,draw:function(){me._drawGrid.apply(me,arguments),me._drawTitle.apply(me,arguments)}},{z:tz,draw:function(){me._drawLabels.apply(me,arguments)}}]:[{z:tz,draw:function(){me.draw.apply(me,arguments)}}]},_getMatchingVisibleMetas:function(type){var me=this,isHorizontal=me.isHorizontal();return me.chart._getSortedVisibleDatasetMetas().filter(function(meta){return(!type||meta.type===type)&&(isHorizontal?meta.xAxisID===me.id:meta.yAxisID===me.id)})}});Scale.prototype._draw=Scale.prototype.draw;var core_scale=Scale,isNullOrUndef$1=helpers$1.isNullOrUndef,scale_category=core_scale.extend({determineDataLimits:function(){var findIndex,me=this,labels=me._getLabels(),ticksOpts=me.options.ticks,min=ticksOpts.min,max=ticksOpts.max,minIndex=0,maxIndex=labels.length-1;void 0!==min&&0<=(findIndex=labels.indexOf(min))&&(minIndex=findIndex),void 0!==max&&0<=(findIndex=labels.indexOf(max))&&(maxIndex=findIndex),me.minIndex=minIndex,me.maxIndex=maxIndex,me.min=labels[minIndex],me.max=labels[maxIndex]},buildTicks:function(){var labels=this._getLabels(),minIndex=this.minIndex,maxIndex=this.maxIndex;this.ticks=0===minIndex&&maxIndex===labels.length-1?labels:labels.slice(minIndex,maxIndex+1)},getLabelForIndex:function(index,datasetIndex){var chart=this.chart;return chart.getDatasetMeta(datasetIndex).controller._getValueScaleId()===this.id?this.getRightValue(chart.data.datasets[datasetIndex].data[index]):this._getLabels()[index]},_configure:function(){var me=this,offset=me.options.offset,ticks=me.ticks;core_scale.prototype._configure.call(me),me.isHorizontal()||(me._reversePixels=!me._reversePixels),ticks&&(me._startValue=me.minIndex-(offset?.5:0),me._valueRange=Math.max(ticks.length-(offset?0:1),1))},getPixelForValue:function(value,index,datasetIndex){var valueCategory,labels,idx,me=this;return isNullOrUndef$1(index)||isNullOrUndef$1(datasetIndex)||(value=me.chart.data.datasets[datasetIndex].data[index]),isNullOrUndef$1(value)||(valueCategory=me.isHorizontal()?value.x:value.y),(void 0!==valueCategory||void 0!==value&&isNaN(index))&&(labels=me._getLabels(),value=helpers$1.valueOrDefault(valueCategory,value),index=-1!==(idx=labels.indexOf(value))?idx:index,isNaN(index)&&(index=value)),me.getPixelForDecimal((index-me._startValue)/me._valueRange)},getPixelForTick:function(index){var ticks=this.ticks;return index<0||index>ticks.length-1?null:this.getPixelForValue(ticks[index],index+this.minIndex)},getValueForPixel:function(pixel){var value=Math.round(this._startValue+this.getDecimalForPixel(pixel)*this._valueRange);return Math.min(Math.max(value,0),this.ticks.length-1)},getBasePixel:function(){return this.bottom}}),_defaults={position:"bottom"};scale_category._defaults=_defaults;var noop=helpers$1.noop,isNullOrUndef$2=helpers$1.isNullOrUndef;var scale_linearbase=core_scale.extend({getRightValue:function(value){return"string"==typeof value?+value:core_scale.prototype.getRightValue.call(this,value)},handleTickRangeOptions:function(){var me=this,tickOpts=me.options.ticks;if(tickOpts.beginAtZero){var minSign=helpers$1.sign(me.min),maxSign=helpers$1.sign(me.max);minSign<0&&maxSign<0?me.max=0:0<minSign&&0<maxSign&&(me.min=0)}var setMin=void 0!==tickOpts.min||void 0!==tickOpts.suggestedMin,setMax=void 0!==tickOpts.max||void 0!==tickOpts.suggestedMax;void 0!==tickOpts.min?me.min=tickOpts.min:void 0!==tickOpts.suggestedMin&&(null===me.min?me.min=tickOpts.suggestedMin:me.min=Math.min(me.min,tickOpts.suggestedMin)),void 0!==tickOpts.max?me.max=tickOpts.max:void 0!==tickOpts.suggestedMax&&(null===me.max?me.max=tickOpts.suggestedMax:me.max=Math.max(me.max,tickOpts.suggestedMax)),setMin!=setMax&&me.min>=me.max&&(setMin?me.max=me.min+1:me.min=me.max-1),me.min===me.max&&(me.max++,tickOpts.beginAtZero||me.min--)},getTickLimit:function(){var maxTicks,tickOpts=this.options.ticks,stepSize=tickOpts.stepSize,maxTicksLimit=tickOpts.maxTicksLimit;return stepSize?maxTicks=Math.ceil(this.max/stepSize)-Math.floor(this.min/stepSize)+1:(maxTicks=this._computeTickLimit(),maxTicksLimit=maxTicksLimit||11),maxTicksLimit&&(maxTicks=Math.min(maxTicksLimit,maxTicks)),maxTicks},_computeTickLimit:function(){return Number.POSITIVE_INFINITY},handleDirectionalChanges:noop,buildTicks:function(){var me=this,tickOpts=me.options.ticks,maxTicks=me.getTickLimit(),numericGeneratorOptions={maxTicks:maxTicks=Math.max(2,maxTicks),min:tickOpts.min,max:tickOpts.max,precision:tickOpts.precision,stepSize:helpers$1.valueOrDefault(tickOpts.fixedStepSize,tickOpts.stepSize)},ticks=me.ticks=function(generationOptions,dataRange){var factor,niceMin,niceMax,numSpaces,ticks=[],stepSize=generationOptions.stepSize,unit=stepSize||1,maxNumSpaces=generationOptions.maxTicks-1,min=generationOptions.min,max=generationOptions.max,precision=generationOptions.precision,rmin=dataRange.min,rmax=dataRange.max,spacing=helpers$1.niceNum((rmax-rmin)/maxNumSpaces/unit)*unit;if(spacing<1e-14&&isNullOrUndef$2(min)&&isNullOrUndef$2(max))return[rmin,rmax];maxNumSpaces<(numSpaces=Math.ceil(rmax/spacing)-Math.floor(rmin/spacing))&&(spacing=helpers$1.niceNum(numSpaces*spacing/maxNumSpaces/unit)*unit),stepSize||isNullOrUndef$2(precision)?factor=Math.pow(10,helpers$1._decimalPlaces(spacing)):(factor=Math.pow(10,precision),spacing=Math.ceil(spacing*factor)/factor),niceMin=Math.floor(rmin/spacing)*spacing,niceMax=Math.ceil(rmax/spacing)*spacing,stepSize&&(!isNullOrUndef$2(min)&&helpers$1.almostWhole(min/spacing,spacing/1e3)&&(niceMin=min),!isNullOrUndef$2(max)&&helpers$1.almostWhole(max/spacing,spacing/1e3)&&(niceMax=max)),numSpaces=(niceMax-niceMin)/spacing,numSpaces=helpers$1.almostEquals(numSpaces,Math.round(numSpaces),spacing/1e3)?Math.round(numSpaces):Math.ceil(numSpaces),niceMin=Math.round(niceMin*factor)/factor,niceMax=Math.round(niceMax*factor)/factor,ticks.push(isNullOrUndef$2(min)?niceMin:min);for(var j=1;j<numSpaces;++j)ticks.push(Math.round((niceMin+j*spacing)*factor)/factor);return ticks.push(isNullOrUndef$2(max)?niceMax:max),ticks}(numericGeneratorOptions,me);me.handleDirectionalChanges(),me.max=helpers$1.max(ticks),me.min=helpers$1.min(ticks),tickOpts.reverse?(ticks.reverse(),me.start=me.max,me.end=me.min):(me.start=me.min,me.end=me.max)},convertTicksToLabels:function(){var me=this;me.ticksAsNumbers=me.ticks.slice(),me.zeroLineIndex=me.ticks.indexOf(0),core_scale.prototype.convertTicksToLabels.call(me)},_configure:function(){var offset,me=this,ticks=me.getTicks(),start=me.min,end=me.max;core_scale.prototype._configure.call(me),me.options.offset&&ticks.length&&(start-=offset=(end-start)/Math.max(ticks.length-1,1)/2,end+=offset),me._startValue=start,me._endValue=end,me._valueRange=end-start}}),defaultConfig$1={position:"left",ticks:{callback:core_ticks.formatters.linear}};function stackData(scale,stacks,meta,data){var i,value,opts=scale.options,stack=function(stacks,stacked,meta){var key=[meta.type,void 0===stacked&&void 0===meta.stack?meta.index:"",meta.stack].join(".");return void 0===stacks[key]&&(stacks[key]={pos:[],neg:[]}),stacks[key]}(stacks,opts.stacked,meta),pos=stack.pos,neg=stack.neg,ilen=data.length;for(i=0;i<ilen;++i)value=scale._parseValue(data[i]),isNaN(value.min)||isNaN(value.max)||meta.data[i].hidden||(pos[i]=pos[i]||0,neg[i]=neg[i]||0,opts.relativePoints?pos[i]=100:value.min<0||value.max<0?neg[i]+=value.min:pos[i]+=value.max)}function updateMinMax(scale,meta,data){var i,value,ilen=data.length;for(i=0;i<ilen;++i)value=scale._parseValue(data[i]),isNaN(value.min)||isNaN(value.max)||meta.data[i].hidden||(scale.min=Math.min(scale.min,value.min),scale.max=Math.max(scale.max,value.max))}var scale_linear=scale_linearbase.extend({determineDataLimits:function(){var i,meta,data,values,me=this,opts=me.options,datasets=me.chart.data.datasets,metasets=me._getMatchingVisibleMetas(),hasStacks=opts.stacked,stacks={},ilen=metasets.length;if(me.min=Number.POSITIVE_INFINITY,me.max=Number.NEGATIVE_INFINITY,void 0===hasStacks)for(i=0;!hasStacks&&i<ilen;++i)hasStacks=void 0!==(meta=metasets[i]).stack;for(i=0;i<ilen;++i)data=datasets[(meta=metasets[i]).index].data,hasStacks?stackData(me,stacks,meta,data):updateMinMax(me,meta,data);helpers$1.each(stacks,function(stackValues){values=stackValues.pos.concat(stackValues.neg),me.min=Math.min(me.min,helpers$1.min(values)),me.max=Math.max(me.max,helpers$1.max(values))}),me.min=helpers$1.isFinite(me.min)&&!isNaN(me.min)?me.min:0,me.max=helpers$1.isFinite(me.max)&&!isNaN(me.max)?me.max:1,me.handleTickRangeOptions()},_computeTickLimit:function(){var tickFont;return this.isHorizontal()?Math.ceil(this.width/40):(tickFont=helpers$1.options._parseFont(this.options.ticks),Math.ceil(this.height/tickFont.lineHeight))},handleDirectionalChanges:function(){this.isHorizontal()||this.ticks.reverse()},getLabelForIndex:function(index,datasetIndex){return this._getScaleLabel(this.chart.data.datasets[datasetIndex].data[index])},getPixelForValue:function(value){return this.getPixelForDecimal((this.getRightValue(value)-this._startValue)/this._valueRange)},getValueForPixel:function(pixel){return this._startValue+this.getDecimalForPixel(pixel)*this._valueRange},getPixelForTick:function(index){var ticks=this.ticksAsNumbers;return index<0||index>ticks.length-1?null:this.getPixelForValue(ticks[index])}}),_defaults$1=defaultConfig$1;scale_linear._defaults=_defaults$1;var valueOrDefault$b=helpers$1.valueOrDefault,log10=helpers$1.math.log10;var defaultConfig$2={position:"left",ticks:{callback:core_ticks.formatters.logarithmic}};function nonNegativeOrDefault(value,defaultValue){return helpers$1.isFinite(value)&&0<=value?value:defaultValue}var scale_logarithmic=core_scale.extend({determineDataLimits:function(){var datasetIndex,meta,value,data,i,ilen,me=this,opts=me.options,chart=me.chart,datasets=chart.data.datasets,isHorizontal=me.isHorizontal();function IDMatches(meta){return isHorizontal?meta.xAxisID===me.id:meta.yAxisID===me.id}me.min=Number.POSITIVE_INFINITY,me.max=Number.NEGATIVE_INFINITY,me.minNotZero=Number.POSITIVE_INFINITY;var hasStacks=opts.stacked;if(void 0===hasStacks)for(datasetIndex=0;datasetIndex<datasets.length;datasetIndex++)if(meta=chart.getDatasetMeta(datasetIndex),chart.isDatasetVisible(datasetIndex)&&IDMatches(meta)&&void 0!==meta.stack){hasStacks=!0;break}if(opts.stacked||hasStacks){var valuesPerStack={};for(datasetIndex=0;datasetIndex<datasets.length;datasetIndex++){var key=[(meta=chart.getDatasetMeta(datasetIndex)).type,void 0===opts.stacked&&void 0===meta.stack?datasetIndex:"",meta.stack].join(".");if(chart.isDatasetVisible(datasetIndex)&&IDMatches(meta))for(void 0===valuesPerStack[key]&&(valuesPerStack[key]=[]),i=0,ilen=(data=datasets[datasetIndex].data).length;i<ilen;i++){var values=valuesPerStack[key];value=me._parseValue(data[i]),isNaN(value.min)||isNaN(value.max)||meta.data[i].hidden||value.min<0||value.max<0||(values[i]=values[i]||0,values[i]+=value.max)}}helpers$1.each(valuesPerStack,function(valuesForType){if(0<valuesForType.length){var minVal=helpers$1.min(valuesForType),maxVal=helpers$1.max(valuesForType);me.min=Math.min(me.min,minVal),me.max=Math.max(me.max,maxVal)}})}else for(datasetIndex=0;datasetIndex<datasets.length;datasetIndex++)if(meta=chart.getDatasetMeta(datasetIndex),chart.isDatasetVisible(datasetIndex)&&IDMatches(meta))for(i=0,ilen=(data=datasets[datasetIndex].data).length;i<ilen;i++)value=me._parseValue(data[i]),isNaN(value.min)||isNaN(value.max)||meta.data[i].hidden||value.min<0||value.max<0||(me.min=Math.min(value.min,me.min),me.max=Math.max(value.max,me.max),0!==value.min&&(me.minNotZero=Math.min(value.min,me.minNotZero)));me.min=helpers$1.isFinite(me.min)?me.min:null,me.max=helpers$1.isFinite(me.max)?me.max:null,me.minNotZero=helpers$1.isFinite(me.minNotZero)?me.minNotZero:null,this.handleTickRangeOptions()},handleTickRangeOptions:function(){var me=this,tickOpts=me.options.ticks;me.min=nonNegativeOrDefault(tickOpts.min,me.min),me.max=nonNegativeOrDefault(tickOpts.max,me.max),me.min===me.max&&(0!==me.min&&null!==me.min?(me.min=Math.pow(10,Math.floor(log10(me.min))-1),me.max=Math.pow(10,Math.floor(log10(me.max))+1)):(me.min=1,me.max=10)),null===me.min&&(me.min=Math.pow(10,Math.floor(log10(me.max))-1)),null===me.max&&(me.max=0!==me.min?Math.pow(10,Math.floor(log10(me.min))+1):10),null===me.minNotZero&&(0<me.min?me.minNotZero=me.min:me.max<1?me.minNotZero=Math.pow(10,Math.floor(log10(me.max))):me.minNotZero=1)},buildTicks:function(){var me=this,tickOpts=me.options.ticks,reverse=!me.isHorizontal(),generationOptions={min:nonNegativeOrDefault(tickOpts.min),max:nonNegativeOrDefault(tickOpts.max)},ticks=me.ticks=function(generationOptions,dataRange){var exp,significand,ticks=[],tickVal=valueOrDefault$b(generationOptions.min,Math.pow(10,Math.floor(log10(dataRange.min)))),endExp=Math.floor(log10(dataRange.max)),endSignificand=Math.ceil(dataRange.max/Math.pow(10,endExp));0===tickVal?(exp=Math.floor(log10(dataRange.minNotZero)),significand=Math.floor(dataRange.minNotZero/Math.pow(10,exp)),ticks.push(tickVal),tickVal=significand*Math.pow(10,exp)):(exp=Math.floor(log10(tickVal)),significand=Math.floor(tickVal/Math.pow(10,exp)));for(var precision=exp<0?Math.pow(10,Math.abs(exp)):1;ticks.push(tickVal),10===++significand&&(significand=1,precision=0<=++exp?1:precision),tickVal=Math.round(significand*Math.pow(10,exp)*precision)/precision,exp<endExp||exp===endExp&&significand<endSignificand;);var lastTick=valueOrDefault$b(generationOptions.max,tickVal);return ticks.push(lastTick),ticks}(generationOptions,me);me.max=helpers$1.max(ticks),me.min=helpers$1.min(ticks),tickOpts.reverse?(reverse=!reverse,me.start=me.max,me.end=me.min):(me.start=me.min,me.end=me.max),reverse&&ticks.reverse()},convertTicksToLabels:function(){this.tickValues=this.ticks.slice(),core_scale.prototype.convertTicksToLabels.call(this)},getLabelForIndex:function(index,datasetIndex){return this._getScaleLabel(this.chart.data.datasets[datasetIndex].data[index])},getPixelForTick:function(index){var ticks=this.tickValues;return index<0||index>ticks.length-1?null:this.getPixelForValue(ticks[index])},_getFirstTickValue:function(value){var exp=Math.floor(log10(value));return Math.floor(value/Math.pow(10,exp))*Math.pow(10,exp)},_configure:function(){var me=this,start=me.min,offset=0;core_scale.prototype._configure.call(me),0===start&&(start=me._getFirstTickValue(me.minNotZero),offset=valueOrDefault$b(me.options.ticks.fontSize,core_defaults.global.defaultFontSize)/me._length),me._startValue=log10(start),me._valueOffset=offset,me._valueRange=(log10(me.max)-log10(start))/(1-offset)},getPixelForValue:function(value){var me=this,decimal=0;return(value=+me.getRightValue(value))>me.min&&0<value&&(decimal=(log10(value)-me._startValue)/me._valueRange+me._valueOffset),me.getPixelForDecimal(decimal)},getValueForPixel:function(pixel){var me=this,decimal=me.getDecimalForPixel(pixel);return 0===decimal&&0===me.min?0:Math.pow(10,me._startValue+(decimal-me._valueOffset)*me._valueRange)}}),_defaults$2=defaultConfig$2;scale_logarithmic._defaults=_defaults$2;var valueOrDefault$c=helpers$1.valueOrDefault,valueAtIndexOrDefault$1=helpers$1.valueAtIndexOrDefault,resolve$4=helpers$1.options.resolve,defaultConfig$3={display:!0,animate:!0,position:"chartArea",angleLines:{display:!0,color:"rgba(0,0,0,0.1)",lineWidth:1,borderDash:[],borderDashOffset:0},gridLines:{circular:!1},ticks:{showLabelBackdrop:!0,backdropColor:"rgba(255,255,255,0.75)",backdropPaddingY:2,backdropPaddingX:2,callback:core_ticks.formatters.linear},pointLabels:{display:!0,fontSize:10,callback:function(label){return label}}};function getTickBackdropHeight(opts){var tickOpts=opts.ticks;return tickOpts.display&&opts.display?valueOrDefault$c(tickOpts.fontSize,core_defaults.global.defaultFontSize)+2*tickOpts.backdropPaddingY:0}function determineLimits(angle,pos,size,min,max){return angle===min||angle===max?{start:pos-size/2,end:pos+size/2}:angle<min||max<angle?{start:pos-size,end:pos}:{start:pos,end:pos+size}}function getTextAlignForAngle(angle){return 0===angle||180===angle?"center":angle<180?"left":"right"}function fillText(ctx,text,position,lineHeight){var i,ilen,y=position.y+lineHeight/2;if(helpers$1.isArray(text))for(i=0,ilen=text.length;i<ilen;++i)ctx.fillText(text[i],position.x,y),y+=lineHeight;else ctx.fillText(text,position.x,y)}function adjustPointPositionForLabelHeight(angle,textSize,position){90===angle||270===angle?position.y-=textSize.h/2:(270<angle||angle<90)&&(position.y-=textSize.h)}function numberOrZero(param){return helpers$1.isNumber(param)?param:0}var scale_radialLinear=scale_linearbase.extend({setDimensions:function(){var me=this;me.width=me.maxWidth,me.height=me.maxHeight,me.paddingTop=getTickBackdropHeight(me.options)/2,me.xCenter=Math.floor(me.width/2),me.yCenter=Math.floor((me.height-me.paddingTop)/2),me.drawingArea=Math.min(me.height-me.paddingTop,me.width)/2},determineDataLimits:function(){var me=this,chart=me.chart,min=Number.POSITIVE_INFINITY,max=Number.NEGATIVE_INFINITY;helpers$1.each(chart.data.datasets,function(dataset,datasetIndex){if(chart.isDatasetVisible(datasetIndex)){var meta=chart.getDatasetMeta(datasetIndex);helpers$1.each(dataset.data,function(rawValue,index){var value=+me.getRightValue(rawValue);isNaN(value)||meta.data[index].hidden||(min=Math.min(value,min),max=Math.max(value,max))})}}),me.min=min===Number.POSITIVE_INFINITY?0:min,me.max=max===Number.NEGATIVE_INFINITY?0:max,me.handleTickRangeOptions()},_computeTickLimit:function(){return Math.ceil(this.drawingArea/getTickBackdropHeight(this.options))},convertTicksToLabels:function(){var me=this;scale_linearbase.prototype.convertTicksToLabels.call(me),me.pointLabels=me.chart.data.labels.map(function(){var label=helpers$1.callback(me.options.pointLabels.callback,arguments,me);return label||0===label?label:""})},getLabelForIndex:function(index,datasetIndex){return+this.getRightValue(this.chart.data.datasets[datasetIndex].data[index])},fit:function(){var opts=this.options;opts.display&&opts.pointLabels.display?function(scale){var i,textSize,pointPosition,plFont=helpers$1.options._parseFont(scale.options.pointLabels),furthestLimits={l:0,r:scale.width,t:0,b:scale.height-scale.paddingTop},furthestAngles={};scale.ctx.font=plFont.string,scale._pointLabelSizes=[];var ctx,lineHeight,label,valueCount=scale.chart.data.labels.length;for(i=0;i<valueCount;i++){pointPosition=scale.getPointPosition(i,scale.drawingArea+5),ctx=scale.ctx,lineHeight=plFont.lineHeight,label=scale.pointLabels[i],textSize=helpers$1.isArray(label)?{w:helpers$1.longestText(ctx,ctx.font,label),h:label.length*lineHeight}:{w:ctx.measureText(label).width,h:lineHeight},scale._pointLabelSizes[i]=textSize;var angleRadians=scale.getIndexAngle(i),angle=helpers$1.toDegrees(angleRadians)%360,hLimits=determineLimits(angle,pointPosition.x,textSize.w,0,180),vLimits=determineLimits(angle,pointPosition.y,textSize.h,90,270);hLimits.start<furthestLimits.l&&(furthestLimits.l=hLimits.start,furthestAngles.l=angleRadians),hLimits.end>furthestLimits.r&&(furthestLimits.r=hLimits.end,furthestAngles.r=angleRadians),vLimits.start<furthestLimits.t&&(furthestLimits.t=vLimits.start,furthestAngles.t=angleRadians),vLimits.end>furthestLimits.b&&(furthestLimits.b=vLimits.end,furthestAngles.b=angleRadians)}scale.setReductions(scale.drawingArea,furthestLimits,furthestAngles)}(this):this.setCenterPoint(0,0,0,0)},setReductions:function(largestPossibleRadius,furthestLimits,furthestAngles){var me=this,radiusReductionLeft=furthestLimits.l/Math.sin(furthestAngles.l),radiusReductionRight=Math.max(furthestLimits.r-me.width,0)/Math.sin(furthestAngles.r),radiusReductionTop=-furthestLimits.t/Math.cos(furthestAngles.t),radiusReductionBottom=-Math.max(furthestLimits.b-(me.height-me.paddingTop),0)/Math.cos(furthestAngles.b);radiusReductionLeft=numberOrZero(radiusReductionLeft),radiusReductionRight=numberOrZero(radiusReductionRight),radiusReductionTop=numberOrZero(radiusReductionTop),radiusReductionBottom=numberOrZero(radiusReductionBottom),me.drawingArea=Math.min(Math.floor(largestPossibleRadius-(radiusReductionLeft+radiusReductionRight)/2),Math.floor(largestPossibleRadius-(radiusReductionTop+radiusReductionBottom)/2)),me.setCenterPoint(radiusReductionLeft,radiusReductionRight,radiusReductionTop,radiusReductionBottom)},setCenterPoint:function(leftMovement,rightMovement,topMovement,bottomMovement){var me=this,maxRight=me.width-rightMovement-me.drawingArea,maxLeft=leftMovement+me.drawingArea,maxTop=topMovement+me.drawingArea,maxBottom=me.height-me.paddingTop-bottomMovement-me.drawingArea;me.xCenter=Math.floor((maxLeft+maxRight)/2+me.left),me.yCenter=Math.floor((maxTop+maxBottom)/2+me.top+me.paddingTop)},getIndexAngle:function(index){var chart=this.chart,angle=(index*(360/chart.data.labels.length)+((chart.options||{}).startAngle||0))%360;return(angle<0?360+angle:angle)*Math.PI*2/360},getDistanceFromCenterForValue:function(value){var me=this;if(helpers$1.isNullOrUndef(value))return NaN;var scalingFactor=me.drawingArea/(me.max-me.min);return me.options.ticks.reverse?(me.max-value)*scalingFactor:(value-me.min)*scalingFactor},getPointPosition:function(index,distanceFromCenter){var thisAngle=this.getIndexAngle(index)-Math.PI/2;return{x:Math.cos(thisAngle)*distanceFromCenter+this.xCenter,y:Math.sin(thisAngle)*distanceFromCenter+this.yCenter}},getPointPositionForValue:function(index,value){return this.getPointPosition(index,this.getDistanceFromCenterForValue(value))},getBasePosition:function(index){var min=this.min,max=this.max;return this.getPointPositionForValue(index||0,this.beginAtZero?0:min<0&&max<0?max:0<min&&0<max?min:0)},_drawGrid:function(){var i,offset,position,me=this,ctx=me.ctx,opts=me.options,gridLineOpts=opts.gridLines,angleLineOpts=opts.angleLines,lineWidth=valueOrDefault$c(angleLineOpts.lineWidth,gridLineOpts.lineWidth),lineColor=valueOrDefault$c(angleLineOpts.color,gridLineOpts.color);if(opts.pointLabels.display&&function(scale){var ctx=scale.ctx,opts=scale.options,pointLabelOpts=opts.pointLabels,tickBackdropHeight=getTickBackdropHeight(opts),outerDistance=scale.getDistanceFromCenterForValue(opts.ticks.reverse?scale.min:scale.max),plFont=helpers$1.options._parseFont(pointLabelOpts);ctx.save(),ctx.font=plFont.string,ctx.textBaseline="middle";for(var i=scale.chart.data.labels.length-1;0<=i;i--){var extra=0===i?tickBackdropHeight/2:0,pointLabelPosition=scale.getPointPosition(i,outerDistance+extra+5),pointLabelFontColor=valueAtIndexOrDefault$1(pointLabelOpts.fontColor,i,core_defaults.global.defaultFontColor);ctx.fillStyle=pointLabelFontColor;var angleRadians=scale.getIndexAngle(i),angle=helpers$1.toDegrees(angleRadians);ctx.textAlign=getTextAlignForAngle(angle),adjustPointPositionForLabelHeight(angle,scale._pointLabelSizes[i],pointLabelPosition),fillText(ctx,scale.pointLabels[i],pointLabelPosition,plFont.lineHeight)}ctx.restore()}(me),gridLineOpts.display&&helpers$1.each(me.ticks,function(label,index){0!==index&&(offset=me.getDistanceFromCenterForValue(me.ticksAsNumbers[index]),function(scale,gridLineOpts,radius,index){var pointPosition,ctx=scale.ctx,circular=gridLineOpts.circular,valueCount=scale.chart.data.labels.length,lineColor=valueAtIndexOrDefault$1(gridLineOpts.color,index-1),lineWidth=valueAtIndexOrDefault$1(gridLineOpts.lineWidth,index-1);if((circular||valueCount)&&lineColor&&lineWidth){if(ctx.save(),ctx.strokeStyle=lineColor,ctx.lineWidth=lineWidth,ctx.setLineDash&&(ctx.setLineDash(gridLineOpts.borderDash||[]),ctx.lineDashOffset=gridLineOpts.borderDashOffset||0),ctx.beginPath(),circular)ctx.arc(scale.xCenter,scale.yCenter,radius,0,2*Math.PI);else{pointPosition=scale.getPointPosition(0,radius),ctx.moveTo(pointPosition.x,pointPosition.y);for(var i=1;i<valueCount;i++)pointPosition=scale.getPointPosition(i,radius),ctx.lineTo(pointPosition.x,pointPosition.y)}ctx.closePath(),ctx.stroke(),ctx.restore()}}(me,gridLineOpts,offset,index))}),angleLineOpts.display&&lineWidth&&lineColor){for(ctx.save(),ctx.lineWidth=lineWidth,ctx.strokeStyle=lineColor,ctx.setLineDash&&(ctx.setLineDash(resolve$4([angleLineOpts.borderDash,gridLineOpts.borderDash,[]])),ctx.lineDashOffset=resolve$4([angleLineOpts.borderDashOffset,gridLineOpts.borderDashOffset,0])),i=me.chart.data.labels.length-1;0<=i;i--)offset=me.getDistanceFromCenterForValue(opts.ticks.reverse?me.min:me.max),position=me.getPointPosition(i,offset),ctx.beginPath(),ctx.moveTo(me.xCenter,me.yCenter),ctx.lineTo(position.x,position.y),ctx.stroke();ctx.restore()}},_drawLabels:function(){var me=this,ctx=me.ctx,tickOpts=me.options.ticks;if(tickOpts.display){var offset,width,startAngle=me.getIndexAngle(0),tickFont=helpers$1.options._parseFont(tickOpts),tickFontColor=valueOrDefault$c(tickOpts.fontColor,core_defaults.global.defaultFontColor);ctx.save(),ctx.font=tickFont.string,ctx.translate(me.xCenter,me.yCenter),ctx.rotate(startAngle),ctx.textAlign="center",ctx.textBaseline="middle",helpers$1.each(me.ticks,function(label,index){0===index&&!tickOpts.reverse||(offset=me.getDistanceFromCenterForValue(me.ticksAsNumbers[index]),tickOpts.showLabelBackdrop&&(width=ctx.measureText(label).width,ctx.fillStyle=tickOpts.backdropColor,ctx.fillRect(-width/2-tickOpts.backdropPaddingX,-offset-tickFont.size/2-tickOpts.backdropPaddingY,width+2*tickOpts.backdropPaddingX,tickFont.size+2*tickOpts.backdropPaddingY)),ctx.fillStyle=tickFontColor,ctx.fillText(label,0,-offset))}),ctx.restore()}},_drawTitle:helpers$1.noop}),_defaults$3=defaultConfig$3;scale_radialLinear._defaults=_defaults$3;var deprecated$1=helpers$1._deprecated,resolve$5=helpers$1.options.resolve,valueOrDefault$d=helpers$1.valueOrDefault,MIN_INTEGER=Number.MIN_SAFE_INTEGER||-9007199254740991,MAX_INTEGER=Number.MAX_SAFE_INTEGER||9007199254740991,INTERVALS={millisecond:{common:!0,size:1,steps:1e3},second:{common:!0,size:1e3,steps:60},minute:{common:!0,size:6e4,steps:60},hour:{common:!0,size:36e5,steps:24},day:{common:!0,size:864e5,steps:30},week:{common:!1,size:6048e5,steps:4},month:{common:!0,size:2628e6,steps:12},quarter:{common:!1,size:7884e6,steps:4},year:{common:!0,size:3154e7}},UNITS=Object.keys(INTERVALS);function sorter(a,b){return a-b}function getMin(options){return helpers$1.valueOrDefault(options.time.min,options.ticks.min)}function getMax(options){return helpers$1.valueOrDefault(options.time.max,options.ticks.max)}function interpolate$1(table,skey,sval,tkey){var range=function(table,key,value){for(var mid,i0,i1,lo=0,hi=table.length-1;0<=lo&&lo<=hi;){if(i0=table[(mid=lo+hi>>1)-1]||null,i1=table[mid],!i0)return{lo:null,hi:i1};if(i1[key]<value)lo=1+mid;else{if(!(i0[key]>value))return{lo:i0,hi:i1};hi=mid-1}}return{lo:i1,hi:null}}(table,skey,sval),prev=range.lo?range.hi?range.lo:table[table.length-2]:table[0],next=range.lo?range.hi?range.hi:table[table.length-1]:table[1],span=next[skey]-prev[skey],ratio=span?(sval-prev[skey])/span:0,offset=(next[tkey]-prev[tkey])*ratio;return prev[tkey]+offset}function toTimestamp(scale,input){var adapter=scale._adapter,options=scale.options.time,parser=options.parser,format=parser||options.format,value=input;return"function"==typeof parser&&(value=parser(value)),helpers$1.isFinite(value)||(value="string"==typeof format?adapter.parse(value,format):adapter.parse(value)),null!==value?+value:(parser||"function"!=typeof format||(value=format(input),helpers$1.isFinite(value)||(value=adapter.parse(value))),value)}function parse(scale,input){if(helpers$1.isNullOrUndef(input))return null;var options=scale.options.time,value=toTimestamp(scale,scale.getRightValue(input));return null===value||options.round&&(value=+scale._adapter.startOf(value,options.round)),value}function determineUnitForAutoTicks(minUnit,min,max,capacity){var i,interval,factor,ilen=UNITS.length;for(i=UNITS.indexOf(minUnit);i<ilen-1;++i)if(factor=(interval=INTERVALS[UNITS[i]]).steps?interval.steps:MAX_INTEGER,interval.common&&Math.ceil((max-min)/(factor*interval.size))<=capacity)return UNITS[i];return UNITS[ilen-1]}function ticksFromTimestamps(scale,values,majorUnit){var i,value,ticks=[],map={},ilen=values.length;for(i=0;i<ilen;++i)map[value=values[i]]=i,ticks.push({value:value,major:!1});return 0!==ilen&&majorUnit?function(scale,ticks,map,majorUnit){var major,index,adapter=scale._adapter,first=+adapter.startOf(ticks[0].value,majorUnit),last=ticks[ticks.length-1].value;for(major=first;major<=last;major=+adapter.add(major,1,majorUnit))0<=(index=map[major])&&(ticks[index].major=!0);return ticks}(scale,ticks,map,majorUnit):ticks}var scale_time=core_scale.extend({initialize:function(){this.mergeTicksOptions(),core_scale.prototype.initialize.call(this)},update:function(){var options=this.options,time=options.time||(options.time={}),adapter=this._adapter=new core_adapters._date(options.adapters.date);return deprecated$1("time scale",time.format,"time.format","time.parser"),deprecated$1("time scale",time.min,"time.min","ticks.min"),deprecated$1("time scale",time.max,"time.max","ticks.max"),helpers$1.mergeIf(time.displayFormats,adapter.formats()),core_scale.prototype.update.apply(this,arguments)},getRightValue:function(rawValue){return rawValue&&void 0!==rawValue.t&&(rawValue=rawValue.t),core_scale.prototype.getRightValue.call(this,rawValue)},determineDataLimits:function(){var i,j,ilen,jlen,data,timestamp,labelsAdded,me=this,chart=me.chart,adapter=me._adapter,options=me.options,unit=options.time.unit||"day",min=MAX_INTEGER,max=MIN_INTEGER,timestamps=[],datasets=[],labels=[],dataLabels=me._getLabels();for(i=0,ilen=dataLabels.length;i<ilen;++i)labels.push(parse(me,dataLabels[i]));for(i=0,ilen=(chart.data.datasets||[]).length;i<ilen;++i)if(chart.isDatasetVisible(i))if(data=chart.data.datasets[i].data,helpers$1.isObject(data[0]))for(datasets[i]=[],j=0,jlen=data.length;j<jlen;++j)timestamp=parse(me,data[j]),timestamps.push(timestamp),datasets[i][j]=timestamp;else datasets[i]=labels.slice(0),labelsAdded||(timestamps=timestamps.concat(labels),labelsAdded=!0);else datasets[i]=[];labels.length&&(min=Math.min(min,labels[0]),max=Math.max(max,labels[labels.length-1])),timestamps.length&&(timestamps=1<ilen?function(items){var i,ilen,item,hash={},out=[];for(i=0,ilen=items.length;i<ilen;++i)hash[item=items[i]]||(hash[item]=!0,out.push(item));return out}(timestamps).sort(sorter):timestamps.sort(sorter),min=Math.min(min,timestamps[0]),max=Math.max(max,timestamps[timestamps.length-1])),min=parse(me,getMin(options))||min,max=parse(me,getMax(options))||max,min=min===MAX_INTEGER?+adapter.startOf(Date.now(),unit):min,max=max===MIN_INTEGER?+adapter.endOf(Date.now(),unit)+1:max,me.min=Math.min(min,max),me.max=Math.max(min+1,max),me._table=[],me._timestamps={data:timestamps,datasets:datasets,labels:labels}},buildTicks:function(){var i,ilen,timestamp,me=this,min=me.min,max=me.max,options=me.options,tickOpts=options.ticks,timeOpts=options.time,timestamps=me._timestamps,ticks=[],capacity=me.getLabelCapacity(min),source=tickOpts.source,distribution=options.distribution;for(timestamps="data"===source||"auto"===source&&"series"===distribution?timestamps.data:"labels"===source?timestamps.labels:function(scale,min,max,capacity){var time,adapter=scale._adapter,options=scale.options,timeOpts=options.time,minor=timeOpts.unit||determineUnitForAutoTicks(timeOpts.minUnit,min,max,capacity),stepSize=resolve$5([timeOpts.stepSize,timeOpts.unitStepSize,1]),weekday="week"===minor&&timeOpts.isoWeekday,first=min,ticks=[];if(weekday&&(first=+adapter.startOf(first,"isoWeek",weekday)),first=+adapter.startOf(first,weekday?"day":minor),adapter.diff(max,min,minor)>1e5*stepSize)throw min+" and "+max+" are too far apart with stepSize of "+stepSize+" "+minor;for(time=first;time<max;time=+adapter.add(time,stepSize,minor))ticks.push(time);return time!==max&&"ticks"!==options.bounds||ticks.push(time),ticks}(me,min,max,capacity),"ticks"===options.bounds&&timestamps.length&&(min=timestamps[0],max=timestamps[timestamps.length-1]),min=parse(me,getMin(options))||min,max=parse(me,getMax(options))||max,i=0,ilen=timestamps.length;i<ilen;++i)min<=(timestamp=timestamps[i])&&timestamp<=max&&ticks.push(timestamp);return me.min=min,me.max=max,me._unit=timeOpts.unit||(tickOpts.autoSkip?determineUnitForAutoTicks(timeOpts.minUnit,me.min,me.max,capacity):function(scale,numTicks,minUnit,min,max){var i,unit;for(i=UNITS.length-1;i>=UNITS.indexOf(minUnit);i--)if(unit=UNITS[i],INTERVALS[unit].common&&scale._adapter.diff(max,min,unit)>=numTicks-1)return unit;return UNITS[minUnit?UNITS.indexOf(minUnit):0]}(me,ticks.length,timeOpts.minUnit,me.min,me.max)),me._majorUnit=tickOpts.major.enabled&&"year"!==me._unit?function(unit){for(var i=UNITS.indexOf(unit)+1,ilen=UNITS.length;i<ilen;++i)if(INTERVALS[UNITS[i]].common)return UNITS[i]}(me._unit):void 0,me._table=function(timestamps,min,max,distribution){if("linear"===distribution||!timestamps.length)return[{time:min,pos:0},{time:max,pos:1}];var i,ilen,prev,curr,next,table=[],items=[min];for(i=0,ilen=timestamps.length;i<ilen;++i)min<(curr=timestamps[i])&&curr<max&&items.push(curr);for(items.push(max),i=0,ilen=items.length;i<ilen;++i)next=items[i+1],prev=items[i-1],curr=items[i],void 0!==prev&&void 0!==next&&Math.round((next+prev)/2)===curr||table.push({time:curr,pos:i/(ilen-1)});return table}(me._timestamps.data,min,max,distribution),me._offsets=function(table,ticks,min,max,options){var first,last,start=0,end=0;return options.offset&&ticks.length&&(first=interpolate$1(table,"time",ticks[0],"pos"),start=1===ticks.length?1-first:(interpolate$1(table,"time",ticks[1],"pos")-first)/2,last=interpolate$1(table,"time",ticks[ticks.length-1],"pos"),end=1===ticks.length?last:(last-interpolate$1(table,"time",ticks[ticks.length-2],"pos"))/2),{start:start,end:end,factor:1/(start+1+end)}}(me._table,ticks,0,0,options),tickOpts.reverse&&ticks.reverse(),ticksFromTimestamps(me,ticks,me._majorUnit)},getLabelForIndex:function(index,datasetIndex){var me=this,adapter=me._adapter,data=me.chart.data,timeOpts=me.options.time,label=data.labels&&index<data.labels.length?data.labels[index]:"",value=data.datasets[datasetIndex].data[index];return helpers$1.isObject(value)&&(label=me.getRightValue(value)),timeOpts.tooltipFormat?adapter.format(toTimestamp(me,label),timeOpts.tooltipFormat):"string"==typeof label?label:adapter.format(toTimestamp(me,label),timeOpts.displayFormats.datetime)},tickFormatFunction:function(time,index,ticks,format){var adapter=this._adapter,options=this.options,formats=options.time.displayFormats,minorFormat=formats[this._unit],majorUnit=this._majorUnit,majorFormat=formats[majorUnit],tick=ticks[index],tickOpts=options.ticks,major=majorUnit&&majorFormat&&tick&&tick.major,label=adapter.format(time,format||(major?majorFormat:minorFormat)),nestedTickOpts=major?tickOpts.major:tickOpts.minor,formatter=resolve$5([nestedTickOpts.callback,nestedTickOpts.userCallback,tickOpts.callback,tickOpts.userCallback]);return formatter?formatter(label,index,ticks):label},convertTicksToLabels:function(ticks){var i,ilen,labels=[];for(i=0,ilen=ticks.length;i<ilen;++i)labels.push(this.tickFormatFunction(ticks[i].value,i,ticks));return labels},getPixelForOffset:function(time){var offsets=this._offsets,pos=interpolate$1(this._table,"time",time,"pos");return this.getPixelForDecimal((offsets.start+pos)*offsets.factor)},getPixelForValue:function(value,index,datasetIndex){var time=null;if(void 0!==index&&void 0!==datasetIndex&&(time=this._timestamps.datasets[datasetIndex][index]),null===time&&(time=parse(this,value)),null!==time)return this.getPixelForOffset(time)},getPixelForTick:function(index){var ticks=this.getTicks();return 0<=index&&index<ticks.length?this.getPixelForOffset(ticks[index].value):null},getValueForPixel:function(pixel){var offsets=this._offsets,pos=this.getDecimalForPixel(pixel)/offsets.factor-offsets.end,time=interpolate$1(this._table,"pos",pos,"time");return this._adapter._create(time)},_getLabelSize:function(label){var ticksOpts=this.options.ticks,tickLabelWidth=this.ctx.measureText(label).width,angle=helpers$1.toRadians(this.isHorizontal()?ticksOpts.maxRotation:ticksOpts.minRotation),cosRotation=Math.cos(angle),sinRotation=Math.sin(angle),tickFontSize=valueOrDefault$d(ticksOpts.fontSize,core_defaults.global.defaultFontSize);return{w:tickLabelWidth*cosRotation+tickFontSize*sinRotation,h:tickLabelWidth*sinRotation+tickFontSize*cosRotation}},getLabelWidth:function(label){return this._getLabelSize(label).w},getLabelCapacity:function(exampleTime){var me=this,timeOpts=me.options.time,displayFormats=timeOpts.displayFormats,format=displayFormats[timeOpts.unit]||displayFormats.millisecond,exampleLabel=me.tickFormatFunction(exampleTime,0,ticksFromTimestamps(me,[exampleTime],me._majorUnit),format),size=me._getLabelSize(exampleLabel),capacity=Math.floor(me.isHorizontal()?me.width/size.w:me.height/size.h);return me.options.offset&&capacity--,0<capacity?capacity:1}}),_defaults$4={position:"bottom",distribution:"linear",bounds:"data",adapters:{},time:{parser:!1,unit:!1,round:!1,displayFormat:!1,isoWeekday:!1,minUnit:"millisecond",displayFormats:{}},ticks:{autoSkip:!1,source:"auto",major:{enabled:!1}}};scale_time._defaults=_defaults$4;var scales={category:scale_category,linear:scale_linear,logarithmic:scale_logarithmic,radialLinear:scale_radialLinear,time:scale_time},moment=createCommonjsModule(function(module,exports){module.exports=function(){var hookCallback,some;function hooks(){return hookCallback.apply(null,arguments)}function setHookCallback(callback){hookCallback=callback}function isArray(input){return input instanceof Array||Object.prototype.toString.call(input)==="[object Array]"}function isObject(input){return input!=null&&Object.prototype.toString.call(input)==="[object Object]"}function isObjectEmpty(obj){if(Object.getOwnPropertyNames){return Object.getOwnPropertyNames(obj).length===0}else{var k;for(k in obj){if(obj.hasOwnProperty(k)){return false}}return true}}function isUndefined(input){return input===void 0}function isNumber(input){return typeof input==="number"||Object.prototype.toString.call(input)==="[object Number]"}function isDate(input){return input instanceof Date||Object.prototype.toString.call(input)==="[object Date]"}function map(arr,fn){var res=[],i;for(i=0;i<arr.length;++i){res.push(fn(arr[i],i))}return res}function hasOwnProp(a,b){return Object.prototype.hasOwnProperty.call(a,b)}function extend(a,b){for(var i in b){if(hasOwnProp(b,i)){a[i]=b[i]}}if(hasOwnProp(b,"toString")){a.toString=b.toString}if(hasOwnProp(b,"valueOf")){a.valueOf=b.valueOf}return a}function createUTC(input,format,locale,strict){return createLocalOrUTC(input,format,locale,strict,true).utc()}function defaultParsingFlags(){return{empty:false,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:false,invalidMonth:null,invalidFormat:false,userInvalidated:false,iso:false,parsedDateParts:[],meridiem:null,rfc2822:false,weekdayMismatch:false}}function getParsingFlags(m){if(m._pf==null){m._pf=defaultParsingFlags()}return m._pf}if(Array.prototype.some){some=Array.prototype.some}else{some=function(fun){var t=Object(this);var len=t.length>>>0;for(var i=0;i<len;i++){if(i in t&&fun.call(this,t[i],i,t)){return true}}return false}}function isValid(m){if(m._isValid==null){var flags=getParsingFlags(m);var parsedParts=some.call(flags.parsedDateParts,function(i){return i!=null});var isNowValid=!isNaN(m._d.getTime())&&flags.overflow<0&&!flags.empty&&!flags.invalidMonth&&!flags.invalidWeekday&&!flags.weekdayMismatch&&!flags.nullInput&&!flags.invalidFormat&&!flags.userInvalidated&&(!flags.meridiem||flags.meridiem&&parsedParts);if(m._strict){isNowValid=isNowValid&&flags.charsLeftOver===0&&flags.unusedTokens.length===0&&flags.bigHour===undefined}if(Object.isFrozen==null||!Object.isFrozen(m)){m._isValid=isNowValid}else{return isNowValid}}return m._isValid}function createInvalid(flags){var m=createUTC(NaN);if(flags!=null){extend(getParsingFlags(m),flags)}else{getParsingFlags(m).userInvalidated=true}return m}var momentProperties=hooks.momentProperties=[];function copyConfig(to,from){var i,prop,val;if(!isUndefined(from._isAMomentObject)){to._isAMomentObject=from._isAMomentObject}if(!isUndefined(from._i)){to._i=from._i}if(!isUndefined(from._f)){to._f=from._f}if(!isUndefined(from._l)){to._l=from._l}if(!isUndefined(from._strict)){to._strict=from._strict}if(!isUndefined(from._tzm)){to._tzm=from._tzm}if(!isUndefined(from._isUTC)){to._isUTC=from._isUTC}if(!isUndefined(from._offset)){to._offset=from._offset}if(!isUndefined(from._pf)){to._pf=getParsingFlags(from)}if(!isUndefined(from._locale)){to._locale=from._locale}if(momentProperties.length>0){for(i=0;i<momentProperties.length;i++){prop=momentProperties[i];val=from[prop];if(!isUndefined(val)){to[prop]=val}}}return to}var updateInProgress=false;function Moment(config){copyConfig(this,config);this._d=new Date(config._d!=null?config._d.getTime():NaN);if(!this.isValid()){this._d=new Date(NaN)}if(updateInProgress===false){updateInProgress=true;hooks.updateOffset(this);updateInProgress=false}}function isMoment(obj){return obj instanceof Moment||obj!=null&&obj._isAMomentObject!=null}function absFloor(number){if(number<0){return Math.ceil(number)||0}else{return Math.floor(number)}}function toInt(argumentForCoercion){var coercedNumber=+argumentForCoercion,value=0;if(coercedNumber!==0&&isFinite(coercedNumber)){value=absFloor(coercedNumber)}return value}function compareArrays(array1,array2,dontConvert){var len=Math.min(array1.length,array2.length),lengthDiff=Math.abs(array1.length-array2.length),diffs=0,i;for(i=0;i<len;i++){if(dontConvert&&array1[i]!==array2[i]||!dontConvert&&toInt(array1[i])!==toInt(array2[i])){diffs++}}return diffs+lengthDiff}function warn(msg){if(hooks.suppressDeprecationWarnings===false&&typeof console!=="undefined"&&console.warn){console.warn("Deprecation warning: "+msg)}}function deprecate(msg,fn){var firstTime=true;return extend(function(){if(hooks.deprecationHandler!=null){hooks.deprecationHandler(null,msg)}if(firstTime){var args=[];var arg;for(var i=0;i<arguments.length;i++){arg="";if(typeof arguments[i]==="object"){arg+="\n["+i+"] ";for(var key in arguments[0]){arg+=key+": "+arguments[0][key]+", "}arg=arg.slice(0,-2)}else{arg=arguments[i]}args.push(arg)}warn(msg+"\nArguments: "+Array.prototype.slice.call(args).join("")+"\n"+(new Error).stack);firstTime=false}return fn.apply(this,arguments)},fn)}var deprecations={},keys;function deprecateSimple(name,msg){if(hooks.deprecationHandler!=null){hooks.deprecationHandler(name,msg)}if(!deprecations[name]){warn(msg);deprecations[name]=true}}function isFunction(input){return input instanceof Function||Object.prototype.toString.call(input)==="[object Function]"}function set(config){var prop,i;for(i in config){prop=config[i];if(isFunction(prop)){this[i]=prop}else{this["_"+i]=prop}}this._config=config;this._dayOfMonthOrdinalParseLenient=new RegExp((this._dayOfMonthOrdinalParse.source||this._ordinalParse.source)+"|"+/\d{1,2}/.source)}function mergeConfigs(parentConfig,childConfig){var res=extend({},parentConfig),prop;for(prop in childConfig){if(hasOwnProp(childConfig,prop)){if(isObject(parentConfig[prop])&&isObject(childConfig[prop])){res[prop]={};extend(res[prop],parentConfig[prop]);extend(res[prop],childConfig[prop])}else if(childConfig[prop]!=null){res[prop]=childConfig[prop]}else{delete res[prop]}}}for(prop in parentConfig){if(hasOwnProp(parentConfig,prop)&&!hasOwnProp(childConfig,prop)&&isObject(parentConfig[prop])){res[prop]=extend({},res[prop])}}return res}function Locale(config){if(config!=null){this.set(config)}}if(hooks.suppressDeprecationWarnings=false,hooks.deprecationHandler=null,Object.keys){keys=Object.keys}else{keys=function(obj){var i,res=[];for(i in obj){if(hasOwnProp(obj,i)){res.push(i)}}return res}}var defaultCalendar={sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"};function calendar(key,mom,now){var output=this._calendar[key]||this._calendar["sameElse"];return isFunction(output)?output.call(mom,now):output}var defaultLongDateFormat={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"};function longDateFormat(key){var format=this._longDateFormat[key],formatUpper=this._longDateFormat[key.toUpperCase()];if(format||!formatUpper){return format}this._longDateFormat[key]=formatUpper.replace(/MMMM|MM|DD|dddd/g,function(val){return val.slice(1)});return this._longDateFormat[key]}var defaultInvalidDate="Invalid date";function invalidDate(){return this._invalidDate}var defaultOrdinal="%d",defaultDayOfMonthOrdinalParse=/\d{1,2}/;function ordinal(number){return this._ordinal.replace("%d",number)}var defaultRelativeTime={future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};function relativeTime(number,withoutSuffix,string,isFuture){var output=this._relativeTime[string];return isFunction(output)?output(number,withoutSuffix,string,isFuture):output.replace(/%d/i,number)}function pastFuture(diff,output){var format=this._relativeTime[diff>0?"future":"past"];return isFunction(format)?format(output):format.replace(/%s/i,output)}var aliases={};function addUnitAlias(unit,shorthand){var lowerCase=unit.toLowerCase();aliases[lowerCase]=aliases[lowerCase+"s"]=aliases[shorthand]=unit}function normalizeUnits(units){return typeof units==="string"?aliases[units]||aliases[units.toLowerCase()]:undefined}function normalizeObjectUnits(inputObject){var normalizedInput={},normalizedProp,prop;for(prop in inputObject){if(hasOwnProp(inputObject,prop)){normalizedProp=normalizeUnits(prop);if(normalizedProp){normalizedInput[normalizedProp]=inputObject[prop]}}}return normalizedInput}var priorities={};function addUnitPriority(unit,priority){priorities[unit]=priority}function getPrioritizedUnits(unitsObj){var units=[];for(var u in unitsObj){units.push({unit:u,priority:priorities[u]})}units.sort(function(a,b){return a.priority-b.priority});return units}function zeroFill(number,targetLength,forceSign){var absNumber=""+Math.abs(number),zerosToFill=targetLength-absNumber.length,sign=number>=0;return(sign?forceSign?"+":"":"-")+Math.pow(10,Math.max(0,zerosToFill)).toString().substr(1)+absNumber}var formattingTokens=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|YYYYYY|YYYYY|YYYY|YY|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,localFormattingTokens=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,formatFunctions={},formatTokenFunctions={};function addFormatToken(token,padded,ordinal,callback){var func=callback;if(typeof callback==="string"){func=function(){return this[callback]()}}if(token){formatTokenFunctions[token]=func}if(padded){formatTokenFunctions[padded[0]]=function(){return zeroFill(func.apply(this,arguments),padded[1],padded[2])}}if(ordinal){formatTokenFunctions[ordinal]=function(){return this.localeData().ordinal(func.apply(this,arguments),token)}}}function removeFormattingTokens(input){if(input.match(/\[[\s\S]/)){return input.replace(/^\[|\]$/g,"")}return input.replace(/\\/g,"")}function makeFormatFunction(format){var array=format.match(formattingTokens),i,length;for(i=0,length=array.length;i<length;i++){if(formatTokenFunctions[array[i]]){array[i]=formatTokenFunctions[array[i]]}else{array[i]=removeFormattingTokens(array[i])}}return function(mom){var output="",i;for(i=0;i<length;i++){output+=isFunction(array[i])?array[i].call(mom,format):array[i]}return output}}function formatMoment(m,format){if(!m.isValid()){return m.localeData().invalidDate()}format=expandFormat(format,m.localeData());formatFunctions[format]=formatFunctions[format]||makeFormatFunction(format);return formatFunctions[format](m)}function expandFormat(format,locale){var i=5;function replaceLongDateFormatTokens(input){return locale.longDateFormat(input)||input}localFormattingTokens.lastIndex=0;while(i>=0&&localFormattingTokens.test(format)){format=format.replace(localFormattingTokens,replaceLongDateFormatTokens);localFormattingTokens.lastIndex=0;i-=1}return format}var match1=/\d/,match2=/\d\d/,match3=/\d{3}/,match4=/\d{4}/,match6=/[+-]?\d{6}/,match1to2=/\d\d?/,match3to4=/\d\d\d\d?/,match5to6=/\d\d\d\d\d\d?/,match1to3=/\d{1,3}/,match1to4=/\d{1,4}/,match1to6=/[+-]?\d{1,6}/,matchUnsigned=/\d+/,matchSigned=/[+-]?\d+/,matchOffset=/Z|[+-]\d\d:?\d\d/gi,matchShortOffset=/Z|[+-]\d\d(?::?\d\d)?/gi,matchTimestamp=/[+-]?\d+(\.\d{1,3})?/,matchWord=/[0-9]{0,256}['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFF07\uFF10-\uFFEF]{1,256}|[\u0600-\u06FF\/]{1,256}(\s*?[\u0600-\u06FF]{1,256}){1,2}/i,regexes={};function addRegexToken(token,regex,strictRegex){regexes[token]=isFunction(regex)?regex:function(isStrict,localeData){return isStrict&&strictRegex?strictRegex:regex}}function getParseRegexForToken(token,config){if(!hasOwnProp(regexes,token)){return new RegExp(unescapeFormat(token))}return regexes[token](config._strict,config._locale)}function unescapeFormat(s){return regexEscape(s.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(matched,p1,p2,p3,p4){return p1||p2||p3||p4}))}function regexEscape(s){return s.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}var tokens={};function addParseToken(token,callback){var i,func=callback;if(typeof token==="string"){token=[token]}if(isNumber(callback)){func=function(input,array){array[callback]=toInt(input)}}for(i=0;i<token.length;i++){tokens[token[i]]=func}}function addWeekParseToken(token,callback){addParseToken(token,function(input,array,config,token){config._w=config._w||{};callback(input,config._w,config,token)})}function addTimeToArrayFromToken(token,input,config){if(input!=null&&hasOwnProp(tokens,token)){tokens[token](input,config._a,config,token)}}var YEAR=0,MONTH=1,DATE=2,HOUR=3,MINUTE=4,SECOND=5,MILLISECOND=6,WEEK=7,WEEKDAY=8;function daysInYear(year){return isLeapYear(year)?366:365}function isLeapYear(year){return year%4===0&&year%100!==0||year%400===0}addFormatToken("Y",0,0,function(){var y=this.year();return y<=9999?""+y:"+"+y}),addFormatToken(0,["YY",2],0,function(){return this.year()%100}),addFormatToken(0,["YYYY",4],0,"year"),addFormatToken(0,["YYYYY",5],0,"year"),addFormatToken(0,["YYYYYY",6,true],0,"year"),addUnitAlias("year","y"),addUnitPriority("year",1),addRegexToken("Y",matchSigned),addRegexToken("YY",match1to2,match2),addRegexToken("YYYY",match1to4,match4),addRegexToken("YYYYY",match1to6,match6),addRegexToken("YYYYYY",match1to6,match6),addParseToken(["YYYYY","YYYYYY"],YEAR),addParseToken("YYYY",function(input,array){array[YEAR]=input.length===2?hooks.parseTwoDigitYear(input):toInt(input)}),addParseToken("YY",function(input,array){array[YEAR]=hooks.parseTwoDigitYear(input)}),addParseToken("Y",function(input,array){array[YEAR]=parseInt(input,10)}),hooks.parseTwoDigitYear=function(input){return toInt(input)+(toInt(input)>68?1900:2e3)};var getSetYear=makeGetSet("FullYear",true),indexOf;function getIsLeapYear(){return isLeapYear(this.year())}function makeGetSet(unit,keepTime){return function(value){if(value!=null){set$1(this,unit,value);hooks.updateOffset(this,keepTime);return this}else{return get(this,unit)}}}function get(mom,unit){return mom.isValid()?mom._d["get"+(mom._isUTC?"UTC":"")+unit]():NaN}function set$1(mom,unit,value){if(mom.isValid()&&!isNaN(value)){if(unit==="FullYear"&&isLeapYear(mom.year())&&mom.month()===1&&mom.date()===29){mom._d["set"+(mom._isUTC?"UTC":"")+unit](value,mom.month(),daysInMonth(value,mom.month()))}else{mom._d["set"+(mom._isUTC?"UTC":"")+unit](value)}}}function stringGet(units){units=normalizeUnits(units);if(isFunction(this[units])){return this[units]()}return this}function stringSet(units,value){if(typeof units==="object"){units=normalizeObjectUnits(units);var prioritized=getPrioritizedUnits(units);for(var i=0;i<prioritized.length;i++){this[prioritized[i].unit](units[prioritized[i].unit])}}else{units=normalizeUnits(units);if(isFunction(this[units])){return this[units](value)}}return this}function mod(n,x){return(n%x+x)%x}if(Array.prototype.indexOf){indexOf=Array.prototype.indexOf}else{indexOf=function(o){var i;for(i=0;i<this.length;++i){if(this[i]===o){return i}}return-1}}function daysInMonth(year,month){if(isNaN(year)||isNaN(month)){return NaN}var modMonth=mod(month,12);year+=(month-modMonth)/12;return modMonth===1?isLeapYear(year)?29:28:31-modMonth%7%2}addFormatToken("M",["MM",2],"Mo",function(){return this.month()+1}),addFormatToken("MMM",0,0,function(format){return this.localeData().monthsShort(this,format)}),addFormatToken("MMMM",0,0,function(format){return this.localeData().months(this,format)}),addUnitAlias("month","M"),addUnitPriority("month",8),addRegexToken("M",match1to2),addRegexToken("MM",match1to2,match2),addRegexToken("MMM",function(isStrict,locale){return locale.monthsShortRegex(isStrict)}),addRegexToken("MMMM",function(isStrict,locale){return locale.monthsRegex(isStrict)}),addParseToken(["M","MM"],function(input,array){array[MONTH]=toInt(input)-1}),addParseToken(["MMM","MMMM"],function(input,array,config,token){var month=config._locale.monthsParse(input,token,config._strict);if(month!=null){array[MONTH]=month}else{getParsingFlags(config).invalidMonth=input}});var MONTHS_IN_FORMAT=/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/,defaultLocaleMonths="January_February_March_April_May_June_July_August_September_October_November_December".split("_");function localeMonths(m,format){if(!m){return isArray(this._months)?this._months:this._months["standalone"]}return isArray(this._months)?this._months[m.month()]:this._months[(this._months.isFormat||MONTHS_IN_FORMAT).test(format)?"format":"standalone"][m.month()]}var defaultLocaleMonthsShort="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_");function localeMonthsShort(m,format){if(!m){return isArray(this._monthsShort)?this._monthsShort:this._monthsShort["standalone"]}return isArray(this._monthsShort)?this._monthsShort[m.month()]:this._monthsShort[MONTHS_IN_FORMAT.test(format)?"format":"standalone"][m.month()]}function handleStrictParse(monthName,format,strict){var i,ii,mom,llc=monthName.toLocaleLowerCase();if(!this._monthsParse){this._monthsParse=[];this._longMonthsParse=[];this._shortMonthsParse=[];for(i=0;i<12;++i){mom=createUTC([2e3,i]);this._shortMonthsParse[i]=this.monthsShort(mom,"").toLocaleLowerCase();this._longMonthsParse[i]=this.months(mom,"").toLocaleLowerCase()}}if(strict){if(format==="MMM"){ii=indexOf.call(this._shortMonthsParse,llc);return ii!==-1?ii:null}else{ii=indexOf.call(this._longMonthsParse,llc);return ii!==-1?ii:null}}else{if(format==="MMM"){ii=indexOf.call(this._shortMonthsParse,llc);if(ii!==-1){return ii}ii=indexOf.call(this._longMonthsParse,llc);return ii!==-1?ii:null}else{ii=indexOf.call(this._longMonthsParse,llc);if(ii!==-1){return ii}ii=indexOf.call(this._shortMonthsParse,llc);return ii!==-1?ii:null}}}function localeMonthsParse(monthName,format,strict){var i,mom,regex;if(this._monthsParseExact){return handleStrictParse.call(this,monthName,format,strict)}if(!this._monthsParse){this._monthsParse=[];this._longMonthsParse=[];this._shortMonthsParse=[]}for(i=0;i<12;i++){mom=createUTC([2e3,i]);if(strict&&!this._longMonthsParse[i]){this._longMonthsParse[i]=new RegExp("^"+this.months(mom,"").replace(".","")+"$","i");this._shortMonthsParse[i]=new RegExp("^"+this.monthsShort(mom,"").replace(".","")+"$","i")}if(!strict&&!this._monthsParse[i]){regex="^"+this.months(mom,"")+"|^"+this.monthsShort(mom,"");this._monthsParse[i]=new RegExp(regex.replace(".",""),"i")}if(strict&&format==="MMMM"&&this._longMonthsParse[i].test(monthName)){return i}else if(strict&&format==="MMM"&&this._shortMonthsParse[i].test(monthName)){return i}else if(!strict&&this._monthsParse[i].test(monthName)){return i}}}function setMonth(mom,value){var dayOfMonth;if(!mom.isValid()){return mom}if(typeof value==="string"){if(/^\d+$/.test(value)){value=toInt(value)}else{value=mom.localeData().monthsParse(value);if(!isNumber(value)){return mom}}}dayOfMonth=Math.min(mom.date(),daysInMonth(mom.year(),value));mom._d["set"+(mom._isUTC?"UTC":"")+"Month"](value,dayOfMonth);return mom}function getSetMonth(value){if(value!=null){setMonth(this,value);hooks.updateOffset(this,true);return this}else{return get(this,"Month")}}function getDaysInMonth(){return daysInMonth(this.year(),this.month())}var defaultMonthsShortRegex=matchWord;function monthsShortRegex(isStrict){if(this._monthsParseExact){if(!hasOwnProp(this,"_monthsRegex")){computeMonthsParse.call(this)}if(isStrict){return this._monthsShortStrictRegex}else{return this._monthsShortRegex}}else{if(!hasOwnProp(this,"_monthsShortRegex")){this._monthsShortRegex=defaultMonthsShortRegex}return this._monthsShortStrictRegex&&isStrict?this._monthsShortStrictRegex:this._monthsShortRegex}}var defaultMonthsRegex=matchWord;function monthsRegex(isStrict){if(this._monthsParseExact){if(!hasOwnProp(this,"_monthsRegex")){computeMonthsParse.call(this)}if(isStrict){return this._monthsStrictRegex}else{return this._monthsRegex}}else{if(!hasOwnProp(this,"_monthsRegex")){this._monthsRegex=defaultMonthsRegex}return this._monthsStrictRegex&&isStrict?this._monthsStrictRegex:this._monthsRegex}}function computeMonthsParse(){function cmpLenRev(a,b){return b.length-a.length}var shortPieces=[],longPieces=[],mixedPieces=[],i,mom;for(i=0;i<12;i++){mom=createUTC([2e3,i]);shortPieces.push(this.monthsShort(mom,""));longPieces.push(this.months(mom,""));mixedPieces.push(this.months(mom,""));mixedPieces.push(this.monthsShort(mom,""))}shortPieces.sort(cmpLenRev);longPieces.sort(cmpLenRev);mixedPieces.sort(cmpLenRev);for(i=0;i<12;i++){shortPieces[i]=regexEscape(shortPieces[i]);longPieces[i]=regexEscape(longPieces[i])}for(i=0;i<24;i++){mixedPieces[i]=regexEscape(mixedPieces[i])}this._monthsRegex=new RegExp("^("+mixedPieces.join("|")+")","i");this._monthsShortRegex=this._monthsRegex;this._monthsStrictRegex=new RegExp("^("+longPieces.join("|")+")","i");this._monthsShortStrictRegex=new RegExp("^("+shortPieces.join("|")+")","i")}function createDate(y,m,d,h,M,s,ms){var date;if(y<100&&y>=0){date=new Date(y+400,m,d,h,M,s,ms);if(isFinite(date.getFullYear())){date.setFullYear(y)}}else{date=new Date(y,m,d,h,M,s,ms)}return date}function createUTCDate(y){var date;if(y<100&&y>=0){var args=Array.prototype.slice.call(arguments);args[0]=y+400;date=new Date(Date.UTC.apply(null,args));if(isFinite(date.getUTCFullYear())){date.setUTCFullYear(y)}}else{date=new Date(Date.UTC.apply(null,arguments))}return date}function firstWeekOffset(year,dow,doy){var fwd=7+dow-doy,fwdlw=(7+createUTCDate(year,0,fwd).getUTCDay()-dow)%7;return-fwdlw+fwd-1}function dayOfYearFromWeeks(year,week,weekday,dow,doy){var localWeekday=(7+weekday-dow)%7,weekOffset=firstWeekOffset(year,dow,doy),dayOfYear=1+7*(week-1)+localWeekday+weekOffset,resYear,resDayOfYear;if(dayOfYear<=0){resYear=year-1;resDayOfYear=daysInYear(resYear)+dayOfYear}else if(dayOfYear>daysInYear(year)){resYear=year+1;resDayOfYear=dayOfYear-daysInYear(year)}else{resYear=year;resDayOfYear=dayOfYear}return{year:resYear,dayOfYear:resDayOfYear}}function weekOfYear(mom,dow,doy){var weekOffset=firstWeekOffset(mom.year(),dow,doy),week=Math.floor((mom.dayOfYear()-weekOffset-1)/7)+1,resWeek,resYear;if(week<1){resYear=mom.year()-1;resWeek=week+weeksInYear(resYear,dow,doy)}else if(week>weeksInYear(mom.year(),dow,doy)){resWeek=week-weeksInYear(mom.year(),dow,doy);resYear=mom.year()+1}else{resYear=mom.year();resWeek=week}return{week:resWeek,year:resYear}}function weeksInYear(year,dow,doy){var weekOffset=firstWeekOffset(year,dow,doy),weekOffsetNext=firstWeekOffset(year+1,dow,doy);return(daysInYear(year)-weekOffset+weekOffsetNext)/7}function localeWeek(mom){return weekOfYear(mom,this._week.dow,this._week.doy).week}addFormatToken("w",["ww",2],"wo","week"),addFormatToken("W",["WW",2],"Wo","isoWeek"),addUnitAlias("week","w"),addUnitAlias("isoWeek","W"),addUnitPriority("week",5),addUnitPriority("isoWeek",5),addRegexToken("w",match1to2),addRegexToken("ww",match1to2,match2),addRegexToken("W",match1to2),addRegexToken("WW",match1to2,match2),addWeekParseToken(["w","ww","W","WW"],function(input,week,config,token){week[token.substr(0,1)]=toInt(input)});var defaultLocaleWeek={dow:0,doy:6};function localeFirstDayOfWeek(){return this._week.dow}function localeFirstDayOfYear(){return this._week.doy}function getSetWeek(input){var week=this.localeData().week(this);return input==null?week:this.add((input-week)*7,"d")}function getSetISOWeek(input){var week=weekOfYear(this,1,4).week;return input==null?week:this.add((input-week)*7,"d")}function parseWeekday(input,locale){if(typeof input!=="string"){return input}if(!isNaN(input)){return parseInt(input,10)}input=locale.weekdaysParse(input);if(typeof input==="number"){return input}return null}function parseIsoWeekday(input,locale){if(typeof input==="string"){return locale.weekdaysParse(input)%7||7}return isNaN(input)?null:input}function shiftWeekdays(ws,n){return ws.slice(n,7).concat(ws.slice(0,n))}addFormatToken("d",0,"do","day"),addFormatToken("dd",0,0,function(format){return this.localeData().weekdaysMin(this,format)}),addFormatToken("ddd",0,0,function(format){return this.localeData().weekdaysShort(this,format)}),addFormatToken("dddd",0,0,function(format){return this.localeData().weekdays(this,format)}),addFormatToken("e",0,0,"weekday"),addFormatToken("E",0,0,"isoWeekday"),addUnitAlias("day","d"),addUnitAlias("weekday","e"),addUnitAlias("isoWeekday","E"),addUnitPriority("day",11),addUnitPriority("weekday",11),addUnitPriority("isoWeekday",11),addRegexToken("d",match1to2),addRegexToken("e",match1to2),addRegexToken("E",match1to2),addRegexToken("dd",function(isStrict,locale){return locale.weekdaysMinRegex(isStrict)}),addRegexToken("ddd",function(isStrict,locale){return locale.weekdaysShortRegex(isStrict)}),addRegexToken("dddd",function(isStrict,locale){return locale.weekdaysRegex(isStrict)}),addWeekParseToken(["dd","ddd","dddd"],function(input,week,config,token){var weekday=config._locale.weekdaysParse(input,token,config._strict);if(weekday!=null){week.d=weekday}else{getParsingFlags(config).invalidWeekday=input}}),addWeekParseToken(["d","e","E"],function(input,week,config,token){week[token]=toInt(input)});var defaultLocaleWeekdays="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_");function localeWeekdays(m,format){var weekdays=isArray(this._weekdays)?this._weekdays:this._weekdays[m&&m!==true&&this._weekdays.isFormat.test(format)?"format":"standalone"];return m===true?shiftWeekdays(weekdays,this._week.dow):m?weekdays[m.day()]:weekdays}var defaultLocaleWeekdaysShort="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_");function localeWeekdaysShort(m){return m===true?shiftWeekdays(this._weekdaysShort,this._week.dow):m?this._weekdaysShort[m.day()]:this._weekdaysShort}var defaultLocaleWeekdaysMin="Su_Mo_Tu_We_Th_Fr_Sa".split("_");function localeWeekdaysMin(m){return m===true?shiftWeekdays(this._weekdaysMin,this._week.dow):m?this._weekdaysMin[m.day()]:this._weekdaysMin}function handleStrictParse$1(weekdayName,format,strict){var i,ii,mom,llc=weekdayName.toLocaleLowerCase();if(!this._weekdaysParse){this._weekdaysParse=[];this._shortWeekdaysParse=[];this._minWeekdaysParse=[];for(i=0;i<7;++i){mom=createUTC([2e3,1]).day(i);this._minWeekdaysParse[i]=this.weekdaysMin(mom,"").toLocaleLowerCase();this._shortWeekdaysParse[i]=this.weekdaysShort(mom,"").toLocaleLowerCase();this._weekdaysParse[i]=this.weekdays(mom,"").toLocaleLowerCase()}}if(strict){if(format==="dddd"){ii=indexOf.call(this._weekdaysParse,llc);return ii!==-1?ii:null}else if(format==="ddd"){ii=indexOf.call(this._shortWeekdaysParse,llc);return ii!==-1?ii:null}else{ii=indexOf.call(this._minWeekdaysParse,llc);return ii!==-1?ii:null}}else{if(format==="dddd"){ii=indexOf.call(this._weekdaysParse,llc);if(ii!==-1){return ii}ii=indexOf.call(this._shortWeekdaysParse,llc);if(ii!==-1){return ii}ii=indexOf.call(this._minWeekdaysParse,llc);return ii!==-1?ii:null}else if(format==="ddd"){ii=indexOf.call(this._shortWeekdaysParse,llc);if(ii!==-1){return ii}ii=indexOf.call(this._weekdaysParse,llc);if(ii!==-1){return ii}ii=indexOf.call(this._minWeekdaysParse,llc);return ii!==-1?ii:null}else{ii=indexOf.call(this._minWeekdaysParse,llc);if(ii!==-1){return ii}ii=indexOf.call(this._weekdaysParse,llc);if(ii!==-1){return ii}ii=indexOf.call(this._shortWeekdaysParse,llc);return ii!==-1?ii:null}}}function localeWeekdaysParse(weekdayName,format,strict){var i,mom,regex;if(this._weekdaysParseExact){return handleStrictParse$1.call(this,weekdayName,format,strict)}if(!this._weekdaysParse){this._weekdaysParse=[];this._minWeekdaysParse=[];this._shortWeekdaysParse=[];this._fullWeekdaysParse=[]}for(i=0;i<7;i++){mom=createUTC([2e3,1]).day(i);if(strict&&!this._fullWeekdaysParse[i]){this._fullWeekdaysParse[i]=new RegExp("^"+this.weekdays(mom,"").replace(".","\\.?")+"$","i");this._shortWeekdaysParse[i]=new RegExp("^"+this.weekdaysShort(mom,"").replace(".","\\.?")+"$","i");this._minWeekdaysParse[i]=new RegExp("^"+this.weekdaysMin(mom,"").replace(".","\\.?")+"$","i")}if(!this._weekdaysParse[i]){regex="^"+this.weekdays(mom,"")+"|^"+this.weekdaysShort(mom,"")+"|^"+this.weekdaysMin(mom,"");this._weekdaysParse[i]=new RegExp(regex.replace(".",""),"i")}if(strict&&format==="dddd"&&this._fullWeekdaysParse[i].test(weekdayName)){return i}else if(strict&&format==="ddd"&&this._shortWeekdaysParse[i].test(weekdayName)){return i}else if(strict&&format==="dd"&&this._minWeekdaysParse[i].test(weekdayName)){return i}else if(!strict&&this._weekdaysParse[i].test(weekdayName)){return i}}}function getSetDayOfWeek(input){if(!this.isValid()){return input!=null?this:NaN}var day=this._isUTC?this._d.getUTCDay():this._d.getDay();if(input!=null){input=parseWeekday(input,this.localeData());return this.add(input-day,"d")}else{return day}}function getSetLocaleDayOfWeek(input){if(!this.isValid()){return input!=null?this:NaN}var weekday=(this.day()+7-this.localeData()._week.dow)%7;return input==null?weekday:this.add(input-weekday,"d")}function getSetISODayOfWeek(input){if(!this.isValid()){return input!=null?this:NaN}if(input!=null){var weekday=parseIsoWeekday(input,this.localeData());return this.day(this.day()%7?weekday:weekday-7)}else{return this.day()||7}}var defaultWeekdaysRegex=matchWord;function weekdaysRegex(isStrict){if(this._weekdaysParseExact){if(!hasOwnProp(this,"_weekdaysRegex")){computeWeekdaysParse.call(this)}if(isStrict){return this._weekdaysStrictRegex}else{return this._weekdaysRegex}}else{if(!hasOwnProp(this,"_weekdaysRegex")){this._weekdaysRegex=defaultWeekdaysRegex}return this._weekdaysStrictRegex&&isStrict?this._weekdaysStrictRegex:this._weekdaysRegex}}var defaultWeekdaysShortRegex=matchWord;function weekdaysShortRegex(isStrict){if(this._weekdaysParseExact){if(!hasOwnProp(this,"_weekdaysRegex")){computeWeekdaysParse.call(this)}if(isStrict){return this._weekdaysShortStrictRegex}else{return this._weekdaysShortRegex}}else{if(!hasOwnProp(this,"_weekdaysShortRegex")){this._weekdaysShortRegex=defaultWeekdaysShortRegex}return this._weekdaysShortStrictRegex&&isStrict?this._weekdaysShortStrictRegex:this._weekdaysShortRegex}}var defaultWeekdaysMinRegex=matchWord;function weekdaysMinRegex(isStrict){if(this._weekdaysParseExact){if(!hasOwnProp(this,"_weekdaysRegex")){computeWeekdaysParse.call(this)}if(isStrict){return this._weekdaysMinStrictRegex}else{return this._weekdaysMinRegex}}else{if(!hasOwnProp(this,"_weekdaysMinRegex")){this._weekdaysMinRegex=defaultWeekdaysMinRegex}return this._weekdaysMinStrictRegex&&isStrict?this._weekdaysMinStrictRegex:this._weekdaysMinRegex}}function computeWeekdaysParse(){function cmpLenRev(a,b){return b.length-a.length}var minPieces=[],shortPieces=[],longPieces=[],mixedPieces=[],i,mom,minp,shortp,longp;for(i=0;i<7;i++){mom=createUTC([2e3,1]).day(i);minp=this.weekdaysMin(mom,"");shortp=this.weekdaysShort(mom,"");longp=this.weekdays(mom,"");minPieces.push(minp);shortPieces.push(shortp);longPieces.push(longp);mixedPieces.push(minp);mixedPieces.push(shortp);mixedPieces.push(longp)}minPieces.sort(cmpLenRev);shortPieces.sort(cmpLenRev);longPieces.sort(cmpLenRev);mixedPieces.sort(cmpLenRev);for(i=0;i<7;i++){shortPieces[i]=regexEscape(shortPieces[i]);longPieces[i]=regexEscape(longPieces[i]);mixedPieces[i]=regexEscape(mixedPieces[i])}this._weekdaysRegex=new RegExp("^("+mixedPieces.join("|")+")","i");this._weekdaysShortRegex=this._weekdaysRegex;this._weekdaysMinRegex=this._weekdaysRegex;this._weekdaysStrictRegex=new RegExp("^("+longPieces.join("|")+")","i");this._weekdaysShortStrictRegex=new RegExp("^("+shortPieces.join("|")+")","i");this._weekdaysMinStrictRegex=new RegExp("^("+minPieces.join("|")+")","i")}function hFormat(){return this.hours()%12||12}function kFormat(){return this.hours()||24}function meridiem(token,lowercase){addFormatToken(token,0,0,function(){return this.localeData().meridiem(this.hours(),this.minutes(),lowercase)})}function matchMeridiem(isStrict,locale){return locale._meridiemParse}function localeIsPM(input){return(input+"").toLowerCase().charAt(0)==="p"}addFormatToken("H",["HH",2],0,"hour"),addFormatToken("h",["hh",2],0,hFormat),addFormatToken("k",["kk",2],0,kFormat),addFormatToken("hmm",0,0,function(){return""+hFormat.apply(this)+zeroFill(this.minutes(),2)}),addFormatToken("hmmss",0,0,function(){return""+hFormat.apply(this)+zeroFill(this.minutes(),2)+zeroFill(this.seconds(),2)}),addFormatToken("Hmm",0,0,function(){return""+this.hours()+zeroFill(this.minutes(),2)}),addFormatToken("Hmmss",0,0,function(){return""+this.hours()+zeroFill(this.minutes(),2)+zeroFill(this.seconds(),2)}),meridiem("a",true),meridiem("A",false),addUnitAlias("hour","h"),addUnitPriority("hour",13),addRegexToken("a",matchMeridiem),addRegexToken("A",matchMeridiem),addRegexToken("H",match1to2),addRegexToken("h",match1to2),addRegexToken("k",match1to2),addRegexToken("HH",match1to2,match2),addRegexToken("hh",match1to2,match2),addRegexToken("kk",match1to2,match2),addRegexToken("hmm",match3to4),addRegexToken("hmmss",match5to6),addRegexToken("Hmm",match3to4),addRegexToken("Hmmss",match5to6),addParseToken(["H","HH"],HOUR),addParseToken(["k","kk"],function(input,array,config){var kInput=toInt(input);array[HOUR]=kInput===24?0:kInput}),addParseToken(["a","A"],function(input,array,config){config._isPm=config._locale.isPM(input);config._meridiem=input}),addParseToken(["h","hh"],function(input,array,config){array[HOUR]=toInt(input);getParsingFlags(config).bigHour=true}),addParseToken("hmm",function(input,array,config){var pos=input.length-2;array[HOUR]=toInt(input.substr(0,pos));array[MINUTE]=toInt(input.substr(pos));getParsingFlags(config).bigHour=true}),addParseToken("hmmss",function(input,array,config){var pos1=input.length-4;var pos2=input.length-2;array[HOUR]=toInt(input.substr(0,pos1));array[MINUTE]=toInt(input.substr(pos1,2));array[SECOND]=toInt(input.substr(pos2));getParsingFlags(config).bigHour=true}),addParseToken("Hmm",function(input,array,config){var pos=input.length-2;array[HOUR]=toInt(input.substr(0,pos));array[MINUTE]=toInt(input.substr(pos))}),addParseToken("Hmmss",function(input,array,config){var pos1=input.length-4;var pos2=input.length-2;array[HOUR]=toInt(input.substr(0,pos1));array[MINUTE]=toInt(input.substr(pos1,2));array[SECOND]=toInt(input.substr(pos2))});var defaultLocaleMeridiemParse=/[ap]\.?m?\.?/i;function localeMeridiem(hours,minutes,isLower){if(hours>11){return isLower?"pm":"PM"}else{return isLower?"am":"AM"}}var getSetHour=makeGetSet("Hours",true),baseConfig={calendar:defaultCalendar,longDateFormat:defaultLongDateFormat,invalidDate:defaultInvalidDate,ordinal:defaultOrdinal,dayOfMonthOrdinalParse:defaultDayOfMonthOrdinalParse,relativeTime:defaultRelativeTime,months:defaultLocaleMonths,monthsShort:defaultLocaleMonthsShort,week:defaultLocaleWeek,weekdays:defaultLocaleWeekdays,weekdaysMin:defaultLocaleWeekdaysMin,weekdaysShort:defaultLocaleWeekdaysShort,meridiemParse:defaultLocaleMeridiemParse},locales={},localeFamilies={},globalLocale;function normalizeLocale(key){return key?key.toLowerCase().replace("_","-"):key}function chooseLocale(names){var i=0,j,next,locale,split;while(i<names.length){split=normalizeLocale(names[i]).split("-");j=split.length;next=normalizeLocale(names[i+1]);next=next?next.split("-"):null;while(j>0){locale=loadLocale(split.slice(0,j).join("-"));if(locale){return locale}if(next&&next.length>=j&&compareArrays(split,next,true)>=j-1){break}j--}i++}return globalLocale}function loadLocale(name){var oldLocale=null;if(!locales[name]&&"object"!=="undefined"&&module&&module.exports){try{oldLocale=globalLocale._abbr;var aliasedRequire=commonjsRequire;aliasedRequire("./locale/"+name);getSetGlobalLocale(oldLocale)}catch(e){}}return locales[name]}function getSetGlobalLocale(key,values){var data;if(key){if(isUndefined(values)){data=getLocale(key)}else{data=defineLocale(key,values)}if(data){globalLocale=data}else{if(typeof console!=="undefined"&&console.warn){console.warn("Locale "+key+" not found. Did you forget to load it?")}}}return globalLocale._abbr}function defineLocale(name,config){if(config!==null){var locale,parentConfig=baseConfig;config.abbr=name;if(locales[name]!=null){deprecateSimple("defineLocaleOverride","use moment.updateLocale(localeName, config) to change "+"an existing locale. moment.defineLocale(localeName, "+"config) should only be used for creating a new locale "+"See http://momentjs.com/guides/#/warnings/define-locale/ for more info.");parentConfig=locales[name]._config}else if(config.parentLocale!=null){if(locales[config.parentLocale]!=null){parentConfig=locales[config.parentLocale]._config}else{locale=loadLocale(config.parentLocale);if(locale!=null){parentConfig=locale._config}else{if(!localeFamilies[config.parentLocale]){localeFamilies[config.parentLocale]=[]}localeFamilies[config.parentLocale].push({name:name,config:config});return null}}}locales[name]=new Locale(mergeConfigs(parentConfig,config));if(localeFamilies[name]){localeFamilies[name].forEach(function(x){defineLocale(x.name,x.config)})}getSetGlobalLocale(name);return locales[name]}else{delete locales[name];return null}}function updateLocale(name,config){if(null!=config){var locale,tmpLocale,parentConfig=baseConfig;null!=(tmpLocale=loadLocale(name))&&(parentConfig=tmpLocale._config),config=mergeConfigs(parentConfig,config),(locale=new Locale(config)).parentLocale=locales[name],locales[name]=locale,getSetGlobalLocale(name)}else null!=locales[name]&&(null!=locales[name].parentLocale?locales[name]=locales[name].parentLocale:null!=locales[name]&&delete locales[name]);return locales[name]}function getLocale(key){var locale;if(key&&key._locale&&key._locale._abbr){key=key._locale._abbr}if(!key){return globalLocale}if(!isArray(key)){locale=loadLocale(key);if(locale){return locale}key=[key]}return chooseLocale(key)}function listLocales(){return keys(locales)}function checkOverflow(m){var overflow;var a=m._a;if(a&&getParsingFlags(m).overflow===-2){overflow=a[MONTH]<0||a[MONTH]>11?MONTH:a[DATE]<1||a[DATE]>daysInMonth(a[YEAR],a[MONTH])?DATE:a[HOUR]<0||a[HOUR]>24||a[HOUR]===24&&(a[MINUTE]!==0||a[SECOND]!==0||a[MILLISECOND]!==0)?HOUR:a[MINUTE]<0||a[MINUTE]>59?MINUTE:a[SECOND]<0||a[SECOND]>59?SECOND:a[MILLISECOND]<0||a[MILLISECOND]>999?MILLISECOND:-1;if(getParsingFlags(m)._overflowDayOfYear&&(overflow<YEAR||overflow>DATE)){overflow=DATE}if(getParsingFlags(m)._overflowWeeks&&overflow===-1){overflow=WEEK}if(getParsingFlags(m)._overflowWeekday&&overflow===-1){overflow=WEEKDAY}getParsingFlags(m).overflow=overflow}return m}function defaults(a,b,c){if(a!=null){return a}if(b!=null){return b}return c}function currentDateArray(config){var nowValue=new Date(hooks.now());if(config._useUTC){return[nowValue.getUTCFullYear(),nowValue.getUTCMonth(),nowValue.getUTCDate()]}return[nowValue.getFullYear(),nowValue.getMonth(),nowValue.getDate()]}function configFromArray(config){var i,date,input=[],currentDate,expectedWeekday,yearToUse;if(config._d){return}currentDate=currentDateArray(config);if(config._w&&config._a[DATE]==null&&config._a[MONTH]==null){dayOfYearFromWeekInfo(config)}if(config._dayOfYear!=null){yearToUse=defaults(config._a[YEAR],currentDate[YEAR]);if(config._dayOfYear>daysInYear(yearToUse)||config._dayOfYear===0){getParsingFlags(config)._overflowDayOfYear=true}date=createUTCDate(yearToUse,0,config._dayOfYear);config._a[MONTH]=date.getUTCMonth();config._a[DATE]=date.getUTCDate()}for(i=0;i<3&&config._a[i]==null;++i){config._a[i]=input[i]=currentDate[i]}for(;i<7;i++){config._a[i]=input[i]=config._a[i]==null?i===2?1:0:config._a[i]}if(config._a[HOUR]===24&&config._a[MINUTE]===0&&config._a[SECOND]===0&&config._a[MILLISECOND]===0){config._nextDay=true;config._a[HOUR]=0}config._d=(config._useUTC?createUTCDate:createDate).apply(null,input);expectedWeekday=config._useUTC?config._d.getUTCDay():config._d.getDay();if(config._tzm!=null){config._d.setUTCMinutes(config._d.getUTCMinutes()-config._tzm)}if(config._nextDay){config._a[HOUR]=24}if(config._w&&typeof config._w.d!=="undefined"&&config._w.d!==expectedWeekday){getParsingFlags(config).weekdayMismatch=true}}function dayOfYearFromWeekInfo(config){var w,weekYear,week,weekday,dow,doy,temp,weekdayOverflow;w=config._w;if(w.GG!=null||w.W!=null||w.E!=null){dow=1;doy=4;weekYear=defaults(w.GG,config._a[YEAR],weekOfYear(createLocal(),1,4).year);week=defaults(w.W,1);weekday=defaults(w.E,1);if(weekday<1||weekday>7){weekdayOverflow=true}}else{dow=config._locale._week.dow;doy=config._locale._week.doy;var curWeek=weekOfYear(createLocal(),dow,doy);weekYear=defaults(w.gg,config._a[YEAR],curWeek.year);week=defaults(w.w,curWeek.week);if(w.d!=null){weekday=w.d;if(weekday<0||weekday>6){weekdayOverflow=true}}else if(w.e!=null){weekday=w.e+dow;if(w.e<0||w.e>6){weekdayOverflow=true}}else{weekday=dow}}if(week<1||week>weeksInYear(weekYear,dow,doy)){getParsingFlags(config)._overflowWeeks=true}else if(weekdayOverflow!=null){getParsingFlags(config)._overflowWeekday=true}else{temp=dayOfYearFromWeeks(weekYear,week,weekday,dow,doy);config._a[YEAR]=temp.year;config._dayOfYear=temp.dayOfYear}}var extendedIsoRegex=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?$/,basicIsoRegex=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?$/,tzRegex=/Z|[+-]\d\d(?::?\d\d)?/,isoDates=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,false],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,false],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,false],["YYYYDDD",/\d{7}/]],isoTimes=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]],aspNetJsonRegex=/^\/?Date\((\-?\d+)/i;function configFromISO(config){var i,l,string=config._i,match=extendedIsoRegex.exec(string)||basicIsoRegex.exec(string),allowTime,dateFormat,timeFormat,tzFormat;if(match){getParsingFlags(config).iso=true;for(i=0,l=isoDates.length;i<l;i++){if(isoDates[i][1].exec(match[1])){dateFormat=isoDates[i][0];allowTime=isoDates[i][2]!==false;break}}if(dateFormat==null){config._isValid=false;return}if(match[3]){for(i=0,l=isoTimes.length;i<l;i++){if(isoTimes[i][1].exec(match[3])){timeFormat=(match[2]||" ")+isoTimes[i][0];break}}if(timeFormat==null){config._isValid=false;return}}if(!allowTime&&timeFormat!=null){config._isValid=false;return}if(match[4]){if(tzRegex.exec(match[4])){tzFormat="Z"}else{config._isValid=false;return}}config._f=dateFormat+(timeFormat||"")+(tzFormat||"");configFromStringAndFormat(config)}else{config._isValid=false}}var rfc2822=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),?\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|([+-]\d{4}))$/;function extractFromRFC2822Strings(yearStr,monthStr,dayStr,hourStr,minuteStr,secondStr){var result=[untruncateYear(yearStr),defaultLocaleMonthsShort.indexOf(monthStr),parseInt(dayStr,10),parseInt(hourStr,10),parseInt(minuteStr,10)];if(secondStr){result.push(parseInt(secondStr,10))}return result}function untruncateYear(yearStr){var year=parseInt(yearStr,10);if(year<=49){return 2e3+year}else if(year<=999){return 1900+year}return year}function preprocessRFC2822(s){return s.replace(/\([^)]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").replace(/^\s\s*/,"").replace(/\s\s*$/,"")}function checkWeekday(weekdayStr,parsedInput,config){if(weekdayStr){var weekdayProvided=defaultLocaleWeekdaysShort.indexOf(weekdayStr),weekdayActual=new Date(parsedInput[0],parsedInput[1],parsedInput[2]).getDay();if(weekdayProvided!==weekdayActual){getParsingFlags(config).weekdayMismatch=true;config._isValid=false;return false}}return true}var obsOffsets={UT:0,GMT:0,EDT:-4*60,EST:-5*60,CDT:-5*60,CST:-6*60,MDT:-6*60,MST:-7*60,PDT:-7*60,PST:-8*60};function calculateOffset(obsOffset,militaryOffset,numOffset){if(obsOffset){return obsOffsets[obsOffset]}else if(militaryOffset){return 0}else{var hm=parseInt(numOffset,10);var m=hm%100,h=(hm-m)/100;return h*60+m}}function configFromRFC2822(config){var match=rfc2822.exec(preprocessRFC2822(config._i));if(match){var parsedArray=extractFromRFC2822Strings(match[4],match[3],match[2],match[5],match[6],match[7]);if(!checkWeekday(match[1],parsedArray,config)){return}config._a=parsedArray;config._tzm=calculateOffset(match[8],match[9],match[10]);config._d=createUTCDate.apply(null,config._a);config._d.setUTCMinutes(config._d.getUTCMinutes()-config._tzm);getParsingFlags(config).rfc2822=true}else{config._isValid=false}}function configFromString(config){var matched=aspNetJsonRegex.exec(config._i);if(matched!==null){config._d=new Date(+matched[1]);return}configFromISO(config);if(config._isValid===false){delete config._isValid}else{return}configFromRFC2822(config);if(config._isValid===false){delete config._isValid}else{return}hooks.createFromInputFallback(config)}function configFromStringAndFormat(config){if(config._f===hooks.ISO_8601){configFromISO(config);return}if(config._f===hooks.RFC_2822){configFromRFC2822(config);return}config._a=[];getParsingFlags(config).empty=true;var string=""+config._i,i,parsedInput,tokens,token,skipped,stringLength=string.length,totalParsedInputLength=0;tokens=expandFormat(config._f,config._locale).match(formattingTokens)||[];for(i=0;i<tokens.length;i++){token=tokens[i];parsedInput=(string.match(getParseRegexForToken(token,config))||[])[0];if(parsedInput){skipped=string.substr(0,string.indexOf(parsedInput));if(skipped.length>0){getParsingFlags(config).unusedInput.push(skipped)}string=string.slice(string.indexOf(parsedInput)+parsedInput.length);totalParsedInputLength+=parsedInput.length}if(formatTokenFunctions[token]){if(parsedInput){getParsingFlags(config).empty=false}else{getParsingFlags(config).unusedTokens.push(token)}addTimeToArrayFromToken(token,parsedInput,config)}else if(config._strict&&!parsedInput){getParsingFlags(config).unusedTokens.push(token)}}getParsingFlags(config).charsLeftOver=stringLength-totalParsedInputLength;if(string.length>0){getParsingFlags(config).unusedInput.push(string)}if(config._a[HOUR]<=12&&getParsingFlags(config).bigHour===true&&config._a[HOUR]>0){getParsingFlags(config).bigHour=undefined}getParsingFlags(config).parsedDateParts=config._a.slice(0);getParsingFlags(config).meridiem=config._meridiem;config._a[HOUR]=meridiemFixWrap(config._locale,config._a[HOUR],config._meridiem);configFromArray(config);checkOverflow(config)}function meridiemFixWrap(locale,hour,meridiem){var isPm;if(meridiem==null){return hour}if(locale.meridiemHour!=null){return locale.meridiemHour(hour,meridiem)}else if(locale.isPM!=null){isPm=locale.isPM(meridiem);if(isPm&&hour<12){hour+=12}if(!isPm&&hour===12){hour=0}return hour}else{return hour}}function configFromStringAndArray(config){var tempConfig,bestMoment,scoreToBeat,i,currentScore;if(config._f.length===0){getParsingFlags(config).invalidFormat=true;config._d=new Date(NaN);return}for(i=0;i<config._f.length;i++){currentScore=0;tempConfig=copyConfig({},config);if(config._useUTC!=null){tempConfig._useUTC=config._useUTC}tempConfig._f=config._f[i];configFromStringAndFormat(tempConfig);if(!isValid(tempConfig)){continue}currentScore+=getParsingFlags(tempConfig).charsLeftOver;currentScore+=getParsingFlags(tempConfig).unusedTokens.length*10;getParsingFlags(tempConfig).score=currentScore;if(scoreToBeat==null||currentScore<scoreToBeat){scoreToBeat=currentScore;bestMoment=tempConfig}}extend(config,bestMoment||tempConfig)}function configFromObject(config){if(config._d){return}var i=normalizeObjectUnits(config._i);config._a=map([i.year,i.month,i.day||i.date,i.hour,i.minute,i.second,i.millisecond],function(obj){return obj&&parseInt(obj,10)});configFromArray(config)}function createFromConfig(config){var res=new Moment(checkOverflow(prepareConfig(config)));if(res._nextDay){res.add(1,"d");res._nextDay=undefined}return res}function prepareConfig(config){var input=config._i,format=config._f;config._locale=config._locale||getLocale(config._l);if(input===null||format===undefined&&input===""){return createInvalid({nullInput:true})}if(typeof input==="string"){config._i=input=config._locale.preparse(input)}if(isMoment(input)){return new Moment(checkOverflow(input))}else if(isDate(input)){config._d=input}else if(isArray(format)){configFromStringAndArray(config)}else if(format){configFromStringAndFormat(config)}else{configFromInput(config)}if(!isValid(config)){config._d=null}return config}function configFromInput(config){var input=config._i;if(isUndefined(input)){config._d=new Date(hooks.now())}else if(isDate(input)){config._d=new Date(input.valueOf())}else if(typeof input==="string"){configFromString(config)}else if(isArray(input)){config._a=map(input.slice(0),function(obj){return parseInt(obj,10)});configFromArray(config)}else if(isObject(input)){configFromObject(config)}else if(isNumber(input)){config._d=new Date(input)}else{hooks.createFromInputFallback(config)}}function createLocalOrUTC(input,format,locale,strict,isUTC){var c={};if(locale===true||locale===false){strict=locale;locale=undefined}if(isObject(input)&&isObjectEmpty(input)||isArray(input)&&input.length===0){input=undefined}c._isAMomentObject=true;c._useUTC=c._isUTC=isUTC;c._l=locale;c._i=input;c._f=format;c._strict=strict;return createFromConfig(c)}function createLocal(input,format,locale,strict){return createLocalOrUTC(input,format,locale,strict,false)}hooks.createFromInputFallback=deprecate("value provided is not in a recognized RFC2822 or ISO format. moment construction falls back to js Date(), "+"which is not reliable across all browsers and versions. Non RFC2822/ISO date formats are "+"discouraged and will be removed in an upcoming major release. Please refer to "+"http://momentjs.com/guides/#/warnings/js-date/ for more info.",function(config){config._d=new Date(config._i+(config._useUTC?" UTC":""))}),hooks.ISO_8601=function(){},hooks.RFC_2822=function(){};var prototypeMin=deprecate("moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var other=createLocal.apply(null,arguments);if(this.isValid()&&other.isValid()){return other<this?this:other}else{return createInvalid()}}),prototypeMax=deprecate("moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var other=createLocal.apply(null,arguments);if(this.isValid()&&other.isValid()){return other>this?this:other}else{return createInvalid()}});function pickBy(fn,moments){var res,i;if(moments.length===1&&isArray(moments[0])){moments=moments[0]}if(!moments.length){return createLocal()}res=moments[0];for(i=1;i<moments.length;++i){if(!moments[i].isValid()||moments[i][fn](res)){res=moments[i]}}return res}function min(){var args;return pickBy("isBefore",[].slice.call(arguments,0))}function max(){var args;return pickBy("isAfter",[].slice.call(arguments,0))}var now=function(){return Date.now?Date.now():+new Date},ordering=["year","quarter","month","week","day","hour","minute","second","millisecond"];function isDurationValid(m){for(var key in m){if(!(indexOf.call(ordering,key)!==-1&&(m[key]==null||!isNaN(m[key])))){return false}}var unitHasDecimal=false;for(var i=0;i<ordering.length;++i){if(m[ordering[i]]){if(unitHasDecimal){return false}if(parseFloat(m[ordering[i]])!==toInt(m[ordering[i]])){unitHasDecimal=true}}}return true}function isValid$1(){return this._isValid}function createInvalid$1(){return createDuration(NaN)}function Duration(duration){var normalizedInput=normalizeObjectUnits(duration),years=normalizedInput.year||0,quarters=normalizedInput.quarter||0,months=normalizedInput.month||0,weeks=normalizedInput.week||normalizedInput.isoWeek||0,days=normalizedInput.day||0,hours=normalizedInput.hour||0,minutes=normalizedInput.minute||0,seconds=normalizedInput.second||0,milliseconds=normalizedInput.millisecond||0;this._isValid=isDurationValid(normalizedInput);this._milliseconds=+milliseconds+seconds*1e3+minutes*6e4+hours*1e3*60*60;this._days=+days+weeks*7;this._months=+months+quarters*3+years*12;this._data={};this._locale=getLocale();this._bubble()}function isDuration(obj){return obj instanceof Duration}function absRound(number){if(number<0){return Math.round(-1*number)*-1}else{return Math.round(number)}}function offset(token,separator){addFormatToken(token,0,0,function(){var offset=this.utcOffset();var sign="+";if(offset<0){offset=-offset;sign="-"}return sign+zeroFill(~~(offset/60),2)+separator+zeroFill(~~offset%60,2)})}offset("Z",":"),offset("ZZ",""),addRegexToken("Z",matchShortOffset),addRegexToken("ZZ",matchShortOffset),addParseToken(["Z","ZZ"],function(input,array,config){config._useUTC=true;config._tzm=offsetFromString(matchShortOffset,input)});var chunkOffset=/([\+\-]|\d\d)/gi;function offsetFromString(matcher,string){var matches=(string||"").match(matcher);if(matches===null){return null}var chunk=matches[matches.length-1]||[];var parts=(chunk+"").match(chunkOffset)||["-",0,0];var minutes=+(parts[1]*60)+toInt(parts[2]);return minutes===0?0:parts[0]==="+"?minutes:-minutes}function cloneWithOffset(input,model){var res,diff;if(model._isUTC){res=model.clone();diff=(isMoment(input)||isDate(input)?input.valueOf():createLocal(input).valueOf())-res.valueOf();res._d.setTime(res._d.valueOf()+diff);hooks.updateOffset(res,false);return res}else{return createLocal(input).local()}}function getDateOffset(m){return-Math.round(m._d.getTimezoneOffset()/15)*15}function getSetOffset(input,keepLocalTime,keepMinutes){var offset=this._offset||0,localAdjust;if(!this.isValid()){return input!=null?this:NaN}if(input!=null){if(typeof input==="string"){input=offsetFromString(matchShortOffset,input);if(input===null){return this}}else if(Math.abs(input)<16&&!keepMinutes){input=input*60}if(!this._isUTC&&keepLocalTime){localAdjust=getDateOffset(this)}this._offset=input;this._isUTC=true;if(localAdjust!=null){this.add(localAdjust,"m")}if(offset!==input){if(!keepLocalTime||this._changeInProgress){addSubtract(this,createDuration(input-offset,"m"),1,false)}else if(!this._changeInProgress){this._changeInProgress=true;hooks.updateOffset(this,true);this._changeInProgress=null}}return this}else{return this._isUTC?offset:getDateOffset(this)}}function getSetZone(input,keepLocalTime){if(input!=null){if(typeof input!=="string"){input=-input}this.utcOffset(input,keepLocalTime);return this}else{return-this.utcOffset()}}function setOffsetToUTC(keepLocalTime){return this.utcOffset(0,keepLocalTime)}function setOffsetToLocal(keepLocalTime){if(this._isUTC){this.utcOffset(0,keepLocalTime);this._isUTC=false;if(keepLocalTime){this.subtract(getDateOffset(this),"m")}}return this}function setOffsetToParsedOffset(){if(this._tzm!=null){this.utcOffset(this._tzm,false,true)}else if(typeof this._i==="string"){var tZone=offsetFromString(matchOffset,this._i);if(tZone!=null){this.utcOffset(tZone)}else{this.utcOffset(0,true)}}return this}function hasAlignedHourOffset(input){if(!this.isValid()){return false}input=input?createLocal(input).utcOffset():0;return(this.utcOffset()-input)%60===0}function isDaylightSavingTime(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()}function isDaylightSavingTimeShifted(){if(!isUndefined(this._isDSTShifted)){return this._isDSTShifted}var c={};copyConfig(c,this);c=prepareConfig(c);if(c._a){var other=c._isUTC?createUTC(c._a):createLocal(c._a);this._isDSTShifted=this.isValid()&&compareArrays(c._a,other.toArray())>0}else{this._isDSTShifted=false}return this._isDSTShifted}function isLocal(){return this.isValid()?!this._isUTC:false}function isUtcOffset(){return this.isValid()?this._isUTC:false}function isUtc(){return this.isValid()?this._isUTC&&this._offset===0:false}hooks.updateOffset=function(){};var aspNetRegex=/^(\-|\+)?(?:(\d*)[. ])?(\d+)\:(\d+)(?:\:(\d+)(\.\d*)?)?$/,isoRegex=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;function createDuration(input,key){var duration=input,match=null,sign,ret,diffRes;if(isDuration(input)){duration={ms:input._milliseconds,d:input._days,M:input._months}}else if(isNumber(input)){duration={};if(key){duration[key]=input}else{duration.milliseconds=input}}else if(!!(match=aspNetRegex.exec(input))){sign=match[1]==="-"?-1:1;duration={y:0,d:toInt(match[DATE])*sign,h:toInt(match[HOUR])*sign,m:toInt(match[MINUTE])*sign,s:toInt(match[SECOND])*sign,ms:toInt(absRound(match[MILLISECOND]*1e3))*sign}}else if(!!(match=isoRegex.exec(input))){sign=match[1]==="-"?-1:1;duration={y:parseIso(match[2],sign),M:parseIso(match[3],sign),w:parseIso(match[4],sign),d:parseIso(match[5],sign),h:parseIso(match[6],sign),m:parseIso(match[7],sign),s:parseIso(match[8],sign)}}else if(duration==null){duration={}}else if(typeof duration==="object"&&("from"in duration||"to"in duration)){diffRes=momentsDifference(createLocal(duration.from),createLocal(duration.to));duration={};duration.ms=diffRes.milliseconds;duration.M=diffRes.months}ret=new Duration(duration);if(isDuration(input)&&hasOwnProp(input,"_locale")){ret._locale=input._locale}return ret}function parseIso(inp,sign){var res=inp&&parseFloat(inp.replace(",","."));return(isNaN(res)?0:res)*sign}function positiveMomentsDifference(base,other){var res={};res.months=other.month()-base.month()+(other.year()-base.year())*12;if(base.clone().add(res.months,"M").isAfter(other)){--res.months}res.milliseconds=+other-+base.clone().add(res.months,"M");return res}function momentsDifference(base,other){var res;if(!(base.isValid()&&other.isValid())){return{milliseconds:0,months:0}}other=cloneWithOffset(other,base);if(base.isBefore(other)){res=positiveMomentsDifference(base,other)}else{res=positiveMomentsDifference(other,base);res.milliseconds=-res.milliseconds;res.months=-res.months}return res}function createAdder(direction,name){return function(val,period){var dur,tmp;if(period!==null&&!isNaN(+period)){deprecateSimple(name,"moment()."+name+"(period, number) is deprecated. Please use moment()."+name+"(number, period). "+"See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info.");tmp=val;val=period;period=tmp}val=typeof val==="string"?+val:val;dur=createDuration(val,period);addSubtract(this,dur,direction);return this}}function addSubtract(mom,duration,isAdding,updateOffset){var milliseconds=duration._milliseconds,days=absRound(duration._days),months=absRound(duration._months);if(!mom.isValid()){return}updateOffset=updateOffset==null?true:updateOffset;if(months){setMonth(mom,get(mom,"Month")+months*isAdding)}if(days){set$1(mom,"Date",get(mom,"Date")+days*isAdding)}if(milliseconds){mom._d.setTime(mom._d.valueOf()+milliseconds*isAdding)}if(updateOffset){hooks.updateOffset(mom,days||months)}}createDuration.fn=Duration.prototype,createDuration.invalid=createInvalid$1;var add=createAdder(1,"add"),subtract=createAdder(-1,"subtract");function getCalendarFormat(myMoment,now){var diff=myMoment.diff(now,"days",!0);return diff<-6?"sameElse":diff<-1?"lastWeek":diff<0?"lastDay":diff<1?"sameDay":diff<2?"nextDay":diff<7?"nextWeek":"sameElse"}function calendar$1(time,formats){var now=time||createLocal(),sod=cloneWithOffset(now,this).startOf("day"),format=hooks.calendarFormat(this,sod)||"sameElse";var output=formats&&(isFunction(formats[format])?formats[format].call(this,now):formats[format]);return this.format(output||this.localeData().calendar(format,this,createLocal(now)))}function clone(){return new Moment(this)}function isAfter(input,units){var localInput=isMoment(input)?input:createLocal(input);if(!(this.isValid()&&localInput.isValid())){return false}units=normalizeUnits(units)||"millisecond";if(units==="millisecond"){return this.valueOf()>localInput.valueOf()}else{return localInput.valueOf()<this.clone().startOf(units).valueOf()}}function isBefore(input,units){var localInput=isMoment(input)?input:createLocal(input);if(!(this.isValid()&&localInput.isValid())){return false}units=normalizeUnits(units)||"millisecond";if(units==="millisecond"){return this.valueOf()<localInput.valueOf()}else{return this.clone().endOf(units).valueOf()<localInput.valueOf()}}function isBetween(from,to,units,inclusivity){var localFrom=isMoment(from)?from:createLocal(from),localTo=isMoment(to)?to:createLocal(to);if(!(this.isValid()&&localFrom.isValid()&&localTo.isValid())){return false}inclusivity=inclusivity||"()";return(inclusivity[0]==="("?this.isAfter(localFrom,units):!this.isBefore(localFrom,units))&&(inclusivity[1]===")"?this.isBefore(localTo,units):!this.isAfter(localTo,units))}function isSame(input,units){var localInput=isMoment(input)?input:createLocal(input),inputMs;if(!(this.isValid()&&localInput.isValid())){return false}units=normalizeUnits(units)||"millisecond";if(units==="millisecond"){return this.valueOf()===localInput.valueOf()}else{inputMs=localInput.valueOf();return this.clone().startOf(units).valueOf()<=inputMs&&inputMs<=this.clone().endOf(units).valueOf()}}function isSameOrAfter(input,units){return this.isSame(input,units)||this.isAfter(input,units)}function isSameOrBefore(input,units){return this.isSame(input,units)||this.isBefore(input,units)}function diff(input,units,asFloat){var that,zoneDelta,output;if(!this.isValid()){return NaN}that=cloneWithOffset(input,this);if(!that.isValid()){return NaN}zoneDelta=(that.utcOffset()-this.utcOffset())*6e4;units=normalizeUnits(units);switch(units){case"year":output=monthDiff(this,that)/12;break;case"month":output=monthDiff(this,that);break;case"quarter":output=monthDiff(this,that)/3;break;case"second":output=(this-that)/1e3;break;case"minute":output=(this-that)/6e4;break;case"hour":output=(this-that)/36e5;break;case"day":output=(this-that-zoneDelta)/864e5;break;case"week":output=(this-that-zoneDelta)/6048e5;break;default:output=this-that}return asFloat?output:absFloor(output)}function monthDiff(a,b){var wholeMonthDiff=(b.year()-a.year())*12+(b.month()-a.month()),anchor=a.clone().add(wholeMonthDiff,"months"),anchor2,adjust;if(b-anchor<0){anchor2=a.clone().add(wholeMonthDiff-1,"months");adjust=(b-anchor)/(anchor-anchor2)}else{anchor2=a.clone().add(wholeMonthDiff+1,"months");adjust=(b-anchor)/(anchor2-anchor)}return-(wholeMonthDiff+adjust)||0}function toString(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")}function toISOString(keepOffset){if(!this.isValid()){return null}var utc=keepOffset!==true;var m=utc?this.clone().utc():this;if(m.year()<0||m.year()>9999){return formatMoment(m,utc?"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYYYY-MM-DD[T]HH:mm:ss.SSSZ")}if(isFunction(Date.prototype.toISOString)){if(utc){return this.toDate().toISOString()}else{return new Date(this.valueOf()+this.utcOffset()*60*1e3).toISOString().replace("Z",formatMoment(m,"Z"))}}return formatMoment(m,utc?"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYY-MM-DD[T]HH:mm:ss.SSSZ")}function inspect(){if(!this.isValid()){return"moment.invalid(/* "+this._i+" */)"}var func="moment";var zone="";if(!this.isLocal()){func=this.utcOffset()===0?"moment.utc":"moment.parseZone";zone="Z"}var prefix="["+func+'("]';var year=0<=this.year()&&this.year()<=9999?"YYYY":"YYYYYY";var datetime="-MM-DD[T]HH:mm:ss.SSS";var suffix=zone+'[")]';return this.format(prefix+year+datetime+suffix)}function format(inputString){if(!inputString){inputString=this.isUtc()?hooks.defaultFormatUtc:hooks.defaultFormat}var output=formatMoment(this,inputString);return this.localeData().postformat(output)}function from(time,withoutSuffix){if(this.isValid()&&(isMoment(time)&&time.isValid()||createLocal(time).isValid())){return createDuration({to:this,from:time}).locale(this.locale()).humanize(!withoutSuffix)}else{return this.localeData().invalidDate()}}function fromNow(withoutSuffix){return this.from(createLocal(),withoutSuffix)}function to(time,withoutSuffix){if(this.isValid()&&(isMoment(time)&&time.isValid()||createLocal(time).isValid())){return createDuration({from:this,to:time}).locale(this.locale()).humanize(!withoutSuffix)}else{return this.localeData().invalidDate()}}function toNow(withoutSuffix){return this.to(createLocal(),withoutSuffix)}function locale(key){var newLocaleData;if(key===undefined){return this._locale._abbr}else{newLocaleData=getLocale(key);if(newLocaleData!=null){this._locale=newLocaleData}return this}}hooks.defaultFormat="YYYY-MM-DDTHH:mm:ssZ",hooks.defaultFormatUtc="YYYY-MM-DDTHH:mm:ss[Z]";var lang=deprecate("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(key){if(key===undefined){return this.localeData()}else{return this.locale(key)}});function localeData(){return this._locale}var MS_PER_SECOND=1e3,MS_PER_MINUTE=60*MS_PER_SECOND,MS_PER_HOUR=60*MS_PER_MINUTE,MS_PER_400_YEARS=(365*400+97)*24*MS_PER_HOUR;function mod$1(dividend,divisor){return(dividend%divisor+divisor)%divisor}function localStartOfDate(y,m,d){if(y<100&&y>=0){return new Date(y+400,m,d)-MS_PER_400_YEARS}else{return new Date(y,m,d).valueOf()}}function utcStartOfDate(y,m,d){if(y<100&&y>=0){return Date.UTC(y+400,m,d)-MS_PER_400_YEARS}else{return Date.UTC(y,m,d)}}function startOf(units){var time;units=normalizeUnits(units);if(units===undefined||units==="millisecond"||!this.isValid()){return this}var startOfDate=this._isUTC?utcStartOfDate:localStartOfDate;switch(units){case"year":time=startOfDate(this.year(),0,1);break;case"quarter":time=startOfDate(this.year(),this.month()-this.month()%3,1);break;case"month":time=startOfDate(this.year(),this.month(),1);break;case"week":time=startOfDate(this.year(),this.month(),this.date()-this.weekday());break;case"isoWeek":time=startOfDate(this.year(),this.month(),this.date()-(this.isoWeekday()-1));break;case"day":case"date":time=startOfDate(this.year(),this.month(),this.date());break;case"hour":time=this._d.valueOf();time-=mod$1(time+(this._isUTC?0:this.utcOffset()*MS_PER_MINUTE),MS_PER_HOUR);break;case"minute":time=this._d.valueOf();time-=mod$1(time,MS_PER_MINUTE);break;case"second":time=this._d.valueOf();time-=mod$1(time,MS_PER_SECOND);break}this._d.setTime(time);hooks.updateOffset(this,true);return this}function endOf(units){var time;units=normalizeUnits(units);if(units===undefined||units==="millisecond"||!this.isValid()){return this}var startOfDate=this._isUTC?utcStartOfDate:localStartOfDate;switch(units){case"year":time=startOfDate(this.year()+1,0,1)-1;break;case"quarter":time=startOfDate(this.year(),this.month()-this.month()%3+3,1)-1;break;case"month":time=startOfDate(this.year(),this.month()+1,1)-1;break;case"week":time=startOfDate(this.year(),this.month(),this.date()-this.weekday()+7)-1;break;case"isoWeek":time=startOfDate(this.year(),this.month(),this.date()-(this.isoWeekday()-1)+7)-1;break;case"day":case"date":time=startOfDate(this.year(),this.month(),this.date()+1)-1;break;case"hour":time=this._d.valueOf();time+=MS_PER_HOUR-mod$1(time+(this._isUTC?0:this.utcOffset()*MS_PER_MINUTE),MS_PER_HOUR)-1;break;case"minute":time=this._d.valueOf();time+=MS_PER_MINUTE-mod$1(time,MS_PER_MINUTE)-1;break;case"second":time=this._d.valueOf();time+=MS_PER_SECOND-mod$1(time,MS_PER_SECOND)-1;break}this._d.setTime(time);hooks.updateOffset(this,true);return this}function valueOf(){return this._d.valueOf()-(this._offset||0)*6e4}function unix(){return Math.floor(this.valueOf()/1e3)}function toDate(){return new Date(this.valueOf())}function toArray(){var m=this;return[m.year(),m.month(),m.date(),m.hour(),m.minute(),m.second(),m.millisecond()]}function toObject(){var m=this;return{years:m.year(),months:m.month(),date:m.date(),hours:m.hours(),minutes:m.minutes(),seconds:m.seconds(),milliseconds:m.milliseconds()}}function toJSON(){return this.isValid()?this.toISOString():null}function isValid$2(){return isValid(this)}function parsingFlags(){return extend({},getParsingFlags(this))}function invalidAt(){return getParsingFlags(this).overflow}function creationData(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}}function addWeekYearFormatToken(token,getter){addFormatToken(0,[token,token.length],0,getter)}function getSetWeekYear(input){return getSetWeekYearHelper.call(this,input,this.week(),this.weekday(),this.localeData()._week.dow,this.localeData()._week.doy)}function getSetISOWeekYear(input){return getSetWeekYearHelper.call(this,input,this.isoWeek(),this.isoWeekday(),1,4)}function getISOWeeksInYear(){return weeksInYear(this.year(),1,4)}function getWeeksInYear(){var weekInfo=this.localeData()._week;return weeksInYear(this.year(),weekInfo.dow,weekInfo.doy)}function getSetWeekYearHelper(input,week,weekday,dow,doy){var weeksTarget;if(input==null){return weekOfYear(this,dow,doy).year}else{weeksTarget=weeksInYear(input,dow,doy);if(week>weeksTarget){week=weeksTarget}return setWeekAll.call(this,input,week,weekday,dow,doy)}}function setWeekAll(weekYear,week,weekday,dow,doy){var dayOfYearData=dayOfYearFromWeeks(weekYear,week,weekday,dow,doy),date=createUTCDate(dayOfYearData.year,0,dayOfYearData.dayOfYear);this.year(date.getUTCFullYear());this.month(date.getUTCMonth());this.date(date.getUTCDate());return this}function getSetQuarter(input){return input==null?Math.ceil((this.month()+1)/3):this.month((input-1)*3+this.month()%3)}addFormatToken(0,["gg",2],0,function(){return this.weekYear()%100}),addFormatToken(0,["GG",2],0,function(){return this.isoWeekYear()%100}),addWeekYearFormatToken("gggg","weekYear"),addWeekYearFormatToken("ggggg","weekYear"),addWeekYearFormatToken("GGGG","isoWeekYear"),addWeekYearFormatToken("GGGGG","isoWeekYear"),addUnitAlias("weekYear","gg"),addUnitAlias("isoWeekYear","GG"),addUnitPriority("weekYear",1),addUnitPriority("isoWeekYear",1),addRegexToken("G",matchSigned),addRegexToken("g",matchSigned),addRegexToken("GG",match1to2,match2),addRegexToken("gg",match1to2,match2),addRegexToken("GGGG",match1to4,match4),addRegexToken("gggg",match1to4,match4),addRegexToken("GGGGG",match1to6,match6),addRegexToken("ggggg",match1to6,match6),addWeekParseToken(["gggg","ggggg","GGGG","GGGGG"],function(input,week,config,token){week[token.substr(0,2)]=toInt(input)}),addWeekParseToken(["gg","GG"],function(input,week,config,token){week[token]=hooks.parseTwoDigitYear(input)}),addFormatToken("Q",0,"Qo","quarter"),addUnitAlias("quarter","Q"),addUnitPriority("quarter",7),addRegexToken("Q",match1),addParseToken("Q",function(input,array){array[MONTH]=(toInt(input)-1)*3}),addFormatToken("D",["DD",2],"Do","date"),addUnitAlias("date","D"),addUnitPriority("date",9),addRegexToken("D",match1to2),addRegexToken("DD",match1to2,match2),addRegexToken("Do",function(isStrict,locale){return isStrict?locale._dayOfMonthOrdinalParse||locale._ordinalParse:locale._dayOfMonthOrdinalParseLenient}),addParseToken(["D","DD"],DATE),addParseToken("Do",function(input,array){array[DATE]=toInt(input.match(match1to2)[0])});var getSetDayOfMonth=makeGetSet("Date",true);function getSetDayOfYear(input){var dayOfYear=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return input==null?dayOfYear:this.add(input-dayOfYear,"d")}addFormatToken("DDD",["DDDD",3],"DDDo","dayOfYear"),addUnitAlias("dayOfYear","DDD"),addUnitPriority("dayOfYear",4),addRegexToken("DDD",match1to3),addRegexToken("DDDD",match3),addParseToken(["DDD","DDDD"],function(input,array,config){config._dayOfYear=toInt(input)}),addFormatToken("m",["mm",2],0,"minute"),addUnitAlias("minute","m"),addUnitPriority("minute",14),addRegexToken("m",match1to2),addRegexToken("mm",match1to2,match2),addParseToken(["m","mm"],MINUTE);var getSetMinute=makeGetSet("Minutes",false);addFormatToken("s",["ss",2],0,"second"),addUnitAlias("second","s"),addUnitPriority("second",15),addRegexToken("s",match1to2),addRegexToken("ss",match1to2,match2),addParseToken(["s","ss"],SECOND);var getSetSecond=makeGetSet("Seconds",false),token;for(addFormatToken("S",0,0,function(){return~~(this.millisecond()/100)}),addFormatToken(0,["SS",2],0,function(){return~~(this.millisecond()/10)}),addFormatToken(0,["SSS",3],0,"millisecond"),addFormatToken(0,["SSSS",4],0,function(){return this.millisecond()*10}),addFormatToken(0,["SSSSS",5],0,function(){return this.millisecond()*100}),addFormatToken(0,["SSSSSS",6],0,function(){return this.millisecond()*1e3}),addFormatToken(0,["SSSSSSS",7],0,function(){return this.millisecond()*1e4}),addFormatToken(0,["SSSSSSSS",8],0,function(){return this.millisecond()*1e5}),addFormatToken(0,["SSSSSSSSS",9],0,function(){return this.millisecond()*1e6}),addUnitAlias("millisecond","ms"),addUnitPriority("millisecond",16),addRegexToken("S",match1to3,match1),addRegexToken("SS",match1to3,match2),addRegexToken("SSS",match1to3,match3),token="SSSS";token.length<=9;token+="S"){addRegexToken(token,matchUnsigned)}function parseMs(input,array){array[MILLISECOND]=toInt(("0."+input)*1e3)}for(token="S";token.length<=9;token+="S"){addParseToken(token,parseMs)}var getSetMillisecond=makeGetSet("Milliseconds",false);function getZoneAbbr(){return this._isUTC?"UTC":""}function getZoneName(){return this._isUTC?"Coordinated Universal Time":""}addFormatToken("z",0,0,"zoneAbbr"),addFormatToken("zz",0,0,"zoneName");var proto=Moment.prototype;function createUnix(input){return createLocal(1e3*input)}function createInZone(){return createLocal.apply(null,arguments).parseZone()}function preParsePostFormat(string){return string}proto.add=add,proto.calendar=calendar$1,proto.clone=clone,proto.diff=diff,proto.endOf=endOf,proto.format=format,proto.from=from,proto.fromNow=fromNow,proto.to=to,proto.toNow=toNow,proto.get=stringGet,proto.invalidAt=invalidAt,proto.isAfter=isAfter,proto.isBefore=isBefore,proto.isBetween=isBetween,proto.isSame=isSame,proto.isSameOrAfter=isSameOrAfter,proto.isSameOrBefore=isSameOrBefore,proto.isValid=isValid$2,proto.lang=lang,proto.locale=locale,proto.localeData=localeData,proto.max=prototypeMax,proto.min=prototypeMin,proto.parsingFlags=parsingFlags,proto.set=stringSet,proto.startOf=startOf,proto.subtract=subtract,proto.toArray=toArray,proto.toObject=toObject,proto.toDate=toDate,proto.toISOString=toISOString,proto.inspect=inspect,proto.toJSON=toJSON,proto.toString=toString,proto.unix=unix,proto.valueOf=valueOf,proto.creationData=creationData,proto.year=getSetYear,proto.isLeapYear=getIsLeapYear,proto.weekYear=getSetWeekYear,proto.isoWeekYear=getSetISOWeekYear,proto.quarter=proto.quarters=getSetQuarter,proto.month=getSetMonth,proto.daysInMonth=getDaysInMonth,proto.week=proto.weeks=getSetWeek,proto.isoWeek=proto.isoWeeks=getSetISOWeek,proto.weeksInYear=getWeeksInYear,proto.isoWeeksInYear=getISOWeeksInYear,proto.date=getSetDayOfMonth,proto.day=proto.days=getSetDayOfWeek,proto.weekday=getSetLocaleDayOfWeek,proto.isoWeekday=getSetISODayOfWeek,proto.dayOfYear=getSetDayOfYear,proto.hour=proto.hours=getSetHour,proto.minute=proto.minutes=getSetMinute,proto.second=proto.seconds=getSetSecond,proto.millisecond=proto.milliseconds=getSetMillisecond,proto.utcOffset=getSetOffset,proto.utc=setOffsetToUTC,proto.local=setOffsetToLocal,proto.parseZone=setOffsetToParsedOffset,proto.hasAlignedHourOffset=hasAlignedHourOffset,proto.isDST=isDaylightSavingTime,proto.isLocal=isLocal,proto.isUtcOffset=isUtcOffset,proto.isUtc=isUtc,proto.isUTC=isUtc,proto.zoneAbbr=getZoneAbbr,proto.zoneName=getZoneName,proto.dates=deprecate("dates accessor is deprecated. Use date instead.",getSetDayOfMonth),proto.months=deprecate("months accessor is deprecated. Use month instead",getSetMonth),proto.years=deprecate("years accessor is deprecated. Use year instead",getSetYear),proto.zone=deprecate("moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/",getSetZone),proto.isDSTShifted=deprecate("isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information",isDaylightSavingTimeShifted);var proto$1=Locale.prototype;function get$1(format,index,field,setter){var locale=getLocale();var utc=createUTC().set(setter,index);return locale[field](utc,format)}function listMonthsImpl(format,index,field){if(isNumber(format)){index=format;format=undefined}format=format||"";if(index!=null){return get$1(format,index,field,"month")}var i;var out=[];for(i=0;i<12;i++){out[i]=get$1(format,i,field,"month")}return out}function listWeekdaysImpl(localeSorted,format,index,field){if(typeof localeSorted==="boolean"){if(isNumber(format)){index=format;format=undefined}format=format||""}else{format=localeSorted;index=format;localeSorted=false;if(isNumber(format)){index=format;format=undefined}format=format||""}var locale=getLocale(),shift=localeSorted?locale._week.dow:0;if(index!=null){return get$1(format,(index+shift)%7,field,"day")}var i;var out=[];for(i=0;i<7;i++){out[i]=get$1(format,(i+shift)%7,field,"day")}return out}function listMonths(format,index){return listMonthsImpl(format,index,"months")}function listMonthsShort(format,index){return listMonthsImpl(format,index,"monthsShort")}function listWeekdays(localeSorted,format,index){return listWeekdaysImpl(localeSorted,format,index,"weekdays")}function listWeekdaysShort(localeSorted,format,index){return listWeekdaysImpl(localeSorted,format,index,"weekdaysShort")}function listWeekdaysMin(localeSorted,format,index){return listWeekdaysImpl(localeSorted,format,index,"weekdaysMin")}proto$1.calendar=calendar,proto$1.longDateFormat=longDateFormat,proto$1.invalidDate=invalidDate,proto$1.ordinal=ordinal,proto$1.preparse=preParsePostFormat,proto$1.postformat=preParsePostFormat,proto$1.relativeTime=relativeTime,proto$1.pastFuture=pastFuture,proto$1.set=set,proto$1.months=localeMonths,proto$1.monthsShort=localeMonthsShort,proto$1.monthsParse=localeMonthsParse,proto$1.monthsRegex=monthsRegex,proto$1.monthsShortRegex=monthsShortRegex,proto$1.week=localeWeek,proto$1.firstDayOfYear=localeFirstDayOfYear,proto$1.firstDayOfWeek=localeFirstDayOfWeek,proto$1.weekdays=localeWeekdays,proto$1.weekdaysMin=localeWeekdaysMin,proto$1.weekdaysShort=localeWeekdaysShort,proto$1.weekdaysParse=localeWeekdaysParse,proto$1.weekdaysRegex=weekdaysRegex,proto$1.weekdaysShortRegex=weekdaysShortRegex,proto$1.weekdaysMinRegex=weekdaysMinRegex,proto$1.isPM=localeIsPM,proto$1.meridiem=localeMeridiem,getSetGlobalLocale("en",{dayOfMonthOrdinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(number){var b=number%10,output=toInt(number%100/10)===1?"th":b===1?"st":b===2?"nd":b===3?"rd":"th";return number+output}}),hooks.lang=deprecate("moment.lang is deprecated. Use moment.locale instead.",getSetGlobalLocale),hooks.langData=deprecate("moment.langData is deprecated. Use moment.localeData instead.",getLocale);var mathAbs=Math.abs;function abs(){var data=this._data;return this._milliseconds=mathAbs(this._milliseconds),this._days=mathAbs(this._days),this._months=mathAbs(this._months),data.milliseconds=mathAbs(data.milliseconds),data.seconds=mathAbs(data.seconds),data.minutes=mathAbs(data.minutes),data.hours=mathAbs(data.hours),data.months=mathAbs(data.months),data.years=mathAbs(data.years),this}function addSubtract$1(duration,input,value,direction){var other=createDuration(input,value);duration._milliseconds+=direction*other._milliseconds;duration._days+=direction*other._days;duration._months+=direction*other._months;return duration._bubble()}function add$1(input,value){return addSubtract$1(this,input,value,1)}function subtract$1(input,value){return addSubtract$1(this,input,value,-1)}function absCeil(number){if(number<0){return Math.floor(number)}else{return Math.ceil(number)}}function bubble(){var seconds,minutes,hours,years,monthsFromDays,milliseconds=this._milliseconds,days=this._days,months=this._months,data=this._data;if(!(0<=milliseconds&&0<=days&&0<=months||milliseconds<=0&&days<=0&&months<=0))milliseconds+=864e5*absCeil(monthsToDays(months)+days),months=days=0;return data.milliseconds=milliseconds%1e3,seconds=absFloor(milliseconds/1e3),data.seconds=seconds%60,minutes=absFloor(seconds/60),data.minutes=minutes%60,hours=absFloor(minutes/60),data.hours=hours%24,days+=absFloor(hours/24),monthsFromDays=absFloor(daysToMonths(days)),months+=monthsFromDays,days-=absCeil(monthsToDays(monthsFromDays)),years=absFloor(months/12),months%=12,data.days=days,data.months=months,data.years=years,this}function daysToMonths(days){return days*4800/146097}function monthsToDays(months){return months*146097/4800}function as(units){if(!this.isValid())return NaN;var days,months,milliseconds=this._milliseconds;if("month"===(units=normalizeUnits(units))||"quarter"===units||"year"===units)switch(days=this._days+milliseconds/864e5,months=this._months+daysToMonths(days),units){case"month":return months;case"quarter":return months/3;case"year":return months/12}else switch(days=this._days+Math.round(monthsToDays(this._months)),units){case"week":return days/7+milliseconds/6048e5;case"day":return days+milliseconds/864e5;case"hour":return 24*days+milliseconds/36e5;case"minute":return 1440*days+milliseconds/6e4;case"second":return 86400*days+milliseconds/1e3;case"millisecond":return Math.floor(864e5*days)+milliseconds;default:throw new Error("Unknown unit "+units)}}function valueOf$1(){return this.isValid()?this._milliseconds+864e5*this._days+this._months%12*2592e6+31536e6*toInt(this._months/12):NaN}function makeAs(alias){return function(){return this.as(alias)}}var asMilliseconds=makeAs("ms"),asSeconds=makeAs("s"),asMinutes=makeAs("m"),asHours=makeAs("h"),asDays=makeAs("d"),asWeeks=makeAs("w"),asMonths=makeAs("M"),asQuarters=makeAs("Q"),asYears=makeAs("y");function clone$1(){return createDuration(this)}function get$2(units){return units=normalizeUnits(units),this.isValid()?this[units+"s"]():NaN}function makeGetter(name){return function(){return this.isValid()?this._data[name]:NaN}}var milliseconds=makeGetter("milliseconds"),seconds=makeGetter("seconds"),minutes=makeGetter("minutes"),hours=makeGetter("hours"),days=makeGetter("days"),months=makeGetter("months"),years=makeGetter("years");function weeks(){return absFloor(this.days()/7)}var round=Math.round,thresholds={ss:44,s:45,m:45,h:22,d:26,M:11};function substituteTimeAgo(string,number,withoutSuffix,isFuture,locale){return locale.relativeTime(number||1,!!withoutSuffix,string,isFuture)}function relativeTime$1(posNegDuration,withoutSuffix,locale){var duration=createDuration(posNegDuration).abs(),seconds=round(duration.as("s")),minutes=round(duration.as("m")),hours=round(duration.as("h")),days=round(duration.as("d")),months=round(duration.as("M")),years=round(duration.as("y")),a=seconds<=thresholds.ss&&["s",seconds]||seconds<thresholds.s&&["ss",seconds]||minutes<=1&&["m"]||minutes<thresholds.m&&["mm",minutes]||hours<=1&&["h"]||hours<thresholds.h&&["hh",hours]||days<=1&&["d"]||days<thresholds.d&&["dd",days]||months<=1&&["M"]||months<thresholds.M&&["MM",months]||years<=1&&["y"]||["yy",years];return a[2]=withoutSuffix,a[3]=0<+posNegDuration,a[4]=locale,function(string,number,withoutSuffix,isFuture,locale){return locale.relativeTime(number||1,!!withoutSuffix,string,isFuture)}.apply(null,a)}function getSetRelativeTimeRounding(roundingFunction){return void 0!==roundingFunction?"function"!=typeof roundingFunction?0:(round=roundingFunction,!0):round}function getSetRelativeTimeThreshold(threshold,limit){if(void 0===thresholds[threshold])return!1;if(void 0===limit)return thresholds[threshold];if(thresholds[threshold]=limit,"s"===threshold)thresholds.ss=limit-1;return!0}function humanize(withSuffix){if(!this.isValid())return this.localeData().invalidDate();var locale=this.localeData(),output=function(posNegDuration,withoutSuffix,locale){var duration=createDuration(posNegDuration).abs(),seconds=round(duration.as("s")),minutes=round(duration.as("m")),hours=round(duration.as("h")),days=round(duration.as("d")),months=round(duration.as("M")),years=round(duration.as("y")),a=seconds<=thresholds.ss&&["s",seconds]||seconds<thresholds.s&&["ss",seconds]||minutes<=1&&["m"]||minutes<thresholds.m&&["mm",minutes]||hours<=1&&["h"]||hours<thresholds.h&&["hh",hours]||days<=1&&["d"]||days<thresholds.d&&["dd",days]||months<=1&&["M"]||months<thresholds.M&&["MM",months]||years<=1&&["y"]||["yy",years];return a[2]=withoutSuffix,a[3]=0<+posNegDuration,a[4]=locale,function(string,number,withoutSuffix,isFuture,locale){return locale.relativeTime(number||1,!!withoutSuffix,string,isFuture)}.apply(null,a)}(this,!withSuffix,locale);if(withSuffix)output=locale.pastFuture(+this,output);return locale.postformat(output)}var abs$1=Math.abs;function sign(x){return(x>0)-(x<0)||+x}function toISOString$1(){if(!this.isValid()){return this.localeData().invalidDate()}var seconds=abs$1(this._milliseconds)/1e3;var days=abs$1(this._days);var months=abs$1(this._months);var minutes,hours,years;minutes=absFloor(seconds/60);hours=absFloor(minutes/60);seconds%=60;minutes%=60;years=absFloor(months/12);months%=12;var Y=years;var M=months;var D=days;var h=hours;var m=minutes;var s=seconds?seconds.toFixed(3).replace(/\.?0+$/,""):"";var total=this.asSeconds();if(!total){return"P0D"}var totalSign=total<0?"-":"";var ymSign=sign(this._months)!==sign(total)?"-":"";var daysSign=sign(this._days)!==sign(total)?"-":"";var hmsSign=sign(this._milliseconds)!==sign(total)?"-":"";return totalSign+"P"+(Y?ymSign+Y+"Y":"")+(M?ymSign+M+"M":"")+(D?daysSign+D+"D":"")+(h||m||s?"T":"")+(h?hmsSign+h+"H":"")+(m?hmsSign+m+"M":"")+(s?hmsSign+s+"S":"")}var proto$2=Duration.prototype;return proto$2.isValid=function(){return this._isValid},proto$2.abs=function(){var data=this._data;return this._milliseconds=mathAbs(this._milliseconds),this._days=mathAbs(this._days),this._months=mathAbs(this._months),data.milliseconds=mathAbs(data.milliseconds),data.seconds=mathAbs(data.seconds),data.minutes=mathAbs(data.minutes),data.hours=mathAbs(data.hours),data.months=mathAbs(data.months),data.years=mathAbs(data.years),this},proto$2.add=function(input,value){return addSubtract$1(this,input,value,1)},proto$2.subtract=function(input,value){return addSubtract$1(this,input,value,-1)},proto$2.as=function(units){if(!this.isValid())return NaN;var days,months,milliseconds=this._milliseconds;if("month"===(units=normalizeUnits(units))||"quarter"===units||"year"===units)switch(days=this._days+milliseconds/864e5,months=this._months+daysToMonths(days),units){case"month":return months;case"quarter":return months/3;case"year":return months/12}else switch(days=this._days+Math.round(monthsToDays(this._months)),units){case"week":return days/7+milliseconds/6048e5;case"day":return days+milliseconds/864e5;case"hour":return 24*days+milliseconds/36e5;case"minute":return 1440*days+milliseconds/6e4;case"second":return 86400*days+milliseconds/1e3;case"millisecond":return Math.floor(864e5*days)+milliseconds;default:throw new Error("Unknown unit "+units)}},proto$2.asMilliseconds=asMilliseconds,proto$2.asSeconds=asSeconds,proto$2.asMinutes=asMinutes,proto$2.asHours=asHours,proto$2.asDays=asDays,proto$2.asWeeks=asWeeks,proto$2.asMonths=asMonths,proto$2.asQuarters=asQuarters,proto$2.asYears=asYears,proto$2.valueOf=function(){return this.isValid()?this._milliseconds+864e5*this._days+this._months%12*2592e6+31536e6*toInt(this._months/12):NaN},proto$2._bubble=function(){var seconds,minutes,hours,years,monthsFromDays,milliseconds=this._milliseconds,days=this._days,months=this._months,data=this._data;0<=milliseconds&&0<=days&&0<=months||milliseconds<=0&&days<=0&&months<=0||(milliseconds+=864e5*absCeil(monthsToDays(months)+days),months=days=0);return data.milliseconds=milliseconds%1e3,seconds=absFloor(milliseconds/1e3),data.seconds=seconds%60,minutes=absFloor(seconds/60),data.minutes=minutes%60,hours=absFloor(minutes/60),data.hours=hours%24,days+=absFloor(hours/24),monthsFromDays=absFloor(daysToMonths(days)),months+=monthsFromDays,days-=absCeil(monthsToDays(monthsFromDays)),years=absFloor(months/12),months%=12,data.days=days,data.months=months,data.years=years,this},proto$2.clone=function(){return createDuration(this)},proto$2.get=function(units){return units=normalizeUnits(units),this.isValid()?this[units+"s"]():NaN},proto$2.milliseconds=milliseconds,proto$2.seconds=seconds,proto$2.minutes=minutes,proto$2.hours=hours,proto$2.days=days,proto$2.weeks=function(){return absFloor(this.days()/7)},proto$2.months=months,proto$2.years=years,proto$2.humanize=function(withSuffix){if(!this.isValid())return this.localeData().invalidDate();var locale=this.localeData(),output=function(posNegDuration,withoutSuffix,locale){var duration=createDuration(posNegDuration).abs(),seconds=round(duration.as("s")),minutes=round(duration.as("m")),hours=round(duration.as("h")),days=round(duration.as("d")),months=round(duration.as("M")),years=round(duration.as("y")),a=seconds<=thresholds.ss&&["s",seconds]||seconds<thresholds.s&&["ss",seconds]||minutes<=1&&["m"]||minutes<thresholds.m&&["mm",minutes]||hours<=1&&["h"]||hours<thresholds.h&&["hh",hours]||days<=1&&["d"]||days<thresholds.d&&["dd",days]||months<=1&&["M"]||months<thresholds.M&&["MM",months]||years<=1&&["y"]||["yy",years];return a[2]=withoutSuffix,a[3]=0<+posNegDuration,a[4]=locale,function(string,number,withoutSuffix,isFuture,locale){return locale.relativeTime(number||1,!!withoutSuffix,string,isFuture)}.apply(null,a)}(this,!withSuffix,locale);withSuffix&&(output=locale.pastFuture(+this,output));return locale.postformat(output)},proto$2.toISOString=toISOString$1,proto$2.toString=toISOString$1,proto$2.toJSON=toISOString$1,proto$2.locale=locale,proto$2.localeData=localeData,proto$2.toIsoString=deprecate("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",toISOString$1),proto$2.lang=lang,addFormatToken("X",0,0,"unix"),addFormatToken("x",0,0,"valueOf"),addRegexToken("x",matchSigned),addRegexToken("X",/[+-]?\d+(\.\d{1,3})?/),addParseToken("X",function(input,array,config){config._d=new Date(1e3*parseFloat(input,10))}),addParseToken("x",function(input,array,config){config._d=new Date(toInt(input))}),hooks.version="2.24.0",function(callback){hookCallback=callback}(createLocal),hooks.fn=proto,hooks.min=function(){return pickBy("isBefore",[].slice.call(arguments,0))},hooks.max=function(){return pickBy("isAfter",[].slice.call(arguments,0))},hooks.now=function(){return Date.now?Date.now():+new Date},hooks.utc=createUTC,hooks.unix=function(input){return createLocal(1e3*input)},hooks.months=function(format,index){return listMonthsImpl(format,index,"months")},hooks.isDate=isDate,hooks.locale=getSetGlobalLocale,hooks.invalid=createInvalid,hooks.duration=createDuration,hooks.isMoment=isMoment,hooks.weekdays=function(localeSorted,format,index){return listWeekdaysImpl(localeSorted,format,index,"weekdays")},hooks.parseZone=function(){return createLocal.apply(null,arguments).parseZone()},hooks.localeData=getLocale,hooks.isDuration=isDuration,hooks.monthsShort=function(format,index){return listMonthsImpl(format,index,"monthsShort")},hooks.weekdaysMin=function(localeSorted,format,index){return listWeekdaysImpl(localeSorted,format,index,"weekdaysMin")},hooks.defineLocale=defineLocale,hooks.updateLocale=function(name,config){if(null!=config){var locale,tmpLocale,parentConfig=baseConfig;null!=(tmpLocale=loadLocale(name))&&(parentConfig=tmpLocale._config),config=mergeConfigs(parentConfig,config),(locale=new Locale(config)).parentLocale=locales[name],locales[name]=locale,getSetGlobalLocale(name)}else null!=locales[name]&&(null!=locales[name].parentLocale?locales[name]=locales[name].parentLocale:null!=locales[name]&&delete locales[name]);return locales[name]},hooks.locales=function(){return keys(locales)},hooks.weekdaysShort=function(localeSorted,format,index){return listWeekdaysImpl(localeSorted,format,index,"weekdaysShort")},hooks.normalizeUnits=normalizeUnits,hooks.relativeTimeRounding=function(roundingFunction){return void 0!==roundingFunction?"function"!=typeof roundingFunction?0:(round=roundingFunction,!0):round},hooks.relativeTimeThreshold=function(threshold,limit){if(void 0===thresholds[threshold])return!1;if(void 0===limit)return thresholds[threshold];thresholds[threshold]=limit,"s"===threshold&&(thresholds.ss=limit-1);return!0},hooks.calendarFormat=function(myMoment,now){var diff=myMoment.diff(now,"days",!0);return diff<-6?"sameElse":diff<-1?"lastWeek":diff<0?"lastDay":diff<1?"sameDay":diff<2?"nextDay":diff<7?"nextWeek":"sameElse"},hooks.prototype=proto,hooks.HTML5_FMT={DATETIME_LOCAL:"YYYY-MM-DDTHH:mm",DATETIME_LOCAL_SECONDS:"YYYY-MM-DDTHH:mm:ss",DATETIME_LOCAL_MS:"YYYY-MM-DDTHH:mm:ss.SSS",DATE:"YYYY-MM-DD",TIME:"HH:mm",TIME_SECONDS:"HH:mm:ss",TIME_MS:"HH:mm:ss.SSS",WEEK:"GGGG-[W]WW",MONTH:"YYYY-MM"},hooks}()}),FORMATS={datetime:"MMM D, YYYY, h:mm:ss a",millisecond:"h:mm:ss.SSS a",second:"h:mm:ss a",minute:"h:mm a",hour:"hA",day:"MMM D",week:"ll",month:"MMM YYYY",quarter:"[Q]Q - YYYY",year:"YYYY"};core_adapters._date.override("function"==typeof moment?{_id:"moment",formats:function(){return FORMATS},parse:function(value,format){return"string"==typeof value&&"string"==typeof format?value=moment(value,format):value instanceof moment||(value=moment(value)),value.isValid()?value.valueOf():null},format:function(time,format){return moment(time).format(format)},add:function(time,amount,unit){return moment(time).add(amount,unit).valueOf()},diff:function(max,min,unit){return moment(max).diff(moment(min),unit)},startOf:function(time,unit,weekday){return time=moment(time),"isoWeek"===unit?time.isoWeekday(weekday).valueOf():time.startOf(unit).valueOf()},endOf:function(time,unit){return moment(time).endOf(unit).valueOf()},_create:function(time){return moment(time)}}:{}),core_defaults._set("global",{plugins:{filler:{propagate:!0}}});var mappers={dataset:function(source){var index=source.fill,chart=source.chart,meta=chart.getDatasetMeta(index),points=meta&&chart.isDatasetVisible(index)&&meta.dataset._children||[],length=points.length||0;return length?function(point,i){return i<length&&points[i]._view||null}:null},boundary:function(source){var boundary=source.boundary,x=boundary?boundary.x:null,y=boundary?boundary.y:null;return helpers$1.isArray(boundary)?function(point,i){return boundary[i]}:function(point){return{x:null===x?point.x:x,y:null===y?point.y:y}}}};function decodeFill(el,index,count){var target,model=el._model||{},fill=model.fill;if(void 0===fill&&(fill=!!model.backgroundColor),!1===fill||null===fill)return!1;if(!0===fill)return"origin";if(target=parseFloat(fill,10),isFinite(target)&&Math.floor(target)===target)return"-"!==fill[0]&&"+"!==fill[0]||(target=index+target),!(target===index||target<0||count<=target)&&target;switch(fill){case"bottom":return"start";case"top":return"end";case"zero":return"origin";case"origin":case"start":case"end":return fill;default:return!1}}function computeBoundary(source){return(source.el._scale||{}).getPointPositionForValue?function(source){var start,end,center,i,point,scale=source.el._scale,options=scale.options,length=scale.chart.data.labels.length,fill=source.fill,target=[];if(!length)return null;for(start=options.ticks.reverse?scale.max:scale.min,end=options.ticks.reverse?scale.min:scale.max,center=scale.getPointPositionForValue(0,start),i=0;i<length;++i)point="start"===fill||"end"===fill?scale.getPointPositionForValue(i,"start"===fill?start:end):scale.getBasePosition(i),options.gridLines.circular&&(point.cx=center.x,point.cy=center.y,point.angle=scale.getIndexAngle(i)-Math.PI/2),target.push(point);return target}(source):function(source){var horizontal,model=source.el._model||{},scale=source.el._scale||{},fill=source.fill,target=null;if(isFinite(fill))return null;if("start"===fill?target=void 0===model.scaleBottom?scale.bottom:model.scaleBottom:"end"===fill?target=void 0===model.scaleTop?scale.top:model.scaleTop:void 0!==model.scaleZero?target=model.scaleZero:scale.getBasePixel&&(target=scale.getBasePixel()),null!=target){if(void 0!==target.x&&void 0!==target.y)return target;if(helpers$1.isFinite(target))return{x:(horizontal=scale.isHorizontal())?target:null,y:horizontal?null:target}}return null}(source)}function resolveTarget(sources,index,propagate){var target,fill=sources[index].fill,visited=[index];if(!propagate)return fill;for(;!1!==fill&&-1===visited.indexOf(fill);){if(!isFinite(fill))return fill;if(!(target=sources[fill]))return!1;if(target.visible)return fill;visited.push(fill),fill=target.fill}return!1}function createMapper(source){var fill=source.fill,type="dataset";return!1===fill?null:(isFinite(fill)||(type="boundary"),mappers[type](source))}function isDrawable(point){return point&&!point.skip}function drawArea(ctx,curve0,curve1,len0,len1){var i,cx,cy,r;if(len0&&len1){for(ctx.moveTo(curve0[0].x,curve0[0].y),i=1;i<len0;++i)helpers$1.canvas.lineTo(ctx,curve0[i-1],curve0[i]);if(void 0===curve1[0].angle)for(ctx.lineTo(curve1[len1-1].x,curve1[len1-1].y),i=len1-1;0<i;--i)helpers$1.canvas.lineTo(ctx,curve1[i],curve1[i-1],!0);else for(cx=curve1[0].cx,cy=curve1[0].cy,r=Math.sqrt(Math.pow(curve1[0].x-cx,2)+Math.pow(curve1[0].y-cy,2)),i=len1-1;0<i;--i)ctx.arc(cx,cy,r,curve1[i].angle,curve1[i-1].angle,!0)}}function doFill(ctx,points,mapper,view,color,loop){var i,ilen,index,p0,p1,d0,d1,loopOffset,count=points.length,span=view.spanGaps,curve0=[],curve1=[],len0=0,len1=0;for(ctx.beginPath(),i=0,ilen=count;i<ilen;++i)p1=mapper(p0=points[index=i%count]._view,index,view),d0=isDrawable(p0),d1=isDrawable(p1),loop&&void 0===loopOffset&&d0&&(ilen=count+(loopOffset=i+1)),d0&&d1?(len0=curve0.push(p0),len1=curve1.push(p1)):len0&&len1&&(span?(d0&&curve0.push(p0),d1&&curve1.push(p1)):(drawArea(ctx,curve0,curve1,len0,len1),len0=len1=0,curve0=[],curve1=[]));drawArea(ctx,curve0,curve1,len0,len1),ctx.closePath(),ctx.fillStyle=color,ctx.fill()}var plugin_filler={id:"filler",afterDatasetsUpdate:function(chart,options){var meta,i,el,source,count=(chart.data.datasets||[]).length,propagate=options.propagate,sources=[];for(i=0;i<count;++i)source=null,(el=(meta=chart.getDatasetMeta(i)).dataset)&&el._model&&el instanceof elements.Line&&(source={visible:chart.isDatasetVisible(i),fill:decodeFill(el,i,count),chart:chart,el:el}),meta.$filler=source,sources.push(source);for(i=0;i<count;++i)(source=sources[i])&&(source.fill=resolveTarget(sources,i,propagate),source.boundary=computeBoundary(source),source.mapper=createMapper(source))},beforeDatasetsDraw:function(chart){var meta,i,el,view,points,mapper,color,metasets=chart._getSortedVisibleDatasetMetas(),ctx=chart.ctx;for(i=metasets.length-1;0<=i;--i)(meta=metasets[i].$filler)&&meta.visible&&(view=(el=meta.el)._view,points=el._children||[],mapper=meta.mapper,color=view.backgroundColor||core_defaults.global.defaultColor,mapper&&color&&points.length&&(helpers$1.canvas.clipArea(ctx,chart.chartArea),doFill(ctx,points,mapper,view,color,el._loop),helpers$1.canvas.unclipArea(ctx)))}},getRtlHelper$1=helpers$1.rtl.getRtlAdapter,noop$1=helpers$1.noop,valueOrDefault$e=helpers$1.valueOrDefault;function getBoxWidth(labelOpts,fontSize){return labelOpts.usePointStyle&&labelOpts.boxWidth>fontSize?fontSize:labelOpts.boxWidth}core_defaults._set("global",{legend:{display:!0,position:"top",align:"center",fullWidth:!0,reverse:!1,weight:1e3,onClick:function(e,legendItem){var index=legendItem.datasetIndex,ci=this.chart,meta=ci.getDatasetMeta(index);meta.hidden=null===meta.hidden?!ci.data.datasets[index].hidden:null,ci.update()},onHover:null,onLeave:null,labels:{boxWidth:40,padding:10,generateLabels:function(chart){var datasets=chart.data.datasets,options=chart.options.legend||{},usePointStyle=options.labels&&options.labels.usePointStyle;return chart._getSortedDatasetMetas().map(function(meta){var style=meta.controller.getStyle(usePointStyle?0:void 0);return{text:datasets[meta.index].label,fillStyle:style.backgroundColor,hidden:!chart.isDatasetVisible(meta.index),lineCap:style.borderCapStyle,lineDash:style.borderDash,lineDashOffset:style.borderDashOffset,lineJoin:style.borderJoinStyle,lineWidth:style.borderWidth,strokeStyle:style.borderColor,pointStyle:style.pointStyle,rotation:style.rotation,datasetIndex:meta.index}},this)}}},legendCallback:function(chart){var i,ilen,listItem,list=document.createElement("ul"),datasets=chart.data.datasets;for(list.setAttribute("class",chart.id+"-legend"),i=0,ilen=datasets.length;i<ilen;i++)(listItem=list.appendChild(document.createElement("li"))).appendChild(document.createElement("span")).style.backgroundColor=datasets[i].backgroundColor,datasets[i].label&&listItem.appendChild(document.createTextNode(datasets[i].label));return list.outerHTML}});var Legend=core_element.extend({initialize:function(config){helpers$1.extend(this,config),this.legendHitBoxes=[],this._hoveredItem=null,this.doughnutMode=!1},beforeUpdate:noop$1,update:function(maxWidth,maxHeight,margins){var me=this;return me.beforeUpdate(),me.maxWidth=maxWidth,me.maxHeight=maxHeight,me.margins=margins,me.beforeSetDimensions(),me.setDimensions(),me.afterSetDimensions(),me.beforeBuildLabels(),me.buildLabels(),me.afterBuildLabels(),me.beforeFit(),me.fit(),me.afterFit(),me.afterUpdate(),me.minSize},afterUpdate:noop$1,beforeSetDimensions:noop$1,setDimensions:function(){var me=this;me.isHorizontal()?(me.width=me.maxWidth,me.left=0,me.right=me.width):(me.height=me.maxHeight,me.top=0,me.bottom=me.height),me.paddingLeft=0,me.paddingTop=0,me.paddingRight=0,me.paddingBottom=0,me.minSize={width:0,height:0}},afterSetDimensions:noop$1,beforeBuildLabels:noop$1,buildLabels:function(){var me=this,labelOpts=me.options.labels||{},legendItems=helpers$1.callback(labelOpts.generateLabels,[me.chart],me)||[];labelOpts.filter&&(legendItems=legendItems.filter(function(item){return labelOpts.filter(item,me.chart.data)})),me.options.reverse&&legendItems.reverse(),me.legendItems=legendItems},afterBuildLabels:noop$1,beforeFit:noop$1,fit:function(){var me=this,opts=me.options,labelOpts=opts.labels,display=opts.display,ctx=me.ctx,labelFont=helpers$1.options._parseFont(labelOpts),fontSize=labelFont.size,hitboxes=me.legendHitBoxes=[],minSize=me.minSize,isHorizontal=me.isHorizontal();if(isHorizontal?(minSize.width=me.maxWidth,minSize.height=display?10:0):(minSize.width=display?10:0,minSize.height=me.maxHeight),display){if(ctx.font=labelFont.string,isHorizontal){var lineWidths=me.lineWidths=[0],totalHeight=0;ctx.textAlign="left",ctx.textBaseline="middle",helpers$1.each(me.legendItems,function(legendItem,i){var width=getBoxWidth(labelOpts,fontSize)+fontSize/2+ctx.measureText(legendItem.text).width;(0===i||lineWidths[lineWidths.length-1]+width+2*labelOpts.padding>minSize.width)&&(totalHeight+=fontSize+labelOpts.padding,lineWidths[lineWidths.length-(0<i?0:1)]=0),hitboxes[i]={left:0,top:0,width:width,height:fontSize},lineWidths[lineWidths.length-1]+=width+labelOpts.padding}),minSize.height+=totalHeight}else{var vPadding=labelOpts.padding,columnWidths=me.columnWidths=[],columnHeights=me.columnHeights=[],totalWidth=labelOpts.padding,currentColWidth=0,currentColHeight=0;helpers$1.each(me.legendItems,function(legendItem,i){var itemWidth=getBoxWidth(labelOpts,fontSize)+fontSize/2+ctx.measureText(legendItem.text).width;0<i&&currentColHeight+fontSize+2*vPadding>minSize.height&&(totalWidth+=currentColWidth+labelOpts.padding,columnWidths.push(currentColWidth),columnHeights.push(currentColHeight),currentColHeight=currentColWidth=0),currentColWidth=Math.max(currentColWidth,itemWidth),currentColHeight+=fontSize+vPadding,hitboxes[i]={left:0,top:0,width:itemWidth,height:fontSize}}),totalWidth+=currentColWidth,columnWidths.push(currentColWidth),columnHeights.push(currentColHeight),minSize.width+=totalWidth}me.width=minSize.width,me.height=minSize.height}else me.width=minSize.width=me.height=minSize.height=0},afterFit:noop$1,isHorizontal:function(){return"top"===this.options.position||"bottom"===this.options.position},draw:function(){var me=this,opts=me.options,labelOpts=opts.labels,globalDefaults=core_defaults.global,defaultColor=globalDefaults.defaultColor,lineDefault=globalDefaults.elements.line,legendHeight=me.height,columnHeights=me.columnHeights,legendWidth=me.width,lineWidths=me.lineWidths;if(opts.display){var cursor,rtlHelper=getRtlHelper$1(opts.rtl,me.left,me.minSize.width),ctx=me.ctx,fontColor=valueOrDefault$e(labelOpts.fontColor,globalDefaults.defaultFontColor),labelFont=helpers$1.options._parseFont(labelOpts),fontSize=labelFont.size;ctx.textAlign=rtlHelper.textAlign("left"),ctx.textBaseline="middle",ctx.lineWidth=.5,ctx.strokeStyle=fontColor,ctx.fillStyle=fontColor,ctx.font=labelFont.string;var boxWidth=getBoxWidth(labelOpts,fontSize),hitboxes=me.legendHitBoxes,alignmentOffset=function(dimension,blockSize){switch(opts.align){case"start":return labelOpts.padding;case"end":return dimension-blockSize;default:return(dimension-blockSize+labelOpts.padding)/2}},isHorizontal=me.isHorizontal();cursor=isHorizontal?{x:me.left+alignmentOffset(legendWidth,lineWidths[0]),y:me.top+labelOpts.padding,line:0}:{x:me.left+labelOpts.padding,y:me.top+alignmentOffset(legendHeight,columnHeights[0]),line:0},helpers$1.rtl.overrideTextDirection(me.ctx,opts.textDirection);var itemHeight=fontSize+labelOpts.padding;helpers$1.each(me.legendItems,function(legendItem,i){var textWidth=ctx.measureText(legendItem.text).width,width=boxWidth+fontSize/2+textWidth,x=cursor.x,y=cursor.y;rtlHelper.setWidth(me.minSize.width),isHorizontal?0<i&&x+width+labelOpts.padding>me.left+me.minSize.width&&(y=cursor.y+=itemHeight,cursor.line++,x=cursor.x=me.left+alignmentOffset(legendWidth,lineWidths[cursor.line])):0<i&&y+itemHeight>me.top+me.minSize.height&&(x=cursor.x=x+me.columnWidths[cursor.line]+labelOpts.padding,cursor.line++,y=cursor.y=me.top+alignmentOffset(legendHeight,columnHeights[cursor.line]));var realX=rtlHelper.x(x);!function(x,y,legendItem){if(!(isNaN(boxWidth)||boxWidth<=0)){ctx.save();var lineWidth=valueOrDefault$e(legendItem.lineWidth,lineDefault.borderWidth);if(ctx.fillStyle=valueOrDefault$e(legendItem.fillStyle,defaultColor),ctx.lineCap=valueOrDefault$e(legendItem.lineCap,lineDefault.borderCapStyle),ctx.lineDashOffset=valueOrDefault$e(legendItem.lineDashOffset,lineDefault.borderDashOffset),ctx.lineJoin=valueOrDefault$e(legendItem.lineJoin,lineDefault.borderJoinStyle),ctx.lineWidth=lineWidth,ctx.strokeStyle=valueOrDefault$e(legendItem.strokeStyle,defaultColor),ctx.setLineDash&&ctx.setLineDash(valueOrDefault$e(legendItem.lineDash,lineDefault.borderDash)),labelOpts&&labelOpts.usePointStyle){var radius=boxWidth*Math.SQRT2/2,centerX=rtlHelper.xPlus(x,boxWidth/2),centerY=y+fontSize/2;helpers$1.canvas.drawPoint(ctx,legendItem.pointStyle,radius,centerX,centerY,legendItem.rotation)}else ctx.fillRect(rtlHelper.leftForLtr(x,boxWidth),y,boxWidth,fontSize),0!==lineWidth&&ctx.strokeRect(rtlHelper.leftForLtr(x,boxWidth),y,boxWidth,fontSize);ctx.restore()}}(realX,y,legendItem),hitboxes[i].left=rtlHelper.leftForLtr(realX,hitboxes[i].width),function(x,y,legendItem,textWidth){var halfFontSize=fontSize/2,xLeft=rtlHelper.xPlus(x,boxWidth+halfFontSize),yMiddle=y+halfFontSize;ctx.fillText(legendItem.text,xLeft,yMiddle),legendItem.hidden&&(ctx.beginPath(),ctx.lineWidth=2,ctx.moveTo(xLeft,yMiddle),ctx.lineTo(rtlHelper.xPlus(xLeft,textWidth),yMiddle),ctx.stroke())}(realX,hitboxes[i].top=y,legendItem,textWidth),isHorizontal?cursor.x+=width+labelOpts.padding:cursor.y+=itemHeight}),helpers$1.rtl.restoreTextDirection(me.ctx,opts.textDirection)}},_getLegendItemAt:function(x,y){var i,hitBox,lh,me=this;if(x>=me.left&&x<=me.right&&y>=me.top&&y<=me.bottom)for(lh=me.legendHitBoxes,i=0;i<lh.length;++i)if(x>=(hitBox=lh[i]).left&&x<=hitBox.left+hitBox.width&&y>=hitBox.top&&y<=hitBox.top+hitBox.height)return me.legendItems[i];return null},handleEvent:function(e){var hoveredItem,me=this,opts=me.options,type="mouseup"===e.type?"click":e.type;if("mousemove"===type){if(!opts.onHover&&!opts.onLeave)return}else{if("click"!==type)return;if(!opts.onClick)return}hoveredItem=me._getLegendItemAt(e.x,e.y),"click"===type?hoveredItem&&opts.onClick&&opts.onClick.call(me,e.native,hoveredItem):(opts.onLeave&&hoveredItem!==me._hoveredItem&&(me._hoveredItem&&opts.onLeave.call(me,e.native,me._hoveredItem),me._hoveredItem=hoveredItem),opts.onHover&&hoveredItem&&opts.onHover.call(me,e.native,hoveredItem))}});function createNewLegendAndAttach(chart,legendOpts){var legend=new Legend({ctx:chart.ctx,options:legendOpts,chart:chart});core_layouts.configure(chart,legend,legendOpts),core_layouts.addBox(chart,legend),chart.legend=legend}var plugin_legend={id:"legend",_element:Legend,beforeInit:function(chart){var legendOpts=chart.options.legend;legendOpts&&createNewLegendAndAttach(chart,legendOpts)},beforeUpdate:function(chart){var legendOpts=chart.options.legend,legend=chart.legend;legendOpts?(helpers$1.mergeIf(legendOpts,core_defaults.global.legend),legend?(core_layouts.configure(chart,legend,legendOpts),legend.options=legendOpts):createNewLegendAndAttach(chart,legendOpts)):legend&&(core_layouts.removeBox(chart,legend),delete chart.legend)},afterEvent:function(chart,e){var legend=chart.legend;legend&&legend.handleEvent(e)}},noop$2=helpers$1.noop;core_defaults._set("global",{title:{display:!1,fontStyle:"bold",fullWidth:!0,padding:10,position:"top",text:"",weight:2e3}});var Title=core_element.extend({initialize:function(config){helpers$1.extend(this,config),this.legendHitBoxes=[]},beforeUpdate:noop$2,update:function(maxWidth,maxHeight,margins){var me=this;return me.beforeUpdate(),me.maxWidth=maxWidth,me.maxHeight=maxHeight,me.margins=margins,me.beforeSetDimensions(),me.setDimensions(),me.afterSetDimensions(),me.beforeBuildLabels(),me.buildLabels(),me.afterBuildLabels(),me.beforeFit(),me.fit(),me.afterFit(),me.afterUpdate(),me.minSize},afterUpdate:noop$2,beforeSetDimensions:noop$2,setDimensions:function(){var me=this;me.isHorizontal()?(me.width=me.maxWidth,me.left=0,me.right=me.width):(me.height=me.maxHeight,me.top=0,me.bottom=me.height),me.paddingLeft=0,me.paddingTop=0,me.paddingRight=0,me.paddingBottom=0,me.minSize={width:0,height:0}},afterSetDimensions:noop$2,beforeBuildLabels:noop$2,buildLabels:noop$2,afterBuildLabels:noop$2,beforeFit:noop$2,fit:function(){var textSize,me=this,opts=me.options,minSize=me.minSize={},isHorizontal=me.isHorizontal();opts.display?(textSize=(helpers$1.isArray(opts.text)?opts.text.length:1)*helpers$1.options._parseFont(opts).lineHeight+2*opts.padding,me.width=minSize.width=isHorizontal?me.maxWidth:textSize,me.height=minSize.height=isHorizontal?textSize:me.maxHeight):me.width=minSize.width=me.height=minSize.height=0},afterFit:noop$2,isHorizontal:function(){var pos=this.options.position;return"top"===pos||"bottom"===pos},draw:function(){var me=this,ctx=me.ctx,opts=me.options;if(opts.display){var maxWidth,titleX,titleY,fontOpts=helpers$1.options._parseFont(opts),lineHeight=fontOpts.lineHeight,offset=lineHeight/2+opts.padding,rotation=0,top=me.top,left=me.left,bottom=me.bottom,right=me.right;ctx.fillStyle=helpers$1.valueOrDefault(opts.fontColor,core_defaults.global.defaultFontColor),ctx.font=fontOpts.string,me.isHorizontal()?(titleX=left+(right-left)/2,titleY=top+offset,maxWidth=right-left):(titleX="left"===opts.position?left+offset:right-offset,titleY=top+(bottom-top)/2,maxWidth=bottom-top,rotation=Math.PI*("left"===opts.position?-.5:.5)),ctx.save(),ctx.translate(titleX,titleY),ctx.rotate(rotation),ctx.textAlign="center",ctx.textBaseline="middle";var text=opts.text;if(helpers$1.isArray(text))for(var y=0,i=0;i<text.length;++i)ctx.fillText(text[i],0,y,maxWidth),y+=lineHeight;else ctx.fillText(text,0,0,maxWidth);ctx.restore()}}});function createNewTitleBlockAndAttach(chart,titleOpts){var title=new Title({ctx:chart.ctx,options:titleOpts,chart:chart});core_layouts.configure(chart,title,titleOpts),core_layouts.addBox(chart,title),chart.titleBlock=title}var plugins={},filler=plugin_filler,legend=plugin_legend,title={id:"title",_element:Title,beforeInit:function(chart){var titleOpts=chart.options.title;titleOpts&&createNewTitleBlockAndAttach(chart,titleOpts)},beforeUpdate:function(chart){var titleOpts=chart.options.title,titleBlock=chart.titleBlock;titleOpts?(helpers$1.mergeIf(titleOpts,core_defaults.global.title),titleBlock?(core_layouts.configure(chart,titleBlock,titleOpts),titleBlock.options=titleOpts):createNewTitleBlockAndAttach(chart,titleOpts)):titleBlock&&(core_layouts.removeBox(chart,titleBlock),delete chart.titleBlock)}};function parseMaxStyle(styleValue,node,parentProperty){var valueInPixels;return"string"==typeof styleValue?(valueInPixels=parseInt(styleValue,10),-1!==styleValue.indexOf("%")&&(valueInPixels=valueInPixels/100*node.parentNode[parentProperty])):valueInPixels=styleValue,valueInPixels}function isConstrainedValue(value){return null!=value&&"none"!==value}function getConstraintDimension(domNode,maxStyle,percentageProperty){var view=document.defaultView,parentNode=helpers$1._getParentNode(domNode),constrainedNode=view.getComputedStyle(domNode)[maxStyle],constrainedContainer=view.getComputedStyle(parentNode)[maxStyle],hasCNode=isConstrainedValue(constrainedNode),hasCContainer=isConstrainedValue(constrainedContainer),infinity=Number.POSITIVE_INFINITY;return hasCNode||hasCContainer?Math.min(hasCNode?parseMaxStyle(constrainedNode,domNode,percentageProperty):infinity,hasCContainer?parseMaxStyle(constrainedContainer,parentNode,percentageProperty):infinity):"none"}for(var k in plugins.filler=filler,plugins.legend=legend,plugins.title=title,(core_controller.helpers=helpers$1).where=function(collection,filterCallback){if(helpers$1.isArray(collection)&&Array.prototype.filter)return collection.filter(filterCallback);var filtered=[];return helpers$1.each(collection,function(item){filterCallback(item)&&filtered.push(item)}),filtered},helpers$1.findIndex=Array.prototype.findIndex?function(array,callback,scope){return array.findIndex(callback,scope)}:function(array,callback,scope){scope=void 0===scope?array:scope;for(var i=0,ilen=array.length;i<ilen;++i)if(callback.call(scope,array[i],i,array))return i;return-1},helpers$1.findNextWhere=function(arrayToSearch,filterCallback,startIndex){helpers$1.isNullOrUndef(startIndex)&&(startIndex=-1);for(var i=startIndex+1;i<arrayToSearch.length;i++){var currentItem=arrayToSearch[i];if(filterCallback(currentItem))return currentItem}},helpers$1.findPreviousWhere=function(arrayToSearch,filterCallback,startIndex){helpers$1.isNullOrUndef(startIndex)&&(startIndex=arrayToSearch.length);for(var i=startIndex-1;0<=i;i--){var currentItem=arrayToSearch[i];if(filterCallback(currentItem))return currentItem}},helpers$1.isNumber=function(n){return!isNaN(parseFloat(n))&&isFinite(n)},helpers$1.almostEquals=function(x,y,epsilon){return Math.abs(x-y)<epsilon},helpers$1.almostWhole=function(x,epsilon){var rounded=Math.round(x);return rounded-epsilon<=x&&x<=rounded+epsilon},helpers$1.max=function(array){return array.reduce(function(max,value){return isNaN(value)?max:Math.max(max,value)},Number.NEGATIVE_INFINITY)},helpers$1.min=function(array){return array.reduce(function(min,value){return isNaN(value)?min:Math.min(min,value)},Number.POSITIVE_INFINITY)},helpers$1.sign=Math.sign?function(x){return Math.sign(x)}:function(x){return 0===(x=+x)||isNaN(x)?x:0<x?1:-1},helpers$1.toRadians=function(degrees){return degrees*(Math.PI/180)},helpers$1.toDegrees=function(radians){return radians*(180/Math.PI)},helpers$1._decimalPlaces=function(x){if(helpers$1.isFinite(x)){for(var e=1,p=0;Math.round(x*e)/e!==x;)e*=10,p++;return p}},helpers$1.getAngleFromPoint=function(centrePoint,anglePoint){var distanceFromXCenter=anglePoint.x-centrePoint.x,distanceFromYCenter=anglePoint.y-centrePoint.y,radialDistanceFromCenter=Math.sqrt(distanceFromXCenter*distanceFromXCenter+distanceFromYCenter*distanceFromYCenter),angle=Math.atan2(distanceFromYCenter,distanceFromXCenter);return angle<-.5*Math.PI&&(angle+=2*Math.PI),{angle:angle,distance:radialDistanceFromCenter}},helpers$1.distanceBetweenPoints=function(pt1,pt2){return Math.sqrt(Math.pow(pt2.x-pt1.x,2)+Math.pow(pt2.y-pt1.y,2))},helpers$1.aliasPixel=function(pixelWidth){return pixelWidth%2==0?0:.5},helpers$1._alignPixel=function(chart,pixel,width){var devicePixelRatio=chart.currentDevicePixelRatio,halfWidth=width/2;return Math.round((pixel-halfWidth)*devicePixelRatio)/devicePixelRatio+halfWidth},helpers$1.splineCurve=function(firstPoint,middlePoint,afterPoint,t){var previous=firstPoint.skip?middlePoint:firstPoint,current=middlePoint,next=afterPoint.skip?middlePoint:afterPoint,d01=Math.sqrt(Math.pow(current.x-previous.x,2)+Math.pow(current.y-previous.y,2)),d12=Math.sqrt(Math.pow(next.x-current.x,2)+Math.pow(next.y-current.y,2)),s01=d01/(d01+d12),s12=d12/(d01+d12),fa=t*(s01=isNaN(s01)?0:s01),fb=t*(s12=isNaN(s12)?0:s12);return{previous:{x:current.x-fa*(next.x-previous.x),y:current.y-fa*(next.y-previous.y)},next:{x:current.x+fb*(next.x-previous.x),y:current.y+fb*(next.y-previous.y)}}},helpers$1.EPSILON=Number.EPSILON||1e-14,helpers$1.splineCurveMonotone=function(points){var i,pointBefore,pointCurrent,pointAfter,alphaK,betaK,tauK,squaredMagnitude,deltaX,pointsWithTangents=(points||[]).map(function(point){return{model:point._model,deltaK:0,mK:0}}),pointsLen=pointsWithTangents.length;for(i=0;i<pointsLen;++i)if(!(pointCurrent=pointsWithTangents[i]).model.skip){if(pointBefore=0<i?pointsWithTangents[i-1]:null,(pointAfter=i<pointsLen-1?pointsWithTangents[i+1]:null)&&!pointAfter.model.skip){var slopeDeltaX=pointAfter.model.x-pointCurrent.model.x;pointCurrent.deltaK=0!=slopeDeltaX?(pointAfter.model.y-pointCurrent.model.y)/slopeDeltaX:0}!pointBefore||pointBefore.model.skip?pointCurrent.mK=pointCurrent.deltaK:!pointAfter||pointAfter.model.skip?pointCurrent.mK=pointBefore.deltaK:this.sign(pointBefore.deltaK)!==this.sign(pointCurrent.deltaK)?pointCurrent.mK=0:pointCurrent.mK=(pointBefore.deltaK+pointCurrent.deltaK)/2}for(i=0;i<pointsLen-1;++i)pointCurrent=pointsWithTangents[i],pointAfter=pointsWithTangents[i+1],pointCurrent.model.skip||pointAfter.model.skip||(helpers$1.almostEquals(pointCurrent.deltaK,0,this.EPSILON)?pointCurrent.mK=pointAfter.mK=0:(alphaK=pointCurrent.mK/pointCurrent.deltaK,betaK=pointAfter.mK/pointCurrent.deltaK,(squaredMagnitude=Math.pow(alphaK,2)+Math.pow(betaK,2))<=9||(tauK=3/Math.sqrt(squaredMagnitude),pointCurrent.mK=alphaK*tauK*pointCurrent.deltaK,pointAfter.mK=betaK*tauK*pointCurrent.deltaK)));for(i=0;i<pointsLen;++i)(pointCurrent=pointsWithTangents[i]).model.skip||(pointBefore=0<i?pointsWithTangents[i-1]:null,pointAfter=i<pointsLen-1?pointsWithTangents[i+1]:null,pointBefore&&!pointBefore.model.skip&&(deltaX=(pointCurrent.model.x-pointBefore.model.x)/3,pointCurrent.model.controlPointPreviousX=pointCurrent.model.x-deltaX,pointCurrent.model.controlPointPreviousY=pointCurrent.model.y-deltaX*pointCurrent.mK),pointAfter&&!pointAfter.model.skip&&(deltaX=(pointAfter.model.x-pointCurrent.model.x)/3,pointCurrent.model.controlPointNextX=pointCurrent.model.x+deltaX,pointCurrent.model.controlPointNextY=pointCurrent.model.y+deltaX*pointCurrent.mK))},helpers$1.nextItem=function(collection,index,loop){return loop?index>=collection.length-1?collection[0]:collection[index+1]:index>=collection.length-1?collection[collection.length-1]:collection[index+1]},helpers$1.previousItem=function(collection,index,loop){return loop?index<=0?collection[collection.length-1]:collection[index-1]:index<=0?collection[0]:collection[index-1]},helpers$1.niceNum=function(range,round){var exponent=Math.floor(helpers$1.log10(range)),fraction=range/Math.pow(10,exponent);return(round?fraction<1.5?1:fraction<3?2:fraction<7?5:10:fraction<=1?1:fraction<=2?2:fraction<=5?5:10)*Math.pow(10,exponent)},helpers$1.requestAnimFrame="undefined"==typeof window?function(callback){callback()}:window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(callback){return window.setTimeout(callback,1e3/60)},helpers$1.getRelativePosition=function(evt,chart){var mouseX,mouseY,e=evt.originalEvent||evt,canvas=evt.target||evt.srcElement,boundingRect=canvas.getBoundingClientRect(),touches=e.touches;mouseY=touches&&0<touches.length?(mouseX=touches[0].clientX,touches[0].clientY):(mouseX=e.clientX,e.clientY);var paddingLeft=parseFloat(helpers$1.getStyle(canvas,"padding-left")),paddingTop=parseFloat(helpers$1.getStyle(canvas,"padding-top")),paddingRight=parseFloat(helpers$1.getStyle(canvas,"padding-right")),paddingBottom=parseFloat(helpers$1.getStyle(canvas,"padding-bottom")),width=boundingRect.right-boundingRect.left-paddingLeft-paddingRight,height=boundingRect.bottom-boundingRect.top-paddingTop-paddingBottom;return{x:mouseX=Math.round((mouseX-boundingRect.left-paddingLeft)/width*canvas.width/chart.currentDevicePixelRatio),y:mouseY=Math.round((mouseY-boundingRect.top-paddingTop)/height*canvas.height/chart.currentDevicePixelRatio)}},helpers$1.getConstraintWidth=function(domNode){return getConstraintDimension(domNode,"max-width","clientWidth")},helpers$1.getConstraintHeight=function(domNode){return getConstraintDimension(domNode,"max-height","clientHeight")},helpers$1._calculatePadding=function(container,padding,parentDimension){return-1<(padding=helpers$1.getStyle(container,padding)).indexOf("%")?parentDimension*parseInt(padding,10)/100:parseInt(padding,10)},helpers$1._getParentNode=function(domNode){var parent=domNode.parentNode;return parent&&"[object ShadowRoot]"===parent.toString()&&(parent=parent.host),parent},helpers$1.getMaximumWidth=function(domNode){var container=helpers$1._getParentNode(domNode);if(!container)return domNode.clientWidth;var clientWidth=container.clientWidth,w=clientWidth-helpers$1._calculatePadding(container,"padding-left",clientWidth)-helpers$1._calculatePadding(container,"padding-right",clientWidth),cw=helpers$1.getConstraintWidth(domNode);return isNaN(cw)?w:Math.min(w,cw)},helpers$1.getMaximumHeight=function(domNode){var container=helpers$1._getParentNode(domNode);if(!container)return domNode.clientHeight;var clientHeight=container.clientHeight,h=clientHeight-helpers$1._calculatePadding(container,"padding-top",clientHeight)-helpers$1._calculatePadding(container,"padding-bottom",clientHeight),ch=helpers$1.getConstraintHeight(domNode);return isNaN(ch)?h:Math.min(h,ch)},helpers$1.getStyle=function(el,property){return el.currentStyle?el.currentStyle[property]:document.defaultView.getComputedStyle(el,null).getPropertyValue(property)},helpers$1.retinaScale=function(chart,forceRatio){var pixelRatio=chart.currentDevicePixelRatio=forceRatio||"undefined"!=typeof window&&window.devicePixelRatio||1;if(1!==pixelRatio){var canvas=chart.canvas,height=chart.height,width=chart.width;canvas.height=height*pixelRatio,canvas.width=width*pixelRatio,chart.ctx.scale(pixelRatio,pixelRatio),canvas.style.height||canvas.style.width||(canvas.style.height=height+"px",canvas.style.width=width+"px")}},helpers$1.fontString=function(pixelSize,fontStyle,fontFamily){return fontStyle+" "+pixelSize+"px "+fontFamily},helpers$1.longestText=function(ctx,font,arrayOfThings,cache){var data=(cache=cache||{}).data=cache.data||{},gc=cache.garbageCollect=cache.garbageCollect||[];cache.font!==font&&(data=cache.data={},gc=cache.garbageCollect=[],cache.font=font),ctx.font=font;var i,j,jlen,thing,nestedThing,longest=0,ilen=arrayOfThings.length;for(i=0;i<ilen;i++)if(null!=(thing=arrayOfThings[i])&&!0!==helpers$1.isArray(thing))longest=helpers$1.measureText(ctx,data,gc,longest,thing);else if(helpers$1.isArray(thing))for(j=0,jlen=thing.length;j<jlen;j++)null==(nestedThing=thing[j])||helpers$1.isArray(nestedThing)||(longest=helpers$1.measureText(ctx,data,gc,longest,nestedThing));var gcLen=gc.length/2;if(gcLen>arrayOfThings.length){for(i=0;i<gcLen;i++)delete data[gc[i]];gc.splice(0,gcLen)}return longest},helpers$1.measureText=function(ctx,data,gc,longest,string){var textWidth=data[string];return textWidth||(textWidth=data[string]=ctx.measureText(string).width,gc.push(string)),longest<textWidth&&(longest=textWidth),longest},helpers$1.numberOfLabelLines=function(arrayOfThings){var numberOfLines=1;return helpers$1.each(arrayOfThings,function(thing){helpers$1.isArray(thing)&&thing.length>numberOfLines&&(numberOfLines=thing.length)}),numberOfLines},helpers$1.color=chartjsColor?function(value){return value instanceof CanvasGradient&&(value=core_defaults.global.defaultColor),chartjsColor(value)}:function(value){return console.error("Color.js not found!"),value},helpers$1.getHoverColor=function(colorValue){return colorValue instanceof CanvasPattern||colorValue instanceof CanvasGradient?colorValue:helpers$1.color(colorValue).saturate(.5).darken(.1).rgbString()},core_controller._adapters=core_adapters,core_controller.Animation=core_animation,core_controller.animationService=core_animations,core_controller.controllers=controllers,core_controller.DatasetController=core_datasetController,core_controller.defaults=core_defaults,core_controller.Element=core_element,core_controller.elements=elements,core_controller.Interaction=core_interaction,core_controller.layouts=core_layouts,core_controller.platform=platform,core_controller.plugins=core_plugins,core_controller.Scale=core_scale,core_controller.scaleService=core_scaleService,core_controller.Ticks=core_ticks,core_controller.Tooltip=core_tooltip,core_controller.helpers.each(scales,function(scale,type){core_controller.scaleService.registerScaleType(type,scale,scale._defaults)}),plugins)plugins.hasOwnProperty(k)&&core_controller.plugins.register(plugins[k]);core_controller.platform.initialize();var src=core_controller;return"undefined"!=typeof window&&(window.Chart=core_controller),(core_controller.Chart=core_controller).Legend=plugins.legend._element,core_controller.Title=plugins.title._element,core_controller.pluginService=core_controller.plugins,core_controller.PluginBase=core_controller.Element.extend({}),core_controller.canvasHelpers=core_controller.helpers.canvas,core_controller.layoutService=core_controller.layouts,core_controller.LinearScaleBase=scale_linearbase,core_controller.helpers.each(["Bar","Bubble","Doughnut","Line","PolarArea","Radar","Scatter"],function(klass){core_controller[klass]=function(ctx,cfg){return new core_controller(ctx,core_controller.helpers.merge(cfg||{},{type:klass.charAt(0).toLowerCase()+klass.slice(1)}))}}),src}),function(window,factory){"function"==typeof define&&define.amd?define("jquery-bridget/jquery-bridget",["jquery"],function(jQuery){return factory(window,jQuery)}):"object"==typeof module&&module.exports?module.exports=factory(window,require("jquery")):window.jQueryBridget=factory(window,window.jQuery)}(window,function(window,jQuery){"use strict";var arraySlice=Array.prototype.slice,console=window.console,logError=void 0===console?function(){}:function(message){console.error(message)};function jQueryBridget(namespace,PluginClass,$){($=$||jQuery||window.jQuery)&&(PluginClass.prototype.option||(PluginClass.prototype.option=function(opts){$.isPlainObject(opts)&&(this.options=$.extend(!0,this.options,opts))}),$.fn[namespace]=function(arg0){return"string"==typeof arg0?function($elems,methodName,args){var returnValue,pluginMethodStr="$()."+namespace+'("'+methodName+'")';return $elems.each(function(i,elem){var instance=$.data(elem,namespace);if(instance){var method=instance[methodName];if(method&&"_"!=methodName.charAt(0)){var value=method.apply(instance,args);returnValue=void 0===returnValue?value:returnValue}else logError(pluginMethodStr+" is not a valid method")}else logError(namespace+" not initialized. Cannot call methods, i.e. "+pluginMethodStr)}),void 0!==returnValue?returnValue:$elems}(this,arg0,arraySlice.call(arguments,1)):(function($elems,options){$elems.each(function(i,elem){var instance=$.data(elem,namespace);instance?(instance.option(options),instance._init()):(instance=new PluginClass(elem,options),$.data(elem,namespace,instance))})}(this,arg0),this)},updateJQuery($))}function updateJQuery($){!$||$&&$.bridget||($.bridget=jQueryBridget)}return updateJQuery(jQuery||window.jQuery),jQueryBridget}),function(window,factory){"function"==typeof define&&define.amd?define("get-size/get-size",factory):"object"==typeof module&&module.exports?module.exports=factory():window.getSize=factory()}(window,function(){"use strict";function getStyleSize(value){var num=parseFloat(value);return-1==value.indexOf("%")&&!isNaN(num)&&num}var logError="undefined"==typeof console?function(){}:function(message){console.error(message)},measurements=["paddingLeft","paddingRight","paddingTop","paddingBottom","marginLeft","marginRight","marginTop","marginBottom","borderLeftWidth","borderRightWidth","borderTopWidth","borderBottomWidth"],measurementsLength=measurements.length;function getStyle(elem){var style=getComputedStyle(elem);return style||logError("Style returned "+style+". Are you running this code in a hidden iframe on Firefox? See https://bit.ly/getsizebug1"),style}var isBoxSizeOuter,isSetup=!1;function getSize(elem){if(!function(){if(!isSetup){isSetup=!0;var div=document.createElement("div");div.style.width="200px",div.style.padding="1px 2px 3px 4px",div.style.borderStyle="solid",div.style.borderWidth="1px 2px 3px 4px",div.style.boxSizing="border-box";var body=document.body||document.documentElement;body.appendChild(div);var style=getStyle(div);isBoxSizeOuter=200==Math.round(getStyleSize(style.width)),getSize.isBoxSizeOuter=isBoxSizeOuter,body.removeChild(div)}}(),"string"==typeof elem&&(elem=document.querySelector(elem)),elem&&"object"==typeof elem&&elem.nodeType){var style=getStyle(elem);if("none"==style.display)return function(){for(var size={width:0,height:0,innerWidth:0,innerHeight:0,outerWidth:0,outerHeight:0},i=0;i<measurementsLength;i++){size[measurements[i]]=0}return size}();var size={};size.width=elem.offsetWidth,size.height=elem.offsetHeight;for(var isBorderBox=size.isBorderBox="border-box"==style.boxSizing,i=0;i<measurementsLength;i++){var measurement=measurements[i],value=style[measurement],num=parseFloat(value);size[measurement]=isNaN(num)?0:num}var paddingWidth=size.paddingLeft+size.paddingRight,paddingHeight=size.paddingTop+size.paddingBottom,marginWidth=size.marginLeft+size.marginRight,marginHeight=size.marginTop+size.marginBottom,borderWidth=size.borderLeftWidth+size.borderRightWidth,borderHeight=size.borderTopWidth+size.borderBottomWidth,isBorderBoxSizeOuter=isBorderBox&&isBoxSizeOuter,styleWidth=getStyleSize(style.width);!1!==styleWidth&&(size.width=styleWidth+(isBorderBoxSizeOuter?0:paddingWidth+borderWidth));var styleHeight=getStyleSize(style.height);return!1!==styleHeight&&(size.height=styleHeight+(isBorderBoxSizeOuter?0:paddingHeight+borderHeight)),size.innerWidth=size.width-(paddingWidth+borderWidth),size.innerHeight=size.height-(paddingHeight+borderHeight),size.outerWidth=size.width+marginWidth,size.outerHeight=size.height+marginHeight,size}}return getSize}),function(global,factory){"function"==typeof define&&define.amd?define("ev-emitter/ev-emitter",factory):"object"==typeof module&&module.exports?module.exports=factory():global.EvEmitter=factory()}("undefined"!=typeof window?window:this,function(){function EvEmitter(){}var proto=EvEmitter.prototype;return proto.on=function(eventName,listener){if(eventName&&listener){var events=this._events=this._events||{},listeners=events[eventName]=events[eventName]||[];return-1==listeners.indexOf(listener)&&listeners.push(listener),this}},proto.once=function(eventName,listener){if(eventName&&listener){this.on(eventName,listener);var onceEvents=this._onceEvents=this._onceEvents||{};return(onceEvents[eventName]=onceEvents[eventName]||{})[listener]=!0,this}},proto.off=function(eventName,listener){var listeners=this._events&&this._events[eventName];if(listeners&&listeners.length){var index=listeners.indexOf(listener);return-1!=index&&listeners.splice(index,1),this}},proto.emitEvent=function(eventName,args){var listeners=this._events&&this._events[eventName];if(listeners&&listeners.length){listeners=listeners.slice(0),args=args||[];for(var onceListeners=this._onceEvents&&this._onceEvents[eventName],i=0;i<listeners.length;i++){var listener=listeners[i];onceListeners&&onceListeners[listener]&&(this.off(eventName,listener),delete onceListeners[listener]),listener.apply(this,args)}return this}},proto.allOff=function(){delete this._events,delete this._onceEvents},EvEmitter}),function(window,factory){"use strict";"function"==typeof define&&define.amd?define("desandro-matches-selector/matches-selector",factory):"object"==typeof module&&module.exports?module.exports=factory():window.matchesSelector=factory()}(window,function(){"use strict";var matchesMethod=function(){var ElemProto=window.Element.prototype;if(ElemProto.matches)return"matches";if(ElemProto.matchesSelector)return"matchesSelector";for(var prefixes=["webkit","moz","ms","o"],i=0;i<prefixes.length;i++){var method=prefixes[i]+"MatchesSelector";if(ElemProto[method])return method}}();return function(elem,selector){return elem[matchesMethod](selector)}}),function(window,factory){"function"==typeof define&&define.amd?define("fizzy-ui-utils/utils",["desandro-matches-selector/matches-selector"],function(matchesSelector){return factory(window,matchesSelector)}):"object"==typeof module&&module.exports?module.exports=factory(window,require("desandro-matches-selector")):window.fizzyUIUtils=factory(window,window.matchesSelector)}(window,function(window,matchesSelector){var utils={extend:function(a,b){for(var prop in b)a[prop]=b[prop];return a},modulo:function(num,div){return(num%div+div)%div}},arraySlice=Array.prototype.slice;utils.makeArray=function(obj){return Array.isArray(obj)?obj:null==obj?[]:"object"==typeof obj&&"number"==typeof obj.length?arraySlice.call(obj):[obj]},utils.removeFrom=function(ary,obj){var index=ary.indexOf(obj);-1!=index&&ary.splice(index,1)},utils.getParent=function(elem,selector){for(;elem.parentNode&&elem!=document.body;)if(elem=elem.parentNode,matchesSelector(elem,selector))return elem},utils.getQueryElement=function(elem){return"string"==typeof elem?document.querySelector(elem):elem},utils.handleEvent=function(event){var method="on"+event.type;this[method]&&this[method](event)},utils.filterFindElements=function(elems,selector){elems=utils.makeArray(elems);var ffElems=[];return elems.forEach(function(elem){if(elem instanceof HTMLElement)if(selector){matchesSelector(elem,selector)&&ffElems.push(elem);for(var childElems=elem.querySelectorAll(selector),i=0;i<childElems.length;i++)ffElems.push(childElems[i])}else ffElems.push(elem)}),ffElems},utils.debounceMethod=function(_class,methodName,threshold){threshold=threshold||100;var method=_class.prototype[methodName],timeoutName=methodName+"Timeout";_class.prototype[methodName]=function(){var timeout=this[timeoutName];clearTimeout(timeout);var args=arguments,_this=this;this[timeoutName]=setTimeout(function(){method.apply(_this,args),delete _this[timeoutName]},threshold)}},utils.docReady=function(callback){var readyState=document.readyState;"complete"==readyState||"interactive"==readyState?setTimeout(callback):document.addEventListener("DOMContentLoaded",callback)},utils.toDashed=function(str){return str.replace(/(.)([A-Z])/g,function(match,$1,$2){return $1+"-"+$2}).toLowerCase()};var console=window.console;return utils.htmlInit=function(WidgetClass,namespace){utils.docReady(function(){var dashedNamespace=utils.toDashed(namespace),dataAttr="data-"+dashedNamespace,dataAttrElems=document.querySelectorAll("["+dataAttr+"]"),jsDashElems=document.querySelectorAll(".js-"+dashedNamespace),elems=utils.makeArray(dataAttrElems).concat(utils.makeArray(jsDashElems)),dataOptionsAttr=dataAttr+"-options",jQuery=window.jQuery;elems.forEach(function(elem){var options,attr=elem.getAttribute(dataAttr)||elem.getAttribute(dataOptionsAttr);try{options=attr&&JSON.parse(attr)}catch(error){return void(console&&console.error("Error parsing "+dataAttr+" on "+elem.className+": "+error))}var instance=new WidgetClass(elem,options);jQuery&&jQuery.data(elem,namespace,instance)})})},utils}),function(window,factory){"function"==typeof define&&define.amd?define("outlayer/item",["ev-emitter/ev-emitter","get-size/get-size"],factory):"object"==typeof module&&module.exports?module.exports=factory(require("ev-emitter"),require("get-size")):(window.Outlayer={},window.Outlayer.Item=factory(window.EvEmitter,window.getSize))}(window,function(EvEmitter,getSize){"use strict";var docElemStyle=document.documentElement.style,transitionProperty="string"==typeof docElemStyle.transition?"transition":"WebkitTransition",transformProperty="string"==typeof docElemStyle.transform?"transform":"WebkitTransform",transitionEndEvent={WebkitTransition:"webkitTransitionEnd",transition:"transitionend"}[transitionProperty],vendorProperties={transform:transformProperty,transition:transitionProperty,transitionDuration:transitionProperty+"Duration",transitionProperty:transitionProperty+"Property",transitionDelay:transitionProperty+"Delay"};function Item(element,layout){element&&(this.element=element,this.layout=layout,this.position={x:0,y:0},this._create())}var proto=Item.prototype=Object.create(EvEmitter.prototype);proto.constructor=Item,proto._create=function(){this._transn={ingProperties:{},clean:{},onEnd:{}},this.css({position:"absolute"})},proto.handleEvent=function(event){var method="on"+event.type;this[method]&&this[method](event)},proto.getSize=function(){this.size=getSize(this.element)},proto.css=function(style){var elemStyle=this.element.style;for(var prop in style){elemStyle[vendorProperties[prop]||prop]=style[prop]}},proto.getPosition=function(){var style=getComputedStyle(this.element),isOriginLeft=this.layout._getOption("originLeft"),isOriginTop=this.layout._getOption("originTop"),xValue=style[isOriginLeft?"left":"right"],yValue=style[isOriginTop?"top":"bottom"],x=parseFloat(xValue),y=parseFloat(yValue),layoutSize=this.layout.size;-1!=xValue.indexOf("%")&&(x=x/100*layoutSize.width),-1!=yValue.indexOf("%")&&(y=y/100*layoutSize.height),x=isNaN(x)?0:x,y=isNaN(y)?0:y,x-=isOriginLeft?layoutSize.paddingLeft:layoutSize.paddingRight,y-=isOriginTop?layoutSize.paddingTop:layoutSize.paddingBottom,this.position.x=x,this.position.y=y},proto.layoutPosition=function(){var layoutSize=this.layout.size,style={},isOriginLeft=this.layout._getOption("originLeft"),isOriginTop=this.layout._getOption("originTop"),xPadding=isOriginLeft?"paddingLeft":"paddingRight",xProperty=isOriginLeft?"left":"right",xResetProperty=isOriginLeft?"right":"left",x=this.position.x+layoutSize[xPadding];style[xProperty]=this.getXValue(x),style[xResetProperty]="";var yPadding=isOriginTop?"paddingTop":"paddingBottom",yProperty=isOriginTop?"top":"bottom",yResetProperty=isOriginTop?"bottom":"top",y=this.position.y+layoutSize[yPadding];style[yProperty]=this.getYValue(y),style[yResetProperty]="",this.css(style),this.emitEvent("layout",[this])},proto.getXValue=function(x){var isHorizontal=this.layout._getOption("horizontal");return this.layout.options.percentPosition&&!isHorizontal?x/this.layout.size.width*100+"%":x+"px"},proto.getYValue=function(y){var isHorizontal=this.layout._getOption("horizontal");return this.layout.options.percentPosition&&isHorizontal?y/this.layout.size.height*100+"%":y+"px"},proto._transitionTo=function(x,y){this.getPosition();var curX=this.position.x,curY=this.position.y,didNotMove=x==this.position.x&&y==this.position.y;if(this.setPosition(x,y),!didNotMove||this.isTransitioning){var transX=x-curX,transY=y-curY,transitionStyle={};transitionStyle.transform=this.getTranslate(transX,transY),this.transition({to:transitionStyle,onTransitionEnd:{transform:this.layoutPosition},isCleaning:!0})}else this.layoutPosition()},proto.getTranslate=function(x,y){return"translate3d("+(x=this.layout._getOption("originLeft")?x:-x)+"px, "+(y=this.layout._getOption("originTop")?y:-y)+"px, 0)"},proto.goTo=function(x,y){this.setPosition(x,y),this.layoutPosition()},proto.moveTo=proto._transitionTo,proto.setPosition=function(x,y){this.position.x=parseFloat(x),this.position.y=parseFloat(y)},proto._nonTransition=function(args){for(var prop in this.css(args.to),args.isCleaning&&this._removeStyles(args.to),args.onTransitionEnd)args.onTransitionEnd[prop].call(this)},proto.transition=function(args){if(parseFloat(this.layout.options.transitionDuration)){var _transition=this._transn;for(var prop in args.onTransitionEnd)_transition.onEnd[prop]=args.onTransitionEnd[prop];for(prop in args.to)_transition.ingProperties[prop]=!0,args.isCleaning&&(_transition.clean[prop]=!0);if(args.from){this.css(args.from);this.element.offsetHeight;null}this.enableTransition(args.to),this.css(args.to),this.isTransitioning=!0}else this._nonTransition(args)};var transitionProps="opacity,"+transformProperty.replace(/([A-Z])/g,function($1){return"-"+$1.toLowerCase()});proto.enableTransition=function(){if(!this.isTransitioning){var duration=this.layout.options.transitionDuration;duration="number"==typeof duration?duration+"ms":duration,this.css({transitionProperty:transitionProps,transitionDuration:duration,transitionDelay:this.staggerDelay||0}),this.element.addEventListener(transitionEndEvent,this,!1)}},proto.onwebkitTransitionEnd=function(event){this.ontransitionend(event)},proto.onotransitionend=function(event){this.ontransitionend(event)};var dashedVendorProperties={"-webkit-transform":"transform"};proto.ontransitionend=function(event){if(event.target===this.element){var _transition=this._transn,propertyName=dashedVendorProperties[event.propertyName]||event.propertyName;if(delete _transition.ingProperties[propertyName],function(obj){for(var prop in obj)return!1;return!null}(_transition.ingProperties)&&this.disableTransition(),propertyName in _transition.clean&&(this.element.style[event.propertyName]="",delete _transition.clean[propertyName]),propertyName in _transition.onEnd)_transition.onEnd[propertyName].call(this),delete _transition.onEnd[propertyName];this.emitEvent("transitionEnd",[this])}},proto.disableTransition=function(){this.removeTransitionStyles(),this.element.removeEventListener(transitionEndEvent,this,!1),this.isTransitioning=!1},proto._removeStyles=function(style){var cleanStyle={};for(var prop in style)cleanStyle[prop]="";this.css(cleanStyle)};var cleanTransitionStyle={transitionProperty:"",transitionDuration:"",transitionDelay:""};return proto.removeTransitionStyles=function(){this.css(cleanTransitionStyle)},proto.stagger=function(delay){delay=isNaN(delay)?0:delay,this.staggerDelay=delay+"ms"},proto.removeElem=function(){this.element.parentNode.removeChild(this.element),this.css({display:""}),this.emitEvent("remove",[this])},proto.remove=function(){transitionProperty&&parseFloat(this.layout.options.transitionDuration)?(this.once("transitionEnd",function(){this.removeElem()}),this.hide()):this.removeElem()},proto.reveal=function(){delete this.isHidden,this.css({display:""});var options=this.layout.options,onTransitionEnd={};onTransitionEnd[this.getHideRevealTransitionEndProperty("visibleStyle")]=this.onRevealTransitionEnd,this.transition({from:options.hiddenStyle,to:options.visibleStyle,isCleaning:!0,onTransitionEnd:onTransitionEnd})},proto.onRevealTransitionEnd=function(){this.isHidden||this.emitEvent("reveal")},proto.getHideRevealTransitionEndProperty=function(styleProperty){var optionStyle=this.layout.options[styleProperty];if(optionStyle.opacity)return"opacity";for(var prop in optionStyle)return prop},proto.hide=function(){this.isHidden=!0,this.css({display:""});var options=this.layout.options,onTransitionEnd={};onTransitionEnd[this.getHideRevealTransitionEndProperty("hiddenStyle")]=this.onHideTransitionEnd,this.transition({from:options.visibleStyle,to:options.hiddenStyle,isCleaning:!0,onTransitionEnd:onTransitionEnd})},proto.onHideTransitionEnd=function(){this.isHidden&&(this.css({display:"none"}),this.emitEvent("hide"))},proto.destroy=function(){this.css({position:"",left:"",right:"",top:"",bottom:"",transition:"",transform:""})},Item}),function(window,factory){"use strict";"function"==typeof define&&define.amd?define("outlayer/outlayer",["ev-emitter/ev-emitter","get-size/get-size","fizzy-ui-utils/utils","./item"],function(EvEmitter,getSize,utils,Item){return factory(window,EvEmitter,getSize,utils,Item)}):"object"==typeof module&&module.exports?module.exports=factory(window,require("ev-emitter"),require("get-size"),require("fizzy-ui-utils"),require("./item")):window.Outlayer=factory(window,window.EvEmitter,window.getSize,window.fizzyUIUtils,window.Outlayer.Item)}(window,function(window,EvEmitter,getSize,utils,Item){"use strict";function noop(){}var console=window.console,jQuery=window.jQuery,GUID=0,instances={};function Outlayer(element,options){var queryElement=utils.getQueryElement(element);if(queryElement){this.element=queryElement,jQuery&&(this.$element=jQuery(this.element)),this.options=utils.extend({},this.constructor.defaults),this.option(options);var id=++GUID;this.element.outlayerGUID=id,(instances[id]=this)._create(),this._getOption("initLayout")&&this.layout()}else console&&console.error("Bad element for "+this.constructor.namespace+": "+(queryElement||element))}Outlayer.namespace="outlayer",Outlayer.Item=Item,Outlayer.defaults={containerStyle:{position:"relative"},initLayout:!0,originLeft:!0,originTop:!0,resize:!0,resizeContainer:!0,transitionDuration:"0.4s",hiddenStyle:{opacity:0,transform:"scale(0.001)"},visibleStyle:{opacity:1,transform:"scale(1)"}};var proto=Outlayer.prototype;function subclass(Parent){function SubClass(){Parent.apply(this,arguments)}return(SubClass.prototype=Object.create(Parent.prototype)).constructor=SubClass}utils.extend(proto,EvEmitter.prototype),proto.option=function(opts){utils.extend(this.options,opts)},proto._getOption=function(option){var oldOption=this.constructor.compatOptions[option];return oldOption&&void 0!==this.options[oldOption]?this.options[oldOption]:this.options[option]},Outlayer.compatOptions={initLayout:"isInitLayout",horizontal:"isHorizontal",layoutInstant:"isLayoutInstant",originLeft:"isOriginLeft",originTop:"isOriginTop",resize:"isResizeBound",resizeContainer:"isResizingContainer"},proto._create=function(){this.reloadItems(),this.stamps=[],this.stamp(this.options.stamp),utils.extend(this.element.style,this.options.containerStyle),this._getOption("resize")&&this.bindResize()},proto.reloadItems=function(){this.items=this._itemize(this.element.children)},proto._itemize=function(elems){for(var itemElems=this._filterFindItemElements(elems),Item=this.constructor.Item,items=[],i=0;i<itemElems.length;i++){var item=new Item(itemElems[i],this);items.push(item)}return items},proto._filterFindItemElements=function(elems){return utils.filterFindElements(elems,this.options.itemSelector)},proto.getItemElements=function(){return this.items.map(function(item){return item.element})},proto.layout=function(){this._resetLayout(),this._manageStamps();var layoutInstant=this._getOption("layoutInstant"),isInstant=void 0!==layoutInstant?layoutInstant:!this._isLayoutInited;this.layoutItems(this.items,isInstant),this._isLayoutInited=!0},proto._init=proto.layout,proto._resetLayout=function(){this.getSize()},proto.getSize=function(){this.size=getSize(this.element)},proto._getMeasurement=function(measurement,size){var elem,option=this.options[measurement];option?("string"==typeof option?elem=this.element.querySelector(option):option instanceof HTMLElement&&(elem=option),this[measurement]=elem?getSize(elem)[size]:option):this[measurement]=0},proto.layoutItems=function(items,isInstant){items=this._getItemsForLayout(items),this._layoutItems(items,isInstant),this._postLayout()},proto._getItemsForLayout=function(items){return items.filter(function(item){return!item.isIgnored})},proto._layoutItems=function(items,isInstant){if(this._emitCompleteOnItems("layout",items),items&&items.length){var queue=[];items.forEach(function(item){var position=this._getItemLayoutPosition(item);position.item=item,position.isInstant=isInstant||item.isLayoutInstant,queue.push(position)},this),this._processLayoutQueue(queue)}},proto._getItemLayoutPosition=function(){return{x:0,y:0}},proto._processLayoutQueue=function(queue){this.updateStagger(),queue.forEach(function(obj,i){this._positionItem(obj.item,obj.x,obj.y,obj.isInstant,i)},this)},proto.updateStagger=function(){var stagger=this.options.stagger;if(null!=stagger)return this.stagger=function(time){if("number"==typeof time)return time;var matches=time.match(/(^\d*\.?\d*)(\w*)/),num=matches&&matches[1],unit=matches&&matches[2];if(!num.length)return 0;num=parseFloat(num);var mult=msUnits[unit]||1;return num*mult}(stagger),this.stagger;this.stagger=0},proto._positionItem=function(item,x,y,isInstant,i){isInstant?item.goTo(x,y):(item.stagger(i*this.stagger),item.moveTo(x,y))},proto._postLayout=function(){this.resizeContainer()},proto.resizeContainer=function(){if(this._getOption("resizeContainer")){var size=this._getContainerSize();size&&(this._setContainerMeasure(size.width,!0),this._setContainerMeasure(size.height,!1))}},proto._getContainerSize=noop,proto._setContainerMeasure=function(measure,isWidth){if(void 0!==measure){var elemSize=this.size;elemSize.isBorderBox&&(measure+=isWidth?elemSize.paddingLeft+elemSize.paddingRight+elemSize.borderLeftWidth+elemSize.borderRightWidth:elemSize.paddingBottom+elemSize.paddingTop+elemSize.borderTopWidth+elemSize.borderBottomWidth),measure=Math.max(measure,0),this.element.style[isWidth?"width":"height"]=measure+"px"}},proto._emitCompleteOnItems=function(eventName,items){var _this=this;function onComplete(){_this.dispatchEvent(eventName+"Complete",null,[items])}var count=items.length;if(items&&count){var doneCount=0;items.forEach(function(item){item.once(eventName,tick)})}else onComplete();function tick(){++doneCount==count&&onComplete()}},proto.dispatchEvent=function(type,event,args){var emitArgs=event?[event].concat(args):args;if(this.emitEvent(type,emitArgs),jQuery)if(this.$element=this.$element||jQuery(this.element),event){var $event=jQuery.Event(event);$event.type=type,this.$element.trigger($event,args)}else this.$element.trigger(type,args)},proto.ignore=function(elem){var item=this.getItem(elem);item&&(item.isIgnored=!0)},proto.unignore=function(elem){var item=this.getItem(elem);item&&delete item.isIgnored},proto.stamp=function(elems){(elems=this._find(elems))&&(this.stamps=this.stamps.concat(elems),elems.forEach(this.ignore,this))},proto.unstamp=function(elems){(elems=this._find(elems))&&elems.forEach(function(elem){utils.removeFrom(this.stamps,elem),this.unignore(elem)},this)},proto._find=function(elems){if(elems)return"string"==typeof elems&&(elems=this.element.querySelectorAll(elems)),elems=utils.makeArray(elems)},proto._manageStamps=function(){this.stamps&&this.stamps.length&&(this._getBoundingRect(),this.stamps.forEach(this._manageStamp,this))},proto._getBoundingRect=function(){var boundingRect=this.element.getBoundingClientRect(),size=this.size;this._boundingRect={left:boundingRect.left+size.paddingLeft+size.borderLeftWidth,top:boundingRect.top+size.paddingTop+size.borderTopWidth,right:boundingRect.right-(size.paddingRight+size.borderRightWidth),bottom:boundingRect.bottom-(size.paddingBottom+size.borderBottomWidth)}},proto._manageStamp=noop,proto._getElementOffset=function(elem){var boundingRect=elem.getBoundingClientRect(),thisRect=this._boundingRect,size=getSize(elem);return{left:boundingRect.left-thisRect.left-size.marginLeft,top:boundingRect.top-thisRect.top-size.marginTop,right:thisRect.right-boundingRect.right-size.marginRight,bottom:thisRect.bottom-boundingRect.bottom-size.marginBottom}},proto.handleEvent=utils.handleEvent,proto.bindResize=function(){window.addEventListener("resize",this),this.isResizeBound=!0},proto.unbindResize=function(){window.removeEventListener("resize",this),this.isResizeBound=!1},proto.onresize=function(){this.resize()},utils.debounceMethod(Outlayer,"onresize",100),proto.resize=function(){this.isResizeBound&&this.needsResizeLayout()&&this.layout()},proto.needsResizeLayout=function(){var size=getSize(this.element);return this.size&&size&&size.innerWidth!==this.size.innerWidth},proto.addItems=function(elems){var items=this._itemize(elems);return items.length&&(this.items=this.items.concat(items)),items},proto.appended=function(elems){var items=this.addItems(elems);items.length&&(this.layoutItems(items,!0),this.reveal(items))},proto.prepended=function(elems){var items=this._itemize(elems);if(items.length){var previousItems=this.items.slice(0);this.items=items.concat(previousItems),this._resetLayout(),this._manageStamps(),this.layoutItems(items,!0),this.reveal(items),this.layoutItems(previousItems)}},proto.reveal=function(items){if(this._emitCompleteOnItems("reveal",items),items&&items.length){var stagger=this.updateStagger();items.forEach(function(item,i){item.stagger(i*stagger),item.reveal()})}},proto.hide=function(items){if(this._emitCompleteOnItems("hide",items),items&&items.length){var stagger=this.updateStagger();items.forEach(function(item,i){item.stagger(i*stagger),item.hide()})}},proto.revealItemElements=function(elems){var items=this.getItems(elems);this.reveal(items)},proto.hideItemElements=function(elems){var items=this.getItems(elems);this.hide(items)},proto.getItem=function(elem){for(var i=0;i<this.items.length;i++){var item=this.items[i];if(item.element==elem)return item}},proto.getItems=function(elems){elems=utils.makeArray(elems);var items=[];return elems.forEach(function(elem){var item=this.getItem(elem);item&&items.push(item)},this),items},proto.remove=function(elems){var removeItems=this.getItems(elems);this._emitCompleteOnItems("remove",removeItems),removeItems&&removeItems.length&&removeItems.forEach(function(item){item.remove(),utils.removeFrom(this.items,item)},this)},proto.destroy=function(){var style=this.element.style;style.height="",style.position="",style.width="",this.items.forEach(function(item){item.destroy()}),this.unbindResize();var id=this.element.outlayerGUID;delete instances[id],delete this.element.outlayerGUID,jQuery&&jQuery.removeData(this.element,this.constructor.namespace)},Outlayer.data=function(elem){var id=(elem=utils.getQueryElement(elem))&&elem.outlayerGUID;return id&&instances[id]},Outlayer.create=function(namespace,options){var Layout=subclass(Outlayer);return Layout.defaults=utils.extend({},Outlayer.defaults),utils.extend(Layout.defaults,options),Layout.compatOptions=utils.extend({},Outlayer.compatOptions),Layout.namespace=namespace,Layout.data=Outlayer.data,Layout.Item=subclass(Item),utils.htmlInit(Layout,namespace),jQuery&&jQuery.bridget&&jQuery.bridget(namespace,Layout),Layout};var msUnits={ms:1,s:1e3};return Outlayer.Item=Item,Outlayer}),function(window,factory){"function"==typeof define&&define.amd?define("packery/js/rect",factory):"object"==typeof module&&module.exports?module.exports=factory():(window.Packery=window.Packery||{},window.Packery.Rect=factory())}(window,function(){"use strict";function Rect(props){for(var prop in Rect.defaults)this[prop]=Rect.defaults[prop];for(prop in props)this[prop]=props[prop]}Rect.defaults={x:0,y:0,width:0,height:0};var proto=Rect.prototype;return proto.contains=function(rect){var otherWidth=rect.width||0,otherHeight=rect.height||0;return this.x<=rect.x&&this.y<=rect.y&&this.x+this.width>=rect.x+otherWidth&&this.y+this.height>=rect.y+otherHeight},proto.overlaps=function(rect){var thisRight=this.x+this.width,thisBottom=this.y+this.height,rectRight=rect.x+rect.width,rectBottom=rect.y+rect.height;return this.x<rectRight&&thisRight>rect.x&&this.y<rectBottom&&thisBottom>rect.y},proto.getMaximalFreeRects=function(rect){if(!this.overlaps(rect))return!1;var freeRect,freeRects=[],thisRight=this.x+this.width,thisBottom=this.y+this.height,rectRight=rect.x+rect.width,rectBottom=rect.y+rect.height;return this.y<rect.y&&(freeRect=new Rect({x:this.x,y:this.y,width:this.width,height:rect.y-this.y}),freeRects.push(freeRect)),rectRight<thisRight&&(freeRect=new Rect({x:rectRight,y:this.y,width:thisRight-rectRight,height:this.height}),freeRects.push(freeRect)),rectBottom<thisBottom&&(freeRect=new Rect({x:this.x,y:rectBottom,width:this.width,height:thisBottom-rectBottom}),freeRects.push(freeRect)),this.x<rect.x&&(freeRect=new Rect({x:this.x,y:this.y,width:rect.x-this.x,height:this.height}),freeRects.push(freeRect)),freeRects},proto.canFit=function(rect){return this.width>=rect.width&&this.height>=rect.height},Rect}),function(window,factory){if("function"==typeof define&&define.amd)define("packery/js/packer",["./rect"],factory);else if("object"==typeof module&&module.exports)module.exports=factory(require("./rect"));else{var Packery=window.Packery=window.Packery||{};Packery.Packer=factory(Packery.Rect)}}(window,function(Rect){"use strict";function Packer(width,height,sortDirection){this.width=width||0,this.height=height||0,this.sortDirection=sortDirection||"downwardLeftToRight",this.reset()}var proto=Packer.prototype;proto.reset=function(){this.spaces=[];var initialSpace=new Rect({x:0,y:0,width:this.width,height:this.height});this.spaces.push(initialSpace),this.sorter=sorters[this.sortDirection]||sorters.downwardLeftToRight},proto.pack=function(rect){for(var i=0;i<this.spaces.length;i++){var space=this.spaces[i];if(space.canFit(rect)){this.placeInSpace(rect,space);break}}},proto.columnPack=function(rect){for(var i=0;i<this.spaces.length;i++){var space=this.spaces[i];if(space.x<=rect.x&&space.x+space.width>=rect.x+rect.width&&space.height>=rect.height-.01){rect.y=space.y,this.placed(rect);break}}},proto.rowPack=function(rect){for(var i=0;i<this.spaces.length;i++){var space=this.spaces[i];if(space.y<=rect.y&&space.y+space.height>=rect.y+rect.height&&space.width>=rect.width-.01){rect.x=space.x,this.placed(rect);break}}},proto.placeInSpace=function(rect,space){rect.x=space.x,rect.y=space.y,this.placed(rect)},proto.placed=function(rect){for(var revisedSpaces=[],i=0;i<this.spaces.length;i++){var space=this.spaces[i],newSpaces=space.getMaximalFreeRects(rect);newSpaces?revisedSpaces.push.apply(revisedSpaces,newSpaces):revisedSpaces.push(space)}this.spaces=revisedSpaces,this.mergeSortSpaces()},proto.mergeSortSpaces=function(){Packer.mergeRects(this.spaces),this.spaces.sort(this.sorter)},proto.addSpace=function(rect){this.spaces.push(rect),this.mergeSortSpaces()},Packer.mergeRects=function(rects){var i=0,rect=rects[i];rectLoop:for(;rect;){for(var j=0,compareRect=rects[i+j];compareRect;){if(compareRect==rect)j++;else{if(compareRect.contains(rect)){rects.splice(i,1),rect=rects[i];continue rectLoop}rect.contains(compareRect)?rects.splice(i+j,1):j++}compareRect=rects[i+j]}rect=rects[++i]}return rects};var sorters={downwardLeftToRight:function(a,b){return a.y-b.y||a.x-b.x},rightwardTopToBottom:function(a,b){return a.x-b.x||a.y-b.y}};return Packer}),function(window,factory){"function"==typeof define&&define.amd?define("packery/js/item",["outlayer/outlayer","./rect"],factory):"object"==typeof module&&module.exports?module.exports=factory(require("outlayer"),require("./rect")):window.Packery.Item=factory(window.Outlayer,window.Packery.Rect)}(window,function(Outlayer,Rect){"use strict";function Item(){Outlayer.Item.apply(this,arguments)}var transformProperty="string"==typeof document.documentElement.style.transform?"transform":"WebkitTransform",proto=Item.prototype=Object.create(Outlayer.Item.prototype),__create=proto._create;proto._create=function(){__create.call(this),this.rect=new Rect};var _moveTo=proto.moveTo;return proto.moveTo=function(x,y){var dx=Math.abs(this.position.x-x),dy=Math.abs(this.position.y-y);this.layout.dragItemCount&&!this.isPlacing&&!this.isTransitioning&&dx<1&&dy<1?this.goTo(x,y):_moveTo.apply(this,arguments)},proto.enablePlacing=function(){this.removeTransitionStyles(),this.isTransitioning&&transformProperty&&(this.element.style[transformProperty]="none"),this.isTransitioning=!1,this.getSize(),this.layout._setRectSize(this.element,this.rect),this.isPlacing=!0},proto.disablePlacing=function(){this.isPlacing=!1},proto.removeElem=function(){var parent=this.element.parentNode;parent&&parent.removeChild(this.element),this.layout.packer.addSpace(this.rect),this.emitEvent("remove",[this])},proto.showDropPlaceholder=function(){var dropPlaceholder=this.dropPlaceholder;dropPlaceholder||((dropPlaceholder=this.dropPlaceholder=document.createElement("div")).className="packery-drop-placeholder",dropPlaceholder.style.position="absolute"),dropPlaceholder.style.width=this.size.width+"px",dropPlaceholder.style.height=this.size.height+"px",this.positionDropPlaceholder(),this.layout.element.appendChild(dropPlaceholder)},proto.positionDropPlaceholder=function(){this.dropPlaceholder.style[transformProperty]="translate("+this.rect.x+"px, "+this.rect.y+"px)"},proto.hideDropPlaceholder=function(){var parent=this.dropPlaceholder.parentNode;parent&&parent.removeChild(this.dropPlaceholder)},Item}),function(window,factory){"function"==typeof define&&define.amd?define(["get-size/get-size","outlayer/outlayer","packery/js/rect","packery/js/packer","packery/js/item"],factory):"object"==typeof module&&module.exports?module.exports=factory(require("get-size"),require("outlayer"),require("./rect"),require("./packer"),require("./item")):window.Packery=factory(window.getSize,window.Outlayer,window.Packery.Rect,window.Packery.Packer,window.Packery.Item)}(window,function(getSize,Outlayer,Rect,Packer,Item){"use strict";Rect.prototype.canFit=function(rect){return this.width>=rect.width-1&&this.height>=rect.height-1};var Packery=Outlayer.create("packery");Packery.Item=Item;var proto=Packery.prototype;function verticalSorter(a,b){return a.position.y-b.position.y||a.position.x-b.position.x}function horizontalSorter(a,b){return a.position.x-b.position.x||a.position.y-b.position.y}proto._create=function(){Outlayer.prototype._create.call(this),this.packer=new Packer,this.shiftPacker=new Packer,this.isEnabled=!0,this.dragItemCount=0;var _this=this;this.handleDraggabilly={dragStart:function(){_this.itemDragStart(this.element)},dragMove:function(){_this.itemDragMove(this.element,this.position.x,this.position.y)},dragEnd:function(){_this.itemDragEnd(this.element)}},this.handleUIDraggable={start:function(event,ui){ui&&_this.itemDragStart(event.currentTarget)},drag:function(event,ui){ui&&_this.itemDragMove(event.currentTarget,ui.position.left,ui.position.top)},stop:function(event,ui){ui&&_this.itemDragEnd(event.currentTarget)}}},proto._resetLayout=function(){var width,height,sortDirection;this.getSize(),this._getMeasurements(),sortDirection=this._getOption("horizontal")?(width=1/0,height=this.size.innerHeight+this.gutter,"rightwardTopToBottom"):(width=this.size.innerWidth+this.gutter,height=1/0,"downwardLeftToRight"),this.packer.width=this.shiftPacker.width=width,this.packer.height=this.shiftPacker.height=height,this.packer.sortDirection=this.shiftPacker.sortDirection=sortDirection,this.packer.reset(),this.maxY=0,this.maxX=0},proto._getMeasurements=function(){this._getMeasurement("columnWidth","width"),this._getMeasurement("rowHeight","height"),this._getMeasurement("gutter","width")},proto._getItemLayoutPosition=function(item){if(this._setRectSize(item.element,item.rect),this.isShifting||0<this.dragItemCount){var packMethod=this._getPackMethod();this.packer[packMethod](item.rect)}else this.packer.pack(item.rect);return this._setMaxXY(item.rect),item.rect},proto.shiftLayout=function(){this.isShifting=!0,this.layout(),delete this.isShifting},proto._getPackMethod=function(){return this._getOption("horizontal")?"rowPack":"columnPack"},proto._setMaxXY=function(rect){this.maxX=Math.max(rect.x+rect.width,this.maxX),this.maxY=Math.max(rect.y+rect.height,this.maxY)},proto._setRectSize=function(elem,rect){var size=getSize(elem),w=size.outerWidth,h=size.outerHeight;(w||h)&&(w=this._applyGridGutter(w,this.columnWidth),h=this._applyGridGutter(h,this.rowHeight)),rect.width=Math.min(w,this.packer.width),rect.height=Math.min(h,this.packer.height)},proto._applyGridGutter=function(measurement,gridSize){if(!gridSize)return measurement+this.gutter;var remainder=measurement%(gridSize+=this.gutter);return measurement=Math[remainder&&remainder<1?"round":"ceil"](measurement/gridSize)*gridSize},proto._getContainerSize=function(){return this._getOption("horizontal")?{width:this.maxX-this.gutter}:{height:this.maxY-this.gutter}},proto._manageStamp=function(elem){var rect,item=this.getItem(elem);if(item&&item.isPlacing)rect=item.rect;else{var offset=this._getElementOffset(elem);rect=new Rect({x:this._getOption("originLeft")?offset.left:offset.right,y:this._getOption("originTop")?offset.top:offset.bottom})}this._setRectSize(elem,rect),this.packer.placed(rect),this._setMaxXY(rect)},proto.sortItemsByPosition=function(){var sorter=this._getOption("horizontal")?horizontalSorter:verticalSorter;this.items.sort(sorter)},proto.fit=function(elem,x,y){var item=this.getItem(elem);item&&(this.stamp(item.element),item.enablePlacing(),this.updateShiftTargets(item),x=void 0===x?item.rect.x:x,y=void 0===y?item.rect.y:y,this.shift(item,x,y),this._bindFitEvents(item),item.moveTo(item.rect.x,item.rect.y),this.shiftLayout(),this.unstamp(item.element),this.sortItemsByPosition(),item.disablePlacing())},proto._bindFitEvents=function(item){var _this=this,ticks=0;function onLayout(){2==++ticks&&_this.dispatchEvent("fitComplete",null,[item])}item.once("layout",onLayout),this.once("layoutComplete",onLayout)},proto.resize=function(){this.isResizeBound&&this.needsResizeLayout()&&(this.options.shiftPercentResize?this.resizeShiftPercentLayout():this.layout())},proto.needsResizeLayout=function(){var size=getSize(this.element),innerSize=this._getOption("horizontal")?"innerHeight":"innerWidth";return size[innerSize]!=this.size[innerSize]},proto.resizeShiftPercentLayout=function(){var items=this._getItemsForLayout(this.items),isHorizontal=this._getOption("horizontal"),coord=isHorizontal?"y":"x",measure=isHorizontal?"height":"width",segmentName=isHorizontal?"rowHeight":"columnWidth",innerSize=isHorizontal?"innerHeight":"innerWidth",previousSegment=this[segmentName];if(previousSegment=previousSegment&&previousSegment+this.gutter){this._getMeasurements();var currentSegment=this[segmentName]+this.gutter;items.forEach(function(item){var seg=Math.round(item.rect[coord]/previousSegment);item.rect[coord]=seg*currentSegment})}else{var currentSize=getSize(this.element)[innerSize]+this.gutter,previousSize=this.packer[measure];items.forEach(function(item){item.rect[coord]=item.rect[coord]/previousSize*currentSize})}this.shiftLayout()},proto.itemDragStart=function(elem){if(this.isEnabled){this.stamp(elem);var item=this.getItem(elem);item&&(item.enablePlacing(),item.showDropPlaceholder(),this.dragItemCount++,this.updateShiftTargets(item))}},proto.updateShiftTargets=function(dropItem){this.shiftPacker.reset(),this._getBoundingRect();var isOriginLeft=this._getOption("originLeft"),isOriginTop=this._getOption("originTop");this.stamps.forEach(function(stamp){var item=this.getItem(stamp);if(!item||!item.isPlacing){var offset=this._getElementOffset(stamp),rect=new Rect({x:isOriginLeft?offset.left:offset.right,y:isOriginTop?offset.top:offset.bottom});this._setRectSize(stamp,rect),this.shiftPacker.placed(rect)}},this);var boundsSize,isHorizontal=this._getOption("horizontal"),segmentName=isHorizontal?"rowHeight":"columnWidth",measure=isHorizontal?"height":"width";this.shiftTargetKeys=[],this.shiftTargets=[];var segment=this[segmentName];if(segment=segment&&segment+this.gutter){var segmentSpan=Math.ceil(dropItem.rect[measure]/segment),segs=Math.floor((this.shiftPacker[measure]+this.gutter)/segment);boundsSize=(segs-segmentSpan)*segment;for(var i=0;i<segs;i++){var initialX=isHorizontal?0:i*segment,initialY=isHorizontal?i*segment:0;this._addShiftTarget(initialX,initialY,boundsSize)}}else boundsSize=this.shiftPacker[measure]+this.gutter-dropItem.rect[measure],this._addShiftTarget(0,0,boundsSize);var items=this._getItemsForLayout(this.items),packMethod=this._getPackMethod();items.forEach(function(item){var rect=item.rect;this._setRectSize(item.element,rect),this.shiftPacker[packMethod](rect),this._addShiftTarget(rect.x,rect.y,boundsSize);var cornerX=isHorizontal?rect.x+rect.width:rect.x,cornerY=isHorizontal?rect.y:rect.y+rect.height;if(this._addShiftTarget(cornerX,cornerY,boundsSize),segment)for(var segSpan=Math.round(rect[measure]/segment),i=1;i<segSpan;i++){var segX=isHorizontal?cornerX:rect.x+segment*i,segY=isHorizontal?rect.y+segment*i:cornerY;this._addShiftTarget(segX,segY,boundsSize)}},this)},proto._addShiftTarget=function(x,y,boundsSize){var checkCoord=this._getOption("horizontal")?y:x;if(!(0!==checkCoord&&boundsSize<checkCoord)){var key=x+","+y;-1!=this.shiftTargetKeys.indexOf(key)||(this.shiftTargetKeys.push(key),this.shiftTargets.push({x:x,y:y}))}},proto.shift=function(item,x,y){var shiftPosition,minDistance=1/0,position={x:x,y:y};this.shiftTargets.forEach(function(target){var distance=function(a,b){var dx=b.x-a.x,dy=b.y-a.y;return Math.sqrt(dx*dx+dy*dy)}(target,position);distance<minDistance&&(shiftPosition=target,minDistance=distance)}),item.rect.x=shiftPosition.x,item.rect.y=shiftPosition.y};proto.itemDragMove=function(elem,x,y){var item=this.isEnabled&&this.getItem(elem);if(item){x-=this.size.paddingLeft,y-=this.size.paddingTop;var _this=this,now=new Date;this._itemDragTime&&now-this._itemDragTime<120?(clearTimeout(this.dragTimeout),this.dragTimeout=setTimeout(onDrag,120)):(onDrag(),this._itemDragTime=now)}function onDrag(){_this.shift(item,x,y),item.positionDropPlaceholder(),_this.layout()}},proto.itemDragEnd=function(elem){var item=this.isEnabled&&this.getItem(elem);if(item){clearTimeout(this.dragTimeout),item.element.classList.add("is-positioning-post-drag");var completeCount=0,_this=this;item.once("layout",onDragEndLayoutComplete),this.once("layoutComplete",onDragEndLayoutComplete),item.moveTo(item.rect.x,item.rect.y),this.layout(),this.dragItemCount=Math.max(0,this.dragItemCount-1),this.sortItemsByPosition(),item.disablePlacing(),this.unstamp(item.element)}function onDragEndLayoutComplete(){2==++completeCount&&(item.element.classList.remove("is-positioning-post-drag"),item.hideDropPlaceholder(),_this.dispatchEvent("dragItemPositioned",null,[item]))}},proto.bindDraggabillyEvents=function(draggie){this._bindDraggabillyEvents(draggie,"on")},proto.unbindDraggabillyEvents=function(draggie){this._bindDraggabillyEvents(draggie,"off")},proto._bindDraggabillyEvents=function(draggie,method){var handlers=this.handleDraggabilly;draggie[method]("dragStart",handlers.dragStart),draggie[method]("dragMove",handlers.dragMove),draggie[method]("dragEnd",handlers.dragEnd)},proto.bindUIDraggableEvents=function($elems){this._bindUIDraggableEvents($elems,"on")},proto.unbindUIDraggableEvents=function($elems){this._bindUIDraggableEvents($elems,"off")},proto._bindUIDraggableEvents=function($elems,method){var handlers=this.handleUIDraggable;$elems[method]("dragstart",handlers.start)[method]("drag",handlers.drag)[method]("dragstop",handlers.stop)};var _destroy=proto.destroy;return proto.destroy=function(){_destroy.apply(this,arguments),this.isEnabled=!1},Packery.Rect=Rect,Packery.Packer=Packer,Packery}),function(global,factory){"function"==typeof define&&define.amd?define("ev-emitter/ev-emitter",factory):"object"==typeof module&&module.exports?module.exports=factory():global.EvEmitter=factory()}("undefined"!=typeof window?window:this,function(){function EvEmitter(){}var proto=EvEmitter.prototype;return proto.on=function(eventName,listener){if(eventName&&listener){var events=this._events=this._events||{},listeners=events[eventName]=events[eventName]||[];return-1==listeners.indexOf(listener)&&listeners.push(listener),this}},proto.once=function(eventName,listener){if(eventName&&listener){this.on(eventName,listener);var onceEvents=this._onceEvents=this._onceEvents||{};return(onceEvents[eventName]=onceEvents[eventName]||{})[listener]=!0,this}},proto.off=function(eventName,listener){var listeners=this._events&&this._events[eventName];if(listeners&&listeners.length){var index=listeners.indexOf(listener);return-1!=index&&listeners.splice(index,1),this}},proto.emitEvent=function(eventName,args){var listeners=this._events&&this._events[eventName];if(listeners&&listeners.length){listeners=listeners.slice(0),args=args||[];for(var onceListeners=this._onceEvents&&this._onceEvents[eventName],i=0;i<listeners.length;i++){var listener=listeners[i];onceListeners&&onceListeners[listener]&&(this.off(eventName,listener),delete onceListeners[listener]),listener.apply(this,args)}return this}},proto.allOff=function(){delete this._events,delete this._onceEvents},EvEmitter}),function(window,factory){"use strict";"function"==typeof define&&define.amd?define(["ev-emitter/ev-emitter"],function(EvEmitter){return factory(window,EvEmitter)}):"object"==typeof module&&module.exports?module.exports=factory(window,require("ev-emitter")):window.imagesLoaded=factory(window,window.EvEmitter)}("undefined"!=typeof window?window:this,function(window,EvEmitter){var $=window.jQuery,console=window.console;function extend(a,b){for(var prop in b)a[prop]=b[prop];return a}var arraySlice=Array.prototype.slice;function ImagesLoaded(elem,options,onAlways){if(!(this instanceof ImagesLoaded))return new ImagesLoaded(elem,options,onAlways);var queryElem=elem;"string"==typeof elem&&(queryElem=document.querySelectorAll(elem)),queryElem?(this.elements=function(obj){return Array.isArray(obj)?obj:"object"==typeof obj&&"number"==typeof obj.length?arraySlice.call(obj):[obj]}(queryElem),this.options=extend({},this.options),"function"==typeof options?onAlways=options:extend(this.options,options),onAlways&&this.on("always",onAlways),this.getImages(),$&&(this.jqDeferred=new $.Deferred),setTimeout(this.check.bind(this))):console.error("Bad element for imagesLoaded "+(queryElem||elem))}(ImagesLoaded.prototype=Object.create(EvEmitter.prototype)).options={},ImagesLoaded.prototype.getImages=function(){this.images=[],this.elements.forEach(this.addElementImages,this)},ImagesLoaded.prototype.addElementImages=function(elem){"IMG"==elem.nodeName&&this.addImage(elem),!0===this.options.background&&this.addElementBackgroundImages(elem);var nodeType=elem.nodeType;if(nodeType&&elementNodeTypes[nodeType]){for(var childImgs=elem.querySelectorAll("img"),i=0;i<childImgs.length;i++){var img=childImgs[i];this.addImage(img)}if("string"==typeof this.options.background){var children=elem.querySelectorAll(this.options.background);for(i=0;i<children.length;i++){var child=children[i];this.addElementBackgroundImages(child)}}}};var elementNodeTypes={1:!0,9:!0,11:!0};function LoadingImage(img){this.img=img}function Background(url,element){this.url=url,this.element=element,this.img=new Image}return ImagesLoaded.prototype.addElementBackgroundImages=function(elem){var style=getComputedStyle(elem);if(style)for(var reURL=/url\((['"])?(.*?)\1\)/gi,matches=reURL.exec(style.backgroundImage);null!==matches;){var url=matches&&matches[2];url&&this.addBackground(url,elem),matches=reURL.exec(style.backgroundImage)}},ImagesLoaded.prototype.addImage=function(img){var loadingImage=new LoadingImage(img);this.images.push(loadingImage)},ImagesLoaded.prototype.addBackground=function(url,elem){var background=new Background(url,elem);this.images.push(background)},ImagesLoaded.prototype.check=function(){var _this=this;function onProgress(image,elem,message){setTimeout(function(){_this.progress(image,elem,message)})}this.progressedCount=0,this.hasAnyBroken=!1,this.images.length?this.images.forEach(function(loadingImage){loadingImage.once("progress",onProgress),loadingImage.check()}):this.complete()},ImagesLoaded.prototype.progress=function(image,elem,message){this.progressedCount++,this.hasAnyBroken=this.hasAnyBroken||!image.isLoaded,this.emitEvent("progress",[this,image,elem]),this.jqDeferred&&this.jqDeferred.notify&&this.jqDeferred.notify(this,image),this.progressedCount==this.images.length&&this.complete(),this.options.debug&&console&&console.log("progress: "+message,image,elem)},ImagesLoaded.prototype.complete=function(){var eventName=this.hasAnyBroken?"fail":"done";if(this.isComplete=!0,this.emitEvent(eventName,[this]),this.emitEvent("always",[this]),this.jqDeferred){var jqMethod=this.hasAnyBroken?"reject":"resolve";this.jqDeferred[jqMethod](this)}},(LoadingImage.prototype=Object.create(EvEmitter.prototype)).check=function(){this.getIsImageComplete()?this.confirm(0!==this.img.naturalWidth,"naturalWidth"):(this.proxyImage=new Image,this.proxyImage.addEventListener("load",this),this.proxyImage.addEventListener("error",this),this.img.addEventListener("load",this),this.img.addEventListener("error",this),this.proxyImage.src=this.img.src)},LoadingImage.prototype.getIsImageComplete=function(){return this.img.complete&&this.img.naturalWidth},LoadingImage.prototype.confirm=function(isLoaded,message){this.isLoaded=isLoaded,this.emitEvent("progress",[this,this.img,message])},LoadingImage.prototype.handleEvent=function(event){var method="on"+event.type;this[method]&&this[method](event)},LoadingImage.prototype.onload=function(){this.confirm(!0,"onload"),this.unbindEvents()},LoadingImage.prototype.onerror=function(){this.confirm(!1,"onerror"),this.unbindEvents()},LoadingImage.prototype.unbindEvents=function(){this.proxyImage.removeEventListener("load",this),this.proxyImage.removeEventListener("error",this),this.img.removeEventListener("load",this),this.img.removeEventListener("error",this)},(Background.prototype=Object.create(LoadingImage.prototype)).check=function(){this.img.addEventListener("load",this),this.img.addEventListener("error",this),this.img.src=this.url,this.getIsImageComplete()&&(this.confirm(0!==this.img.naturalWidth,"naturalWidth"),this.unbindEvents())},Background.prototype.unbindEvents=function(){this.img.removeEventListener("load",this),this.img.removeEventListener("error",this)},Background.prototype.confirm=function(isLoaded,message){this.isLoaded=isLoaded,this.emitEvent("progress",[this,this.element,message])},ImagesLoaded.makeJQueryPlugin=function(jQuery){(jQuery=jQuery||window.jQuery)&&(($=jQuery).fn.imagesLoaded=function(options,callback){return new ImagesLoaded(this,options,callback).jqDeferred.promise($(this))})},ImagesLoaded.makeJQueryPlugin(),ImagesLoaded}),function(root,factory){"function"==typeof define&&define.amd?define(factory):"object"==typeof exports?module.exports=factory(require,exports,module):root.Tether=factory()}(this,function(require,exports,module){return function(){var Evented,addClass,defer,deferred,extend,flush,getBounds,getOffsetParent,getOrigin,getScrollBarSize,getScrollParent,hasClass,removeClass,uniqueId,updateClasses,zeroPosCache,id,__hasProp={}.hasOwnProperty,__indexOf=[].indexOf||function(item){for(var i=0,l=this.length;i<l;i++)if(i in this&&this[i]===item)return i;return-1},__slice=[].slice;null==this.Tether&&(this.Tether={modules:[]}),getScrollParent=function(el){var parent,position,style,_ref;if("fixed"===(position=getComputedStyle(el).position))return el;for(void 0,parent=el;parent=parent.parentNode;){try{style=getComputedStyle(parent)}catch(_error){}if(null==style)return parent;if(/(auto|scroll)/.test(style.overflow+style["overflow-y"]+style["overflow-x"])&&("absolute"!==position||"relative"===(_ref=style.position)||"absolute"===_ref||"fixed"===_ref))return parent}return document.body},id=0,uniqueId=function(){return id++},zeroPosCache={},getOrigin=function(doc){var id,k,node,v,_ref;if(null==(node=doc._tetherZeroElement)&&((node=doc.createElement("div")).setAttribute("data-tether-id",uniqueId()),extend(node.style,{top:0,left:0,position:"absolute"}),doc.body.appendChild(node),doc._tetherZeroElement=node),id=node.getAttribute("data-tether-id"),null==zeroPosCache[id]){for(k in zeroPosCache[id]={},_ref=node.getBoundingClientRect())v=_ref[k],zeroPosCache[id][k]=v;defer(function(){return zeroPosCache[id]=void 0})}return zeroPosCache[id]},getBounds=function(el){var box,doc,docEl,k,origin,v,_ref;for(k in el===document?(doc=document,el=document.documentElement):doc=el.ownerDocument,docEl=doc.documentElement,box={},_ref=el.getBoundingClientRect())v=_ref[k],box[k]=v;return origin=getOrigin(doc),box.top-=origin.top,box.left-=origin.left,null==box.width&&(box.width=document.body.scrollWidth-box.left-box.right),null==box.height&&(box.height=document.body.scrollHeight-box.top-box.bottom),box.top=box.top-docEl.clientTop,box.left=box.left-docEl.clientLeft,box.right=doc.body.clientWidth-box.width-box.left,box.bottom=doc.body.clientHeight-box.height-box.top,box},getOffsetParent=function(el){return el.offsetParent||document.documentElement},getScrollBarSize=function(){var inner,outer,width,widthContained,widthScroll;return(inner=document.createElement("div")).style.width="100%",inner.style.height="200px",outer=document.createElement("div"),extend(outer.style,{position:"absolute",top:0,left:0,pointerEvents:"none",visibility:"hidden",width:"200px",height:"150px",overflow:"hidden"}),outer.appendChild(inner),document.body.appendChild(outer),widthContained=inner.offsetWidth,outer.style.overflow="scroll",widthContained===(widthScroll=inner.offsetWidth)&&(widthScroll=outer.clientWidth),document.body.removeChild(outer),{width:width=widthContained-widthScroll,height:width}},extend=function(out){var args,key,obj,val,_i,_len,_ref;for(null==out&&(out={}),args=[],Array.prototype.push.apply(args,arguments),_i=0,_len=(_ref=args.slice(1)).length;_i<_len;_i++)if(obj=_ref[_i])for(key in obj)__hasProp.call(obj,key)&&(val=obj[key],out[key]=val);return out},removeClass=function(el,name){var cls,_i,_len,_ref,_results;if(null==el.classList)return el.className=el.className.replace(new RegExp("(^| )"+name.split(" ").join("|")+"( |$)","gi")," ");for(_results=[],_i=0,_len=(_ref=name.split(" ")).length;_i<_len;_i++)(cls=_ref[_i]).trim()&&_results.push(el.classList.remove(cls));return _results},addClass=function(el,name){var cls,_i,_len,_ref,_results;if(null==el.classList)return removeClass(el,name),el.className+=" "+name;for(_results=[],_i=0,_len=(_ref=name.split(" ")).length;_i<_len;_i++)(cls=_ref[_i]).trim()&&_results.push(el.classList.add(cls));return _results},hasClass=function(el,name){return null!=el.classList?el.classList.contains(name):new RegExp("(^| )"+name+"( |$)","gi").test(el.className)},updateClasses=function(el,add,all){var cls,_i,_j,_len,_len1,_results;for(_i=0,_len=all.length;_i<_len;_i++)cls=all[_i],__indexOf.call(add,cls)<0&&hasClass(el,cls)&&removeClass(el,cls);for(_results=[],_j=0,_len1=add.length;_j<_len1;_j++)cls=add[_j],hasClass(el,cls)?_results.push(void 0):_results.push(addClass(el,cls));return _results},deferred=[],defer=function(fn){return deferred.push(fn)},flush=function(){var fn,_results;for(_results=[];fn=deferred.pop();)_results.push(fn());return _results},Evented=function(){function Evented(){}return Evented.prototype.on=function(event,handler,ctx,once){var _base;return null==once&&(once=!1),null==this.bindings&&(this.bindings={}),null==(_base=this.bindings)[event]&&(_base[event]=[]),this.bindings[event].push({handler:handler,ctx:ctx,once:once})},Evented.prototype.once=function(event,handler,ctx){return this.on(event,handler,ctx,!0)},Evented.prototype.off=function(event,handler){var i,_ref,_results;if(null!=(null!=(_ref=this.bindings)?_ref[event]:void 0)){if(null==handler)return delete this.bindings[event];for(i=0,_results=[];i<this.bindings[event].length;)this.bindings[event][i].handler===handler?_results.push(this.bindings[event].splice(i,1)):_results.push(i++);return _results}},Evented.prototype.trigger=function(){var args,ctx,event,handler,i,once,_ref,_ref1,_results;if(event=arguments[0],args=2<=arguments.length?__slice.call(arguments,1):[],null!=(_ref=this.bindings)?_ref[event]:void 0){for(i=0,_results=[];i<this.bindings[event].length;)handler=(_ref1=this.bindings[event][i]).handler,ctx=_ref1.ctx,once=_ref1.once,handler.apply(null!=ctx?ctx:this,args),once?_results.push(this.bindings[event].splice(i,1)):_results.push(i++);return _results}},Evented}(),this.Tether.Utils={getScrollParent:getScrollParent,getBounds:getBounds,getOffsetParent:getOffsetParent,extend:extend,addClass:addClass,removeClass:removeClass,hasClass:hasClass,updateClasses:updateClasses,defer:defer,flush:flush,uniqueId:uniqueId,Evented:Evented,getScrollBarSize:getScrollBarSize}}.call(this),function(){var MIRROR_LR,MIRROR_TB,OFFSET_MAP,Tether,addClass,addOffset,attachmentToOffset,autoToFixedAttachment,defer,extend,flush,getBounds,getOffsetParent,getScrollBarSize,getScrollParent,now,offsetToPx,parseAttachment,parseOffset,position,removeClass,tethers,transformKey,updateClasses,within,_Tether,_ref,__slice=[].slice;if(null==this.Tether)throw new Error("You must include the utils.js file before tether.js");_ref=(Tether=this.Tether).Utils,getScrollParent=_ref.getScrollParent,_ref.getSize,_ref.getOuterSize,getBounds=_ref.getBounds,getOffsetParent=_ref.getOffsetParent,extend=_ref.extend,addClass=_ref.addClass,removeClass=_ref.removeClass,updateClasses=_ref.updateClasses,defer=_ref.defer,flush=_ref.flush,getScrollBarSize=_ref.getScrollBarSize,within=function(a,b,diff){return null==diff&&(diff=1),b<=a+diff&&a-diff<=b},transformKey=function(){var el,key,_i,_len,_ref1;for(el=document.createElement("div"),_i=0,_len=(_ref1=["transform","webkitTransform","OTransform","MozTransform","msTransform"]).length;_i<_len;_i++)if(key=_ref1[_i],void 0!==el.style[key])return key}(),tethers=[],position=function(){var _i,_len;for(_i=0,_len=tethers.length;_i<_len;_i++)tethers[_i].position(!1);return flush()},now=function(){var _ref1;return null!=(_ref1="undefined"!=typeof performance&&null!==performance&&"function"==typeof performance.now?performance.now():void 0)?_ref1:+new Date},function(){var event,lastCall,lastDuration,pendingTimeout,tick,_i,_len,_ref1,_results;for(pendingTimeout=lastDuration=lastCall=null,tick=function(){return null!=lastDuration&&16<lastDuration?(lastDuration=Math.min(lastDuration-16,250),void(pendingTimeout=setTimeout(tick,250))):null!=lastCall&&now()-lastCall<10?void 0:(null!=pendingTimeout&&(clearTimeout(pendingTimeout),pendingTimeout=null),lastCall=now(),position(),lastDuration=now()-lastCall)},_results=[],_i=0,_len=(_ref1=["resize","scroll","touchmove"]).length;_i<_len;_i++)event=_ref1[_i],_results.push(window.addEventListener(event,tick))}(),MIRROR_LR={center:"center",left:"right",right:"left"},MIRROR_TB={middle:"middle",top:"bottom",bottom:"top"},OFFSET_MAP={top:0,left:0,middle:"50%",center:"50%",bottom:"100%",right:"100%"},autoToFixedAttachment=function(attachment,relativeToAttachment){var left,top;return left=attachment.left,top=attachment.top,"auto"===left&&(left=MIRROR_LR[relativeToAttachment.left]),"auto"===top&&(top=MIRROR_TB[relativeToAttachment.top]),{left:left,top:top}},attachmentToOffset=function(attachment){var _ref1,_ref2;return{left:null!=(_ref1=OFFSET_MAP[attachment.left])?_ref1:attachment.left,top:null!=(_ref2=OFFSET_MAP[attachment.top])?_ref2:attachment.top}},addOffset=function(){var left,offsets,out,top,_i,_len,_ref1;for(out={top:0,left:0},_i=0,_len=(offsets=1<=arguments.length?__slice.call(arguments,0):[]).length;_i<_len;_i++)top=(_ref1=offsets[_i]).top,left=_ref1.left,"string"==typeof top&&(top=parseFloat(top,10)),"string"==typeof left&&(left=parseFloat(left,10)),out.top+=top,out.left+=left;return out},offsetToPx=function(offset,size){return"string"==typeof offset.left&&-1!==offset.left.indexOf("%")&&(offset.left=parseFloat(offset.left,10)/100*size.width),"string"==typeof offset.top&&-1!==offset.top.indexOf("%")&&(offset.top=parseFloat(offset.top,10)/100*size.height),offset},parseAttachment=parseOffset=function(value){var _ref1;return{top:(_ref1=value.split(" "))[0],left:_ref1[1]}},_Tether=function(){function _Tether(options){var _i,_len,_ref1,_ref2;for(this.position=function(fn,me){return function(){return fn.apply(me,arguments)}}(this.position,this),tethers.push(this),this.history=[],this.setOptions(options,!1),_i=0,_len=(_ref1=Tether.modules).length;_i<_len;_i++)null!=(_ref2=_ref1[_i].initialize)&&_ref2.call(this);this.position()}return _Tether.modules=[],_Tether.prototype.getClass=function(key){var _ref1,_ref2;return(null!=(_ref1=this.options.classes)?_ref1[key]:void 0)?this.options.classes[key]:!1!==(null!=(_ref2=this.options.classes)?_ref2[key]:void 0)?this.options.classPrefix?this.options.classPrefix+"-"+key:key:""},_Tether.prototype.setOptions=function(options,position){var defaults,key,_i,_len,_ref1,_ref2;for(this.options=options,null==position&&(position=!0),defaults={offset:"0 0",targetOffset:"0 0",targetAttachment:"auto auto",classPrefix:"tether"},this.options=extend(defaults,this.options),_ref1=this.options,this.element=_ref1.element,this.target=_ref1.target,this.targetModifier=_ref1.targetModifier,"viewport"===this.target?(this.target=document.body,this.targetModifier="visible"):"scroll-handle"===this.target&&(this.target=document.body,this.targetModifier="scroll-handle"),_i=0,_len=(_ref2=["element","target"]).length;_i<_len;_i++){if(null==this[key=_ref2[_i]])throw new Error("Tether Error: Both element and target must be defined");null!=this[key].jquery?this[key]=this[key][0]:"string"==typeof this[key]&&(this[key]=document.querySelector(this[key]))}if(addClass(this.element,this.getClass("element")),addClass(this.target,this.getClass("target")),!this.options.attachment)throw new Error("Tether Error: You must provide an attachment");if(this.targetAttachment=parseAttachment(this.options.targetAttachment),this.attachment=parseAttachment(this.options.attachment),this.offset=parseOffset(this.options.offset),this.targetOffset=parseOffset(this.options.targetOffset),null!=this.scrollParent&&this.disable(),"scroll-handle"===this.targetModifier?this.scrollParent=this.target:this.scrollParent=getScrollParent(this.target),!1!==this.options.enabled)return this.enable(position)},_Tether.prototype.getTargetBounds=function(){var bounds,fitAdj,height,out,scrollBottom,scrollPercentage,style,target;if(null==this.targetModifier)return getBounds(this.target);switch(this.targetModifier){case"visible":return this.target===document.body?{top:pageYOffset,left:pageXOffset,height:innerHeight,width:innerWidth}:((out={height:(bounds=getBounds(this.target)).height,width:bounds.width,top:bounds.top,left:bounds.left}).height=Math.min(out.height,bounds.height-(pageYOffset-bounds.top)),out.height=Math.min(out.height,bounds.height-(bounds.top+bounds.height-(pageYOffset+innerHeight))),out.height=Math.min(innerHeight,out.height),out.height-=2,out.width=Math.min(out.width,bounds.width-(pageXOffset-bounds.left)),out.width=Math.min(out.width,bounds.width-(bounds.left+bounds.width-(pageXOffset+innerWidth))),out.width=Math.min(innerWidth,out.width),out.width-=2,out.top<pageYOffset&&(out.top=pageYOffset),out.left<pageXOffset&&(out.left=pageXOffset),out);case"scroll-handle":return bounds=(target=this.target)===document.body?(target=document.documentElement,{left:pageXOffset,top:pageYOffset,height:innerHeight,width:innerWidth}):getBounds(target),style=getComputedStyle(target),scrollBottom=0,(target.scrollWidth>target.clientWidth||"scroll"===[style.overflow,style.overflowX]||this.target!==document.body)&&(scrollBottom=15),out={width:15,height:.975*(height=bounds.height-parseFloat(style.borderTopWidth)-parseFloat(style.borderBottomWidth)-scrollBottom)*(height/target.scrollHeight),left:bounds.left+bounds.width-parseFloat(style.borderLeftWidth)-15},fitAdj=0,height<408&&this.target===document.body&&(fitAdj=-11e-5*Math.pow(height,2)-.00727*height+22.58),this.target!==document.body&&(out.height=Math.max(out.height,24)),scrollPercentage=this.target.scrollTop/(target.scrollHeight-height),out.top=scrollPercentage*(height-out.height-fitAdj)+bounds.top+parseFloat(style.borderTopWidth),this.target===document.body&&(out.height=Math.max(out.height,24)),out}},_Tether.prototype.clearCache=function(){return this._cache={}},_Tether.prototype.cache=function(k,getter){return null==this._cache&&(this._cache={}),null==this._cache[k]&&(this._cache[k]=getter.call(this)),this._cache[k]},_Tether.prototype.enable=function(position){if(null==position&&(position=!0),addClass(this.target,this.getClass("enabled")),addClass(this.element,this.getClass("enabled")),this.enabled=!0,this.scrollParent!==document&&this.scrollParent.addEventListener("scroll",this.position),position)return this.position()},_Tether.prototype.disable=function(){if(removeClass(this.target,this.getClass("enabled")),removeClass(this.element,this.getClass("enabled")),this.enabled=!1,null!=this.scrollParent)return this.scrollParent.removeEventListener("scroll",this.position)},_Tether.prototype.destroy=function(){var i,_i,_len,_results;for(this.disable(),_results=[],i=_i=0,_len=tethers.length;_i<_len;i=++_i){if(tethers[i]===this){tethers.splice(i,1);break}_results.push(void 0)}return _results},_Tether.prototype.updateAttachClasses=function(elementAttach,targetAttach){var add,all,side,sides,_i,_j,_len,_len1,_ref1,_this=this;for(null==elementAttach&&(elementAttach=this.attachment),null==targetAttach&&(targetAttach=this.targetAttachment),sides=["left","top","bottom","right","middle","center"],(null!=(_ref1=this._addAttachClasses)?_ref1.length:void 0)&&this._addAttachClasses.splice(0,this._addAttachClasses.length),add=null!=this._addAttachClasses?this._addAttachClasses:this._addAttachClasses=[],elementAttach.top&&add.push(this.getClass("element-attached")+"-"+elementAttach.top),elementAttach.left&&add.push(this.getClass("element-attached")+"-"+elementAttach.left),targetAttach.top&&add.push(this.getClass("target-attached")+"-"+targetAttach.top),targetAttach.left&&add.push(this.getClass("target-attached")+"-"+targetAttach.left),all=[],_i=0,_len=sides.length;_i<_len;_i++)side=sides[_i],all.push(this.getClass("element-attached")+"-"+side);for(_j=0,_len1=sides.length;_j<_len1;_j++)side=sides[_j],all.push(this.getClass("target-attached")+"-"+side);return defer(function(){if(null!=_this._addAttachClasses)return updateClasses(_this.element,_this._addAttachClasses,all),updateClasses(_this.target,_this._addAttachClasses,all),_this._addAttachClasses=void 0})},_Tether.prototype.position=function(flushChanges){var elementPos,height,left,manualOffset,manualTargetOffset,next,offset,offsetBorder,offsetParent,offsetParentSize,offsetParentStyle,offsetPosition,ret,scrollLeft,scrollTop,scrollbarSize,side,targetAttachment,targetOffset,targetPos,targetSize,top,width,_i,_j,_len,_len1,_ref1,_ref2,_ref3,_ref4,_ref5,_ref6,_this=this;if(null==flushChanges&&(flushChanges=!0),this.enabled){for(this.clearCache(),targetAttachment=autoToFixedAttachment(this.targetAttachment,this.attachment),this.updateAttachClasses(this.attachment,targetAttachment),width=(elementPos=this.cache("element-bounds",function(){return getBounds(_this.element)})).width,height=elementPos.height,0===width&&0===height&&null!=this.lastSize?(width=(_ref1=this.lastSize).width,height=_ref1.height):this.lastSize={width:width,height:height},targetSize=targetPos=this.cache("target-bounds",function(){return _this.getTargetBounds()}),offset=offsetToPx(attachmentToOffset(this.attachment),{width:width,height:height}),targetOffset=offsetToPx(attachmentToOffset(targetAttachment),targetSize),manualOffset=offsetToPx(this.offset,{width:width,height:height}),manualTargetOffset=offsetToPx(this.targetOffset,targetSize),offset=addOffset(offset,manualOffset),targetOffset=addOffset(targetOffset,manualTargetOffset),left=targetPos.left+targetOffset.left-offset.left,top=targetPos.top+targetOffset.top-offset.top,_i=0,_len=(_ref2=Tether.modules).length;_i<_len;_i++)if(null!=(ret=_ref2[_i].position.call(this,{left:left,top:top,targetAttachment:targetAttachment,targetPos:targetPos,attachment:this.attachment,elementPos:elementPos,offset:offset,targetOffset:targetOffset,manualOffset:manualOffset,manualTargetOffset:manualTargetOffset,scrollbarSize:scrollbarSize}))&&"object"==typeof ret){if(!1===ret)return!1;top=ret.top,left=ret.left}if(next={page:{top:top,left:left},viewport:{top:top-pageYOffset,bottom:pageYOffset-top-height+innerHeight,left:left-pageXOffset,right:pageXOffset-left-width+innerWidth}},document.body.scrollWidth>window.innerWidth&&(scrollbarSize=this.cache("scrollbar-size",getScrollBarSize),next.viewport.bottom-=scrollbarSize.height),document.body.scrollHeight>window.innerHeight&&(scrollbarSize=this.cache("scrollbar-size",getScrollBarSize),next.viewport.right-=scrollbarSize.width),(""!==(_ref3=document.body.style.position)&&"static"!==_ref3||""!==(_ref4=document.body.parentElement.style.position)&&"static"!==_ref4)&&(next.page.bottom=document.body.scrollHeight-top-height,next.page.right=document.body.scrollWidth-left-width),!1!==(null!=(_ref5=this.options.optimizations)?_ref5.moveElement:void 0)&&null==this.targetModifier){for(offsetParent=this.cache("target-offsetparent",function(){return getOffsetParent(_this.target)}),offsetPosition=this.cache("target-offsetparent-bounds",function(){return getBounds(offsetParent)}),offsetParentStyle=getComputedStyle(offsetParent),getComputedStyle(this.element),offsetParentSize=offsetPosition,offsetBorder={},_j=0,_len1=(_ref6=["Top","Left","Bottom","Right"]).length;_j<_len1;_j++)offsetBorder[(side=_ref6[_j]).toLowerCase()]=parseFloat(offsetParentStyle["border"+side+"Width"]);offsetPosition.right=document.body.scrollWidth-offsetPosition.left-offsetParentSize.width+offsetBorder.right,offsetPosition.bottom=document.body.scrollHeight-offsetPosition.top-offsetParentSize.height+offsetBorder.bottom,next.page.top>=offsetPosition.top+offsetBorder.top&&next.page.bottom>=offsetPosition.bottom&&next.page.left>=offsetPosition.left+offsetBorder.left&&next.page.right>=offsetPosition.right&&(scrollTop=offsetParent.scrollTop,scrollLeft=offsetParent.scrollLeft,next.offset={top:next.page.top-offsetPosition.top+scrollTop-offsetBorder.top,left:next.page.left-offsetPosition.left+scrollLeft-offsetBorder.left})}return this.move(next),this.history.unshift(next),3<this.history.length&&this.history.pop(),flushChanges&&flush(),!0}},_Tether.prototype.move=function(position){var css,elVal,found,key,moved,offsetParent,point,same,transcribe,type,val,write,writeCSS,_i,_len,_ref1,_ref2,_this=this;if(null!=this.element.parentNode){for(type in same={},position)for(key in same[type]={},position[type]){for(found=!1,_i=0,_len=(_ref1=this.history).length;_i<_len;_i++)if(point=_ref1[_i],!within(null!=(_ref2=point[type])?_ref2[key]:void 0,position[type][key])){found=!0;break}found||(same[type][key]=!0)}for(key in css={top:"",left:"",right:"",bottom:""},moved=!(transcribe=function(same,pos){var xPos,yPos,_ref3;return!1===(null!=(_ref3=_this.options.optimizations)?_ref3.gpu:void 0)?(same.top?css.top=pos.top+"px":css.bottom=pos.bottom+"px",same.left?css.left=pos.left+"px":css.right=pos.right+"px"):(yPos=same.top?(css.top=0,pos.top):(css.bottom=0,-pos.bottom),xPos=same.left?(css.left=0,pos.left):(css.right=0,-pos.right),css[transformKey]="translateX("+Math.round(xPos)+"px) translateY("+Math.round(yPos)+"px)","msTransform"!==transformKey?css[transformKey]+=" translateZ(0)":void 0)}),(same.page.top||same.page.bottom)&&(same.page.left||same.page.right)?(css.position="absolute",transcribe(same.page,position.page)):(same.viewport.top||same.viewport.bottom)&&(same.viewport.left||same.viewport.right)?(css.position="fixed",transcribe(same.viewport,position.viewport)):null!=same.offset&&same.offset.top&&same.offset.left?(css.position="absolute",offsetParent=this.cache("target-offsetparent",function(){return getOffsetParent(_this.target)}),getOffsetParent(this.element)!==offsetParent&&defer(function(){return _this.element.parentNode.removeChild(_this.element),offsetParent.appendChild(_this.element)}),transcribe(same.offset,position.offset),moved=!0):(css.position="absolute",transcribe({top:!0,left:!0},position.page)),moved||"BODY"===this.element.parentNode.tagName||(this.element.parentNode.removeChild(this.element),document.body.appendChild(this.element)),write=!(writeCSS={}),css)val=css[key],""===(elVal=this.element.style[key])||""===val||"top"!==key&&"left"!==key&&"bottom"!==key&&"right"!==key||(elVal=parseFloat(elVal),val=parseFloat(val)),elVal!==val&&(write=!0,writeCSS[key]=css[key]);return write?defer(function(){return extend(_this.element.style,writeCSS)}):void 0}},_Tether}(),Tether.position=position,this.Tether=extend(_Tether,Tether)}.call(this),function(){var BOUNDS_FORMAT,defer,extend,getBoundingRect,getBounds,updateClasses,_ref,__indexOf=[].indexOf||function(item){for(var i=0,l=this.length;i<l;i++)if(i in this&&this[i]===item)return i;return-1};(_ref=this.Tether.Utils).getOuterSize,getBounds=_ref.getBounds,_ref.getSize,extend=_ref.extend,updateClasses=_ref.updateClasses,defer=_ref.defer,BOUNDS_FORMAT=["left","top","right","bottom"],getBoundingRect=function(tether,to){var i,pos,side,size,style,_i,_len;if("scrollParent"===to?to=tether.scrollParent:"window"===to&&(to=[pageXOffset,pageYOffset,innerWidth+pageXOffset,innerHeight+pageYOffset]),to===document&&(to=to.documentElement),null!=to.nodeType)for(pos=size=getBounds(to),style=getComputedStyle(to),to=[pos.left,pos.top,size.width+pos.left,size.height+pos.top],i=_i=0,_len=BOUNDS_FORMAT.length;_i<_len;i=++_i)"Top"===(side=(side=BOUNDS_FORMAT[i])[0].toUpperCase()+side.substr(1))||"Left"===side?to[i]+=parseFloat(style["border"+side+"Width"]):to[i]-=parseFloat(style["border"+side+"Width"]);return to},this.Tether.modules.push({position:function(_arg){var addClasses,allClasses,attachment,bounds,changeAttachX,changeAttachY,cls,constraint,eAttachment,height,left,oob,oobClass,p,pin,pinned,pinnedClass,side,tAttachment,targetAttachment,targetHeight,targetSize,targetWidth,to,top,width,_i,_j,_k,_l,_len,_len1,_len2,_len3,_len4,_len5,_m,_n,_ref1,_ref2,_ref3,_ref4,_ref5,_ref6,_ref7,_ref8,_this=this;if(top=_arg.top,left=_arg.left,targetAttachment=_arg.targetAttachment,!this.options.constraints)return!0;for(function(prefix){var side,_i,_len,_results;for(_this.removeClass(prefix),_results=[],_i=0,_len=BOUNDS_FORMAT.length;_i<_len;_i++)side=BOUNDS_FORMAT[_i],_results.push(_this.removeClass(prefix+"-"+side));return _results},height=(_ref1=this.cache("element-bounds",function(){return getBounds(_this.element)})).height,0===(width=_ref1.width)&&0===height&&null!=this.lastSize&&(width=(_ref2=this.lastSize).width,height=_ref2.height),targetHeight=(targetSize=this.cache("target-bounds",function(){return _this.getTargetBounds()})).height,targetWidth=targetSize.width,tAttachment={},eAttachment={},allClasses=[this.getClass("pinned"),this.getClass("out-of-bounds")],_i=0,_len=(_ref3=this.options.constraints).length;_i<_len;_i++)(constraint=_ref3[_i]).outOfBoundsClass&&allClasses.push(constraint.outOfBoundsClass),constraint.pinnedClass&&allClasses.push(constraint.pinnedClass);for(_j=0,_len1=allClasses.length;_j<_len1;_j++)for(cls=allClasses[_j],_k=0,_len2=(_ref4=["left","top","right","bottom"]).length;_k<_len2;_k++)side=_ref4[_k],allClasses.push(cls+"-"+side);for(addClasses=[],tAttachment=extend({},targetAttachment),eAttachment=extend({},this.attachment),_l=0,_len3=(_ref5=this.options.constraints).length;_l<_len3;_l++){if(to=(constraint=_ref5[_l]).to,attachment=constraint.attachment,pin=constraint.pin,null==attachment&&(attachment=""),changeAttachX=0<=__indexOf.call(attachment," ")?(changeAttachY=(_ref6=attachment.split(" "))[0],_ref6[1]):changeAttachY=attachment,bounds=getBoundingRect(this,to),"target"!==changeAttachY&&"both"!==changeAttachY||(top<bounds[1]&&"top"===tAttachment.top&&(top+=targetHeight,tAttachment.top="bottom"),top+height>bounds[3]&&"bottom"===tAttachment.top&&(top-=targetHeight,tAttachment.top="top")),"together"===changeAttachY&&(top<bounds[1]&&"top"===tAttachment.top&&("bottom"===eAttachment.top?(top+=targetHeight,tAttachment.top="bottom",top+=height,eAttachment.top="top"):"top"===eAttachment.top&&(top+=targetHeight,tAttachment.top="bottom",top-=height,eAttachment.top="bottom")),top+height>bounds[3]&&"bottom"===tAttachment.top&&("top"===eAttachment.top?(top-=targetHeight,tAttachment.top="top",top-=height,eAttachment.top="bottom"):"bottom"===eAttachment.top&&(top-=targetHeight,tAttachment.top="top",top+=height,eAttachment.top="top")),"middle"===tAttachment.top&&(top+height>bounds[3]&&"top"===eAttachment.top?(top-=height,eAttachment.top="bottom"):top<bounds[1]&&"bottom"===eAttachment.top&&(top+=height,eAttachment.top="top"))),"target"!==changeAttachX&&"both"!==changeAttachX||(left<bounds[0]&&"left"===tAttachment.left&&(left+=targetWidth,tAttachment.left="right"),left+width>bounds[2]&&"right"===tAttachment.left&&(left-=targetWidth,tAttachment.left="left")),"together"===changeAttachX&&(left<bounds[0]&&"left"===tAttachment.left?"right"===eAttachment.left?(left+=targetWidth,tAttachment.left="right",left+=width,eAttachment.left="left"):"left"===eAttachment.left&&(left+=targetWidth,tAttachment.left="right",left-=width,eAttachment.left="right"):left+width>bounds[2]&&"right"===tAttachment.left?"left"===eAttachment.left?(left-=targetWidth,tAttachment.left="left",left-=width,eAttachment.left="right"):"right"===eAttachment.left&&(left-=targetWidth,tAttachment.left="left",left+=width,eAttachment.left="left"):"center"===tAttachment.left&&(left+width>bounds[2]&&"left"===eAttachment.left?(left-=width,eAttachment.left="right"):left<bounds[0]&&"right"===eAttachment.left&&(left+=width,eAttachment.left="left"))),"element"!==changeAttachY&&"both"!==changeAttachY||(top<bounds[1]&&"bottom"===eAttachment.top&&(top+=height,eAttachment.top="top"),top+height>bounds[3]&&"top"===eAttachment.top&&(top-=height,eAttachment.top="bottom")),"element"!==changeAttachX&&"both"!==changeAttachX||(left<bounds[0]&&"right"===eAttachment.left&&(left+=width,eAttachment.left="left"),left+width>bounds[2]&&"left"===eAttachment.left&&(left-=width,eAttachment.left="right")),"string"==typeof pin?pin=function(){var _len4,_m,_ref7,_results;for(_results=[],_m=0,_len4=(_ref7=pin.split(",")).length;_m<_len4;_m++)p=_ref7[_m],_results.push(p.trim());return _results}():!0===pin&&(pin=["top","left","right","bottom"]),pin=pin||[],pinned=[],oob=[],top<bounds[1]&&(0<=__indexOf.call(pin,"top")?(top=bounds[1],pinned.push("top")):oob.push("top")),top+height>bounds[3]&&(0<=__indexOf.call(pin,"bottom")?(top=bounds[3]-height,pinned.push("bottom")):oob.push("bottom")),left<bounds[0]&&(0<=__indexOf.call(pin,"left")?(left=bounds[0],pinned.push("left")):oob.push("left")),left+width>bounds[2]&&(0<=__indexOf.call(pin,"right")?(left=bounds[2]-width,pinned.push("right")):oob.push("right")),pinned.length)for(pinnedClass=null!=(_ref7=this.options.pinnedClass)?_ref7:this.getClass("pinned"),addClasses.push(pinnedClass),_m=0,_len4=pinned.length;_m<_len4;_m++)side=pinned[_m],addClasses.push(pinnedClass+"-"+side);if(oob.length)for(oobClass=null!=(_ref8=this.options.outOfBoundsClass)?_ref8:this.getClass("out-of-bounds"),addClasses.push(oobClass),_n=0,_len5=oob.length;_n<_len5;_n++)side=oob[_n],addClasses.push(oobClass+"-"+side);(0<=__indexOf.call(pinned,"left")||0<=__indexOf.call(pinned,"right"))&&(eAttachment.left=tAttachment.left=!1),(0<=__indexOf.call(pinned,"top")||0<=__indexOf.call(pinned,"bottom"))&&(eAttachment.top=tAttachment.top=!1),tAttachment.top===targetAttachment.top&&tAttachment.left===targetAttachment.left&&eAttachment.top===this.attachment.top&&eAttachment.left===this.attachment.left||this.updateAttachClasses(eAttachment,tAttachment)}return defer(function(){return updateClasses(_this.target,addClasses,allClasses),updateClasses(_this.element,addClasses,allClasses)}),{top:top,left:left}}})}.call(this),function(){var defer,getBounds,updateClasses,_ref;_ref=this.Tether.Utils,getBounds=_ref.getBounds,updateClasses=_ref.updateClasses,defer=_ref.defer,this.Tether.modules.push({position:function(_arg){var abutted,addClasses,allClasses,bottom,left,right,side,sides,targetPos,top,_i,_j,_k,_l,_len,_len1,_len2,_len3,_ref1,_ref2,_ref3,_ref4,_ref5,_this=this;if(top=_arg.top,left=_arg.left,bottom=top+(_ref1=this.cache("element-bounds",function(){return getBounds(_this.element)})).height,right=left+_ref1.width,abutted=[],top<=(targetPos=this.getTargetBounds()).bottom&&bottom>=targetPos.top)for(_i=0,_len=(_ref2=["left","right"]).length;_i<_len;_i++)(_ref3=targetPos[side=_ref2[_i]])!==left&&_ref3!==right||abutted.push(side);if(left<=targetPos.right&&right>=targetPos.left)for(_j=0,_len1=(_ref4=["top","bottom"]).length;_j<_len1;_j++)(_ref5=targetPos[side=_ref4[_j]])!==top&&_ref5!==bottom||abutted.push(side);for(addClasses=[],sides=["left","top","right","bottom"],(allClasses=[]).push(this.getClass("abutted")),_k=0,_len2=sides.length;_k<_len2;_k++)side=sides[_k],allClasses.push(this.getClass("abutted")+"-"+side);for(abutted.length&&addClasses.push(this.getClass("abutted")),_l=0,_len3=abutted.length;_l<_len3;_l++)side=abutted[_l],addClasses.push(this.getClass("abutted")+"-"+side);return defer(function(){return updateClasses(_this.target,addClasses,allClasses),updateClasses(_this.element,addClasses,allClasses)}),!0}})}.call(this),function(){this.Tether.modules.push({position:function(_arg){var left,shift,shiftLeft,shiftTop,top,_ref;if(top=_arg.top,left=_arg.left,this.options.shift)return shiftLeft="string"==typeof(shift=function(val){return"function"==typeof val?val.call(this,{top:top,left:left}):val}(this.options.shift))?((shift=shift.split(" "))[1]||(shift[1]=shift[0]),shiftTop=shift[0],shiftLeft=shift[1],shiftTop=parseFloat(shiftTop,10),parseFloat(shiftLeft,10)):(shiftTop=(_ref=[shift.top,shift.left])[0],_ref[1]),{top:top+=shiftTop,left:left+=shiftLeft}}})}.call(this),this.Tether}),function(root,factory){"function"==typeof define&&define.amd?define(["tether"],factory):"object"==typeof exports?module.exports=factory(require("tether")):root.Shepherd=factory(root.Tether)}(this,function(Tether){"use strict";var _createClass=function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor};function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function _get(_x5,_x6,_x7){for(var _again=!0;_again;){var object=_x5,property=_x6,receiver=_x7;_again=!1,null===object&&(object=Function.prototype);var desc=Object.getOwnPropertyDescriptor(object,property);if(void 0!==desc){if("value"in desc)return desc.value;var getter=desc.get;if(void 0===getter)return;return getter.call(receiver)}var parent=Object.getPrototypeOf(object);if(null===parent)return;_x5=parent,_x6=property,_x7=receiver,_again=!0,desc=parent=void 0}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}var _Tether$Utils=Tether.Utils,Evented=_Tether$Utils.Evented,addClass=_Tether$Utils.addClass,extend=_Tether$Utils.extend,hasClass=_Tether$Utils.hasClass,removeClass=_Tether$Utils.removeClass,uniqueId=_Tether$Utils.uniqueId,Shepherd=new Evented;function isUndefined(obj){return void 0===obj}function isObjectLoose(obj){return"object"==typeof obj}var ATTACHMENT={"top right":"bottom left","top left":"bottom right","top center":"bottom center","middle right":"middle left","middle left":"middle right","middle center":"middle center","bottom left":"top right","bottom right":"top left","bottom center":"top center",top:"bottom center",left:"middle right",right:"middle left",bottom:"top center",center:"middle center",middle:"middle center"};function createFromHTML(html){var el=document.createElement("div");return el.innerHTML=html,el.children[0]}var positionRe=/^(.+) (top|left|right|bottom|center|\[[a-z ]+\])$/;var Step=function(){function Step(tour,options){return _classCallCheck(this,Step),_get(Object.getPrototypeOf(Step.prototype),"constructor",this).call(this,tour,options),this.tour=tour,this.bindMethods(),this.setOptions(options),this}return _inherits(Step,Evented),_createClass(Step,[{key:"bindMethods",value:function(){var _this=this;["_show","show","hide","isOpen","cancel","complete","scrollTo","destroy","render"].map(function(method){_this[method]=_this[method].bind(_this)})}},{key:"setOptions",value:function(argument_0){var options=arguments.length<=0||void 0===argument_0?{}:argument_0;this.options=options,this.destroy(),this.id=this.options.id||this.id||"step-"+uniqueId();var when=this.options.when;if(when)for(var _event in when)if({}.hasOwnProperty.call(when,_event)){var handler=when[_event];this.on(_event,handler,this)}var buttonsJson=JSON.stringify(this.options.buttons),buttonsAreDefault=isUndefined(buttonsJson)||"true"===buttonsJson,buttonsAreEmpty="{}"===buttonsJson||"[]"===buttonsJson||"null"===buttonsJson||"false"===buttonsJson,buttonsAreArray=!buttonsAreDefault&&function(obj){return obj&&obj.constructor===Array}(this.options.buttons),buttonsAreObject=!buttonsAreDefault&&function(obj){return obj&&obj.constructor===Object}(this.options.buttons);buttonsAreDefault?this.options.buttons=[{text:"Next",action:this.tour.next,classes:"btn"}]:!buttonsAreEmpty&&buttonsAreObject?this.options.buttons=[this.options.buttons]:!buttonsAreEmpty&&buttonsAreArray||(this.options.buttons=!1)}},{key:"getTour",value:function(){return this.tour}},{key:"bindAdvance",value:function(){var _this2=this,_parseShorthand=function(obj,props){if(null===obj||isUndefined(obj))return obj;if(isObjectLoose(obj))return obj;for(var vals=obj.split(" "),out={},j=props.length-1,i=vals.length-1;0<=i;i--){if(0===j){out[props[j]]=vals.slice(0,i+1).join(" ");break}out[props[j]]=vals[i],j--}return out}(this.options.advanceOn,["selector","event"]),event=_parseShorthand.event,selector=_parseShorthand.selector,handler=function(e){_this2.isOpen()&&(isUndefined(selector)?_this2.el&&e.target===_this2.el&&_this2.tour.next():function(el,sel){var matches=void 0;return isUndefined(el.matches)?isUndefined(el.matchesSelector)?isUndefined(el.msMatchesSelector)?isUndefined(el.webkitMatchesSelector)?isUndefined(el.mozMatchesSelector)?isUndefined(el.oMatchesSelector)||(matches=el.oMatchesSelector):matches=el.mozMatchesSelector:matches=el.webkitMatchesSelector:matches=el.msMatchesSelector:matches=el.matchesSelector:matches=el.matches,matches.call(el,sel)}(e.target,selector)&&_this2.tour.next())};document.body.addEventListener(event,handler),this.on("destroy",function(){return document.body.removeEventListener(event,handler)})}},{key:"getAttachTo",value:function(){var opts=function(str){if(isObjectLoose(str))return str.hasOwnProperty("element")&&str.hasOwnProperty("on")?str:null;var matches=positionRe.exec(str);if(!matches)return null;var on=matches[2];return"["===on[0]&&(on=on.substring(1,on.length-1)),{element:matches[1],on:on}}(this.options.attachTo)||{},returnOpts=extend({},opts);return"string"==typeof opts.element&&(returnOpts.element=document.querySelector(opts.element),returnOpts.element||console.error("The element for this Shepherd step was not found "+opts.element)),returnOpts}},{key:"setupTether",value:function(){if(isUndefined(Tether))throw new Error("Using the attachment feature of Shepherd requires the Tether library");var opts=this.getAttachTo(),attachment=ATTACHMENT[opts.on]||ATTACHMENT.right;isUndefined(opts.element)&&(opts.element="viewport",attachment="middle center");var tetherOpts={classPrefix:"shepherd",element:this.el,constraints:[{to:"window",pin:!0,attachment:"together"}],target:opts.element,offset:opts.offset||"0 0",attachment:attachment};this.tether&&this.tether.destroy(),this.tether=new Tether(extend(tetherOpts,this.options.tetherOptions))}},{key:"show",value:function(){var _this3=this;if(!isUndefined(this.options.beforeShowPromise)){var beforeShowPromise=this.options.beforeShowPromise();if(!isUndefined(beforeShowPromise))return beforeShowPromise.then(function(){return _this3._show()})}this._show()}},{key:"_show",value:function(){var _this4=this;this.trigger("before-show"),this.el||this.render(),addClass(this.el,"shepherd-open"),document.body.setAttribute("data-shepherd-step",this.id),this.setupTether(),this.options.scrollTo&&setTimeout(function(){_this4.scrollTo()}),this.trigger("show")}},{key:"hide",value:function(){this.trigger("before-hide"),removeClass(this.el,"shepherd-open"),document.body.removeAttribute("data-shepherd-step"),this.tether&&this.tether.destroy(),this.tether=null,this.trigger("hide")}},{key:"isOpen",value:function(){return this.el&&hasClass(this.el,"shepherd-open")}},{key:"cancel",value:function(){this.tour.cancel(),this.trigger("cancel")}},{key:"complete",value:function(){this.tour.complete(),this.trigger("complete")}},{key:"scrollTo",value:function(){var element=this.getAttachTo().element;isUndefined(this.options.scrollToHandler)?isUndefined(element)||element.scrollIntoView():this.options.scrollToHandler(element)}},{key:"destroy",value:function(){!isUndefined(this.el)&&this.el.parentNode&&(this.el.parentNode.removeChild(this.el),delete this.el),this.tether&&this.tether.destroy(),this.tether=null,this.trigger("destroy")}},{key:"render",value:function(){var _this5=this;isUndefined(this.el)||this.destroy(),this.el=createFromHTML("<div class='shepherd-step "+(this.options.classes||"")+"' data-id='"+this.id+"' "+(this.options.idAttribute?'id="'+this.options.idAttribute+'"':"")+"></div>");var content=document.createElement("div");content.className="shepherd-content",this.el.appendChild(content);var text,paragraphs,footer,buttons,header=document.createElement("header");if(content.appendChild(header),this.options.title&&(header.innerHTML+="<h3 class='shepherd-title'>"+this.options.title+"</h3>",this.el.className+=" shepherd-has-title"),this.options.showCancelLink){var link=createFromHTML("<a href class='shepherd-cancel-link'></a>");header.appendChild(link),this.el.className+=" shepherd-has-cancel-link",this.bindCancelLink(link)}isUndefined(this.options.text)||(text=createFromHTML("<div class='shepherd-text'></div>"),"function"==typeof(paragraphs=_this5.options.text)&&(paragraphs=paragraphs.call(_this5,text)),paragraphs instanceof HTMLElement?text.appendChild(paragraphs):("string"==typeof paragraphs&&(paragraphs=[paragraphs]),paragraphs.map(function(paragraph){text.innerHTML+="<p>"+paragraph+"</p>"})),content.appendChild(text)),this.options.buttons&&(footer=document.createElement("footer"),buttons=createFromHTML("<ul class='shepherd-buttons'></ul>"),_this5.options.buttons.map(function(cfg){var button=createFromHTML("<li><a class='shepherd-button "+(cfg.classes||"")+"'>"+cfg.text+"</a>");buttons.appendChild(button),_this5.bindButtonEvents(cfg,button.querySelector("a"))}),footer.appendChild(buttons),content.appendChild(footer)),document.body.appendChild(this.el),this.setupTether(),this.options.advanceOn&&this.bindAdvance()}},{key:"bindCancelLink",value:function(link){var _this6=this;link.addEventListener("click",function(e){e.preventDefault(),_this6.cancel()})}},{key:"bindButtonEvents",value:function(cfg,el){var _this7=this;for(var _event2 in cfg.events=cfg.events||{},isUndefined(cfg.action)||(cfg.events.click=cfg.action),cfg.events)if({}.hasOwnProperty.call(cfg.events,_event2)){var handler=cfg.events[_event2];"string"==typeof handler&&function(){var page=handler;handler=function(){return _this7.tour.show(page)}}(),el.addEventListener(_event2,handler)}this.on("destroy",function(){for(var _event3 in cfg.events)if({}.hasOwnProperty.call(cfg.events,_event3)){var handler=cfg.events[_event3];el.removeEventListener(_event3,handler)}})}}]),Step}(),Tour=function(){function Tour(){var _this8=this,options=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];_classCallCheck(this,Tour),_get(Object.getPrototypeOf(Tour.prototype),"constructor",this).call(this,options),this.bindMethods(),this.options=options,this.steps=this.options.steps||[];return["complete","cancel","hide","start","show","active","inactive"].map(function(event){var e;e=event,_this8.on(e,function(opts){(opts=opts||{}).tour=_this8,Shepherd.trigger(e,opts)})}),this}return _inherits(Tour,Evented),_createClass(Tour,[{key:"bindMethods",value:function(){var _this9=this;["next","back","cancel","complete","hide"].map(function(method){_this9[method]=_this9[method].bind(_this9)})}},{key:"addStep",value:function(name,step){return isUndefined(step)&&(step=name),step instanceof Step?step.tour=this:("string"!=typeof name&&"number"!=typeof name||(step.id=name.toString()),step=extend({},this.options.defaults,step),step=new Step(this,step)),this.steps.push(step),this}},{key:"removeStep",value:function(name){for(var current=this.getCurrentStep(),i=0;i<this.steps.length;++i){var step=this.steps[i];if(step.id===name){step.isOpen()&&step.hide(),step.destroy(),this.steps.splice(i,1);break}}current&&current.id===name&&(this.currentStep=void 0,this.steps.length?this.show(0):this.hide())}},{key:"getById",value:function(id){for(var i=0;i<this.steps.length;++i){var step=this.steps[i];if(step.id===id)return step}}},{key:"getCurrentStep",value:function(){return this.currentStep}},{key:"next",value:function(){var index=this.steps.indexOf(this.currentStep);index===this.steps.length-1?(this.hide(index),this.trigger("complete"),this.done()):this.show(index+1,!0)}},{key:"back",value:function(){var index=this.steps.indexOf(this.currentStep);this.show(index-1,!1)}},{key:"cancel",value:function(){this.currentStep&&this.currentStep.hide(),this.trigger("cancel"),this.done()}},{key:"complete",value:function(){this.currentStep&&this.currentStep.hide(),this.trigger("complete"),this.done()}},{key:"hide",value:function(){this.currentStep&&this.currentStep.hide(),this.trigger("hide"),this.done()}},{key:"done",value:function(){Shepherd.activeTour=null,removeClass(document.body,"shepherd-active"),this.trigger("inactive",{tour:this})}},{key:"show",value:function(argument_0,argument_1){var key=arguments.length<=0||void 0===argument_0?0:argument_0,forward=arguments.length<=1||void 0===argument_1||argument_1;this.currentStep?this.currentStep.hide():(addClass(document.body,"shepherd-active"),this.trigger("active",{tour:this})),Shepherd.activeTour=this;var next=void 0;if(next="string"==typeof key?this.getById(key):this.steps[key])if(isUndefined(next.options.showOn)||next.options.showOn())this.trigger("show",{step:next,previous:this.currentStep}),this.currentStep&&this.currentStep.hide(),(this.currentStep=next).show();else{var index=this.steps.indexOf(next),nextIndex=forward?index+1:index-1;this.show(nextIndex,forward)}}},{key:"start",value:function(){this.trigger("start"),this.currentStep=null,this.next()}}]),Tour}();return extend(Shepherd,{Tour:Tour,Step:Step,Evented:Evented}),Shepherd}),function(factory){"use strict";"function"==typeof define&&define.amd?define(["jquery"],function($){return factory($,window,document)}):"object"==typeof exports?module.exports=function(root,$){return root=root||window,$=$||("undefined"!=typeof window?require("jquery"):require("jquery")(root)),factory($,root,root.document)}:factory(jQuery,window,document)}(function($,window,document,undefined){"use strict";function _empty(d){return!d||!0===d||"-"===d}function _intVal(s){var integer=parseInt(s,10);return!isNaN(integer)&&isFinite(s)?integer:null}function _numToDecimal(num,decimalPoint){return _re_dic[decimalPoint]||(_re_dic[decimalPoint]=new RegExp(_fnEscapeRegex(decimalPoint),"g")),"string"==typeof num&&"."!==decimalPoint?num.replace(/\./g,"").replace(_re_dic[decimalPoint],"."):num}function _isNumber(d,decimalPoint,formatted){var strType="string"==typeof d;return!!_empty(d)||(decimalPoint&&strType&&(d=_numToDecimal(d,decimalPoint)),formatted&&strType&&(d=d.replace(_re_formatted_numeric,"")),!isNaN(parseFloat(d))&&isFinite(d))}function _htmlNumeric(d,decimalPoint,formatted){return!!_empty(d)||(function(d){return _empty(d)||"string"==typeof d}(d)&&!!_isNumber(_stripHtml(d),decimalPoint,formatted)||null)}function _pluck_order(a,order,prop,prop2){var out=[],i=0,ien=order.length;if(prop2!==undefined)for(;i<ien;i++)a[order[i]][prop]&&out.push(a[order[i]][prop][prop2]);else for(;i<ien;i++)out.push(a[order[i]][prop]);return out}function _range(len,start){var end,out=[];start===undefined?(start=0,end=len):(end=start,start=len);for(var i=start;i<end;i++)out.push(i);return out}function _removeEmpty(a){for(var out=[],i=0,ien=a.length;i<ien;i++)a[i]&&out.push(a[i]);return out}var _ext,_Api,_api_register,_api_registerPlural,DataTable=function(options){this.$=function(sSelector,oOpts){return this.api(!0).$(sSelector,oOpts)},this._=function(sSelector,oOpts){return this.api(!0).rows(sSelector,oOpts).data()},this.api=function(traditional){return new _Api(traditional?_fnSettingsFromNode(this[_ext.iApiIndex]):this)},this.fnAddData=function(data,redraw){var api=this.api(!0),rows=$.isArray(data)&&($.isArray(data[0])||$.isPlainObject(data[0]))?api.rows.add(data):api.row.add(data);return redraw!==undefined&&!redraw||api.draw(),rows.flatten().toArray()},this.fnAdjustColumnSizing=function(bRedraw){var api=this.api(!0).columns.adjust(),settings=api.settings()[0],scroll=settings.oScroll;bRedraw===undefined||bRedraw?api.draw(!1):""===scroll.sX&&""===scroll.sY||_fnScrollDraw(settings)},this.fnClearTable=function(bRedraw){var api=this.api(!0).clear();bRedraw!==undefined&&!bRedraw||api.draw()},this.fnClose=function(nTr){this.api(!0).row(nTr).child.hide()},this.fnDeleteRow=function(target,callback,redraw){var api=this.api(!0),rows=api.rows(target),settings=rows.settings()[0],data=settings.aoData[rows[0][0]];return rows.remove(),callback&&callback.call(this,settings,data),redraw!==undefined&&!redraw||api.draw(),data},this.fnDestroy=function(remove){this.api(!0).destroy(remove)},this.fnDraw=function(complete){this.api(!0).draw(complete)},this.fnFilter=function(sInput,iColumn,bRegex,bSmart,bShowGlobal,bCaseInsensitive){var api=this.api(!0);null===iColumn||iColumn===undefined?api.search(sInput,bRegex,bSmart,bCaseInsensitive):api.column(iColumn).search(sInput,bRegex,bSmart,bCaseInsensitive),api.draw()},this.fnGetData=function(src,col){var api=this.api(!0);if(src===undefined)return api.data().toArray();var type=src.nodeName?src.nodeName.toLowerCase():"";return col!==undefined||"td"==type||"th"==type?api.cell(src,col).data():api.row(src).data()||null},this.fnGetNodes=function(iRow){var api=this.api(!0);return iRow!==undefined?api.row(iRow).node():api.rows().nodes().flatten().toArray()},this.fnGetPosition=function(node){var api=this.api(!0),nodeName=node.nodeName.toUpperCase();if("TR"==nodeName)return api.row(node).index();if("TD"!=nodeName&&"TH"!=nodeName)return null;var cell=api.cell(node).index();return[cell.row,cell.columnVisible,cell.column]},this.fnIsOpen=function(nTr){return this.api(!0).row(nTr).child.isShown()},this.fnOpen=function(nTr,mHtml,sClass){return this.api(!0).row(nTr).child(mHtml,sClass).show().child()[0]},this.fnPageChange=function(mAction,bRedraw){var api=this.api(!0).page(mAction);bRedraw!==undefined&&!bRedraw||api.draw(!1)},this.fnSetColumnVis=function(iCol,bShow,bRedraw){var api=this.api(!0).column(iCol).visible(bShow);bRedraw!==undefined&&!bRedraw||api.columns.adjust().draw()},this.fnSettings=function(){return _fnSettingsFromNode(this[_ext.iApiIndex])},this.fnSort=function(aaSort){this.api(!0).order(aaSort).draw()},this.fnSortListener=function(nNode,iColumn,fnCallback){this.api(!0).order.listener(nNode,iColumn,fnCallback)},this.fnUpdate=function(mData,mRow,iColumn,bRedraw,bAction){var api=this.api(!0);return iColumn===undefined||null===iColumn?api.row(mRow).data(mData):api.cell(mRow,iColumn).data(mData),bAction!==undefined&&!bAction||api.columns.adjust(),bRedraw!==undefined&&!bRedraw||api.draw(),0},this.fnVersionCheck=_ext.fnVersionCheck;var _that=this,emptyInit=options===undefined,len=this.length;for(var fn in emptyInit&&(options={}),this.oApi=this.internal=_ext.internal,DataTable.ext.internal)fn&&(this[fn]=_fnExternApiFunc(fn));return this.each(function(){var iLen,oInit=1<len?_fnExtend({},options,!0):options,i=0,sId=this.getAttribute("id"),bInitHandedOff=!1,defaults=DataTable.defaults,$this=$(this);if("table"==this.nodeName.toLowerCase()){_fnCompatOpts(defaults),_fnCompatCols(defaults.column),_fnCamelToHungarian(defaults,defaults,!0),_fnCamelToHungarian(defaults.column,defaults.column,!0),_fnCamelToHungarian(defaults,$.extend(oInit,$this.data()),!0);var allSettings=DataTable.settings;for(i=0,iLen=allSettings.length;i<iLen;i++){var s=allSettings[i];if(s.nTable==this||s.nTHead&&s.nTHead.parentNode==this||s.nTFoot&&s.nTFoot.parentNode==this){var bRetrieve=oInit.bRetrieve!==undefined?oInit.bRetrieve:defaults.bRetrieve,bDestroy=oInit.bDestroy!==undefined?oInit.bDestroy:defaults.bDestroy;if(emptyInit||bRetrieve)return s.oInstance;if(bDestroy){s.oInstance.fnDestroy();break}return void _fnLog(s,0,"Cannot reinitialise DataTable",3)}if(s.sTableId==this.id){allSettings.splice(i,1);break}}null!==sId&&""!==sId||(sId="DataTables_Table_"+DataTable.ext._unique++,this.id=sId);var oSettings=$.extend(!0,{},DataTable.models.oSettings,{sDestroyWidth:$this[0].style.width,sInstance:sId,sTableId:sId});oSettings.nTable=this,oSettings.oApi=_that.internal,oSettings.oInit=oInit,allSettings.push(oSettings),oSettings.oInstance=1===_that.length?_that:$this.dataTable(),_fnCompatOpts(oInit),_fnLanguageCompat(oInit.oLanguage),oInit.aLengthMenu&&!oInit.iDisplayLength&&(oInit.iDisplayLength=$.isArray(oInit.aLengthMenu[0])?oInit.aLengthMenu[0][0]:oInit.aLengthMenu[0]),oInit=_fnExtend($.extend(!0,{},defaults),oInit),_fnMap(oSettings.oFeatures,oInit,["bPaginate","bLengthChange","bFilter","bSort","bSortMulti","bInfo","bProcessing","bAutoWidth","bSortClasses","bServerSide","bDeferRender"]),_fnMap(oSettings,oInit,["asStripeClasses","ajax","fnServerData","fnFormatNumber","sServerMethod","aaSorting","aaSortingFixed","aLengthMenu","sPaginationType","sAjaxSource","sAjaxDataProp","iStateDuration","sDom","bSortCellsTop","iTabIndex","fnStateLoadCallback","fnStateSaveCallback","renderer","searchDelay","rowId",["iCookieDuration","iStateDuration"],["oSearch","oPreviousSearch"],["aoSearchCols","aoPreSearchCols"],["iDisplayLength","_iDisplayLength"]]),_fnMap(oSettings.oScroll,oInit,[["sScrollX","sX"],["sScrollXInner","sXInner"],["sScrollY","sY"],["bScrollCollapse","bCollapse"]]),_fnMap(oSettings.oLanguage,oInit,"fnInfoCallback"),_fnCallbackReg(oSettings,"aoDrawCallback",oInit.fnDrawCallback,"user"),_fnCallbackReg(oSettings,"aoServerParams",oInit.fnServerParams,"user"),_fnCallbackReg(oSettings,"aoStateSaveParams",oInit.fnStateSaveParams,"user"),_fnCallbackReg(oSettings,"aoStateLoadParams",oInit.fnStateLoadParams,"user"),_fnCallbackReg(oSettings,"aoStateLoaded",oInit.fnStateLoaded,"user"),_fnCallbackReg(oSettings,"aoRowCallback",oInit.fnRowCallback,"user"),_fnCallbackReg(oSettings,"aoRowCreatedCallback",oInit.fnCreatedRow,"user"),_fnCallbackReg(oSettings,"aoHeaderCallback",oInit.fnHeaderCallback,"user"),_fnCallbackReg(oSettings,"aoFooterCallback",oInit.fnFooterCallback,"user"),_fnCallbackReg(oSettings,"aoInitComplete",oInit.fnInitComplete,"user"),_fnCallbackReg(oSettings,"aoPreDrawCallback",oInit.fnPreDrawCallback,"user"),oSettings.rowIdFn=_fnGetObjectDataFn(oInit.rowId),_fnBrowserDetect(oSettings);var oClasses=oSettings.oClasses;if($.extend(oClasses,DataTable.ext.classes,oInit.oClasses),$this.addClass(oClasses.sTable),oSettings.iInitDisplayStart===undefined&&(oSettings.iInitDisplayStart=oInit.iDisplayStart,oSettings._iDisplayStart=oInit.iDisplayStart),null!==oInit.iDeferLoading){oSettings.bDeferLoading=!0;var tmp=$.isArray(oInit.iDeferLoading);oSettings._iRecordsDisplay=tmp?oInit.iDeferLoading[0]:oInit.iDeferLoading,oSettings._iRecordsTotal=tmp?oInit.iDeferLoading[1]:oInit.iDeferLoading}var oLanguage=oSettings.oLanguage;$.extend(!0,oLanguage,oInit.oLanguage),oLanguage.sUrl&&($.ajax({dataType:"json",url:oLanguage.sUrl,success:function(json){_fnLanguageCompat(json),_fnCamelToHungarian(defaults.oLanguage,json),$.extend(!0,oLanguage,json),_fnInitialise(oSettings)},error:function(){_fnInitialise(oSettings)}}),bInitHandedOff=!0),null===oInit.asStripeClasses&&(oSettings.asStripeClasses=[oClasses.sStripeOdd,oClasses.sStripeEven]);var stripeClasses=oSettings.asStripeClasses,rowOne=$this.children("tbody").find("tr").eq(0);-1!==$.inArray(!0,$.map(stripeClasses,function(el,i){return rowOne.hasClass(el)}))&&($("tbody tr",this).removeClass(stripeClasses.join(" ")),oSettings.asDestroyStripes=stripeClasses.slice());var aoColumnsInit,anThs=[],nThead=this.getElementsByTagName("thead");if(0!==nThead.length&&(_fnDetectHeader(oSettings.aoHeader,nThead[0]),anThs=_fnGetUniqueThs(oSettings)),null===oInit.aoColumns)for(aoColumnsInit=[],i=0,iLen=anThs.length;i<iLen;i++)aoColumnsInit.push(null);else aoColumnsInit=oInit.aoColumns;for(i=0,iLen=aoColumnsInit.length;i<iLen;i++)_fnAddColumn(oSettings,anThs?anThs[i]:null);if(_fnApplyColumnDefs(oSettings,oInit.aoColumnDefs,aoColumnsInit,function(iCol,oDef){_fnColumnOptions(oSettings,iCol,oDef)}),rowOne.length){var a=function(cell,name){return null!==cell.getAttribute("data-"+name)?name:null};$(rowOne[0]).children("th, td").each(function(i,cell){var col=oSettings.aoColumns[i];if(col.mData===i){var sort=a(cell,"sort")||a(cell,"order"),filter=a(cell,"filter")||a(cell,"search");null===sort&&null===filter||(col.mData={_:i+".display",sort:null!==sort?i+".@data-"+sort:undefined,type:null!==sort?i+".@data-"+sort:undefined,filter:null!==filter?i+".@data-"+filter:undefined},_fnColumnOptions(oSettings,i))}})}var features=oSettings.oFeatures,loadedInit=function(){if(oInit.aaSorting===undefined){var sorting=oSettings.aaSorting;for(i=0,iLen=sorting.length;i<iLen;i++)sorting[i][1]=oSettings.aoColumns[i].asSorting[0]}_fnSortingClasses(oSettings),features.bSort&&_fnCallbackReg(oSettings,"aoDrawCallback",function(){if(oSettings.bSorted){var aSort=_fnSortFlatten(oSettings),sortedColumns={};$.each(aSort,function(i,val){sortedColumns[val.src]=val.dir}),_fnCallbackFire(oSettings,null,"order",[oSettings,aSort,sortedColumns]),_fnSortAria(oSettings)}}),_fnCallbackReg(oSettings,"aoDrawCallback",function(){(oSettings.bSorted||"ssp"===_fnDataSource(oSettings)||features.bDeferRender)&&_fnSortingClasses(oSettings)},"sc");var captions=$this.children("caption").each(function(){this._captionSide=$(this).css("caption-side")}),thead=$this.children("thead");0===thead.length&&(thead=$("<thead/>").appendTo($this)),oSettings.nTHead=thead[0];var tbody=$this.children("tbody");0===tbody.length&&(tbody=$("<tbody/>").appendTo($this)),oSettings.nTBody=tbody[0];var tfoot=$this.children("tfoot");if(0===tfoot.length&&0<captions.length&&(""!==oSettings.oScroll.sX||""!==oSettings.oScroll.sY)&&(tfoot=$("<tfoot/>").appendTo($this)),0===tfoot.length||0===tfoot.children().length?$this.addClass(oClasses.sNoFooter):0<tfoot.length&&(oSettings.nTFoot=tfoot[0],_fnDetectHeader(oSettings.aoFooter,oSettings.nTFoot)),oInit.aaData)for(i=0;i<oInit.aaData.length;i++)_fnAddData(oSettings,oInit.aaData[i]);else!oSettings.bDeferLoading&&"dom"!=_fnDataSource(oSettings)||_fnAddTr(oSettings,$(oSettings.nTBody).children("tr"));oSettings.aiDisplay=oSettings.aiDisplayMaster.slice(),!(oSettings.bInitialised=!0)===bInitHandedOff&&_fnInitialise(oSettings)};oInit.bStateSave?(features.bStateSave=!0,_fnCallbackReg(oSettings,"aoDrawCallback",_fnSaveState,"state_save"),_fnLoadState(oSettings,oInit,loadedInit)):loadedInit()}else _fnLog(null,0,"Non-table node initialisation ("+this.nodeName+")",2)}),_that=null,this},_re_dic={},_re_new_lines=/[\r\n\u2028]/g,_re_html=/<.*?>/g,_re_date=/^\d{2,4}[\.\/\-]\d{1,2}[\.\/\-]\d{1,2}([T ]{1}\d{1,2}[:\.]\d{2}([\.:]\d{2})?)?$/,_re_escape_regex=new RegExp("(\\"+["/",".","*","+","?","|","(",")","[","]","{","}","\\","$","^","-"].join("|\\")+")","g"),_re_formatted_numeric=/[',$%\u2009\u202F\u20BD\u20a9\u20BArfk]/gi,_pluck=function(a,prop,prop2){var out=[],i=0,ien=a.length;if(prop2!==undefined)for(;i<ien;i++)a[i]&&a[i][prop]&&out.push(a[i][prop][prop2]);else for(;i<ien;i++)a[i]&&out.push(a[i][prop]);return out},_stripHtml=function(d){return d.replace(_re_html,"")},_unique=function(src){if(function(src){if(src.length<2)return!0;for(var sorted=src.slice().sort(),last=sorted[0],i=1,ien=sorted.length;i<ien;i++){if(sorted[i]===last)return!1;last=sorted[i]}return!0}(src))return src.slice();var val,i,j,out=[],ien=src.length,k=0;again:for(i=0;i<ien;i++){for(val=src[i],j=0;j<k;j++)if(out[j]===val)continue again;out.push(val),k++}return out};function _fnHungarianMap(o){var match,newKey,map={};$.each(o,function(key,val){(match=key.match(/^([^A-Z]+?)([A-Z])/))&&-1!=="a aa ai ao as b fn i m o s ".indexOf(match[1]+" ")&&(newKey=key.replace(match[0],match[2].toLowerCase()),map[newKey]=key,"o"===match[1]&&_fnHungarianMap(o[key]))}),o._hungarianMap=map}function _fnCamelToHungarian(src,user,force){var hungarianKey;src._hungarianMap||_fnHungarianMap(src),$.each(user,function(key,val){(hungarianKey=src._hungarianMap[key])===undefined||!force&&user[hungarianKey]!==undefined||("o"===hungarianKey.charAt(0)?(user[hungarianKey]||(user[hungarianKey]={}),$.extend(!0,user[hungarianKey],user[key]),_fnCamelToHungarian(src[hungarianKey],user[hungarianKey],force)):user[hungarianKey]=user[key])})}function _fnLanguageCompat(lang){var defaults=DataTable.defaults.oLanguage,defaultDecimal=defaults.sDecimal;if(defaultDecimal&&_addNumericSort(defaultDecimal),lang){var zeroRecords=lang.sZeroRecords;!lang.sEmptyTable&&zeroRecords&&"No data available in table"===defaults.sEmptyTable&&_fnMap(lang,lang,"sZeroRecords","sEmptyTable"),!lang.sLoadingRecords&&zeroRecords&&"Loading..."===defaults.sLoadingRecords&&_fnMap(lang,lang,"sZeroRecords","sLoadingRecords"),lang.sInfoThousands&&(lang.sThousands=lang.sInfoThousands);var decimal=lang.sDecimal;decimal&&defaultDecimal!==decimal&&_addNumericSort(decimal)}}DataTable.util={throttle:function(fn,freq){var last,timer,frequency=freq!==undefined?freq:200;return function(){var that=this,now=+new Date,args=arguments;last&&now<last+frequency?(clearTimeout(timer),timer=setTimeout(function(){last=undefined,fn.apply(that,args)},frequency)):(last=now,fn.apply(that,args))}},escapeRegex:function(val){return val.replace(_re_escape_regex,"\\$1")}};var _fnCompatMap=function(o,knew,old){o[knew]!==undefined&&(o[old]=o[knew])};function _fnCompatOpts(init){_fnCompatMap(init,"ordering","bSort"),_fnCompatMap(init,"orderMulti","bSortMulti"),_fnCompatMap(init,"orderClasses","bSortClasses"),_fnCompatMap(init,"orderCellsTop","bSortCellsTop"),_fnCompatMap(init,"order","aaSorting"),_fnCompatMap(init,"orderFixed","aaSortingFixed"),_fnCompatMap(init,"paging","bPaginate"),_fnCompatMap(init,"pagingType","sPaginationType"),_fnCompatMap(init,"pageLength","iDisplayLength"),_fnCompatMap(init,"searching","bFilter"),"boolean"==typeof init.sScrollX&&(init.sScrollX=init.sScrollX?"100%":""),"boolean"==typeof init.scrollX&&(init.scrollX=init.scrollX?"100%":"");var searchCols=init.aoSearchCols;if(searchCols)for(var i=0,ien=searchCols.length;i<ien;i++)searchCols[i]&&_fnCamelToHungarian(DataTable.models.oSearch,searchCols[i])}function _fnCompatCols(init){_fnCompatMap(init,"orderable","bSortable"),_fnCompatMap(init,"orderData","aDataSort"),_fnCompatMap(init,"orderSequence","asSorting"),_fnCompatMap(init,"orderDataType","sortDataType");var dataSort=init.aDataSort;"number"!=typeof dataSort||$.isArray(dataSort)||(init.aDataSort=[dataSort])}function _fnBrowserDetect(settings){if(!DataTable.__browser){var browser={};DataTable.__browser=browser;var n=$("<div/>").css({position:"fixed",top:0,left:-1*$(window).scrollLeft(),height:1,width:1,overflow:"hidden"}).append($("<div/>").css({position:"absolute",top:1,left:1,width:100,overflow:"scroll"}).append($("<div/>").css({width:"100%",height:10}))).appendTo("body"),outer=n.children(),inner=outer.children();browser.barWidth=outer[0].offsetWidth-outer[0].clientWidth,browser.bScrollOversize=100===inner[0].offsetWidth&&100!==outer[0].clientWidth,browser.bScrollbarLeft=1!==Math.round(inner.offset().left),browser.bBounding=!!n[0].getBoundingClientRect().width,n.remove()}$.extend(settings.oBrowser,DataTable.__browser),settings.oScroll.iBarWidth=DataTable.__browser.barWidth}function _fnReduce(that,fn,init,start,end,inc){var value,i=start,isSet=!1;for(init!==undefined&&(value=init,isSet=!0);i!==end;)that.hasOwnProperty(i)&&(value=isSet?fn(value,that[i],i,that):that[i],isSet=!0,i+=inc);return value}function _fnAddColumn(oSettings,nTh){var oDefaults=DataTable.defaults.column,iCol=oSettings.aoColumns.length,oCol=$.extend({},DataTable.models.oColumn,oDefaults,{nTh:nTh||document.createElement("th"),sTitle:oDefaults.sTitle?oDefaults.sTitle:nTh?nTh.innerHTML:"",aDataSort:oDefaults.aDataSort?oDefaults.aDataSort:[iCol],mData:oDefaults.mData?oDefaults.mData:iCol,idx:iCol});oSettings.aoColumns.push(oCol);var searchCols=oSettings.aoPreSearchCols;searchCols[iCol]=$.extend({},DataTable.models.oSearch,searchCols[iCol]),_fnColumnOptions(oSettings,iCol,$(nTh).data())}function _fnColumnOptions(oSettings,iCol,oOptions){var oCol=oSettings.aoColumns[iCol],oClasses=oSettings.oClasses,th=$(oCol.nTh);if(!oCol.sWidthOrig){oCol.sWidthOrig=th.attr("width")||null;var t=(th.attr("style")||"").match(/width:\s*(\d+[pxem%]+)/);t&&(oCol.sWidthOrig=t[1])}oOptions!==undefined&&null!==oOptions&&(_fnCompatCols(oOptions),_fnCamelToHungarian(DataTable.defaults.column,oOptions,!0),oOptions.mDataProp===undefined||oOptions.mData||(oOptions.mData=oOptions.mDataProp),oOptions.sType&&(oCol._sManualType=oOptions.sType),oOptions.className&&!oOptions.sClass&&(oOptions.sClass=oOptions.className),oOptions.sClass&&th.addClass(oOptions.sClass),$.extend(oCol,oOptions),_fnMap(oCol,oOptions,"sWidth","sWidthOrig"),oOptions.iDataSort!==undefined&&(oCol.aDataSort=[oOptions.iDataSort]),_fnMap(oCol,oOptions,"aDataSort"));function attrTest(src){return"string"==typeof src&&-1!==src.indexOf("@")}var mDataSrc=oCol.mData,mData=_fnGetObjectDataFn(mDataSrc),mRender=oCol.mRender?_fnGetObjectDataFn(oCol.mRender):null;oCol._bAttrSrc=$.isPlainObject(mDataSrc)&&(attrTest(mDataSrc.sort)||attrTest(mDataSrc.type)||attrTest(mDataSrc.filter)),oCol._setter=null,oCol.fnGetData=function(rowData,type,meta){var innerData=mData(rowData,type,undefined,meta);return mRender&&type?mRender(innerData,type,rowData,meta):innerData},oCol.fnSetData=function(rowData,val,meta){return _fnSetObjectDataFn(mDataSrc)(rowData,val,meta)},"number"!=typeof mDataSrc&&(oSettings._rowReadObject=!0),oSettings.oFeatures.bSort||(oCol.bSortable=!1,th.addClass(oClasses.sSortableNone));var bAsc=-1!==$.inArray("asc",oCol.asSorting),bDesc=-1!==$.inArray("desc",oCol.asSorting);oCol.bSortable&&(bAsc||bDesc)?bAsc&&!bDesc?(oCol.sSortingClass=oClasses.sSortableAsc,oCol.sSortingClassJUI=oClasses.sSortJUIAscAllowed):!bAsc&&bDesc?(oCol.sSortingClass=oClasses.sSortableDesc,oCol.sSortingClassJUI=oClasses.sSortJUIDescAllowed):(oCol.sSortingClass=oClasses.sSortable,oCol.sSortingClassJUI=oClasses.sSortJUI):(oCol.sSortingClass=oClasses.sSortableNone,oCol.sSortingClassJUI="")}function _fnAdjustColumnSizing(settings){if(!1!==settings.oFeatures.bAutoWidth){var columns=settings.aoColumns;_fnCalculateColumnWidths(settings);for(var i=0,iLen=columns.length;i<iLen;i++)columns[i].nTh.style.width=columns[i].sWidth}var scroll=settings.oScroll;""===scroll.sY&&""===scroll.sX||_fnScrollDraw(settings),_fnCallbackFire(settings,null,"column-sizing",[settings])}function _fnVisibleToColumnIndex(oSettings,iMatch){var aiVis=_fnGetColumns(oSettings,"bVisible");return"number"==typeof aiVis[iMatch]?aiVis[iMatch]:null}function _fnColumnIndexToVisible(oSettings,iMatch){var aiVis=_fnGetColumns(oSettings,"bVisible"),iPos=$.inArray(iMatch,aiVis);return-1!==iPos?iPos:null}function _fnVisbleColumns(oSettings){var vis=0;return $.each(oSettings.aoColumns,function(i,col){col.bVisible&&"none"!==$(col.nTh).css("display")&&vis++}),vis}function _fnGetColumns(oSettings,sParam){var a=[];return $.map(oSettings.aoColumns,function(val,i){val[sParam]&&a.push(i)}),a}function _fnColumnTypes(settings){var i,ien,j,jen,k,ken,col,detectedType,cache,columns=settings.aoColumns,data=settings.aoData,types=DataTable.ext.type.detect;for(i=0,ien=columns.length;i<ien;i++)if(cache=[],!(col=columns[i]).sType&&col._sManualType)col.sType=col._sManualType;else if(!col.sType){for(j=0,jen=types.length;j<jen;j++){for(k=0,ken=data.length;k<ken&&(cache[k]===undefined&&(cache[k]=_fnGetCellData(settings,k,i,"type")),(detectedType=types[j](cache[k],settings))||j===types.length-1)&&"html"!==detectedType;k++);if(detectedType){col.sType=detectedType;break}}col.sType||(col.sType="string")}}function _fnApplyColumnDefs(oSettings,aoColDefs,aoCols,fn){var i,iLen,j,jLen,k,kLen,def,columns=oSettings.aoColumns;if(aoColDefs)for(i=aoColDefs.length-1;0<=i;i--){var aTargets=(def=aoColDefs[i]).targets!==undefined?def.targets:def.aTargets;for($.isArray(aTargets)||(aTargets=[aTargets]),j=0,jLen=aTargets.length;j<jLen;j++)if("number"==typeof aTargets[j]&&0<=aTargets[j]){for(;columns.length<=aTargets[j];)_fnAddColumn(oSettings);fn(aTargets[j],def)}else if("number"==typeof aTargets[j]&&aTargets[j]<0)fn(columns.length+aTargets[j],def);else if("string"==typeof aTargets[j])for(k=0,kLen=columns.length;k<kLen;k++)"_all"!=aTargets[j]&&!$(columns[k].nTh).hasClass(aTargets[j])||fn(k,def)}if(aoCols)for(i=0,iLen=aoCols.length;i<iLen;i++)fn(i,aoCols[i])}function _fnAddData(oSettings,aDataIn,nTr,anTds){var iRow=oSettings.aoData.length,oData=$.extend(!0,{},DataTable.models.oRow,{src:nTr?"dom":"data",idx:iRow});oData._aData=aDataIn,oSettings.aoData.push(oData);for(var columns=oSettings.aoColumns,i=0,iLen=columns.length;i<iLen;i++)columns[i].sType=null;oSettings.aiDisplayMaster.push(iRow);var id=oSettings.rowIdFn(aDataIn);return id!==undefined&&(oSettings.aIds[id]=oData),!nTr&&oSettings.oFeatures.bDeferRender||_fnCreateTr(oSettings,iRow,nTr,anTds),iRow}function _fnAddTr(settings,trs){var row;return trs instanceof $||(trs=$(trs)),trs.map(function(i,el){return row=_fnGetRowElements(settings,el),_fnAddData(settings,row.data,el,row.cells)})}function _fnGetCellData(settings,rowIdx,colIdx,type){var draw=settings.iDraw,col=settings.aoColumns[colIdx],rowData=settings.aoData[rowIdx]._aData,defaultContent=col.sDefaultContent,cellData=col.fnGetData(rowData,type,{settings:settings,row:rowIdx,col:colIdx});if(cellData===undefined)return settings.iDrawError!=draw&&null===defaultContent&&(_fnLog(settings,0,"Requested unknown parameter "+("function"==typeof col.mData?"{function}":"'"+col.mData+"'")+" for row "+rowIdx+", column "+colIdx,4),settings.iDrawError=draw),defaultContent;if(cellData!==rowData&&null!==cellData||null===defaultContent||type===undefined){if("function"==typeof cellData)return cellData.call(rowData)}else cellData=defaultContent;return null===cellData&&"display"==type?"":cellData}function _fnSetCellData(settings,rowIdx,colIdx,val){var col=settings.aoColumns[colIdx],rowData=settings.aoData[rowIdx]._aData;col.fnSetData(rowData,val,{settings:settings,row:rowIdx,col:colIdx})}var __reArray=/\[.*?\]$/,__reFn=/\(\)$/;function _fnSplitObjNotation(str){return $.map(str.match(/(\\.|[^\.])+/g)||[""],function(s){return s.replace(/\\\./g,".")})}function _fnGetObjectDataFn(mSource){if($.isPlainObject(mSource)){var o={};return $.each(mSource,function(key,val){val&&(o[key]=_fnGetObjectDataFn(val))}),function(data,type,row,meta){var t=o[type]||o._;return t!==undefined?t(data,type,row,meta):data}}if(null===mSource)return function(data){return data};if("function"==typeof mSource)return function(data,type,row,meta){return mSource(data,type,row,meta)};if("string"!=typeof mSource||-1===mSource.indexOf(".")&&-1===mSource.indexOf("[")&&-1===mSource.indexOf("("))return function(data,type){return data[mSource]};var fetchData=function(data,type,src){var arrayNotation,funcNotation,out,innerSrc;if(""!==src)for(var a=_fnSplitObjNotation(src),i=0,iLen=a.length;i<iLen;i++){if(arrayNotation=a[i].match(__reArray),funcNotation=a[i].match(__reFn),arrayNotation){if(a[i]=a[i].replace(__reArray,""),""!==a[i]&&(data=data[a[i]]),out=[],a.splice(0,i+1),innerSrc=a.join("."),$.isArray(data))for(var j=0,jLen=data.length;j<jLen;j++)out.push(fetchData(data[j],type,innerSrc));var join=arrayNotation[0].substring(1,arrayNotation[0].length-1);data=""===join?out:out.join(join);break}if(funcNotation)a[i]=a[i].replace(__reFn,""),data=data[a[i]]();else{if(null===data||data[a[i]]===undefined)return undefined;data=data[a[i]]}}return data};return function(data,type){return fetchData(data,type,mSource)}}function _fnSetObjectDataFn(mSource){if($.isPlainObject(mSource))return _fnSetObjectDataFn(mSource._);if(null===mSource)return function(){};if("function"==typeof mSource)return function(data,val,meta){mSource(data,"set",val,meta)};if("string"!=typeof mSource||-1===mSource.indexOf(".")&&-1===mSource.indexOf("[")&&-1===mSource.indexOf("("))return function(data,val){data[mSource]=val};var setData=function(data,val,src){for(var b,arrayNotation,funcNotation,o,innerSrc,a=_fnSplitObjNotation(src),aLast=a[a.length-1],i=0,iLen=a.length-1;i<iLen;i++){if(arrayNotation=a[i].match(__reArray),funcNotation=a[i].match(__reFn),arrayNotation){if(a[i]=a[i].replace(__reArray,""),data[a[i]]=[],(b=a.slice()).splice(0,i+1),innerSrc=b.join("."),$.isArray(val))for(var j=0,jLen=val.length;j<jLen;j++)setData(o={},val[j],innerSrc),data[a[i]].push(o);else data[a[i]]=val;return}funcNotation&&(a[i]=a[i].replace(__reFn,""),data=data[a[i]](val)),null!==data[a[i]]&&data[a[i]]!==undefined||(data[a[i]]={}),data=data[a[i]]}aLast.match(__reFn)?data=data[aLast.replace(__reFn,"")](val):data[aLast.replace(__reArray,"")]=val};return function(data,val){return setData(data,val,mSource)}}function _fnGetDataMaster(settings){return _pluck(settings.aoData,"_aData")}function _fnClearTable(settings){settings.aoData.length=0,settings.aiDisplayMaster.length=0,settings.aiDisplay.length=0,settings.aIds={}}function _fnDeleteIndex(a,iTarget,splice){for(var iTargetIndex=-1,i=0,iLen=a.length;i<iLen;i++)a[i]==iTarget?iTargetIndex=i:a[i]>iTarget&&a[i]--;-1!=iTargetIndex&&splice===undefined&&a.splice(iTargetIndex,1)}function _fnInvalidate(settings,rowIdx,src,colIdx){function cellWrite(cell,col){for(;cell.childNodes.length;)cell.removeChild(cell.firstChild);cell.innerHTML=_fnGetCellData(settings,rowIdx,col,"display")}var i,ien,row=settings.aoData[rowIdx];if("dom"!==src&&(src&&"auto"!==src||"dom"!==row.src)){var cells=row.anCells;if(cells)if(colIdx!==undefined)cellWrite(cells[colIdx],colIdx);else for(i=0,ien=cells.length;i<ien;i++)cellWrite(cells[i],i)}else row._aData=_fnGetRowElements(settings,row,colIdx,colIdx===undefined?undefined:row._aData).data;row._aSortData=null,row._aFilterData=null;var cols=settings.aoColumns;if(colIdx!==undefined)cols[colIdx].sType=null;else{for(i=0,ien=cols.length;i<ien;i++)cols[i].sType=null;_fnRowAttributes(settings,row)}}function _fnGetRowElements(settings,row,colIdx,d){var name,col,contents,tds=[],td=row.firstChild,i=0,columns=settings.aoColumns,objectRead=settings._rowReadObject;d=d!==undefined?d:objectRead?{}:[];function cellProcess(cell){colIdx!==undefined&&colIdx!==i||(col=columns[i],contents=$.trim(cell.innerHTML),col&&col._bAttrSrc?(_fnSetObjectDataFn(col.mData._)(d,contents),attr(col.mData.sort,cell),attr(col.mData.type,cell),attr(col.mData.filter,cell)):objectRead?(col._setter||(col._setter=_fnSetObjectDataFn(col.mData)),col._setter(d,contents)):d[i]=contents),i++}var attr=function(str,td){if("string"==typeof str){var idx=str.indexOf("@");if(-1!==idx){var attr=str.substring(idx+1);_fnSetObjectDataFn(str)(d,td.getAttribute(attr))}}};if(td)for(;td;)"TD"!=(name=td.nodeName.toUpperCase())&&"TH"!=name||(cellProcess(td),tds.push(td)),td=td.nextSibling;else for(var j=0,jen=(tds=row.anCells).length;j<jen;j++)cellProcess(tds[j]);var rowNode=row.firstChild?row:row.nTr;if(rowNode){var id=rowNode.getAttribute("id");id&&_fnSetObjectDataFn(settings.rowId)(d,id)}return{data:d,cells:tds}}function _fnCreateTr(oSettings,iRow,nTrIn,anTds){var nTr,nTd,oCol,i,iLen,create,row=oSettings.aoData[iRow],rowData=row._aData,cells=[];if(null===row.nTr){for(nTr=nTrIn||document.createElement("tr"),row.nTr=nTr,row.anCells=cells,nTr._DT_RowIndex=iRow,_fnRowAttributes(oSettings,row),i=0,iLen=oSettings.aoColumns.length;i<iLen;i++)oCol=oSettings.aoColumns[i],(nTd=(create=!nTrIn)?document.createElement(oCol.sCellType):anTds[i])._DT_CellIndex={row:iRow,column:i},cells.push(nTd),!create&&(nTrIn&&!oCol.mRender&&oCol.mData===i||$.isPlainObject(oCol.mData)&&oCol.mData._===i+".display")||(nTd.innerHTML=_fnGetCellData(oSettings,iRow,i,"display")),oCol.sClass&&(nTd.className+=" "+oCol.sClass),oCol.bVisible&&!nTrIn?nTr.appendChild(nTd):!oCol.bVisible&&nTrIn&&nTd.parentNode.removeChild(nTd),oCol.fnCreatedCell&&oCol.fnCreatedCell.call(oSettings.oInstance,nTd,_fnGetCellData(oSettings,iRow,i),rowData,iRow,i);_fnCallbackFire(oSettings,"aoRowCreatedCallback",null,[nTr,rowData,iRow,cells])}row.nTr.setAttribute("role","row")}function _fnRowAttributes(settings,row){var tr=row.nTr,data=row._aData;if(tr){var id=settings.rowIdFn(data);if(id&&(tr.id=id),data.DT_RowClass){var a=data.DT_RowClass.split(" ");row.__rowc=row.__rowc?_unique(row.__rowc.concat(a)):a,$(tr).removeClass(row.__rowc.join(" ")).addClass(data.DT_RowClass)}data.DT_RowAttr&&$(tr).attr(data.DT_RowAttr),data.DT_RowData&&$(tr).data(data.DT_RowData)}}function _fnBuildHead(oSettings){var i,ien,cell,row,column,thead=oSettings.nTHead,tfoot=oSettings.nTFoot,createHeader=0===$("th, td",thead).length,classes=oSettings.oClasses,columns=oSettings.aoColumns;for(createHeader&&(row=$("<tr/>").appendTo(thead)),i=0,ien=columns.length;i<ien;i++)column=columns[i],cell=$(column.nTh).addClass(column.sClass),createHeader&&cell.appendTo(row),oSettings.oFeatures.bSort&&(cell.addClass(column.sSortingClass),!1!==column.bSortable&&(cell.attr("tabindex",oSettings.iTabIndex).attr("aria-controls",oSettings.sTableId),_fnSortAttachListener(oSettings,column.nTh,i))),column.sTitle!=cell[0].innerHTML&&cell.html(column.sTitle),_fnRenderer(oSettings,"header")(oSettings,cell,column,classes);if(createHeader&&_fnDetectHeader(oSettings.aoHeader,thead),$(thead).find(">tr").attr("role","row"),$(thead).find(">tr>th, >tr>td").addClass(classes.sHeaderTH),$(tfoot).find(">tr>th, >tr>td").addClass(classes.sFooterTH),null!==tfoot){var cells=oSettings.aoFooter[0];for(i=0,ien=cells.length;i<ien;i++)(column=columns[i]).nTf=cells[i].cell,column.sClass&&$(column.nTf).addClass(column.sClass)}}function _fnDrawHead(oSettings,aoSource,bIncludeHidden){var i,iLen,j,jLen,k,n,nLocalTr,iRowspan,iColspan,aoLocal=[],aApplied=[],iColumns=oSettings.aoColumns.length;if(aoSource){for(bIncludeHidden===undefined&&(bIncludeHidden=!1),i=0,iLen=aoSource.length;i<iLen;i++){for(aoLocal[i]=aoSource[i].slice(),aoLocal[i].nTr=aoSource[i].nTr,j=iColumns-1;0<=j;j--)oSettings.aoColumns[j].bVisible||bIncludeHidden||aoLocal[i].splice(j,1);aApplied.push([])}for(i=0,iLen=aoLocal.length;i<iLen;i++){if(nLocalTr=aoLocal[i].nTr)for(;n=nLocalTr.firstChild;)nLocalTr.removeChild(n);for(j=0,jLen=aoLocal[i].length;j<jLen;j++)if(iColspan=iRowspan=1,aApplied[i][j]===undefined){for(nLocalTr.appendChild(aoLocal[i][j].cell),aApplied[i][j]=1;aoLocal[i+iRowspan]!==undefined&&aoLocal[i][j].cell==aoLocal[i+iRowspan][j].cell;)aApplied[i+iRowspan][j]=1,iRowspan++;for(;aoLocal[i][j+iColspan]!==undefined&&aoLocal[i][j].cell==aoLocal[i][j+iColspan].cell;){for(k=0;k<iRowspan;k++)aApplied[i+k][j+iColspan]=1;iColspan++}$(aoLocal[i][j].cell).attr("rowspan",iRowspan).attr("colspan",iColspan)}}}}function _fnDraw(oSettings){var aPreDraw=_fnCallbackFire(oSettings,"aoPreDrawCallback","preDraw",[oSettings]);if(-1===$.inArray(!1,aPreDraw)){var anRows=[],iRowCount=0,asStripeClasses=oSettings.asStripeClasses,iStripes=asStripeClasses.length,oLang=(oSettings.aoOpenRows.length,oSettings.oLanguage),iInitDisplayStart=oSettings.iInitDisplayStart,bServerSide="ssp"==_fnDataSource(oSettings),aiDisplay=oSettings.aiDisplay;oSettings.bDrawing=!0,iInitDisplayStart!==undefined&&-1!==iInitDisplayStart&&(oSettings._iDisplayStart=bServerSide?iInitDisplayStart:iInitDisplayStart>=oSettings.fnRecordsDisplay()?0:iInitDisplayStart,oSettings.iInitDisplayStart=-1);var iDisplayStart=oSettings._iDisplayStart,iDisplayEnd=oSettings.fnDisplayEnd();if(oSettings.bDeferLoading)oSettings.bDeferLoading=!1,oSettings.iDraw++,_fnProcessingDisplay(oSettings,!1);else if(bServerSide){if(!oSettings.bDestroying&&!_fnAjaxUpdate(oSettings))return}else oSettings.iDraw++;if(0!==aiDisplay.length)for(var iStart=bServerSide?0:iDisplayStart,iEnd=bServerSide?oSettings.aoData.length:iDisplayEnd,j=iStart;j<iEnd;j++){var iDataIndex=aiDisplay[j],aoData=oSettings.aoData[iDataIndex];null===aoData.nTr&&_fnCreateTr(oSettings,iDataIndex);var nRow=aoData.nTr;if(0!==iStripes){var sStripe=asStripeClasses[iRowCount%iStripes];aoData._sRowStripe!=sStripe&&($(nRow).removeClass(aoData._sRowStripe).addClass(sStripe),aoData._sRowStripe=sStripe)}_fnCallbackFire(oSettings,"aoRowCallback",null,[nRow,aoData._aData,iRowCount,j,iDataIndex]),anRows.push(nRow),iRowCount++}else{var sZero=oLang.sZeroRecords;1==oSettings.iDraw&&"ajax"==_fnDataSource(oSettings)?sZero=oLang.sLoadingRecords:oLang.sEmptyTable&&0===oSettings.fnRecordsTotal()&&(sZero=oLang.sEmptyTable),anRows[0]=$("<tr/>",{class:iStripes?asStripeClasses[0]:""}).append($("<td />",{valign:"top",colSpan:_fnVisbleColumns(oSettings),class:oSettings.oClasses.sRowEmpty}).html(sZero))[0]}_fnCallbackFire(oSettings,"aoHeaderCallback","header",[$(oSettings.nTHead).children("tr")[0],_fnGetDataMaster(oSettings),iDisplayStart,iDisplayEnd,aiDisplay]),_fnCallbackFire(oSettings,"aoFooterCallback","footer",[$(oSettings.nTFoot).children("tr")[0],_fnGetDataMaster(oSettings),iDisplayStart,iDisplayEnd,aiDisplay]);var body=$(oSettings.nTBody);body.children().detach(),body.append($(anRows)),_fnCallbackFire(oSettings,"aoDrawCallback","draw",[oSettings]),oSettings.bSorted=!1,oSettings.bFiltered=!1,oSettings.bDrawing=!1}else _fnProcessingDisplay(oSettings,!1)}function _fnReDraw(settings,holdPosition){var features=settings.oFeatures,sort=features.bSort,filter=features.bFilter;sort&&_fnSort(settings),filter?_fnFilterComplete(settings,settings.oPreviousSearch):settings.aiDisplay=settings.aiDisplayMaster.slice(),!0!==holdPosition&&(settings._iDisplayStart=0),settings._drawHold=holdPosition,_fnDraw(settings),settings._drawHold=!1}function _fnAddOptionsHtml(oSettings){var classes=oSettings.oClasses,table=$(oSettings.nTable),holding=$("<div/>").insertBefore(table),features=oSettings.oFeatures,insert=$("<div/>",{id:oSettings.sTableId+"_wrapper",class:classes.sWrapper+(oSettings.nTFoot?"":" "+classes.sNoFooter)});oSettings.nHolding=holding[0],oSettings.nTableWrapper=insert[0],oSettings.nTableReinsertBefore=oSettings.nTable.nextSibling;for(var featureNode,cOption,nNewNode,cNext,sAttr,j,aDom=oSettings.sDom.split(""),i=0;i<aDom.length;i++){if(featureNode=null,"<"==(cOption=aDom[i])){if(nNewNode=$("<div/>")[0],"'"==(cNext=aDom[i+1])||'"'==cNext){for(sAttr="",j=2;aDom[i+j]!=cNext;)sAttr+=aDom[i+j],j++;if("H"==sAttr?sAttr=classes.sJUIHeader:"F"==sAttr&&(sAttr=classes.sJUIFooter),-1!=sAttr.indexOf(".")){var aSplit=sAttr.split(".");nNewNode.id=aSplit[0].substr(1,aSplit[0].length-1),nNewNode.className=aSplit[1]}else"#"==sAttr.charAt(0)?nNewNode.id=sAttr.substr(1,sAttr.length-1):nNewNode.className=sAttr;i+=j}insert.append(nNewNode),insert=$(nNewNode)}else if(">"==cOption)insert=insert.parent();else if("l"==cOption&&features.bPaginate&&features.bLengthChange)featureNode=_fnFeatureHtmlLength(oSettings);else if("f"==cOption&&features.bFilter)featureNode=_fnFeatureHtmlFilter(oSettings);else if("r"==cOption&&features.bProcessing)featureNode=_fnFeatureHtmlProcessing(oSettings);else if("t"==cOption)featureNode=_fnFeatureHtmlTable(oSettings);else if("i"==cOption&&features.bInfo)featureNode=_fnFeatureHtmlInfo(oSettings);else if("p"==cOption&&features.bPaginate)featureNode=_fnFeatureHtmlPaginate(oSettings);else if(0!==DataTable.ext.feature.length)for(var aoFeatures=DataTable.ext.feature,k=0,kLen=aoFeatures.length;k<kLen;k++)if(cOption==aoFeatures[k].cFeature){featureNode=aoFeatures[k].fnInit(oSettings);break}if(featureNode){var aanFeatures=oSettings.aanFeatures;aanFeatures[cOption]||(aanFeatures[cOption]=[]),aanFeatures[cOption].push(featureNode),insert.append(featureNode)}}holding.replaceWith(insert),oSettings.nHolding=null}function _fnDetectHeader(aLayout,nThead){function fnShiftCol(a,i,j){for(var k=a[i];k[j];)j++;return j}var nTr,nCell,i,k,l,iLen,iColShifted,iColspan,iRowspan,bUnique,nTrs=$(nThead).children("tr");for(aLayout.splice(0,aLayout.length),i=0,iLen=nTrs.length;i<iLen;i++)aLayout.push([]);for(i=0,iLen=nTrs.length;i<iLen;i++)for(0,nCell=(nTr=nTrs[i]).firstChild;nCell;){if("TD"==nCell.nodeName.toUpperCase()||"TH"==nCell.nodeName.toUpperCase())for(iColspan=(iColspan=1*nCell.getAttribute("colspan"))&&0!==iColspan&&1!==iColspan?iColspan:1,iRowspan=(iRowspan=1*nCell.getAttribute("rowspan"))&&0!==iRowspan&&1!==iRowspan?iRowspan:1,iColShifted=fnShiftCol(aLayout,i,0),bUnique=1===iColspan,l=0;l<iColspan;l++)for(k=0;k<iRowspan;k++)aLayout[i+k][iColShifted+l]={cell:nCell,unique:bUnique},aLayout[i+k].nTr=nTr;nCell=nCell.nextSibling}}function _fnGetUniqueThs(oSettings,nHeader,aLayout){var aReturn=[];aLayout||(aLayout=oSettings.aoHeader,nHeader&&_fnDetectHeader(aLayout=[],nHeader));for(var i=0,iLen=aLayout.length;i<iLen;i++)for(var j=0,jLen=aLayout[i].length;j<jLen;j++)!aLayout[i][j].unique||aReturn[j]&&oSettings.bSortCellsTop||(aReturn[j]=aLayout[i][j].cell);return aReturn}function _fnBuildAjax(oSettings,data,fn){if(_fnCallbackFire(oSettings,"aoServerParams","serverParams",[data]),data&&$.isArray(data)){var tmp={},rbracket=/(.*?)\[\]$/;$.each(data,function(key,val){var match=val.name.match(rbracket);if(match){var name=match[0];tmp[name]||(tmp[name]=[]),tmp[name].push(val.value)}else tmp[val.name]=val.value}),data=tmp}function callback(json){_fnCallbackFire(oSettings,null,"xhr",[oSettings,json,oSettings.jqXHR]),fn(json)}var ajaxData,ajax=oSettings.ajax,instance=oSettings.oInstance;if($.isPlainObject(ajax)&&ajax.data){var newData="function"==typeof(ajaxData=ajax.data)?ajaxData(data,oSettings):ajaxData;data="function"==typeof ajaxData&&newData?newData:$.extend(!0,data,newData),delete ajax.data}var baseAjax={data:data,success:function(json){var error=json.error||json.sError;error&&_fnLog(oSettings,0,error),oSettings.json=json,callback(json)},dataType:"json",cache:!1,type:oSettings.sServerMethod,error:function(xhr,error,thrown){var ret=_fnCallbackFire(oSettings,null,"xhr",[oSettings,null,oSettings.jqXHR]);-1===$.inArray(!0,ret)&&("parsererror"==error?_fnLog(oSettings,0,"Invalid JSON response",1):4===xhr.readyState&&_fnLog(oSettings,0,"Ajax error",7)),_fnProcessingDisplay(oSettings,!1)}};oSettings.oAjaxData=data,_fnCallbackFire(oSettings,null,"preXhr",[oSettings,data]),oSettings.fnServerData?oSettings.fnServerData.call(instance,oSettings.sAjaxSource,$.map(data,function(val,key){return{name:key,value:val}}),callback,oSettings):oSettings.sAjaxSource||"string"==typeof ajax?oSettings.jqXHR=$.ajax($.extend(baseAjax,{url:ajax||oSettings.sAjaxSource})):"function"==typeof ajax?oSettings.jqXHR=ajax.call(instance,data,callback,oSettings):(oSettings.jqXHR=$.ajax($.extend(baseAjax,ajax)),ajax.data=ajaxData)}function _fnAjaxUpdate(settings){return!settings.bAjaxDataGet||(settings.iDraw++,_fnProcessingDisplay(settings,!0),_fnBuildAjax(settings,_fnAjaxParameters(settings),function(json){_fnAjaxUpdateDraw(settings,json)}),!1)}function _fnAjaxParameters(settings){function param(name,value){data.push({name:name,value:value})}var i,dataProp,column,columnSearch,columns=settings.aoColumns,columnCount=columns.length,features=settings.oFeatures,preSearch=settings.oPreviousSearch,preColSearch=settings.aoPreSearchCols,data=[],sort=_fnSortFlatten(settings),displayStart=settings._iDisplayStart,displayLength=!1!==features.bPaginate?settings._iDisplayLength:-1;param("sEcho",settings.iDraw),param("iColumns",columnCount),param("sColumns",_pluck(columns,"sName").join(",")),param("iDisplayStart",displayStart),param("iDisplayLength",displayLength);var d={draw:settings.iDraw,columns:[],order:[],start:displayStart,length:displayLength,search:{value:preSearch.sSearch,regex:preSearch.bRegex}};for(i=0;i<columnCount;i++)column=columns[i],columnSearch=preColSearch[i],dataProp="function"==typeof column.mData?"function":column.mData,d.columns.push({data:dataProp,name:column.sName,searchable:column.bSearchable,orderable:column.bSortable,search:{value:columnSearch.sSearch,regex:columnSearch.bRegex}}),param("mDataProp_"+i,dataProp),features.bFilter&&(param("sSearch_"+i,columnSearch.sSearch),param("bRegex_"+i,columnSearch.bRegex),param("bSearchable_"+i,column.bSearchable)),features.bSort&&param("bSortable_"+i,column.bSortable);features.bFilter&&(param("sSearch",preSearch.sSearch),param("bRegex",preSearch.bRegex)),features.bSort&&($.each(sort,function(i,val){d.order.push({column:val.col,dir:val.dir}),param("iSortCol_"+i,val.col),param("sSortDir_"+i,val.dir)}),param("iSortingCols",sort.length));var legacy=DataTable.ext.legacy.ajax;return null===legacy?settings.sAjaxSource?data:d:legacy?data:d}function _fnAjaxUpdateDraw(settings,json){function compat(old,modern){return json[old]!==undefined?json[old]:json[modern]}var data=_fnAjaxDataSrc(settings,json),draw=compat("sEcho","draw"),recordsTotal=compat("iTotalRecords","recordsTotal"),recordsFiltered=compat("iTotalDisplayRecords","recordsFiltered");if(draw){if(1*draw<settings.iDraw)return;settings.iDraw=1*draw}_fnClearTable(settings),settings._iRecordsTotal=parseInt(recordsTotal,10),settings._iRecordsDisplay=parseInt(recordsFiltered,10);for(var i=0,ien=data.length;i<ien;i++)_fnAddData(settings,data[i]);settings.aiDisplay=settings.aiDisplayMaster.slice(),settings.bAjaxDataGet=!1,_fnDraw(settings),settings._bInitComplete||_fnInitComplete(settings,json),settings.bAjaxDataGet=!0,_fnProcessingDisplay(settings,!1)}function _fnAjaxDataSrc(oSettings,json){var dataSrc=$.isPlainObject(oSettings.ajax)&&oSettings.ajax.dataSrc!==undefined?oSettings.ajax.dataSrc:oSettings.sAjaxDataProp;return"data"===dataSrc?json.aaData||json[dataSrc]:""!==dataSrc?_fnGetObjectDataFn(dataSrc)(json):json}function _fnFeatureHtmlFilter(settings){var classes=settings.oClasses,tableId=settings.sTableId,language=settings.oLanguage,previousSearch=settings.oPreviousSearch,features=settings.aanFeatures,input='<input type="search" class="'+classes.sFilterInput+'"/>',str=language.sSearch;str=str.match(/_INPUT_/)?str.replace("_INPUT_",input):str+input;function searchFn(){features.f;var val=this.value?this.value:"";val!=previousSearch.sSearch&&(_fnFilterComplete(settings,{sSearch:val,bRegex:previousSearch.bRegex,bSmart:previousSearch.bSmart,bCaseInsensitive:previousSearch.bCaseInsensitive}),settings._iDisplayStart=0,_fnDraw(settings))}var filter=$("<div/>",{id:features.f?null:tableId+"_filter",class:classes.sFilter}).append($("<label/>").append(str)),searchDelay=null!==settings.searchDelay?settings.searchDelay:"ssp"===_fnDataSource(settings)?400:0,jqFilter=$("input",filter).val(previousSearch.sSearch).attr("placeholder",language.sSearchPlaceholder).on("keyup.DT search.DT input.DT paste.DT cut.DT",searchDelay?_fnThrottle(searchFn,searchDelay):searchFn).on("keypress.DT",function(e){if(13==e.keyCode)return!1}).attr("aria-controls",tableId);return $(settings.nTable).on("search.dt.DT",function(ev,s){if(settings===s)try{jqFilter[0]!==document.activeElement&&jqFilter.val(previousSearch.sSearch)}catch(e){}}),filter[0]}function _fnFilterComplete(oSettings,oInput,iForce){function fnSaveFilter(oFilter){oPrevSearch.sSearch=oFilter.sSearch,oPrevSearch.bRegex=oFilter.bRegex,oPrevSearch.bSmart=oFilter.bSmart,oPrevSearch.bCaseInsensitive=oFilter.bCaseInsensitive}function fnRegex(o){return o.bEscapeRegex!==undefined?!o.bEscapeRegex:o.bRegex}var oPrevSearch=oSettings.oPreviousSearch,aoPrevSearch=oSettings.aoPreSearchCols;if(_fnColumnTypes(oSettings),"ssp"!=_fnDataSource(oSettings)){_fnFilter(oSettings,oInput.sSearch,iForce,fnRegex(oInput),oInput.bSmart,oInput.bCaseInsensitive),fnSaveFilter(oInput);for(var i=0;i<aoPrevSearch.length;i++)_fnFilterColumn(oSettings,aoPrevSearch[i].sSearch,i,fnRegex(aoPrevSearch[i]),aoPrevSearch[i].bSmart,aoPrevSearch[i].bCaseInsensitive);_fnFilterCustom(oSettings)}else fnSaveFilter(oInput);oSettings.bFiltered=!0,_fnCallbackFire(oSettings,null,"search",[oSettings])}function _fnFilterCustom(settings){for(var row,rowIdx,filters=DataTable.ext.search,displayRows=settings.aiDisplay,i=0,ien=filters.length;i<ien;i++){for(var rows=[],j=0,jen=displayRows.length;j<jen;j++)rowIdx=displayRows[j],row=settings.aoData[rowIdx],filters[i](settings,row._aFilterData,rowIdx,row._aData,j)&&rows.push(rowIdx);displayRows.length=0,$.merge(displayRows,rows)}}function _fnFilterColumn(settings,searchStr,colIdx,regex,smart,caseInsensitive){if(""!==searchStr){for(var data,out=[],display=settings.aiDisplay,rpSearch=_fnFilterCreateSearch(searchStr,regex,smart,caseInsensitive),i=0;i<display.length;i++)data=settings.aoData[display[i]]._aFilterData[colIdx],rpSearch.test(data)&&out.push(display[i]);settings.aiDisplay=out}}function _fnFilter(settings,input,force,regex,smart,caseInsensitive){var display,invalidated,i,rpSearch=_fnFilterCreateSearch(input,regex,smart,caseInsensitive),prevSearch=settings.oPreviousSearch.sSearch,displayMaster=settings.aiDisplayMaster,filtered=[];if(0!==DataTable.ext.search.length&&(force=!0),invalidated=_fnFilterData(settings),input.length<=0)settings.aiDisplay=displayMaster.slice();else{for((invalidated||force||regex||prevSearch.length>input.length||0!==input.indexOf(prevSearch)||settings.bSorted)&&(settings.aiDisplay=displayMaster.slice()),display=settings.aiDisplay,i=0;i<display.length;i++)rpSearch.test(settings.aoData[display[i]]._sFilterRow)&&filtered.push(display[i]);settings.aiDisplay=filtered}}function _fnFilterCreateSearch(search,regex,smart,caseInsensitive){search=regex?search:_fnEscapeRegex(search),smart&&(search="^(?=.*?"+$.map(search.match(/"[^"]+"|[^ ]+/g)||[""],function(word){if('"'===word.charAt(0)){var m=word.match(/^"(.*)"$/);word=m?m[1]:word}return word.replace('"',"")}).join(")(?=.*?")+").*$");return new RegExp(search,caseInsensitive?"i":"")}var _fnEscapeRegex=DataTable.util.escapeRegex,__filter_div=$("<div>")[0],__filter_div_textContent=__filter_div.textContent!==undefined;function _fnFilterData(settings){var column,i,j,ien,jen,filterData,cellData,row,columns=settings.aoColumns,fomatters=DataTable.ext.type.search,wasInvalidated=!1;for(i=0,ien=settings.aoData.length;i<ien;i++)if(!(row=settings.aoData[i])._aFilterData){for(filterData=[],j=0,jen=columns.length;j<jen;j++)(column=columns[j]).bSearchable?(cellData=_fnGetCellData(settings,i,j,"filter"),fomatters[column.sType]&&(cellData=fomatters[column.sType](cellData)),null===cellData&&(cellData=""),"string"!=typeof cellData&&cellData.toString&&(cellData=cellData.toString())):cellData="",cellData.indexOf&&-1!==cellData.indexOf("&")&&(__filter_div.innerHTML=cellData,cellData=__filter_div_textContent?__filter_div.textContent:__filter_div.innerText),cellData.replace&&(cellData=cellData.replace(/[\r\n\u2028]/g,"")),filterData.push(cellData);row._aFilterData=filterData,row._sFilterRow=filterData.join("  "),wasInvalidated=!0}return wasInvalidated}function _fnSearchToCamel(obj){return{search:obj.sSearch,smart:obj.bSmart,regex:obj.bRegex,caseInsensitive:obj.bCaseInsensitive}}function _fnSearchToHung(obj){return{sSearch:obj.search,bSmart:obj.smart,bRegex:obj.regex,bCaseInsensitive:obj.caseInsensitive}}function _fnFeatureHtmlInfo(settings){var tid=settings.sTableId,nodes=settings.aanFeatures.i,n=$("<div/>",{class:settings.oClasses.sInfo,id:nodes?null:tid+"_info"});return nodes||(settings.aoDrawCallback.push({fn:_fnUpdateInfo,sName:"information"}),n.attr("role","status").attr("aria-live","polite"),$(settings.nTable).attr("aria-describedby",tid+"_info")),n[0]}function _fnUpdateInfo(settings){var nodes=settings.aanFeatures.i;if(0!==nodes.length){var lang=settings.oLanguage,start=settings._iDisplayStart+1,end=settings.fnDisplayEnd(),max=settings.fnRecordsTotal(),total=settings.fnRecordsDisplay(),out=total?lang.sInfo:lang.sInfoEmpty;total!==max&&(out+=" "+lang.sInfoFiltered),out=_fnInfoMacros(settings,out+=lang.sInfoPostFix);var callback=lang.fnInfoCallback;null!==callback&&(out=callback.call(settings.oInstance,settings,start,end,max,total,out)),$(nodes).html(out)}}function _fnInfoMacros(settings,str){var formatter=settings.fnFormatNumber,start=settings._iDisplayStart+1,len=settings._iDisplayLength,vis=settings.fnRecordsDisplay(),all=-1===len;return str.replace(/_START_/g,formatter.call(settings,start)).replace(/_END_/g,formatter.call(settings,settings.fnDisplayEnd())).replace(/_MAX_/g,formatter.call(settings,settings.fnRecordsTotal())).replace(/_TOTAL_/g,formatter.call(settings,vis)).replace(/_PAGE_/g,formatter.call(settings,all?1:Math.ceil(start/len))).replace(/_PAGES_/g,formatter.call(settings,all?1:Math.ceil(vis/len)))}function _fnInitialise(settings){var i,iLen,column,iAjaxStart=settings.iInitDisplayStart,columns=settings.aoColumns,features=settings.oFeatures,deferLoading=settings.bDeferLoading;if(settings.bInitialised){for(_fnAddOptionsHtml(settings),_fnBuildHead(settings),_fnDrawHead(settings,settings.aoHeader),_fnDrawHead(settings,settings.aoFooter),_fnProcessingDisplay(settings,!0),features.bAutoWidth&&_fnCalculateColumnWidths(settings),i=0,iLen=columns.length;i<iLen;i++)(column=columns[i]).sWidth&&(column.nTh.style.width=_fnStringToCss(column.sWidth));_fnCallbackFire(settings,null,"preInit",[settings]),_fnReDraw(settings);var dataSrc=_fnDataSource(settings);"ssp"==dataSrc&&!deferLoading||("ajax"==dataSrc?_fnBuildAjax(settings,[],function(json){var aData=_fnAjaxDataSrc(settings,json);for(i=0;i<aData.length;i++)_fnAddData(settings,aData[i]);settings.iInitDisplayStart=iAjaxStart,_fnReDraw(settings),_fnProcessingDisplay(settings,!1),_fnInitComplete(settings,json)}):(_fnProcessingDisplay(settings,!1),_fnInitComplete(settings)))}else setTimeout(function(){_fnInitialise(settings)},200)}function _fnInitComplete(settings,json){settings._bInitComplete=!0,(json||settings.oInit.aaData)&&_fnAdjustColumnSizing(settings),_fnCallbackFire(settings,null,"plugin-init",[settings,json]),_fnCallbackFire(settings,"aoInitComplete","init",[settings,json])}function _fnLengthChange(settings,val){var len=parseInt(val,10);settings._iDisplayLength=len,_fnLengthOverflow(settings),_fnCallbackFire(settings,null,"length",[settings,len])}function _fnFeatureHtmlLength(settings){for(var classes=settings.oClasses,tableId=settings.sTableId,menu=settings.aLengthMenu,d2=$.isArray(menu[0]),lengths=d2?menu[0]:menu,language=d2?menu[1]:menu,select=$("<select/>",{name:tableId+"_length","aria-controls":tableId,class:classes.sLengthSelect}),i=0,ien=lengths.length;i<ien;i++)select[0][i]=new Option("number"==typeof language[i]?settings.fnFormatNumber(language[i]):language[i],lengths[i]);var div=$("<div><label/></div>").addClass(classes.sLength);return settings.aanFeatures.l||(div[0].id=tableId+"_length"),div.children().append(settings.oLanguage.sLengthMenu.replace("_MENU_",select[0].outerHTML)),$("select",div).val(settings._iDisplayLength).on("change.DT",function(e){_fnLengthChange(settings,$(this).val()),_fnDraw(settings)}),$(settings.nTable).on("length.dt.DT",function(e,s,len){settings===s&&$("select",div).val(len)}),div[0]}function _fnFeatureHtmlPaginate(settings){function redraw(settings){_fnDraw(settings)}var type=settings.sPaginationType,plugin=DataTable.ext.pager[type],modern="function"==typeof plugin,node=$("<div/>").addClass(settings.oClasses.sPaging+type)[0],features=settings.aanFeatures;return modern||plugin.fnInit(settings,node,redraw),features.p||(node.id=settings.sTableId+"_paginate",settings.aoDrawCallback.push({fn:function(settings){if(modern){var i,ien,start=settings._iDisplayStart,len=settings._iDisplayLength,visRecords=settings.fnRecordsDisplay(),all=-1===len,page=all?0:Math.ceil(start/len),pages=all?1:Math.ceil(visRecords/len),buttons=plugin(page,pages);for(i=0,ien=features.p.length;i<ien;i++)_fnRenderer(settings,"pageButton")(settings,features.p[i],i,buttons,page,pages)}else plugin.fnUpdate(settings,redraw)},sName:"pagination"})),node}function _fnPageChange(settings,action,redraw){var start=settings._iDisplayStart,len=settings._iDisplayLength,records=settings.fnRecordsDisplay();0===records||-1===len?start=0:"number"==typeof action?records<(start=action*len)&&(start=0):"first"==action?start=0:"previous"==action?(start=0<=len?start-len:0)<0&&(start=0):"next"==action?start+len<records&&(start+=len):"last"==action?start=Math.floor((records-1)/len)*len:_fnLog(settings,0,"Unknown paging action: "+action,5);var changed=settings._iDisplayStart!==start;return settings._iDisplayStart=start,changed&&(_fnCallbackFire(settings,null,"page",[settings]),redraw&&_fnDraw(settings)),changed}function _fnFeatureHtmlProcessing(settings){return $("<div/>",{id:settings.aanFeatures.r?null:settings.sTableId+"_processing",class:settings.oClasses.sProcessing}).html(settings.oLanguage.sProcessing).insertBefore(settings.nTable)[0]}function _fnProcessingDisplay(settings,show){settings.oFeatures.bProcessing&&$(settings.aanFeatures.r).css("display",show?"block":"none"),_fnCallbackFire(settings,null,"processing",[settings,show])}function _fnFeatureHtmlTable(settings){var table=$(settings.nTable);table.attr("role","grid");var scroll=settings.oScroll;if(""===scroll.sX&&""===scroll.sY)return settings.nTable;function size(s){return s?_fnStringToCss(s):null}var scrollX=scroll.sX,scrollY=scroll.sY,classes=settings.oClasses,caption=table.children("caption"),captionSide=caption.length?caption[0]._captionSide:null,headerClone=$(table[0].cloneNode(!1)),footerClone=$(table[0].cloneNode(!1)),footer=table.children("tfoot"),_div="<div/>";footer.length||(footer=null);var scroller=$(_div,{class:classes.sScrollWrapper}).append($(_div,{class:classes.sScrollHead}).css({overflow:"hidden",position:"relative",border:0,width:scrollX?size(scrollX):"100%"}).append($(_div,{class:classes.sScrollHeadInner}).css({"box-sizing":"content-box",width:scroll.sXInner||"100%"}).append(headerClone.removeAttr("id").css("margin-left",0).append("top"===captionSide?caption:null).append(table.children("thead"))))).append($(_div,{class:classes.sScrollBody}).css({position:"relative",overflow:"auto",width:size(scrollX)}).append(table));footer&&scroller.append($(_div,{class:classes.sScrollFoot}).css({overflow:"hidden",border:0,width:scrollX?size(scrollX):"100%"}).append($(_div,{class:classes.sScrollFootInner}).append(footerClone.removeAttr("id").css("margin-left",0).append("bottom"===captionSide?caption:null).append(table.children("tfoot")))));var children=scroller.children(),scrollHead=children[0],scrollBody=children[1],scrollFoot=footer?children[2]:null;return scrollX&&$(scrollBody).on("scroll.DT",function(e){var scrollLeft=this.scrollLeft;scrollHead.scrollLeft=scrollLeft,footer&&(scrollFoot.scrollLeft=scrollLeft)}),$(scrollBody).css(scrollY&&scroll.bCollapse?"max-height":"height",scrollY),settings.nScrollHead=scrollHead,settings.nScrollBody=scrollBody,settings.nScrollFoot=scrollFoot,settings.aoDrawCallback.push({fn:_fnScrollDraw,sName:"scrolling"}),scroller[0]}function _fnScrollDraw(settings){function zeroOut(nSizer){var style=nSizer.style;style.paddingTop="0",style.paddingBottom="0",style.borderTopWidth="0",style.borderBottomWidth="0",style.height=0}var headerTrgEls,footerTrgEls,headerSrcEls,footerSrcEls,headerCopy,footerCopy,idx,correction,sanityWidth,scroll=settings.oScroll,scrollX=scroll.sX,scrollXInner=scroll.sXInner,scrollY=scroll.sY,barWidth=scroll.iBarWidth,divHeader=$(settings.nScrollHead),divHeaderStyle=divHeader[0].style,divHeaderInner=divHeader.children("div"),divHeaderInnerStyle=divHeaderInner[0].style,divHeaderTable=divHeaderInner.children("table"),divBodyEl=settings.nScrollBody,divBody=$(divBodyEl),divBodyStyle=divBodyEl.style,divFooterInner=$(settings.nScrollFoot).children("div"),divFooterTable=divFooterInner.children("table"),header=$(settings.nTHead),table=$(settings.nTable),tableEl=table[0],tableStyle=tableEl.style,footer=settings.nTFoot?$(settings.nTFoot):null,browser=settings.oBrowser,ie67=browser.bScrollOversize,dtHeaderCells=_pluck(settings.aoColumns,"nTh"),headerWidths=[],footerWidths=[],headerContent=[],footerContent=[],scrollBarVis=divBodyEl.scrollHeight>divBodyEl.clientHeight;if(settings.scrollBarVis!==scrollBarVis&&settings.scrollBarVis!==undefined)return settings.scrollBarVis=scrollBarVis,void _fnAdjustColumnSizing(settings);settings.scrollBarVis=scrollBarVis,table.children("thead, tfoot").remove(),footer&&(footerCopy=footer.clone().prependTo(table),footerTrgEls=footer.find("tr"),footerSrcEls=footerCopy.find("tr")),headerCopy=header.clone().prependTo(table),headerTrgEls=header.find("tr"),headerSrcEls=headerCopy.find("tr"),headerCopy.find("th, td").removeAttr("tabindex"),scrollX||(divBodyStyle.width="100%",divHeader[0].style.width="100%"),$.each(_fnGetUniqueThs(settings,headerCopy),function(i,el){idx=_fnVisibleToColumnIndex(settings,i),el.style.width=settings.aoColumns[idx].sWidth}),footer&&_fnApplyToChildren(function(n){n.style.width=""},footerSrcEls),sanityWidth=table.outerWidth(),""===scrollX?(tableStyle.width="100%",ie67&&(table.find("tbody").height()>divBodyEl.offsetHeight||"scroll"==divBody.css("overflow-y"))&&(tableStyle.width=_fnStringToCss(table.outerWidth()-barWidth)),sanityWidth=table.outerWidth()):""!==scrollXInner&&(tableStyle.width=_fnStringToCss(scrollXInner),sanityWidth=table.outerWidth()),_fnApplyToChildren(zeroOut,headerSrcEls),_fnApplyToChildren(function(nSizer){headerContent.push(nSizer.innerHTML),headerWidths.push(_fnStringToCss($(nSizer).css("width")))},headerSrcEls),_fnApplyToChildren(function(nToSize,i){-1!==$.inArray(nToSize,dtHeaderCells)&&(nToSize.style.width=headerWidths[i])},headerTrgEls),$(headerSrcEls).height(0),footer&&(_fnApplyToChildren(zeroOut,footerSrcEls),_fnApplyToChildren(function(nSizer){footerContent.push(nSizer.innerHTML),footerWidths.push(_fnStringToCss($(nSizer).css("width")))},footerSrcEls),_fnApplyToChildren(function(nToSize,i){nToSize.style.width=footerWidths[i]},footerTrgEls),$(footerSrcEls).height(0)),_fnApplyToChildren(function(nSizer,i){nSizer.innerHTML='<div class="dataTables_sizing">'+headerContent[i]+"</div>",nSizer.childNodes[0].style.height="0",nSizer.childNodes[0].style.overflow="hidden",nSizer.style.width=headerWidths[i]},headerSrcEls),footer&&_fnApplyToChildren(function(nSizer,i){nSizer.innerHTML='<div class="dataTables_sizing">'+footerContent[i]+"</div>",nSizer.childNodes[0].style.height="0",nSizer.childNodes[0].style.overflow="hidden",nSizer.style.width=footerWidths[i]},footerSrcEls),table.outerWidth()<sanityWidth?(correction=divBodyEl.scrollHeight>divBodyEl.offsetHeight||"scroll"==divBody.css("overflow-y")?sanityWidth+barWidth:sanityWidth,ie67&&(divBodyEl.scrollHeight>divBodyEl.offsetHeight||"scroll"==divBody.css("overflow-y"))&&(tableStyle.width=_fnStringToCss(correction-barWidth)),""!==scrollX&&""===scrollXInner||_fnLog(settings,1,"Possible column misalignment",6)):correction="100%",divBodyStyle.width=_fnStringToCss(correction),divHeaderStyle.width=_fnStringToCss(correction),footer&&(settings.nScrollFoot.style.width=_fnStringToCss(correction)),scrollY||ie67&&(divBodyStyle.height=_fnStringToCss(tableEl.offsetHeight+barWidth));var iOuterWidth=table.outerWidth();divHeaderTable[0].style.width=_fnStringToCss(iOuterWidth),divHeaderInnerStyle.width=_fnStringToCss(iOuterWidth);var bScrolling=table.height()>divBodyEl.clientHeight||"scroll"==divBody.css("overflow-y"),padding="padding"+(browser.bScrollbarLeft?"Left":"Right");divHeaderInnerStyle[padding]=bScrolling?barWidth+"px":"0px",footer&&(divFooterTable[0].style.width=_fnStringToCss(iOuterWidth),divFooterInner[0].style.width=_fnStringToCss(iOuterWidth),divFooterInner[0].style[padding]=bScrolling?barWidth+"px":"0px"),table.children("colgroup").insertBefore(table.children("thead")),divBody.trigger("scroll"),!settings.bSorted&&!settings.bFiltered||settings._drawHold||(divBodyEl.scrollTop=0)}function _fnApplyToChildren(fn,an1,an2){for(var nNode1,nNode2,index=0,i=0,iLen=an1.length;i<iLen;){for(nNode1=an1[i].firstChild,nNode2=an2?an2[i].firstChild:null;nNode1;)1===nNode1.nodeType&&(an2?fn(nNode1,nNode2,index):fn(nNode1,index),index++),nNode1=nNode1.nextSibling,nNode2=an2?nNode2.nextSibling:null;i++}}var __re_html_remove=/<.*?>/g;function _fnCalculateColumnWidths(oSettings){var i,column,columnIdx,table=oSettings.nTable,columns=oSettings.aoColumns,scroll=oSettings.oScroll,scrollY=scroll.sY,scrollX=scroll.sX,scrollXInner=scroll.sXInner,columnCount=columns.length,visibleColumns=_fnGetColumns(oSettings,"bVisible"),headerCells=$("th",oSettings.nTHead),tableWidthAttr=table.getAttribute("width"),tableContainer=table.parentNode,userInputs=!1,browser=oSettings.oBrowser,ie67=browser.bScrollOversize,styleWidth=table.style.width;for(styleWidth&&-1!==styleWidth.indexOf("%")&&(tableWidthAttr=styleWidth),i=0;i<visibleColumns.length;i++)null!==(column=columns[visibleColumns[i]]).sWidth&&(column.sWidth=_fnConvertToWidth(column.sWidthOrig,tableContainer),userInputs=!0);if(ie67||!userInputs&&!scrollX&&!scrollY&&columnCount==_fnVisbleColumns(oSettings)&&columnCount==headerCells.length)for(i=0;i<columnCount;i++){var colIdx=_fnVisibleToColumnIndex(oSettings,i);null!==colIdx&&(columns[colIdx].sWidth=_fnStringToCss(headerCells.eq(i).width()))}else{var tmpTable=$(table).clone().css("visibility","hidden").removeAttr("id");tmpTable.find("tbody tr").remove();var tr=$("<tr/>").appendTo(tmpTable.find("tbody"));for(tmpTable.find("thead, tfoot").remove(),tmpTable.append($(oSettings.nTHead).clone()).append($(oSettings.nTFoot).clone()),tmpTable.find("tfoot th, tfoot td").css("width",""),headerCells=_fnGetUniqueThs(oSettings,tmpTable.find("thead")[0]),i=0;i<visibleColumns.length;i++)column=columns[visibleColumns[i]],headerCells[i].style.width=null!==column.sWidthOrig&&""!==column.sWidthOrig?_fnStringToCss(column.sWidthOrig):"",column.sWidthOrig&&scrollX&&$(headerCells[i]).append($("<div/>").css({width:column.sWidthOrig,margin:0,padding:0,border:0,height:1}));if(oSettings.aoData.length)for(i=0;i<visibleColumns.length;i++)column=columns[columnIdx=visibleColumns[i]],$(_fnGetWidestNode(oSettings,columnIdx)).clone(!1).append(column.sContentPadding).appendTo(tr);$("[name]",tmpTable).removeAttr("name");var holder=$("<div/>").css(scrollX||scrollY?{position:"absolute",top:0,left:0,height:1,right:0,overflow:"hidden"}:{}).append(tmpTable).appendTo(tableContainer);scrollX&&scrollXInner?tmpTable.width(scrollXInner):scrollX?(tmpTable.css("width","auto"),tmpTable.removeAttr("width"),tmpTable.width()<tableContainer.clientWidth&&tableWidthAttr&&tmpTable.width(tableContainer.clientWidth)):scrollY?tmpTable.width(tableContainer.clientWidth):tableWidthAttr&&tmpTable.width(tableWidthAttr);var total=0;for(i=0;i<visibleColumns.length;i++){var cell=$(headerCells[i]),border=cell.outerWidth()-cell.width(),bounding=browser.bBounding?Math.ceil(headerCells[i].getBoundingClientRect().width):cell.outerWidth();total+=bounding,columns[visibleColumns[i]].sWidth=_fnStringToCss(bounding-border)}table.style.width=_fnStringToCss(total),holder.remove()}if(tableWidthAttr&&(table.style.width=_fnStringToCss(tableWidthAttr)),(tableWidthAttr||scrollX)&&!oSettings._reszEvt){var bindResize=function(){$(window).on("resize.DT-"+oSettings.sInstance,_fnThrottle(function(){_fnAdjustColumnSizing(oSettings)}))};ie67?setTimeout(bindResize,1e3):bindResize(),oSettings._reszEvt=!0}}var _fnThrottle=DataTable.util.throttle;function _fnConvertToWidth(width,parent){if(!width)return 0;var n=$("<div/>").css("width",_fnStringToCss(width)).appendTo(parent||document.body),val=n[0].offsetWidth;return n.remove(),val}function _fnGetWidestNode(settings,colIdx){var idx=_fnGetMaxLenString(settings,colIdx);if(idx<0)return null;var data=settings.aoData[idx];return data.nTr?data.anCells[colIdx]:$("<td/>").html(_fnGetCellData(settings,idx,colIdx,"display"))[0]}function _fnGetMaxLenString(settings,colIdx){for(var s,max=-1,maxIdx=-1,i=0,ien=settings.aoData.length;i<ien;i++)(s=(s=(s=_fnGetCellData(settings,i,colIdx,"display")+"").replace(__re_html_remove,"")).replace(/&nbsp;/g," ")).length>max&&(max=s.length,maxIdx=i);return maxIdx}function _fnStringToCss(s){return null===s?"0px":"number"==typeof s?s<0?"0px":s+"px":s.match(/\d$/)?s+"px":s}function _fnSortFlatten(settings){function add(a){a.length&&!$.isArray(a[0])?nestedSort.push(a):$.merge(nestedSort,a)}var i,k,kLen,aDataSort,iCol,sType,srcCol,aSort=[],aoColumns=settings.aoColumns,fixed=settings.aaSortingFixed,fixedObj=$.isPlainObject(fixed),nestedSort=[];for($.isArray(fixed)&&add(fixed),fixedObj&&fixed.pre&&add(fixed.pre),add(settings.aaSorting),fixedObj&&fixed.post&&add(fixed.post),i=0;i<nestedSort.length;i++)for(k=0,kLen=(aDataSort=aoColumns[srcCol=nestedSort[i][0]].aDataSort).length;k<kLen;k++)sType=aoColumns[iCol=aDataSort[k]].sType||"string",nestedSort[i]._idx===undefined&&(nestedSort[i]._idx=$.inArray(nestedSort[i][1],aoColumns[iCol].asSorting)),aSort.push({src:srcCol,col:iCol,dir:nestedSort[i][1],index:nestedSort[i]._idx,type:sType,formatter:DataTable.ext.type.order[sType+"-pre"]});return aSort}function _fnSort(oSettings){var i,ien,iLen,sortCol,aSort,aiOrig=[],oExtSort=DataTable.ext.type.order,aoData=oSettings.aoData,formatters=(oSettings.aoColumns,0),displayMaster=oSettings.aiDisplayMaster;for(_fnColumnTypes(oSettings),i=0,ien=(aSort=_fnSortFlatten(oSettings)).length;i<ien;i++)(sortCol=aSort[i]).formatter&&formatters++,_fnSortData(oSettings,sortCol.col);if("ssp"!=_fnDataSource(oSettings)&&0!==aSort.length){for(i=0,iLen=displayMaster.length;i<iLen;i++)aiOrig[displayMaster[i]]=i;formatters===aSort.length?displayMaster.sort(function(a,b){var x,y,k,test,sort,len=aSort.length,dataA=aoData[a]._aSortData,dataB=aoData[b]._aSortData;for(k=0;k<len;k++)if(0!=(test=(x=dataA[(sort=aSort[k]).col])<(y=dataB[sort.col])?-1:y<x?1:0))return"asc"===sort.dir?test:-test;return(x=aiOrig[a])<(y=aiOrig[b])?-1:y<x?1:0}):displayMaster.sort(function(a,b){var x,y,k,test,sort,len=aSort.length,dataA=aoData[a]._aSortData,dataB=aoData[b]._aSortData;for(k=0;k<len;k++)if(x=dataA[(sort=aSort[k]).col],y=dataB[sort.col],0!==(test=(oExtSort[sort.type+"-"+sort.dir]||oExtSort["string-"+sort.dir])(x,y)))return test;return(x=aiOrig[a])<(y=aiOrig[b])?-1:y<x?1:0})}oSettings.bSorted=!0}function _fnSortAria(settings){for(var label,columns=settings.aoColumns,aSort=_fnSortFlatten(settings),oAria=settings.oLanguage.oAria,i=0,iLen=columns.length;i<iLen;i++){var col=columns[i],asSorting=col.asSorting,sTitle=col.sTitle.replace(/<.*?>/g,""),th=col.nTh;th.removeAttribute("aria-sort"),label=col.bSortable?sTitle+("asc"===(0<aSort.length&&aSort[0].col==i?(th.setAttribute("aria-sort","asc"==aSort[0].dir?"ascending":"descending"),asSorting[aSort[0].index+1]||asSorting[0]):asSorting[0])?oAria.sSortAscending:oAria.sSortDescending):sTitle,th.setAttribute("aria-label",label)}}function _fnSortListener(settings,colIdx,append,callback){function next(a,overflow){var idx=a._idx;return idx===undefined&&(idx=$.inArray(a[1],asSorting)),idx+1<asSorting.length?idx+1:overflow?null:0}var nextSortIdx,col=settings.aoColumns[colIdx],sorting=settings.aaSorting,asSorting=col.asSorting;if("number"==typeof sorting[0]&&(sorting=settings.aaSorting=[sorting]),append&&settings.oFeatures.bSortMulti){var sortIdx=$.inArray(colIdx,_pluck(sorting,"0"));-1!==sortIdx?(null===(nextSortIdx=next(sorting[sortIdx],!0))&&1===sorting.length&&(nextSortIdx=0),null===nextSortIdx?sorting.splice(sortIdx,1):(sorting[sortIdx][1]=asSorting[nextSortIdx],sorting[sortIdx]._idx=nextSortIdx)):(sorting.push([colIdx,asSorting[0],0]),sorting[sorting.length-1]._idx=0)}else sorting.length&&sorting[0][0]==colIdx?(nextSortIdx=next(sorting[0]),sorting.length=1,sorting[0][1]=asSorting[nextSortIdx],sorting[0]._idx=nextSortIdx):(sorting.length=0,sorting.push([colIdx,asSorting[0]]),sorting[0]._idx=0);_fnReDraw(settings),"function"==typeof callback&&callback(settings)}function _fnSortAttachListener(settings,attachTo,colIdx,callback){var col=settings.aoColumns[colIdx];_fnBindAction(attachTo,{},function(e){!1!==col.bSortable&&(settings.oFeatures.bProcessing?(_fnProcessingDisplay(settings,!0),setTimeout(function(){_fnSortListener(settings,colIdx,e.shiftKey,callback),"ssp"!==_fnDataSource(settings)&&_fnProcessingDisplay(settings,!1)},0)):_fnSortListener(settings,colIdx,e.shiftKey,callback))})}function _fnSortingClasses(settings){var i,ien,colIdx,oldSort=settings.aLastSort,sortClass=settings.oClasses.sSortColumn,sort=_fnSortFlatten(settings),features=settings.oFeatures;if(features.bSort&&features.bSortClasses){for(i=0,ien=oldSort.length;i<ien;i++)colIdx=oldSort[i].src,$(_pluck(settings.aoData,"anCells",colIdx)).removeClass(sortClass+(i<2?i+1:3));for(i=0,ien=sort.length;i<ien;i++)colIdx=sort[i].src,$(_pluck(settings.aoData,"anCells",colIdx)).addClass(sortClass+(i<2?i+1:3))}settings.aLastSort=sort}function _fnSortData(settings,idx){var customData,row,cellData,column=settings.aoColumns[idx],customSort=DataTable.ext.order[column.sSortDataType];customSort&&(customData=customSort.call(settings.oInstance,settings,idx,_fnColumnIndexToVisible(settings,idx)));for(var formatter=DataTable.ext.type.order[column.sType+"-pre"],i=0,ien=settings.aoData.length;i<ien;i++)(row=settings.aoData[i])._aSortData||(row._aSortData=[]),row._aSortData[idx]&&!customSort||(cellData=customSort?customData[i]:_fnGetCellData(settings,i,idx,"sort"),row._aSortData[idx]=formatter?formatter(cellData):cellData)}function _fnSaveState(settings){if(settings.oFeatures.bStateSave&&!settings.bDestroying){var state={time:+new Date,start:settings._iDisplayStart,length:settings._iDisplayLength,order:$.extend(!0,[],settings.aaSorting),search:_fnSearchToCamel(settings.oPreviousSearch),columns:$.map(settings.aoColumns,function(col,i){return{visible:col.bVisible,search:_fnSearchToCamel(settings.aoPreSearchCols[i])}})};_fnCallbackFire(settings,"aoStateSaveParams","stateSaveParams",[settings,state]),settings.oSavedState=state,settings.fnStateSaveCallback.call(settings.oInstance,settings,state)}}function _fnLoadState(settings,oInit,callback){function loaded(s){if(s&&s.time){var abStateLoad=_fnCallbackFire(settings,"aoStateLoadParams","stateLoadParams",[settings,s]);if(-1===$.inArray(!1,abStateLoad)){var duration=settings.iStateDuration;if(0<duration&&s.time<new Date-1e3*duration)callback();else if(s.columns&&columns.length!==s.columns.length)callback();else{if(settings.oLoadedState=$.extend(!0,{},s),s.start!==undefined&&(settings._iDisplayStart=s.start,settings.iInitDisplayStart=s.start),s.length!==undefined&&(settings._iDisplayLength=s.length),s.order!==undefined&&(settings.aaSorting=[],$.each(s.order,function(i,col){settings.aaSorting.push(col[0]>=columns.length?[0,col[1]]:col)})),s.search!==undefined&&$.extend(settings.oPreviousSearch,_fnSearchToHung(s.search)),s.columns)for(i=0,ien=s.columns.length;i<ien;i++){var col=s.columns[i];col.visible!==undefined&&(columns[i].bVisible=col.visible),col.search!==undefined&&$.extend(settings.aoPreSearchCols[i],_fnSearchToHung(col.search))}_fnCallbackFire(settings,"aoStateLoaded","stateLoaded",[settings,s]),callback()}}else callback()}else callback()}var i,ien,columns=settings.aoColumns;if(settings.oFeatures.bStateSave){var state=settings.fnStateLoadCallback.call(settings.oInstance,settings,loaded);state!==undefined&&loaded(state)}else callback()}function _fnSettingsFromNode(table){var settings=DataTable.settings,idx=$.inArray(table,_pluck(settings,"nTable"));return-1!==idx?settings[idx]:null}function _fnLog(settings,level,msg,tn){if(msg="DataTables warning: "+(settings?"table id="+settings.sTableId+" - ":"")+msg,tn&&(msg+=". For more information about this error, please see http://datatables.net/tn/"+tn),level)window.console&&console.log&&console.log(msg);else{var ext=DataTable.ext,type=ext.sErrMode||ext.errMode;if(settings&&_fnCallbackFire(settings,null,"error",[settings,tn,msg]),"alert"==type)alert(msg);else{if("throw"==type)throw new Error(msg);"function"==typeof type&&type(settings,tn,msg)}}}function _fnMap(ret,src,name,mappedName){$.isArray(name)?$.each(name,function(i,val){$.isArray(val)?_fnMap(ret,src,val[0],val[1]):_fnMap(ret,src,val)}):(mappedName===undefined&&(mappedName=name),src[name]!==undefined&&(ret[mappedName]=src[name]))}function _fnExtend(out,extender,breakRefs){var val;for(var prop in extender)extender.hasOwnProperty(prop)&&(val=extender[prop],$.isPlainObject(val)?($.isPlainObject(out[prop])||(out[prop]={}),$.extend(!0,out[prop],val)):breakRefs&&"data"!==prop&&"aaData"!==prop&&$.isArray(val)?out[prop]=val.slice():out[prop]=val);return out}function _fnBindAction(n,oData,fn){$(n).on("click.DT",oData,function(e){$(n).blur(),fn(e)}).on("keypress.DT",oData,function(e){13===e.which&&(e.preventDefault(),fn(e))}).on("selectstart.DT",function(){return!1})}function _fnCallbackReg(oSettings,sStore,fn,sName){fn&&oSettings[sStore].push({fn:fn,sName:sName})}function _fnCallbackFire(settings,callbackArr,eventName,args){var ret=[];if(callbackArr&&(ret=$.map(settings[callbackArr].slice().reverse(),function(val,i){return val.fn.apply(settings.oInstance,args)})),null!==eventName){var e=$.Event(eventName+".dt");$(settings.nTable).trigger(e,args),ret.push(e.result)}return ret}function _fnLengthOverflow(settings){var start=settings._iDisplayStart,end=settings.fnDisplayEnd(),len=settings._iDisplayLength;end<=start&&(start=end-len),start-=start%len,(-1===len||start<0)&&(start=0),settings._iDisplayStart=start}function _fnRenderer(settings,type){var renderer=settings.renderer,host=DataTable.ext.renderer[type];return $.isPlainObject(renderer)&&renderer[type]?host[renderer[type]]||host._:"string"==typeof renderer&&host[renderer]||host._}function _fnDataSource(settings){return settings.oFeatures.bServerSide?"ssp":settings.ajax||settings.sAjaxSource?"ajax":"dom"}var __apiStruct=[],__arrayProto=Array.prototype;_Api=function(context,data){if(!(this instanceof _Api))return new _Api(context,data);function ctxSettings(o){var a=function(mixed){var idx,jq,settings=DataTable.settings,tables=$.map(settings,function(el,i){return el.nTable});return mixed?mixed.nTable&&mixed.oApi?[mixed]:mixed.nodeName&&"table"===mixed.nodeName.toLowerCase()?-1!==(idx=$.inArray(mixed,tables))?[settings[idx]]:null:mixed&&"function"==typeof mixed.settings?mixed.settings().toArray():("string"==typeof mixed?jq=$(mixed):mixed instanceof $&&(jq=mixed),jq?jq.map(function(i){return-1!==(idx=$.inArray(this,tables))?settings[idx]:null}).toArray():void 0):[]}(o);a&&settings.push.apply(settings,a)}var settings=[];if($.isArray(context))for(var i=0,ien=context.length;i<ien;i++)ctxSettings(context[i]);else ctxSettings(context);this.context=_unique(settings),data&&$.merge(this,data),this.selector={rows:null,cols:null,opts:null},_Api.extend(this,this,__apiStruct)},DataTable.Api=_Api,$.extend(_Api.prototype,{any:function(){return 0!==this.count()},concat:__arrayProto.concat,context:[],count:function(){return this.flatten().length},each:function(fn){for(var i=0,ien=this.length;i<ien;i++)fn.call(this,this[i],i,this);return this},eq:function(idx){var ctx=this.context;return ctx.length>idx?new _Api(ctx[idx],this[idx]):null},filter:function(fn){var a=[];if(__arrayProto.filter)a=__arrayProto.filter.call(this,fn,this);else for(var i=0,ien=this.length;i<ien;i++)fn.call(this,this[i],i,this)&&a.push(this[i]);return new _Api(this.context,a)},flatten:function(){var a=[];return new _Api(this.context,a.concat.apply(a,this.toArray()))},join:__arrayProto.join,indexOf:__arrayProto.indexOf||function(obj,start){for(var i=start||0,ien=this.length;i<ien;i++)if(this[i]===obj)return i;return-1},iterator:function(flatten,type,fn,alwaysNew){var ret,i,ien,j,jen,rows,items,item,a=[],context=this.context,selector=this.selector;for("string"==typeof flatten&&(alwaysNew=fn,fn=type,type=flatten,flatten=!1),i=0,ien=context.length;i<ien;i++){var apiInst=new _Api(context[i]);if("table"===type)(ret=fn.call(apiInst,context[i],i))!==undefined&&a.push(ret);else if("columns"===type||"rows"===type)(ret=fn.call(apiInst,context[i],this[i],i))!==undefined&&a.push(ret);else if("column"===type||"column-rows"===type||"row"===type||"cell"===type)for(items=this[i],"column-rows"===type&&(rows=_selector_row_indexes(context[i],selector.opts)),j=0,jen=items.length;j<jen;j++)item=items[j],(ret="cell"===type?fn.call(apiInst,context[i],item.row,item.column,i,j):fn.call(apiInst,context[i],item,i,j,rows))!==undefined&&a.push(ret)}if(a.length||alwaysNew){var api=new _Api(context,flatten?a.concat.apply([],a):a),apiSelector=api.selector;return apiSelector.rows=selector.rows,apiSelector.cols=selector.cols,apiSelector.opts=selector.opts,api}return this},lastIndexOf:__arrayProto.lastIndexOf||function(obj,start){return this.indexOf.apply(this.toArray.reverse(),arguments)},length:0,map:function(fn){var a=[];if(__arrayProto.map)a=__arrayProto.map.call(this,fn,this);else for(var i=0,ien=this.length;i<ien;i++)a.push(fn.call(this,this[i],i));return new _Api(this.context,a)},pluck:function(prop){return this.map(function(el){return el[prop]})},pop:__arrayProto.pop,push:__arrayProto.push,reduce:__arrayProto.reduce||function(fn,init){return _fnReduce(this,fn,init,0,this.length,1)},reduceRight:__arrayProto.reduceRight||function(fn,init){return _fnReduce(this,fn,init,this.length-1,-1,-1)},reverse:__arrayProto.reverse,selector:null,shift:__arrayProto.shift,slice:function(){return new _Api(this.context,this)},sort:__arrayProto.sort,splice:__arrayProto.splice,toArray:function(){return __arrayProto.slice.call(this)},to$:function(){return $(this)},toJQuery:function(){return $(this)},unique:function(){return new _Api(this.context,_unique(this))},unshift:__arrayProto.unshift}),_Api.extend=function(scope,obj,ext){if(ext.length&&obj&&(obj instanceof _Api||obj.__dt_wrapper)){var i,ien,struct,methodScoping=function(scope,fn,struc){return function(){var ret=fn.apply(scope,arguments);return _Api.extend(ret,ret,struc.methodExt),ret}};for(i=0,ien=ext.length;i<ien;i++)obj[(struct=ext[i]).name]="function"===struct.type?methodScoping(scope,struct.val,struct):"object"===struct.type?{}:struct.val,obj[struct.name].__dt_wrapper=!0,_Api.extend(scope,obj[struct.name],struct.propExt)}},_Api.register=_api_register=function(name,val){if($.isArray(name))for(var j=0,jen=name.length;j<jen;j++)_Api.register(name[j],val);else{var i,ien,key,method,heir=name.split("."),struct=__apiStruct,find=function(src,name){for(var i=0,ien=src.length;i<ien;i++)if(src[i].name===name)return src[i];return null};for(i=0,ien=heir.length;i<ien;i++){var src=find(struct,key=(method=-1!==heir[i].indexOf("()"))?heir[i].replace("()",""):heir[i]);src||(src={name:key,val:{},methodExt:[],propExt:[],type:"object"},struct.push(src)),i===ien-1?(src.val=val,src.type="function"==typeof val?"function":$.isPlainObject(val)?"object":"other"):struct=method?src.methodExt:src.propExt}}},_Api.registerPlural=_api_registerPlural=function(pluralName,singularName,val){_Api.register(pluralName,val),_Api.register(singularName,function(){var ret=val.apply(this,arguments);return ret===this?this:ret instanceof _Api?ret.length?$.isArray(ret[0])?new _Api(ret.context,ret[0]):ret[0]:undefined:ret})};_api_register("tables()",function(selector){return selector?new _Api(function(selector,a){if("number"==typeof selector)return[a[selector]];var nodes=$.map(a,function(el,i){return el.nTable});return $(nodes).filter(selector).map(function(i){var idx=$.inArray(this,nodes);return a[idx]}).toArray()}(selector,this.context)):this}),_api_register("table()",function(selector){var tables=this.tables(selector),ctx=tables.context;return ctx.length?new _Api(ctx[0]):tables}),_api_registerPlural("tables().nodes()","table().node()",function(){return this.iterator("table",function(ctx){return ctx.nTable},1)}),_api_registerPlural("tables().body()","table().body()",function(){return this.iterator("table",function(ctx){return ctx.nTBody},1)}),_api_registerPlural("tables().header()","table().header()",function(){return this.iterator("table",function(ctx){return ctx.nTHead},1)}),_api_registerPlural("tables().footer()","table().footer()",function(){return this.iterator("table",function(ctx){return ctx.nTFoot},1)}),_api_registerPlural("tables().containers()","table().container()",function(){return this.iterator("table",function(ctx){return ctx.nTableWrapper},1)}),_api_register("draw()",function(paging){return this.iterator("table",function(settings){"page"===paging?_fnDraw(settings):("string"==typeof paging&&(paging="full-hold"!==paging),_fnReDraw(settings,!1===paging))})}),_api_register("page()",function(action){return action===undefined?this.page.info().page:this.iterator("table",function(settings){_fnPageChange(settings,action)})}),_api_register("page.info()",function(action){if(0===this.context.length)return undefined;var settings=this.context[0],start=settings._iDisplayStart,len=settings.oFeatures.bPaginate?settings._iDisplayLength:-1,visRecords=settings.fnRecordsDisplay(),all=-1===len;return{page:all?0:Math.floor(start/len),pages:all?1:Math.ceil(visRecords/len),start:start,end:settings.fnDisplayEnd(),length:len,recordsTotal:settings.fnRecordsTotal(),recordsDisplay:visRecords,serverSide:"ssp"===_fnDataSource(settings)}}),_api_register("page.len()",function(len){return len===undefined?0!==this.context.length?this.context[0]._iDisplayLength:undefined:this.iterator("table",function(settings){_fnLengthChange(settings,len)})});function __reload(settings,holdPosition,callback){if(callback){var api=new _Api(settings);api.one("draw",function(){callback(api.ajax.json())})}if("ssp"==_fnDataSource(settings))_fnReDraw(settings,holdPosition);else{_fnProcessingDisplay(settings,!0);var xhr=settings.jqXHR;xhr&&4!==xhr.readyState&&xhr.abort(),_fnBuildAjax(settings,[],function(json){_fnClearTable(settings);for(var data=_fnAjaxDataSrc(settings,json),i=0,ien=data.length;i<ien;i++)_fnAddData(settings,data[i]);_fnReDraw(settings,holdPosition),_fnProcessingDisplay(settings,!1)})}}_api_register("ajax.json()",function(){var ctx=this.context;if(0<ctx.length)return ctx[0].json}),_api_register("ajax.params()",function(){var ctx=this.context;if(0<ctx.length)return ctx[0].oAjaxData}),_api_register("ajax.reload()",function(callback,resetPaging){return this.iterator("table",function(settings){__reload(settings,!1===resetPaging,callback)})}),_api_register("ajax.url()",function(url){var ctx=this.context;return url===undefined?0===ctx.length?undefined:(ctx=ctx[0]).ajax?$.isPlainObject(ctx.ajax)?ctx.ajax.url:ctx.ajax:ctx.sAjaxSource:this.iterator("table",function(settings){$.isPlainObject(settings.ajax)?settings.ajax.url=url:settings.ajax=url})}),_api_register("ajax.url().load()",function(callback,resetPaging){return this.iterator("table",function(ctx){__reload(ctx,!1===resetPaging,callback)})});function _selector_run(type,selector,selectFn,settings,opts){var res,a,i,ien,j,jen,out=[],selectorType=typeof selector;for(selector&&"string"!=selectorType&&"function"!=selectorType&&selector.length!==undefined||(selector=[selector]),i=0,ien=selector.length;i<ien;i++)for(j=0,jen=(a=selector[i]&&selector[i].split&&!selector[i].match(/[\[\(:]/)?selector[i].split(","):[selector[i]]).length;j<jen;j++)(res=selectFn("string"==typeof a[j]?$.trim(a[j]):a[j]))&&res.length&&(out=out.concat(res));var ext=_ext.selector[type];if(ext.length)for(i=0,ien=ext.length;i<ien;i++)out=ext[i](settings,opts,out);return _unique(out)}function _selector_opts(opts){return(opts=opts||{}).filter&&opts.search===undefined&&(opts.search=opts.filter),$.extend({search:"none",order:"current",page:"all"},opts)}function _selector_first(inst){for(var i=0,ien=inst.length;i<ien;i++)if(0<inst[i].length)return inst[0]=inst[i],inst[0].length=1,inst.length=1,inst.context=[inst.context[i]],inst;return inst.length=0,inst}var _selector_row_indexes=function(settings,opts){var tmp,a=[],displayFiltered=settings.aiDisplay,displayMaster=settings.aiDisplayMaster,search=opts.search,order=opts.order,page=opts.page;if("ssp"==_fnDataSource(settings))return"removed"===search?[]:_range(0,displayMaster.length);if("current"==page)for(i=settings._iDisplayStart,ien=settings.fnDisplayEnd();i<ien;i++)a.push(displayFiltered[i]);else if("current"==order||"applied"==order){if("none"==search)a=displayMaster.slice();else if("applied"==search)a=displayFiltered.slice();else if("removed"==search){for(var displayFilteredMap={},i=0,ien=displayFiltered.length;i<ien;i++)displayFilteredMap[displayFiltered[i]]=null;a=$.map(displayMaster,function(el){return displayFilteredMap.hasOwnProperty(el)?null:el})}}else if("index"==order||"original"==order)for(i=0,ien=settings.aoData.length;i<ien;i++)"none"==search?a.push(i):(-1===(tmp=$.inArray(i,displayFiltered))&&"removed"==search||0<=tmp&&"applied"==search)&&a.push(i);return a};_api_register("rows()",function(selector,opts){selector===undefined?selector="":$.isPlainObject(selector)&&(opts=selector,selector=""),opts=_selector_opts(opts);var inst=this.iterator("table",function(settings){return function(settings,selector,opts){var rows;return _selector_run("row",selector,function(sel){var selInt=_intVal(sel),aoData=settings.aoData;if(null!==selInt&&!opts)return[selInt];if(rows=rows||_selector_row_indexes(settings,opts),null!==selInt&&-1!==$.inArray(selInt,rows))return[selInt];if(null===sel||sel===undefined||""===sel)return rows;if("function"==typeof sel)return $.map(rows,function(idx){var row=aoData[idx];return sel(idx,row._aData,row.nTr)?idx:null});if(sel.nodeName){var rowIdx=sel._DT_RowIndex,cellIdx=sel._DT_CellIndex;if(rowIdx!==undefined)return aoData[rowIdx]&&aoData[rowIdx].nTr===sel?[rowIdx]:[];if(cellIdx)return aoData[cellIdx.row]&&aoData[cellIdx.row].nTr===sel.parentNode?[cellIdx.row]:[];var host=$(sel).closest("*[data-dt-row]");return host.length?[host.data("dt-row")]:[]}if("string"==typeof sel&&"#"===sel.charAt(0)){var rowObj=settings.aIds[sel.replace(/^#/,"")];if(rowObj!==undefined)return[rowObj.idx]}var nodes=_removeEmpty(_pluck_order(settings.aoData,rows,"nTr"));return $(nodes).filter(sel).map(function(){return this._DT_RowIndex}).toArray()},settings,opts)}(settings,selector,opts)},1);return inst.selector.rows=selector,inst.selector.opts=opts,inst}),_api_register("rows().nodes()",function(){return this.iterator("row",function(settings,row){return settings.aoData[row].nTr||undefined},1)}),_api_register("rows().data()",function(){return this.iterator(!0,"rows",function(settings,rows){return _pluck_order(settings.aoData,rows,"_aData")},1)}),_api_registerPlural("rows().cache()","row().cache()",function(type){return this.iterator("row",function(settings,row){var r=settings.aoData[row];return"search"===type?r._aFilterData:r._aSortData},1)}),_api_registerPlural("rows().invalidate()","row().invalidate()",function(src){return this.iterator("row",function(settings,row){_fnInvalidate(settings,row,src)})}),_api_registerPlural("rows().indexes()","row().index()",function(){return this.iterator("row",function(settings,row){return row},1)}),_api_registerPlural("rows().ids()","row().id()",function(hash){for(var a=[],context=this.context,i=0,ien=context.length;i<ien;i++)for(var j=0,jen=this[i].length;j<jen;j++){var id=context[i].rowIdFn(context[i].aoData[this[i][j]]._aData);a.push((!0===hash?"#":"")+id)}return new _Api(context,a)}),_api_registerPlural("rows().remove()","row().remove()",function(){var that=this;return this.iterator("row",function(settings,row,thatIdx){var i,ien,j,jen,loopRow,loopCells,data=settings.aoData,rowData=data[row];for(data.splice(row,1),i=0,ien=data.length;i<ien;i++)if(loopCells=(loopRow=data[i]).anCells,null!==loopRow.nTr&&(loopRow.nTr._DT_RowIndex=i),null!==loopCells)for(j=0,jen=loopCells.length;j<jen;j++)loopCells[j]._DT_CellIndex.row=i;_fnDeleteIndex(settings.aiDisplayMaster,row),_fnDeleteIndex(settings.aiDisplay,row),_fnDeleteIndex(that[thatIdx],row,!1),0<settings._iRecordsDisplay&&settings._iRecordsDisplay--,_fnLengthOverflow(settings);var id=settings.rowIdFn(rowData._aData);id!==undefined&&delete settings.aIds[id]}),this.iterator("table",function(settings){for(var i=0,ien=settings.aoData.length;i<ien;i++)settings.aoData[i].idx=i}),this}),_api_register("rows.add()",function(rows){var newRows=this.iterator("table",function(settings){var row,i,ien,out=[];for(i=0,ien=rows.length;i<ien;i++)(row=rows[i]).nodeName&&"TR"===row.nodeName.toUpperCase()?out.push(_fnAddTr(settings,row)[0]):out.push(_fnAddData(settings,row));return out},1),modRows=this.rows(-1);return modRows.pop(),$.merge(modRows,newRows),modRows}),_api_register("row()",function(selector,opts){return _selector_first(this.rows(selector,opts))}),_api_register("row().data()",function(data){var ctx=this.context;if(data===undefined)return ctx.length&&this.length?ctx[0].aoData[this[0]]._aData:undefined;var row=ctx[0].aoData[this[0]];return row._aData=data,$.isArray(data)&&row.nTr.id&&_fnSetObjectDataFn(ctx[0].rowId)(data,row.nTr.id),_fnInvalidate(ctx[0],this[0],"data"),this}),_api_register("row().node()",function(){var ctx=this.context;return ctx.length&&this.length&&ctx[0].aoData[this[0]].nTr||null}),_api_register("row.add()",function(row){row instanceof $&&row.length&&(row=row[0]);var rows=this.iterator("table",function(settings){return row.nodeName&&"TR"===row.nodeName.toUpperCase()?_fnAddTr(settings,row)[0]:_fnAddData(settings,row)});return this.row(rows[0])});function __details_remove(api,idx){var ctx=api.context;if(ctx.length){var row=ctx[0].aoData[idx!==undefined?idx:api[0]];row&&row._details&&(row._details.remove(),row._detailsShow=undefined,row._details=undefined)}}function __details_display(api,show){var ctx=api.context;if(ctx.length&&api.length){var row=ctx[0].aoData[api[0]];row._details&&((row._detailsShow=show)?row._details.insertAfter(row.nTr):row._details.detach(),__details_events(ctx[0]))}}var __details_events=function(settings){var api=new _Api(settings),data=settings.aoData;api.off("draw.dt.DT_details column-visibility.dt.DT_details destroy.dt.DT_details"),0<_pluck(data,"_details").length&&(api.on("draw.dt.DT_details",function(e,ctx){settings===ctx&&api.rows({page:"current"}).eq(0).each(function(idx){var row=data[idx];row._detailsShow&&row._details.insertAfter(row.nTr)})}),api.on("column-visibility.dt.DT_details",function(e,ctx,idx,vis){if(settings===ctx)for(var row,visible=_fnVisbleColumns(ctx),i=0,ien=data.length;i<ien;i++)(row=data[i])._details&&row._details.children("td[colspan]").attr("colspan",visible)}),api.on("destroy.dt.DT_details",function(e,ctx){if(settings===ctx)for(var i=0,ien=data.length;i<ien;i++)data[i]._details&&__details_remove(api,i)}))};_api_register("row().child()",function(data,klass){var ctx=this.context;return data===undefined?ctx.length&&this.length?ctx[0].aoData[this[0]]._details:undefined:(!0===data?this.child.show():!1===data?__details_remove(this):ctx.length&&this.length&&function(ctx,row,data,klass){var rows=[],addRow=function(r,k){if($.isArray(r)||r instanceof $)for(var i=0,ien=r.length;i<ien;i++)addRow(r[i],k);else if(r.nodeName&&"tr"===r.nodeName.toLowerCase())rows.push(r);else{var created=$("<tr><td/></tr>").addClass(k);$("td",created).addClass(k).html(r)[0].colSpan=_fnVisbleColumns(ctx),rows.push(created[0])}};addRow(data,klass),row._details&&row._details.detach(),row._details=$(rows),row._detailsShow&&row._details.insertAfter(row.nTr)}(ctx[0],ctx[0].aoData[this[0]],data,klass),this)}),_api_register(["row().child.show()","row().child().show()"],function(show){return __details_display(this,!0),this}),_api_register(["row().child.hide()","row().child().hide()"],function(){return __details_display(this,!1),this}),_api_register(["row().child.remove()","row().child().remove()"],function(){return __details_remove(this),this}),_api_register("row().child.isShown()",function(){var ctx=this.context;return ctx.length&&this.length&&ctx[0].aoData[this[0]]._detailsShow||!1});function __columnData(settings,column,r1,r2,rows){for(var a=[],row=0,ien=rows.length;row<ien;row++)a.push(_fnGetCellData(settings,rows[row],column));return a}var __re_column_selector=/^([^:]+):(name|visIdx|visible)$/;_api_register("columns()",function(selector,opts){selector===undefined?selector="":$.isPlainObject(selector)&&(opts=selector,selector=""),opts=_selector_opts(opts);var inst=this.iterator("table",function(settings){return function(settings,selector,opts){var columns=settings.aoColumns,names=_pluck(columns,"sName"),nodes=_pluck(columns,"nTh");return _selector_run("column",selector,function(s){var selInt=_intVal(s);if(""===s)return _range(columns.length);if(null!==selInt)return[0<=selInt?selInt:columns.length+selInt];if("function"==typeof s){var rows=_selector_row_indexes(settings,opts);return $.map(columns,function(col,idx){return s(idx,__columnData(settings,idx,0,0,rows),nodes[idx])?idx:null})}var match="string"==typeof s?s.match(__re_column_selector):"";if(match)switch(match[2]){case"visIdx":case"visible":var idx=parseInt(match[1],10);if(idx<0){var visColumns=$.map(columns,function(col,i){return col.bVisible?i:null});return[visColumns[visColumns.length+idx]]}return[_fnVisibleToColumnIndex(settings,idx)];case"name":return $.map(names,function(name,i){return name===match[1]?i:null});default:return[]}if(s.nodeName&&s._DT_CellIndex)return[s._DT_CellIndex.column];var jqResult=$(nodes).filter(s).map(function(){return $.inArray(this,nodes)}).toArray();if(jqResult.length||!s.nodeName)return jqResult;var host=$(s).closest("*[data-dt-column]");return host.length?[host.data("dt-column")]:[]},settings,opts)}(settings,selector,opts)},1);return inst.selector.cols=selector,inst.selector.opts=opts,inst}),_api_registerPlural("columns().header()","column().header()",function(selector,opts){return this.iterator("column",function(settings,column){return settings.aoColumns[column].nTh},1)}),_api_registerPlural("columns().footer()","column().footer()",function(selector,opts){return this.iterator("column",function(settings,column){return settings.aoColumns[column].nTf},1)}),_api_registerPlural("columns().data()","column().data()",function(){return this.iterator("column-rows",__columnData,1)}),_api_registerPlural("columns().dataSrc()","column().dataSrc()",function(){return this.iterator("column",function(settings,column){return settings.aoColumns[column].mData},1)}),_api_registerPlural("columns().cache()","column().cache()",function(type){return this.iterator("column-rows",function(settings,column,i,j,rows){return _pluck_order(settings.aoData,rows,"search"===type?"_aFilterData":"_aSortData",column)},1)}),_api_registerPlural("columns().nodes()","column().nodes()",function(){return this.iterator("column-rows",function(settings,column,i,j,rows){return _pluck_order(settings.aoData,rows,"anCells",column)},1)}),_api_registerPlural("columns().visible()","column().visible()",function(vis,calc){var that=this,ret=this.iterator("column",function(settings,column){if(vis===undefined)return settings.aoColumns[column].bVisible;!function(settings,column,vis){var cells,i,ien,tr,cols=settings.aoColumns,col=cols[column],data=settings.aoData;if(vis===undefined)return col.bVisible;if(col.bVisible!==vis){if(vis){var insertBefore=$.inArray(!0,_pluck(cols,"bVisible"),column+1);for(i=0,ien=data.length;i<ien;i++)tr=data[i].nTr,cells=data[i].anCells,tr&&tr.insertBefore(cells[column],cells[insertBefore]||null)}else $(_pluck(settings.aoData,"anCells",column)).detach();col.bVisible=vis}}(settings,column,vis)});return vis!==undefined&&this.iterator("table",function(settings){_fnDrawHead(settings,settings.aoHeader),_fnDrawHead(settings,settings.aoFooter),settings.aiDisplay.length||$(settings.nTBody).find("td[colspan]").attr("colspan",_fnVisbleColumns(settings)),_fnSaveState(settings),that.iterator("column",function(settings,column){_fnCallbackFire(settings,null,"column-visibility",[settings,column,vis,calc])}),calc!==undefined&&!calc||that.columns.adjust()}),ret}),_api_registerPlural("columns().indexes()","column().index()",function(type){return this.iterator("column",function(settings,column){return"visible"===type?_fnColumnIndexToVisible(settings,column):column},1)}),_api_register("columns.adjust()",function(){return this.iterator("table",function(settings){_fnAdjustColumnSizing(settings)},1)}),_api_register("column.index()",function(type,idx){if(0!==this.context.length){var ctx=this.context[0];if("fromVisible"===type||"toData"===type)return _fnVisibleToColumnIndex(ctx,idx);if("fromData"===type||"toVisible"===type)return _fnColumnIndexToVisible(ctx,idx)}}),_api_register("column()",function(selector,opts){return _selector_first(this.columns(selector,opts))});_api_register("cells()",function(rowSelector,columnSelector,opts){if($.isPlainObject(rowSelector)&&(rowSelector.row===undefined?(opts=rowSelector,rowSelector=null):(opts=columnSelector,columnSelector=null)),$.isPlainObject(columnSelector)&&(opts=columnSelector,columnSelector=null),null===columnSelector||columnSelector===undefined)return this.iterator("table",function(settings){return function(settings,selector,opts){var row,a,i,ien,j,o,host,data=settings.aoData,rows=_selector_row_indexes(settings,opts),cells=_removeEmpty(_pluck_order(data,rows,"anCells")),allCells=$([].concat.apply([],cells)),columns=settings.aoColumns.length;return _selector_run("cell",selector,function(s){var fnSelector="function"==typeof s;if(null===s||s===undefined||fnSelector){for(a=[],i=0,ien=rows.length;i<ien;i++)for(row=rows[i],j=0;j<columns;j++)o={row:row,column:j},fnSelector?(host=data[row],s(o,_fnGetCellData(settings,row,j),host.anCells?host.anCells[j]:null)&&a.push(o)):a.push(o);return a}if($.isPlainObject(s))return s.column!==undefined&&s.row!==undefined&&-1!==$.inArray(s.row,rows)?[s]:[];var jqResult=allCells.filter(s).map(function(i,el){return{row:el._DT_CellIndex.row,column:el._DT_CellIndex.column}}).toArray();return jqResult.length||!s.nodeName?jqResult:(host=$(s).closest("*[data-dt-row]")).length?[{row:host.data("dt-row"),column:host.data("dt-column")}]:[]},settings,opts)}(settings,rowSelector,_selector_opts(opts))});var i,ien,j,jen,internalOpts=opts?{page:opts.page,order:opts.order,search:opts.search}:{},columns=this.columns(columnSelector,internalOpts),rows=this.rows(rowSelector,internalOpts),cellsNoOpts=this.iterator("table",function(settings,idx){var a=[];for(i=0,ien=rows[idx].length;i<ien;i++)for(j=0,jen=columns[idx].length;j<jen;j++)a.push({row:rows[idx][i],column:columns[idx][j]});return a},1),cells=opts&&opts.selected?this.cells(cellsNoOpts,opts):cellsNoOpts;return $.extend(cells.selector,{cols:columnSelector,rows:rowSelector,opts:opts}),cells}),_api_registerPlural("cells().nodes()","cell().node()",function(){return this.iterator("cell",function(settings,row,column){var data=settings.aoData[row];return data&&data.anCells?data.anCells[column]:undefined},1)}),_api_register("cells().data()",function(){return this.iterator("cell",function(settings,row,column){return _fnGetCellData(settings,row,column)},1)}),_api_registerPlural("cells().cache()","cell().cache()",function(type){return type="search"===type?"_aFilterData":"_aSortData",this.iterator("cell",function(settings,row,column){return settings.aoData[row][type][column]},1)}),_api_registerPlural("cells().render()","cell().render()",function(type){return this.iterator("cell",function(settings,row,column){return _fnGetCellData(settings,row,column,type)},1)}),_api_registerPlural("cells().indexes()","cell().index()",function(){return this.iterator("cell",function(settings,row,column){return{row:row,column:column,columnVisible:_fnColumnIndexToVisible(settings,column)}},1)}),_api_registerPlural("cells().invalidate()","cell().invalidate()",function(src){return this.iterator("cell",function(settings,row,column){_fnInvalidate(settings,row,src,column)})}),_api_register("cell()",function(rowSelector,columnSelector,opts){return _selector_first(this.cells(rowSelector,columnSelector,opts))}),_api_register("cell().data()",function(data){var ctx=this.context,cell=this[0];return data===undefined?ctx.length&&cell.length?_fnGetCellData(ctx[0],cell[0].row,cell[0].column):undefined:(_fnSetCellData(ctx[0],cell[0].row,cell[0].column,data),_fnInvalidate(ctx[0],cell[0].row,"data",cell[0].column),this)}),_api_register("order()",function(order,dir){var ctx=this.context;return order===undefined?0!==ctx.length?ctx[0].aaSorting:undefined:("number"==typeof order?order=[[order,dir]]:order.length&&!$.isArray(order[0])&&(order=Array.prototype.slice.call(arguments)),this.iterator("table",function(settings){settings.aaSorting=order.slice()}))}),_api_register("order.listener()",function(node,column,callback){return this.iterator("table",function(settings){_fnSortAttachListener(settings,node,column,callback)})}),_api_register("order.fixed()",function(set){if(set)return this.iterator("table",function(settings){settings.aaSortingFixed=$.extend(!0,{},set)});var ctx=this.context,fixed=ctx.length?ctx[0].aaSortingFixed:undefined;return $.isArray(fixed)?{pre:fixed}:fixed}),_api_register(["columns().order()","column().order()"],function(dir){var that=this;return this.iterator("table",function(settings,i){var sort=[];$.each(that[i],function(j,col){sort.push([col,dir])}),settings.aaSorting=sort})}),_api_register("search()",function(input,regex,smart,caseInsen){var ctx=this.context;return input===undefined?0!==ctx.length?ctx[0].oPreviousSearch.sSearch:undefined:this.iterator("table",function(settings){settings.oFeatures.bFilter&&_fnFilterComplete(settings,$.extend({},settings.oPreviousSearch,{sSearch:input+"",bRegex:null!==regex&&regex,bSmart:null===smart||smart,bCaseInsensitive:null===caseInsen||caseInsen}),1)})}),_api_registerPlural("columns().search()","column().search()",function(input,regex,smart,caseInsen){return this.iterator("column",function(settings,column){var preSearch=settings.aoPreSearchCols;if(input===undefined)return preSearch[column].sSearch;settings.oFeatures.bFilter&&($.extend(preSearch[column],{sSearch:input+"",bRegex:null!==regex&&regex,bSmart:null===smart||smart,bCaseInsensitive:null===caseInsen||caseInsen}),_fnFilterComplete(settings,settings.oPreviousSearch,1))})}),_api_register("state()",function(){return this.context.length?this.context[0].oSavedState:null}),_api_register("state.clear()",function(){return this.iterator("table",function(settings){settings.fnStateSaveCallback.call(settings.oInstance,settings,{})})}),_api_register("state.loaded()",function(){return this.context.length?this.context[0].oLoadedState:null}),_api_register("state.save()",function(){return this.iterator("table",function(settings){_fnSaveState(settings)})}),DataTable.versionCheck=DataTable.fnVersionCheck=function(version){for(var iThis,iThat,aThis=DataTable.version.split("."),aThat=version.split("."),i=0,iLen=aThat.length;i<iLen;i++)if((iThis=parseInt(aThis[i],10)||0)!==(iThat=parseInt(aThat[i],10)||0))return iThat<iThis;return!0},DataTable.isDataTable=DataTable.fnIsDataTable=function(table){var t=$(table).get(0),is=!1;return table instanceof DataTable.Api||($.each(DataTable.settings,function(i,o){var head=o.nScrollHead?$("table",o.nScrollHead)[0]:null,foot=o.nScrollFoot?$("table",o.nScrollFoot)[0]:null;o.nTable!==t&&head!==t&&foot!==t||(is=!0)}),is)},DataTable.tables=DataTable.fnTables=function(visible){var api=!1;$.isPlainObject(visible)&&(api=visible.api,visible=visible.visible);var a=$.map(DataTable.settings,function(o){if(!visible||visible&&$(o.nTable).is(":visible"))return o.nTable});return api?new _Api(a):a},DataTable.camelToHungarian=_fnCamelToHungarian,_api_register("$()",function(selector,opts){var rows=this.rows(opts).nodes(),jqRows=$(rows);return $([].concat(jqRows.filter(selector).toArray(),jqRows.find(selector).toArray()))}),$.each(["on","one","off"],function(i,key){_api_register(key+"()",function(){var args=Array.prototype.slice.call(arguments);args[0]=$.map(args[0].split(/\s/),function(e){return e.match(/\.dt\b/)?e:e+".dt"}).join(" ");var inst=$(this.tables().nodes());return inst[key].apply(inst,args),this})}),_api_register("clear()",function(){return this.iterator("table",function(settings){_fnClearTable(settings)})}),_api_register("settings()",function(){return new _Api(this.context,this.context)}),_api_register("init()",function(){var ctx=this.context;return ctx.length?ctx[0].oInit:null}),_api_register("data()",function(){return this.iterator("table",function(settings){return _pluck(settings.aoData,"_aData")}).flatten()}),_api_register("destroy()",function(remove){return remove=remove||!1,this.iterator("table",function(settings){var ien,orig=settings.nTableWrapper.parentNode,classes=settings.oClasses,table=settings.nTable,tbody=settings.nTBody,thead=settings.nTHead,tfoot=settings.nTFoot,jqTable=$(table),jqTbody=$(tbody),jqWrapper=$(settings.nTableWrapper),rows=$.map(settings.aoData,function(r){return r.nTr});settings.bDestroying=!0,_fnCallbackFire(settings,"aoDestroyCallback","destroy",[settings]),remove||new _Api(settings).columns().visible(!0),jqWrapper.off(".DT").find(":not(tbody *)").off(".DT"),$(window).off(".DT-"+settings.sInstance),table!=thead.parentNode&&(jqTable.children("thead").detach(),jqTable.append(thead)),tfoot&&table!=tfoot.parentNode&&(jqTable.children("tfoot").detach(),jqTable.append(tfoot)),settings.aaSorting=[],settings.aaSortingFixed=[],_fnSortingClasses(settings),$(rows).removeClass(settings.asStripeClasses.join(" ")),$("th, td",thead).removeClass(classes.sSortable+" "+classes.sSortableAsc+" "+classes.sSortableDesc+" "+classes.sSortableNone),jqTbody.children().detach(),jqTbody.append(rows);var removedMethod=remove?"remove":"detach";jqTable[removedMethod](),jqWrapper[removedMethod](),!remove&&orig&&(orig.insertBefore(table,settings.nTableReinsertBefore),jqTable.css("width",settings.sDestroyWidth).removeClass(classes.sTable),(ien=settings.asDestroyStripes.length)&&jqTbody.children().each(function(i){$(this).addClass(settings.asDestroyStripes[i%ien])}));var idx=$.inArray(settings,DataTable.settings);-1!==idx&&DataTable.settings.splice(idx,1)})}),$.each(["column","row","cell"],function(i,type){_api_register(type+"s().every()",function(fn){var opts=this.selector.opts,api=this;return this.iterator(type,function(settings,arg1,arg2,arg3,arg4){fn.call(api[type](arg1,"cell"===type?arg2:opts,"cell"===type?opts:undefined),arg1,arg2,arg3,arg4)})})}),_api_register("i18n()",function(token,def,plural){var ctx=this.context[0],resolved=_fnGetObjectDataFn(token)(ctx.oLanguage);return resolved===undefined&&(resolved=def),plural!==undefined&&$.isPlainObject(resolved)&&(resolved=resolved[plural]!==undefined?resolved[plural]:resolved._),resolved.replace("%d",plural)}),DataTable.version="1.10.20",DataTable.settings=[],DataTable.models={},DataTable.models.oSearch={bCaseInsensitive:!0,sSearch:"",bRegex:!1,bSmart:!0},DataTable.models.oRow={nTr:null,anCells:null,_aData:[],_aSortData:null,_aFilterData:null,_sFilterRow:null,_sRowStripe:"",src:null,idx:-1},DataTable.models.oColumn={idx:null,aDataSort:null,asSorting:null,bSearchable:null,bSortable:null,bVisible:null,_sManualType:null,_bAttrSrc:!1,fnCreatedCell:null,fnGetData:null,fnSetData:null,mData:null,mRender:null,nTh:null,nTf:null,sClass:null,sContentPadding:null,sDefaultContent:null,sName:null,sSortDataType:"std",sSortingClass:null,sSortingClassJUI:null,sTitle:null,sType:null,sWidth:null,sWidthOrig:null},DataTable.defaults={aaData:null,aaSorting:[[0,"asc"]],aaSortingFixed:[],ajax:null,aLengthMenu:[10,25,50,100],aoColumns:null,aoColumnDefs:null,aoSearchCols:[],asStripeClasses:null,bAutoWidth:!0,bDeferRender:!1,bDestroy:!1,bFilter:!0,bInfo:!0,bLengthChange:!0,bPaginate:!0,bProcessing:!1,bRetrieve:!1,bScrollCollapse:!1,bServerSide:!1,bSort:!0,bSortMulti:!0,bSortCellsTop:!1,bSortClasses:!0,bStateSave:!1,fnCreatedRow:null,fnDrawCallback:null,fnFooterCallback:null,fnFormatNumber:function(toFormat){return toFormat.toString().replace(/\B(?=(\d{3})+(?!\d))/g,this.oLanguage.sThousands)},fnHeaderCallback:null,fnInfoCallback:null,fnInitComplete:null,fnPreDrawCallback:null,fnRowCallback:null,fnServerData:null,fnServerParams:null,fnStateLoadCallback:function(settings){try{return JSON.parse((-1===settings.iStateDuration?sessionStorage:localStorage).getItem("DataTables_"+settings.sInstance+"_"+location.pathname))}catch(e){}},fnStateLoadParams:null,fnStateLoaded:null,fnStateSaveCallback:function(settings,data){try{(-1===settings.iStateDuration?sessionStorage:localStorage).setItem("DataTables_"+settings.sInstance+"_"+location.pathname,JSON.stringify(data))}catch(e){}},fnStateSaveParams:null,iStateDuration:7200,iDeferLoading:null,iDisplayLength:10,iDisplayStart:0,iTabIndex:0,oClasses:{},oLanguage:{oAria:{sSortAscending:": activate to sort column ascending",sSortDescending:": activate to sort column descending"},oPaginate:{sFirst:"First",sLast:"Last",sNext:"Next",sPrevious:"Previous"},sEmptyTable:"No data available in table",sInfo:"Showing _START_ to _END_ of _TOTAL_ entries",sInfoEmpty:"Showing 0 to 0 of 0 entries",sInfoFiltered:"(filtered from _MAX_ total entries)",sInfoPostFix:"",sDecimal:"",sThousands:",",sLengthMenu:"Show _MENU_ entries",sLoadingRecords:"Loading...",sProcessing:"Processing...",sSearch:"Search:",sSearchPlaceholder:"",sUrl:"",sZeroRecords:"No matching records found"},oSearch:$.extend({},DataTable.models.oSearch),sAjaxDataProp:"data",sAjaxSource:null,sDom:"lfrtip",searchDelay:null,sPaginationType:"simple_numbers",sScrollX:"",sScrollXInner:"",sScrollY:"",sServerMethod:"GET",renderer:null,rowId:"DT_RowId"},_fnHungarianMap(DataTable.defaults),DataTable.defaults.column={aDataSort:null,iDataSort:-1,asSorting:["asc","desc"],bSearchable:!0,bSortable:!0,bVisible:!0,fnCreatedCell:null,mData:null,mRender:null,sCellType:"td",sClass:"",sContentPadding:"",sDefaultContent:null,sName:"",sSortDataType:"std",sTitle:null,sType:null,sWidth:null},_fnHungarianMap(DataTable.defaults.column),DataTable.models.oSettings={oFeatures:{bAutoWidth:null,bDeferRender:null,bFilter:null,bInfo:null,bLengthChange:null,bPaginate:null,bProcessing:null,bServerSide:null,bSort:null,bSortMulti:null,bSortClasses:null,bStateSave:null},oScroll:{bCollapse:null,iBarWidth:0,sX:null,sXInner:null,sY:null},oLanguage:{fnInfoCallback:null},oBrowser:{bScrollOversize:!1,bScrollbarLeft:!1,bBounding:!1,barWidth:0},ajax:null,aanFeatures:[],aoData:[],aiDisplay:[],aiDisplayMaster:[],aIds:{},aoColumns:[],aoHeader:[],aoFooter:[],oPreviousSearch:{},aoPreSearchCols:[],aaSorting:null,aaSortingFixed:[],asStripeClasses:null,asDestroyStripes:[],sDestroyWidth:0,aoRowCallback:[],aoHeaderCallback:[],aoFooterCallback:[],aoDrawCallback:[],aoRowCreatedCallback:[],aoPreDrawCallback:[],aoInitComplete:[],aoStateSaveParams:[],aoStateLoadParams:[],aoStateLoaded:[],sTableId:"",nTable:null,nTHead:null,nTFoot:null,nTBody:null,nTableWrapper:null,bDeferLoading:!1,bInitialised:!1,aoOpenRows:[],sDom:null,searchDelay:null,sPaginationType:"two_button",iStateDuration:0,aoStateSave:[],aoStateLoad:[],oSavedState:null,oLoadedState:null,sAjaxSource:null,sAjaxDataProp:null,bAjaxDataGet:!0,jqXHR:null,json:undefined,oAjaxData:undefined,fnServerData:null,aoServerParams:[],sServerMethod:null,fnFormatNumber:null,aLengthMenu:null,iDraw:0,bDrawing:!1,iDrawError:-1,_iDisplayLength:10,_iDisplayStart:0,_iRecordsTotal:0,_iRecordsDisplay:0,oClasses:{},bFiltered:!1,bSorted:!1,bSortCellsTop:null,oInit:null,aoDestroyCallback:[],fnRecordsTotal:function(){return"ssp"==_fnDataSource(this)?1*this._iRecordsTotal:this.aiDisplayMaster.length},fnRecordsDisplay:function(){return"ssp"==_fnDataSource(this)?1*this._iRecordsDisplay:this.aiDisplay.length},fnDisplayEnd:function(){var len=this._iDisplayLength,start=this._iDisplayStart,calc=start+len,records=this.aiDisplay.length,features=this.oFeatures,paginate=features.bPaginate;return features.bServerSide?!1===paginate||-1===len?start+records:Math.min(start+len,this._iRecordsDisplay):!paginate||records<calc||-1===len?records:calc},oInstance:null,sInstance:null,iTabIndex:0,nScrollHead:null,nScrollFoot:null,aLastSort:[],oPlugins:{},rowIdFn:null,rowId:null},DataTable.ext=_ext={buttons:{},classes:{},builder:"-source-",errMode:"alert",feature:[],search:[],selector:{cell:[],column:[],row:[]},internal:{},legacy:{ajax:null},pager:{},renderer:{pageButton:{},header:{}},order:{},type:{detect:[],search:{},order:{}},_unique:0,fnVersionCheck:DataTable.fnVersionCheck,iApiIndex:0,oJUIClasses:{},sVersion:DataTable.version},$.extend(_ext,{afnFiltering:_ext.search,aTypes:_ext.type.detect,ofnSearch:_ext.type.search,oSort:_ext.type.order,afnSortData:_ext.order,aoFeatures:_ext.feature,oApi:_ext.internal,oStdClasses:_ext.classes,oPagination:_ext.pager}),$.extend(DataTable.ext.classes,{sTable:"dataTable",sNoFooter:"no-footer",sPageButton:"paginate_button",sPageButtonActive:"current",sPageButtonDisabled:"disabled",sStripeOdd:"odd",sStripeEven:"even",sRowEmpty:"dataTables_empty",sWrapper:"dataTables_wrapper",sFilter:"dataTables_filter",sInfo:"dataTables_info",sPaging:"dataTables_paginate paging_",sLength:"dataTables_length",sProcessing:"dataTables_processing",sSortAsc:"sorting_asc",sSortDesc:"sorting_desc",sSortable:"sorting",sSortableAsc:"sorting_asc_disabled",sSortableDesc:"sorting_desc_disabled",sSortableNone:"sorting_disabled",sSortColumn:"sorting_",sFilterInput:"",sLengthSelect:"",sScrollWrapper:"dataTables_scroll",sScrollHead:"dataTables_scrollHead",sScrollHeadInner:"dataTables_scrollHeadInner",sScrollBody:"dataTables_scrollBody",sScrollFoot:"dataTables_scrollFoot",sScrollFootInner:"dataTables_scrollFootInner",sHeaderTH:"",sFooterTH:"",sSortJUIAsc:"",sSortJUIDesc:"",sSortJUI:"",sSortJUIAscAllowed:"",sSortJUIDescAllowed:"",sSortJUIWrapper:"",sSortIcon:"",sJUIHeader:"",sJUIFooter:""});var extPagination=DataTable.ext.pager;function _numbers(page,pages){var numbers=[],buttons=extPagination.numbers_length,half=Math.floor(buttons/2);return pages<=buttons?numbers=_range(0,pages):page<=half?((numbers=_range(0,buttons-2)).push("ellipsis"),numbers.push(pages-1)):(pages-1-half<=page?(numbers=_range(pages-(buttons-2),pages)).splice(0,0,"ellipsis"):((numbers=_range(page-half+2,page+half-1)).push("ellipsis"),numbers.push(pages-1),numbers.splice(0,0,"ellipsis")),numbers.splice(0,0,0)),numbers.DT_el="span",numbers}$.extend(extPagination,{simple:function(page,pages){return["previous","next"]},full:function(page,pages){return["first","previous","next","last"]},numbers:function(page,pages){return[_numbers(page,pages)]},simple_numbers:function(page,pages){return["previous",_numbers(page,pages),"next"]},full_numbers:function(page,pages){return["first","previous",_numbers(page,pages),"next","last"]},first_last_numbers:function(page,pages){return["first",_numbers(page,pages),"last"]},_numbers:_numbers,numbers_length:7}),$.extend(!0,DataTable.ext.renderer,{pageButton:{_:function(settings,host,idx,buttons,page,pages){var btnDisplay,btnClass,activeEl,classes=settings.oClasses,lang=settings.oLanguage.oPaginate,aria=settings.oLanguage.oAria.paginate||{},counter=0,attach=function(container,buttons){function clickHandler(e){_fnPageChange(settings,e.data.action,!0)}var i,ien,button,tabIndex,disabledClass=classes.sPageButtonDisabled;for(i=0,ien=buttons.length;i<ien;i++)if(button=buttons[i],$.isArray(button)){var inner=$("<"+(button.DT_el||"div")+"/>").appendTo(container);attach(inner,button)}else{switch(btnDisplay=null,btnClass=button,tabIndex=settings.iTabIndex,button){case"ellipsis":container.append('<span class="ellipsis">&#x2026;</span>');break;case"first":btnDisplay=lang.sFirst,0===page&&(tabIndex=-1,btnClass+=" "+disabledClass);break;case"previous":btnDisplay=lang.sPrevious,0===page&&(tabIndex=-1,btnClass+=" "+disabledClass);break;case"next":btnDisplay=lang.sNext,page===pages-1&&(tabIndex=-1,btnClass+=" "+disabledClass);break;case"last":btnDisplay=lang.sLast,page===pages-1&&(tabIndex=-1,btnClass+=" "+disabledClass);break;default:btnDisplay=button+1,btnClass=page===button?classes.sPageButtonActive:""}null!==btnDisplay&&(_fnBindAction($("<a>",{class:classes.sPageButton+" "+btnClass,"aria-controls":settings.sTableId,"aria-label":aria[button],"data-dt-idx":counter,tabindex:tabIndex,id:0===idx&&"string"==typeof button?settings.sTableId+"_"+button:null}).html(btnDisplay).appendTo(container),{action:button},clickHandler),counter++)}};try{activeEl=$(host).find(document.activeElement).data("dt-idx")}catch(e){}attach($(host).empty(),buttons),activeEl!==undefined&&$(host).find("[data-dt-idx="+activeEl+"]").focus()}}}),$.extend(DataTable.ext.type.detect,[function(d,settings){var decimal=settings.oLanguage.sDecimal;return _isNumber(d,decimal)?"num"+decimal:null},function(d,settings){if(d&&!(d instanceof Date)&&!_re_date.test(d))return null;var parsed=Date.parse(d);return null!==parsed&&!isNaN(parsed)||_empty(d)?"date":null},function(d,settings){var decimal=settings.oLanguage.sDecimal;return _isNumber(d,decimal,!0)?"num-fmt"+decimal:null},function(d,settings){var decimal=settings.oLanguage.sDecimal;return _htmlNumeric(d,decimal)?"html-num"+decimal:null},function(d,settings){var decimal=settings.oLanguage.sDecimal;return _htmlNumeric(d,decimal,!0)?"html-num-fmt"+decimal:null},function(d,settings){return _empty(d)||"string"==typeof d&&-1!==d.indexOf("<")?"html":null}]),$.extend(DataTable.ext.type.search,{html:function(data){return _empty(data)?data:"string"==typeof data?data.replace(_re_new_lines," ").replace(_re_html,""):""},string:function(data){return _empty(data)?data:"string"==typeof data?data.replace(_re_new_lines," "):data}});var __numericReplace=function(d,decimalPlace,re1,re2){return 0===d||d&&"-"!==d?(decimalPlace&&(d=_numToDecimal(d,decimalPlace)),d.replace&&(re1&&(d=d.replace(re1,"")),re2&&(d=d.replace(re2,""))),1*d):-1/0};function _addNumericSort(decimalPlace){$.each({num:function(d){return __numericReplace(d,decimalPlace)},"num-fmt":function(d){return __numericReplace(d,decimalPlace,_re_formatted_numeric)},"html-num":function(d){return __numericReplace(d,decimalPlace,_re_html)},"html-num-fmt":function(d){return __numericReplace(d,decimalPlace,_re_html,_re_formatted_numeric)}},function(key,fn){_ext.type.order[key+decimalPlace+"-pre"]=fn,key.match(/^html\-/)&&(_ext.type.search[key+decimalPlace]=_ext.type.search.html)})}$.extend(_ext.type.order,{"date-pre":function(d){var ts=Date.parse(d);return isNaN(ts)?-1/0:ts},"html-pre":function(a){return _empty(a)?"":a.replace?a.replace(/<.*?>/g,"").toLowerCase():a+""},"string-pre":function(a){return _empty(a)?"":"string"==typeof a?a.toLowerCase():a.toString?a.toString():""},"string-asc":function(x,y){return x<y?-1:y<x?1:0},"string-desc":function(x,y){return x<y?1:y<x?-1:0}}),_addNumericSort(""),$.extend(!0,DataTable.ext.renderer,{header:{_:function(settings,cell,column,classes){$(settings.nTable).on("order.dt.DT",function(e,ctx,sorting,columns){if(settings===ctx){var colIdx=column.idx;cell.removeClass(column.sSortingClass+" "+classes.sSortAsc+" "+classes.sSortDesc).addClass("asc"==columns[colIdx]?classes.sSortAsc:"desc"==columns[colIdx]?classes.sSortDesc:column.sSortingClass)}})},jqueryui:function(settings,cell,column,classes){$("<div/>").addClass(classes.sSortJUIWrapper).append(cell.contents()).append($("<span/>").addClass(classes.sSortIcon+" "+column.sSortingClassJUI)).appendTo(cell),$(settings.nTable).on("order.dt.DT",function(e,ctx,sorting,columns){if(settings===ctx){var colIdx=column.idx;cell.removeClass(classes.sSortAsc+" "+classes.sSortDesc).addClass("asc"==columns[colIdx]?classes.sSortAsc:"desc"==columns[colIdx]?classes.sSortDesc:column.sSortingClass),cell.find("span."+classes.sSortIcon).removeClass(classes.sSortJUIAsc+" "+classes.sSortJUIDesc+" "+classes.sSortJUI+" "+classes.sSortJUIAscAllowed+" "+classes.sSortJUIDescAllowed).addClass("asc"==columns[colIdx]?classes.sSortJUIAsc:"desc"==columns[colIdx]?classes.sSortJUIDesc:column.sSortingClassJUI)}})}}});function __htmlEscapeEntities(d){return"string"==typeof d?d.replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;"):d}function _fnExternApiFunc(fn){return function(){var args=[_fnSettingsFromNode(this[DataTable.ext.iApiIndex])].concat(Array.prototype.slice.call(arguments));return DataTable.ext.internal[fn].apply(this,args)}}return DataTable.render={number:function(thousands,decimal,precision,prefix,postfix){return{display:function(d){if("number"!=typeof d&&"string"!=typeof d)return d;var negative=d<0?"-":"",flo=parseFloat(d);if(isNaN(flo))return __htmlEscapeEntities(d);flo=flo.toFixed(precision),d=Math.abs(flo);var intPart=parseInt(d,10),floatPart=precision?decimal+(d-intPart).toFixed(precision).substring(2):"";return negative+(prefix||"")+intPart.toString().replace(/\B(?=(\d{3})+(?!\d))/g,thousands)+floatPart+(postfix||"")}}},text:function(){return{display:__htmlEscapeEntities,filter:__htmlEscapeEntities}}},$.extend(DataTable.ext.internal,{_fnExternApiFunc:_fnExternApiFunc,_fnBuildAjax:_fnBuildAjax,_fnAjaxUpdate:_fnAjaxUpdate,_fnAjaxParameters:_fnAjaxParameters,_fnAjaxUpdateDraw:_fnAjaxUpdateDraw,_fnAjaxDataSrc:_fnAjaxDataSrc,_fnAddColumn:_fnAddColumn,_fnColumnOptions:_fnColumnOptions,_fnAdjustColumnSizing:_fnAdjustColumnSizing,_fnVisibleToColumnIndex:_fnVisibleToColumnIndex,_fnColumnIndexToVisible:_fnColumnIndexToVisible,_fnVisbleColumns:_fnVisbleColumns,_fnGetColumns:_fnGetColumns,_fnColumnTypes:_fnColumnTypes,_fnApplyColumnDefs:_fnApplyColumnDefs,_fnHungarianMap:_fnHungarianMap,_fnCamelToHungarian:_fnCamelToHungarian,_fnLanguageCompat:_fnLanguageCompat,_fnBrowserDetect:_fnBrowserDetect,_fnAddData:_fnAddData,_fnAddTr:_fnAddTr,_fnNodeToDataIndex:function(oSettings,n){return n._DT_RowIndex!==undefined?n._DT_RowIndex:null},_fnNodeToColumnIndex:function(oSettings,iRow,n){return $.inArray(n,oSettings.aoData[iRow].anCells)},_fnGetCellData:_fnGetCellData,_fnSetCellData:_fnSetCellData,_fnSplitObjNotation:_fnSplitObjNotation,_fnGetObjectDataFn:_fnGetObjectDataFn,_fnSetObjectDataFn:_fnSetObjectDataFn,_fnGetDataMaster:_fnGetDataMaster,_fnClearTable:_fnClearTable,_fnDeleteIndex:_fnDeleteIndex,_fnInvalidate:_fnInvalidate,_fnGetRowElements:_fnGetRowElements,_fnCreateTr:_fnCreateTr,_fnBuildHead:_fnBuildHead,_fnDrawHead:_fnDrawHead,_fnDraw:_fnDraw,_fnReDraw:_fnReDraw,_fnAddOptionsHtml:_fnAddOptionsHtml,_fnDetectHeader:_fnDetectHeader,_fnGetUniqueThs:_fnGetUniqueThs,_fnFeatureHtmlFilter:_fnFeatureHtmlFilter,_fnFilterComplete:_fnFilterComplete,_fnFilterCustom:_fnFilterCustom,_fnFilterColumn:_fnFilterColumn,_fnFilter:_fnFilter,_fnFilterCreateSearch:_fnFilterCreateSearch,_fnEscapeRegex:_fnEscapeRegex,_fnFilterData:_fnFilterData,_fnFeatureHtmlInfo:_fnFeatureHtmlInfo,_fnUpdateInfo:_fnUpdateInfo,_fnInfoMacros:_fnInfoMacros,_fnInitialise:_fnInitialise,_fnInitComplete:_fnInitComplete,_fnLengthChange:_fnLengthChange,_fnFeatureHtmlLength:_fnFeatureHtmlLength,_fnFeatureHtmlPaginate:_fnFeatureHtmlPaginate,_fnPageChange:_fnPageChange,_fnFeatureHtmlProcessing:_fnFeatureHtmlProcessing,_fnProcessingDisplay:_fnProcessingDisplay,_fnFeatureHtmlTable:_fnFeatureHtmlTable,_fnScrollDraw:_fnScrollDraw,_fnApplyToChildren:_fnApplyToChildren,_fnCalculateColumnWidths:_fnCalculateColumnWidths,_fnThrottle:_fnThrottle,_fnConvertToWidth:_fnConvertToWidth,_fnGetWidestNode:_fnGetWidestNode,_fnGetMaxLenString:_fnGetMaxLenString,_fnStringToCss:_fnStringToCss,_fnSortFlatten:_fnSortFlatten,_fnSort:_fnSort,_fnSortAria:_fnSortAria,_fnSortListener:_fnSortListener,_fnSortAttachListener:_fnSortAttachListener,_fnSortingClasses:_fnSortingClasses,_fnSortData:_fnSortData,_fnSaveState:_fnSaveState,_fnLoadState:_fnLoadState,_fnSettingsFromNode:_fnSettingsFromNode,_fnLog:_fnLog,_fnMap:_fnMap,_fnBindAction:_fnBindAction,_fnCallbackReg:_fnCallbackReg,_fnCallbackFire:_fnCallbackFire,_fnLengthOverflow:_fnLengthOverflow,_fnRenderer:_fnRenderer,_fnDataSource:_fnDataSource,_fnRowAttributes:_fnRowAttributes,_fnExtend:_fnExtend,_fnCalculateEnd:function(){}}),(($.fn.dataTable=DataTable).$=$).fn.dataTableSettings=DataTable.settings,$.fn.dataTableExt=DataTable.ext,$.fn.DataTable=function(opts){return $(this).dataTable(opts).api()},$.each(DataTable,function(prop,val){$.fn.DataTable[prop]=val}),$.fn.dataTable}),function(factory){"function"==typeof define&&define.amd?define(["jquery","datatables.net"],function($){return factory($,window,document)}):"object"==typeof exports?module.exports=function(root,$){return root=root||window,$&&$.fn.dataTable||($=require("datatables.net")(root,$).$),factory($,root,root.document)}:factory(jQuery,window,document)}(function($,window,document,undefined){"use strict";var DataTable=$.fn.dataTable,RowGroup=function(dt,opts){if(!DataTable.versionCheck||!DataTable.versionCheck("1.10.8"))throw"RowGroup requires DataTables 1.10.8 or newer";this.c=$.extend(!0,{},DataTable.defaults.rowGroup,RowGroup.defaults,opts),this.s={dt:new DataTable.Api(dt)},this.dom={};var settings=this.s.dt.settings()[0],existing=settings.rowGroup;if(existing)return existing;(settings.rowGroup=this)._constructor()};return $.extend(RowGroup.prototype,{dataSrc:function(val){if(val===undefined)return this.c.dataSrc;var dt=this.s.dt;return this.c.dataSrc=val,$(dt.table().node()).triggerHandler("rowgroup-datasrc.dt",[dt,val]),this},disable:function(){return this.c.enable=!1,this},enable:function(flag){return!1===flag?this.disable():(this.c.enable=!0,this)},_constructor:function(){var that=this,dt=this.s.dt;dt.on("draw.dtrg",function(){that.c.enable&&that._draw()}),dt.on("column-visibility.dt.dtrg responsive-resize.dt.dtrg",function(){that._adjustColspan()}),dt.on("destroy",function(){dt.off(".dtrg")}),dt.on("responsive-resize.dt",function(){that._adjustColspan()})},_adjustColspan:function(){$("tr."+this.c.className,this.s.dt.table().body()).find("td").attr("colspan",this._colspan())},_colspan:function(){return this.s.dt.columns().visible().reduce(function(a,b){return a+b},0)},_draw:function(){var dt=this.s.dt,groupedRows=this._group(0,dt.rows({page:"current"}).indexes());this._groupDisplay(0,groupedRows)},_group:function(level,rows){for(var last,fns=$.isArray(this.c.dataSrc)?this.c.dataSrc:[this.c.dataSrc],fn=DataTable.ext.oApi._fnGetObjectDataFn(fns[level]),dt=this.s.dt,data=[],i=0,ien=rows.length;i<ien;i++){var group,rowIndex=rows[i];null!==(group=fn(dt.row(rowIndex).data()))&&group!==undefined||(group=this.c.emptyDataGroup),last!==undefined&&group===last||(data.push({dataPoint:group,rows:[]}),last=group),data[data.length-1].rows.push(rowIndex)}if(fns[level+1]!==undefined)for(i=0,ien=data.length;i<ien;i++)data[i].children=this._group(level+1,data[i].rows);return data},_groupDisplay:function(level,groups){for(var display,dt=this.s.dt,i=0,ien=groups.length;i<ien;i++){var row,group=groups[i],groupName=group.dataPoint,rows=group.rows;this.c.startRender&&(display=this.c.startRender.call(this,dt.rows(rows),groupName,level),(row=this._rowWrap(display,this.c.startClassName,level))&&row.insertBefore(dt.row(rows[0]).node())),this.c.endRender&&(display=this.c.endRender.call(this,dt.rows(rows),groupName,level),(row=this._rowWrap(display,this.c.endClassName,level))&&row.insertAfter(dt.row(rows[rows.length-1]).node())),group.children&&this._groupDisplay(level+1,group.children)}},_rowWrap:function(display,className,level){return null!==display&&""!==display||(display=this.c.emptyDataGroup),display===undefined||null===display?null:("object"==typeof display&&display.nodeName&&"tr"===display.nodeName.toLowerCase()?$(display):display instanceof $&&display.length&&"tr"===display[0].nodeName.toLowerCase()?display:$("<tr/>").append($("<td/>").attr("colspan",this._colspan()).append(display))).addClass(this.c.className).addClass(className).addClass("dtrg-level-"+level)}}),RowGroup.defaults={className:"dtrg-group",dataSrc:0,emptyDataGroup:"No group",enable:!0,endClassName:"dtrg-end",endRender:null,startClassName:"dtrg-start",startRender:function(rows,group){return group}},RowGroup.version="1.1.1",$.fn.dataTable.RowGroup=RowGroup,$.fn.DataTable.RowGroup=RowGroup,DataTable.Api.register("rowGroup()",function(){return this}),DataTable.Api.register("rowGroup().disable()",function(){return this.iterator("table",function(ctx){ctx.rowGroup&&ctx.rowGroup.enable(!1)})}),DataTable.Api.register("rowGroup().enable()",function(opts){return this.iterator("table",function(ctx){ctx.rowGroup&&ctx.rowGroup.enable(opts===undefined||opts)})}),DataTable.Api.register("rowGroup().dataSrc()",function(val){return val===undefined?this.context[0].rowGroup.dataSrc():this.iterator("table",function(ctx){ctx.rowGroup&&ctx.rowGroup.dataSrc(val)})}),$(document).on("preInit.dt.dtrg",function(e,settings,json){if("dt"===e.namespace){var init=settings.oInit.rowGroup,defaults=DataTable.defaults.rowGroup;if(init||defaults){var opts=$.extend({},defaults,init);!1!==init&&new RowGroup(settings,opts)}}}),RowGroup}),function(factory){"function"==typeof define&&define.amd?define(["jquery","datatables.net"],function($){return factory($,window,document)}):"object"==typeof exports?module.exports=function(root,$){return root=root||window,$&&$.fn.dataTable||($=require("datatables.net")(root,$).$),factory($,root,root.document)}:factory(jQuery,window,document)}(function($,window,document,undefined){"use strict";var DataTable=$.fn.dataTable,RowReorder=function(dt,opts){if(!DataTable.versionCheck||!DataTable.versionCheck("1.10.8"))throw"DataTables RowReorder requires DataTables 1.10.8 or newer";this.c=$.extend(!0,{},DataTable.defaults.rowReorder,RowReorder.defaults,opts),this.s={bodyTop:null,dt:new DataTable.Api(dt),getDataFn:DataTable.ext.oApi._fnGetObjectDataFn(this.c.dataSrc),middles:null,scroll:{},scrollInterval:null,setDataFn:DataTable.ext.oApi._fnSetObjectDataFn(this.c.dataSrc),start:{top:0,left:0,offsetTop:0,offsetLeft:0,nodes:[]},windowHeight:0,documentOuterHeight:0,domCloneOuterHeight:0},this.dom={clone:null,dtScroll:$("div.dataTables_scrollBody",this.s.dt.table().container())};var settings=this.s.dt.settings()[0],exisiting=settings.rowreorder;if(exisiting)return exisiting;(settings.rowreorder=this)._constructor()};$.extend(RowReorder.prototype,{_constructor:function(){var that=this,dt=this.s.dt,table=$(dt.table().node());"static"===table.css("position")&&table.css("position","relative"),$(dt.table().container()).on("mousedown.rowReorder touchstart.rowReorder",this.c.selector,function(e){if(that.c.enable){if($(e.target).is(that.c.excludedChildren))return!0;var tr=$(this).closest("tr"),row=dt.row(tr);return row.any()?(that._emitEvent("pre-row-reorder",{node:row.node(),index:row.index()}),that._mouseDown(e,tr),!1):void 0}}),dt.on("destroy.rowReorder",function(){$(dt.table().container()).off(".rowReorder"),dt.off(".rowReorder")})},_cachePositions:function(){var dt=this.s.dt,headerHeight=$(dt.table().node()).find("thead").outerHeight(),nodes=$.unique(dt.rows({page:"current"}).nodes().toArray()),tops=$.map(nodes,function(node,i){return $(node).position().top-headerHeight}),middles=$.map(tops,function(top,i){return tops.length<i-1?(top+tops[i+1])/2:(top+top+$(dt.row(":last-child").node()).outerHeight())/2});this.s.middles=middles,this.s.bodyTop=$(dt.table().body()).offset().top,this.s.windowHeight=$(window).height(),this.s.documentOuterHeight=$(document).outerHeight()},_clone:function(target){var dt=this.s.dt,clone=$(dt.table().node().cloneNode(!1)).addClass("dt-rowReorder-float").append("<tbody/>").append(target.clone(!1)),tableWidth=target.outerWidth(),tableHeight=target.outerHeight(),sizes=target.children().map(function(){return $(this).width()});clone.width(tableWidth).height(tableHeight).find("tr").children().each(function(i){this.style.width=sizes[i]+"px"}),clone.appendTo("body"),this.dom.clone=clone,this.s.domCloneOuterHeight=clone.outerHeight()},_clonePosition:function(e){var left,start=this.s.start,topDiff=this._eventToPage(e,"Y")-start.top,leftDiff=this._eventToPage(e,"X")-start.left,snap=this.c.snapX,top=topDiff+start.offsetTop;left=!0===snap?start.offsetLeft:"number"==typeof snap?start.offsetLeft+snap:leftDiff+start.offsetLeft,top<0?top=0:top+this.s.domCloneOuterHeight>this.s.documentOuterHeight&&(top=this.s.documentOuterHeight-this.s.domCloneOuterHeight),this.dom.clone.css({top:top,left:left})},_emitEvent:function(name,args){this.s.dt.iterator("table",function(ctx,i){$(ctx.nTable).triggerHandler(name+".dt",args)})},_eventToPage:function(e,pos){return-1!==e.type.indexOf("touch")?e.originalEvent.touches[0]["page"+pos]:e["page"+pos]},_mouseDown:function(e,target){var that=this,dt=this.s.dt,start=this.s.start,offset=target.offset();start.top=this._eventToPage(e,"Y"),start.left=this._eventToPage(e,"X"),start.offsetTop=offset.top,start.offsetLeft=offset.left,start.nodes=$.unique(dt.rows({page:"current"}).nodes().toArray()),this._cachePositions(),this._clone(target),this._clonePosition(e),(this.dom.target=target).addClass("dt-rowReorder-moving"),$(document).on("mouseup.rowReorder touchend.rowReorder",function(e){that._mouseUp(e)}).on("mousemove.rowReorder touchmove.rowReorder",function(e){that._mouseMove(e)}),$(window).width()===$(document).width()&&$(document.body).addClass("dt-rowReorder-noOverflow");var scrollWrapper=this.dom.dtScroll;this.s.scroll={windowHeight:$(window).height(),windowWidth:$(window).width(),dtTop:scrollWrapper.length?scrollWrapper.offset().top:null,dtLeft:scrollWrapper.length?scrollWrapper.offset().left:null,dtHeight:scrollWrapper.length?scrollWrapper.outerHeight():null,dtWidth:scrollWrapper.length?scrollWrapper.outerWidth():null}},_mouseMove:function(e){this._clonePosition(e);for(var bodyY=this._eventToPage(e,"Y")-this.s.bodyTop,middles=this.s.middles,insertPoint=null,dt=this.s.dt,body=dt.table().body(),i=0,ien=middles.length;i<ien;i++)if(bodyY<middles[i]){insertPoint=i;break}if(null===insertPoint&&(insertPoint=middles.length),null===this.s.lastInsert||this.s.lastInsert!==insertPoint){if(0===insertPoint)this.dom.target.prependTo(body);else{var nodes=$.unique(dt.rows({page:"current"}).nodes().toArray());insertPoint>this.s.lastInsert?this.dom.target.insertAfter(nodes[insertPoint-1]):this.dom.target.insertBefore(nodes[insertPoint])}this._cachePositions(),this.s.lastInsert=insertPoint}this._shiftScroll(e)},_mouseUp:function(e){var i,ien,that=this,dt=this.s.dt,dataSrc=this.c.dataSrc;this.dom.clone.remove(),this.dom.clone=null,this.dom.target.removeClass("dt-rowReorder-moving"),$(document).off(".rowReorder"),$(document.body).removeClass("dt-rowReorder-noOverflow"),clearInterval(this.s.scrollInterval),this.s.scrollInterval=null;var startNodes=this.s.start.nodes,endNodes=$.unique(dt.rows({page:"current"}).nodes().toArray()),idDiff={},fullDiff=[],diffNodes=[],getDataFn=this.s.getDataFn,setDataFn=this.s.setDataFn;for(i=0,ien=startNodes.length;i<ien;i++)if(startNodes[i]!==endNodes[i]){var id=dt.row(endNodes[i]).id(),endRowData=dt.row(endNodes[i]).data(),startRowData=dt.row(startNodes[i]).data();id&&(idDiff[id]=getDataFn(startRowData)),fullDiff.push({node:endNodes[i],oldData:getDataFn(endRowData),newData:getDataFn(startRowData),newPosition:i,oldPosition:$.inArray(endNodes[i],startNodes)}),diffNodes.push(endNodes[i])}var eventArgs=[fullDiff,{dataSrc:dataSrc,nodes:diffNodes,values:idDiff,triggerRow:dt.row(this.dom.target),originalEvent:e}];this._emitEvent("row-reorder",eventArgs);function update(){if(that.c.update){for(i=0,ien=fullDiff.length;i<ien;i++){var rowData=dt.row(fullDiff[i].node).data();setDataFn(rowData,fullDiff[i].newData),dt.columns().every(function(){this.dataSrc()===dataSrc&&dt.cell(fullDiff[i].node,this.index()).invalidate("data")})}that._emitEvent("row-reordered",eventArgs),dt.draw(!1)}}this.c.editor?(this.c.enable=!1,this.c.editor.edit(diffNodes,!1,$.extend({submit:"changed"},this.c.formOptions)).multiSet(dataSrc,idDiff).one("preSubmitCancelled.rowReorder",function(){that.c.enable=!0,that.c.editor.off(".rowReorder"),dt.draw(!1)}).one("submitUnsuccessful.rowReorder",function(){dt.draw(!1)}).one("submitSuccess.rowReorder",function(){update()}).one("submitComplete",function(){that.c.enable=!0,that.c.editor.off(".rowReorder")}).submit()):update()},_shiftScroll:function(e){var windowVert,dtVert,that=this,scroll=(this.s.dt,this.s.scroll),runInterval=!1,windowY=e.pageY-document.body.scrollTop;windowY<65?windowVert=-5:windowY>scroll.windowHeight-65&&(windowVert=5),null!==scroll.dtTop&&e.pageY<scroll.dtTop+65?dtVert=-5:null!==scroll.dtTop&&e.pageY>scroll.dtTop+scroll.dtHeight-65&&(dtVert=5),windowVert||dtVert?(scroll.windowVert=windowVert,scroll.dtVert=dtVert,runInterval=!0):this.s.scrollInterval&&(clearInterval(this.s.scrollInterval),this.s.scrollInterval=null),!this.s.scrollInterval&&runInterval&&(this.s.scrollInterval=setInterval(function(){if(scroll.windowVert&&(document.body.scrollTop+=scroll.windowVert),scroll.dtVert){var scroller=that.dom.dtScroll[0];scroll.dtVert&&(scroller.scrollTop+=scroll.dtVert)}},20))}}),RowReorder.defaults={dataSrc:0,editor:null,enable:!0,formOptions:{},selector:"td:first-child",snapX:!1,update:!0,excludedChildren:"a"};var Api=$.fn.dataTable.Api;return Api.register("rowReorder()",function(){return this}),Api.register("rowReorder.enable()",function(toggle){return toggle===undefined&&(toggle=!0),this.iterator("table",function(ctx){ctx.rowreorder&&(ctx.rowreorder.c.enable=toggle)})}),Api.register("rowReorder.disable()",function(){return this.iterator("table",function(ctx){ctx.rowreorder&&(ctx.rowreorder.c.enable=!1)})}),RowReorder.version="1.2.6",$.fn.dataTable.RowReorder=RowReorder,$.fn.DataTable.RowReorder=RowReorder,$(document).on("init.dt.dtr",function(e,settings,json){if("dt"===e.namespace){var init=settings.oInit.rowReorder,defaults=DataTable.defaults.rowReorder;if(init||defaults){var opts=$.extend({},init,defaults);!1!==init&&new RowReorder(settings,opts)}}}),RowReorder}),function(factory){"function"==typeof define&&define.amd?define(["jquery","datatables.net"],function($){return factory($,window,document)}):"object"==typeof exports?module.exports=function(root,$){return root=root||window,$&&$.fn.dataTable||($=require("datatables.net")(root,$).$),factory($,root,root.document)}:factory(jQuery,window,document)}(function($,window,document,undefined){"use strict";var _infoTimer,DataTable=$.fn.dataTable,_instCounter=0,_buttonCounter=0,_dtButtons=DataTable.ext.buttons,Buttons=function(dt,config){if(!(this instanceof Buttons))return function(settings){return new Buttons(settings,dt).container()};void 0===config&&(config={}),!0===config&&(config={}),$.isArray(config)&&(config={buttons:config}),this.c=$.extend(!0,{},Buttons.defaults,config),config.buttons&&(this.c.buttons=config.buttons),this.s={dt:new DataTable.Api(dt),buttons:[],listenKeys:"",namespace:"dtb"+_instCounter++},this.dom={container:$("<"+this.c.dom.container.tag+"/>").addClass(this.c.dom.container.className)},this._constructor()};$.extend(Buttons.prototype,{action:function(node,action){var button=this._nodeToButton(node);return action===undefined?button.conf.action:(button.conf.action=action,this)},active:function(node,flag){var button=this._nodeToButton(node),klass=this.c.dom.button.active,jqNode=$(button.node);return flag===undefined?jqNode.hasClass(klass):(jqNode.toggleClass(klass,flag===undefined||flag),this)},add:function(config,idx){var buttons=this.s.buttons;if("string"==typeof idx){for(var split=idx.split("-"),base=this.s,i=0,ien=split.length-1;i<ien;i++)base=base.buttons[1*split[i]];buttons=base.buttons,idx=1*split[split.length-1]}return this._expandButton(buttons,config,base!==undefined,idx),this._draw(),this},container:function(){return this.dom.container},disable:function(node){var button=this._nodeToButton(node);return $(button.node).addClass(this.c.dom.button.disabled),this},destroy:function(){$("body").off("keyup."+this.s.namespace);var i,ien,buttons=this.s.buttons.slice();for(i=0,ien=buttons.length;i<ien;i++)this.remove(buttons[i].node);this.dom.container.remove();var buttonInsts=this.s.dt.settings()[0];for(i=0,ien=buttonInsts.length;i<ien;i++)if(buttonInsts.inst===this){buttonInsts.splice(i,1);break}return this},enable:function(node,flag){if(!1===flag)return this.disable(node);var button=this._nodeToButton(node);return $(button.node).removeClass(this.c.dom.button.disabled),this},name:function(){return this.c.name},node:function(node){if(!node)return this.dom.container;var button=this._nodeToButton(node);return $(button.node)},processing:function(node,flag){var dt=this.s.dt,button=this._nodeToButton(node);return flag===undefined?$(button.node).hasClass("processing"):($(button.node).toggleClass("processing",flag),$(dt.table().node()).triggerHandler("buttons-processing.dt",[flag,dt.button(node),dt,$(node),button.conf]),this)},remove:function(node){var button=this._nodeToButton(node),host=this._nodeToHost(node),dt=this.s.dt;if(button.buttons.length)for(var i=button.buttons.length-1;0<=i;i--)this.remove(button.buttons[i].node);button.conf.destroy&&button.conf.destroy.call(dt.button(node),dt,$(node),button.conf),this._removeKey(button.conf),$(button.node).remove();var idx=$.inArray(button,host);return host.splice(idx,1),this},text:function(node,label){function text(opt){return"function"==typeof opt?opt(dt,jqNode,button.conf):opt}var button=this._nodeToButton(node),buttonLiner=this.c.dom.collection.buttonLiner,linerTag=button.inCollection&&buttonLiner&&buttonLiner.tag?buttonLiner.tag:this.c.dom.buttonLiner.tag,dt=this.s.dt,jqNode=$(button.node);return label===undefined?text(button.conf.text):(button.conf.text=label,linerTag?jqNode.children(linerTag).html(text(label)):jqNode.html(text(label)),this)},_constructor:function(){var that=this,dt=this.s.dt,dtSettings=dt.settings()[0],buttons=this.c.buttons;dtSettings._buttons||(dtSettings._buttons=[]),dtSettings._buttons.push({inst:this,name:this.c.name});for(var i=0,ien=buttons.length;i<ien;i++)this.add(buttons[i]);dt.on("destroy",function(e,settings){settings===dtSettings&&that.destroy()}),$("body").on("keyup."+this.s.namespace,function(e){if(!document.activeElement||document.activeElement===document.body){var character=String.fromCharCode(e.keyCode).toLowerCase();-1!==that.s.listenKeys.toLowerCase().indexOf(character)&&that._keypress(character,e)}})},_addKey:function(conf){conf.key&&(this.s.listenKeys+=$.isPlainObject(conf.key)?conf.key.key:conf.key)},_draw:function(container,buttons){container||(container=this.dom.container,buttons=this.s.buttons),container.children().detach();for(var i=0,ien=buttons.length;i<ien;i++)container.append(buttons[i].inserter),container.append(" "),buttons[i].buttons&&buttons[i].buttons.length&&this._draw(buttons[i].collection,buttons[i].buttons)},_expandButton:function(attachTo,button,inCollection,attachPoint){for(var dt=this.s.dt,buttons=$.isArray(button)?button:[button],i=0,ien=buttons.length;i<ien;i++){var conf=this._resolveExtends(buttons[i]);if(conf)if($.isArray(conf))this._expandButton(attachTo,conf,inCollection,attachPoint);else{var built=this._buildButton(conf,inCollection);built&&(attachPoint!==undefined?(attachTo.splice(attachPoint,0,built),attachPoint++):attachTo.push(built),built.conf.buttons&&(built.collection=$("<"+this.c.dom.collection.tag+"/>"),built.conf._collection=built.collection,this._expandButton(built.buttons,built.conf.buttons,!0,attachPoint)),conf.init&&conf.init.call(dt.button(built.node),dt,$(built.node),conf),0)}}},_buildButton:function(config,inCollection){function text(opt){return"function"==typeof opt?opt(dt,button,config):opt}var buttonDom=this.c.dom.button,linerDom=this.c.dom.buttonLiner,collectionDom=this.c.dom.collection,dt=this.s.dt;if(inCollection&&collectionDom.button&&(buttonDom=collectionDom.button),inCollection&&collectionDom.buttonLiner&&(linerDom=collectionDom.buttonLiner),config.available&&!config.available(dt,config))return!1;function action(e,dt,button,config){config.action.call(dt.button(button),e,dt,button,config),$(dt.table().node()).triggerHandler("buttons-action.dt",[dt.button(button),dt,button,config])}var tag=config.tag||buttonDom.tag,clickBlurs=config.clickBlurs===undefined||config.clickBlurs,button=$("<"+tag+"/>").addClass(buttonDom.className).attr("tabindex",this.s.dt.settings()[0].iTabIndex).attr("aria-controls",this.s.dt.table().node().id).on("click.dtb",function(e){e.preventDefault(),!button.hasClass(buttonDom.disabled)&&config.action&&action(e,dt,button,config),clickBlurs&&button.blur()}).on("keyup.dtb",function(e){13===e.keyCode&&!button.hasClass(buttonDom.disabled)&&config.action&&action(e,dt,button,config)});if("a"===tag.toLowerCase()&&button.attr("href","#"),"button"===tag.toLowerCase()&&button.attr("type","button"),linerDom.tag){var liner=$("<"+linerDom.tag+"/>").html(text(config.text)).addClass(linerDom.className);"a"===linerDom.tag.toLowerCase()&&liner.attr("href","#"),button.append(liner)}else button.html(text(config.text));!1===config.enabled&&button.addClass(buttonDom.disabled),config.className&&button.addClass(config.className),config.titleAttr&&button.attr("title",text(config.titleAttr)),config.attr&&button.attr(config.attr),config.namespace||(config.namespace=".dt-button-"+_buttonCounter++);var inserter,buttonContainer=this.c.dom.buttonContainer;return inserter=buttonContainer&&buttonContainer.tag?$("<"+buttonContainer.tag+"/>").addClass(buttonContainer.className).append(button):button,this._addKey(config),this.c.buttonCreated&&(inserter=this.c.buttonCreated(config,inserter)),{conf:config,node:button.get(0),inserter:inserter,buttons:[],inCollection:inCollection,collection:null}},_nodeToButton:function(node,buttons){for(var i=0,ien=(buttons=buttons||this.s.buttons).length;i<ien;i++){if(buttons[i].node===node)return buttons[i];if(buttons[i].buttons.length){var ret=this._nodeToButton(node,buttons[i].buttons);if(ret)return ret}}},_nodeToHost:function(node,buttons){for(var i=0,ien=(buttons=buttons||this.s.buttons).length;i<ien;i++){if(buttons[i].node===node)return buttons;if(buttons[i].buttons.length){var ret=this._nodeToHost(node,buttons[i].buttons);if(ret)return ret}}},_keypress:function(character,e){if(!e._buttonsHandled){var run=function(conf,node){if(conf.key)if(conf.key===character)e._buttonsHandled=!0,$(node).click();else if($.isPlainObject(conf.key)){if(conf.key.key!==character)return;if(conf.key.shiftKey&&!e.shiftKey)return;if(conf.key.altKey&&!e.altKey)return;if(conf.key.ctrlKey&&!e.ctrlKey)return;if(conf.key.metaKey&&!e.metaKey)return;e._buttonsHandled=!0,$(node).click()}},recurse=function(a){for(var i=0,ien=a.length;i<ien;i++)run(a[i].conf,a[i].node),a[i].buttons.length&&recurse(a[i].buttons)};recurse(this.s.buttons)}},_removeKey:function(conf){if(conf.key){var character=$.isPlainObject(conf.key)?conf.key.key:conf.key,a=this.s.listenKeys.split(""),idx=$.inArray(character,a);a.splice(idx,1),this.s.listenKeys=a.join("")}},_resolveExtends:function(conf){function toConfObject(base){for(var loop=0;!$.isPlainObject(base)&&!$.isArray(base);){if(base===undefined)return;if("function"==typeof base){if(!(base=base(dt,conf)))return!1}else if("string"==typeof base){if(!_dtButtons[base])throw"Unknown button type: "+base;base=_dtButtons[base]}if(30<++loop)throw"Buttons: Too many iterations"}return $.isArray(base)?base:$.extend({},base)}var i,ien,dt=this.s.dt;for(conf=toConfObject(conf);conf&&conf.extend;){if(!_dtButtons[conf.extend])throw"Cannot extend unknown button type: "+conf.extend;var objArray=toConfObject(_dtButtons[conf.extend]);if($.isArray(objArray))return objArray;if(!objArray)return!1;var originalClassName=objArray.className;conf=$.extend({},objArray,conf),originalClassName&&conf.className!==originalClassName&&(conf.className=originalClassName+" "+conf.className);var postfixButtons=conf.postfixButtons;if(postfixButtons){for(conf.buttons||(conf.buttons=[]),i=0,ien=postfixButtons.length;i<ien;i++)conf.buttons.push(postfixButtons[i]);conf.postfixButtons=null}var prefixButtons=conf.prefixButtons;if(prefixButtons){for(conf.buttons||(conf.buttons=[]),i=0,ien=prefixButtons.length;i<ien;i++)conf.buttons.splice(i,0,prefixButtons[i]);conf.prefixButtons=null}conf.extend=objArray.extend}return conf},_popover:function(content,hostButton,inOpts){function close(){$(".dt-button-collection").stop().fadeOut(options.fade,function(){$(this).detach()}),$(dt.buttons('[aria-haspopup="true"][aria-expanded="true"]').nodes()).attr("aria-expanded","false"),$("div.dt-button-background").off("click.dtb-collection"),Buttons.background(!1,options.backgroundClassName,options.fade,hostNode),$("body").off(".dtb-collection"),dt.off("buttons-action.b-internal")}var dt=hostButton,buttonsSettings=this.c,options=$.extend({align:"button-left",autoClose:!1,background:!0,backgroundClassName:"dt-button-background",contentClassName:buttonsSettings.dom.collection.className,collectionLayout:"",collectionTitle:"",dropup:!1,fade:400,rightAlignClassName:"dt-button-right",tag:buttonsSettings.dom.collection.tag},inOpts),hostNode=hostButton.node();!1===content&&close();var existingExpanded=$(dt.buttons('[aria-haspopup="true"][aria-expanded="true"]').nodes());existingExpanded.length&&(hostNode=existingExpanded.eq(0),close());var display=$("<div/>").addClass("dt-button-collection").addClass(options.collectionLayout).css("display","none");content=$(content).addClass(options.contentClassName).attr("role","menu").appendTo(display),hostNode.attr("aria-expanded","true"),hostNode.parents("body")[0]!==document.body&&(hostNode=document.body.lastChild),options.collectionTitle&&display.prepend('<div class="dt-button-collection-title">'+options.collectionTitle+"</div>"),display.insertAfter(hostNode).fadeIn(options.fade);var tableContainer=$(hostButton.table().container()),position=display.css("position");if("dt-container"===options.align&&(hostNode=hostNode.parent(),display.css("width",tableContainer.width())),"absolute"===position){var hostPosition=hostNode.position();display.css({top:hostPosition.top+hostNode.outerHeight(),left:hostPosition.left});var collectionHeight=display.outerHeight(),collectionWidth=display.outerWidth(),tableBottom=tableContainer.offset().top+tableContainer.height(),bottomOverflow=hostPosition.top+hostNode.outerHeight()+collectionHeight-tableBottom,listTop=hostPosition.top-collectionHeight,tableTop=tableContainer.offset().top,topOverflow=tableTop-listTop,moveTop=hostPosition.top-collectionHeight-5;(topOverflow<bottomOverflow||options.dropup)&&-moveTop<tableTop&&display.css("top",moveTop),!display.hasClass(options.rightAlignClassName)&&"button-right"!==options.align||display.css("left",hostPosition.left+hostNode.outerWidth()-collectionWidth);var listRight=hostPosition.left+collectionWidth,tableRight=tableContainer.offset().left+tableContainer.width();tableRight<listRight&&display.css("left",hostPosition.left-(listRight-tableRight));var listOffsetRight=hostNode.offset().left+collectionWidth;listOffsetRight>$(window).width()&&display.css("left",hostPosition.left-(listOffsetRight-$(window).width()))}else{var top=display.height()/2;top>$(window).height()/2&&(top=$(window).height()/2),display.css("marginTop",-1*top)}options.background&&Buttons.background(!0,options.backgroundClassName,options.fade,hostNode),$("div.dt-button-background").on("click.dtb-collection",function(){}),$("body").on("click.dtb-collection",function(e){var back=$.fn.addBack?"addBack":"andSelf";$(e.target).parents()[back]().filter(content).length||close()}).on("keyup.dtb-collection",function(e){27===e.keyCode&&close()}),options.autoClose&&setTimeout(function(){dt.on("buttons-action.b-internal",function(e,btn,dt,node){node[0]!==hostNode[0]&&close()})},0)}}),Buttons.background=function(show,className,fade,insertPoint){fade===undefined&&(fade=400),insertPoint=insertPoint||document.body,show?$("<div/>").addClass(className).css("display","none").insertAfter(insertPoint).stop().fadeIn(fade):$("div."+className).stop().fadeOut(fade,function(){$(this).removeClass(className).remove()})},Buttons.instanceSelector=function(group,buttons){if(group===undefined||null===group)return $.map(buttons,function(v){return v.inst});var ret=[],names=$.map(buttons,function(v){return v.name}),process=function(input){if($.isArray(input))for(var i=0,ien=input.length;i<ien;i++)process(input[i]);else if("string"==typeof input)if(-1!==input.indexOf(","))process(input.split(","));else{var idx=$.inArray($.trim(input),names);-1!==idx&&ret.push(buttons[idx].inst)}else"number"==typeof input&&ret.push(buttons[input].inst)};return process(group),ret},Buttons.buttonSelector=function(insts,selector){for(var ret=[],nodeBuilder=function(a,buttons,baseIdx){for(var button,idx,i=0,ien=buttons.length;i<ien;i++)(button=buttons[i])&&(idx=baseIdx!==undefined?baseIdx+i:i+"",a.push({node:button.node,name:button.conf.name,idx:idx}),button.buttons&&nodeBuilder(a,button.buttons,idx+"-"))},run=function(selector,inst){var i,ien,buttons=[];nodeBuilder(buttons,inst.s.buttons);var nodes=$.map(buttons,function(v){return v.node});if($.isArray(selector)||selector instanceof $)for(i=0,ien=selector.length;i<ien;i++)run(selector[i],inst);else if(null===selector||selector===undefined||"*"===selector)for(i=0,ien=buttons.length;i<ien;i++)ret.push({inst:inst,node:buttons[i].node});else if("number"==typeof selector)ret.push({inst:inst,node:inst.s.buttons[selector].node});else if("string"==typeof selector)if(-1!==selector.indexOf(",")){var a=selector.split(",");for(i=0,ien=a.length;i<ien;i++)run($.trim(a[i]),inst)}else if(selector.match(/^\d+(\-\d+)*$/)){var indexes=$.map(buttons,function(v){return v.idx});ret.push({inst:inst,node:buttons[$.inArray(selector,indexes)].node})}else if(-1!==selector.indexOf(":name")){var name=selector.replace(":name","");for(i=0,ien=buttons.length;i<ien;i++)buttons[i].name===name&&ret.push({inst:inst,node:buttons[i].node})}else $(nodes).filter(selector).each(function(){ret.push({inst:inst,node:this})});else if("object"==typeof selector&&selector.nodeName){var idx=$.inArray(selector,nodes);-1!==idx&&ret.push({inst:inst,node:nodes[idx]})}},i=0,ien=insts.length;i<ien;i++){var inst=insts[i];run(selector,inst)}return ret},Buttons.defaults={buttons:["copy","excel","csv","pdf","print"],name:"main",tabIndex:0,dom:{container:{tag:"div",className:"dt-buttons"},collection:{tag:"div",className:""},button:{tag:"ActiveXObject"in window?"a":"button",className:"dt-button",active:"active",disabled:"disabled"},buttonLiner:{tag:"span",className:""}}},Buttons.version="1.6.1",$.extend(_dtButtons,{collection:{text:function(dt){return dt.i18n("buttons.collection","Collection")},className:"buttons-collection",init:function(dt,button,config){button.attr("aria-expanded",!1)},action:function(e,dt,button,config){e.stopPropagation(),config._collection.parents("body").length?this.popover(!1,config):this.popover(config._collection,config)},attr:{"aria-haspopup":!0}},copy:function(dt,conf){return _dtButtons.copyHtml5?"copyHtml5":_dtButtons.copyFlash&&_dtButtons.copyFlash.available(dt,conf)?"copyFlash":void 0},csv:function(dt,conf){return _dtButtons.csvHtml5&&_dtButtons.csvHtml5.available(dt,conf)?"csvHtml5":_dtButtons.csvFlash&&_dtButtons.csvFlash.available(dt,conf)?"csvFlash":void 0},excel:function(dt,conf){return _dtButtons.excelHtml5&&_dtButtons.excelHtml5.available(dt,conf)?"excelHtml5":_dtButtons.excelFlash&&_dtButtons.excelFlash.available(dt,conf)?"excelFlash":void 0},pdf:function(dt,conf){return _dtButtons.pdfHtml5&&_dtButtons.pdfHtml5.available(dt,conf)?"pdfHtml5":_dtButtons.pdfFlash&&_dtButtons.pdfFlash.available(dt,conf)?"pdfFlash":void 0},pageLength:function(dt){var lengthMenu=dt.settings()[0].aLengthMenu,vals=$.isArray(lengthMenu[0])?lengthMenu[0]:lengthMenu,lang=$.isArray(lengthMenu[0])?lengthMenu[1]:lengthMenu;return{extend:"collection",text:function(dt){return dt.i18n("buttons.pageLength",{"-1":"Show all rows",_:"Show %d rows"},dt.page.len())},className:"buttons-page-length",autoClose:!0,buttons:$.map(vals,function(val,i){return{text:lang[i],className:"button-page-length",action:function(e,dt){dt.page.len(val).draw()},init:function(dt,node,conf){function fn(){that.active(dt.page.len()===val)}var that=this;dt.on("length.dt"+conf.namespace,fn),fn()},destroy:function(dt,node,conf){dt.off("length.dt"+conf.namespace)}}}),init:function(dt,node,conf){var that=this;dt.on("length.dt"+conf.namespace,function(){that.text(conf.text)})},destroy:function(dt,node,conf){dt.off("length.dt"+conf.namespace)}}}}),DataTable.Api.register("buttons()",function(group,selector){selector===undefined&&(selector=group,group=undefined),this.selector.buttonGroup=group;var res=this.iterator(!0,"table",function(ctx){if(ctx._buttons)return Buttons.buttonSelector(Buttons.instanceSelector(group,ctx._buttons),selector)},!0);return res._groupSelector=group,res}),DataTable.Api.register("button()",function(group,selector){var buttons=this.buttons(group,selector);return 1<buttons.length&&buttons.splice(1,buttons.length),buttons}),DataTable.Api.registerPlural("buttons().active()","button().active()",function(flag){return flag===undefined?this.map(function(set){return set.inst.active(set.node)}):this.each(function(set){set.inst.active(set.node,flag)})}),DataTable.Api.registerPlural("buttons().action()","button().action()",function(action){return action===undefined?this.map(function(set){return set.inst.action(set.node)}):this.each(function(set){set.inst.action(set.node,action)})}),DataTable.Api.register(["buttons().enable()","button().enable()"],function(flag){return this.each(function(set){set.inst.enable(set.node,flag)})}),DataTable.Api.register(["buttons().disable()","button().disable()"],function(){return this.each(function(set){set.inst.disable(set.node)})}),DataTable.Api.registerPlural("buttons().nodes()","button().node()",function(){var jq=$();return $(this.each(function(set){jq=jq.add(set.inst.node(set.node))})),jq}),DataTable.Api.registerPlural("buttons().processing()","button().processing()",function(flag){return flag===undefined?this.map(function(set){return set.inst.processing(set.node)}):this.each(function(set){set.inst.processing(set.node,flag)})}),DataTable.Api.registerPlural("buttons().text()","button().text()",function(label){return label===undefined?this.map(function(set){return set.inst.text(set.node)}):this.each(function(set){set.inst.text(set.node,label)})}),DataTable.Api.registerPlural("buttons().trigger()","button().trigger()",function(){return this.each(function(set){set.inst.node(set.node).trigger("click")})}),DataTable.Api.register("button().popover()",function(content,options){return this.map(function(set){return set.inst._popover(content,this.button(this[0].node),options)})}),DataTable.Api.register("buttons().containers()",function(){var jq=$(),groupSelector=this._groupSelector;return this.iterator(!0,"table",function(ctx){if(ctx._buttons)for(var insts=Buttons.instanceSelector(groupSelector,ctx._buttons),i=0,ien=insts.length;i<ien;i++)jq=jq.add(insts[i].container())}),jq}),DataTable.Api.register("buttons().container()",function(){return this.containers().eq(0)}),DataTable.Api.register("button().add()",function(idx,conf){var ctx=this.context;if(ctx.length){var inst=Buttons.instanceSelector(this._groupSelector,ctx[0]._buttons);inst.length&&inst[0].add(conf,idx)}return this.button(this._groupSelector,idx)}),DataTable.Api.register("buttons().destroy()",function(){return this.pluck("inst").unique().each(function(inst){inst.destroy()}),this}),DataTable.Api.registerPlural("buttons().remove()","buttons().remove()",function(){return this.each(function(set){set.inst.remove(set.node)}),this}),DataTable.Api.register("buttons.info()",function(title,message,time){var that=this;return!1===title?(this.off("destroy.btn-info"),$("#datatables_buttons_info").fadeOut(function(){$(this).remove()}),clearTimeout(_infoTimer),_infoTimer=null):(_infoTimer&&clearTimeout(_infoTimer),$("#datatables_buttons_info").length&&$("#datatables_buttons_info").remove(),title=title?"<h2>"+title+"</h2>":"",$('<div id="datatables_buttons_info" class="dt-button-info"/>').html(title).append($("<div/>")["string"==typeof message?"html":"append"](message)).css("display","none").appendTo("body").fadeIn(),time!==undefined&&0!==time&&(_infoTimer=setTimeout(function(){that.buttons.info(!1)},time)),this.on("destroy.btn-info",function(){that.buttons.info(!1)})),this}),DataTable.Api.register("buttons.exportData()",function(options){if(this.context.length)return _exportData(new DataTable.Api(this.context[0]),options)}),DataTable.Api.register("buttons.exportInfo()",function(conf){return{filename:_filename(conf=conf||{}),title:_title(conf),messageTop:_message(this,conf.message||conf.messageTop,"top"),messageBottom:_message(this,conf.messageBottom,"bottom")}});var _filename=function(config){var filename="*"===config.filename&&"*"!==config.title&&config.title!==undefined&&null!==config.title&&""!==config.title?config.title:config.filename;if("function"==typeof filename&&(filename=filename()),filename===undefined||null===filename)return null;-1!==filename.indexOf("*")&&(filename=$.trim(filename.replace("*",$("head > title").text()))),filename=filename.replace(/[^a-zA-Z0-9_\u00A1-\uFFFF\.,\-_ !\(\)]/g,"");var extension=_stringOrFunction(config.extension);return filename+(extension=extension||"")},_stringOrFunction=function(option){return null===option||option===undefined?null:"function"==typeof option?option():option},_title=function(config){var title=_stringOrFunction(config.title);return null===title?null:-1!==title.indexOf("*")?title.replace("*",$("head > title").text()||"Exported data"):title},_message=function(dt,option,position){var message=_stringOrFunction(option);if(null===message)return null;var caption=$("caption",dt.table().container()).eq(0);return"*"!==message?message:caption.css("caption-side")!==position?null:caption.length?caption.text():""},_exportTextarea=$("<textarea/>")[0],_exportData=function(dt,inOpts){var config=$.extend(!0,{},{rows:null,columns:"",modifier:{search:"applied",order:"applied"},orthogonal:"display",stripHtml:!0,stripNewlines:!0,decodeEntities:!0,trim:!0,format:{header:function(d){return strip(d)},footer:function(d){return strip(d)},body:function(d){return strip(d)}},customizeData:null},inOpts),strip=function(str){return"string"!=typeof str||(str=(str=str.replace(/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,"")).replace(/<!\-\-.*?\-\->/g,""),config.stripHtml&&(str=str.replace(/<[^>]*>/g,"")),config.trim&&(str=str.replace(/^\s+|\s+$/g,"")),config.stripNewlines&&(str=str.replace(/\n/g," ")),config.decodeEntities&&(_exportTextarea.innerHTML=str,str=_exportTextarea.value)),str},header=dt.columns(config.columns).indexes().map(function(idx){var el=dt.column(idx).header();return config.format.header(el.innerHTML,idx,el)}).toArray(),footer=dt.table().footer()?dt.columns(config.columns).indexes().map(function(idx){var el=dt.column(idx).footer();return config.format.footer(el?el.innerHTML:"",idx,el)}).toArray():null,modifier=$.extend({},config.modifier);dt.select&&"function"==typeof dt.select.info&&modifier.selected===undefined&&dt.rows(config.rows,$.extend({selected:!0},modifier)).any()&&$.extend(modifier,{selected:!0});for(var rowIndexes=dt.rows(config.rows,modifier).indexes().toArray(),selectedCells=dt.cells(rowIndexes,config.columns),cells=selectedCells.render(config.orthogonal).toArray(),cellNodes=selectedCells.nodes().toArray(),columns=header.length,body=[],cellCounter=0,i=0,ien=0<columns?cells.length/columns:0;i<ien;i++){for(var row=[columns],j=0;j<columns;j++)row[j]=config.format.body(cells[cellCounter],i,j,cellNodes[cellCounter]),cellCounter++;body[i]=row}var data={header:header,footer:footer,body:body};return config.customizeData&&config.customizeData(data),data};function _init(settings){var api=new DataTable.Api(settings),opts=api.init().buttons||DataTable.defaults.buttons;return new Buttons(api,opts).container()}return $.fn.dataTable.Buttons=Buttons,$.fn.DataTable.Buttons=Buttons,$(document).on("init.dt plugin-init.dt",function(e,settings){if("dt"===e.namespace){var opts=settings.oInit.buttons||DataTable.defaults.buttons;opts&&!settings._buttons&&new Buttons(settings,opts).container()}}),DataTable.ext.feature.push({fnInit:_init,cFeature:"B"}),DataTable.ext.features&&DataTable.ext.features.register("buttons",_init),Buttons}),function(factory){"function"==typeof define&&define.amd?define(["jquery","datatables.net","datatables.net-buttons"],function($){return factory($,window,document)}):"object"==typeof exports?module.exports=function(root,$,jszip,pdfmake){return root=root||window,$&&$.fn.dataTable||($=require("datatables.net")(root,$).$),$.fn.dataTable.Buttons||require("datatables.net-buttons")(root,$),factory($,root,root.document,jszip,pdfmake)}:factory(jQuery,window,document)}(function($,window,document,jszip,pdfmake,undefined){"use strict";var DataTable=$.fn.dataTable;function _jsZip(){return jszip||window.JSZip}function _pdfMake(){return pdfmake||window.pdfMake}DataTable.Buttons.pdfMake=function(_){if(!_)return _pdfMake();pdfmake=m_ake},DataTable.Buttons.jszip=function(_){if(!_)return _jsZip();jszip=_};var _saveAs=function(view){if(!(void 0===view||"undefined"!=typeof navigator&&/MSIE [1-9]\./.test(navigator.userAgent))){var doc=view.document,get_URL=function(){return view.URL||view.webkitURL||view},save_link=doc.createElementNS("http://www.w3.org/1999/xhtml","a"),can_use_save_link="download"in save_link,is_safari=/constructor/i.test(view.HTMLElement)||view.safari,is_chrome_ios=/CriOS\/[\d]+/.test(navigator.userAgent),throw_outside=function(ex){(view.setImmediate||view.setTimeout)(function(){throw ex},0)},revoke=function(file){setTimeout(function(){"string"==typeof file?get_URL().revokeObjectURL(file):file.remove()},4e4)},auto_bom=function(blob){return/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(blob.type)?new Blob([String.fromCharCode(65279),blob],{type:blob.type}):blob},FileSaver=function(blob,name,no_auto_bom){no_auto_bom||(blob=auto_bom(blob));function dispatch_all(){!function(filesaver,event_types,event){for(var i=(event_types=[].concat(event_types)).length;i--;){var listener=filesaver["on"+event_types[i]];if("function"==typeof listener)try{listener.call(filesaver,event||filesaver)}catch(ex){throw_outside(ex)}}}(filesaver,"writestart progress write writeend".split(" "))}var object_url,filesaver=this,force="application/octet-stream"===blob.type;if(filesaver.readyState=filesaver.INIT,can_use_save_link)return object_url=get_URL().createObjectURL(blob),void setTimeout(function(){save_link.href=object_url,save_link.download=name,function(node){var event=new MouseEvent("click");node.dispatchEvent(event)}(save_link),dispatch_all(),revoke(object_url),filesaver.readyState=filesaver.DONE});!function(){if((is_chrome_ios||force&&is_safari)&&view.FileReader){var reader=new FileReader;return reader.onloadend=function(){var url=is_chrome_ios?reader.result:reader.result.replace(/^data:[^;]*;/,"data:attachment/file;");view.open(url,"_blank")||(view.location.href=url),url=undefined,filesaver.readyState=filesaver.DONE,dispatch_all()},reader.readAsDataURL(blob),filesaver.readyState=filesaver.INIT}(object_url=object_url||get_URL().createObjectURL(blob),force)?view.location.href=object_url:view.open(object_url,"_blank")||(view.location.href=object_url);filesaver.readyState=filesaver.DONE,dispatch_all(),revoke(object_url)}()},FS_proto=FileSaver.prototype;return"undefined"!=typeof navigator&&navigator.msSaveOrOpenBlob?function(blob,name,no_auto_bom){return name=name||blob.name||"download",no_auto_bom||(blob=auto_bom(blob)),navigator.msSaveOrOpenBlob(blob,name)}:(FS_proto.abort=function(){},FS_proto.readyState=FS_proto.INIT=0,FS_proto.WRITING=1,FS_proto.DONE=2,FS_proto.error=FS_proto.onwritestart=FS_proto.onprogress=FS_proto.onwrite=FS_proto.onabort=FS_proto.onerror=FS_proto.onwriteend=null,function(blob,name,no_auto_bom){return new FileSaver(blob,name||blob.name||"download",no_auto_bom)})}}("undefined"!=typeof self&&self||void 0!==window&&window||this.content);DataTable.fileSave=_saveAs;function _sheetname(config){var sheetName="Sheet1";return config.sheetName&&(sheetName=config.sheetName.replace(/[\[\]\*\/\\\?\:]/g,"")),sheetName}function _newLine(config){return config.newline?config.newline:navigator.userAgent.match(/Windows/)?"\r\n":"\n"}function _exportData(dt,config){for(var newLine=_newLine(config),data=dt.buttons.exportData(config.exportOptions),boundary=config.fieldBoundary,separator=config.fieldSeparator,reBoundary=new RegExp(boundary,"g"),escapeChar=config.escapeChar!==undefined?config.escapeChar:"\\",join=function(a){for(var s="",i=0,ien=a.length;i<ien;i++)0<i&&(s+=separator),s+=boundary?boundary+(""+a[i]).replace(reBoundary,escapeChar+boundary)+boundary:a[i];return s},header=config.header?join(data.header)+newLine:"",footer=config.footer&&data.footer?newLine+join(data.footer):"",body=[],i=0,ien=data.body.length;i<ien;i++)body.push(join(data.body[i]));return{str:header+body.join(newLine)+footer,rows:body.length}}function _isDuffSafari(){if(!(-1!==navigator.userAgent.indexOf("Safari")&&-1===navigator.userAgent.indexOf("Chrome")&&-1===navigator.userAgent.indexOf("Opera")))return!1;var version=navigator.userAgent.match(/AppleWebKit\/(\d+\.\d+)/);return!!(version&&1<version.length&&1*version[1]<603.1)}function createCellPos(n){for(var ordA="A".charCodeAt(0),len="Z".charCodeAt(0)-ordA+1,s="";0<=n;)s=String.fromCharCode(n%len+ordA)+s,n=Math.floor(n/len)-1;return s}try{var _ieExcel,_serialiser=new XMLSerializer}catch(t){}function _createNode(doc,nodeName,opts){var tempNode=doc.createElement(nodeName);return opts&&(opts.attr&&$(tempNode).attr(opts.attr),opts.children&&$.each(opts.children,function(key,value){tempNode.appendChild(value)}),null!==opts.text&&opts.text!==undefined&&tempNode.appendChild(doc.createTextNode(opts.text))),tempNode}function _excelColWidth(data,col){var len,lineSplit,str,max=data.header[col].length;data.footer&&data.footer[col].length>max&&(max=data.footer[col].length);for(var i=0,ien=data.body.length;i<ien;i++){var point=data.body[i][col];if(max<(len=-1!==(str=null!==point&&point!==undefined?point.toString():"").indexOf("\n")?((lineSplit=str.split("\n")).sort(function(a,b){return b.length-a.length}),lineSplit[0].length):str.length)&&(max=len),40<max)return 54}return 6<(max*=1.35)?max:6}var excelStrings={"_rels/.rels":'<?xml version="1.0" encoding="UTF-8" standalone="yes"?><Relationships xmlns="http://schemas.openxmlformats.org/package/2006/relationships"><Relationship Id="rId1" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument" Target="xl/workbook.xml"/></Relationships>',"xl/_rels/workbook.xml.rels":'<?xml version="1.0" encoding="UTF-8" standalone="yes"?><Relationships xmlns="http://schemas.openxmlformats.org/package/2006/relationships"><Relationship Id="rId1" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet" Target="worksheets/sheet1.xml"/><Relationship Id="rId2" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles" Target="styles.xml"/></Relationships>',"[Content_Types].xml":'<?xml version="1.0" encoding="UTF-8" standalone="yes"?><Types xmlns="http://schemas.openxmlformats.org/package/2006/content-types"><Default Extension="xml" ContentType="application/xml" /><Default Extension="rels" ContentType="application/vnd.openxmlformats-package.relationships+xml" /><Default Extension="jpeg" ContentType="image/jpeg" /><Override PartName="/xl/workbook.xml" ContentType="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml" /><Override PartName="/xl/worksheets/sheet1.xml" ContentType="application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml" /><Override PartName="/xl/styles.xml" ContentType="application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml" /></Types>',"xl/workbook.xml":'<?xml version="1.0" encoding="UTF-8" standalone="yes"?><workbook xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:r="http://schemas.openxmlformats.org/officeDocument/2006/relationships"><fileVersion appName="xl" lastEdited="5" lowestEdited="5" rupBuild="24816"/><workbookPr showInkAnnotation="0" autoCompressPictures="0"/><bookViews><workbookView xWindow="0" yWindow="0" windowWidth="25600" windowHeight="19020" tabRatio="500"/></bookViews><sheets><sheet name="Sheet1" sheetId="1" r:id="rId1"/></sheets><definedNames/></workbook>',"xl/worksheets/sheet1.xml":'<?xml version="1.0" encoding="UTF-8" standalone="yes"?><worksheet xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:r="http://schemas.openxmlformats.org/officeDocument/2006/relationships" xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" mc:Ignorable="x14ac" xmlns:x14ac="http://schemas.microsoft.com/office/spreadsheetml/2009/9/ac"><sheetData/><mergeCells count="0"/></worksheet>',"xl/styles.xml":'<?xml version="1.0" encoding="UTF-8"?><styleSheet xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" mc:Ignorable="x14ac" xmlns:x14ac="http://schemas.microsoft.com/office/spreadsheetml/2009/9/ac"><numFmts count="6"><numFmt numFmtId="164" formatCode="#,##0.00_- [$$-45C]"/><numFmt numFmtId="165" formatCode="&quot;&quot;#,##0.00"/><numFmt numFmtId="166" formatCode="[$-2] #,##0.00"/><numFmt numFmtId="167" formatCode="0.0%"/><numFmt numFmtId="168" formatCode="#,##0;(#,##0)"/><numFmt numFmtId="169" formatCode="#,##0.00;(#,##0.00)"/></numFmts><fonts count="5" x14ac:knownFonts="1"><font><sz val="11" /><name val="Calibri" /></font><font><sz val="11" /><name val="Calibri" /><color rgb="FFFFFFFF" /></font><font><sz val="11" /><name val="Calibri" /><b /></font><font><sz val="11" /><name val="Calibri" /><i /></font><font><sz val="11" /><name val="Calibri" /><u /></font></fonts><fills count="6"><fill><patternFill patternType="none" /></fill><fill><patternFill patternType="none" /></fill><fill><patternFill patternType="solid"><fgColor rgb="FFD9D9D9" /><bgColor indexed="64" /></patternFill></fill><fill><patternFill patternType="solid"><fgColor rgb="FFD99795" /><bgColor indexed="64" /></patternFill></fill><fill><patternFill patternType="solid"><fgColor rgb="ffc6efce" /><bgColor indexed="64" /></patternFill></fill><fill><patternFill patternType="solid"><fgColor rgb="ffc6cfef" /><bgColor indexed="64" /></patternFill></fill></fills><borders count="2"><border><left /><right /><top /><bottom /><diagonal /></border><border diagonalUp="false" diagonalDown="false"><left style="thin"><color auto="1" /></left><right style="thin"><color auto="1" /></right><top style="thin"><color auto="1" /></top><bottom style="thin"><color auto="1" /></bottom><diagonal /></border></borders><cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0" /></cellStyleXfs><cellXfs count="67"><xf numFmtId="0" fontId="0" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="1" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="2" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="3" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="4" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="0" fillId="2" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="1" fillId="2" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="2" fillId="2" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="3" fillId="2" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="4" fillId="2" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="0" fillId="3" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="1" fillId="3" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="2" fillId="3" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="3" fillId="3" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="4" fillId="3" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="0" fillId="4" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="1" fillId="4" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="2" fillId="4" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="3" fillId="4" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="4" fillId="4" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="0" fillId="5" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="1" fillId="5" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="2" fillId="5" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="3" fillId="5" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="4" fillId="5" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="0" fillId="0" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="1" fillId="0" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="2" fillId="0" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="3" fillId="0" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="4" fillId="0" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="0" fillId="2" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="1" fillId="2" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="2" fillId="2" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="3" fillId="2" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="4" fillId="2" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="0" fillId="3" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="1" fillId="3" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="2" fillId="3" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="3" fillId="3" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="4" fillId="3" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="0" fillId="4" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="1" fillId="4" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="2" fillId="4" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="3" fillId="4" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="4" fillId="4" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="0" fillId="5" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="1" fillId="5" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="2" fillId="5" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="3" fillId="5" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="4" fillId="5" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="0" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1" xfId="0" applyAlignment="1"><alignment horizontal="left"/></xf><xf numFmtId="0" fontId="0" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1" xfId="0" applyAlignment="1"><alignment horizontal="center"/></xf><xf numFmtId="0" fontId="0" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1" xfId="0" applyAlignment="1"><alignment horizontal="right"/></xf><xf numFmtId="0" fontId="0" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1" xfId="0" applyAlignment="1"><alignment horizontal="fill"/></xf><xf numFmtId="0" fontId="0" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1" xfId="0" applyAlignment="1"><alignment textRotation="90"/></xf><xf numFmtId="0" fontId="0" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1" xfId="0" applyAlignment="1"><alignment wrapText="1"/></xf><xf numFmtId="9"   fontId="0" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1" xfId="0" applyNumberFormat="1"/><xf numFmtId="164" fontId="0" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1" xfId="0" applyNumberFormat="1"/><xf numFmtId="165" fontId="0" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1" xfId="0" applyNumberFormat="1"/><xf numFmtId="166" fontId="0" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1" xfId="0" applyNumberFormat="1"/><xf numFmtId="167" fontId="0" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1" xfId="0" applyNumberFormat="1"/><xf numFmtId="168" fontId="0" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1" xfId="0" applyNumberFormat="1"/><xf numFmtId="169" fontId="0" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1" xfId="0" applyNumberFormat="1"/><xf numFmtId="3" fontId="0" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1" xfId="0" applyNumberFormat="1"/><xf numFmtId="4" fontId="0" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1" xfId="0" applyNumberFormat="1"/><xf numFmtId="1" fontId="0" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1" xfId="0" applyNumberFormat="1"/><xf numFmtId="2" fontId="0" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1" xfId="0" applyNumberFormat="1"/></cellXfs><cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0" /></cellStyles><dxfs count="0" /><tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4" /></styleSheet>'},_excelSpecials=[{match:/^\-?\d+\.\d%$/,style:60,fmt:function(d){return d/100}},{match:/^\-?\d+\.?\d*%$/,style:56,fmt:function(d){return d/100}},{match:/^\-?\$[\d,]+.?\d*$/,style:57},{match:/^\-?[\d,]+.?\d*$/,style:58},{match:/^\-?[\d,]+.?\d*$/,style:59},{match:/^\-?\d+$/,style:65},{match:/^\-?\d+\.\d{2}$/,style:66},{match:/^\([\d,]+\)$/,style:61,fmt:function(d){return-1*d.replace(/[\(\)]/g,"")}},{match:/^\([\d,]+\.\d{2}\)$/,style:62,fmt:function(d){return-1*d.replace(/[\(\)]/g,"")}},{match:/^\-?[\d,]+$/,style:63},{match:/^\-?[\d,]+\.\d{2}$/,style:64}];return DataTable.ext.buttons.copyHtml5={className:"buttons-copy buttons-html5",text:function(dt){return dt.i18n("buttons.copy","Copy")},action:function(e,dt,button,config){this.processing(!0);var that=this,exportData=_exportData(dt,config),info=dt.buttons.exportInfo(config),newline=_newLine(config),output=exportData.str,hiddenDiv=$("<div/>").css({height:1,width:1,overflow:"hidden",position:"fixed",top:0,left:0});info.title&&(output=info.title+newline+newline+output),info.messageTop&&(output=info.messageTop+newline+newline+output),info.messageBottom&&(output=output+newline+newline+info.messageBottom),config.customize&&(output=config.customize(output,config,dt));var textarea=$("<textarea readonly/>").val(output).appendTo(hiddenDiv);if(document.queryCommandSupported("copy")){hiddenDiv.appendTo(dt.table().container()),textarea[0].focus(),textarea[0].select();try{var successful=document.execCommand("copy");if(hiddenDiv.remove(),successful)return dt.buttons.info(dt.i18n("buttons.copyTitle","Copy to clipboard"),dt.i18n("buttons.copySuccess",{1:"Copied one row to clipboard",_:"Copied %d rows to clipboard"},exportData.rows),2e3),void this.processing(!1)}catch(t){}}var message=$("<span>"+dt.i18n("buttons.copyKeys","Press <i>ctrl</i> or <i></i> + <i>C</i> to copy the table data<br>to your system clipboard.<br><br>To cancel, click this message or press escape.")+"</span>").append(hiddenDiv);dt.buttons.info(dt.i18n("buttons.copyTitle","Copy to clipboard"),message,0),textarea[0].focus(),textarea[0].select();function close(){container.off("click.buttons-copy"),$(document).off(".buttons-copy"),dt.buttons.info(!1)}var container=$(message).closest(".dt-button-info");container.on("click.buttons-copy",close),$(document).on("keydown.buttons-copy",function(e){27===e.keyCode&&(close(),that.processing(!1))}).on("copy.buttons-copy cut.buttons-copy",function(){close(),that.processing(!1)})},exportOptions:{},fieldSeparator:"\t",fieldBoundary:"",header:!0,footer:!1,title:"*",messageTop:"*",messageBottom:"*"},DataTable.ext.buttons.csvHtml5={bom:!1,className:"buttons-csv buttons-html5",available:function(){return window.FileReader!==undefined&&window.Blob},text:function(dt){return dt.i18n("buttons.csv","CSV")},action:function(e,dt,button,config){this.processing(!0);var output=_exportData(dt,config).str,info=dt.buttons.exportInfo(config),charset=config.charset;config.customize&&(output=config.customize(output,config,dt)),charset=!1!==charset?(charset=charset||(document.characterSet||document.charset))&&";charset="+charset:"",config.bom&&(output="\ufeff"+output),_saveAs(new Blob([output],{type:"text/csv"+charset}),info.filename,!0),this.processing(!1)},filename:"*",extension:".csv",exportOptions:{},fieldSeparator:",",fieldBoundary:'"',escapeChar:'"',charset:null,header:!0,footer:!1},DataTable.ext.buttons.excelHtml5={className:"buttons-excel buttons-html5",available:function(){return window.FileReader!==undefined&&_jsZip()!==undefined&&!_isDuffSafari()&&_serialiser},text:function(dt){return dt.i18n("buttons.excel","Excel")},action:function(e,dt,button,config){this.processing(!0);function getXml(type){var str=excelStrings[type];return $.parseXML(str)}function addRow(row){rowNode=_createNode(rels,"row",{attr:{r:currentRow=rowPos+1}});for(var i=0,ien=row.length;i<ien;i++){var cellId=createCellPos(i)+""+currentRow,cell=null;if(null===row[i]||row[i]===undefined||""===row[i]){if(!0!==config.createEmptyCells)continue;row[i]=""}var originalContent=row[i];row[i]=$.trim(row[i]);for(var j=0,jen=_excelSpecials.length;j<jen;j++){var special=_excelSpecials[j];if(row[i].match&&!row[i].match(/^0\d+/)&&row[i].match(special.match)){var val=row[i].replace(/[^\d\.\-]/g,"");special.fmt&&(val=special.fmt(val)),cell=_createNode(rels,"c",{attr:{r:cellId,s:special.style},children:[_createNode(rels,"v",{text:val})]});break}}if(!cell)if("number"==typeof row[i]||row[i].match&&row[i].match(/^-?\d+(\.\d+)?$/)&&!row[i].match(/^0\d+/))cell=_createNode(rels,"c",{attr:{t:"n",r:cellId},children:[_createNode(rels,"v",{text:row[i]})]});else{var text=originalContent.replace?originalContent.replace(/[\x00-\x09\x0B\x0C\x0E-\x1F\x7F-\x9F]/g,""):originalContent;cell=_createNode(rels,"c",{attr:{t:"inlineStr",r:cellId},children:{row:_createNode(rels,"is",{children:{row:_createNode(rels,"t",{text:text,attr:{"xml:space":"preserve"}})}})}})}rowNode.appendChild(cell)}relsGet.appendChild(rowNode),rowPos++}var dataStartRow,dataEndRow,currentRow,rowNode,that=this,rowPos=0,rels=getXml("xl/worksheets/sheet1.xml"),relsGet=rels.getElementsByTagName("sheetData")[0],xlsx={_rels:{".rels":getXml("_rels/.rels")},xl:{_rels:{"workbook.xml.rels":getXml("xl/_rels/workbook.xml.rels")},"workbook.xml":getXml("xl/workbook.xml"),"styles.xml":getXml("xl/styles.xml"),worksheets:{"sheet1.xml":rels}},"[Content_Types].xml":getXml("[Content_Types].xml")},data=dt.buttons.exportData(config.exportOptions);config.customizeData&&config.customizeData(data);var mergeCells=function(row,colspan){var mergeCells=$("mergeCells",rels);mergeCells[0].appendChild(_createNode(rels,"mergeCell",{attr:{ref:"A"+row+":"+createCellPos(colspan)+row}})),mergeCells.attr("count",parseFloat(mergeCells.attr("count"))+1),$("row:eq("+(row-1)+") c",rels).attr("s","51")},exportInfo=dt.buttons.exportInfo(config);exportInfo.title&&(addRow([exportInfo.title]),mergeCells(rowPos,data.header.length-1)),exportInfo.messageTop&&(addRow([exportInfo.messageTop]),mergeCells(rowPos,data.header.length-1)),config.header&&(addRow(data.header),$("row:last c",rels).attr("s","2")),dataStartRow=rowPos;for(var n=0,ie=data.body.length;n<ie;n++)addRow(data.body[n]);dataEndRow=rowPos,config.footer&&data.footer&&(addRow(data.footer),$("row:last c",rels).attr("s","2")),exportInfo.messageBottom&&(addRow([exportInfo.messageBottom]),mergeCells(rowPos,data.header.length-1));var cols=_createNode(rels,"cols");$("worksheet",rels).prepend(cols);for(var i=0,ien=data.header.length;i<ien;i++)cols.appendChild(_createNode(rels,"col",{attr:{min:i+1,max:i+1,width:_excelColWidth(data,i),customWidth:1}}));var workbook=xlsx.xl["workbook.xml"];$("sheets sheet",workbook).attr("name",_sheetname(config)),config.autoFilter&&($("mergeCells",rels).before(_createNode(rels,"autoFilter",{attr:{ref:"A"+dataStartRow+":"+createCellPos(data.header.length-1)+dataEndRow}})),$("definedNames",workbook).append(_createNode(workbook,"definedName",{attr:{name:"_xlnm._FilterDatabase",localSheetId:"0",hidden:1},text:_sheetname(config)+"!$A$"+dataStartRow+":"+createCellPos(data.header.length-1)+dataEndRow}))),config.customize&&config.customize(xlsx,config,dt),0===$("mergeCells",rels).children().length&&$("mergeCells",rels).remove();var zip=new(_jsZip()),zipConfig={type:"blob",mimeType:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"};!function _addToZip(zip,obj){_ieExcel===undefined&&(_ieExcel=-1===_serialiser.serializeToString($.parseXML(excelStrings["xl/worksheets/sheet1.xml"])).indexOf("xmlns:r")),$.each(obj,function(name,val){if($.isPlainObject(val))_addToZip(zip.folder(name),val);else{if(_ieExcel){var i,ien,worksheet=val.childNodes[0],attrs=[];for(i=worksheet.attributes.length-1;0<=i;i--){var attrName=worksheet.attributes[i].nodeName,attrValue=worksheet.attributes[i].nodeValue;-1!==attrName.indexOf(":")&&(attrs.push({name:attrName,value:attrValue}),worksheet.removeAttribute(attrName))}for(i=0,ien=attrs.length;i<ien;i++){var attr=val.createAttribute(attrs[i].name.replace(":","_dt_b_namespace_token_"));attr.value=attrs[i].value,worksheet.setAttributeNode(attr)}}var str=_serialiser.serializeToString(val);_ieExcel&&(-1===str.indexOf("<?xml")&&(str='<?xml version="1.0" encoding="UTF-8" standalone="yes"?>'+str),str=(str=str.replace(/_dt_b_namespace_token_/g,":")).replace(/xmlns:NS[\d]+="" NS[\d]+:/g,"")),str=str.replace(/<([^<>]*?) xmlns=""([^<>]*?)>/g,"<$1 $2>"),zip.file(name,str)}})}(zip,xlsx),zip.generateAsync?zip.generateAsync(zipConfig).then(function(blob){_saveAs(blob,exportInfo.filename),that.processing(!1)}):(_saveAs(zip.generate(zipConfig),exportInfo.filename),this.processing(!1))},filename:"*",extension:".xlsx",exportOptions:{},header:!0,footer:!1,title:"*",messageTop:"*",messageBottom:"*",createEmptyCells:!1,autoFilter:!1,sheetName:""},DataTable.ext.buttons.pdfHtml5={className:"buttons-pdf buttons-html5",available:function(){return window.FileReader!==undefined&&_pdfMake()},text:function(dt){return dt.i18n("buttons.pdf","PDF")},action:function(e,dt,button,config){this.processing(!0);var data=dt.buttons.exportData(config.exportOptions),info=dt.buttons.exportInfo(config),rows=[];config.header&&rows.push($.map(data.header,function(d){return{text:"string"==typeof d?d:d+"",style:"tableHeader"}}));for(var i=0,ien=data.body.length;i<ien;i++)rows.push($.map(data.body[i],function(d){return null!==d&&d!==undefined||(d=""),{text:"string"==typeof d?d:d+"",style:i%2?"tableBodyEven":"tableBodyOdd"}}));config.footer&&data.footer&&rows.push($.map(data.footer,function(d){return{text:"string"==typeof d?d:d+"",style:"tableFooter"}}));var doc={pageSize:config.pageSize,pageOrientation:config.orientation,content:[{table:{headerRows:1,body:rows},layout:"noBorders"}],styles:{tableHeader:{bold:!0,fontSize:11,color:"white",fillColor:"#2d4154",alignment:"center"},tableBodyEven:{},tableBodyOdd:{fillColor:"#f3f3f3"},tableFooter:{bold:!0,fontSize:11,color:"white",fillColor:"#2d4154"},title:{alignment:"center",fontSize:15},message:{}},defaultStyle:{fontSize:10}};info.messageTop&&doc.content.unshift({text:info.messageTop,style:"message",margin:[0,0,0,12]}),info.messageBottom&&doc.content.push({text:info.messageBottom,style:"message",margin:[0,0,0,12]}),info.title&&doc.content.unshift({text:info.title,style:"title",margin:[0,0,0,12]}),config.customize&&config.customize(doc,config,dt);var pdf=_pdfMake().createPdf(doc);"open"!==config.download||_isDuffSafari()?pdf.download(info.filename):pdf.open(),this.processing(!1)},title:"*",filename:"*",extension:".pdf",exportOptions:{},orientation:"portrait",pageSize:"A4",header:!0,footer:!1,messageTop:"*",messageBottom:"*",customize:null,download:"download"},DataTable.Buttons}),function(factory){"function"==typeof define&&define.amd?define(["jquery","datatables.net","datatables.net-buttons"],function($){return factory($,window,document)}):"object"==typeof exports?module.exports=function(root,$){return root=root||window,$&&$.fn.dataTable||($=require("datatables.net")(root,$).$),$.fn.dataTable.Buttons||require("datatables.net-buttons")(root,$),factory($,root,root.document)}:factory(jQuery,window,document)}(function($,window,document,undefined){"use strict";var DataTable=$.fn.dataTable,_link=document.createElement("a"),_relToAbs=function(href){_link.href=href;var linkHost=_link.host;return-1===linkHost.indexOf("/")&&0!==_link.pathname.indexOf("/")&&(linkHost+="/"),_link.protocol+"//"+linkHost+_link.pathname+_link.search};return DataTable.ext.buttons.print={className:"buttons-print",text:function(dt){return dt.i18n("buttons.print","Print")},action:function(e,dt,button,config){function addRow(d,tag){for(var str="<tr>",i=0,ien=d.length;i<ien;i++){var dataOut=null===d[i]||d[i]===undefined?"":d[i];str+="<"+tag+" "+(columnClasses[i]?'class="'+columnClasses[i]+'"':"")+">"+dataOut+"</"+tag+">"}return str+"</tr>"}var data=dt.buttons.exportData($.extend({decodeEntities:!1},config.exportOptions)),exportInfo=dt.buttons.exportInfo(config),columnClasses=dt.columns(config.exportOptions.columns).flatten().map(function(idx){return dt.settings()[0].aoColumns[dt.column(idx).index()].sClass}).toArray(),html='<table class="'+dt.table().node().className+'">';config.header&&(html+="<thead>"+addRow(data.header,"th")+"</thead>"),html+="<tbody>";for(var i=0,ien=data.body.length;i<ien;i++)html+=addRow(data.body[i],"td");html+="</tbody>",config.footer&&data.footer&&(html+="<tfoot>"+addRow(data.footer,"th")+"</tfoot>"),html+="</table>";var win=window.open("","");win.document.close();var head="<title>"+exportInfo.title+"</title>";$("style, link").each(function(){head+=function(el){var clone=$(el).clone()[0];return"link"===clone.nodeName.toLowerCase()&&(clone.href=_relToAbs(clone.href)),clone.outerHTML}(this)});try{win.document.head.innerHTML=head}catch(e){$(win.document.head).html(head)}win.document.body.innerHTML="<h1>"+exportInfo.title+"</h1><div>"+(exportInfo.messageTop||"")+"</div>"+html+"<div>"+(exportInfo.messageBottom||"")+"</div>",$(win.document.body).addClass("dt-print-view"),$("img",win.document.body).each(function(i,img){img.setAttribute("src",_relToAbs(img.getAttribute("src")))}),config.customize&&config.customize(win,config,dt);function autoPrint(){config.autoPrint&&(win.print(),win.close())}navigator.userAgent.match(/Trident\/\d.\d/)?autoPrint():win.setTimeout(autoPrint,1e3)},title:"*",messageTop:"*",messageBottom:"*",exportOptions:{},header:!0,footer:!1,autoPrint:!0,customize:null},DataTable.Buttons}),function(factory){"function"==typeof define&&define.amd?define(["jquery","datatables.net","datatables.net-buttons"],function($){return factory($,window,document)}):"object"==typeof exports?module.exports=function(root,$){return root=root||window,$&&$.fn.dataTable||($=require("datatables.net")(root,$).$),$.fn.dataTable.Buttons||require("datatables.net-buttons")(root,$),factory($,root,root.document)}:factory(jQuery,window,document)}(function($,window,document,undefined){"use strict";var DataTable=$.fn.dataTable;return $.extend(DataTable.ext.buttons,{colvis:function(dt,conf){return{extend:"collection",text:function(dt){return dt.i18n("buttons.colvis","Column visibility")},className:"buttons-colvis",buttons:[{extend:"columnsToggle",columns:conf.columns,columnText:conf.columnText}]}},columnsToggle:function(dt,conf){return dt.columns(conf.columns).indexes().map(function(idx){return{extend:"columnToggle",columns:idx,columnText:conf.columnText}}).toArray()},columnToggle:function(dt,conf){return{extend:"columnVisibility",columns:conf.columns,columnText:conf.columnText}},columnsVisibility:function(dt,conf){return dt.columns(conf.columns).indexes().map(function(idx){return{extend:"columnVisibility",columns:idx,visibility:conf.visibility,columnText:conf.columnText}}).toArray()},columnVisibility:{columns:undefined,text:function(dt,button,conf){return conf._columnText(dt,conf)},className:"buttons-columnVisibility",action:function(e,dt,button,conf){var col=dt.columns(conf.columns),curr=col.visible();col.visible(conf.visibility!==undefined?conf.visibility:!(curr.length&&curr[0]))},init:function(dt,button,conf){var that=this;button.attr("data-cv-idx",conf.columns),dt.on("column-visibility.dt"+conf.namespace,function(e,settings){settings.bDestroying||settings.nTable!=dt.settings()[0].nTable||that.active(dt.column(conf.columns).visible())}).on("column-reorder.dt"+conf.namespace,function(e,settings,details){1===dt.columns(conf.columns).count()&&(button.text(conf._columnText(dt,conf)),that.active(dt.column(conf.columns).visible()))}),this.active(dt.column(conf.columns).visible())},destroy:function(dt,button,conf){dt.off("column-visibility.dt"+conf.namespace).off("column-reorder.dt"+conf.namespace)},_columnText:function(dt,conf){var idx=dt.column(conf.columns).index(),title=dt.settings()[0].aoColumns[idx].sTitle.replace(/\n/g," ").replace(/<br\s*\/?>/gi," ").replace(/<select(.*?)<\/select>/g,"").replace(/<!\-\-.*?\-\->/g,"").replace(/<.*?>/g,"").replace(/^\s+|\s+$/g,"");return conf.columnText?conf.columnText(dt,idx,title):title}},colvisRestore:{className:"buttons-colvisRestore",text:function(dt){return dt.i18n("buttons.colvisRestore","Restore visibility")},init:function(dt,button,conf){conf._visOriginal=dt.columns().indexes().map(function(idx){return dt.column(idx).visible()}).toArray()},action:function(e,dt,button,conf){dt.columns().every(function(i){var idx=dt.colReorder&&dt.colReorder.transpose?dt.colReorder.transpose(i,"toOriginal"):i;this.visible(conf._visOriginal[idx])})}},colvisGroup:{className:"buttons-colvisGroup",action:function(e,dt,button,conf){dt.columns(conf.show).visible(!0,!1),dt.columns(conf.hide).visible(!1,!1),dt.columns.adjust()},show:[],hide:[]}}),DataTable.Buttons}),function(domGlobals){"use strict";function noop(){}var compose=function(fa,fb){return function(){for(var args=[],_i=0;_i<arguments.length;_i++)args[_i]=arguments[_i];return fa(fb.apply(null,args))}},constant=function(value){return function(){return value}},identity=function(x){return x};function curry(fn){for(var initialArgs=[],_i=1;_i<arguments.length;_i++)initialArgs[_i-1]=arguments[_i];return function(){for(var restArgs=[],_i=0;_i<arguments.length;_i++)restArgs[_i]=arguments[_i];var all=initialArgs.concat(restArgs);return fn.apply(null,all)}}function not(f){return function(){for(var args=[],_i=0;_i<arguments.length;_i++)args[_i]=arguments[_i];return!f.apply(null,args)}}function none(){return NONE}function isType(type){return function(value){return function(x){if(null===x)return"null";var t=typeof x;return"object"==t&&(Array.prototype.isPrototypeOf(x)||x.constructor&&"Array"===x.constructor.name)?"array":"object"==t&&(String.prototype.isPrototypeOf(x)||x.constructor&&"String"===x.constructor.name)?"string":t}(value)===type}}function rawIndexOf(ts,t){return nativeIndexOf.call(ts,t)}function contains(xs,x){return-1<rawIndexOf(xs,x)}function exists(xs,pred){for(var i=0,len=xs.length;i<len;i++){if(pred(xs[i],i))return!0}return!1}function foldr(xs,f,acc){return function(xs,f){for(var i=xs.length-1;0<=i;i--){f(xs[i],i)}}(xs,function(x){acc=f(acc,x)}),acc}function foldl(xs,f,acc){return each(xs,function(x){acc=f(acc,x)}),acc}function find(xs,pred){for(var i=0,len=xs.length;i<len;i++){var x=xs[i];if(pred(x,i))return Option.some(x)}return Option.none()}function findIndex(xs,pred){for(var i=0,len=xs.length;i<len;i++){if(pred(xs[i],i))return Option.some(i)}return Option.none()}function bind(xs,f){return function(xs){for(var r=[],i=0,len=xs.length;i<len;++i){if(!isArray(xs[i]))throw new Error("Arr.flatten item "+i+" was not an array, input: "+xs);nativePush.apply(r,xs[i])}return r}(map(xs,f))}function forall(xs,pred){for(var i=0,len=xs.length;i<len;++i){if(!0!==pred(xs[i],i))return!1}return!0}function reverse(xs){var r=nativeSlice.call(xs,0);return r.reverse(),r}function difference(a1,a2){return filter(a1,function(x){return!contains(a2,x)})}function head(xs){return 0===xs.length?Option.none():Option.some(xs[0])}function last(xs){return 0===xs.length?Option.none():Option.some(xs[xs.length-1])}function each$1(obj,f){for(var props=keys(obj),k=0,len=props.length;k<len;k++){var i=props[k];f(obj[i],i)}}function map$1(obj,f){return tupleMap(obj,function(x,i){return{k:i,v:f(x,i)}})}function objAcc(r){return function(x,i){r[i]=x}}function internalFilter(obj,pred,onTrue,onFalse){return each$1(obj,function(x,i){(pred(x,i)?onTrue:onFalse)(x,i)}),{}}function bifilter(obj,pred){var t={},f={};return internalFilter(obj,pred,objAcc(t),objAcc(f)),{t:t,f:f}}function get(obj,key){return has(obj,key)?Option.from(obj[key]):Option.none()}var never=constant(!1),always=constant(!0),NONE=function(){function eq(o){return o.isNone()}function call(thunk){return thunk()}function id(n){return n}var me={fold:function(n,s){return n()},is:never,isSome:never,isNone:always,getOr:id,getOrThunk:call,getOrDie:function(msg){throw new Error(msg||"error: getOrDie called on none.")},getOrNull:constant(null),getOrUndefined:constant(void 0),or:id,orThunk:call,map:none,each:noop,bind:none,exists:never,forall:always,filter:none,equals:eq,equals_:eq,toArray:function(){return[]},toString:constant("none()")};return Object.freeze&&Object.freeze(me),me}(),some=function(a){function self(){return me}function bind(f){return f(a)}var constant_a=constant(a),me={fold:function(n,s){return s(a)},is:function(v){return a===v},isSome:always,isNone:never,getOr:constant_a,getOrThunk:constant_a,getOrDie:constant_a,getOrNull:constant_a,getOrUndefined:constant_a,or:self,orThunk:self,map:function(f){return some(f(a))},each:function(f){f(a)},bind:bind,exists:bind,forall:bind,filter:function(f){return f(a)?me:NONE},toArray:function(){return[a]},toString:function(){return"some("+a+")"},equals:function(o){return o.is(a)},equals_:function(o,elementEq){return o.fold(never,function(b){return elementEq(a,b)})}};return me},Option={some:some,none:none,from:function(value){return null==value?NONE:some(value)}},isString=isType("string"),isObject=isType("object"),isArray=isType("array"),isNull=isType("null"),isBoolean=isType("boolean"),isFunction=isType("function"),isNumber=isType("number"),nativeSlice=Array.prototype.slice,nativeIndexOf=Array.prototype.indexOf,nativePush=Array.prototype.push,map=function(xs,f){for(var len=xs.length,r=new Array(len),i=0;i<len;i++){var x=xs[i];r[i]=f(x,i)}return r},each=function(xs,f){for(var i=0,len=xs.length;i<len;i++){f(xs[i],i)}},partition=function(xs,pred){for(var pass=[],fail=[],i=0,len=xs.length;i<len;i++){var x=xs[i];(pred(x,i)?pass:fail).push(x)}return{pass:pass,fail:fail}},filter=function(xs,pred){for(var r=[],i=0,len=xs.length;i<len;i++){var x=xs[i];pred(x,i)&&r.push(x)}return r},from$1=isFunction(Array.from)?Array.from:function(x){return nativeSlice.call(x)},keys=Object.keys,hasOwnProperty=Object.hasOwnProperty,tupleMap=function(obj,f){var r={};return each$1(obj,function(x,i){var tuple=f(x,i);r[tuple.k]=tuple.v}),r},has=function(obj,key){return hasOwnProperty.call(obj,key)},__assign=function(){return(__assign=Object.assign||function(t){for(var s,i=1,n=arguments.length;i<n;i++)for(var p in s=arguments[i])Object.prototype.hasOwnProperty.call(s,p)&&(t[p]=s[p]);return t}).apply(this,arguments)};function find$1(regexes,agent){var r=function(regexes,s){for(var i=0;i<regexes.length;i++){var x=regexes[i];if(x.test(s))return x}}(regexes,agent);if(!r)return{major:0,minor:0};function group(i){return Number(agent.replace(r,"$"+i))}return nu(group(1),group(2))}function isBrowser(name,current){return function(){return current===name}}function isOS(name,current){return function(){return current===name}}function detect$1(candidates,userAgent){var agent=String(userAgent).toLowerCase();return find(candidates,function(candidate){return candidate.search(agent)})}function contains$1(str,substr){return-1!==str.indexOf(substr)}function startsWith(str,prefix){return function(str,substr,start){return""===substr||!(str.length<substr.length)&&str.substr(start,start+substr.length)===substr}(str,prefix,0)}function trim(str){return str.replace(/^\s+|\s+$/g,"")}function rTrim(str){return str.replace(/\s+$/g,"")}function checkContains(target){return function(uastring){return contains$1(uastring,target)}}function detect$3(){return platform.get()}function Immutable(){for(var fields=[],_i=0;_i<arguments.length;_i++)fields[_i]=arguments[_i];return function(){for(var values=[],_i=0;_i<arguments.length;_i++)values[_i]=arguments[_i];if(fields.length!==values.length)throw new Error('Wrong number of arguments to struct. Expected "['+fields.length+']", got '+values.length+" arguments");var struct={};return each(fields,function(name,i){struct[name]=constant(values[i])}),struct}}function compareDocumentPosition(a,b,match){return 0!=(a.compareDocumentPosition(b)&match)}function is(element,selector){var dom=element.dom();if(dom.nodeType!==ELEMENT$1)return!1;var elem=dom;if(void 0!==elem.matches)return elem.matches(selector);if(void 0!==elem.msMatchesSelector)return elem.msMatchesSelector(selector);if(void 0!==elem.webkitMatchesSelector)return elem.webkitMatchesSelector(selector);if(void 0!==elem.mozMatchesSelector)return elem.mozMatchesSelector(selector);throw new Error("Browser lacks native selectors")}function bypassSelector(dom){return dom.nodeType!==ELEMENT$1&&dom.nodeType!==DOCUMENT$1||0===dom.childElementCount}function eq(e1,e2){return e1.dom()===e2.dom()}function owner(element){return Element.fromDom(element.dom().ownerDocument)}function defaultView(element){return Element.fromDom(element.dom().ownerDocument.defaultView)}function parent(element){return Option.from(element.dom().parentNode).map(Element.fromDom)}function prevSibling(element){return Option.from(element.dom().previousSibling).map(Element.fromDom)}function nextSibling(element){return Option.from(element.dom().nextSibling).map(Element.fromDom)}function prevSiblings(element){return reverse(Recurse_toArray(element,prevSibling))}function nextSiblings(element){return Recurse_toArray(element,nextSibling)}function children(element){return map(element.dom().childNodes,Element.fromDom)}function child(element,index){var cs=element.dom().childNodes;return Option.from(cs[index]).map(Element.fromDom)}function firstChild(element){return child(element,0)}function lastChild(element){return child(element,element.dom().childNodes.length-1)}function before(marker,element){parent(marker).each(function(v){v.dom().insertBefore(element.dom(),marker.dom())})}function after(marker,element){nextSibling(marker).fold(function(){parent(marker).each(function(v){append(v,element)})},function(v){before(v,element)})}function prepend(parent,element){firstChild(parent).fold(function(){append(parent,element)},function(v){parent.dom().insertBefore(element.dom(),v.dom())})}function append$1(parent,elements){each(elements,function(x){append(parent,x)})}function empty(element){element.dom().textContent="",each(children(element),function(rogue){remove(rogue)})}function unwrap(wrapper){var children$1=children(wrapper);0<children$1.length&&function(marker,elements){each(elements,function(x){before(marker,x)})}(wrapper,children$1),remove(wrapper)}function name(element){return element.dom().nodeName.toLowerCase()}function isType$1(t){return function(element){return function(element){return element.dom().nodeType}(element)===t}}function inBody(element){var dom=isText(element)?element.dom().parentNode:element.dom();return null!=dom&&dom.ownerDocument.body.contains(dom)}function firstDefinedOrZero(a,b){return void 0!==a?a:void 0!==b?b:0}function get$1(_DOC){var doc=void 0!==_DOC?_DOC.dom():domGlobals.document,x=doc.body.scrollLeft||doc.documentElement.scrollLeft,y=doc.body.scrollTop||doc.documentElement.scrollTop;return Position(x,y)}function to(x,y,_DOC){(void 0!==_DOC?_DOC.dom():domGlobals.document).defaultView.scrollTo(x,y)}function intoView(element,alignToTop){isSafari&&isFunction(element.dom().scrollIntoViewIfNeeded)?element.dom().scrollIntoViewIfNeeded(!1):element.dom().scrollIntoView(alignToTop)}function bounds(x,y,width,height){return{x:constant(x),y:constant(y),width:constant(width),height:constant(height),right:constant(x+width),bottom:constant(y+height)}}function isNodeType(type){return function(node){return!!node&&node.nodeType===type}}function matchNodeNames(names){var lowercasedNames=names.map(function(s){return s.toLowerCase()});return function(node){if(node&&node.nodeName){var nodeName=node.nodeName.toLowerCase();return contains(lowercasedNames,nodeName)}return!1}}function hasContentEditableState(value){return function(node){if(isElement$1(node)){if(node.contentEditable===value)return!0;if(node.getAttribute("data-mce-contenteditable")===value)return!0}return!1}}function isSupported(dom){return void 0!==dom.style&&isFunction(dom.style.getPropertyValue)}function rawSet(dom,key,value){if(!(isString(value)||isBoolean(value)||isNumber(value)))throw domGlobals.console.error("Invalid call to Attr.set. Key ",key,":: Value ",value,":: Element ",dom),new Error("Attribute value was not simple");dom.setAttribute(key,value+"")}function setAll(element,attrs){var dom=element.dom();each$1(attrs,function(v,k){rawSet(dom,k,v)})}function get$3(element,key){var v=element.dom().getAttribute(key);return null===v?void 0:v}function remove$1(element,key){element.dom().removeAttribute(key)}function get$4(element,property){var dom=element.dom(),r=domGlobals.window.getComputedStyle(dom).getPropertyValue(property),v=""!==r||inBody(element)?r:getUnsafeProperty(dom,property);return null===v?void 0:v}function getRaw(element,property){var dom=element.dom(),raw=getUnsafeProperty(dom,property);return Option.from(raw).filter(function(r){return 0<r.length})}function firstElement(nodes){return find(nodes,isElement)}function hasChild(elm,child){return elm.children&&contains(elm.children,child)}var fromDom=function(node){if(null==node)throw new Error("Node cannot be null or undefined");return{dom:constant(node)}},Element={fromHtml:function(html,scope){var div=(scope||domGlobals.document).createElement("div");if(div.innerHTML=html,!div.hasChildNodes()||1<div.childNodes.length)throw domGlobals.console.error("HTML does not have a single root node",html),new Error("HTML must have a single root node");return fromDom(div.childNodes[0])},fromTag:function(tag,scope){var node=(scope||domGlobals.document).createElement(tag);return fromDom(node)},fromText:function(text,scope){var node=(scope||domGlobals.document).createTextNode(text);return fromDom(node)},fromDom:fromDom,fromPoint:function(docElm,x,y){var doc=docElm.dom();return Option.from(doc.elementFromPoint(x,y)).map(fromDom)}},Cell=function(initial){function get(){return value}var value=initial;return{get:get,set:function(v){value=v},clone:function(){return Cell(get())}}},unknown=function(){return nu(0,0)},nu=function(major,minor){return{major:major,minor:minor}},Version={nu:nu,detect:function(versionRegexes,agent){var cleanedAgent=String(agent).toLowerCase();return 0===versionRegexes.length?unknown():find$1(versionRegexes,cleanedAgent)},unknown:unknown},nu$1=function(info){var current=info.current;return{current:current,version:info.version,isEdge:isBrowser("Edge",current),isChrome:isBrowser("Chrome",current),isIE:isBrowser("IE",current),isOpera:isBrowser("Opera",current),isFirefox:isBrowser("Firefox",current),isSafari:isBrowser("Safari",current)}},Browser={unknown:function(){return nu$1({current:void 0,version:Version.unknown()})},nu:nu$1,edge:constant("Edge"),chrome:constant("Chrome"),ie:constant("IE"),opera:constant("Opera"),firefox:constant("Firefox"),safari:constant("Safari")},nu$2=function(info){var current=info.current;return{current:current,version:info.version,isWindows:isOS("Windows",current),isiOS:isOS("iOS",current),isAndroid:isOS("Android",current),isOSX:isOS("OSX",current),isLinux:isOS("Linux",current),isSolaris:isOS("Solaris",current),isFreeBSD:isOS("FreeBSD",current),isChromeOS:isOS("ChromeOS",current)}},OperatingSystem={unknown:function(){return nu$2({current:void 0,version:Version.unknown()})},nu:nu$2,windows:constant("Windows"),ios:constant("iOS"),android:constant("Android"),linux:constant("Linux"),osx:constant("OSX"),solaris:constant("Solaris"),freebsd:constant("FreeBSD"),chromeos:constant("ChromeOS")},UaString_detectBrowser=function(browsers,userAgent){return detect$1(browsers,userAgent).map(function(browser){var version=Version.detect(browser.versionRegexes,userAgent);return{current:browser.name,version:version}})},UaString_detectOs=function(oses,userAgent){return detect$1(oses,userAgent).map(function(os){var version=Version.detect(os.versionRegexes,userAgent);return{current:os.name,version:version}})},normalVersionRegex=/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,browsers=[{name:"Edge",versionRegexes:[/.*?edge\/ ?([0-9]+)\.([0-9]+)$/],search:function(uastring){return contains$1(uastring,"edge/")&&contains$1(uastring,"chrome")&&contains$1(uastring,"safari")&&contains$1(uastring,"applewebkit")}},{name:"Chrome",versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/,normalVersionRegex],search:function(uastring){return contains$1(uastring,"chrome")&&!contains$1(uastring,"chromeframe")}},{name:"IE",versionRegexes:[/.*?msie\ ?([0-9]+)\.([0-9]+).*/,/.*?rv:([0-9]+)\.([0-9]+).*/],search:function(uastring){return contains$1(uastring,"msie")||contains$1(uastring,"trident")}},{name:"Opera",versionRegexes:[normalVersionRegex,/.*?opera\/([0-9]+)\.([0-9]+).*/],search:checkContains("opera")},{name:"Firefox",versionRegexes:[/.*?firefox\/\ ?([0-9]+)\.([0-9]+).*/],search:checkContains("firefox")},{name:"Safari",versionRegexes:[normalVersionRegex,/.*?cpu os ([0-9]+)_([0-9]+).*/],search:function(uastring){return(contains$1(uastring,"safari")||contains$1(uastring,"mobile/"))&&contains$1(uastring,"applewebkit")}}],oses=[{name:"Windows",search:checkContains("win"),versionRegexes:[/.*?windows\ nt\ ?([0-9]+)\.([0-9]+).*/]},{name:"iOS",search:function(uastring){return contains$1(uastring,"iphone")||contains$1(uastring,"ipad")},versionRegexes:[/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,/.*cpu os ([0-9]+)_([0-9]+).*/,/.*cpu iphone os ([0-9]+)_([0-9]+).*/]},{name:"Android",search:checkContains("android"),versionRegexes:[/.*?android\ ?([0-9]+)\.([0-9]+).*/]},{name:"OSX",search:checkContains("mac os x"),versionRegexes:[/.*?mac\ os\ x\ ?([0-9]+)_([0-9]+).*/]},{name:"Linux",search:checkContains("linux"),versionRegexes:[]},{name:"Solaris",search:checkContains("sunos"),versionRegexes:[]},{name:"FreeBSD",search:checkContains("freebsd"),versionRegexes:[]},{name:"ChromeOS",search:checkContains("cros"),versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/]}],PlatformInfo={browsers:constant(browsers),oses:constant(oses)},PlatformDetection_detect=function(userAgent,mediaMatch){var browsers=PlatformInfo.browsers(),oses=PlatformInfo.oses(),browser=UaString_detectBrowser(browsers,userAgent).fold(Browser.unknown,Browser.nu),os=UaString_detectOs(oses,userAgent).fold(OperatingSystem.unknown,OperatingSystem.nu),deviceType=function(os,browser,userAgent,mediaMatch){var isiPad=os.isiOS()&&!0===/ipad/i.test(userAgent),isiPhone=os.isiOS()&&!isiPad,isMobile=os.isiOS()||os.isAndroid(),isTouch=isMobile||mediaMatch("(pointer:coarse)"),isTablet=isiPad||!isiPhone&&isMobile&&mediaMatch("(min-device-width:768px)"),isPhone=isiPhone||isMobile&&!isTablet,iOSwebview=browser.isSafari()&&os.isiOS()&&!1===/safari/i.test(userAgent),isDesktop=!isPhone&&!isTablet&&!iOSwebview;return{isiPad:constant(isiPad),isiPhone:constant(isiPhone),isTablet:constant(isTablet),isPhone:constant(isPhone),isTouch:constant(isTouch),isAndroid:os.isAndroid,isiOS:os.isiOS,isWebView:constant(iOSwebview),isDesktop:constant(isDesktop)}}(os,browser,userAgent,mediaMatch);return{browser:browser,os:os,deviceType:deviceType}},platform=Cell(PlatformDetection_detect(domGlobals.navigator.userAgent,function(query){return domGlobals.window.matchMedia(query).matches})),Recurse_toArray=function(target,f){for(var r=[],recurse=function(e){return r.push(e),f(e)},cur=f(target);(cur=cur.bind(recurse)).isSome(););return r},Node_documentPositionContainedBy=function(a,b){return compareDocumentPosition(a,b,domGlobals.Node.DOCUMENT_POSITION_CONTAINED_BY)},DOCUMENT=(domGlobals.Node.ATTRIBUTE_NODE,domGlobals.Node.CDATA_SECTION_NODE,domGlobals.Node.COMMENT_NODE,domGlobals.Node.DOCUMENT_NODE),ELEMENT=(domGlobals.Node.DOCUMENT_TYPE_NODE,domGlobals.Node.DOCUMENT_FRAGMENT_NODE,domGlobals.Node.ELEMENT_NODE),TEXT=domGlobals.Node.TEXT_NODE,ELEMENT$1=(domGlobals.Node.PROCESSING_INSTRUCTION_NODE,domGlobals.Node.ENTITY_REFERENCE_NODE,domGlobals.Node.ENTITY_NODE,domGlobals.Node.NOTATION_NODE,ELEMENT),DOCUMENT$1=DOCUMENT,contains$2=detect$3().browser.isIE()?function(e1,e2){return Node_documentPositionContainedBy(e1.dom(),e2.dom())}:function(e1,e2){var d1=e1.dom(),d2=e2.dom();return d1!==d2&&d1.contains(d2)},append=(Immutable("element","offset"),function(parent,element){parent.dom().appendChild(element.dom())}),remove=function(element){var dom=element.dom();null!==dom.parentNode&&dom.parentNode.removeChild(dom)},isElement=(void 0!==domGlobals.window?domGlobals.window:Function("return this;")(),isType$1(ELEMENT)),isText=isType$1(TEXT),r=function(left,top){return{left:constant(left),top:constant(top),translate:function(x,y){return r(left+x,top+y)}}},Position=r,viewport=function(element){var dom=element.dom(),body=dom.ownerDocument.body;return body===dom?Position(body.offsetLeft,body.offsetTop):inBody(element)?function(dom){var box=dom.getBoundingClientRect();return Position(box.left,box.top)}(dom):Position(0,0)},isSafari=detect$3().browser.isSafari(),getBounds=function(_win){var win=void 0===_win?domGlobals.window:_win,doc=win.document,scroll=get$1(Element.fromDom(doc));return function(_win){var win=void 0===_win?domGlobals.window:_win;return Option.from(win.visualViewport)}(win).fold(function(){var html=win.document.documentElement,width=html.clientWidth,height=html.clientHeight;return bounds(scroll.left(),scroll.top(),width,height)},function(visualViewport){return bounds(Math.max(visualViewport.pageLeft,scroll.left()),Math.max(visualViewport.pageTop,scroll.top()),visualViewport.width,visualViewport.height)})},isElement$1=isNodeType(1),isTextareaOrInput=matchNodeNames(["textarea","input"]),isText$1=isNodeType(3),isComment=isNodeType(8),isDocument=isNodeType(9),isDocumentFragment=isNodeType(11),isBr=matchNodeNames(["br"]),isContentEditableTrue=hasContentEditableState("true"),isContentEditableFalse=hasContentEditableState("false"),NodeType={isText:isText$1,isElement:isElement$1,isComment:isComment,isDocument:isDocument,isDocumentFragment:isDocumentFragment,isBr:isBr,isContentEditableTrue:isContentEditableTrue,isContentEditableFalse:isContentEditableFalse,isRestrictedNode:function(node){return!!node&&!Object.getPrototypeOf(node)},matchNodeNames:matchNodeNames,hasPropValue:function(propName,propValue){return function(node){return isElement$1(node)&&node[propName]===propValue}},hasAttribute:function(attrName,attrValue){return function(node){return isElement$1(node)&&node.hasAttribute(attrName)}},hasAttributeValue:function(attrName,attrValue){return function(node){return isElement$1(node)&&node.getAttribute(attrName)===attrValue}},matchStyleValues:function(name,values){var items=values.toLowerCase().split(" ");return function(node){var i;if(isElement$1(node))for(i=0;i<items.length;i++){var computed=node.ownerDocument.defaultView.getComputedStyle(node,null);if((computed?computed.getPropertyValue(name):null)===items[i])return!0}return!1}},isBogus:function(node){return isElement$1(node)&&node.hasAttribute("data-mce-bogus")},isBogusAll:function(node){return isElement$1(node)&&"all"===node.getAttribute("data-mce-bogus")},isTable:function(node){return isElement$1(node)&&"TABLE"===node.tagName},isTextareaOrInput:isTextareaOrInput},set=function(element,key,value){rawSet(element.dom(),key,value)},getUnsafeProperty=function(dom,property){return isSupported(dom)?dom.style.getPropertyValue(property):""},browser$1=detect$3().browser,Position$1={getPos:function(body,elm,rootElm){var offsetParent,pos,x=0,y=0,doc=body.ownerDocument;if(rootElm=rootElm||body,elm){if(rootElm===body&&elm.getBoundingClientRect&&"static"===get$4(Element.fromDom(body),"position"))return{x:x=(pos=elm.getBoundingClientRect()).left+(doc.documentElement.scrollLeft||body.scrollLeft)-doc.documentElement.clientLeft,y:y=pos.top+(doc.documentElement.scrollTop||body.scrollTop)-doc.documentElement.clientTop};for(offsetParent=elm;offsetParent&&offsetParent!==rootElm&&offsetParent.nodeType&&!hasChild(offsetParent,rootElm);)x+=offsetParent.offsetLeft||0,y+=offsetParent.offsetTop||0,offsetParent=offsetParent.offsetParent;for(offsetParent=elm.parentNode;offsetParent&&offsetParent!==rootElm&&offsetParent.nodeType&&!hasChild(offsetParent,rootElm);)x-=offsetParent.scrollLeft||0,y-=offsetParent.scrollTop||0,offsetParent=offsetParent.parentNode;y+=function(elm){return browser$1.isFirefox()&&"table"===name(elm)?firstElement(children(elm)).filter(function(elm){return"caption"===name(elm)}).bind(function(caption){return firstElement(nextSiblings(caption)).map(function(body){var bodyTop=body.dom().offsetTop,captionTop=caption.dom().offsetTop,captionHeight=caption.dom().offsetHeight;return bodyTop<=captionTop?-captionHeight:0})}).getOr(0):0}(Element.fromDom(elm))}return{x:x,y:y}}},exports$1={},module$1={exports:exports$1};!function(define,exports,module,require){!function(f){if("object"==typeof exports&&void 0!==module)module.exports=f();else if("function"==typeof define&&define.amd)define([],f);else{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).EphoxContactWrapper=f()}}(function(){return function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c="function"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error("Cannot find module '"+i+"'");throw a.code="MODULE_NOT_FOUND",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){return o(e[i][1][r]||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u="function"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}({1:[function(require,module,exports){var cachedSetTimeout,cachedClearTimeout,process=module.exports={};function defaultSetTimout(){throw new Error("setTimeout has not been defined")}function defaultClearTimeout(){throw new Error("clearTimeout has not been defined")}function runTimeout(fun){if(cachedSetTimeout===setTimeout)return setTimeout(fun,0);if((cachedSetTimeout===defaultSetTimout||!cachedSetTimeout)&&setTimeout)return cachedSetTimeout=setTimeout,setTimeout(fun,0);try{return cachedSetTimeout(fun,0)}catch(e){try{return cachedSetTimeout.call(null,fun,0)}catch(e){return cachedSetTimeout.call(this,fun,0)}}}!function(){try{cachedSetTimeout="function"==typeof setTimeout?setTimeout:defaultSetTimout}catch(e){cachedSetTimeout=defaultSetTimout}try{cachedClearTimeout="function"==typeof clearTimeout?clearTimeout:defaultClearTimeout}catch(e){cachedClearTimeout=defaultClearTimeout}}();var currentQueue,queue=[],draining=!1,queueIndex=-1;function cleanUpNextTick(){draining&&currentQueue&&(draining=!1,currentQueue.length?queue=currentQueue.concat(queue):queueIndex=-1,queue.length&&drainQueue())}function drainQueue(){if(!draining){var timeout=runTimeout(cleanUpNextTick);draining=!0;for(var len=queue.length;len;){for(currentQueue=queue,queue=[];++queueIndex<len;)currentQueue&&currentQueue[queueIndex].run();queueIndex=-1,len=queue.length}currentQueue=null,draining=!1,function(marker){if(cachedClearTimeout===clearTimeout)return clearTimeout(marker);if((cachedClearTimeout===defaultClearTimeout||!cachedClearTimeout)&&clearTimeout)return cachedClearTimeout=clearTimeout,clearTimeout(marker);try{cachedClearTimeout(marker)}catch(e){try{return cachedClearTimeout.call(null,marker)}catch(e){return cachedClearTimeout.call(this,marker)}}}(timeout)}}function Item(fun,array){this.fun=fun,this.array=array}function noop(){}process.nextTick=function(fun){var args=new Array(arguments.length-1);if(1<arguments.length)for(var i=1;i<arguments.length;i++)args[i-1]=arguments[i];queue.push(new Item(fun,args)),1!==queue.length||draining||runTimeout(drainQueue)},Item.prototype.run=function(){this.fun.apply(null,this.array)},process.title="browser",process.browser=!0,process.env={},process.argv=[],process.version="",process.versions={},process.on=noop,process.addListener=noop,process.once=noop,process.off=noop,process.removeListener=noop,process.removeAllListeners=noop,process.emit=noop,process.prependListener=noop,process.prependOnceListener=noop,process.listeners=function(name){return[]},process.binding=function(name){throw new Error("process.binding is not supported")},process.cwd=function(){return"/"},process.chdir=function(dir){throw new Error("process.chdir is not supported")},process.umask=function(){return 0}},{}],2:[function(require,module,exports){(function(setImmediate){function noop(){}function Promise(fn){if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");if("function"!=typeof fn)throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],doResolve(fn,this)}function handle(self,deferred){for(;3===self._state;)self=self._value;0!==self._state?(self._handled=!0,Promise._immediateFn(function(){var cb=1===self._state?deferred.onFulfilled:deferred.onRejected;if(null!==cb){var ret;try{ret=cb(self._value)}catch(e){return void reject(deferred.promise,e)}resolve(deferred.promise,ret)}else(1===self._state?resolve:reject)(deferred.promise,self._value)})):self._deferreds.push(deferred)}function resolve(self,newValue){try{if(newValue===self)throw new TypeError("A promise cannot be resolved with itself.");if(newValue&&("object"==typeof newValue||"function"==typeof newValue)){var then=newValue.then;if(newValue instanceof Promise)return self._state=3,self._value=newValue,void finale(self);if("function"==typeof then)return void doResolve(function(fn,thisArg){return function(){fn.apply(thisArg,arguments)}}(then,newValue),self)}self._state=1,self._value=newValue,finale(self)}catch(e){reject(self,e)}}function reject(self,newValue){self._state=2,self._value=newValue,finale(self)}function finale(self){2===self._state&&0===self._deferreds.length&&Promise._immediateFn(function(){self._handled||Promise._unhandledRejectionFn(self._value)});for(var i=0,len=self._deferreds.length;i<len;i++)handle(self,self._deferreds[i]);self._deferreds=null}function Handler(onFulfilled,onRejected,promise){this.onFulfilled="function"==typeof onFulfilled?onFulfilled:null,this.onRejected="function"==typeof onRejected?onRejected:null,this.promise=promise}function doResolve(fn,self){var done=!1;try{fn(function(value){done||(done=!0,resolve(self,value))},function(reason){done||(done=!0,reject(self,reason))})}catch(ex){if(done)return;done=!0,reject(self,ex)}}var root,setTimeoutFunc;root=this,setTimeoutFunc=setTimeout,Promise.prototype.catch=function(onRejected){return this.then(null,onRejected)},Promise.prototype.then=function(onFulfilled,onRejected){var prom=new this.constructor(noop);return handle(this,new Handler(onFulfilled,onRejected,prom)),prom},Promise.all=function(arr){var args=Array.prototype.slice.call(arr);return new Promise(function(resolve,reject){if(0===args.length)return resolve([]);var remaining=args.length;function res(i,val){try{if(val&&("object"==typeof val||"function"==typeof val)){var then=val.then;if("function"==typeof then)return void then.call(val,function(val){res(i,val)},reject)}args[i]=val,0==--remaining&&resolve(args)}catch(ex){reject(ex)}}for(var i=0;i<args.length;i++)res(i,args[i])})},Promise.resolve=function(value){return value&&"object"==typeof value&&value.constructor===Promise?value:new Promise(function(resolve){resolve(value)})},Promise.reject=function(value){return new Promise(function(resolve,reject){reject(value)})},Promise.race=function(values){return new Promise(function(resolve,reject){for(var i=0,len=values.length;i<len;i++)values[i].then(resolve,reject)})},Promise._immediateFn="function"==typeof setImmediate?function(fn){setImmediate(fn)}:function(fn){setTimeoutFunc(fn,0)},Promise._unhandledRejectionFn=function(err){"undefined"!=typeof console&&console&&console.warn("Possible Unhandled Promise Rejection:",err)},Promise._setImmediateFn=function(fn){Promise._immediateFn=fn},Promise._setUnhandledRejectionFn=function(fn){Promise._unhandledRejectionFn=fn},void 0!==module&&module.exports?module.exports=Promise:root.Promise||(root.Promise=Promise)}).call(this,require("timers").setImmediate)},{timers:3}],3:[function(require,module,exports){(function(setImmediate,clearImmediate){var nextTick=require("process/browser.js").nextTick,apply=Function.prototype.apply,slice=Array.prototype.slice,immediateIds={},nextImmediateId=0;function Timeout(id,clearFn){this._id=id,this._clearFn=clearFn}exports.setTimeout=function(){return new Timeout(apply.call(setTimeout,window,arguments),clearTimeout)},exports.setInterval=function(){return new Timeout(apply.call(setInterval,window,arguments),clearInterval)},exports.clearTimeout=exports.clearInterval=function(timeout){timeout.close()},Timeout.prototype.unref=Timeout.prototype.ref=function(){},Timeout.prototype.close=function(){this._clearFn.call(window,this._id)},exports.enroll=function(item,msecs){clearTimeout(item._idleTimeoutId),item._idleTimeout=msecs},exports.unenroll=function(item){clearTimeout(item._idleTimeoutId),item._idleTimeout=-1},exports._unrefActive=exports.active=function(item){clearTimeout(item._idleTimeoutId);var msecs=item._idleTimeout;0<=msecs&&(item._idleTimeoutId=setTimeout(function(){item._onTimeout&&item._onTimeout()},msecs))},exports.setImmediate="function"==typeof setImmediate?setImmediate:function(fn){var id=nextImmediateId++,args=!(arguments.length<2)&&slice.call(arguments,1);return immediateIds[id]=!0,nextTick(function(){immediateIds[id]&&(args?fn.apply(null,args):fn.call(null),exports.clearImmediate(id))}),id},exports.clearImmediate="function"==typeof clearImmediate?clearImmediate:function(id){delete immediateIds[id]}}).call(this,require("timers").setImmediate,require("timers").clearImmediate)},{"process/browser.js":1,timers:3}],4:[function(require,module,exports){var promisePolyfill=require("promise-polyfill"),Global="undefined"!=typeof window?window:Function("return this;")();module.exports={boltExport:Global.Promise||promisePolyfill}},{"promise-polyfill":2}]},{},[4])(4)})}(void 0,exports$1,module$1,void 0);function errorReporter(err){domGlobals.setTimeout(function(){throw err},0)}function par(asyncValues,nu){return nu(function(callback){var r=[],count=0;0===asyncValues.length?callback([]):each(asyncValues,function(asyncValue,i){asyncValue.get(function(i){return function(value){r[i]=value,++count>=asyncValues.length&&callback(r)}}(i))})})}function wrappedSetTimeout(callback,time){return"number"!=typeof time&&(time=0),domGlobals.setTimeout(callback,time)}function wrappedSetInterval(callback,time){return"number"!=typeof time&&(time=1),domGlobals.setInterval(callback,time)}function debounce(callback,time){var timer,func;return(func=function(){for(var args=[],_i=0;_i<arguments.length;_i++)args[_i]=arguments[_i];domGlobals.clearTimeout(timer),timer=wrappedSetTimeout(function(){callback.apply(this,args)},time)}).stop=function(){domGlobals.clearTimeout(timer)},func}function each$2(o,cb,s){var n,l;if(!o)return 0;if(s=s||o,void 0!==o.length){for(n=0,l=o.length;n<l;n++)if(!1===cb.call(s,o[n],n,o))return 0}else for(n in o)if(o.hasOwnProperty(n)&&!1===cb.call(s,o[n],n,o))return 0;return 1}function findIndex$1(array,predicate,thisArg){var i,l;for(i=0,l=array.length;i<l;i++)if(predicate.call(thisArg,array[i],i,array))return i;return-1}function trim$1(str){return null==str?"":(""+str).replace(whiteSpaceRegExp,"")}function is$1(obj,type){return type?!("array"!==type||!ArrUtils.isArray(obj))||typeof obj===type:void 0!==obj}var requestAnimationFramePromise,Promise=module$1.exports.boltExport,nu$3=function(baseFn){var data=Option.none(),callbacks=[],get=function(nCallback){isReady()?call(nCallback):callbacks.push(nCallback)},isReady=function(){return data.isSome()},run=function(cbs){each(cbs,call)},call=function(cb){data.each(function(x){domGlobals.setTimeout(function(){cb(x)},0)})};return baseFn(function(x){data=Option.some(x),run(callbacks),callbacks=[]}),{get:get,map:function(f){return nu$3(function(nCallback){get(function(data){nCallback(f(data))})})},isReady:isReady}},LazyValue={nu:nu$3,pure:function(a){return nu$3(function(callback){callback(a)})}},make=function(run){function get(callback){run().then(callback,errorReporter)}return{map:function(fab){return make(function(){return run().then(fab)})},bind:function(aFutureB){return make(function(){return run().then(function(v){return aFutureB(v).toPromise()})})},anonBind:function(futureB){return make(function(){return run().then(function(){return futureB.toPromise()})})},toLazy:function(){return LazyValue.nu(get)},toCached:function(){var cache=null;return make(function(){return null===cache&&(cache=run()),cache})},toPromise:run,get:get}},Future={nu:function(baseFn){return make(function(){return new Promise(baseFn)})},pure:function(a){return make(function(){return Promise.resolve(a)})}},par$1=function(futures){return par(futures,Future.nu)},value=function(o){return{is:function(v){return o===v},isValue:always,isError:never,getOr:constant(o),getOrThunk:constant(o),getOrDie:constant(o),or:function(opt){return value(o)},orThunk:function(f){return value(o)},fold:function(_,onValue){return onValue(o)},map:function(f){return value(f(o))},mapError:function(f){return value(o)},each:function(f){f(o)},bind:function(f){return f(o)},exists:function(f){return f(o)},forall:function(f){return f(o)},toOption:function(){return Option.some(o)}}},error=function(message){return{is:never,isValue:never,isError:always,getOr:identity,getOrThunk:function(f){return f()},getOrDie:function(){return function(msg){return function(){throw new Error(msg)}}(String(message))()},or:function(opt){return opt},orThunk:function(f){return f()},fold:function(onError,_){return onError(message)},map:function(f){return error(message)},mapError:function(f){return error(f(message))},each:noop,bind:function(f){return error(message)},exists:never,forall:always,toOption:Option.none}},Result={value:value,error:error,fromOption:function(opt,err){return opt.fold(function(){return error(err)},value)}},promiseObj=window.Promise?window.Promise:function(){function bind(fn,thisArg){return function(){fn.apply(thisArg,arguments)}}function Promise(fn){if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");if("function"!=typeof fn)throw new TypeError("not a function");this._state=null,this._value=null,this._deferreds=[],doResolve(fn,bind(resolve,this),bind(reject,this))}var isArray=Array.isArray||function(value){return"[object Array]"===Object.prototype.toString.call(value)},asap=Promise.immediateFn||"function"==typeof domGlobals.setImmediate&&domGlobals.setImmediate||function(fn){domGlobals.setTimeout(fn,1)};function handle(deferred){var me=this;null!==this._state?asap(function(){var cb=me._state?deferred.onFulfilled:deferred.onRejected;if(null!==cb){var ret;try{ret=cb(me._value)}catch(e){return void deferred.reject(e)}deferred.resolve(ret)}else(me._state?deferred.resolve:deferred.reject)(me._value)}):this._deferreds.push(deferred)}function resolve(newValue){try{if(newValue===this)throw new TypeError("A promise cannot be resolved with itself.");if(newValue&&("object"==typeof newValue||"function"==typeof newValue)){var then=newValue.then;if("function"==typeof then)return void doResolve(bind(then,newValue),bind(resolve,this),bind(reject,this))}this._state=!0,this._value=newValue,finale.call(this)}catch(e){reject.call(this,e)}}function reject(newValue){this._state=!1,this._value=newValue,finale.call(this)}function finale(){for(var i=0,len=this._deferreds.length;i<len;i++)handle.call(this,this._deferreds[i]);this._deferreds=null}function Handler(onFulfilled,onRejected,resolve,reject){this.onFulfilled="function"==typeof onFulfilled?onFulfilled:null,this.onRejected="function"==typeof onRejected?onRejected:null,this.resolve=resolve,this.reject=reject}function doResolve(fn,onFulfilled,onRejected){var done=!1;try{fn(function(value){done||(done=!0,onFulfilled(value))},function(reason){done||(done=!0,onRejected(reason))})}catch(ex){if(done)return;done=!0,onRejected(ex)}}return Promise.prototype.catch=function(onRejected){return this.then(null,onRejected)},Promise.prototype.then=function(onFulfilled,onRejected){var me=this;return new Promise(function(resolve,reject){handle.call(me,new Handler(onFulfilled,onRejected,resolve,reject))})},Promise.all=function(){var args=Array.prototype.slice.call(1===arguments.length&&isArray(arguments[0])?arguments[0]:arguments);return new Promise(function(resolve,reject){if(0===args.length)return resolve([]);var remaining=args.length;function res(i,val){try{if(val&&("object"==typeof val||"function"==typeof val)){var then=val.then;if("function"==typeof then)return void then.call(val,function(val){res(i,val)},reject)}args[i]=val,0==--remaining&&resolve(args)}catch(ex){reject(ex)}}for(var i=0;i<args.length;i++)res(i,args[i])})},Promise.resolve=function(value){return value&&"object"==typeof value&&value.constructor===Promise?value:new Promise(function(resolve){resolve(value)})},Promise.reject=function(value){return new Promise(function(resolve,reject){reject(value)})},Promise.race=function(values){return new Promise(function(resolve,reject){for(var i=0,len=values.length;i<len;i++)values[i].then(resolve,reject)})},Promise}(),Delay={requestAnimationFrame:function(callback,element){requestAnimationFramePromise?requestAnimationFramePromise.then(callback):requestAnimationFramePromise=new promiseObj(function(resolve){!function(callback,element){var i,requestAnimationFrameFunc=domGlobals.window.requestAnimationFrame,vendors=["ms","moz","webkit"];for(i=0;i<vendors.length&&!requestAnimationFrameFunc;i++)requestAnimationFrameFunc=domGlobals.window[vendors[i]+"RequestAnimationFrame"];(requestAnimationFrameFunc=requestAnimationFrameFunc||function(callback){domGlobals.window.setTimeout(callback,0)})(callback,element)}(resolve,element=element||domGlobals.document.body)}).then(callback)},setTimeout:wrappedSetTimeout,setInterval:wrappedSetInterval,setEditorTimeout:function(editor,callback,time){return wrappedSetTimeout(function(){editor.removed||callback()},time)},setEditorInterval:function(editor,callback,time){var timer;return timer=wrappedSetInterval(function(){editor.removed?domGlobals.clearInterval(timer):callback()},time)},debounce:debounce,throttle:debounce,clearInterval:function(id){return domGlobals.clearInterval(id)},clearTimeout:function(id){return domGlobals.clearTimeout(id)}},userAgent=domGlobals.navigator.userAgent,platform$1=detect$3(),browser$2=platform$1.browser,os=platform$1.os,deviceType=platform$1.deviceType,webkit=/WebKit/.test(userAgent)&&!browser$2.isEdge(),fileApi="FormData"in domGlobals.window&&"FileReader"in domGlobals.window&&"URL"in domGlobals.window&&!!domGlobals.URL.createObjectURL,windowsPhone=-1!==userAgent.indexOf("Windows Phone"),Env={opera:browser$2.isOpera(),webkit:webkit,ie:!(!browser$2.isIE()&&!browser$2.isEdge())&&browser$2.version.major,gecko:browser$2.isFirefox(),mac:os.isOSX()||os.isiOS(),iOS:deviceType.isiPad()||deviceType.isiPhone(),android:os.isAndroid(),contentEditable:!0,transparentSrc:"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",caretAfter:!0,range:domGlobals.window.getSelection&&"Range"in domGlobals.window,documentMode:browser$2.isIE()?domGlobals.document.documentMode||7:10,fileApi:fileApi,ceFalse:!0,cacheSuffix:null,container:null,experimentalShadowDom:!1,canHaveCSP:!browser$2.isIE(),desktop:deviceType.isDesktop(),windowsPhone:windowsPhone,browser:{current:browser$2.current,version:browser$2.version,isChrome:browser$2.isChrome,isEdge:browser$2.isEdge,isFirefox:browser$2.isFirefox,isIE:browser$2.isIE,isOpera:browser$2.isOpera,isSafari:browser$2.isSafari},os:{current:os.current,version:os.version,isAndroid:os.isAndroid,isChromeOS:os.isChromeOS,isFreeBSD:os.isFreeBSD,isiOS:os.isiOS,isLinux:os.isLinux,isOSX:os.isOSX,isSolaris:os.isSolaris,isWindows:os.isWindows},deviceType:{isDesktop:deviceType.isDesktop,isiPad:deviceType.isiPad,isiPhone:deviceType.isiPhone,isPhone:deviceType.isPhone,isTablet:deviceType.isTablet,isTouch:deviceType.isTouch,isWebView:deviceType.isWebView}},isArray$1=Array.isArray,ArrUtils={isArray:isArray$1,toArray:function(obj){var i,l,array=obj;if(!isArray$1(obj))for(array=[],i=0,l=obj.length;i<l;i++)array[i]=obj[i];return array},each:each$2,map:function(array,callback){var out=[];return each$2(array,function(item,index){out.push(callback(item,index,array))}),out},filter:function(a,f){var o=[];return each$2(a,function(v,index){f&&!f(v,index,a)||o.push(v)}),o},indexOf:function(a,v){var i,l;if(a)for(i=0,l=a.length;i<l;i++)if(a[i]===v)return i;return-1},reduce:function(collection,iteratee,accumulator,thisArg){var i=0;for(arguments.length<3&&(accumulator=collection[0]);i<collection.length;i++)accumulator=iteratee.call(thisArg,accumulator,collection[i],i);return accumulator},findIndex:findIndex$1,find:function(array,predicate,thisArg){var idx=findIndex$1(array,predicate,thisArg);if(-1!==idx)return array[idx]},last:function(collection){return collection[collection.length-1]}},whiteSpaceRegExp=/^\s*|\s*$/g,walk=function(o,f,n,s){s=s||this,o&&(n&&(o=o[n]),ArrUtils.each(o,function(o,i){if(!1===f.call(s,o,i,n))return!1;walk(o,f,n,s)}))},Tools={trim:trim$1,isArray:ArrUtils.isArray,is:is$1,toArray:ArrUtils.toArray,makeMap:function(items,delim,map){var i;for(delim=delim||",","string"==typeof(items=items||[])&&(items=items.split(delim)),map=map||{},i=items.length;i--;)map[items[i]]={};return map},each:ArrUtils.each,map:ArrUtils.map,grep:ArrUtils.filter,inArray:ArrUtils.indexOf,hasOwn:function(obj,prop){return Object.prototype.hasOwnProperty.call(obj,prop)},extend:function(obj,ext){for(var i,l,name,x=[],_i=2;_i<arguments.length;_i++)x[_i-2]=arguments[_i];var value,args=arguments;for(i=1,l=args.length;i<l;i++)for(name in ext=args[i])ext.hasOwnProperty(name)&&void 0!==(value=ext[name])&&(obj[name]=value);return obj},create:function(s,p,root){var sp,ns,cn,scn,c,de=0;if(s=/^((static) )?([\w.]+)(:([\w.]+))?/.exec(s),cn=s[3].match(/(^|\.)(\w+)$/i)[2],!(ns=this.createNS(s[3].replace(/\.\w+$/,""),root))[cn]){if("static"===s[2])return ns[cn]=p,void(this.onCreate&&this.onCreate(s[2],s[3],ns[cn]));p[cn]||(p[cn]=function(){},de=1),ns[cn]=p[cn],this.extend(ns[cn].prototype,p),s[5]&&(sp=this.resolve(s[5]).prototype,scn=s[5].match(/\.(\w+)$/i)[1],c=ns[cn],ns[cn]=de?function(){return sp[scn].apply(this,arguments)}:function(){return this.parent=sp[scn],c.apply(this,arguments)},ns[cn].prototype[cn]=ns[cn],this.each(sp,function(f,n){ns[cn].prototype[n]=sp[n]}),this.each(p,function(f,n){sp[n]?ns[cn].prototype[n]=function(){return this.parent=sp[n],f.apply(this,arguments)}:n!==cn&&(ns[cn].prototype[n]=f)})),this.each(p.static,function(f,n){ns[cn][n]=f})}},walk:walk,createNS:function(n,o){var i,v;for(o=o||domGlobals.window,n=n.split("."),i=0;i<n.length;i++)o[v=n[i]]||(o[v]={}),o=o[v];return o},resolve:function(n,o){var i,l;for(o=o||domGlobals.window,i=0,l=(n=n.split(".")).length;i<l&&(o=o[n[i]]);i++);return o},explode:function(s,d){return!s||is$1(s,"array")?s:ArrUtils.map(s.split(d||","),trim$1)},_addCacheSuffix:function(url){var cacheSuffix=Env.cacheSuffix;return cacheSuffix&&(url+=(-1===url.indexOf("?")?"?":"&")+cacheSuffix),url}};function StyleSheetLoader(document,settings){void 0===settings&&(settings={});var maxLoadTime,idCount=0,loadedStates={};maxLoadTime=settings.maxLoadTime||5e3;function appendToHead(node){document.getElementsByTagName("head")[0].appendChild(node)}function load(url,loadedCallback,errorCallback){function resolve(status){state.status=status,state.passed=[],state.failed=[],link&&(link.onload=null,link.onerror=null,link=null)}function passed(){for(var callbacks=state.passed,i=callbacks.length;i--;)callbacks[i]();resolve(2)}function failed(){for(var callbacks=state.failed,i=callbacks.length;i--;)callbacks[i]();resolve(3)}function wait(testCallback,waitCallback){testCallback()||((new Date).getTime()-startTime<maxLoadTime?Delay.setTimeout(waitCallback):failed())}var link,style,startTime,state,waitForWebKitLinkLoaded=function(){wait(function(){for(var styleSheet,owner,styleSheets=document.styleSheets,i=styleSheets.length;i--;)if((owner=(styleSheet=styleSheets[i]).ownerNode?styleSheet.ownerNode:styleSheet.owningElement)&&owner.id===link.id)return passed(),!0},waitForWebKitLinkLoaded)},waitForGeckoLinkLoaded=function(){wait(function(){try{var cssRules=style.sheet.cssRules;return passed(),!!cssRules}catch(ex){}},waitForGeckoLinkLoaded)};if(url=Tools._addCacheSuffix(url),loadedStates[url]?state=loadedStates[url]:(state={passed:[],failed:[]},loadedStates[url]=state),loadedCallback&&state.passed.push(loadedCallback),errorCallback&&state.failed.push(errorCallback),1!==state.status)if(2!==state.status)if(3!==state.status){if(state.status=1,(link=document.createElement("link")).rel="stylesheet",link.type="text/css",link.id="u"+idCount++,link.async=!1,link.defer=!1,startTime=(new Date).getTime(),settings.contentCssCors&&(link.crossOrigin="anonymous"),settings.referrerPolicy&&set(Element.fromDom(link),"referrerpolicy",settings.referrerPolicy),"onload"in link&&!((webKitChunks=domGlobals.navigator.userAgent.match(/WebKit\/(\d*)/))&&parseInt(webKitChunks[1],10)<536))link.onload=waitForWebKitLinkLoaded,link.onerror=failed;else{if(0<domGlobals.navigator.userAgent.indexOf("Firefox"))return(style=document.createElement("style")).textContent='@import "'+url+'"',waitForGeckoLinkLoaded(),void appendToHead(style);waitForWebKitLinkLoaded()}var webKitChunks;appendToHead(link),link.href=url}else failed();else passed()}function loadF(url){return Future.nu(function(resolve){load(url,compose(resolve,constant(Result.value(url))),compose(resolve,constant(Result.error(url))))})}function unbox(result){return result.fold(identity,identity)}return{load:load,loadAll:function(urls,success,failure){par$1(map(urls,loadF)).get(function(result){var parts=partition(result,function(r){return r.isValue()});0<parts.fail.length?failure(parts.fail.map(unbox)):success(parts.pass.map(unbox))})},_setReferrerPolicy:function(referrerPolicy){settings.referrerPolicy=referrerPolicy}}}function lazyLookup(items){var lookup;return function(node){return(lookup=lookup||function(xs,f){for(var r={},i=0,len=xs.length;i<len;i++){var x=xs[i];r[String(x)]=f(x,i)}return r}(items,constant(!0))).hasOwnProperty(name(node))}}function isInline(node){return isElement(node)&&!isBlock(node)}function isBr$1(node){return isElement(node)&&"br"===name(node)}function isBookmarkNode(node){return node&&"SPAN"===node.tagName&&"bookmark"===node.getAttribute("data-mce-type")}var namedEntities,baseEntities,reverseEntities,isHeading=lazyLookup(["h1","h2","h3","h4","h5","h6"]),isBlock=lazyLookup(["article","aside","details","div","dt","figcaption","footer","form","fieldset","header","hgroup","html","main","nav","section","summary","body","p","dl","multicol","dd","figure","address","center","blockquote","h1","h2","h3","h4","h5","h6","listing","xmp","pre","plaintext","menu","dir","ul","ol","li","hr","table","tbody","thead","tfoot","th","tr","td","caption"]),isTextBlock=lazyLookup(["h1","h2","h3","h4","h5","h6","p","div","address","pre","form","blockquote","center","dir","fieldset","header","footer","article","section","hgroup","aside","nav","figure"]),isList=lazyLookup(["ul","ol","dl"]),isListItem=lazyLookup(["li","dd","dt"]),isVoid=lazyLookup(["area","base","basefont","br","col","frame","hr","img","input","isindex","link","meta","param","embed","source","wbr","track"]),isTableSection=lazyLookup(["thead","tbody","tfoot"]),isTableCell=lazyLookup(["td","th"]),isWsPreserveElement=lazyLookup(["pre","script","textarea","style"]),trimNode=function(dom,node){var i,children=node.childNodes;if(!NodeType.isElement(node)||!isBookmarkNode(node)){for(i=children.length-1;0<=i;i--)trimNode(dom,children[i]);if(!1===NodeType.isDocument(node)){if(NodeType.isText(node)&&0<node.nodeValue.length){var trimmedLength=Tools.trim(node.nodeValue).length;if(dom.isBlock(node.parentNode)||0<trimmedLength)return;if(0===trimmedLength&&function(node){var previousIsSpan=node.previousSibling&&"SPAN"===node.previousSibling.nodeName,nextIsSpan=node.nextSibling&&"SPAN"===node.nextSibling.nodeName;return previousIsSpan&&nextIsSpan}(node))return}else if(NodeType.isElement(node)&&(1===(children=node.childNodes).length&&isBookmarkNode(children[0])&&node.parentNode.insertBefore(children[0],node),children.length||isVoid(Element.fromDom(node))))return;dom.remove(node)}return node}},TrimNode={trimNode:trimNode},makeMap$1=Tools.makeMap,attrsCharsRegExp=/[&<>\"\u0060\u007E-\uD7FF\uE000-\uFFEF]|[\uD800-\uDBFF][\uDC00-\uDFFF]/g,textCharsRegExp=/[<>&\u007E-\uD7FF\uE000-\uFFEF]|[\uD800-\uDBFF][\uDC00-\uDFFF]/g,rawCharsRegExp=/[<>&\"\']/g,entityRegExp=/&#([a-z0-9]+);?|&([a-z0-9]+);/gi,asciiMap={128:"",130:"",131:"",132:"",133:"",134:"",135:"",136:"",137:"",138:"",139:"",140:"",142:"",145:"",146:"",147:"",148:"",149:"",150:"",151:"",152:"",153:"",154:"",155:"",156:"",158:"",159:""};baseEntities={'"':"&quot;","'":"&#39;","<":"&lt;",">":"&gt;","&":"&amp;","`":"&#96;"},reverseEntities={"&lt;":"<","&gt;":">","&amp;":"&","&quot;":'"',"&apos;":"'"};function buildEntitiesLookup(items,radix){var i,chr,entity,lookup={};if(items){for(items=items.split(","),radix=radix||10,i=0;i<items.length;i+=2)chr=String.fromCharCode(parseInt(items[i],radix)),baseEntities[chr]||(entity="&"+items[i+1]+";",lookup[chr]=entity,lookup[entity]=chr);return lookup}}namedEntities=buildEntitiesLookup("50,nbsp,51,iexcl,52,cent,53,pound,54,curren,55,yen,56,brvbar,57,sect,58,uml,59,copy,5a,ordf,5b,laquo,5c,not,5d,shy,5e,reg,5f,macr,5g,deg,5h,plusmn,5i,sup2,5j,sup3,5k,acute,5l,micro,5m,para,5n,middot,5o,cedil,5p,sup1,5q,ordm,5r,raquo,5s,frac14,5t,frac12,5u,frac34,5v,iquest,60,Agrave,61,Aacute,62,Acirc,63,Atilde,64,Auml,65,Aring,66,AElig,67,Ccedil,68,Egrave,69,Eacute,6a,Ecirc,6b,Euml,6c,Igrave,6d,Iacute,6e,Icirc,6f,Iuml,6g,ETH,6h,Ntilde,6i,Ograve,6j,Oacute,6k,Ocirc,6l,Otilde,6m,Ouml,6n,times,6o,Oslash,6p,Ugrave,6q,Uacute,6r,Ucirc,6s,Uuml,6t,Yacute,6u,THORN,6v,szlig,70,agrave,71,aacute,72,acirc,73,atilde,74,auml,75,aring,76,aelig,77,ccedil,78,egrave,79,eacute,7a,ecirc,7b,euml,7c,igrave,7d,iacute,7e,icirc,7f,iuml,7g,eth,7h,ntilde,7i,ograve,7j,oacute,7k,ocirc,7l,otilde,7m,ouml,7n,divide,7o,oslash,7p,ugrave,7q,uacute,7r,ucirc,7s,uuml,7t,yacute,7u,thorn,7v,yuml,ci,fnof,sh,Alpha,si,Beta,sj,Gamma,sk,Delta,sl,Epsilon,sm,Zeta,sn,Eta,so,Theta,sp,Iota,sq,Kappa,sr,Lambda,ss,Mu,st,Nu,su,Xi,sv,Omicron,t0,Pi,t1,Rho,t3,Sigma,t4,Tau,t5,Upsilon,t6,Phi,t7,Chi,t8,Psi,t9,Omega,th,alpha,ti,beta,tj,gamma,tk,delta,tl,epsilon,tm,zeta,tn,eta,to,theta,tp,iota,tq,kappa,tr,lambda,ts,mu,tt,nu,tu,xi,tv,omicron,u0,pi,u1,rho,u2,sigmaf,u3,sigma,u4,tau,u5,upsilon,u6,phi,u7,chi,u8,psi,u9,omega,uh,thetasym,ui,upsih,um,piv,812,bull,816,hellip,81i,prime,81j,Prime,81u,oline,824,frasl,88o,weierp,88h,image,88s,real,892,trade,89l,alefsym,8cg,larr,8ch,uarr,8ci,rarr,8cj,darr,8ck,harr,8dl,crarr,8eg,lArr,8eh,uArr,8ei,rArr,8ej,dArr,8ek,hArr,8g0,forall,8g2,part,8g3,exist,8g5,empty,8g7,nabla,8g8,isin,8g9,notin,8gb,ni,8gf,prod,8gh,sum,8gi,minus,8gn,lowast,8gq,radic,8gt,prop,8gu,infin,8h0,ang,8h7,and,8h8,or,8h9,cap,8ha,cup,8hb,int,8hk,there4,8hs,sim,8i5,cong,8i8,asymp,8j0,ne,8j1,equiv,8j4,le,8j5,ge,8k2,sub,8k3,sup,8k4,nsub,8k6,sube,8k7,supe,8kl,oplus,8kn,otimes,8l5,perp,8m5,sdot,8o8,lceil,8o9,rceil,8oa,lfloor,8ob,rfloor,8p9,lang,8pa,rang,9ea,loz,9j0,spades,9j3,clubs,9j5,hearts,9j6,diams,ai,OElig,aj,oelig,b0,Scaron,b1,scaron,bo,Yuml,m6,circ,ms,tilde,802,ensp,803,emsp,809,thinsp,80c,zwnj,80d,zwj,80e,lrm,80f,rlm,80j,ndash,80k,mdash,80o,lsquo,80p,rsquo,80q,sbquo,80s,ldquo,80t,rdquo,80u,bdquo,810,dagger,811,Dagger,81g,permil,81p,lsaquo,81q,rsaquo,85c,euro",32);function encodeRaw(text,attr){return text.replace(attr?attrsCharsRegExp:textCharsRegExp,function(chr){return baseEntities[chr]||chr})}function encodeNumeric(text,attr){return text.replace(attr?attrsCharsRegExp:textCharsRegExp,function(chr){return 1<chr.length?"&#"+(1024*(chr.charCodeAt(0)-55296)+(chr.charCodeAt(1)-56320)+65536)+";":baseEntities[chr]||"&#"+chr.charCodeAt(0)+";"})}function encodeNamed(text,attr,entities){return entities=entities||namedEntities,text.replace(attr?attrsCharsRegExp:textCharsRegExp,function(chr){return baseEntities[chr]||entities[chr]||chr})}var Entities={encodeRaw:encodeRaw,encodeAllRaw:function(text){return(""+text).replace(rawCharsRegExp,function(chr){return baseEntities[chr]||chr})},encodeNumeric:encodeNumeric,encodeNamed:encodeNamed,getEncodeFunc:function(name,entities){var entitiesMap=buildEntitiesLookup(entities)||namedEntities,nameMap=makeMap$1(name.replace(/\+/g,","));return nameMap.named&&nameMap.numeric?function(text,attr){return text.replace(attr?attrsCharsRegExp:textCharsRegExp,function(chr){return void 0!==baseEntities[chr]?baseEntities[chr]:void 0!==entitiesMap[chr]?entitiesMap[chr]:1<chr.length?"&#"+(1024*(chr.charCodeAt(0)-55296)+(chr.charCodeAt(1)-56320)+65536)+";":"&#"+chr.charCodeAt(0)+";"})}:nameMap.named?entities?function(text,attr){return encodeNamed(text,attr,entitiesMap)}:encodeNamed:nameMap.numeric?encodeNumeric:encodeRaw},decode:function(text){return text.replace(entityRegExp,function(all,numeric){return numeric?65535<(numeric="x"===numeric.charAt(0).toLowerCase()?parseInt(numeric.substr(1),16):parseInt(numeric,10))?(numeric-=65536,String.fromCharCode(55296+(numeric>>10),56320+(1023&numeric))):asciiMap[numeric]||String.fromCharCode(numeric):reverseEntities[all]||namedEntities[all]||function(text){var elm;return(elm=Element.fromTag("div").dom()).innerHTML=text,elm.textContent||elm.innerText||text}(all)})}},mapCache={},dummyObj={},makeMap$2=Tools.makeMap,each$3=Tools.each,extend$1=Tools.extend,explode$1=Tools.explode,inArray=Tools.inArray,split=function(items,delim){return(items=Tools.trim(items))?items.split(delim||" "):[]},compileSchema=function(type){function add(name,attributes,children){function arrayToMap(array,obj){var i,l,map={};for(i=0,l=array.length;i<l;i++)map[array[i]]=obj||{};return map}var ni,attributesOrder,element;for(attributes=attributes||"","string"==typeof(children=children||[])&&(children=split(children)),ni=(name=split(name)).length;ni--;)element={attributes:arrayToMap(attributesOrder=split([globalAttributes,attributes].join(" "))),attributesOrder:attributesOrder,children:arrayToMap(children,dummyObj)},schema[name[ni]]=element}function addAttrs(name,attributes){var ni,schemaItem,i,l;for(ni=(name=split(name)).length,attributes=split(attributes);ni--;)for(schemaItem=schema[name[ni]],i=0,l=attributes.length;i<l;i++)schemaItem.attributes[attributes[i]]={},schemaItem.attributesOrder.push(attributes[i])}var globalAttributes,blockContent,phrasingContent,flowContent,html4BlockContent,html4PhrasingContent,schema={};return mapCache[type]?mapCache[type]:(globalAttributes="id accesskey class dir lang style tabindex title role",blockContent="address blockquote div dl fieldset form h1 h2 h3 h4 h5 h6 hr menu ol p pre table ul",phrasingContent="a abbr b bdo br button cite code del dfn em embed i iframe img input ins kbd label map noscript object q s samp script select small span strong sub sup textarea u var #text #comment","html4"!==type&&(globalAttributes+=" contenteditable contextmenu draggable dropzone hidden spellcheck translate",blockContent+=" article aside details dialog figure main header footer hgroup section nav",phrasingContent+=" audio canvas command datalist mark meter output picture progress time wbr video ruby bdi keygen"),"html5-strict"!==type&&(globalAttributes+=" xml:lang",phrasingContent=[phrasingContent,html4PhrasingContent="acronym applet basefont big font strike tt"].join(" "),each$3(split(html4PhrasingContent),function(name){add(name,"",phrasingContent)}),blockContent=[blockContent,html4BlockContent="center dir isindex noframes"].join(" "),flowContent=[blockContent,phrasingContent].join(" "),each$3(split(html4BlockContent),function(name){add(name,"",flowContent)})),flowContent=flowContent||[blockContent,phrasingContent].join(" "),add("html","manifest","head body"),add("head","","base command link meta noscript script style title"),add("title hr noscript br"),add("base","href target"),add("link","href rel media hreflang type sizes hreflang"),add("meta","name http-equiv content charset"),add("style","media type scoped"),add("script","src async defer type charset"),add("body","onafterprint onbeforeprint onbeforeunload onblur onerror onfocus onhashchange onload onmessage onoffline ononline onpagehide onpageshow onpopstate onresize onscroll onstorage onunload",flowContent),add("address dt dd div caption","",flowContent),add("h1 h2 h3 h4 h5 h6 pre p abbr code var samp kbd sub sup i b u bdo span legend em strong small s cite dfn","",phrasingContent),add("blockquote","cite",flowContent),add("ol","reversed start type","li"),add("ul","","li"),add("li","value",flowContent),add("dl","","dt dd"),add("a","href target rel media hreflang type",phrasingContent),add("q","cite",phrasingContent),add("ins del","cite datetime",flowContent),add("img","src sizes srcset alt usemap ismap width height"),add("iframe","src name width height",flowContent),add("embed","src type width height"),add("object","data type typemustmatch name usemap form width height",[flowContent,"param"].join(" ")),add("param","name value"),add("map","name",[flowContent,"area"].join(" ")),add("area","alt coords shape href target rel media hreflang type"),add("table","border","caption colgroup thead tfoot tbody tr"+("html4"===type?" col":"")),add("colgroup","span","col"),add("col","span"),add("tbody thead tfoot","","tr"),add("tr","","td th"),add("td","colspan rowspan headers",flowContent),add("th","colspan rowspan headers scope abbr",flowContent),add("form","accept-charset action autocomplete enctype method name novalidate target",flowContent),add("fieldset","disabled form name",[flowContent,"legend"].join(" ")),add("label","form for",phrasingContent),add("input","accept alt autocomplete checked dirname disabled form formaction formenctype formmethod formnovalidate formtarget height list max maxlength min multiple name pattern readonly required size src step type value width"),add("button","disabled form formaction formenctype formmethod formnovalidate formtarget name type value","html4"===type?flowContent:phrasingContent),add("select","disabled form multiple name required size","option optgroup"),add("optgroup","disabled label","option"),add("option","disabled label selected value"),add("textarea","cols dirname disabled form maxlength name readonly required rows wrap"),add("menu","type label",[flowContent,"li"].join(" ")),add("noscript","",flowContent),"html4"!==type&&(add("wbr"),add("ruby","",[phrasingContent,"rt rp"].join(" ")),add("figcaption","",flowContent),add("mark rt rp summary bdi","",phrasingContent),add("canvas","width height",flowContent),add("video","src crossorigin poster preload autoplay mediagroup loop muted controls width height buffered",[flowContent,"track source"].join(" ")),add("audio","src crossorigin preload autoplay mediagroup loop muted controls buffered volume",[flowContent,"track source"].join(" ")),add("picture","","img source"),add("source","src srcset type media sizes"),add("track","kind src srclang label default"),add("datalist","",[phrasingContent,"option"].join(" ")),add("article section nav aside main header footer","",flowContent),add("hgroup","","h1 h2 h3 h4 h5 h6"),add("figure","",[flowContent,"figcaption"].join(" ")),add("time","datetime",phrasingContent),add("dialog","open",flowContent),add("command","type label icon disabled checked radiogroup command"),add("output","for form name",phrasingContent),add("progress","value max",phrasingContent),add("meter","value min max low high optimum",phrasingContent),add("details","open",[flowContent,"summary"].join(" ")),add("keygen","autofocus challenge disabled form keytype name")),"html5-strict"!==type&&(addAttrs("script","language xml:space"),addAttrs("style","xml:space"),addAttrs("object","declare classid code codebase codetype archive standby align border hspace vspace"),addAttrs("embed","align name hspace vspace"),addAttrs("param","valuetype type"),addAttrs("a","charset name rev shape coords"),addAttrs("br","clear"),addAttrs("applet","codebase archive code object alt name width height align hspace vspace"),addAttrs("img","name longdesc align border hspace vspace"),addAttrs("iframe","longdesc frameborder marginwidth marginheight scrolling align"),addAttrs("font basefont","size color face"),addAttrs("input","usemap align"),addAttrs("select"),addAttrs("textarea"),addAttrs("h1 h2 h3 h4 h5 h6 div p legend caption","align"),addAttrs("ul","type compact"),addAttrs("li","type"),addAttrs("ol dl menu dir","compact"),addAttrs("pre","width xml:space"),addAttrs("hr","align noshade size width"),addAttrs("isindex","prompt"),addAttrs("table","summary width frame rules cellspacing cellpadding align bgcolor"),addAttrs("col","width align char charoff valign"),addAttrs("colgroup","width align char charoff valign"),addAttrs("thead","align char charoff valign"),addAttrs("tr","align char charoff valign bgcolor"),addAttrs("th","axis align char charoff valign nowrap bgcolor width height"),addAttrs("form","accept"),addAttrs("td","abbr axis scope align char charoff valign nowrap bgcolor width height"),addAttrs("tfoot","align char charoff valign"),addAttrs("tbody","align char charoff valign"),addAttrs("area","nohref"),addAttrs("body","background bgcolor text link vlink alink")),"html4"!==type&&(addAttrs("input button select textarea","autofocus"),addAttrs("input textarea","placeholder"),addAttrs("a","download"),addAttrs("link script img","crossorigin"),addAttrs("img","loading"),addAttrs("iframe","sandbox seamless allowfullscreen loading")),each$3(split("a form meter progress dfn"),function(name){schema[name]&&delete schema[name].children[name]}),delete schema.caption.children.table,delete schema.script,mapCache[type]=schema)},compileElementMap=function(value,mode){var styles;return value&&(styles={},"string"==typeof value&&(value={"*":value}),each$3(value,function(value,key){styles[key]=styles[key.toUpperCase()]="map"===mode?makeMap$2(value,/[, ]/):explode$1(value,/[, ]/)})),styles};function Schema(settings){function createLookupTable(option,defaultValue,extendWith){var value=settings[option];return value?value=makeMap$2(value,/[, ]/,makeMap$2(value.toUpperCase(),/[, ]/)):(value=mapCache[option])||(value=makeMap$2(defaultValue," ",makeMap$2(defaultValue.toUpperCase()," ")),value=extend$1(value,extendWith),mapCache[option]=value),value}var validStyles,invalidStyles,schemaItems,whiteSpaceElementsMap,selfClosingElementsMap,shortEndedElementsMap,boolAttrMap,validClasses,blockElementsMap,nonEmptyElementsMap,moveCaretBeforeOnEnterElementsMap,textBlockElementsMap,textInlineElementsMap,elements={},children={},patternElements=[],customElementsMap={},specialElements={};schemaItems=compileSchema((settings=settings||{}).schema),!1===settings.verify_html&&(settings.valid_elements="*[*]"),validStyles=compileElementMap(settings.valid_styles),invalidStyles=compileElementMap(settings.invalid_styles,"map"),validClasses=compileElementMap(settings.valid_classes,"map"),whiteSpaceElementsMap=createLookupTable("whitespace_elements","pre script noscript style textarea video audio iframe object code"),selfClosingElementsMap=createLookupTable("self_closing_elements","colgroup dd dt li option p td tfoot th thead tr"),shortEndedElementsMap=createLookupTable("short_ended_elements","area base basefont br col frame hr img input isindex link meta param embed source wbr track"),boolAttrMap=createLookupTable("boolean_attributes","checked compact declare defer disabled ismap multiple nohref noresize noshade nowrap readonly selected autoplay loop controls"),nonEmptyElementsMap=createLookupTable("non_empty_elements","td th iframe video audio object script pre code",shortEndedElementsMap),moveCaretBeforeOnEnterElementsMap=createLookupTable("move_caret_before_on_enter_elements","table",nonEmptyElementsMap),textBlockElementsMap=createLookupTable("text_block_elements","h1 h2 h3 h4 h5 h6 p div address pre form blockquote center dir fieldset header footer article section hgroup aside main nav figure"),blockElementsMap=createLookupTable("block_elements","hr table tbody thead tfoot th tr td li ol ul caption dl dt dd noscript menu isindex option datalist select optgroup figcaption details summary",textBlockElementsMap),textInlineElementsMap=createLookupTable("text_inline_elements","span strong b em i font strike u var cite dfn code mark q sup sub samp"),each$3((settings.special||"script noscript noframes noembed title style textarea xmp").split(" "),function(name){specialElements[name]=new RegExp("</"+name+"[^>]*>","gi")});function patternToRegExp(str){return new RegExp("^"+str.replace(/([?+*])/g,".$1")+"$")}function addValidElements(validElements){var ei,el,ai,al,matches,element,attr,attrData,elementName,attrName,attrType,attributes,attributesOrder,prefix,outputName,globalAttributes,globalAttributesOrder,key,value,elementRuleRegExp=/^([#+\-])?([^\[!\/]+)(?:\/([^\[!]+))?(?:(!?)\[([^\]]+)\])?$/,attrRuleRegExp=/^([!\-])?(\w+[\\:]:\w+|[^=:<]+)?(?:([=:<])(.*))?$/,hasPatternsRegExp=/[*?+]/;if(validElements)for(validElements=split(validElements,","),elements["@"]&&(globalAttributes=elements["@"].attributes,globalAttributesOrder=elements["@"].attributesOrder),ei=0,el=validElements.length;ei<el;ei++)if(matches=elementRuleRegExp.exec(validElements[ei])){if(prefix=matches[1],elementName=matches[2],outputName=matches[3],attrData=matches[5],element={attributes:attributes={},attributesOrder:attributesOrder=[]},"#"===prefix&&(element.paddEmpty=!0),"-"===prefix&&(element.removeEmpty=!0),"!"===matches[4]&&(element.removeEmptyAttrs=!0),globalAttributes){for(key in globalAttributes)attributes[key]=globalAttributes[key];attributesOrder.push.apply(attributesOrder,globalAttributesOrder)}if(attrData)for(ai=0,al=(attrData=split(attrData,"|")).length;ai<al;ai++)if(matches=attrRuleRegExp.exec(attrData[ai])){if(attr={},attrType=matches[1],attrName=matches[2].replace(/[\\:]:/g,":"),prefix=matches[3],value=matches[4],"!"===attrType&&(element.attributesRequired=element.attributesRequired||[],element.attributesRequired.push(attrName),attr.required=!0),"-"===attrType){delete attributes[attrName],attributesOrder.splice(inArray(attributesOrder,attrName),1);continue}prefix&&("="===prefix&&(element.attributesDefault=element.attributesDefault||[],element.attributesDefault.push({name:attrName,value:value}),attr.defaultValue=value),":"===prefix&&(element.attributesForced=element.attributesForced||[],element.attributesForced.push({name:attrName,value:value}),attr.forcedValue=value),"<"===prefix&&(attr.validValues=makeMap$2(value,"?"))),hasPatternsRegExp.test(attrName)?(element.attributePatterns=element.attributePatterns||[],attr.pattern=patternToRegExp(attrName),element.attributePatterns.push(attr)):(attributes[attrName]||attributesOrder.push(attrName),attributes[attrName]=attr)}globalAttributes||"@"!==elementName||(globalAttributes=attributes,globalAttributesOrder=attributesOrder),outputName&&(element.outputName=elementName,elements[outputName]=element),hasPatternsRegExp.test(elementName)?(element.pattern=patternToRegExp(elementName),patternElements.push(element)):elements[elementName]=element}}function setValidElements(validElements){elements={},patternElements=[],addValidElements(validElements),each$3(schemaItems,function(element,name){children[name]=element.children})}function addCustomElements(customElements){var customElementRegExp=/^(~)?(.+)$/;customElements&&(mapCache.text_block_elements=mapCache.block_elements=null,each$3(split(customElements,","),function(rule){var matches=customElementRegExp.exec(rule),inline="~"===matches[1],cloneName=inline?"span":"div",name=matches[2];if(children[name]=children[cloneName],customElementsMap[name]=cloneName,inline||(blockElementsMap[name.toUpperCase()]={},blockElementsMap[name]={}),!elements[name]){var customRule=elements[cloneName];delete(customRule=extend$1({},customRule)).removeEmptyAttrs,delete customRule.removeEmpty,elements[name]=customRule}each$3(children,function(element,elmName){element[cloneName]&&(children[elmName]=element=extend$1({},children[elmName]),element[name]=element[cloneName])})}))}function addValidChildren(validChildren){var childRuleRegExp=/^([+\-]?)(\w+)\[([^\]]+)\]$/;mapCache[settings.schema]=null,validChildren&&each$3(split(validChildren,","),function(rule){var parent,prefix,matches=childRuleRegExp.exec(rule);matches&&(prefix=matches[1],parent=prefix?children[matches[2]]:children[matches[2]]={"#comment":{}},parent=children[matches[2]],each$3(split(matches[3],"|"),function(child){"-"===prefix?delete parent[child]:parent[child]={}}))})}function getElementRule(name){var i,element=elements[name];if(element)return element;for(i=patternElements.length;i--;)if((element=patternElements[i]).pattern.test(name))return element}settings.valid_elements?setValidElements(settings.valid_elements):(each$3(schemaItems,function(element,name){elements[name]={attributes:element.attributes,attributesOrder:element.attributesOrder},children[name]=element.children}),"html5"!==settings.schema&&each$3(split("strong/b em/i"),function(item){item=split(item,"/"),elements[item[1]].outputName=item[0]}),each$3(split("ol ul sub sup blockquote span font a table tbody tr strong em b i"),function(name){elements[name]&&(elements[name].removeEmpty=!0)}),each$3(split("p h1 h2 h3 h4 h5 h6 th td pre div address caption li"),function(name){elements[name].paddEmpty=!0}),each$3(split("span"),function(name){elements[name].removeEmptyAttrs=!0})),addCustomElements(settings.custom_elements),addValidChildren(settings.valid_children),addValidElements(settings.extended_valid_elements),addValidChildren("+ol[ul|ol],+ul[ul|ol]"),each$3({dd:"dl",dt:"dl",li:"ul ol",td:"tr",th:"tr",tr:"tbody thead tfoot",tbody:"table",thead:"table",tfoot:"table",legend:"fieldset",area:"map",param:"video audio object"},function(parents,item){elements[item]&&(elements[item].parentsRequired=split(parents))}),settings.invalid_elements&&each$3(explode$1(settings.invalid_elements),function(item){elements[item]&&delete elements[item]}),getElementRule("span")||addValidElements("span[!data-mce-type|*]");return{children:children,elements:elements,getValidStyles:function(){return validStyles},getValidClasses:function(){return validClasses},getBlockElements:function(){return blockElementsMap},getInvalidStyles:function(){return invalidStyles},getShortEndedElements:function(){return shortEndedElementsMap},getTextBlockElements:function(){return textBlockElementsMap},getTextInlineElements:function(){return textInlineElementsMap},getBoolAttrs:function(){return boolAttrMap},getElementRule:getElementRule,getSelfClosingElements:function(){return selfClosingElementsMap},getNonEmptyElements:function(){return nonEmptyElementsMap},getMoveCaretBeforeOnEnterElements:function(){return moveCaretBeforeOnEnterElementsMap},getWhiteSpaceElements:function(){return whiteSpaceElementsMap},getSpecialElements:function(){return specialElements},isValidChild:function(name,child){var parent=children[name.toLowerCase()];return!(!parent||!parent[child.toLowerCase()])},isValid:function(name,attr){var attrPatterns,i,rule=getElementRule(name);if(rule){if(!attr)return!0;if(rule.attributes[attr])return!0;if(attrPatterns=rule.attributePatterns)for(i=attrPatterns.length;i--;)if(attrPatterns[i].pattern.test(name))return!0}return!1},getCustomElements:function(){return customElementsMap},addValidElements:addValidElements,setValidElements:setValidElements,addCustomElements:addCustomElements,addValidChildren:addValidChildren}}function toHex(match,r,g,b){function hex(val){return 1<(val=parseInt(val,10).toString(16)).length?val:"0"+val}return"#"+hex(r)+hex(g)+hex(b)}function addEvent(target,name,callback,capture){target.addEventListener?target.addEventListener(name,callback,capture||!1):target.attachEvent&&target.attachEvent("on"+name,callback)}function removeEvent(target,name,callback,capture){target.removeEventListener?target.removeEventListener(name,callback,capture||!1):target.detachEvent&&target.detachEvent("on"+name,callback)}function fix(originalEvent,data){var name,event=data||{};for(name in originalEvent)deprecated[name]||(event[name]=originalEvent[name]);if(event.target||(event.target=event.srcElement||domGlobals.document),Env.experimentalShadowDom&&(event.target=function(event,defaultTarget){if(event.composedPath){var composedPath=event.composedPath();if(composedPath&&0<composedPath.length)return composedPath[0]}return defaultTarget}(originalEvent,event.target)),originalEvent&&mouseEventRe.test(originalEvent.type)&&void 0===originalEvent.pageX&&void 0!==originalEvent.clientX){var eventDoc=event.target.ownerDocument||domGlobals.document,doc=eventDoc.documentElement,body=eventDoc.body;event.pageX=originalEvent.clientX+(doc&&doc.scrollLeft||body&&body.scrollLeft||0)-(doc&&doc.clientLeft||body&&body.clientLeft||0),event.pageY=originalEvent.clientY+(doc&&doc.scrollTop||body&&body.scrollTop||0)-(doc&&doc.clientTop||body&&body.clientTop||0)}return event.preventDefault=function(){event.isDefaultPrevented=returnTrue,originalEvent&&(originalEvent.preventDefault?originalEvent.preventDefault():originalEvent.returnValue=!1)},event.stopPropagation=function(){event.isPropagationStopped=returnTrue,originalEvent&&(originalEvent.stopPropagation?originalEvent.stopPropagation():originalEvent.cancelBubble=!0)},!(event.stopImmediatePropagation=function(){event.isImmediatePropagationStopped=returnTrue,event.stopPropagation()})===function(event){return event.isDefaultPrevented===returnTrue||event.isDefaultPrevented===returnFalse}(event)&&(event.isDefaultPrevented=returnFalse,event.isPropagationStopped=returnFalse,event.isImmediatePropagationStopped=returnFalse),void 0===event.metaKey&&(event.metaKey=!1),event}function bindOnReady(win,callback,eventUtils){var doc=win.document,event={type:"ready"};if(eventUtils.domLoaded)callback(event);else{var readyHandler=function(){removeEvent(win,"DOMContentLoaded",readyHandler),removeEvent(win,"load",readyHandler),eventUtils.domLoaded||(eventUtils.domLoaded=!0,callback(event))};"complete"===doc.readyState||"interactive"===doc.readyState&&doc.body?readyHandler():addEvent(win,"DOMContentLoaded",readyHandler),addEvent(win,"load",readyHandler)}}function funescape(_,escaped,escapedWhitespace){var high="0x"+escaped-65536;return high!=high||escapedWhitespace?escaped:high<0?String.fromCharCode(65536+high):String.fromCharCode(high>>10|55296,1023&high|56320)}var i,support,Expr,getText,isXML,tokenize,compile,select,outermostContext,sortInput,hasDuplicate,setDocument,document,docElem,documentIsHTML,rbuggyQSA,rbuggyMatches,contains$3,Styles=function(settings,schema){var i,encodingItems,validStyles,invalidStyles,rgbRegExp=/rgb\s*\(\s*([0-9]+)\s*,\s*([0-9]+)\s*,\s*([0-9]+)\s*\)/gi,urlOrStrRegExp=/(?:url(?:(?:\(\s*\"([^\"]+)\"\s*\))|(?:\(\s*\'([^\']+)\'\s*\))|(?:\(\s*([^)\s]+)\s*\))))|(?:\'([^\']+)\')|(?:\"([^\"]+)\")/gi,styleRegExp=/\s*([^:]+):\s*([^;]+);?/g,trimRightRegExp=/\s+$/,encodingLookup={};for(settings=settings||{},schema&&(validStyles=schema.getValidStyles(),invalidStyles=schema.getInvalidStyles()),encodingItems="\\\" \\' \\; \\: ; : \ufeff".split(" "),i=0;i<encodingItems.length;i++)encodingLookup[encodingItems[i]]="\ufeff"+i,encodingLookup["\ufeff"+i]=encodingItems[i];return{toHex:function(color){return color.replace(rgbRegExp,toHex)},parse:function(css){function compress(prefix,suffix,noJoin){var top,right,bottom,left;if((top=styles[prefix+"-top"+suffix])&&(right=styles[prefix+"-right"+suffix])&&(bottom=styles[prefix+"-bottom"+suffix])&&(left=styles[prefix+"-left"+suffix])){var box=[top,right,bottom,left];for(i=box.length-1;i--&&box[i]===box[i+1];);-1<i&&noJoin||(styles[prefix+suffix]=-1===i?box[0]:box.join(" "),delete styles[prefix+"-top"+suffix],delete styles[prefix+"-right"+suffix],delete styles[prefix+"-bottom"+suffix],delete styles[prefix+"-left"+suffix])}}function canCompress(key){var i,value=styles[key];if(value){for(i=(value=value.split(" ")).length;i--;)if(value[i]!==value[0])return!1;return styles[key]=value[0],!0}}function encode(str){return isEncoded=!0,encodingLookup[str]}function decode(str,keepSlashes){return isEncoded&&(str=str.replace(/\uFEFF[0-9]/g,function(str){return encodingLookup[str]})),keepSlashes||(str=str.replace(/\\([\'\";:])/g,"$1")),str}function decodeSingleHexSequence(escSeq){return String.fromCharCode(parseInt(escSeq.slice(1),16))}function decodeHexSequences(value){return value.replace(/\\[0-9a-f]+/gi,decodeSingleHexSequence)}function processUrl(match,url,url2,url3,str,str2){if(str=str||str2)return"'"+(str=decode(str)).replace(/\'/g,"\\'")+"'";if(url=decode(url||url2||url3),!settings.allow_script_urls){var scriptUrl=url.replace(/[\s\r\n]+/g,"");if(/(java|vb)script:/i.test(scriptUrl))return"";if(!settings.allow_svg_data_urls&&/^data:image\/svg/i.test(scriptUrl))return""}return urlConverter&&(url=urlConverter.call(urlConverterScope,url,"style")),"url('"+url.replace(/\'/g,"\\'")+"')"}var matches,name,value,isEncoded,target,a,b,c,styles={},urlConverter=settings.url_converter,urlConverterScope=settings.url_converter_scope||this;if(css){for(css=(css=css.replace(/[\u0000-\u001F]/g,"")).replace(/\\[\"\';:\uFEFF]/g,encode).replace(/\"[^\"]+\"|\'[^\']+\'/g,function(str){return str.replace(/[;:]/g,encode)});matches=styleRegExp.exec(css);)if(styleRegExp.lastIndex=matches.index+matches[0].length,name=matches[1].replace(trimRightRegExp,"").toLowerCase(),value=matches[2].replace(trimRightRegExp,""),name&&value){if(name=decodeHexSequences(name),value=decodeHexSequences(value),-1!==name.indexOf("\ufeff")||-1!==name.indexOf('"'))continue;if(!settings.allow_script_urls&&("behavior"===name||/expression\s*\(|\/\*|\*\//.test(value)))continue;"font-weight"===name&&"700"===value?value="bold":"color"!==name&&"background-color"!==name||(value=value.toLowerCase()),value=(value=value.replace(rgbRegExp,toHex)).replace(urlOrStrRegExp,processUrl),styles[name]=isEncoded?decode(value,!0):value}compress("border","",!0),compress("border","-width"),compress("border","-color"),compress("border","-style"),compress("padding",""),compress("margin",""),target="border",b="border-style",c="border-color",canCompress(a="border-width")&&canCompress(b)&&canCompress(c)&&(styles[target]=styles[a]+" "+styles[b]+" "+styles[c],delete styles[a],delete styles[b],delete styles[c]),"medium none"===styles.border&&delete styles.border,"none"===styles["border-image"]&&delete styles["border-image"]}return styles},serialize:function(styles,elementName){function serializeStyles(name){var styleList,i,l,value;if(styleList=validStyles[name])for(i=0,l=styleList.length;i<l;i++)name=styleList[i],(value=styles[name])&&(css+=(0<css.length?" ":"")+name+": "+value+";")}function isValid(name,elementName){var styleMap;return(!(styleMap=invalidStyles["*"])||!styleMap[name])&&(!(styleMap=invalidStyles[elementName])||!styleMap[name])}var name,value,css="";if(elementName&&validStyles)serializeStyles("*"),serializeStyles(elementName);else for(name in styles)!(value=styles[name])||invalidStyles&&!isValid(name,elementName)||(css+=(0<css.length?" ":"")+name+": "+value+";");return css}}},mouseEventRe=/^(?:mouse|contextmenu)|click/,deprecated={keyLocation:1,layerX:1,layerY:1,returnValue:1,webkitMovementX:1,webkitMovementY:1,keyIdentifier:1,mozPressure:1},returnFalse=function(){return!1},returnTrue=function(){return!0},EventUtils=function(){function EventUtils(){this.domLoaded=!1,this.events={},this.count=1,this.expando="mce-data-"+(+new Date).toString(32),this.hasMouseEnterLeave="onmouseenter"in domGlobals.document.documentElement,this.hasFocusIn="onfocusin"in domGlobals.document.documentElement,this.count=1}return EventUtils.prototype.bind=function(target,names,callback,scope){function defaultNativeHandler(evt){self.executeHandlers(fix(evt||win.event),id)}var id,callbackList,i,name,fakeName,nativeHandler,capture,self=this,win=domGlobals.window;if(target&&3!==target.nodeType&&8!==target.nodeType){target[self.expando]?id=target[self.expando]:(id=self.count++,target[self.expando]=id,self.events[id]={}),scope=scope||target;var namesList=names.split(" ");for(i=namesList.length;i--;)nativeHandler=defaultNativeHandler,fakeName=capture=!1,"DOMContentLoaded"===(name=namesList[i])&&(name="ready"),self.domLoaded&&"ready"===name&&"complete"===target.readyState?callback.call(scope,fix({type:name})):(self.hasMouseEnterLeave||(fakeName=self.mouseEnterLeave[name])&&(nativeHandler=function(evt){var current,related;if(current=evt.currentTarget,(related=evt.relatedTarget)&&current.contains)related=current.contains(related);else for(;related&&related!==current;)related=related.parentNode;related||((evt=fix(evt||win.event)).type="mouseout"===evt.type?"mouseleave":"mouseenter",evt.target=current,self.executeHandlers(evt,id))}),self.hasFocusIn||"focusin"!==name&&"focusout"!==name||(capture=!0,fakeName="focusin"===name?"focus":"blur",nativeHandler=function(evt){(evt=fix(evt||win.event)).type="focus"===evt.type?"focusin":"focusout",self.executeHandlers(evt,id)}),(callbackList=self.events[id][name])?"ready"===name&&self.domLoaded?callback(fix({type:name})):callbackList.push({func:callback,scope:scope}):(self.events[id][name]=callbackList=[{func:callback,scope:scope}],callbackList.fakeName=fakeName,callbackList.capture=capture,callbackList.nativeHandler=nativeHandler,"ready"===name?bindOnReady(target,nativeHandler,self):addEvent(target,fakeName||name,nativeHandler,capture)));return target=callbackList=0,callback}},EventUtils.prototype.unbind=function(target,names,callback){var id,callbackList,i,ci,name,eventMap;if(!target||3===target.nodeType||8===target.nodeType)return this;if(id=target[this.expando]){if(eventMap=this.events[id],names){var namesList=names.split(" ");for(i=namesList.length;i--;)if(callbackList=eventMap[name=namesList[i]]){if(callback)for(ci=callbackList.length;ci--;)if(callbackList[ci].func===callback){var nativeHandler=callbackList.nativeHandler,fakeName=callbackList.fakeName,capture=callbackList.capture;(callbackList=callbackList.slice(0,ci).concat(callbackList.slice(ci+1))).nativeHandler=nativeHandler,callbackList.fakeName=fakeName,callbackList.capture=capture,eventMap[name]=callbackList}callback&&0!==callbackList.length||(delete eventMap[name],removeEvent(target,callbackList.fakeName||name,callbackList.nativeHandler,callbackList.capture))}}else{for(name in eventMap)callbackList=eventMap[name],removeEvent(target,callbackList.fakeName||name,callbackList.nativeHandler,callbackList.capture);eventMap={}}for(name in eventMap)return this;delete this.events[id];try{delete target[this.expando]}catch(ex){target[this.expando]=null}}return this},EventUtils.prototype.fire=function(target,name,args){var id;if(!target||3===target.nodeType||8===target.nodeType)return this;var event=fix(null,args);for(event.type=name,event.target=target;(id=target[this.expando])&&this.executeHandlers(event,id),(target=target.parentNode||target.ownerDocument||target.defaultView||target.parentWindow)&&!event.isPropagationStopped(););return this},EventUtils.prototype.clean=function(target){var i,children;if(!target||3===target.nodeType||8===target.nodeType)return this;if(target[this.expando]&&this.unbind(target),target.getElementsByTagName||(target=target.document),target&&target.getElementsByTagName)for(this.unbind(target),i=(children=target.getElementsByTagName("*")).length;i--;)(target=children[i])[this.expando]&&this.unbind(target);return this},EventUtils.prototype.destroy=function(){this.events={}},EventUtils.prototype.cancel=function(e){return e&&(e.preventDefault(),e.stopImmediatePropagation()),!1},EventUtils.prototype.executeHandlers=function(evt,id){var callbackList,i,l,callback,container=this.events[id];if(callbackList=container&&container[evt.type])for(i=0,l=callbackList.length;i<l;i++)if((callback=callbackList[i])&&!1===callback.func.call(callback.scope,evt)&&evt.preventDefault(),evt.isImmediatePropagationStopped())return},EventUtils.Event=new EventUtils,EventUtils}(),expando="sizzle"+-new Date,preferredDoc=domGlobals.window.document,dirruns=0,done=0,classCache=createCache(),tokenCache=createCache(),compilerCache=createCache(),sortOrder=function(a,b){return a===b&&(hasDuplicate=!0),0},hasOwn={}.hasOwnProperty,arr=[],pop=arr.pop,push_native=arr.push,push=arr.push,slice=arr.slice,indexOf$2=arr.indexOf||function(elem){for(var i=0,len=this.length;i<len;i++)if(this[i]===elem)return i;return-1},whitespace="[\\x20\\t\\r\\n\\f]",identifier="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",attributes="\\["+whitespace+"*("+identifier+")(?:"+whitespace+"*([*^$|!~]?=)"+whitespace+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+identifier+"))|)"+whitespace+"*\\]",pseudos=":("+identifier+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+attributes+")*)|.*)\\)|)",rtrim=new RegExp("^"+whitespace+"+|((?:^|[^\\\\])(?:\\\\.)*)"+whitespace+"+$","g"),rcomma=new RegExp("^"+whitespace+"*,"+whitespace+"*"),rcombinators=new RegExp("^"+whitespace+"*([>+~]|"+whitespace+")"+whitespace+"*"),rattributeQuotes=new RegExp("="+whitespace+"*([^\\]'\"]*?)"+whitespace+"*\\]","g"),rpseudo=new RegExp(pseudos),ridentifier=new RegExp("^"+identifier+"$"),matchExpr={ID:new RegExp("^#("+identifier+")"),CLASS:new RegExp("^\\.("+identifier+")"),TAG:new RegExp("^("+identifier+"|[*])"),ATTR:new RegExp("^"+attributes),PSEUDO:new RegExp("^"+pseudos),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+whitespace+"*(even|odd|(([+-]|)(\\d*)n|)"+whitespace+"*(?:([+-]|)"+whitespace+"*(\\d+)|))"+whitespace+"*\\)|)","i"),bool:new RegExp("^(?:checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped)$","i"),needsContext:new RegExp("^"+whitespace+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+whitespace+"*((?:-\\d)?\\d*)"+whitespace+"*\\)|)(?=[^-]|$)","i")},rinputs=/^(?:input|select|textarea|button)$/i,rheader=/^h\d$/i,rnative=/^[^{]+\{\s*\[native \w/,rquickExpr=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,rsibling=/[+~]/,rescape=/'|\\/g,runescape=new RegExp("\\\\([\\da-f]{1,6}"+whitespace+"?|("+whitespace+")|.)","ig");try{push.apply(arr=slice.call(preferredDoc.childNodes),preferredDoc.childNodes),arr[preferredDoc.childNodes.length].nodeType}catch(e){push={apply:arr.length?function(target,els){push_native.apply(target,slice.call(els))}:function(target,els){for(var j=target.length,i=0;target[j++]=els[i++];);target.length=j-1}}}var Sizzle=function(selector,context,results,seed){var match,elem,m,nodeType,i,groups,old,nid,newContext,newSelector;if((context?context.ownerDocument||context:preferredDoc)!==document&&setDocument(context),results=results||[],!selector||"string"!=typeof selector)return results;if(1!==(nodeType=(context=context||document).nodeType)&&9!==nodeType)return[];if(documentIsHTML&&!seed){if(match=rquickExpr.exec(selector))if(m=match[1]){if(9===nodeType){if(!(elem=context.getElementById(m))||!elem.parentNode)return results;if(elem.id===m)return results.push(elem),results}else if(context.ownerDocument&&(elem=context.ownerDocument.getElementById(m))&&contains$3(context,elem)&&elem.id===m)return results.push(elem),results}else{if(match[2])return push.apply(results,context.getElementsByTagName(selector)),results;if((m=match[3])&&support.getElementsByClassName)return push.apply(results,context.getElementsByClassName(m)),results}if(support.qsa&&(!rbuggyQSA||!rbuggyQSA.test(selector))){if(nid=old=expando,newContext=context,newSelector=9===nodeType&&selector,1===nodeType&&"object"!==context.nodeName.toLowerCase()){for(groups=tokenize(selector),(old=context.getAttribute("id"))?nid=old.replace(rescape,"\\$&"):context.setAttribute("id",nid),nid="[id='"+nid+"'] ",i=groups.length;i--;)groups[i]=nid+toSelector(groups[i]);newContext=rsibling.test(selector)&&testContext(context.parentNode)||context,newSelector=groups.join(",")}if(newSelector)try{return push.apply(results,newContext.querySelectorAll(newSelector)),results}catch(qsaError){}finally{old||context.removeAttribute("id")}}}return select(selector.replace(rtrim,"$1"),context,results,seed)};function createCache(){var keys=[];return function cache(key,value){return keys.push(key+" ")>Expr.cacheLength&&delete cache[keys.shift()],cache[key+" "]=value}}function markFunction(fn){return fn[expando]=!0,fn}function siblingCheck(a,b){var cur=b&&a,diff=cur&&1===a.nodeType&&1===b.nodeType&&(~b.sourceIndex||1<<31)-(~a.sourceIndex||1<<31);if(diff)return diff;if(cur)for(;cur=cur.nextSibling;)if(cur===b)return-1;return a?1:-1}function createInputPseudo(type){return function(elem){return"input"===elem.nodeName.toLowerCase()&&elem.type===type}}function createButtonPseudo(type){return function(elem){var name=elem.nodeName.toLowerCase();return("input"===name||"button"===name)&&elem.type===type}}function createPositionalPseudo(fn){return markFunction(function(argument){return argument=+argument,markFunction(function(seed,matches){for(var j,matchIndexes=fn([],seed.length,argument),i=matchIndexes.length;i--;)seed[j=matchIndexes[i]]&&(seed[j]=!(matches[j]=seed[j]))})})}function testContext(context){return context&&void 0!==context.getElementsByTagName&&context}for(i in support=Sizzle.support={},isXML=Sizzle.isXML=function(elem){var documentElement=elem&&(elem.ownerDocument||elem).documentElement;return!!documentElement&&"HTML"!==documentElement.nodeName},setDocument=Sizzle.setDocument=function(node){var hasCompare,doc=node?node.ownerDocument||node:preferredDoc,parent=doc.defaultView;return doc!==document&&9===doc.nodeType&&doc.documentElement?(docElem=(document=doc).documentElement,documentIsHTML=!isXML(doc),parent&&parent!==function(win){try{return win.top}catch(ex){}return null}(parent)&&(parent.addEventListener?parent.addEventListener("unload",function(){setDocument()},!1):parent.attachEvent&&parent.attachEvent("onunload",function(){setDocument()})),support.attributes=!0,support.getElementsByTagName=!0,support.getElementsByClassName=rnative.test(doc.getElementsByClassName),support.getById=!0,Expr.find.ID=function(id,context){if(void 0!==context.getElementById&&documentIsHTML){var m=context.getElementById(id);return m&&m.parentNode?[m]:[]}},Expr.filter.ID=function(id){var attrId=id.replace(runescape,funescape);return function(elem){return elem.getAttribute("id")===attrId}},Expr.find.TAG=support.getElementsByTagName?function(tag,context){if(void 0!==context.getElementsByTagName)return context.getElementsByTagName(tag)}:function(tag,context){var elem,tmp=[],i=0,results=context.getElementsByTagName(tag);if("*"!==tag)return results;for(;elem=results[i++];)1===elem.nodeType&&tmp.push(elem);return tmp},Expr.find.CLASS=support.getElementsByClassName&&function(className,context){if(documentIsHTML)return context.getElementsByClassName(className)},rbuggyMatches=[],rbuggyQSA=[],support.disconnectedMatch=!0,rbuggyQSA=rbuggyQSA.length&&new RegExp(rbuggyQSA.join("|")),rbuggyMatches=rbuggyMatches.length&&new RegExp(rbuggyMatches.join("|")),hasCompare=rnative.test(docElem.compareDocumentPosition),contains$3=hasCompare||rnative.test(docElem.contains)?function(a,b){var adown=9===a.nodeType?a.documentElement:a,bup=b&&b.parentNode;return a===bup||!(!bup||1!==bup.nodeType||!(adown.contains?adown.contains(bup):a.compareDocumentPosition&&16&a.compareDocumentPosition(bup)))}:function(a,b){if(b)for(;b=b.parentNode;)if(b===a)return!0;return!1},sortOrder=hasCompare?function(a,b){if(a===b)return hasDuplicate=!0,0;var compare=!a.compareDocumentPosition-!b.compareDocumentPosition;return compare||(1&(compare=(a.ownerDocument||a)===(b.ownerDocument||b)?a.compareDocumentPosition(b):1)||!support.sortDetached&&b.compareDocumentPosition(a)===compare?a===doc||a.ownerDocument===preferredDoc&&contains$3(preferredDoc,a)?-1:b===doc||b.ownerDocument===preferredDoc&&contains$3(preferredDoc,b)?1:sortInput?indexOf$2.call(sortInput,a)-indexOf$2.call(sortInput,b):0:4&compare?-1:1)}:function(a,b){if(a===b)return hasDuplicate=!0,0;var cur,i=0,aup=a.parentNode,bup=b.parentNode,ap=[a],bp=[b];if(!aup||!bup)return a===doc?-1:b===doc?1:aup?-1:bup?1:sortInput?indexOf$2.call(sortInput,a)-indexOf$2.call(sortInput,b):0;if(aup===bup)return siblingCheck(a,b);for(cur=a;cur=cur.parentNode;)ap.unshift(cur);for(cur=b;cur=cur.parentNode;)bp.unshift(cur);for(;ap[i]===bp[i];)i++;return i?siblingCheck(ap[i],bp[i]):ap[i]===preferredDoc?-1:bp[i]===preferredDoc?1:0},doc):document},Sizzle.matches=function(expr,elements){return Sizzle(expr,null,null,elements)},Sizzle.matchesSelector=function(elem,expr){if((elem.ownerDocument||elem)!==document&&setDocument(elem),expr=expr.replace(rattributeQuotes,"='$1']"),support.matchesSelector&&documentIsHTML&&(!rbuggyMatches||!rbuggyMatches.test(expr))&&(!rbuggyQSA||!rbuggyQSA.test(expr)))try{var ret=(void 0).call(elem,expr);if(ret||support.disconnectedMatch||elem.document&&11!==elem.document.nodeType)return ret}catch(e){}return 0<Sizzle(expr,document,null,[elem]).length},Sizzle.contains=function(context,elem){return(context.ownerDocument||context)!==document&&setDocument(context),contains$3(context,elem)},Sizzle.attr=function(elem,name){(elem.ownerDocument||elem)!==document&&setDocument(elem);var fn=Expr.attrHandle[name.toLowerCase()],val=fn&&hasOwn.call(Expr.attrHandle,name.toLowerCase())?fn(elem,name,!documentIsHTML):void 0;return void 0!==val?val:support.attributes||!documentIsHTML?elem.getAttribute(name):(val=elem.getAttributeNode(name))&&val.specified?val.value:null},Sizzle.error=function(msg){throw new Error("Syntax error, unrecognized expression: "+msg)},Sizzle.uniqueSort=function(results){var elem,duplicates=[],j=0,i=0;if(hasDuplicate=!support.detectDuplicates,sortInput=!support.sortStable&&results.slice(0),results.sort(sortOrder),hasDuplicate){for(;elem=results[i++];)elem===results[i]&&(j=duplicates.push(i));for(;j--;)results.splice(duplicates[j],1)}return sortInput=null,results},getText=Sizzle.getText=function(elem){var node,ret="",i=0,nodeType=elem.nodeType;if(nodeType){if(1===nodeType||9===nodeType||11===nodeType){if("string"==typeof elem.textContent)return elem.textContent;for(elem=elem.firstChild;elem;elem=elem.nextSibling)ret+=getText(elem)}else if(3===nodeType||4===nodeType)return elem.nodeValue}else for(;node=elem[i++];)ret+=getText(node);return ret},(Expr=Sizzle.selectors={cacheLength:50,createPseudo:markFunction,match:matchExpr,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(match){return match[1]=match[1].replace(runescape,funescape),match[3]=(match[3]||match[4]||match[5]||"").replace(runescape,funescape),"~="===match[2]&&(match[3]=" "+match[3]+" "),match.slice(0,4)},CHILD:function(match){return match[1]=match[1].toLowerCase(),"nth"===match[1].slice(0,3)?(match[3]||Sizzle.error(match[0]),match[4]=+(match[4]?match[5]+(match[6]||1):2*("even"===match[3]||"odd"===match[3])),match[5]=+(match[7]+match[8]||"odd"===match[3])):match[3]&&Sizzle.error(match[0]),match},PSEUDO:function(match){var excess,unquoted=!match[6]&&match[2];return matchExpr.CHILD.test(match[0])?null:(match[3]?match[2]=match[4]||match[5]||"":unquoted&&rpseudo.test(unquoted)&&(excess=tokenize(unquoted,!0))&&(excess=unquoted.indexOf(")",unquoted.length-excess)-unquoted.length)&&(match[0]=match[0].slice(0,excess),match[2]=unquoted.slice(0,excess)),match.slice(0,3))}},filter:{TAG:function(nodeNameSelector){var nodeName=nodeNameSelector.replace(runescape,funescape).toLowerCase();return"*"===nodeNameSelector?function(){return!0}:function(elem){return elem.nodeName&&elem.nodeName.toLowerCase()===nodeName}},CLASS:function(className){var pattern=classCache[className+" "];return pattern||(pattern=new RegExp("(^|"+whitespace+")"+className+"("+whitespace+"|$)"))&&classCache(className,function(elem){return pattern.test("string"==typeof elem.className&&elem.className||void 0!==elem.getAttribute&&elem.getAttribute("class")||"")})},ATTR:function(name,operator,check){return function(elem){var result=Sizzle.attr(elem,name);return null==result?"!="===operator:!operator||(result+="","="===operator?result===check:"!="===operator?result!==check:"^="===operator?check&&0===result.indexOf(check):"*="===operator?check&&-1<result.indexOf(check):"$="===operator?check&&result.slice(-check.length)===check:"~="===operator?-1<(" "+result+" ").indexOf(check):"|="===operator&&(result===check||result.slice(0,check.length+1)===check+"-"))}},CHILD:function(type,what,argument,first,last){var simple="nth"!==type.slice(0,3),forward="last"!==type.slice(-4),ofType="of-type"===what;return 1===first&&0===last?function(elem){return!!elem.parentNode}:function(elem,context,xml){var cache,outerCache,node,diff,nodeIndex,start,dir=simple!=forward?"nextSibling":"previousSibling",parent=elem.parentNode,name=ofType&&elem.nodeName.toLowerCase(),useCache=!xml&&!ofType;if(parent){if(simple){for(;dir;){for(node=elem;node=node[dir];)if(ofType?node.nodeName.toLowerCase()===name:1===node.nodeType)return!1;start=dir="only"===type&&!start&&"nextSibling"}return!0}if(start=[forward?parent.firstChild:parent.lastChild],forward&&useCache){for(nodeIndex=(cache=(outerCache=parent[expando]||(parent[expando]={}))[type]||[])[0]===dirruns&&cache[1],diff=cache[0]===dirruns&&cache[2],node=nodeIndex&&parent.childNodes[nodeIndex];node=++nodeIndex&&node&&node[dir]||(diff=nodeIndex=0)||start.pop();)if(1===node.nodeType&&++diff&&node===elem){outerCache[type]=[dirruns,nodeIndex,diff];break}}else if(useCache&&(cache=(elem[expando]||(elem[expando]={}))[type])&&cache[0]===dirruns)diff=cache[1];else for(;(node=++nodeIndex&&node&&node[dir]||(diff=nodeIndex=0)||start.pop())&&((ofType?node.nodeName.toLowerCase()!==name:1!==node.nodeType)||!++diff||(useCache&&((node[expando]||(node[expando]={}))[type]=[dirruns,diff]),node!==elem)););return(diff-=last)===first||diff%first==0&&0<=diff/first}}},PSEUDO:function(pseudo,argument){var args,fn=Expr.pseudos[pseudo]||Expr.setFilters[pseudo.toLowerCase()]||Sizzle.error("unsupported pseudo: "+pseudo);return fn[expando]?fn(argument):1<fn.length?(args=[pseudo,pseudo,"",argument],Expr.setFilters.hasOwnProperty(pseudo.toLowerCase())?markFunction(function(seed,matches){for(var idx,matched=fn(seed,argument),i=matched.length;i--;)seed[idx=indexOf$2.call(seed,matched[i])]=!(matches[idx]=matched[i])}):function(elem){return fn(elem,0,args)}):fn}},pseudos:{not:markFunction(function(selector){var input=[],results=[],matcher=compile(selector.replace(rtrim,"$1"));return matcher[expando]?markFunction(function(seed,matches,context,xml){for(var elem,unmatched=matcher(seed,null,xml,[]),i=seed.length;i--;)(elem=unmatched[i])&&(seed[i]=!(matches[i]=elem))}):function(elem,context,xml){return input[0]=elem,matcher(input,null,xml,results),!results.pop()}}),has:markFunction(function(selector){return function(elem){return 0<Sizzle(selector,elem).length}}),contains:markFunction(function(text){return text=text.replace(runescape,funescape),function(elem){return-1<(elem.textContent||elem.innerText||getText(elem)).indexOf(text)}}),lang:markFunction(function(lang){return ridentifier.test(lang||"")||Sizzle.error("unsupported lang: "+lang),lang=lang.replace(runescape,funescape).toLowerCase(),function(elem){var elemLang;do{if(elemLang=documentIsHTML?elem.lang:elem.getAttribute("xml:lang")||elem.getAttribute("lang"))return(elemLang=elemLang.toLowerCase())===lang||0===elemLang.indexOf(lang+"-")}while((elem=elem.parentNode)&&1===elem.nodeType);return!1}}),target:function(elem){var hash=domGlobals.window.location&&domGlobals.window.location.hash;return hash&&hash.slice(1)===elem.id},root:function(elem){return elem===docElem},focus:function(elem){return elem===document.activeElement&&(!document.hasFocus||document.hasFocus())&&!!(elem.type||elem.href||~elem.tabIndex)},enabled:function(elem){return!1===elem.disabled},disabled:function(elem){return!0===elem.disabled},checked:function(elem){var nodeName=elem.nodeName.toLowerCase();return"input"===nodeName&&!!elem.checked||"option"===nodeName&&!!elem.selected},selected:function(elem){return elem.parentNode&&elem.parentNode.selectedIndex,!0===elem.selected},empty:function(elem){for(elem=elem.firstChild;elem;elem=elem.nextSibling)if(elem.nodeType<6)return!1;return!0},parent:function(elem){return!Expr.pseudos.empty(elem)},header:function(elem){return rheader.test(elem.nodeName)},input:function(elem){return rinputs.test(elem.nodeName)},button:function(elem){var name=elem.nodeName.toLowerCase();return"input"===name&&"button"===elem.type||"button"===name},text:function(elem){var attr;return"input"===elem.nodeName.toLowerCase()&&"text"===elem.type&&(null==(attr=elem.getAttribute("type"))||"text"===attr.toLowerCase())},first:createPositionalPseudo(function(){return[0]}),last:createPositionalPseudo(function(matchIndexes,length){return[length-1]}),eq:createPositionalPseudo(function(matchIndexes,length,argument){return[argument<0?argument+length:argument]}),even:createPositionalPseudo(function(matchIndexes,length){for(var i=0;i<length;i+=2)matchIndexes.push(i);return matchIndexes}),odd:createPositionalPseudo(function(matchIndexes,length){for(var i=1;i<length;i+=2)matchIndexes.push(i);return matchIndexes}),lt:createPositionalPseudo(function(matchIndexes,length,argument){for(var i=argument<0?argument+length:argument;0<=--i;)matchIndexes.push(i);return matchIndexes}),gt:createPositionalPseudo(function(matchIndexes,length,argument){for(var i=argument<0?argument+length:argument;++i<length;)matchIndexes.push(i);return matchIndexes})}}).pseudos.nth=Expr.pseudos.eq,{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})Expr.pseudos[i]=createInputPseudo(i);for(i in{submit:!0,reset:!0})Expr.pseudos[i]=createButtonPseudo(i);function setFilters(){}function toSelector(tokens){for(var i=0,len=tokens.length,selector="";i<len;i++)selector+=tokens[i].value;return selector}function addCombinator(matcher,combinator,base){var dir=combinator.dir,checkNonElements=base&&"parentNode"===dir,doneName=done++;return combinator.first?function(elem,context,xml){for(;elem=elem[dir];)if(1===elem.nodeType||checkNonElements)return matcher(elem,context,xml)}:function(elem,context,xml){var oldCache,outerCache,newCache=[dirruns,doneName];if(xml){for(;elem=elem[dir];)if((1===elem.nodeType||checkNonElements)&&matcher(elem,context,xml))return!0}else for(;elem=elem[dir];)if(1===elem.nodeType||checkNonElements){if((oldCache=(outerCache=elem[expando]||(elem[expando]={}))[dir])&&oldCache[0]===dirruns&&oldCache[1]===doneName)return newCache[2]=oldCache[2];if((outerCache[dir]=newCache)[2]=matcher(elem,context,xml))return!0}}}function elementMatcher(matchers){return 1<matchers.length?function(elem,context,xml){for(var i=matchers.length;i--;)if(!matchers[i](elem,context,xml))return!1;return!0}:matchers[0]}function condense(unmatched,map,filter,context,xml){for(var elem,newUnmatched=[],i=0,len=unmatched.length,mapped=null!=map;i<len;i++)(elem=unmatched[i])&&(filter&&!filter(elem,context,xml)||(newUnmatched.push(elem),mapped&&map.push(i)));return newUnmatched}function setMatcher(preFilter,selector,matcher,postFilter,postFinder,postSelector){return postFilter&&!postFilter[expando]&&(postFilter=setMatcher(postFilter)),postFinder&&!postFinder[expando]&&(postFinder=setMatcher(postFinder,postSelector)),markFunction(function(seed,results,context,xml){var temp,i,elem,preMap=[],postMap=[],preexisting=results.length,elems=seed||function(selector,contexts,results){for(var i=0,len=contexts.length;i<len;i++)Sizzle(selector,contexts[i],results);return results}(selector||"*",context.nodeType?[context]:context,[]),matcherIn=!preFilter||!seed&&selector?elems:condense(elems,preMap,preFilter,context,xml),matcherOut=matcher?postFinder||(seed?preFilter:preexisting||postFilter)?[]:results:matcherIn;if(matcher&&matcher(matcherIn,matcherOut,context,xml),postFilter)for(temp=condense(matcherOut,postMap),postFilter(temp,[],context,xml),i=temp.length;i--;)(elem=temp[i])&&(matcherOut[postMap[i]]=!(matcherIn[postMap[i]]=elem));if(seed){if(postFinder||preFilter){if(postFinder){for(temp=[],i=matcherOut.length;i--;)(elem=matcherOut[i])&&temp.push(matcherIn[i]=elem);postFinder(null,matcherOut=[],temp,xml)}for(i=matcherOut.length;i--;)(elem=matcherOut[i])&&-1<(temp=postFinder?indexOf$2.call(seed,elem):preMap[i])&&(seed[temp]=!(results[temp]=elem))}}else matcherOut=condense(matcherOut===results?matcherOut.splice(preexisting,matcherOut.length):matcherOut),postFinder?postFinder(null,results,matcherOut,xml):push.apply(results,matcherOut)})}function matcherFromTokens(tokens){for(var checkContext,matcher,j,len=tokens.length,leadingRelative=Expr.relative[tokens[0].type],implicitRelative=leadingRelative||Expr.relative[" "],i=leadingRelative?1:0,matchContext=addCombinator(function(elem){return elem===checkContext},implicitRelative,!0),matchAnyContext=addCombinator(function(elem){return-1<indexOf$2.call(checkContext,elem)},implicitRelative,!0),matchers=[function(elem,context,xml){return!leadingRelative&&(xml||context!==outermostContext)||((checkContext=context).nodeType?matchContext(elem,context,xml):matchAnyContext(elem,context,xml))}];i<len;i++)if(matcher=Expr.relative[tokens[i].type])matchers=[addCombinator(elementMatcher(matchers),matcher)];else{if((matcher=Expr.filter[tokens[i].type].apply(null,tokens[i].matches))[expando]){for(j=++i;j<len&&!Expr.relative[tokens[j].type];j++);return setMatcher(1<i&&elementMatcher(matchers),1<i&&toSelector(tokens.slice(0,i-1).concat({value:" "===tokens[i-2].type?"*":""})).replace(rtrim,"$1"),matcher,i<j&&matcherFromTokens(tokens.slice(i,j)),j<len&&matcherFromTokens(tokens=tokens.slice(j)),j<len&&toSelector(tokens))}matchers.push(matcher)}return elementMatcher(matchers)}function matcherFromGroupMatchers(elementMatchers,setMatchers){function superMatcher(seed,context,xml,results,outermost){var elem,j,matcher,matchedCount=0,i="0",unmatched=seed&&[],setMatched=[],contextBackup=outermostContext,elems=seed||byElement&&Expr.find.TAG("*",outermost),dirrunsUnique=dirruns+=null==contextBackup?1:Math.random()||.1,len=elems.length;for(outermost&&(outermostContext=context!==document&&context);i!==len&&null!=(elem=elems[i]);i++){if(byElement&&elem){for(j=0;matcher=elementMatchers[j++];)if(matcher(elem,context,xml)){results.push(elem);break}outermost&&(dirruns=dirrunsUnique)}bySet&&((elem=!matcher&&elem)&&matchedCount--,seed&&unmatched.push(elem))}if(matchedCount+=i,bySet&&i!==matchedCount){for(j=0;matcher=setMatchers[j++];)matcher(unmatched,setMatched,context,xml);if(seed){if(0<matchedCount)for(;i--;)unmatched[i]||setMatched[i]||(setMatched[i]=pop.call(results));setMatched=condense(setMatched)}push.apply(results,setMatched),outermost&&!seed&&0<setMatched.length&&1<matchedCount+setMatchers.length&&Sizzle.uniqueSort(results)}return outermost&&(dirruns=dirrunsUnique,outermostContext=contextBackup),unmatched}var bySet=0<setMatchers.length,byElement=0<elementMatchers.length;return bySet?markFunction(superMatcher):superMatcher}setFilters.prototype=Expr.filters=Expr.pseudos,Expr.setFilters=new setFilters,tokenize=Sizzle.tokenize=function(selector,parseOnly){var matched,match,tokens,type,soFar,groups,preFilters,cached=tokenCache[selector+" "];if(cached)return parseOnly?0:cached.slice(0);for(soFar=selector,groups=[],preFilters=Expr.preFilter;soFar;){for(type in matched&&!(match=rcomma.exec(soFar))||(match&&(soFar=soFar.slice(match[0].length)||soFar),groups.push(tokens=[])),matched=!1,(match=rcombinators.exec(soFar))&&(matched=match.shift(),tokens.push({value:matched,type:match[0].replace(rtrim," ")}),soFar=soFar.slice(matched.length)),Expr.filter)Expr.filter.hasOwnProperty(type)&&(!(match=matchExpr[type].exec(soFar))||preFilters[type]&&!(match=preFilters[type](match))||(matched=match.shift(),tokens.push({value:matched,type:type,matches:match}),soFar=soFar.slice(matched.length)));if(!matched)break}return parseOnly?soFar.length:soFar?Sizzle.error(selector):tokenCache(selector,groups).slice(0)},compile=Sizzle.compile=function(selector,match){var i,setMatchers=[],elementMatchers=[],cached=compilerCache[selector+" "];if(!cached){for(i=(match=match||tokenize(selector)).length;i--;)(cached=matcherFromTokens(match[i]))[expando]?setMatchers.push(cached):elementMatchers.push(cached);(cached=compilerCache(selector,matcherFromGroupMatchers(elementMatchers,setMatchers))).selector=selector}return cached},select=Sizzle.select=function(selector,context,results,seed){var i,tokens,token,type,find,compiled="function"==typeof selector&&selector,match=!seed&&tokenize(selector=compiled.selector||selector);if(results=results||[],1===match.length){if(2<(tokens=match[0]=match[0].slice(0)).length&&"ID"===(token=tokens[0]).type&&support.getById&&9===context.nodeType&&documentIsHTML&&Expr.relative[tokens[1].type]){if(!(context=(Expr.find.ID(token.matches[0].replace(runescape,funescape),context)||[])[0]))return results;compiled&&(context=context.parentNode),selector=selector.slice(tokens.shift().value.length)}for(i=matchExpr.needsContext.test(selector)?0:tokens.length;i--&&(token=tokens[i],!Expr.relative[type=token.type]);)if((find=Expr.find[type])&&(seed=find(token.matches[0].replace(runescape,funescape),rsibling.test(tokens[0].type)&&testContext(context.parentNode)||context))){if(tokens.splice(i,1),!(selector=seed.length&&toSelector(tokens)))return push.apply(results,seed),results;break}}return(compiled||compile(selector,match))(seed,context,!documentIsHTML,results,rsibling.test(selector)&&testContext(context.parentNode)||context),results},support.sortStable=expando.split("").sort(sortOrder).join("")===expando,support.detectDuplicates=!!hasDuplicate,setDocument(),support.sortDetached=!0;function isDefined(obj){return void 0!==obj}function isString$1(obj){return"string"==typeof obj}function createFragment(html,fragDoc){var frag,node,container;for(container=(fragDoc=fragDoc||doc).createElement("div"),frag=fragDoc.createDocumentFragment(),container.innerHTML=html;node=container.firstChild;)frag.appendChild(node);return frag}function hasClass(node,className){return node&&className&&-1!==(" "+node.className+" ").indexOf(" "+className+" ")}function wrap$1(elements,wrapper,all){var lastParent,newWrapper;return wrapper=DomQuery(wrapper)[0],elements.each(function(){all&&lastParent===this.parentNode||(lastParent=this.parentNode,newWrapper=wrapper.cloneNode(!1),this.parentNode.insertBefore(newWrapper,this)),newWrapper.appendChild(this)}),elements}function DomQueryConstructor(selector,context){return new DomQuery.fn.init(selector,context)}function trim$2(str){return null==str?"":(""+str).replace(whiteSpaceRegExp$1,"")}function each$4(obj,callback){var length,key,i,value;if(obj)if(void 0===(length=obj.length)){for(key in obj)if(obj.hasOwnProperty(key)&&(value=obj[key],!1===callback.call(value,key,value)))break}else for(i=0;i<length&&(value=obj[i],!1!==callback.call(value,i,value));i++);return obj}function grep(array,callback){var out=[];return each$4(array,function(i,item){callback(item,i)&&out.push(item)}),out}var doc=domGlobals.document,push$1=Array.prototype.push,slice$1=Array.prototype.slice,rquickExpr$1=/^(?:[^#<]*(<[\w\W]+>)[^>]*$|#([\w\-]*)$)/,Event=EventUtils.Event,skipUniques=Tools.makeMap("children,contents,next,prev"),domManipulate=function(targetNodes,sourceItem,callback,reverse){var i;if(isString$1(sourceItem))sourceItem=createFragment(sourceItem,getElementDocument(targetNodes[0]));else if(sourceItem.length&&!sourceItem.nodeType){if(sourceItem=DomQuery.makeArray(sourceItem),reverse)for(i=sourceItem.length-1;0<=i;i--)domManipulate(targetNodes,sourceItem[i],callback,reverse);else for(i=0;i<sourceItem.length;i++)domManipulate(targetNodes,sourceItem[i],callback,reverse);return targetNodes}if(sourceItem.nodeType)for(i=targetNodes.length;i--;)callback.call(targetNodes[i],sourceItem);return targetNodes},numericCssMap=Tools.makeMap("fillOpacity fontWeight lineHeight opacity orphans widows zIndex zoom"," "),booleanMap=Tools.makeMap("checked compact declare defer disabled ismap multiple nohref noshade nowrap readonly selected"," "),propFix={for:"htmlFor",class:"className",readonly:"readOnly"},cssFix={float:"cssFloat"},attrHooks={},cssHooks={},whiteSpaceRegExp$1=/^\s*|\s*$/g,getElementDocument=function(element){return element?9===element.nodeType?element:element.ownerDocument:doc};DomQueryConstructor.fn=DomQueryConstructor.prototype={constructor:DomQueryConstructor,selector:"",context:null,length:0,init:function(selector,context){var match,node;if(!selector)return this;if(selector.nodeType)return this.context=this[0]=selector,this.length=1,this;if(context&&context.nodeType)this.context=context;else{if(context)return DomQuery(selector).attr(context);this.context=context=domGlobals.document}if(isString$1(selector)){if(!(match="<"===(this.selector=selector).charAt(0)&&">"===selector.charAt(selector.length-1)&&3<=selector.length?[null,selector,null]:rquickExpr$1.exec(selector)))return DomQuery(context).find(selector);if(match[1])for(node=createFragment(selector,getElementDocument(context)).firstChild;node;)push$1.call(this,node),node=node.nextSibling;else{if(!(node=getElementDocument(context).getElementById(match[2])))return this;if(node.id!==match[2])return this.find(selector);this.length=1,this[0]=node}}else this.add(selector,!1);return this},toArray:function(){return Tools.toArray(this)},add:function(items,sort){var nodes,i;if(isString$1(items))return this.add(DomQuery(items));if(!1!==sort)for(nodes=DomQuery.unique(this.toArray().concat(DomQuery.makeArray(items))),this.length=nodes.length,i=0;i<nodes.length;i++)this[i]=nodes[i];else push$1.apply(this,DomQuery.makeArray(items));return this},attr:function(name,value){var hook,self=this;if("object"==typeof name)each$4(name,function(name,value){self.attr(name,value)});else{if(!isDefined(value)){if(self[0]&&1===self[0].nodeType){if((hook=attrHooks[name])&&hook.get)return hook.get(self[0],name);if(booleanMap[name])return self.prop(name)?name:void 0;null===(value=self[0].getAttribute(name,2))&&(value=void 0)}return value}this.each(function(){var hook;if(1===this.nodeType){if((hook=attrHooks[name])&&hook.set)return void hook.set(this,value);null===value?this.removeAttribute(name,2):this.setAttribute(name,value,2)}})}return self},removeAttr:function(name){return this.attr(name,null)},prop:function(name,value){var self=this;if("object"==typeof(name=propFix[name]||name))each$4(name,function(name,value){self.prop(name,value)});else{if(!isDefined(value))return self[0]&&self[0].nodeType&&name in self[0]?self[0][name]:value;this.each(function(){1===this.nodeType&&(this[name]=value)})}return self},css:function(name,value){function camel(name){return name.replace(/-(\D)/g,function(a,b){return b.toUpperCase()})}function dashed(name){return name.replace(/[A-Z]/g,function(a){return"-"+a})}var elm,hook,self=this;if("object"==typeof name)each$4(name,function(name,value){self.css(name,value)});else if(isDefined(value))name=camel(name),"number"!=typeof value||numericCssMap[name]||(value=value.toString()+"px"),self.each(function(){var style=this.style;if((hook=cssHooks[name])&&hook.set)hook.set(this,value);else{try{this.style[cssFix[name]||name]=value}catch(ex){}null!==value&&""!==value||(style.removeProperty?style.removeProperty(dashed(name)):style.removeAttribute(name))}});else{if(elm=self[0],(hook=cssHooks[name])&&hook.get)return hook.get(elm);if(!elm.ownerDocument.defaultView)return elm.currentStyle?elm.currentStyle[camel(name)]:"";try{return elm.ownerDocument.defaultView.getComputedStyle(elm,null).getPropertyValue(dashed(name))}catch(ex){return}}return self},remove:function(){for(var node,i=this.length;i--;)node=this[i],Event.clean(node),node.parentNode&&node.parentNode.removeChild(node);return this},empty:function(){for(var node,i=this.length;i--;)for(node=this[i];node.firstChild;)node.removeChild(node.firstChild);return this},html:function(value){var i,self=this;if(isDefined(value)){i=self.length;try{for(;i--;)self[i].innerHTML=value}catch(ex){DomQuery(self[i]).empty().append(value)}return self}return self[0]?self[0].innerHTML:""},text:function(value){var i;if(isDefined(value)){for(i=this.length;i--;)"innerText"in this[i]?this[i].innerText=value:this[0].textContent=value;return this}return this[0]?this[0].innerText||this[0].textContent:""},append:function(){return domManipulate(this,arguments,function(node){(1===this.nodeType||this.host&&1===this.host.nodeType)&&this.appendChild(node)})},prepend:function(){return domManipulate(this,arguments,function(node){(1===this.nodeType||this.host&&1===this.host.nodeType)&&this.insertBefore(node,this.firstChild)},!0)},before:function(){return this[0]&&this[0].parentNode?domManipulate(this,arguments,function(node){this.parentNode.insertBefore(node,this)}):this},after:function(){return this[0]&&this[0].parentNode?domManipulate(this,arguments,function(node){this.parentNode.insertBefore(node,this.nextSibling)},!0):this},appendTo:function(val){return DomQuery(val).append(this),this},prependTo:function(val){return DomQuery(val).prepend(this),this},replaceWith:function(content){return this.before(content).remove()},wrap:function(content){return wrap$1(this,content)},wrapAll:function(content){return wrap$1(this,content,!0)},wrapInner:function(content){return this.each(function(){DomQuery(this).contents().wrapAll(content)}),this},unwrap:function(){return this.parent().each(function(){DomQuery(this).replaceWith(this.childNodes)})},clone:function(){var result=[];return this.each(function(){result.push(this.cloneNode(!0))}),DomQuery(result)},addClass:function(className){return this.toggleClass(className,!0)},removeClass:function(className){return this.toggleClass(className,!1)},toggleClass:function(className,state){var self=this;return"string"!=typeof className||(-1!==className.indexOf(" ")?each$4(className.split(" "),function(){self.toggleClass(this,state)}):self.each(function(index,node){var existingClassName,classState;(classState=hasClass(node,className))!==state&&(existingClassName=node.className,classState?node.className=trim$2((" "+existingClassName+" ").replace(" "+className+" "," ")):node.className+=existingClassName?" "+className:className)})),self},hasClass:function(className){return hasClass(this[0],className)},each:function(callback){return each$4(this,callback)},on:function(name,callback){return this.each(function(){Event.bind(this,name,callback)})},off:function(name,callback){return this.each(function(){Event.unbind(this,name,callback)})},trigger:function(name){return this.each(function(){"object"==typeof name?Event.fire(this,name.type,name):Event.fire(this,name)})},show:function(){return this.css("display","")},hide:function(){return this.css("display","none")},slice:function(){return new DomQuery(slice$1.apply(this,arguments))},eq:function(index){return-1===index?this.slice(index):this.slice(index,+index+1)},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},find:function(selector){var i,l,ret=[];for(i=0,l=this.length;i<l;i++)DomQuery.find(selector,this[i],ret);return DomQuery(ret)},filter:function(selector){return DomQuery("function"==typeof selector?grep(this.toArray(),function(item,i){return selector(i,item)}):DomQuery.filter(selector,this.toArray()))},closest:function(selector){var result=[];return selector instanceof DomQuery&&(selector=selector[0]),this.each(function(i,node){for(;node;){if("string"==typeof selector&&DomQuery(node).is(selector)){result.push(node);break}if(node===selector){result.push(node);break}node=node.parentNode}}),DomQuery(result)},offset:function(offset){var elm,doc,docElm,pos,x=0,y=0;return offset?this.css(offset):((elm=this[0])&&(docElm=(doc=elm.ownerDocument).documentElement,elm.getBoundingClientRect&&(x=(pos=elm.getBoundingClientRect()).left+(docElm.scrollLeft||doc.body.scrollLeft)-docElm.clientLeft,y=pos.top+(docElm.scrollTop||doc.body.scrollTop)-docElm.clientTop)),{left:x,top:y})},push:push$1,sort:Array.prototype.sort,splice:Array.prototype.splice},Tools.extend(DomQueryConstructor,{extend:Tools.extend,makeArray:function(object){return function(obj){return obj&&obj===obj.window}(object)||object.nodeType?[object]:Tools.toArray(object)},inArray:function(item,array){var i;if(array.indexOf)return array.indexOf(item);for(i=array.length;i--;)if(array[i]===item)return i;return-1},isArray:Tools.isArray,each:each$4,trim:trim$2,grep:grep,find:Sizzle,expr:Sizzle.selectors,unique:Sizzle.uniqueSort,text:Sizzle.getText,contains:Sizzle.contains,filter:function(expr,elems,not){var i=elems.length;for(not&&(expr=":not("+expr+")");i--;)1!==elems[i].nodeType&&elems.splice(i,1);return elems=1===elems.length?DomQuery.find.matchesSelector(elems[0],expr)?[elems[0]]:[]:DomQuery.find.matches(expr,elems)}});function dir(el,prop,until){var matched=[],cur=el[prop];for("string"!=typeof until&&until instanceof DomQuery&&(until=until[0]);cur&&9!==cur.nodeType;){if(void 0!==until){if(cur===until)break;if("string"==typeof until&&DomQuery(cur).is(until))break}1===cur.nodeType&&matched.push(cur),cur=cur[prop]}return matched}function sibling(node,siblingName,nodeType,until){var result=[];for(until instanceof DomQuery&&(until=until[0]);node;node=node[siblingName])if(!nodeType||node.nodeType===nodeType){if(void 0!==until){if(node===until)break;if("string"==typeof until&&DomQuery(node).is(until))break}result.push(node)}return result}function firstSibling(node,siblingName,nodeType){for(node=node[siblingName];node;node=node[siblingName])if(node.nodeType===nodeType)return node;return null}each$4({parent:function(node){var parent=node.parentNode;return parent&&11!==parent.nodeType?parent:null},parents:function(node){return dir(node,"parentNode")},next:function(node){return firstSibling(node,"nextSibling",1)},prev:function(node){return firstSibling(node,"previousSibling",1)},children:function(node){return sibling(node.firstChild,"nextSibling",1)},contents:function(node){return Tools.toArray(("iframe"===node.nodeName?node.contentDocument||node.contentWindow.document:node).childNodes)}},function(name,fn){DomQueryConstructor.fn[name]=function(selector){var result=[];this.each(function(){var nodes=fn.call(result,this,selector,result);nodes&&(DomQuery.isArray(nodes)?result.push.apply(result,nodes):result.push(nodes))}),1<this.length&&(skipUniques[name]||(result=DomQuery.unique(result)),0===name.indexOf("parents")&&(result=result.reverse()));var wrappedResult=DomQuery(result);return selector?wrappedResult.filter(selector):wrappedResult}}),each$4({parentsUntil:function(node,until){return dir(node,"parentNode",until)},nextUntil:function(node,until){return sibling(node,"nextSibling",1,until).slice(1)},prevUntil:function(node,until){return sibling(node,"previousSibling",1,until).slice(1)}},function(name,fn){DomQueryConstructor.fn[name]=function(selector,filter){var result=[];this.each(function(){var nodes=fn.call(result,this,selector,result);nodes&&(DomQuery.isArray(nodes)?result.push.apply(result,nodes):result.push(nodes))}),1<this.length&&(result=DomQuery.unique(result),0!==name.indexOf("parents")&&"prevUntil"!==name||(result=result.reverse()));var wrappedResult=DomQuery(result);return filter?wrappedResult.filter(filter):wrappedResult}}),DomQueryConstructor.fn.is=function(selector){return!!selector&&0<this.filter(selector).length},DomQueryConstructor.fn.init.prototype=DomQueryConstructor.fn,DomQueryConstructor.overrideDefaults=function(callback){var defaults,sub=function(selector,context){return defaults=defaults||callback(),0===arguments.length&&(selector=defaults.element),context=context||defaults.context,new sub.fn.init(selector,context)};return DomQuery.extend(sub,this),sub},DomQueryConstructor.attrHooks=attrHooks,DomQueryConstructor.cssHooks=cssHooks;var DomQuery=DomQueryConstructor,TreeWalker=function(){function TreeWalker(startNode,rootNode){this.node=startNode,this.rootNode=rootNode,this.current=this.current.bind(this),this.next=this.next.bind(this),this.prev=this.prev.bind(this),this.prev2=this.prev2.bind(this)}return TreeWalker.prototype.current=function(){return this.node},TreeWalker.prototype.next=function(shallow){return this.node=this.findSibling(this.node,"firstChild","nextSibling",shallow),this.node},TreeWalker.prototype.prev=function(shallow){return this.node=this.findSibling(this.node,"lastChild","previousSibling",shallow),this.node},TreeWalker.prototype.prev2=function(shallow){return this.node=this.findPreviousNode(this.node,"lastChild","previousSibling",shallow),this.node},TreeWalker.prototype.findSibling=function(node,startName,siblingName,shallow){var sibling,parent;if(node){if(!shallow&&node[startName])return node[startName];if(node!==this.rootNode){if(sibling=node[siblingName])return sibling;for(parent=node.parentNode;parent&&parent!==this.rootNode;parent=parent.parentNode)if(sibling=parent[siblingName])return sibling}}},TreeWalker.prototype.findPreviousNode=function(node,startName,siblingName,shallow){var sibling,parent,child;if(node){if(sibling=node[siblingName],this.rootNode&&sibling===this.rootNode)return;if(sibling){if(!shallow)for(child=sibling[startName];child;child=child[startName])if(!child[startName])return child;return sibling}if((parent=node.parentNode)&&parent!==this.rootNode)return parent}},TreeWalker}(),each$5=Tools.each,grep$1=Tools.grep,isIE=Env.ie,simpleSelectorRe=/^([a-z0-9],?)+$/i,whiteSpaceRegExp$2=/^[ \t\r\n]*$/,setupAttrHooks=function(styles,settings,getContext){var keepValues=settings.keep_values,keepUrlHook={set:function($elm,value,name){settings.url_converter&&(value=settings.url_converter.call(settings.url_converter_scope||getContext(),value,name,$elm[0])),$elm.attr("data-mce-"+name,value).attr(name,value)},get:function($elm,name){return $elm.attr("data-mce-"+name)||$elm.attr(name)}},attrHooks={style:{set:function($elm,value){null===value||"object"!=typeof value?(keepValues&&$elm.attr("data-mce-style",value),null!==value&&"string"==typeof value?($elm.removeAttr("style"),$elm.css(styles.parse(value))):$elm.attr("style",value)):$elm.css(value)},get:function($elm){var value=$elm.attr("data-mce-style")||$elm.attr("style");return value=styles.serialize(styles.parse(value),$elm[0].nodeName)}}};return keepValues&&(attrHooks.href=attrHooks.src=keepUrlHook),attrHooks},updateInternalStyleAttr=function(styles,$elm){var rawValue=$elm.attr("style"),value=styles.serialize(styles.parse(rawValue),$elm[0].nodeName);value=value||null,$elm.attr("data-mce-style",value)},findNodeIndex=function(node,normalized){var lastNodeType,nodeType,idx=0;if(node)for(lastNodeType=node.nodeType,node=node.previousSibling;node;node=node.previousSibling)nodeType=node.nodeType,(!normalized||3!==nodeType||nodeType!==lastNodeType&&node.nodeValue.length)&&(idx++,lastNodeType=nodeType);return idx};function DOMUtils(doc,settings){var attrHooks,_this=this;void 0===settings&&(settings={});function get(elm){if(elm&&doc&&"string"==typeof elm){var node=doc.getElementById(elm);return node&&node.id!==elm?doc.getElementsByName(elm)[1]:node}return elm}function $$(elm){return"string"==typeof elm&&(elm=get(elm)),$(elm)}function getAttrib(elm,name,defaultVal){var hook,value,$elm=$$(elm);return $elm.length&&(value=(hook=attrHooks[name])&&hook.get?hook.get($elm,name):$elm.attr(name)),void 0===value&&(value=defaultVal||""),value}function getAttribs(elm){var node=get(elm);return node?node.attributes:[]}function setAttrib(elm,name,value){var originalValue,hook;""===value&&(value=null);var $elm=$$(elm);originalValue=$elm.attr(name),$elm.length&&((hook=attrHooks[name])&&hook.set?hook.set($elm,value,name):$elm.attr(name,value),originalValue!==value&&settings.onSetAttrib&&settings.onSetAttrib({attrElm:$elm,attrName:name,attrValue:value}))}function getRoot(){return settings.root_element||doc.body}function getPos(elm,rootElm){return Position$1.getPos(doc.body,get(elm),rootElm)}function getStyle(elm,name,computed){var $elm=$$(elm);return computed?$elm.css(name):("float"===(name=name.replace(/-(\D)/g,function(a,b){return b.toUpperCase()}))&&(name=Env.browser.isIE()?"styleFloat":"cssFloat"),$elm[0]&&$elm[0].style?$elm[0].style[name]:void 0)}function getSize(elm){var w,h;return elm=get(elm),w=getStyle(elm,"width"),h=getStyle(elm,"height"),-1===w.indexOf("px")&&(w=0),-1===h.indexOf("px")&&(h=0),{w:parseInt(w,10)||elm.offsetWidth||elm.clientWidth,h:parseInt(h,10)||elm.offsetHeight||elm.clientHeight}}function is(elm,selector){var i;if(!elm)return!1;if(!Array.isArray(elm)){if("*"===selector)return 1===elm.nodeType;if(simpleSelectorRe.test(selector)){var selectors=selector.toLowerCase().split(/,/),elmName=elm.nodeName.toLowerCase();for(i=selectors.length-1;0<=i;i--)if(selectors[i]===elmName)return!0;return!1}if(elm.nodeType&&1!==elm.nodeType)return!1}var elms=Array.isArray(elm)?elm:[elm];return 0<Sizzle(selector,elms[0].ownerDocument||elms[0],null,elms).length}function getParents(elm,selector,root,collect){var selectorVal,result=[],node=get(elm);for(collect=void 0===collect,root=root||("BODY"!==getRoot().nodeName?getRoot().parentNode:null),Tools.is(selector,"string")&&(selector="*"===(selectorVal=selector)?function(node){return 1===node.nodeType}:function(node){return is(node,selectorVal)});node&&node!==root&&node.nodeType&&9!==node.nodeType;){if(!selector||"function"==typeof selector&&selector(node)){if(!collect)return[node];result.push(node)}node=node.parentNode}return collect?result:null}function _findSib(node,selector,name){var func=selector;if(node)for("string"==typeof selector&&(func=function(node){return is(node,selector)}),node=node[name];node;node=node[name])if("function"==typeof func&&func(node))return node;return null}function run(elm,func,scope){var result,node="string"==typeof elm?get(elm):elm;if(!node)return!1;if(Tools.isArray(node)&&(node.length||0===node.length))return result=[],each$5(node,function(elm,i){elm&&("string"==typeof elm&&(elm=get(elm)),result.push(func.call(scope,elm,i)))}),result;var context=scope||_this;return func.call(context,node)}function setAttribs(elm,attrs){$$(elm).each(function(i,node){each$5(attrs,function(value,name){setAttrib(node,name,value)})})}function setHTML(elm,html){var $elm=$$(elm);isIE?$elm.each(function(i,target){if(!1!==target.canHaveHTML){for(;target.firstChild;)target.removeChild(target.firstChild);try{target.innerHTML="<br>"+html,target.removeChild(target.firstChild)}catch(ex){DomQuery("<div></div>").html("<br>"+html).contents().slice(1).appendTo(target)}return html}}):$elm.html(html)}function add(parentElm,name,attrs,html,create){return run(parentElm,function(parentElm){var newElm="string"==typeof name?doc.createElement(name):name;return setAttribs(newElm,attrs),html&&("string"!=typeof html&&html.nodeType?newElm.appendChild(html):"string"==typeof html&&setHTML(newElm,html)),create?newElm:parentElm.appendChild(newElm)})}function create(name,attrs,html){return add(doc.createElement(name),name,attrs,html,!0)}function remove(node,keepChildren){var $node=$$(node);return keepChildren?$node.each(function(){for(var child;child=this.firstChild;)3===child.nodeType&&0===child.data.length?this.removeChild(child):this.parentNode.insertBefore(child,this)}).remove():$node.remove(),1<$node.length?$node.toArray():$node[0]}function toggleClass(elm,cls,state){$$(elm).toggleClass(cls,state).each(function(){""===this.className&&DomQuery(this).attr("class",null)})}function replace(newElm,oldElm,keepChildren){return run(oldElm,function(oldElm){return Tools.is(oldElm,"array")&&(newElm=newElm.cloneNode(!0)),keepChildren&&each$5(grep$1(oldElm.childNodes),function(node){newElm.appendChild(node)}),oldElm.parentNode.replaceChild(newElm,oldElm)})}function isNonEmptyElement(node){if(NodeType.isElement(node)){var isNamedAnchor="a"===node.nodeName.toLowerCase()&&!getAttrib(node,"href")&&getAttrib(node,"id");if(getAttrib(node,"name")||getAttrib(node,"data-mce-bookmark")||isNamedAnchor)return!0}return!1}function createRng(){return doc.createRange()}function getContentEditable(node){if(node&&NodeType.isElement(node)){var contentEditable=node.getAttribute("data-mce-contenteditable");return contentEditable&&"inherit"!==contentEditable?contentEditable:"inherit"!==node.contentEditable?node.contentEditable:null}return null}var addedStyles={},win=domGlobals.window,files={},counter=0,styleSheetLoader=StyleSheetLoader(doc,{contentCssCors:settings.contentCssCors,referrerPolicy:settings.referrerPolicy}),boundEvents=[],schema=settings.schema?settings.schema:Schema({}),styles=Styles({url_converter:settings.url_converter,url_converter_scope:settings.url_converter_scope},settings.schema),events=settings.ownEvents?new EventUtils:EventUtils.Event,blockElementsMap=schema.getBlockElements(),$=DomQuery.overrideDefaults(function(){return{context:doc,element:self.getRoot()}}),decode=Entities.decode,encode=Entities.encodeAllRaw,bind=function(target,name,func,scope){if(Tools.isArray(target)){for(var i=target.length,rv=[];i--;)rv[i]=bind(target[i],name,func,scope);return rv}return!settings.collect||target!==doc&&target!==win||boundEvents.push([target,name,func,scope]),events.bind(target,name,func,scope||self)},unbind=function(target,name,func){var i;if(Tools.isArray(target)){i=target.length;for(var rv=[];i--;)rv[i]=unbind(target[i],name,func);return rv}if(boundEvents&&(target===doc||target===win))for(i=boundEvents.length;i--;){var item=boundEvents[i];target!==item[0]||name&&name!==item[1]||func&&func!==item[2]||events.unbind(item[0],item[1],item[2])}return events.unbind(target,name,func)},self={doc:doc,settings:settings,win:win,files:files,stdMode:!0,boxModel:!0,styleSheetLoader:styleSheetLoader,boundEvents:boundEvents,styles:styles,schema:schema,events:events,isBlock:function(node){if("string"==typeof node)return!!blockElementsMap[node];if(node){var type=node.nodeType;if(type)return!(1!==type||!blockElementsMap[node.nodeName])}return!1},$:$,$$:$$,root:null,clone:function(node,deep){if(!isIE||1!==node.nodeType||deep)return node.cloneNode(deep);if(deep)return null;var clone_1=doc.createElement(node.nodeName);return each$5(getAttribs(node),function(attr){setAttrib(clone_1,attr.nodeName,getAttrib(node,attr.nodeName))}),clone_1},getRoot:getRoot,getViewPort:function(argWin){var vp=getBounds(argWin);return{x:vp.x(),y:vp.y(),w:vp.width(),h:vp.height()}},getRect:function(elm){var pos,size;return elm=get(elm),pos=getPos(elm),size=getSize(elm),{x:pos.x,y:pos.y,w:size.w,h:size.h}},getSize:getSize,getParent:function(node,selector,root){var parents=getParents(node,selector,root,!1);return parents&&0<parents.length?parents[0]:null},getParents:getParents,get:get,getNext:function(node,selector){return _findSib(node,selector,"nextSibling")},getPrev:function(node,selector){return _findSib(node,selector,"previousSibling")},select:function(selector,scope){return Sizzle(selector,get(scope)||settings.root_element||doc,[])},is:is,add:add,create:create,createHTML:function(name,attrs,html){var key,outHtml="";for(key in outHtml+="<"+name,attrs)attrs.hasOwnProperty(key)&&null!==attrs[key]&&void 0!==attrs[key]&&(outHtml+=" "+key+'="'+encode(attrs[key])+'"');return void 0!==html?outHtml+">"+html+"</"+name+">":outHtml+" />"},createFragment:function(html){var node,container=doc.createElement("div"),frag=doc.createDocumentFragment();for(frag.appendChild(container),html&&(container.innerHTML=html);node=container.firstChild;)frag.appendChild(node);return frag.removeChild(container),frag},remove:remove,setStyle:function(elm,name,value){var $elm=isString(name)?$$(elm).css(name,value):$$(elm).css(name);settings.update_styles&&updateInternalStyleAttr(styles,$elm)},getStyle:getStyle,setStyles:function(elm,stylesArg){var $elm=$$(elm).css(stylesArg);settings.update_styles&&updateInternalStyleAttr(styles,$elm)},removeAllAttribs:function(e){return run(e,function(e){var i,attrs=e.attributes;for(i=attrs.length-1;0<=i;i--)e.removeAttributeNode(attrs.item(i))})},setAttrib:setAttrib,setAttribs:setAttribs,getAttrib:getAttrib,getPos:getPos,parseStyle:function(cssText){return styles.parse(cssText)},serializeStyle:function(stylesArg,name){return styles.serialize(stylesArg,name)},addStyle:function(cssText){var head,styleElm;if(self!==DOMUtils.DOM&&doc===domGlobals.document){if(addedStyles[cssText])return;addedStyles[cssText]=!0}(styleElm=doc.getElementById("mceDefaultStyles"))||((styleElm=doc.createElement("style")).id="mceDefaultStyles",styleElm.type="text/css",(head=doc.getElementsByTagName("head")[0]).firstChild?head.insertBefore(styleElm,head.firstChild):head.appendChild(styleElm)),styleElm.styleSheet?styleElm.styleSheet.cssText+=cssText:styleElm.appendChild(doc.createTextNode(cssText))},loadCSS:function(url){var head;self===DOMUtils.DOM||doc!==domGlobals.document?(url=url||"",head=doc.getElementsByTagName("head")[0],each$5(url.split(","),function(url){var link;url=Tools._addCacheSuffix(url),files[url]||(files[url]=!0,link=create("link",__assign(__assign({rel:"stylesheet",type:"text/css",href:url},settings.contentCssCors?{crossOrigin:"anonymous"}:{}),settings.referrerPolicy?{referrerPolicy:settings.referrerPolicy}:{})),head.appendChild(link))})):DOMUtils.DOM.loadCSS(url)},addClass:function(elm,cls){$$(elm).addClass(cls)},removeClass:function(elm,cls){toggleClass(elm,cls,!1)},hasClass:function(elm,cls){return $$(elm).hasClass(cls)},toggleClass:toggleClass,show:function(elm){$$(elm).show()},hide:function(elm){$$(elm).hide()},isHidden:function(elm){return"none"===$$(elm).css("display")},uniqueId:function(prefix){return(prefix||"mce_")+counter++},setHTML:setHTML,getOuterHTML:function(elm){var node="string"==typeof elm?get(elm):elm;return NodeType.isElement(node)?node.outerHTML:DomQuery("<div></div>").append(DomQuery(node).clone()).html()},setOuterHTML:function(elm,html){$$(elm).each(function(){try{if("outerHTML"in this)return void(this.outerHTML=html)}catch(ex){}remove(DomQuery(this).html(html),!0)})},decode:decode,encode:encode,insertAfter:function(node,reference){var referenceNode=get(reference);return run(node,function(node){var parent,nextSibling;return parent=referenceNode.parentNode,(nextSibling=referenceNode.nextSibling)?parent.insertBefore(node,nextSibling):parent.appendChild(node),node})},replace:replace,rename:function(elm,name){var newElm;return elm.nodeName!==name.toUpperCase()&&(newElm=create(name),each$5(getAttribs(elm),function(attrNode){setAttrib(newElm,attrNode.nodeName,getAttrib(elm,attrNode.nodeName))}),replace(newElm,elm,!0)),newElm||elm},findCommonAncestor:function(a,b){for(var pe,ps=a;ps;){for(pe=b;pe&&ps!==pe;)pe=pe.parentNode;if(ps===pe)break;ps=ps.parentNode}return!ps&&a.ownerDocument?a.ownerDocument.documentElement:ps},toHex:function(rgbVal){return styles.toHex(Tools.trim(rgbVal))},run:run,getAttribs:getAttribs,isEmpty:function(node,elements){var type,name,brCount=0;if(isNonEmptyElement(node))return!1;if(node=node.firstChild){var walker=new TreeWalker(node,node.parentNode),whitespace=schema?schema.getWhiteSpaceElements():{};elements=elements||(schema?schema.getNonEmptyElements():null);do{if(type=node.nodeType,NodeType.isElement(node)){var bogusVal=node.getAttribute("data-mce-bogus");if(bogusVal){node=walker.next("all"===bogusVal);continue}if(name=node.nodeName.toLowerCase(),elements&&elements[name]){if("br"!==name)return!1;brCount++,node=walker.next();continue}if(isNonEmptyElement(node))return!1}if(8===type)return!1;if(3===type&&!whiteSpaceRegExp$2.test(node.nodeValue))return!1;if(3===type&&node.parentNode&&whitespace[node.parentNode.nodeName]&&whiteSpaceRegExp$2.test(node.nodeValue))return!1;node=walker.next()}while(node)}return brCount<=1},createRng:createRng,nodeIndex:findNodeIndex,split:function(parentElm,splitElm,replacementElm){var bef,aft,pa,r=createRng();if(parentElm&&splitElm)return r.setStart(parentElm.parentNode,findNodeIndex(parentElm)),r.setEnd(splitElm.parentNode,findNodeIndex(splitElm)),bef=r.extractContents(),(r=createRng()).setStart(splitElm.parentNode,findNodeIndex(splitElm)+1),r.setEnd(parentElm.parentNode,findNodeIndex(parentElm)+1),aft=r.extractContents(),(pa=parentElm.parentNode).insertBefore(TrimNode.trimNode(self,bef),parentElm),replacementElm?pa.insertBefore(replacementElm,parentElm):pa.insertBefore(splitElm,parentElm),pa.insertBefore(TrimNode.trimNode(self,aft),parentElm),remove(parentElm),replacementElm||splitElm},bind:bind,unbind:unbind,fire:function(target,name,evt){return events.fire(target,name,evt)},getContentEditable:getContentEditable,getContentEditableParent:function(node){for(var root=getRoot(),state=null;node&&node!==root&&null===(state=getContentEditable(node));node=node.parentNode);return state},destroy:function(){if(boundEvents)for(var i=boundEvents.length;i--;){var item=boundEvents[i];events.unbind(item[0],item[1],item[2])}Sizzle.setDocument&&Sizzle.setDocument()},isChildOf:function(node,parent){for(;node;){if(parent===node)return!0;node=node.parentNode}return!1},dumpRng:function(r){return"startContainer: "+r.startContainer.nodeName+", startOffset: "+r.startOffset+", endContainer: "+r.endContainer.nodeName+", endOffset: "+r.endOffset}};return attrHooks=setupAttrHooks(styles,settings,function(){return self}),self}!function(DOMUtils){DOMUtils.DOM=DOMUtils(domGlobals.document),DOMUtils.nodeIndex=findNodeIndex}(DOMUtils=DOMUtils||{});function getLanguageData(){return get(data,currentCode.get())}var DOMUtils$1=DOMUtils,DOM=DOMUtils$1.DOM,each$6=Tools.each,grep$2=Tools.grep,ScriptLoader=function(){function ScriptLoader(settings){void 0===settings&&(settings={}),this.states={},this.queue=[],this.scriptLoadedCallbacks={},this.queueLoadedCallbacks=[],this.loading=0,this.settings=settings}return ScriptLoader.prototype._setReferrerPolicy=function(referrerPolicy){this.settings.referrerPolicy=referrerPolicy},ScriptLoader.prototype.loadScript=function(url,success,failure){var elm,id,dom=DOM;id=dom.uniqueId(),(elm=domGlobals.document.createElement("script")).id=id,elm.type="text/javascript",elm.src=Tools._addCacheSuffix(url),this.settings.referrerPolicy&&dom.setAttrib(elm,"referrerpolicy",this.settings.referrerPolicy),elm.onload=function(){dom.remove(id),elm&&(elm.onreadystatechange=elm.onload=elm=null),success()},elm.onerror=function(){isFunction(failure)?failure():void 0!==domGlobals.console&&domGlobals.console.log&&domGlobals.console.log("Failed to load script: "+url)},(domGlobals.document.getElementsByTagName("head")[0]||domGlobals.document.body).appendChild(elm)},ScriptLoader.prototype.isDone=function(url){return 2===this.states[url]},ScriptLoader.prototype.markDone=function(url){this.states[url]=2},ScriptLoader.prototype.add=function(url,success,scope,failure){void 0===this.states[url]&&(this.queue.push(url),this.states[url]=0),success&&(this.scriptLoadedCallbacks[url]||(this.scriptLoadedCallbacks[url]=[]),this.scriptLoadedCallbacks[url].push({success:success,failure:failure,scope:scope||this}))},ScriptLoader.prototype.load=function(url,success,scope,failure){return this.add(url,success,scope,failure)},ScriptLoader.prototype.remove=function(url){delete this.states[url],delete this.scriptLoadedCallbacks[url]},ScriptLoader.prototype.loadQueue=function(success,scope,failure){this.loadScripts(this.queue,success,scope,failure)},ScriptLoader.prototype.loadScripts=function(scripts,success,scope,failure){function execCallbacks(name,url){each$6(self.scriptLoadedCallbacks[url],function(callback){isFunction(callback[name])&&callback[name].call(callback.scope)}),self.scriptLoadedCallbacks[url]=void 0}var loadScripts,self=this,failures=[];self.queueLoadedCallbacks.push({success:success,failure:failure,scope:scope||this}),(loadScripts=function(){var loadingScripts=grep$2(scripts);if(scripts.length=0,each$6(loadingScripts,function(url){2!==self.states[url]?3!==self.states[url]?1!==self.states[url]&&(self.states[url]=1,self.loading++,self.loadScript(url,function(){self.states[url]=2,self.loading--,execCallbacks("success",url),loadScripts()},function(){self.states[url]=3,self.loading--,failures.push(url),execCallbacks("failure",url),loadScripts()})):execCallbacks("failure",url):execCallbacks("success",url)}),!self.loading){var notifyCallbacks=self.queueLoadedCallbacks.slice(0);self.queueLoadedCallbacks.length=0,each$6(notifyCallbacks,function(callback){0===failures.length?isFunction(callback.success)&&callback.success.call(callback.scope):isFunction(callback.failure)&&callback.failure.call(callback.scope,failures)})}})()},ScriptLoader.ScriptLoader=new ScriptLoader,ScriptLoader}(),data={},currentCode=Cell("en"),I18n={getData:function(){return map$1(data,function(value){return __assign({},value)})},setCode:function(newCode){newCode&&currentCode.set(newCode)},getCode:function(){return currentCode.get()},add:function(code,items){var langData=data[code];langData||(data[code]=langData={}),each$1(items,function(translation,name){langData[name.toLowerCase()]=translation})},translate:function(text){function toString(obj){return isFunction(obj)?Object.prototype.toString.call(obj):isEmpty(obj)?"":""+obj}function getLangData(text){var textstr=toString(text);return get(langData,textstr.toLowerCase()).map(toString).getOr(textstr)}function removeContext(str){return str.replace(/{context:\w+}$/,"")}function translated(text){return text}var langData=getLanguageData().getOr({}),isEmpty=function(text){return""===text||null==text};if(isEmpty(text))return"";if(function(str){return isObject(str)&&has(str,"raw")}(text))return translated(toString(text.raw));if(function(str){return isArray(str)&&1<str.length}(text)){var values_1=text.slice(1);return translated(removeContext(getLangData(text[0]).replace(/\{([0-9]+)\}/g,function($1,$2){return has(values_1,$2)?toString(values_1[$2]):$1})))}return translated(removeContext(getLangData(text)))},isRtl:function(){return getLanguageData().bind(function(items){return get(items,"_dir")}).exists(function(dir){return"rtl"===dir})},hasCode:function(code){return has(data,code)}};function AddOnManager(){function runListeners(name,state){var matchedListeners=filter(_listeners,function(listener){return listener.name===name&&listener.state===state});each(matchedListeners,function(listener){return listener.callback()})}function dependencies(name){var result;return lookup[name]&&(result=lookup[name].dependencies),result||[]}function createUrl(baseUrl,dep){return"object"==typeof dep?dep:"string"==typeof baseUrl?{prefix:"",resource:dep,suffix:""}:{prefix:baseUrl.prefix,resource:dep,suffix:baseUrl.suffix}}var _this=this,items=[],urls={},lookup={},_listeners=[],load=function(name,addOnUrl,success,scope,failure){if(!urls[name]){var urlString="string"==typeof addOnUrl?addOnUrl:addOnUrl.prefix+addOnUrl.resource+addOnUrl.suffix;0!==urlString.indexOf("/")&&-1===urlString.indexOf("://")&&(urlString=AddOnManager.baseURL+"/"+urlString),urls[name]=urlString.substring(0,urlString.lastIndexOf("/"));var done=function(){runListeners(name,"loaded"),function(name,addOnUrl,success,scope){var deps=dependencies(name);each(deps,function(dep){var newUrl=createUrl(addOnUrl,dep);load(newUrl.resource,newUrl,void 0,void 0)}),success&&(scope?success.call(scope):success.call(ScriptLoader))}(name,addOnUrl,success,scope)};lookup[name]?done():ScriptLoader.ScriptLoader.add(urlString,done,scope,failure)}},waitFor=function(name,callback,state){void 0===state&&(state="added"),has(lookup,name)&&"added"===state?callback():has(urls,name)&&"loaded"===state?callback():_listeners.push({name:name,state:state,callback:callback})};return{items:items,urls:urls,lookup:lookup,_listeners:_listeners,get:function(name){if(lookup[name])return lookup[name].instance},dependencies:dependencies,requireLangPack:function(name,languages){!1!==AddOnManager.languageLoad&&waitFor(name,function(){var language=I18n.getCode();!language||languages&&-1===(","+(languages||"")+",").indexOf(","+language+",")||ScriptLoader.ScriptLoader.add(urls[name]+"/langs/"+language+".js")},"loaded")},add:function(id,addOn,dependencies){var addOnConstructor=addOn;return items.push(addOnConstructor),lookup[id]={instance:addOnConstructor,dependencies:dependencies},runListeners(id,"added"),addOnConstructor},remove:function(name){delete urls[name],delete lookup[name]},createUrl:createUrl,addComponents:function(pluginName,scripts){var pluginUrl=_this.urls[pluginName];each(scripts,function(script){ScriptLoader.ScriptLoader.add(pluginUrl+"/"+script)})},load:load,waitFor:waitFor}}!function(AddOnManager){AddOnManager.PluginManager=AddOnManager(),AddOnManager.ThemeManager=AddOnManager()}(AddOnManager=AddOnManager||{});function first(fn,rate){var timer=null;return{cancel:function(){null!==timer&&(domGlobals.clearTimeout(timer),timer=null)},throttle:function(){for(var args=[],_i=0;_i<arguments.length;_i++)args[_i]=arguments[_i];null===timer&&(timer=domGlobals.setTimeout(function(){fn.apply(null,args),timer=null},rate))}}}function last$2(fn,rate){var timer=null;return{cancel:function(){null!==timer&&(domGlobals.clearTimeout(timer),timer=null)},throttle:function(){for(var args=[],_i=0;_i<arguments.length;_i++)args[_i]=arguments[_i];null!==timer&&domGlobals.clearTimeout(timer),timer=domGlobals.setTimeout(function(){fn.apply(null,args),timer=null},rate)}}}function read(element,attr){var value=get$3(element,attr);return void 0===value||""===value?[]:value.split(" ")}function supports(element){return void 0!==element.dom().classList}function add$2(element,clazz){return function(element,attr,id){var nu=read(element,attr).concat([id]);return set(element,attr,nu.join(" ")),!0}(element,"class",clazz)}function remove$3(element,clazz){return function(element,attr,id){var nu=filter(read(element,attr),function(v){return v!==id});return 0<nu.length?set(element,attr,nu.join(" ")):remove$1(element,attr),!1}(element,"class",clazz)}function add$3(element,clazz){supports(element)?element.dom().classList.add(clazz):add$2(element,clazz)}function cleanClass(element){0===(supports(element)?element.dom().classList:function(element){return read(element,"class")}(element)).length&&remove$1(element,"class")}function has$2(element,clazz){return supports(element)&&element.dom().classList.contains(clazz)}function descendants$1(scope,selector){return function(selector,scope){var base=void 0===scope?domGlobals.document:scope.dom();return bypassSelector(base)?[]:map(base.querySelectorAll(selector),Element.fromDom)}(selector,scope)}var AddOnManager$1=AddOnManager,descendants=function(scope,predicate){var result=[];return each(children(scope),function(x){predicate(x)&&(result=result.concat([x])),result=result.concat(descendants(x,predicate))}),result};function ClosestOrAncestor(is,ancestor,scope,a,isRoot){return is(scope,a)?Option.some(scope):isFunction(isRoot)&&isRoot(scope)?Option.none():ancestor(scope,a,isRoot)}function ancestor(scope,predicate,isRoot){for(var element=scope.dom(),stop=isFunction(isRoot)?isRoot:constant(!1);element.parentNode;){element=element.parentNode;var el=Element.fromDom(element);if(predicate(el))return Option.some(el);if(stop(el))break}return Option.none()}function closest(scope,predicate,isRoot){return ClosestOrAncestor(function(s,test){return test(s)},ancestor,scope,predicate,isRoot)}function ancestor$1(scope,selector,isRoot){return ancestor(scope,function(e){return is(e,selector)},isRoot)}function descendant(scope,selector){return function(selector,scope){var base=void 0===scope?domGlobals.document:scope.dom();return bypassSelector(base)?Option.none():Option.from(base.querySelector(selector)).map(Element.fromDom)}(selector,scope)}function closest$1(scope,selector,isRoot){return ClosestOrAncestor(is,ancestor$1,scope,selector,isRoot)}function identify(editor,annotationName){function getAttr(c,property){return function(element,key){var dom=element.dom();return!(!dom||!dom.hasAttribute)&&dom.hasAttribute(key)}(c,property)?Option.some(get$3(c,property)):Option.none()}var rng=editor.selection.getRng(),start=Element.fromDom(rng.startContainer),root=Element.fromDom(editor.getBody()),selector=annotationName.fold(function(){return"."+annotation()},function(an){return"["+dataAnnotation()+'="'+an+'"]'}),newStart=child(start,rng.startOffset).getOr(start);return closest$1(newStart,selector,function(n){return eq(n,root)}).bind(function(c){return getAttr(c,""+dataAnnotationId()).bind(function(uid){return getAttr(c,""+dataAnnotation()).map(function(name){var elements=findMarkers(editor,uid);return{uid:uid,name:name,elements:elements}})})})}function setup(editor,registry){function withCallbacks(name,f){updateCallbacks(name,function(data){return f(data),data})}var changeCallbacks=Cell({}),updateCallbacks=function(name,f){var callbackMap=changeCallbacks.get(),outputData=f(callbackMap.hasOwnProperty(name)?callbackMap[name]:{listeners:[],previous:Cell(Option.none())});callbackMap[name]=outputData,changeCallbacks.set(callbackMap)},onNodeChange=last$2(function(){var callbackMap=changeCallbacks.get(),annotations=function(xs,comparator){var copy=nativeSlice.call(xs,0);return copy.sort(comparator),copy}(keys(callbackMap));each(annotations,function(name){updateCallbacks(name,function(data){var prev=data.previous.get();return identify(editor,Option.some(name)).fold(function(){prev.isSome()&&(function(name){withCallbacks(name,function(data){each(data.listeners,function(f){return f(!1,name)})})}(name),data.previous.set(Option.none()))},function(_a){var uid=_a.uid,name=_a.name,elements=_a.elements;prev.is(uid)||(function(name,uid,elements){withCallbacks(name,function(data){each(data.listeners,function(f){return f(!0,name,{uid:uid,nodes:map(elements,function(elem){return elem.dom()})})})})}(name,uid,elements),data.previous.set(Option.some(uid)))}),{previous:data.previous,listeners:data.listeners}})})},30);return editor.on("remove",function(){onNodeChange.cancel()}),editor.on("NodeChange",function(){onNodeChange.throttle()}),{addListener:function(name,f){updateCallbacks(name,function(data){return{previous:data.previous,listeners:data.listeners.concat([f])}})}}}function setup$1(editor,registry){editor.on("init",function(){editor.serializer.addNodeFilter("span",function(spans){each(spans,function(span){(function(span){return Option.from(span.attr(dataAnnotation())).bind(registry.lookup)})(span).each(function(settings){!1===settings.persistent&&span.unwrap()})})})})}function set$1(element,content){var docDom=owner(element).dom(),fragment=Element.fromDom(docDom.createDocumentFragment()),contentElements=function(html,scope){var div=(scope||domGlobals.document).createElement("div");return div.innerHTML=html,children(Element.fromDom(div))}(content,docDom);append$1(fragment,contentElements),empty(element),append(element,fragment)}function clone(original,isDeep){return Element.fromDom(original.dom().cloneNode(isDeep))}function shallow(original){return clone(original,!1)}function deep(original){return clone(original,!0)}function isCaretContainerBlock(node){return isText$2(node)&&(node=node.parentNode),isElement$2(node)&&node.hasAttribute("data-mce-caret")}function isCaretContainerInline(node){return isText$2(node)&&Zwsp.isZwsp(node.data)}function isCaretContainer(node){return isCaretContainerBlock(node)||isCaretContainerInline(node)}function hasContent(node){return node.firstChild!==node.lastChild||!NodeType.isBr(node.firstChild)}function isBeforeInline(pos){var container=pos.container();return!(!pos||!NodeType.isText(container))&&(container.data.charAt(pos.offset())===Zwsp.ZWSP||pos.isAtStart()&&isCaretContainerInline(container.previousSibling))}function isAfterInline(pos){var container=pos.container();return!(!pos||!NodeType.isText(container))&&(container.data.charAt(pos.offset()-1)===Zwsp.ZWSP||pos.isAtEnd()&&isCaretContainerInline(container.nextSibling))}function insertBlock(blockName,node,before){var blockNode,parentNode;return(blockNode=node.ownerDocument.createElement(blockName)).setAttribute("data-mce-caret",before?"before":"after"),blockNode.setAttribute("data-mce-bogus","all"),blockNode.appendChild(function(){var br=domGlobals.document.createElement("br");return br.setAttribute("data-mce-bogus","1"),br}()),parentNode=node.parentNode,before?parentNode.insertBefore(blockNode,node):node.nextSibling?parentNode.insertBefore(blockNode,node.nextSibling):parentNode.appendChild(blockNode),blockNode}function showCaretContainerBlock(caretContainer){return caretContainer&&caretContainer.hasAttribute("data-mce-caret")?(function(elm){var brs=elm.getElementsByTagName("br"),lastBr=brs[brs.length-1];NodeType.isBogus(lastBr)&&lastBr.parentNode.removeChild(lastBr)}(caretContainer),caretContainer.removeAttribute("data-mce-caret"),caretContainer.removeAttribute("data-mce-bogus"),caretContainer.removeAttribute("style"),caretContainer.removeAttribute("_moz_abspos"),caretContainer):null}function isCaretCandidate(node){return!isCaretContainer$1(node)&&(isText$3(node)?!isInvalidTextElement(node.parentNode):isAtomicInline(node)||isBr$2(node)||isTable$2(node)||isNonUiContentEditableFalse(node))}function isEditableCaretCandidate(node,root){return isCaretCandidate(node)&&function(node,root){for(node=node.parentNode;node&&node!==root;node=node.parentNode){if(isNonUiContentEditableFalse(node))return!1;if(isContentEditableTrue$1(node))return!0}return!0}(node,root)}function clone$1(rect){return rect?{left:round(rect.left),top:round(rect.top),bottom:round(rect.bottom),right:round(rect.right),width:round(rect.width),height:round(rect.height)}:{left:0,top:0,bottom:0,right:0,width:0,height:0}}function collapse(rect,toStart){return rect=clone$1(rect),toStart||(rect.left=rect.left+rect.width),rect.right=rect.left,rect.width=0,rect}function isValidOverflow(overflowY,rect1,rect2){return 0<=overflowY&&overflowY<=Math.min(rect1.height,rect2.height)/2}function isAbove(rect1,rect2){return rect1.bottom-rect1.height/2<rect2.top||!(rect1.top>rect2.bottom)&&isValidOverflow(rect2.top-rect1.bottom,rect1,rect2)}function isBelow(rect1,rect2){return rect1.top>rect2.bottom||!(rect1.bottom<rect2.top)&&isValidOverflow(rect2.bottom-rect1.top,rect1,rect2)}function containsXY(rect,clientX,clientY){return clientX>=rect.left&&clientX<=rect.right&&clientY>=rect.top&&clientY<=rect.bottom}function getSelectedNode(range){var startContainer=range.startContainer,startOffset=range.startOffset;return startContainer.hasChildNodes()&&range.endOffset===startOffset+1?startContainer.childNodes[startOffset]:null}function getNode(container,offset){return 1===container.nodeType&&container.hasChildNodes()&&(offset>=container.childNodes.length&&(offset=container.childNodes.length-1),container=container.childNodes[offset]),container}function isExtendingChar(ch){return"string"==typeof ch&&768<=ch.charCodeAt(0)&&extendingChars.test(ch)}function lift2(oa,ob,f){return oa.isSome()&&ob.isSome()?Option.some(f(oa.getOrDie(),ob.getOrDie())):Option.none()}function isWhiteSpace(chr){return chr&&/[\r\n\t ]/.test(chr)}function isRange(rng){return!!rng.setStart&&!!rng.setEnd}function isHiddenWhiteSpaceRange(range){var text,container=range.startContainer,offset=range.startOffset;return!!(isWhiteSpace(range.toString())&&isNotPre(container.parentNode)&&NodeType.isText(container)&&(text=container.data,isWhiteSpace(text[offset-1])||isWhiteSpace(text[offset+1])))}function isZeroRect(r){return 0===r.left&&0===r.right&&0===r.top&&0===r.bottom}function collapseAndInflateWidth(clientRect,toStart){var newClientRect=collapse(clientRect,toStart);return newClientRect.width=1,newClientRect.right=newClientRect.left+1,newClientRect}var annotation=constant("mce-annotation"),dataAnnotation=constant("data-mce-annotation"),dataAnnotationId=constant("data-mce-annotation-uid"),findMarkers=function(editor,uid){var body=Element.fromDom(editor.getBody());return descendants$1(body,"["+dataAnnotationId()+'="'+uid+'"]')},unique=0,Zwsp={isZwsp:function(chr){return"\ufeff"===chr},ZWSP:"\ufeff",trim:function(text){return text.replace(new RegExp("\ufeff","g"),"")}},isElement$2=NodeType.isElement,isText$2=NodeType.isText,startsWithCaretContainer=function(node){return isText$2(node)&&node.data[0]===Zwsp.ZWSP},endsWithCaretContainer=function(node){return isText$2(node)&&node.data[node.data.length-1]===Zwsp.ZWSP},isContentEditableTrue$1=NodeType.isContentEditableTrue,isContentEditableFalse$1=NodeType.isContentEditableFalse,isBr$2=NodeType.isBr,isText$3=NodeType.isText,isInvalidTextElement=NodeType.matchNodeNames(["script","style","textarea"]),isAtomicInline=NodeType.matchNodeNames(["img","input","textarea","hr","iframe","video","audio","object"]),isTable$2=NodeType.matchNodeNames(["table"]),isCaretContainer$1=isCaretContainer,isNonUiContentEditableFalse=function(node){return!1===function(node){return NodeType.isElement(node)&&"true"===node.getAttribute("unselectable")}(node)&&isContentEditableFalse$1(node)},round=Math.round,extendingChars=new RegExp("[-----------------------------------------------------------------------------------------------------------------------------------]"),slice$2=[].slice,Predicate_and=function(){for(var x=[],_i=0;_i<arguments.length;_i++)x[_i]=arguments[_i];var args=slice$2.call(arguments);return function(x){for(var i=0;i<args.length;i++)if(!args[i](x))return!1;return!0}},Predicate_or=function(){for(var x=[],_i=0;_i<arguments.length;_i++)x[_i]=arguments[_i];var args=slice$2.call(arguments);return function(x){for(var i=0;i<args.length;i++)if(args[i](x))return!0;return!1}},isElement$3=NodeType.isElement,isCaretCandidate$1=isCaretCandidate,isBlock$1=NodeType.matchStyleValues("display","block table"),isFloated=NodeType.matchStyleValues("float","left right"),isValidElementCaretCandidate=Predicate_and(isElement$3,isCaretCandidate$1,not(isFloated)),isNotPre=not(NodeType.matchStyleValues("white-space","pre pre-line pre-wrap")),isText$4=NodeType.isText,isBr$3=NodeType.isBr,nodeIndex=DOMUtils$1.nodeIndex,resolveIndex=getNode,createRange=function(doc){return"createRange"in doc?doc.createRange():DOMUtils$1.DOM.createRng()},getBoundingClientRect=function(item){var clientRect,clientRects;return clientRect=0<(clientRects=item.getClientRects()).length?clone$1(clientRects[0]):clone$1(item.getBoundingClientRect()),!isRange(item)&&isBr$3(item)&&isZeroRect(clientRect)?function(brNode){var clientRect,doc=brNode.ownerDocument,rng=createRange(doc),nbsp$1=doc.createTextNode(""),parentNode=brNode.parentNode;return parentNode.insertBefore(nbsp$1,brNode),rng.setStart(nbsp$1,0),rng.setEnd(nbsp$1,1),clientRect=clone$1(rng.getBoundingClientRect()),parentNode.removeChild(nbsp$1),clientRect}(item):isZeroRect(clientRect)&&isRange(item)?function(rng){var sc=rng.startContainer,ec=rng.endContainer,so=rng.startOffset,eo=rng.endOffset;if(sc===ec&&NodeType.isText(ec)&&0===so&&1===eo){var newRng=rng.cloneRange();return newRng.setEndAfter(ec),getBoundingClientRect(newRng)}return null}(item):clientRect},getCaretPositionClientRects=function(caretPosition){function addUniqueAndValidRect(clientRect){0!==clientRect.height&&(0<clientRects.length&&function(rect1,rect2){return rect1.left===rect2.left&&rect1.top===rect2.top&&rect1.bottom===rect2.bottom&&rect1.right===rect2.right}(clientRect,clientRects[clientRects.length-1])||clientRects.push(clientRect))}function addCharacterOffset(container,offset){var range=createRange(container.ownerDocument);if(offset<container.data.length){if(isExtendingChar(container.data[offset]))return clientRects;if(isExtendingChar(container.data[offset-1])&&(range.setStart(container,offset),range.setEnd(container,offset+1),!isHiddenWhiteSpaceRange(range)))return addUniqueAndValidRect(collapseAndInflateWidth(getBoundingClientRect(range),!1)),clientRects}0<offset&&(range.setStart(container,offset-1),range.setEnd(container,offset),isHiddenWhiteSpaceRange(range)||addUniqueAndValidRect(collapseAndInflateWidth(getBoundingClientRect(range),!1))),offset<container.data.length&&(range.setStart(container,offset),range.setEnd(container,offset+1),isHiddenWhiteSpaceRange(range)||addUniqueAndValidRect(collapseAndInflateWidth(getBoundingClientRect(range),!0)))}var beforeNode,node,clientRects=[];if(isText$4(caretPosition.container()))return addCharacterOffset(caretPosition.container(),caretPosition.offset()),clientRects;if(isElement$3(caretPosition.container()))if(caretPosition.isAtEnd())node=resolveIndex(caretPosition.container(),caretPosition.offset()),isText$4(node)&&addCharacterOffset(node,node.data.length),isValidElementCaretCandidate(node)&&!isBr$3(node)&&addUniqueAndValidRect(collapseAndInflateWidth(getBoundingClientRect(node),!1));else{if(node=resolveIndex(caretPosition.container(),caretPosition.offset()),isText$4(node)&&addCharacterOffset(node,0),isValidElementCaretCandidate(node)&&caretPosition.isAtEnd())return addUniqueAndValidRect(collapseAndInflateWidth(getBoundingClientRect(node),!1)),clientRects;beforeNode=resolveIndex(caretPosition.container(),caretPosition.offset()-1),isValidElementCaretCandidate(beforeNode)&&!isBr$3(beforeNode)&&(!isBlock$1(beforeNode)&&!isBlock$1(node)&&isValidElementCaretCandidate(node)||addUniqueAndValidRect(collapseAndInflateWidth(getBoundingClientRect(beforeNode),!1))),isValidElementCaretCandidate(node)&&addUniqueAndValidRect(collapseAndInflateWidth(getBoundingClientRect(node),!0))}return clientRects};function CaretPosition(container,offset,clientRects){function getClientRects(){return clientRects=clientRects||getCaretPositionClientRects(CaretPosition(container,offset))}return{container:constant(container),offset:constant(offset),toRange:function(){var range;return(range=createRange(container.ownerDocument)).setStart(container,offset),range.setEnd(container,offset),range},getClientRects:getClientRects,isVisible:function(){return 0<getClientRects().length},isAtStart:function(){return isText$4(container),0===offset},isAtEnd:function(){return isText$4(container)?offset>=container.data.length:offset>=container.childNodes.length},isEqual:function(caretPosition){return caretPosition&&container===caretPosition.container()&&offset===caretPosition.offset()},getNode:function(before){return resolveIndex(container,before?offset-1:offset)}}}!function(CaretPosition){CaretPosition.fromRangeStart=function(range){return CaretPosition(range.startContainer,range.startOffset)},CaretPosition.fromRangeEnd=function(range){return CaretPosition(range.endContainer,range.endOffset)},CaretPosition.after=function(node){return CaretPosition(node.parentNode,nodeIndex(node)+1)},CaretPosition.before=function(node){return CaretPosition(node.parentNode,nodeIndex(node))},CaretPosition.isAbove=function(pos1,pos2){return lift2(head(pos2.getClientRects()),last(pos1.getClientRects()),isAbove).getOr(!1)},CaretPosition.isBelow=function(pos1,pos2){return lift2(last(pos2.getClientRects()),head(pos1.getClientRects()),isBelow).getOr(!1)},CaretPosition.isAtStart=function(pos){return!!pos&&pos.isAtStart()},CaretPosition.isAtEnd=function(pos){return!!pos&&pos.isAtEnd()},CaretPosition.isTextPosition=function(pos){return!!pos&&NodeType.isText(pos.container())},CaretPosition.isElementPosition=function(pos){return!1===CaretPosition.isTextPosition(pos)}}(CaretPosition=CaretPosition||{});function equal(a){return function(b){return a===b}}function createPathItem(node){return(isText$5(node)?"text()":node.nodeName.toLowerCase())+"["+function(node){var nodes,index,numTextFragments;return nodes=getChildNodes(normalizedParent(node)),index=ArrUtils.findIndex(nodes,equal(node),node),nodes=nodes.slice(0,index+1),numTextFragments=ArrUtils.reduce(nodes,function(result,node,i){return isText$5(node)&&isText$5(nodes[i-1])&&result++,result},0),nodes=ArrUtils.filter(nodes,NodeType.matchNodeNames([node.nodeName])),(index=ArrUtils.findIndex(nodes,equal(node),node))-numTextFragments}(node)+"]"}function create$2(root,caretPosition){var container,offset,outputOffset,childNodes,parents,path=[];return container=caretPosition.container(),offset=caretPosition.offset(),isText$5(container)?outputOffset=function(node,offset){for(;(node=node.previousSibling)&&isText$5(node);)offset+=node.data.length;return offset}(container,offset):(offset>=(childNodes=container.childNodes).length?(outputOffset="after",offset=childNodes.length-1):outputOffset="before",container=childNodes[offset]),path.push(createPathItem(container)),parents=function(root,node,predicate){var parents=[];for(node=node.parentNode;node!==root&&(!predicate||!predicate(node));node=node.parentNode)parents.push(node);return parents}(root,container),parents=ArrUtils.filter(parents,not(NodeType.isBogus)),(path=path.concat(ArrUtils.map(parents,function(node){return createPathItem(node)}))).reverse().join("/")+","+outputOffset}function resolve$1(root,path){var parts,container,offset;return path?(path=(parts=path.split(","))[0].split("/"),offset=1<parts.length?parts[1]:"before",(container=ArrUtils.reduce(path,function(result,value){return(value=/([\w\-\(\)]+)\[([0-9]+)\]/.exec(value))?("text()"===value[1]&&(value[1]="#text"),function(node,name,index){var nodes=getChildNodes(node);return nodes=ArrUtils.filter(nodes,function(node,index){return!isText$5(node)||!isText$5(nodes[index-1])}),(nodes=ArrUtils.filter(nodes,NodeType.matchNodeNames([name])))[index]}(result,value[1],parseInt(value[2],10))):null},root))?isText$5(container)?function(container,offset){for(var dataLen,node=container,targetOffset=0;isText$5(node);){if(dataLen=node.data.length,targetOffset<=offset&&offset<=targetOffset+dataLen){container=node,offset-=targetOffset;break}if(!isText$5(node.nextSibling)){container=node,offset=dataLen;break}targetOffset+=dataLen,node=node.nextSibling}return isText$5(container)&&offset>container.data.length&&(offset=container.data.length),CaretPosition$1(container,offset)}(container,parseInt(offset,10)):(offset="after"===offset?nodeIndex$1(container)+1:nodeIndex$1(container),CaretPosition$1(container.parentNode,offset)):null):null}function trimEmptyTextNode(dom,node){NodeType.isText(node)&&0===node.data.length&&dom.remove(node)}function rangeInsertNode(dom,rng,node){NodeType.isDocumentFragment(node)?function(dom,rng,frag){var firstChild=Option.from(frag.firstChild),lastChild=Option.from(frag.lastChild);rng.insertNode(frag),firstChild.each(function(child){return trimEmptyTextNode(dom,child.previousSibling)}),lastChild.each(function(child){return trimEmptyTextNode(dom,child.nextSibling)})}(dom,rng,node):function(dom,rng,node){rng.insertNode(node),trimEmptyTextNode(dom,node.previousSibling),trimEmptyTextNode(dom,node.nextSibling)}(dom,rng,node)}function getPoint(dom,trim,normalized,rng,start){var childNodes,container=rng[start?"startContainer":"endContainer"],offset=rng[start?"startOffset":"endOffset"],point=[],after=0,root=dom.getRoot();for(NodeType.isText(container)?point.push(normalized?function(trim,container,offset){var node,trimmedOffset;for(trimmedOffset=trim(container.data.slice(0,offset)).length,node=container.previousSibling;node&&NodeType.isText(node);node=node.previousSibling)trimmedOffset+=trim(node.data).length;return trimmedOffset}(trim,container,offset):offset):(offset>=(childNodes=container.childNodes).length&&childNodes.length&&(after=1,offset=Math.max(0,childNodes.length-1)),point.push(dom.nodeIndex(childNodes[offset],normalized)+after));container&&container!==root;container=container.parentNode)point.push(dom.nodeIndex(container,normalized));return point}function findIndex$2(dom,name,element){var count=0;return Tools.each(dom.select(name),function(node){if("all"!==node.getAttribute("data-mce-bogus"))return node!==element&&void count++}),count}function moveEndPoint(rng,start){var container,offset,childNodes,prefix=start?"start":"end";container=rng[prefix+"Container"],offset=rng[prefix+"Offset"],NodeType.isElement(container)&&"TR"===container.nodeName&&(container=(childNodes=container.childNodes)[Math.min(start?offset:offset-1,childNodes.length-1)])&&(offset=start?0:container.childNodes.length,rng["set"+(start?"Start":"End")](container,offset))}function normalizeTableCellSelection(rng){return moveEndPoint(rng,!0),moveEndPoint(rng,!1),rng}function findSibling(node,offset){var sibling;if(NodeType.isElement(node)&&(node=getNode(node,offset),isContentEditableFalse$2(node)))return node;if(isCaretContainer(node)){if(NodeType.isText(node)&&isCaretContainerBlock(node)&&(node=node.parentNode),sibling=node.previousSibling,isContentEditableFalse$2(sibling))return sibling;if(sibling=node.nextSibling,isContentEditableFalse$2(sibling))return sibling}}function getOffsetBookmark(trim,normalized,selection){var element=selection.getNode(),name=element?element.nodeName:null,rng=selection.getRng();if(isContentEditableFalse$2(element)||"IMG"===name)return{name:name,index:findIndex$2(selection.dom,name,element)};var sibling=function(rng){return findSibling(rng.startContainer,rng.startOffset)||findSibling(rng.endContainer,rng.endOffset)}(rng);return sibling?{name:name=sibling.tagName,index:findIndex$2(selection.dom,name,sibling)}:function(trim,selection,normalized,rng){var dom=selection.dom,bookmark={};return bookmark.start=getPoint(dom,trim,normalized,rng,!0),selection.isCollapsed()||(bookmark.end=getPoint(dom,trim,normalized,rng,!1)),bookmark}(trim,selection,normalized,rng)}function createBookmarkSpan(dom,id,filled){var args={"data-mce-type":"bookmark",id:id,style:"overflow:hidden;line-height:0px"};return filled?dom.create("span",args,"&#xFEFF;"):dom.create("span",args)}function getPersistentBookmark(selection,filled){var dom=selection.dom,rng=selection.getRng(),id=dom.uniqueId(),collapsed=selection.isCollapsed(),element=selection.getNode(),name=element.nodeName;if("IMG"===name)return{name:name,index:findIndex$2(dom,name,element)};var rng2=normalizeTableCellSelection(rng.cloneRange());if(!collapsed){rng2.collapse(!1);var endBookmarkNode=createBookmarkSpan(dom,id+"_end",filled);rangeInsertNode(dom,rng2,endBookmarkNode)}(rng=normalizeTableCellSelection(rng)).collapse(!0);var startBookmarkNode=createBookmarkSpan(dom,id+"_start",filled);return rangeInsertNode(dom,rng,startBookmarkNode),selection.moveToBookmark({id:id,keep:1}),{id:id}}function TextWalker(startNode,rootNode,isBoundary){function walk(direction){for(var next;(next=walker[direction]())&&!NodeType.isText(next)&&!isBoundary(next););return Option.from(next).filter(NodeType.isText)}void 0===isBoundary&&(isBoundary=never);var walker=new TreeWalker(startNode,rootNode);return{current:function(){return Option.from(walker.current()).filter(NodeType.isText)},next:function(){return walk("next")},prev:function(){return walk("prev")},prev2:function(){return walk("prev2")}}}function TextSeeker(dom,isBoundary){var isBlockBoundary=isBoundary||function(node){return dom.isBlock(node)||NodeType.isBr(node)||NodeType.isContentEditableFalse(node)},walk=function(node,offset,walker,process){if(NodeType.isText(node)){var newOffset=process(node,offset,node.data);if(-1!==newOffset)return Option.some({container:node,offset:newOffset})}return walker().bind(function(next){return walk(next.container,next.offset,walker,process)})};return{backwards:function(node,offset,process,root){var walker=TextWalker(node,root,isBlockBoundary);return walk(node,offset,function(){return walker.prev().map(function(prev){return{container:prev,offset:prev.length}})},process).getOrNull()},forwards:function(node,offset,process,root){var walker=TextWalker(node,root,isBlockBoundary);return walk(node,offset,function(){return walker.next().map(function(next){return{container:next,offset:0}})},process).getOrNull()}}}function isCaretNode(node){return NodeType.isElement(node)&&"_mce_caret"===node.id}function getParentCaretContainer(body,node){for(;node&&node!==body;){if("_mce_caret"===node.id)return node;node=node.parentNode}return null}function removeNode(node){var parentNode=node.parentNode;parentNode&&parentNode.removeChild(node)}function setNodeValue(node,text){0===text.length?removeNode(node):node.nodeValue=text}function trimCount(text){var trimmedText=Zwsp.trim(text);return{count:text.length-trimmedText.length,text:trimmedText}}function removeUnchanged(caretContainer,pos){return remove$5(caretContainer),pos}function removeElementAndReposition(caretContainer,pos){var parentNode=pos.container(),newPosition=function(xs,x){var r=rawIndexOf(xs,x);return-1===r?Option.none():Option.some(r)}(from$1(parentNode.childNodes),caretContainer).map(function(index){return index<pos.offset()?CaretPosition$1(parentNode,pos.offset()-1):pos}).getOr(pos);return remove$5(caretContainer),newPosition}function removeTextCaretContainer(caretContainer,pos){return isText$6(caretContainer)&&pos.container()===caretContainer?function(caretContainer,pos){var before=trimCount(caretContainer.data.substr(0,pos.offset())),after=trimCount(caretContainer.data.substr(pos.offset())),text=before.text+after.text;return 0<text.length?(setNodeValue(caretContainer,text),CaretPosition$1(caretContainer,pos.offset()-before.count)):pos}(caretContainer,pos):removeUnchanged(caretContainer,pos)}function getBodySetting(editor,name,defaultValue){var value=editor.getParam(name,defaultValue);if(-1===value.indexOf("="))return value;var bodyObj=editor.getParam(name,"","hash");return bodyObj.hasOwnProperty(editor.id)?bodyObj[editor.id]:defaultValue}function getAbsoluteClientRect(root,element,before){var docElm,scrollX,scrollY,margin,rootRect,clientRect=collapse(element.getBoundingClientRect(),before);return scrollY="BODY"===root.tagName?(docElm=root.ownerDocument.documentElement,scrollX=root.scrollLeft||docElm.scrollLeft,root.scrollTop||docElm.scrollTop):(rootRect=root.getBoundingClientRect(),scrollX=root.scrollLeft-rootRect.left,root.scrollTop-rootRect.top),clientRect.left+=scrollX,clientRect.right+=scrollX,clientRect.top+=scrollY,clientRect.bottom+=scrollY,clientRect.width=1,0<(margin=element.offsetWidth-element.clientWidth)&&(before&&(margin*=-1),clientRect.left+=margin,clientRect.right+=margin),clientRect}function FakeCaret(editor,root,isBlock,hasFocus){var cursorInterval,caretContainerNode,lastVisualCaret=Cell(Option.none()),rootBlock=Settings_getForcedRootBlock(editor),caretBlock=0<rootBlock.length?rootBlock:"p",hide=function(){!function(root){var contentEditableFalseNodes,node,sibling,i,data;for(contentEditableFalseNodes=DomQuery("*[contentEditable=false]",root),i=0;i<contentEditableFalseNodes.length;i++)sibling=(node=contentEditableFalseNodes[i]).previousSibling,endsWithCaretContainer(sibling)&&(1===(data=sibling.data).length?sibling.parentNode.removeChild(sibling):sibling.deleteData(data.length-1,1)),sibling=node.nextSibling,startsWithCaretContainer(sibling)&&(1===(data=sibling.data).length?sibling.parentNode.removeChild(sibling):sibling.deleteData(0,1))}(root),caretContainerNode&&(CaretContainerRemove.remove(caretContainerNode),caretContainerNode=null),lastVisualCaret.get().each(function(caretState){DomQuery(caretState.caret).remove(),lastVisualCaret.set(Option.none())}),Delay.clearInterval(cursorInterval)},startBlink=function(){cursorInterval=Delay.setInterval(function(){hasFocus()?DomQuery("div.mce-visual-caret",root).toggleClass("mce-visual-caret-hidden"):DomQuery("div.mce-visual-caret",root).addClass("mce-visual-caret-hidden")},500)};return{show:function(before,element){var clientRect,rng;if(hide(),function(node){return NodeType.isElement(node)&&/^(TD|TH)$/i.test(node.tagName)}(element))return null;if(!isBlock(element))return caretContainerNode=function(node,before){var sibling,textNode,parentNode;if(textNode=node.ownerDocument.createTextNode(Zwsp.ZWSP),parentNode=node.parentNode,before){if(sibling=node.previousSibling,isText$2(sibling)){if(isCaretContainer(sibling))return sibling;if(endsWithCaretContainer(sibling))return sibling.splitText(sibling.data.length-1)}parentNode.insertBefore(textNode,node)}else{if(sibling=node.nextSibling,isText$2(sibling)){if(isCaretContainer(sibling))return sibling;if(startsWithCaretContainer(sibling))return sibling.splitText(1),sibling}node.nextSibling?parentNode.insertBefore(textNode,node.nextSibling):parentNode.appendChild(textNode)}return textNode}(element,before),rng=element.ownerDocument.createRange(),isContentEditableFalse$3(caretContainerNode.nextSibling)?(rng.setStart(caretContainerNode,0),rng.setEnd(caretContainerNode,0)):(rng.setStart(caretContainerNode,1),rng.setEnd(caretContainerNode,1)),rng;caretContainerNode=insertBlock(caretBlock,element,before),clientRect=getAbsoluteClientRect(root,element,before),DomQuery(caretContainerNode).css("top",clientRect.top);var caret=DomQuery('<div class="mce-visual-caret" data-mce-bogus="all"></div>').css(clientRect).appendTo(root)[0];return lastVisualCaret.set(Option.some({caret:caret,element:element,before:before})),lastVisualCaret.get().each(function(caretState){before&&DomQuery(caretState.caret).addClass("mce-visual-caret-before")}),startBlink(),(rng=element.ownerDocument.createRange()).setStart(caretContainerNode,0),rng.setEnd(caretContainerNode,0),rng},hide:hide,getCss:function(){return".mce-visual-caret {position: absolute;background-color: black;background-color: currentcolor;}.mce-visual-caret-hidden {display: none;}*[data-mce-caret] {position: absolute;left: -1000px;right: auto;top: 0;margin: 0;padding: 0;}"},reposition:function(){lastVisualCaret.get().each(function(caretState){var clientRect=getAbsoluteClientRect(root,caretState.element,caretState.before);DomQuery(caretState.caret).css(__assign({},clientRect))})},destroy:function(){return Delay.clearInterval(cursorInterval)}}}function isFakeCaretTableBrowser(){return browser$3.isIE()||browser$3.isEdge()||browser$3.isFirefox()}function isFakeCaretTarget(node){return isContentEditableFalse$3(node)||NodeType.isTable(node)&&isFakeCaretTableBrowser()}function isForwards(direction){return 0<direction}function isBackwards(direction){return direction<0}function skipCaretContainers(walk,shallow){for(var node;node=walk(shallow);)if(!isCaretContainerBlock$1(node))return node;return null}function findNode(node,direction,predicateFn,rootNode,shallow){var walker=new TreeWalker(node,rootNode);if(isBackwards(direction)){if((isContentEditableFalse$4(node)||isCaretContainerBlock$1(node))&&predicateFn(node=skipCaretContainers(walker.prev,!0)))return node;for(;node=skipCaretContainers(walker.prev,shallow);)if(predicateFn(node))return node}if(isForwards(direction)){if((isContentEditableFalse$4(node)||isCaretContainerBlock$1(node))&&predicateFn(node=skipCaretContainers(walker.next,!0)))return node;for(;node=skipCaretContainers(walker.next,shallow);)if(predicateFn(node))return node}return null}function getParentBlock(node,rootNode){for(;node&&node!==rootNode;){if(isBlockLike(node))return node;node=node.parentNode}return null}function isInSameBlock(caretPosition1,caretPosition2,rootNode){return getParentBlock(caretPosition1.container(),rootNode)===getParentBlock(caretPosition2.container(),rootNode)}function getChildNodeAtRelativeOffset(relativeOffset,caretPosition){var container,offset;return caretPosition?(container=caretPosition.container(),offset=caretPosition.offset(),isElement$5(container)?container.childNodes[offset+relativeOffset]:null):null}function beforeAfter(before,node){var range=node.ownerDocument.createRange();return before?(range.setStartBefore(node),range.setEndBefore(node)):(range.setStartAfter(node),range.setEndAfter(node)),range}function isNodesInSameBlock(root,node1,node2){return getParentBlock(node1,root)===getParentBlock(node2,root)}function lean(left,root,node){var sibling,siblingName;for(siblingName=left?"previousSibling":"nextSibling";node&&node!==root;){if(sibling=node[siblingName],isCaretContainer$2(sibling)&&(sibling=sibling[siblingName]),isContentEditableFalse$4(sibling)){if(isNodesInSameBlock(root,sibling,node))return sibling;break}if(isCaretCandidate$2(sibling))break;node=node.parentNode}return null}function normalizeRange(direction,root,range){var node,container,offset,location,leanLeft=curry(lean,!0,root),leanRight=curry(lean,!1,root);if(container=range.startContainer,offset=range.startOffset,isCaretContainerBlock(container)){if(isElement$5(container)||(container=container.parentNode),"before"===(location=container.getAttribute("data-mce-caret"))&&(node=container.nextSibling,isFakeCaretTarget(node)))return before$2(node);if("after"===location&&(node=container.previousSibling,isFakeCaretTarget(node)))return after$1(node)}if(!range.collapsed)return range;if(NodeType.isText(container)){if(isCaretContainer$2(container)){if(1===direction){if(node=leanRight(container))return before$2(node);if(node=leanLeft(container))return after$1(node)}if(-1===direction){if(node=leanLeft(container))return after$1(node);if(node=leanRight(container))return before$2(node)}return range}if(endsWithCaretContainer(container)&&offset>=container.data.length-1)return 1===direction&&(node=leanRight(container))?before$2(node):range;if(startsWithCaretContainer(container)&&offset<=1)return-1===direction&&(node=leanLeft(container))?after$1(node):range;if(offset===container.data.length)return(node=leanRight(container))?before$2(node):range;if(0===offset)return(node=leanLeft(container))?after$1(node):range}return range}function getRelativeCefElm(forward,caretPosition){return Option.from(getChildNodeAtRelativeOffset(forward?0:-1,caretPosition)).filter(isContentEditableFalse$4)}function getNormalizedRangeEndPoint(direction,root,range){var normalizedRange=normalizeRange(direction,root,range);return-1===direction?CaretPosition.fromRangeStart(normalizedRange):CaretPosition.fromRangeEnd(normalizedRange)}function getElementFromPosition(pos){return Option.from(pos.getNode()).map(Element.fromDom)}function getVisualCaretPosition(walkFn,caretPosition){for(;caretPosition=walkFn(caretPosition);)if(caretPosition.isVisible())return caretPosition;return caretPosition}function isMoveInsideSameBlock(from,to){var inSameBlock=isInSameBlock(from,to);return!(inSameBlock||!NodeType.isBr(from.getNode()))||inSameBlock}var HDirection,CaretPosition$1=CaretPosition,isText$5=NodeType.isText,isBogus$1=NodeType.isBogus,nodeIndex$1=DOMUtils$1.nodeIndex,normalizedParent=function(node){var parentNode=node.parentNode;return isBogus$1(parentNode)?normalizedParent(parentNode):parentNode},getChildNodes=function(node){return node?ArrUtils.reduce(node.childNodes,function(result,node){return isBogus$1(node)&&"BR"!==node.nodeName?result=result.concat(getChildNodes(node)):result.push(node),result},[]):[]},isContentEditableFalse$2=NodeType.isContentEditableFalse,GetBookmark={getBookmark:function(selection,type,normalized){return 2===type?getOffsetBookmark(Zwsp.trim,normalized,selection):3===type?function(selection){var rng=selection.getRng();return{start:create$2(selection.dom.getRoot(),CaretPosition$1.fromRangeStart(rng)),end:create$2(selection.dom.getRoot(),CaretPosition$1.fromRangeEnd(rng))}}(selection):type?function(selection){return{rng:selection.getRng()}}(selection):getPersistentBookmark(selection,!1)},getUndoBookmark:curry(getOffsetBookmark,identity,!0),getPersistentBookmark:getPersistentBookmark},isElement$4=NodeType.isElement,isText$6=NodeType.isText,remove$5=function(caretContainerNode){if(isElement$4(caretContainerNode)&&isCaretContainer(caretContainerNode)&&(hasContent(caretContainerNode)?caretContainerNode.removeAttribute("data-mce-caret"):removeNode(caretContainerNode)),isText$6(caretContainerNode)){var text=Zwsp.trim(function(node){try{return node.nodeValue}catch(ex){return""}}(caretContainerNode));setNodeValue(caretContainerNode,text)}},CaretContainerRemove={removeAndReposition:function(container,pos){return CaretPosition$1.isTextPosition(pos)?removeTextCaretContainer(container,pos):function(caretContainer,pos){return pos.container()===caretContainer.parentNode?removeElementAndReposition(caretContainer,pos):removeUnchanged(caretContainer,pos)}(container,pos)},remove:remove$5},DOM$1=DOMUtils$1.DOM,Settings_getIframeAttrs=function(editor){return editor.getParam("iframe_attrs",{})},Settings_getDocType=function(editor){return editor.getParam("doctype","<!DOCTYPE html>")},Settings_getDocumentBaseUrl=function(editor){return editor.getParam("document_base_url","")},Settings_getBodyId=function(editor){return getBodySetting(editor,"body_id","tinymce")},Settings_getBodyClass=function(editor){return getBodySetting(editor,"body_class","")},Settings_getContentSecurityPolicy=function(editor){return editor.getParam("content_security_policy","")},Settings_shouldPutBrInPre=function(editor){return editor.getParam("br_in_pre",!0)},Settings_getForcedRootBlock=function(editor){if(editor.getParam("force_p_newlines",!1))return"p";var block=editor.getParam("forced_root_block","p");return!1===block?"":!0===block?"p":block},Settings_getForcedRootBlockAttrs=function(editor){return editor.getParam("forced_root_block_attrs",{})},Settings_getBrNewLineSelector=function(editor){return editor.getParam("br_newline_selector",".mce-toc h2,figcaption,caption")},Settings_getNoNewLineSelector=function(editor){return editor.getParam("no_newline_selector","")},Settings_shouldKeepStyles=function(editor){return editor.getParam("keep_styles",!0)},Settings_shouldEndContainerOnEmptyBlock=function(editor){return editor.getParam("end_container_on_empty_block",!1)},Settings_getFontStyleValues=function(editor){return Tools.explode(editor.getParam("font_size_style_values","xx-small,x-small,small,medium,large,x-large,xx-large"))},Settings_getFontSizeClasses=function(editor){return Tools.explode(editor.getParam("font_size_classes",""))},Settings_getIconPackName=function(editor){return editor.getParam("icons","","string")},Settings_getIconsUrl=function(editor){return editor.getParam("icons_url","","string")},Settings_getImagesDataImgFilter=function(editor){return editor.getParam("images_dataimg_filter",constant(!0),"function")},Settings_isAutomaticUploadsEnabled=function(editor){return editor.getParam("automatic_uploads",!0,"boolean")},Settings_shouldReuseFileName=function(editor){return editor.getParam("images_reuse_filename",!1,"boolean")},Settings_shouldReplaceBlobUris=function(editor){return editor.getParam("images_replace_blob_uris",!0,"boolean")},Settings_getImageUploadUrl=function(editor){return editor.getParam("images_upload_url","","string")},Settings_getImageUploadBasePath=function(editor){return editor.getParam("images_upload_base_path","","string")},Settings_getImagesUploadCredentials=function(editor){return editor.getParam("images_upload_credentials",!1,"boolean")},Settings_getImagesUploadHandler=function(editor){return editor.getParam("images_upload_handler",null,"function")},Settings_shouldUseContentCssCors=function(editor){return editor.getParam("content_css_cors",!1,"boolean")},Settings_getReferrerPolicy=function(editor){return editor.getParam("referrer_policy","","string")},Settings_getLanguageCode=function(editor){return editor.getParam("language","en","string")},Settings_getLanguageUrl=function(editor){return editor.getParam("language_url","","string")},Settings_shouldIndentUseMargin=function(editor){return editor.getParam("indent_use_margin",!1)},Settings_getIndentation=function(editor){return editor.getParam("indentation","40px","string")},Settings_getContentCss=function(editor){var contentCss=editor.settings.content_css;return isString(contentCss)?map(contentCss.split(","),trim):isArray(contentCss)?contentCss:!1===contentCss||editor.inline?[]:["default"]},Settings_getDirectionality=function(editor){return editor.getParam("directionality",I18n.isRtl()?"rtl":void 0)},Settings_getInlineBoundarySelector=function(editor){return editor.getParam("inline_boundaries_selector","a[href],code,.mce-annotation","string")},Settings_getObjectResizing=function(editor){return editor.getParam("object_resizing")},Settings_getResizeImgProportional=function(editor){return editor.getParam("resize_img_proportional",!0,"boolean")},Settings_getPlaceholder=function(editor){return editor.getParam("placeholder",DOM$1.getAttrib(editor.getElement(),"placeholder"),"string")},browser$3=detect$3().browser,isContentEditableFalse$3=NodeType.isContentEditableFalse,isContentEditableFalse$4=NodeType.isContentEditableFalse,isBlockLike=NodeType.matchStyleValues("display","block table table-cell table-caption list-item"),isCaretContainer$2=isCaretContainer,isCaretContainerBlock$1=isCaretContainerBlock,isElement$5=NodeType.isElement,isCaretCandidate$2=isCaretCandidate,before$2=curry(beforeAfter,!0),after$1=curry(beforeAfter,!1);!function(HDirection){HDirection[HDirection.Backwards=-1]="Backwards",HDirection[HDirection.Forwards=1]="Forwards"}(HDirection=HDirection||{});function nodeAtIndex(container,offset){return container.hasChildNodes()&&offset<container.childNodes.length?container.childNodes[offset]:null}function getCaretCandidatePosition(direction,node){if(isForwards(direction)){if(isCaretCandidate$3(node.previousSibling)&&!isText$7(node.previousSibling))return CaretPosition$1.before(node);if(isText$7(node))return CaretPosition$1(node,0)}if(isBackwards(direction)){if(isCaretCandidate$3(node.nextSibling)&&!isText$7(node.nextSibling))return CaretPosition$1.after(node);if(isText$7(node))return CaretPosition$1(node,node.data.length)}return isBackwards(direction)?isBr$4(node)?CaretPosition$1.before(node):CaretPosition$1.after(node):CaretPosition$1.before(node)}function CaretWalker(root){return{next:function(caretPosition){return findCaretPosition(HDirection.Forwards,caretPosition,root)},prev:function(caretPosition){return findCaretPosition(HDirection.Backwards,caretPosition,root)}}}function isBeforeOrStart(position){return CaretPosition$1.isTextPosition(position)?0===position.offset():isCaretCandidate(position.getNode())}function isAfterOrEnd(position){if(CaretPosition$1.isTextPosition(position)){var container=position.container();return position.offset()===container.data.length}return isCaretCandidate(position.getNode(!0))}function isBeforeAfterSameElement(from,to){return!CaretPosition$1.isTextPosition(from)&&!CaretPosition$1.isTextPosition(to)&&from.getNode()===to.getNode(!0)}function shouldSkipPosition(forward,from,to){return forward?!isBeforeAfterSameElement(from,to)&&!function(position){return!CaretPosition$1.isTextPosition(position)&&NodeType.isBr(position.getNode())}(from)&&isAfterOrEnd(from)&&isBeforeOrStart(to):!isBeforeAfterSameElement(to,from)&&isBeforeOrStart(from)&&isAfterOrEnd(to)}function navigate(forward,root,from){return fromPosition(forward,root,from).bind(function(to){return isInSameBlock(from,to,root)&&shouldSkipPosition(forward,from,to)?fromPosition(forward,root,to):Option.some(to)})}function positionIn(forward,element){var startNode=forward?element.firstChild:element.lastChild;return NodeType.isText(startNode)?Option.some(CaretPosition$1(startNode,forward?0:startNode.data.length)):startNode?isCaretCandidate(startNode)?Option.some(forward?CaretPosition$1.before(startNode):function(node){return NodeType.isBr(node)?CaretPosition$1.before(node):CaretPosition$1.after(node)}(startNode)):function(forward,root,start){var position=forward?CaretPosition$1.before(start):CaretPosition$1.after(start);return fromPosition(forward,root,position)}(forward,element,startNode):Option.none()}function addBogus(dom,node){return NodeType.isElement(node)&&dom.isBlock(node)&&!node.innerHTML&&!Env.ie&&(node.innerHTML='<br data-mce-bogus="1" />'),node}function tryFindRangePosition(node,rng){return CaretFinder.lastPositionIn(node).fold(function(){return!1},function(pos){return rng.setStart(pos.container(),pos.offset()),rng.setEnd(pos.container(),pos.offset()),!0})}function padEmptyCaretContainer(root,node,rng){return!(!function(node){return!1===node.hasChildNodes()}(node)||!getParentCaretContainer(root,node))&&(function(node,rng){var textNode=node.ownerDocument.createTextNode(Zwsp.ZWSP);node.appendChild(textNode),rng.setStart(textNode,0),rng.setEnd(textNode,0)}(node,rng),!0)}function setEndPoint(dom,start,bookmark,rng){var i,node,offset,children,point=bookmark[start?"start":"end"],root=dom.getRoot();if(point){for(offset=point[0],node=root,i=point.length-1;1<=i;i--){if(children=node.childNodes,padEmptyCaretContainer(root,node,rng))return!0;if(point[i]>children.length-1)return!!padEmptyCaretContainer(root,node,rng)||tryFindRangePosition(node,rng);node=children[point[i]]}3===node.nodeType&&(offset=Math.min(point[0],node.nodeValue.length)),1===node.nodeType&&(offset=Math.min(point[0],node.childNodes.length)),start?rng.setStart(node,offset):rng.setEnd(node,offset)}return!0}function isValidTextNode(node){return NodeType.isText(node)&&0<node.data.length}function restoreEndPoint(dom,suffix,bookmark){var node,idx,next,prev,container,offset,marker=dom.get(bookmark.id+"_"+suffix),keep=bookmark.keep;if(marker){if(node=marker.parentNode,offset=(container=(idx="start"===suffix?keep?marker.hasChildNodes()?(node=marker.firstChild,1):isValidTextNode(marker.nextSibling)?(node=marker.nextSibling,0):isValidTextNode(marker.previousSibling)?(node=marker.previousSibling,marker.previousSibling.data.length):(node=marker.parentNode,dom.nodeIndex(marker)+1):dom.nodeIndex(marker):keep?marker.hasChildNodes()?(node=marker.firstChild,1):isValidTextNode(marker.previousSibling)?(node=marker.previousSibling,marker.previousSibling.data.length):(node=marker.parentNode,dom.nodeIndex(marker)):dom.nodeIndex(marker),node),idx),!keep){for(prev=marker.previousSibling,next=marker.nextSibling,Tools.each(Tools.grep(marker.childNodes),function(node){NodeType.isText(node)&&(node.nodeValue=node.nodeValue.replace(/\uFEFF/g,""))});marker=dom.get(bookmark.id+"_"+suffix);)dom.remove(marker,!0);prev&&next&&prev.nodeType===next.nodeType&&NodeType.isText(prev)&&!Env.opera&&(idx=prev.nodeValue.length,prev.appendData(next.nodeValue),dom.remove(next),offset=(container=prev,idx))}return Option.some(CaretPosition$1(container,offset))}return Option.none()}function isWhiteSpace$1(chr){return""!==chr&&-1!==" \f\n\r\t\v".indexOf(chr)}function isContent(chr){return!isWhiteSpace$1(chr)&&!isNbsp(chr)}function isNode(node){return!!node.nodeType}function moveStart(dom,selection,rng){var walker,node,nodes,offset=rng.startOffset,container=rng.startContainer;if((rng.startContainer!==rng.endContainer||!function(node){return node&&/^(IMG)$/.test(node.nodeName)}(rng.startContainer.childNodes[rng.startOffset]))&&1===container.nodeType)for(offset<(nodes=container.childNodes).length?(container=nodes[offset],walker=new TreeWalker(container,dom.getParent(container,dom.isBlock))):(container=nodes[nodes.length-1],(walker=new TreeWalker(container,dom.getParent(container,dom.isBlock))).next(!0)),node=walker.current();node;node=walker.next())if(3===node.nodeType&&!isWhiteSpaceNode(node))return rng.setStart(node,0),void selection.setRng(rng)}function getNonWhiteSpaceSibling(node,next,inc){if(node){var nextName=next?"nextSibling":"previousSibling";for(node=inc?node:node[nextName];node;node=node[nextName])if(1===node.nodeType||!isWhiteSpaceNode(node))return node}}function isTextBlock$1(editor,name){return isNode(name)&&(name=name.nodeName),!!editor.schema.getTextBlockElements()[name.toLowerCase()]}function isValid(ed,parent,child){return ed.schema.isValidChild(parent,child)}function replaceVars(value,vars){return"string"!=typeof value?value=value(vars):vars&&(value=value.replace(/%(\w+)/g,function(str,name){return vars[name]||str})),value}function isEq(str1,str2){return str1=""+((str1=str1||"").nodeName||str1),str2=""+((str2=str2||"").nodeName||str2),str1.toLowerCase()===str2.toLowerCase()}function normalizeStyleValue(dom,value,name){return"color"!==name&&"backgroundColor"!==name||(value=dom.toHex(value)),"fontWeight"===name&&700===value&&(value="bold"),"fontFamily"===name&&(value=value.replace(/[\'\"]/g,"").replace(/,\s+/g,",")),""+value}function getStyle(dom,node,name){return normalizeStyleValue(dom,dom.getStyle(node,name),name)}function getTextDecoration(dom,node){var decoration;return dom.getParent(node,function(n){return(decoration=dom.getStyle(n,"text-decoration"))&&"none"!==decoration}),decoration}function getParents$1(dom,node,selector){return dom.getParents(node,selector,dom.getRoot())}function findParentContentEditable(dom,node){for(var parent=node;parent;){if(NodeType.isElement(parent)&&dom.getContentEditable(parent))return"false"===dom.getContentEditable(parent)?parent:node;parent=parent.parentNode}return node}function walkText(start,node,offset,predicate){for(var str=node.data,i=offset;start?0<=i:i<str.length;start?i--:i++)if(predicate(str.charAt(i)))return start?i+1:i;return-1}function findSpace(start,node,offset){return walkText(start,node,offset,function(c){return isNbsp(c)||isWhiteSpace$1(c)})}function findContent(start,node,offset){return walkText(start,node,offset,isContent)}function findWordEndPoint(dom,body,container,offset,start,includeTrailingSpaces){function walk(container,offset,pred){var textSeeker=TextSeeker(dom),walker=start?textSeeker.backwards:textSeeker.forwards;return Option.from(walker(container,offset,function(text,textOffset){return isBookmarkNode$2(text.parentNode)?-1:pred(start,lastTextNode=text,textOffset)},rootNode))}var lastTextNode,rootNode=dom.getParent(container,dom.isBlock)||body;return walk(container,offset,findSpace).bind(function(result){return includeTrailingSpaces?walk(result.container,result.offset+(start?-1:0),findContent):Option.some(result)}).orThunk(function(){return lastTextNode?Option.some({container:lastTextNode,offset:start?0:lastTextNode.length}):Option.none()})}function findSelectorEndPoint(dom,format,rng,container,siblingName){NodeType.isText(container)&&0===container.nodeValue.length&&container[siblingName]&&(container=container[siblingName]);for(var parents=getParents$2(dom,container),i=0;i<parents.length;i++)for(var y=0;y<format.length;y++){var curFormat=format[y];if(!("collapsed"in curFormat&&curFormat.collapsed!==rng.collapsed)&&dom.is(parents[i],curFormat.selector))return parents[i]}return container}function findBlockEndPoint(editor,format,container,siblingName){var node,dom=editor.dom,root=dom.getRoot();if(format[0].wrapper||(node=dom.getParent(container,format[0].block,root)),!node){var scopeRoot=dom.getParent(container,"LI,TD,TH");node=dom.getParent(NodeType.isText(container)?container.parentNode:container,function(node){return node!==root&&isTextBlock$2(editor,node)},scopeRoot)}if(node&&format[0].wrapper&&(node=getParents$2(dom,node,"ul,ol").reverse()[0]||node),!node)for(node=container;node[siblingName]&&!dom.isBlock(node[siblingName])&&(node=node[siblingName],!isEq(node,"br")););return node||container}function findParentContainer(dom,format,startContainer,startOffset,endContainer,endOffset,start){var container,parent,sibling,siblingName,root,node;if(container=parent=start?startContainer:endContainer,siblingName=start?"previousSibling":"nextSibling",root=dom.getRoot(),NodeType.isText(container)&&!isWhiteSpaceNode$1(container)&&(start?0<startOffset:endOffset<container.nodeValue.length))return container;for(;;){if(!format[0].block_expand&&dom.isBlock(parent))return parent;for(sibling=parent[siblingName];sibling;sibling=sibling[siblingName])if(!isBookmarkNode$2(sibling)&&!isWhiteSpaceNode$1(sibling)&&("BR"!==(node=sibling).nodeName||!node.getAttribute("data-mce-bogus")||node.nextSibling))return parent;if(parent===root||parent.parentNode===root){container=parent;break}parent=parent.parentNode}return container}function expandRng(editor,rng,format,includeTrailingSpace){void 0===includeTrailingSpace&&(includeTrailingSpace=!1);var startContainer=rng.startContainer,startOffset=rng.startOffset,endContainer=rng.endContainer,endOffset=rng.endOffset,dom=editor.dom;return NodeType.isElement(startContainer)&&startContainer.hasChildNodes()&&(startContainer=getNode(startContainer,startOffset),NodeType.isText(startContainer)&&(startOffset=0)),NodeType.isElement(endContainer)&&endContainer.hasChildNodes()&&(endContainer=getNode(endContainer,rng.collapsed?endOffset:endOffset-1),NodeType.isText(endContainer)&&(endOffset=endContainer.nodeValue.length)),startContainer=findParentContentEditable(dom,startContainer),endContainer=findParentContentEditable(dom,endContainer),(isBookmarkNode$2(startContainer.parentNode)||isBookmarkNode$2(startContainer))&&(startContainer=isBookmarkNode$2(startContainer)?startContainer:startContainer.parentNode,startContainer=rng.collapsed?startContainer.previousSibling||startContainer:startContainer.nextSibling||startContainer,NodeType.isText(startContainer)&&(startOffset=rng.collapsed?startContainer.length:0)),(isBookmarkNode$2(endContainer.parentNode)||isBookmarkNode$2(endContainer))&&(endContainer=isBookmarkNode$2(endContainer)?endContainer:endContainer.parentNode,endContainer=rng.collapsed?endContainer.nextSibling||endContainer:endContainer.previousSibling||endContainer,NodeType.isText(endContainer)&&(endOffset=rng.collapsed?0:endContainer.length)),rng.collapsed&&(findWordEndPoint(dom,editor.getBody(),startContainer,startOffset,!0,includeTrailingSpace).each(function(_a){var container=_a.container,offset=_a.offset;startContainer=container,startOffset=offset}),findWordEndPoint(dom,editor.getBody(),endContainer,endOffset,!1,includeTrailingSpace).each(function(_a){var container=_a.container,offset=_a.offset;endContainer=container,endOffset=offset})),(format[0].inline||format[0].block_expand)&&(format[0].inline&&NodeType.isText(startContainer)&&0!==startOffset||(startContainer=findParentContainer(dom,format,startContainer,startOffset,endContainer,endOffset,!0)),format[0].inline&&NodeType.isText(endContainer)&&endOffset!==endContainer.nodeValue.length||(endContainer=findParentContainer(dom,format,startContainer,startOffset,endContainer,endOffset,!1))),format[0].selector&&!1!==format[0].expand&&!format[0].inline&&(startContainer=findSelectorEndPoint(dom,format,rng,startContainer,"previousSibling"),endContainer=findSelectorEndPoint(dom,format,rng,endContainer,"nextSibling")),(format[0].block||format[0].selector)&&(startContainer=findBlockEndPoint(editor,format,startContainer,"previousSibling"),endContainer=findBlockEndPoint(editor,format,endContainer,"nextSibling"),format[0].block&&(dom.isBlock(startContainer)||(startContainer=findParentContainer(dom,format,startContainer,startOffset,endContainer,endOffset,!0)),dom.isBlock(endContainer)||(endContainer=findParentContainer(dom,format,startContainer,startOffset,endContainer,endOffset,!1)))),NodeType.isElement(startContainer)&&(startOffset=dom.nodeIndex(startContainer),startContainer=startContainer.parentNode),NodeType.isElement(endContainer)&&(endOffset=dom.nodeIndex(endContainer)+1,endContainer=endContainer.parentNode),{startContainer:startContainer,startOffset:startOffset,endContainer:endContainer,endOffset:endOffset}}function clampToExistingChildren(container,index){var childNodes=container.childNodes;return index>=childNodes.length?index=childNodes.length-1:index<0&&(index=0),childNodes[index]||container}var expected,isContentEditableFalse$5=NodeType.isContentEditableFalse,isText$7=NodeType.isText,isElement$6=NodeType.isElement,isBr$4=NodeType.isBr,isCaretCandidate$3=isCaretCandidate,isAtomic$1=function(node){return isAtomicInline(node)||function(node){return!!isNonUiContentEditableFalse(node)&&!0!==foldl(from$1(node.getElementsByTagName("*")),function(result,elm){return result||isContentEditableTrue$1(elm)},!1)}(node)},isEditableCaretCandidate$1=isEditableCaretCandidate,findCaretPosition=function(direction,startPos,root){var node,nextNode,innerNode,rootContentEditableFalseElm,caretPosition;if(!isElement$6(root)||!startPos)return null;if(startPos.isEqual(CaretPosition$1.after(root))&&root.lastChild){if(caretPosition=CaretPosition$1.after(root.lastChild),isBackwards(direction)&&isCaretCandidate$3(root.lastChild)&&isElement$6(root.lastChild))return isBr$4(root.lastChild)?CaretPosition$1.before(root.lastChild):caretPosition}else caretPosition=startPos;var container=caretPosition.container(),offset=caretPosition.offset();if(isText$7(container)){if(isBackwards(direction)&&0<offset)return CaretPosition$1(container,--offset);if(isForwards(direction)&&offset<container.length)return CaretPosition$1(container,++offset);node=container}else{if(isBackwards(direction)&&0<offset&&(nextNode=nodeAtIndex(container,offset-1),isCaretCandidate$3(nextNode)))return!isAtomic$1(nextNode)&&(innerNode=findNode(nextNode,direction,isEditableCaretCandidate$1,nextNode))?isText$7(innerNode)?CaretPosition$1(innerNode,innerNode.data.length):CaretPosition$1.after(innerNode):isText$7(nextNode)?CaretPosition$1(nextNode,nextNode.data.length):CaretPosition$1.before(nextNode);if(isForwards(direction)&&offset<container.childNodes.length&&(nextNode=nodeAtIndex(container,offset),isCaretCandidate$3(nextNode)))return isBr$4(nextNode)?function(root,nextNode){var nextSibling=nextNode.nextSibling;return nextSibling&&isCaretCandidate$3(nextSibling)?isText$7(nextSibling)?CaretPosition$1(nextSibling,0):CaretPosition$1.before(nextSibling):findCaretPosition(HDirection.Forwards,CaretPosition$1.after(nextNode),root)}(root,nextNode):!isAtomic$1(nextNode)&&(innerNode=findNode(nextNode,direction,isEditableCaretCandidate$1,nextNode))?isText$7(innerNode)?CaretPosition$1(innerNode,0):CaretPosition$1.before(innerNode):isText$7(nextNode)?CaretPosition$1(nextNode,0):CaretPosition$1.after(nextNode);node=nextNode||caretPosition.getNode()}return(isForwards(direction)&&caretPosition.isAtEnd()||isBackwards(direction)&&caretPosition.isAtStart())&&(node=findNode(node,direction,constant(!0),root,!0),isEditableCaretCandidate$1(node,root))?getCaretCandidatePosition(direction,node):(nextNode=findNode(node,direction,isEditableCaretCandidate$1,root),!(rootContentEditableFalseElm=ArrUtils.last(filter(function(node,root){for(var parents=[];node&&node!==root;)parents.push(node),node=node.parentNode;return parents}(container,root),isContentEditableFalse$5)))||nextNode&&rootContentEditableFalseElm.contains(nextNode)?nextNode?getCaretCandidatePosition(direction,nextNode):null:caretPosition=isForwards(direction)?CaretPosition$1.after(rootContentEditableFalseElm):CaretPosition$1.before(rootContentEditableFalseElm))},fromPosition=function(forward,root,pos){var walker=CaretWalker(root);return Option.from(forward?walker.next(pos):walker.prev(pos))},navigateIgnore=function(forward,root,from,ignoreFilter){return navigate(forward,root,from).bind(function(pos){return ignoreFilter(pos)?navigateIgnore(forward,root,pos,ignoreFilter):Option.some(pos)})},nextPosition=curry(fromPosition,!0),prevPosition=curry(fromPosition,!1),CaretFinder={fromPosition:fromPosition,nextPosition:nextPosition,prevPosition:prevPosition,navigate:navigate,navigateIgnore:navigateIgnore,positionIn:positionIn,firstPositionIn:curry(positionIn,!0),lastPositionIn:curry(positionIn,!1)},ResolveBookmark_resolve=function(selection,bookmark){var dom=selection.dom;if(bookmark){if(function(bookmark){return Tools.isArray(bookmark.start)}(bookmark))return function(dom,bookmark){var rng=dom.createRng();return setEndPoint(dom,!0,bookmark,rng)&&setEndPoint(dom,!1,bookmark,rng)?Option.some(rng):Option.none()}(dom,bookmark);if(function(bookmark){return"string"==typeof bookmark.start}(bookmark))return Option.some(function(dom,bookmark){var rng,pos;return rng=dom.createRng(),pos=resolve$1(dom.getRoot(),bookmark.start),rng.setStart(pos.container(),pos.offset()),pos=resolve$1(dom.getRoot(),bookmark.end),rng.setEnd(pos.container(),pos.offset()),rng}(dom,bookmark));if(function(bookmark){return bookmark.hasOwnProperty("id")}(bookmark))return function(dom,bookmark){var startPos=restoreEndPoint(dom,"start",bookmark),endPos=restoreEndPoint(dom,"end",bookmark);return lift2(startPos,endPos.or(startPos),function(spos,epos){var rng=dom.createRng();return rng.setStart(addBogus(dom,spos.container()),spos.offset()),rng.setEnd(addBogus(dom,epos.container()),epos.offset()),rng})}(dom,bookmark);if(function(bookmark){return bookmark.hasOwnProperty("name")}(bookmark))return function(dom,bookmark){return Option.from(dom.select(bookmark.name)[bookmark.index]).map(function(elm){var rng=dom.createRng();return rng.selectNode(elm),rng})}(dom,bookmark);if(function(bookmark){return bookmark.hasOwnProperty("rng")}(bookmark))return Option.some(bookmark.rng)}return Option.none()},Bookmarks_getBookmark=function(selection,type,normalized){return GetBookmark.getBookmark(selection,type,normalized)},Bookmarks_moveToBookmark=function(selection,bookmark){ResolveBookmark_resolve(selection,bookmark).each(function(rng){selection.setRng(rng)})},Bookmarks_isBookmarkNode=function(node){return NodeType.isElement(node)&&"SPAN"===node.tagName&&"bookmark"===node.getAttribute("data-mce-type")},isNbsp=(expected="",function(actual){return expected===actual}),isWhiteSpaceNode=function(node){return node&&NodeType.isText(node)&&/^([\t \r\n]+|)$/.test(node.nodeValue)},isBookmarkNode$2=Bookmarks_isBookmarkNode,getParents$2=getParents$1,isWhiteSpaceNode$1=isWhiteSpaceNode,isTextBlock$2=isTextBlock$1,each$7=Tools.each,RangeWalk_walk=function(dom,rng,callback){var startContainer=rng.startContainer,startOffset=rng.startOffset,endContainer=rng.endContainer,endOffset=rng.endOffset,nodes=dom.select("td[data-mce-selected],th[data-mce-selected]");if(0<nodes.length)each$7(nodes,function(node){callback([node])});else{var exclude=function(nodes){var node;return 3===(node=nodes[0]).nodeType&&node===startContainer&&startOffset>=node.nodeValue.length&&nodes.splice(0,1),node=nodes[nodes.length-1],0===endOffset&&0<nodes.length&&node===endContainer&&3===node.nodeType&&nodes.splice(nodes.length-1,1),nodes},collectSiblings=function(node,name,endNode){for(var siblings=[];node&&node!==endNode;node=node[name])siblings.push(node);return siblings},findEndPoint=function(node,root){do{if(node.parentNode===root)return node;node=node.parentNode}while(node)},walkBoundary=function(startNode,endNode,next){for(var siblingName=next?"nextSibling":"previousSibling",node=startNode,parent_1=node.parentNode;node&&node!==endNode;node=parent_1){parent_1=node.parentNode;var siblings_1=collectSiblings(node===startNode?node:node[siblingName],siblingName);siblings_1.length&&(next||siblings_1.reverse(),callback(exclude(siblings_1)))}};if(1===startContainer.nodeType&&startContainer.hasChildNodes()&&(startContainer=clampToExistingChildren(startContainer,startOffset)),1===endContainer.nodeType&&endContainer.hasChildNodes()&&(endContainer=function(container,index){return clampToExistingChildren(container,index-1)}(endContainer,endOffset)),startContainer===endContainer)return callback(exclude([startContainer]));for(var ancestor=dom.findCommonAncestor(startContainer,endContainer),node=startContainer;node;node=node.parentNode){if(node===endContainer)return walkBoundary(startContainer,ancestor,!0);if(node===ancestor)break}for(node=endContainer;node;node=node.parentNode){if(node===startContainer)return walkBoundary(endContainer,ancestor);if(node===ancestor)break}var startPoint=findEndPoint(startContainer,ancestor)||startContainer,endPoint=findEndPoint(endContainer,ancestor)||endContainer;walkBoundary(startContainer,startPoint,!0);var siblings=collectSiblings(startPoint===startContainer?startPoint:startPoint.nextSibling,"nextSibling",endPoint===endContainer?endPoint.nextSibling:endPoint);siblings.length&&callback(exclude(siblings)),walkBoundary(endContainer,endPoint)}};function get$7(element){return api.get(element)}function context(editor,elem,wrapName,nodeName){return parent(elem).fold(function(){return"skipping"},function(parent){return"br"===nodeName||function(elem){return isText(elem)&&"\ufeff"===get$7(elem)}(elem)?"valid":function(elem){return isElement(elem)&&has$2(elem,annotation())}(elem)?"existing":isCaretNode(elem)?"caret":isValid(editor,wrapName,nodeName)&&isValid(editor,name(parent),wrapName)?"valid":"invalid-child"})}function makeAnnotation(eDoc,_a,annotationName,decorate){var _b=_a.uid,uid=void 0===_b?function(prefix){var time=(new Date).getTime();return prefix+"_"+Math.floor(1e9*Math.random())+ ++unique+String(time)}("mce-annotation"):_b,data=function(s,e){var t={};for(var p in s)Object.prototype.hasOwnProperty.call(s,p)&&e.indexOf(p)<0&&(t[p]=s[p]);if(null!=s&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(p=Object.getOwnPropertySymbols(s);i<p.length;i++)e.indexOf(p[i])<0&&Object.prototype.propertyIsEnumerable.call(s,p[i])&&(t[p[i]]=s[p[i]])}return t}(_a,["uid"]),master=Element.fromTag("span",eDoc);add$3(master,annotation()),set(master,""+dataAnnotationId(),uid),set(master,""+dataAnnotation(),annotationName);var _c=decorate(uid,data),_d=_c.attributes,attributes=void 0===_d?{}:_d,_e=_c.classes,classes=void 0===_e?[]:_e;return setAll(master,attributes),function(element,classes){each(classes,function(x){add$3(element,x)})}(master,classes),master}function annotate(editor,rng,annotationName,decorate,data){function finishWrapper(){wrapper.set(Option.none())}function processElements(elems){each(elems,processElement)}var newWrappers=[],master=makeAnnotation(editor.getDoc(),data,annotationName,decorate),wrapper=Cell(Option.none()),processElement=function(elem){switch(context(editor,elem,"span",name(elem))){case"invalid-child":finishWrapper();var children$1=children(elem);processElements(children$1),finishWrapper();break;case"valid":!function(element,wrapper){before(element,wrapper),append(wrapper,element)}(elem,wrapper.get().getOrThunk(function(){var nu=shallow(master);return newWrappers.push(nu),wrapper.set(Option.some(nu)),nu}))}};return RangeWalk_walk(editor.dom,rng,function(nodes){finishWrapper(),function(nodes){var elems=map(nodes,Element.fromDom);processElements(elems)}(nodes)}),newWrappers}function annotateWithBookmark(editor,name,settings,data){editor.undoManager.transact(function(){var initialRng=editor.selection.getRng();if(initialRng.collapsed&&function(editor,rng){var r=expandRng(editor,rng,[{inline:!0}]);rng.setStart(r.startContainer,r.startOffset),rng.setEnd(r.endContainer,r.endOffset),editor.selection.setRng(rng)}(editor,initialRng),editor.selection.getRng().collapsed){var wrapper=makeAnnotation(editor.getDoc(),data,name,settings.decorate);set$1(wrapper,""),editor.selection.getRng().insertNode(wrapper.dom()),editor.selection.select(wrapper.dom())}else{var bookmark=GetBookmark.getPersistentBookmark(editor.selection,!1),rng=editor.selection.getRng();annotate(editor,rng,name,settings.decorate,data),editor.selection.moveToBookmark(bookmark)}})}function Annotator(editor){var registry=function(){var annotations={};return{register:function(name,settings){annotations[name]={name:name,settings:settings}},lookup:function(name){return annotations.hasOwnProperty(name)?Option.from(annotations[name]).map(function(a){return a.settings}):Option.none()}}}();setup$1(editor,registry);var changes=setup(editor);return{register:function(name,settings){registry.register(name,settings)},annotate:function(name,data){registry.lookup(name).each(function(settings){annotateWithBookmark(editor,name,settings,data)})},annotationChanged:function(name,callback){changes.addListener(name,callback)},remove:function(name){identify(editor,Option.some(name)).each(function(_a){var elements=_a.elements;each(elements,unwrap)})},getAll:function(name){var directory=function(editor,name){var body=Element.fromDom(editor.getBody()),markers=descendants$1(body,"["+dataAnnotation()+'="'+name+'"]'),directory={};return each(markers,function(m){var uid=get$3(m,dataAnnotationId()),nodesAlready=directory.hasOwnProperty(uid)?directory[uid]:[];directory[uid]=nodesAlready.concat([m])}),directory}(editor,name);return map$1(directory,function(elems){return map(elems,function(elem){return elem.dom()})})}}}function walk$2(node,root,prev){var startName=prev?"lastChild":"firstChild",siblingName=prev?"prev":"next";if(node[startName])return node[startName];if(node!==root){var sibling=node[siblingName];if(sibling)return sibling;for(var parent_1=node.parent;parent_1&&parent_1!==root;parent_1=parent_1.parent)if(sibling=parent_1[siblingName])return sibling}}function isEmptyTextNode$1(node){if(!whiteSpaceRegExp$3.test(node.value))return!1;var parentNode=node.parent;return!parentNode||"span"===parentNode.name&&!parentNode.attr("style")||!/^[ ]+$/.test(node.value)}function isNonEmptyElement(node){var isNamedAnchor="a"===node.name&&!node.attr("href")&&node.attr("id");return node.attr("name")||node.attr("id")&&!node.firstChild||node.attr("data-mce-bookmark")||isNamedAnchor}function findEndTagIndex(schema,html,startIndex){var index,matches,tokenRegExp,shortEndedElements,count=1;for(shortEndedElements=schema.getShortEndedElements(),(tokenRegExp=/<([!?\/])?([A-Za-z0-9\-_\:\.]+)((?:\s+[^"\'>]+(?:(?:"[^"]*")|(?:\'[^\']*\')|[^>]*))*|\/|\s+)>/g).lastIndex=index=startIndex;matches=tokenRegExp.exec(html);){if(index=tokenRegExp.lastIndex,"/"===matches[1])count--;else if(!matches[1]){if(matches[2]in shortEndedElements)continue;count++}if(0===count)break}return index}function checkBogusAttribute(regExp,attrString){var matches=regExp.exec(attrString);if(matches){var name_1=matches[1],value=matches[2];return"string"==typeof name_1&&"data-mce-bogus"===name_1.toLowerCase()?value:null}return null}var api=function(is,name){var getOption=function(element){return is(element)?Option.from(element.dom().nodeValue):Option.none()};return{get:function(element){if(!is(element))throw new Error("Can only get "+name+" value of a "+name+" node");return getOption(element).getOr("")},getOption:getOption,set:function(element,value){if(!is(element))throw new Error("Can only set raw "+name+" value of a "+name+" node");element.dom().nodeValue=value}}}(isText,"text"),whiteSpaceRegExp$3=/^[ \t\r\n]*$/,typeLookup={"#text":3,"#comment":8,"#cdata":4,"#pi":7,"#doctype":10,"#document-fragment":11},Node$1=function(){function Node(name,type){this.name=name,1===(this.type=type)&&(this.attributes=[],this.attributes.map={})}return Node.create=function(name,attrs){var node=new Node(name,typeLookup[name]||1);if(attrs)for(var attrName in attrs)node.attr(attrName,attrs[attrName]);return node},Node.prototype.replace=function(node){return node.parent&&node.remove(),this.insert(node,this),this.remove(),this},Node.prototype.attr=function(name,value){var attrs;if("string"!=typeof name){for(var key in name)this.attr(key,name[key]);return this}if(attrs=this.attributes){if(void 0===value)return attrs.map[name];if(null===value){if(name in attrs.map){delete attrs.map[name];for(var i=attrs.length;i--;)if(attrs[i].name===name)return attrs.splice(i,1),this}return this}if(name in attrs.map){for(i=attrs.length;i--;)if(attrs[i].name===name){attrs[i].value=value;break}}else attrs.push({name:name,value:value});return attrs.map[name]=value,this}},Node.prototype.clone=function(){var selfAttrs,clone=new Node(this.name,this.type);if(selfAttrs=this.attributes){var cloneAttrs=[];cloneAttrs.map={};for(var i=0,l=selfAttrs.length;i<l;i++){var selfAttr=selfAttrs[i];"id"!==selfAttr.name&&(cloneAttrs[cloneAttrs.length]={name:selfAttr.name,value:selfAttr.value},cloneAttrs.map[selfAttr.name]=selfAttr.value)}clone.attributes=cloneAttrs}return clone.value=this.value,clone.shortEnded=this.shortEnded,clone},Node.prototype.wrap=function(wrapper){return this.parent.insert(wrapper,this),wrapper.append(this),this},Node.prototype.unwrap=function(){for(var node=this.firstChild;node;){var next=node.next;this.insert(node,this,!0),node=next}this.remove()},Node.prototype.remove=function(){var parent=this.parent,next=this.next,prev=this.prev;return parent&&(parent.firstChild===this?(parent.firstChild=next)&&(next.prev=null):prev.next=next,parent.lastChild===this?(parent.lastChild=prev)&&(prev.next=null):next.prev=prev,this.parent=this.next=this.prev=null),this},Node.prototype.append=function(node){node.parent&&node.remove();var last=this.lastChild;return last?((last.next=node).prev=last,this.lastChild=node):this.lastChild=this.firstChild=node,node.parent=this,node},Node.prototype.insert=function(node,refNode,before){node.parent&&node.remove();var parent=refNode.parent||this;return before?(refNode===parent.firstChild?parent.firstChild=node:refNode.prev.next=node,node.prev=refNode.prev,(node.next=refNode).prev=node):(refNode===parent.lastChild?parent.lastChild=node:refNode.next.prev=node,node.next=refNode.next,(node.prev=refNode).next=node),node.parent=parent,node},Node.prototype.getAll=function(name){for(var collection=[],node=this.firstChild;node;node=walk$2(node,this))node.name===name&&collection.push(node);return collection},Node.prototype.empty=function(){if(this.firstChild){for(var nodes=[],node=this.firstChild;node;node=walk$2(node,this))nodes.push(node);for(var i=nodes.length;i--;){(node=nodes[i]).parent=node.firstChild=node.lastChild=node.next=node.prev=null}}return this.firstChild=this.lastChild=null,this},Node.prototype.isEmpty=function(elements,whitespace,predicate){void 0===whitespace&&(whitespace={});var node=this.firstChild;if(isNonEmptyElement(this))return!1;if(node)do{if(1===node.type){if(node.attr("data-mce-bogus"))continue;if(elements[node.name])return!1;if(isNonEmptyElement(node))return!1}if(8===node.type)return!1;if(3===node.type&&!isEmptyTextNode$1(node))return!1;if(3===node.type&&node.parent&&whitespace[node.parent.name]&&whiteSpaceRegExp$3.test(node.value))return!1;if(predicate&&predicate(node))return!1}while(node=walk$2(node,this));return!0},Node.prototype.walk=function(prev){return walk$2(this,null,prev)},Node}();function SaxParser(settings,schema){void 0===schema&&(schema=Schema());function noop(){}!1!==(settings=settings||{}).fix_self_closing&&(settings.fix_self_closing=!0);var comment=settings.comment?settings.comment:noop,cdata=settings.cdata?settings.cdata:noop,text=settings.text?settings.text:noop,start=settings.start?settings.start:noop,end=settings.end?settings.end:noop,pi=settings.pi?settings.pi:noop,doctype=settings.doctype?settings.doctype:noop;return{parse:function(html,format){void 0===format&&(format="html");function processEndTag(name){var pos,i;for(pos=stack.length;pos--&&stack[pos].name!==name;);if(0<=pos){for(i=stack.length-1;pos<=i;i--)(name=stack[i]).valid&&end(name.name);stack.length=pos}}function processComment(value){""!==value&&(">"===value.charAt(0)&&(value=" "+value),settings.allow_conditional_comments||"[if"!==value.substr(0,3).toLowerCase()||(value=" "+value),comment(value))}function processMalformedComment(value,startIndex){var startTag=value||"",isBogus=!startsWith(startTag,"--"),endIndex=function(html,isBogus,startIndex){void 0===startIndex&&(startIndex=0);var lcHtml=html.toLowerCase();if(-1!==lcHtml.indexOf("[if ",startIndex)&&function(html,startIndex){return/^\s*\[if [\w\W]+\]>.*<!\[endif\](--!?)?>/.test(html.substr(startIndex))}(lcHtml,startIndex)){var endIfIndex=lcHtml.indexOf("[endif]",startIndex);return lcHtml.indexOf(">",endIfIndex)}if(isBogus){var endIndex=lcHtml.indexOf(">",startIndex);return-1!==endIndex?endIndex:lcHtml.length}var endCommentRegexp=/--!?>/;endCommentRegexp.lastIndex=startIndex;var match=endCommentRegexp.exec(html);return match?match.index+match[0].length:lcHtml.length}(html,isBogus,startIndex);return value=html.substr(startIndex,endIndex-startIndex),processComment(isBogus?startTag+value:value),endIndex+1}function parseAttribute(match,name,value,val2,val3){var attrRule,i;if(value=(name=name.toLowerCase())in fillAttrsMap?name:decode(value||val2||val3||""),validate&&!isInternalElement&&!1===function(name){return 0===name.indexOf("data-")||0===name.indexOf("aria-")}(name)){if(!(attrRule=validAttributesMap[name])&&validAttributePatterns){for(i=validAttributePatterns.length;i--&&!(attrRule=validAttributePatterns[i]).pattern.test(name););-1===i&&(attrRule=null)}if(!attrRule)return;if(attrRule.validValues&&!(value in attrRule.validValues))return}if(filteredUrlAttrs[name]&&!settings.allow_script_urls){var uri=value.replace(/[\s\u0000-\u001F]+/g,"");try{uri=decodeURIComponent(uri)}catch(ex){uri=unescape(uri)}if(scriptUriRegExp.test(uri))return;if(function(settings,uri){return!settings.allow_html_data_urls&&(/^data:image\//i.test(uri)?!1===settings.allow_svg_data_urls&&/^data:image\/svg\+xml/i.test(uri):/^data:/i.test(uri))}(settings,uri))return}isInternalElement&&(name in filteredUrlAttrs||0===name.indexOf("on"))||(attrList.map[name]=value,attrList.push({name:name,value:value}))}var matches,value,endRegExp,attrList,i,textData,name,isInternalElement,removeInternalElements,shortEndedElements,fillAttrsMap,isShortEnded,validate,elementRule,isValidElement,attr,attribsValue,validAttributesMap,validAttributePatterns,attributesRequired,attributesDefault,attributesForced,processHtml,selfClosing,tokenRegExp,attrRegExp,specialElements,attrValue,fixSelfClosing,index=0,stack=[],idCount=0,decode=Entities.decode,filteredUrlAttrs=Tools.makeMap("src,href,data,background,formaction,poster,xlink:href"),scriptUriRegExp=/((java|vb)script|mhtml):/i,parsingMode="html"===format?0:1;for(tokenRegExp=new RegExp("<(?:(?:!--([\\w\\W]*?)--!?>)|(?:!\\[CDATA\\[([\\w\\W]*?)\\]\\]>)|(?:![Dd][Oo][Cc][Tt][Yy][Pp][Ee]([\\w\\W]*?)>)|(?:!(--)?)|(?:\\?([^\\s\\/<>]+) ?([\\w\\W]*?)[?/]>)|(?:\\/([A-Za-z][A-Za-z0-9\\-_\\:\\.]*)>)|(?:([A-Za-z][A-Za-z0-9\\-_\\:\\.]*)((?:\\s+[^\"'>]+(?:(?:\"[^\"]*\")|(?:'[^']*')|[^>]*))*|\\/|\\s+)>))","g"),attrRegExp=/([\w:\-]+)(?:\s*=\s*(?:(?:\"((?:[^\"])*)\")|(?:\'((?:[^\'])*)\')|([^>\s]+)))?/g,shortEndedElements=schema.getShortEndedElements(),selfClosing=settings.self_closing_elements||schema.getSelfClosingElements(),fillAttrsMap=schema.getBoolAttrs(),validate=settings.validate,removeInternalElements=settings.remove_internals,fixSelfClosing=settings.fix_self_closing,specialElements=schema.getSpecialElements(),processHtml=html+">";matches=tokenRegExp.exec(processHtml);){var matchText=matches[0];if(index<matches.index&&text(decode(html.substr(index,matches.index-index))),value=matches[7])":"===(value=value.toLowerCase()).charAt(0)&&(value=value.substr(1)),processEndTag(value);else if(value=matches[8]){if(matches.index+matchText.length>html.length){text(decode(html.substr(matches.index))),index=matches.index+matchText.length;continue}":"===(value=value.toLowerCase()).charAt(0)&&(value=value.substr(1)),isShortEnded=value in shortEndedElements,fixSelfClosing&&selfClosing[value]&&0<stack.length&&stack[stack.length-1].name===value&&processEndTag(value);var bogusValue=checkBogusAttribute(attrRegExp,matches[9]);if(null!==bogusValue){if("all"===bogusValue){index=findEndTagIndex(schema,html,tokenRegExp.lastIndex),tokenRegExp.lastIndex=index;continue}isValidElement=!1}if(!validate||(elementRule=schema.getElementRule(value))){if(isValidElement=!0,validate&&(validAttributesMap=elementRule.attributes,validAttributePatterns=elementRule.attributePatterns),(attribsValue=matches[9])?((isInternalElement=-1!==attribsValue.indexOf("data-mce-type"))&&removeInternalElements&&(isValidElement=!1),(attrList=[]).map={},attribsValue.replace(attrRegExp,parseAttribute)):(attrList=[]).map={},validate&&!isInternalElement){if(attributesRequired=elementRule.attributesRequired,attributesDefault=elementRule.attributesDefault,attributesForced=elementRule.attributesForced,elementRule.removeEmptyAttrs&&!attrList.length&&(isValidElement=!1),attributesForced)for(i=attributesForced.length;i--;)name=(attr=attributesForced[i]).name,"{$uid}"===(attrValue=attr.value)&&(attrValue="mce_"+idCount++),attrList.map[name]=attrValue,attrList.push({name:name,value:attrValue});if(attributesDefault)for(i=attributesDefault.length;i--;)(name=(attr=attributesDefault[i]).name)in attrList.map||("{$uid}"===(attrValue=attr.value)&&(attrValue="mce_"+idCount++),attrList.map[name]=attrValue,attrList.push({name:name,value:attrValue}));if(attributesRequired){for(i=attributesRequired.length;i--&&!(attributesRequired[i]in attrList.map););-1===i&&(isValidElement=!1)}if(attr=attrList.map["data-mce-bogus"]){if("all"===attr){index=findEndTagIndex(schema,html,tokenRegExp.lastIndex),tokenRegExp.lastIndex=index;continue}isValidElement=!1}}isValidElement&&start(value,attrList,isShortEnded)}else isValidElement=!1;if(endRegExp=specialElements[value]){endRegExp.lastIndex=index=matches.index+matchText.length,index=(matches=endRegExp.exec(html))?(isValidElement&&(textData=html.substr(index,matches.index-index)),matches.index+matches[0].length):(textData=html.substr(index),html.length),isValidElement&&(0<textData.length&&text(textData,!0),end(value)),tokenRegExp.lastIndex=index;continue}isShortEnded||(attribsValue&&attribsValue.indexOf("/")===attribsValue.length-1?isValidElement&&end(value):stack.push({name:value,valid:isValidElement}))}else if(value=matches[1])processComment(value);else if(value=matches[2]){if(!(1==parsingMode||settings.preserve_cdata||0<stack.length&&schema.isValidChild(stack[stack.length-1].name,"#cdata"))){index=processMalformedComment("",matches.index+2),tokenRegExp.lastIndex=index;continue}cdata(value)}else if(value=matches[3])doctype(value);else{if((value=matches[4])||"<!"===matchText){index=processMalformedComment(value,matches.index+matchText.length),tokenRegExp.lastIndex=index;continue}if(value=matches[5]){if(1!=parsingMode){index=processMalformedComment("?",matches.index+2),tokenRegExp.lastIndex=index;continue}pi(value,matches[6])}}index=matches.index+matchText.length}for(index<html.length&&text(decode(html.substr(index))),i=stack.length-1;0<=i;i--)(value=stack[i]).valid&&end(value.name)}}}!function(SaxParser){SaxParser.findEndTag=findEndTagIndex}(SaxParser=SaxParser||{});function trimInternal(serializer,html){var endTagIndex,index,matchLength,matches,shortEndedElements,content=html,bogusAllRegExp=/<(\w+) [^>]*data-mce-bogus="all"[^>]*>/g,schema=serializer.schema;for(content=function(tempAttrs,html){var trimContentRegExp=new RegExp(["\\s?("+tempAttrs.join("|")+')="[^"]+"'].join("|"),"gi");return html.replace(trimContentRegExp,"")}(serializer.getTempAttrs(),content),shortEndedElements=schema.getShortEndedElements();matches=bogusAllRegExp.exec(content);)index=bogusAllRegExp.lastIndex,matchLength=matches[0].length,endTagIndex=shortEndedElements[matches[1]]?index:SaxParser$1.findEndTag(schema,content,index),content=content.substring(0,index-matchLength)+content.substring(endTagIndex),bogusAllRegExp.lastIndex=index-matchLength;return Zwsp.trim(content)}function getContentFromBody(editor,args,body){var content;if(args.format=args.format?args.format:"html",args.get=!0,args.getInner=!0,args.no_events||editor.fire("BeforeGetContent",args),"raw"===args.format)content=Tools.trim(TrimHtml.trimExternal(editor.serializer,body.innerHTML));else if("text"===args.format)content=Zwsp.trim(body.innerText||body.textContent);else{if("tree"===args.format)return editor.serializer.serialize(body,args);content=function(editor,html){var blockName=Settings_getForcedRootBlock(editor),emptyRegExp=new RegExp("^(<"+blockName+"[^>]*>(&nbsp;|&#160;|\\s||<br \\/>|)<\\/"+blockName+">[\r\n]*|<br \\/>[\r\n]*)$");return html.replace(emptyRegExp,"")}(editor,editor.serializer.serialize(body,args))}return"text"===args.format||isWsPreserveElement(Element.fromDom(body))?args.content=content:args.content=Tools.trim(content),args.no_events||editor.fire("GetContent",args),args.content}function Writer(settings){var indent,indentBefore,indentAfter,encode,htmlOutput,html=[];return indent=(settings=settings||{}).indent,indentBefore=makeMap$3(settings.indent_before||""),indentAfter=makeMap$3(settings.indent_after||""),encode=Entities.getEncodeFunc(settings.entity_encoding||"raw",settings.entities),htmlOutput="html"===settings.element_format,{start:function(name,attrs,empty){var i,l,attr,value;if(indent&&indentBefore[name]&&0<html.length&&0<(value=html[html.length-1]).length&&"\n"!==value&&html.push("\n"),html.push("<",name),attrs)for(i=0,l=attrs.length;i<l;i++)attr=attrs[i],html.push(" ",attr.name,'="',encode(attr.value,!0),'"');html[html.length]=!empty||htmlOutput?">":" />",empty&&indent&&indentAfter[name]&&0<html.length&&0<(value=html[html.length-1]).length&&"\n"!==value&&html.push("\n")},end:function(name){var value;html.push("</",name,">"),indent&&indentAfter[name]&&0<html.length&&0<(value=html[html.length-1]).length&&"\n"!==value&&html.push("\n")},text:function(text,raw){0<text.length&&(html[html.length]=raw?text:encode(text))},cdata:function(text){html.push("<![CDATA[",text,"]]>")},comment:function(text){html.push("\x3c!--",text,"--\x3e")},pi:function(name,text){text?html.push("<?",name," ",encode(text),"?>"):html.push("<?",name,"?>"),indent&&html.push("\n")},doctype:function(text){html.push("<!DOCTYPE",text,">",indent?"\n":"")},reset:function(){html.length=0},getContent:function(){return html.join("").replace(/\n$/,"")}}}function Serializer(settings,schema){void 0===schema&&(schema=Schema());var writer=Writer(settings);return(settings=settings||{}).validate=!("validate"in settings)||settings.validate,{serialize:function(node){var handlers,validate;validate=settings.validate,handlers={3:function(node){writer.text(node.value,node.raw)},8:function(node){writer.comment(node.value)},7:function(node){writer.pi(node.name,node.value)},10:function(node){writer.doctype(node.value)},4:function(node){writer.cdata(node.value)},11:function(node){if(node=node.firstChild)for(;walk(node),node=node.next;);}},writer.reset();var walk=function(node){var name,isEmpty,attrs,attrName,attrValue,sortedAttrs,i,l,elementRule,handler=handlers[node.type];if(handler)handler(node);else{if(name=node.name,isEmpty=node.shortEnded,attrs=node.attributes,validate&&attrs&&1<attrs.length&&((sortedAttrs=[]).map={},elementRule=schema.getElementRule(node.name))){for(i=0,l=elementRule.attributesOrder.length;i<l;i++)(attrName=elementRule.attributesOrder[i])in attrs.map&&(attrValue=attrs.map[attrName],sortedAttrs.map[attrName]=attrValue,sortedAttrs.push({name:attrName,value:attrValue}));for(i=0,l=attrs.length;i<l;i++)(attrName=attrs[i].name)in sortedAttrs.map||(attrValue=attrs.map[attrName],sortedAttrs.map[attrName]=attrValue,sortedAttrs.push({name:attrName,value:attrValue}));attrs=sortedAttrs}if(writer.start(node.name,attrs,isEmpty),!isEmpty){if(node=node.firstChild)for(;walk(node),node=node.next;);writer.end(name)}}};return 1!==node.type||settings.inner?handlers[11](node):walk(node),writer.getContent()}}}function filter$3(nodeFilters,attributeFilters,node){var matches=function(nodeFilters,attributeFilters,node){var nodeMatches={},attrMatches={},matches=[];for(var name_1 in node.firstChild&&traverse(node.firstChild,function(node){each(nodeFilters,function(filter){filter.name===node.name&&(nodeMatches[filter.name]?nodeMatches[filter.name].nodes.push(node):nodeMatches[filter.name]={filter:filter,nodes:[node]})}),each(attributeFilters,function(filter){"string"==typeof node.attr(filter.name)&&(attrMatches[filter.name]?attrMatches[filter.name].nodes.push(node):attrMatches[filter.name]={filter:filter,nodes:[node]})})}),nodeMatches)nodeMatches.hasOwnProperty(name_1)&&matches.push(nodeMatches[name_1]);for(var name_2 in attrMatches)attrMatches.hasOwnProperty(name_2)&&matches.push(attrMatches[name_2]);return matches}(nodeFilters,attributeFilters,node);each(matches,function(match){each(match.filter.callbacks,function(callback){callback(match.nodes,match.filter.name,{})})})}function hasFocus(element){var doc=owner(element).dom();return element.dom()===doc.activeElement}function active(_doc){var doc=void 0!==_doc?_doc.dom():domGlobals.document;return Option.from(doc.activeElement).map(Element.fromDom)}function clamp(offset,element){var max=isText(element)?get$7(element).length:children(element).length+1;return max<offset?max:offset<0?0:offset}function normalizeRng(rng){return Selection.range(rng.start(),clamp(rng.soffset(),rng.start()),rng.finish(),clamp(rng.foffset(),rng.finish()))}function isOrContains(root,elm){return!NodeType.isRestrictedNode(elm.dom())&&(contains$2(root,elm)||eq(root,elm))}function isRngInRoot(root){return function(rng){return isOrContains(root,rng.start())&&isOrContains(root,rng.finish())}}function shouldStore(editor){return!0===editor.inline||browser$4.isIE()}function nativeRangeToSelectionRange(r){return Selection.range(Element.fromDom(r.startContainer),r.startOffset,Element.fromDom(r.endContainer),r.endOffset)}function readRange(win){var selection=win.getSelection();return(selection&&0!==selection.rangeCount?Option.from(selection.getRangeAt(0)):Option.none()).map(nativeRangeToSelectionRange)}function getBookmark$2(root){var win=defaultView(root);return readRange(win.dom()).filter(isRngInRoot(root))}function validate(root,bookmark){return Option.from(bookmark).filter(isRngInRoot(root)).map(normalizeRng)}function bookmarkToNativeRng(bookmark){var rng=domGlobals.document.createRange();try{return rng.setStart(bookmark.start().dom(),bookmark.soffset()),rng.setEnd(bookmark.finish().dom(),bookmark.foffset()),Option.some(rng)}catch(_){return Option.none()}}function getRng(editor){return(editor.bookmark?editor.bookmark:Option.none()).bind(function(x){return validate(Element.fromDom(editor.getBody()),x)}).bind(bookmarkToNativeRng)}function registerEditorEvents(editor,throttledStore){detect$3().browser.isIE()?function(editor){editor.on("focusout",function(){SelectionBookmark_store(editor)})}(editor):function(editor,throttledStore){editor.on("mouseup touchend",function(e){throttledStore.throttle()})}(editor,throttledStore),editor.on("keyup NodeChange",function(e){!function(e){return"nodechange"===e.type&&e.selectionChange}(e)&&SelectionBookmark_store(editor)})}function isEditorUIElement$1(elm){return FocusManager.isEditorUIElement(elm)}function isUIElement(editor,elm){var customSelector=editor?editor.settings.custom_ui_selector:"";return null!==DOM$2.getParent(elm,function(elm){return isEditorUIElement$1(elm)||!!customSelector&&editor.dom.is(elm,customSelector)})}function registerEvents(editorManager,e){var editor=e.editor;SelectionRestore_register(editor),editor.on("focusin",function(){var focusedEditor=editorManager.focusedEditor;focusedEditor!==this&&(focusedEditor&&focusedEditor.fire("blur",{focusedEditor:this}),editorManager.setActive(this),(editorManager.focusedEditor=this).fire("focus",{blurredEditor:focusedEditor}),this.focus(!0))}),editor.on("focusout",function(){var self=this;Delay.setEditorTimeout(self,function(){var focusedEditor=editorManager.focusedEditor;isUIElement(self,function(){try{return domGlobals.document.activeElement}catch(ex){return domGlobals.document.body}}())||focusedEditor!==self||(self.fire("blur",{focusedEditor:null}),editorManager.focusedEditor=null)})}),documentFocusInHandler||(documentFocusInHandler=function(e){var target,activeEditor=editorManager.activeEditor;target=e.target,activeEditor&&target.ownerDocument===domGlobals.document&&(target===domGlobals.document.body||isUIElement(activeEditor,target)||editorManager.focusedEditor!==activeEditor||(activeEditor.fire("blur",{focusedEditor:null}),editorManager.focusedEditor=null))},DOM$2.bind(domGlobals.document,"focusin",documentFocusInHandler))}function unregisterDocumentEvents(editorManager,e){editorManager.focusedEditor===e.editor&&(editorManager.focusedEditor=null),editorManager.activeEditor||(DOM$2.unbind(domGlobals.document,"focusin",documentFocusInHandler),documentFocusInHandler=null)}function getFocusInElement(root,rng){return function(rng){return rng.collapsed?Option.from(getNode(rng.startContainer,rng.startOffset)).map(Element.fromDom):Option.none()}(rng).bind(function(node){return isTableSection(node)?Option.some(node):!1===contains$2(root,node)?Option.some(root):Option.none()})}function normalizeSelection(editor,rng){getFocusInElement(Element.fromDom(editor.getBody()),rng).bind(function(elm){return CaretFinder.firstPositionIn(elm.dom())}).fold(function(){editor.selection.normalize()},function(caretPos){return editor.selection.setRng(caretPos.toRange())})}function focusBody(body){if(body.setActive)try{body.setActive()}catch(ex){body.focus()}else body.focus()}function hasElementFocus(elm){return hasFocus(elm)||function(element){return active(owner(element)).filter(function(e){return element.dom().contains(e.dom())})}(elm).isSome()}function hasFocus$1(editor){return editor.inline?function(editor){var rawBody=editor.getBody();return rawBody&&hasElementFocus(Element.fromDom(rawBody))}(editor):function(editor){return editor.iframeElement&&hasFocus(Element.fromDom(editor.iframeElement))}(editor)}function isTreeNode(content){return content instanceof Node$1}function setEditorHtml(editor,html){editor.dom.setHTML(editor.getBody(),html),function(editor){EditorFocus_hasFocus(editor)&&CaretFinder.firstPositionIn(editor.getBody()).each(function(pos){var node=pos.getNode(),caretPos=NodeType.isTable(node)?CaretFinder.firstPositionIn(node).getOr(pos):pos;editor.selection.setRng(caretPos.toRange())})}(editor)}function setContent(editor,content,args){return void 0===args&&(args={}),args.format=args.format?args.format:"html",args.set=!0,args.content=isTreeNode(content)?"":content,isTreeNode(content)||args.no_events||(editor.fire("BeforeSetContent",args),content=args.content),Option.from(editor.getBody()).fold(constant(content),function(body){return isTreeNode(content)?function(editor,body,content,args){filter$3(editor.parser.getNodeFilters(),editor.parser.getAttributeFilters(),content);var html=Serializer({validate:editor.validate},editor.schema).serialize(content);return args.content=isWsPreserveElement(Element.fromDom(body))?html:Tools.trim(html),setEditorHtml(editor,args.content),args.no_events||editor.fire("SetContent",args),content}(editor,body,content,args):function(editor,body,content,args){var forcedRootBlockName,padd;return 0===content.length||/^\s+$/.test(content)?(padd='<br data-mce-bogus="1">',"TABLE"===body.nodeName?content="<tr><td>"+padd+"</td></tr>":/^(UL|OL)$/.test(body.nodeName)&&(content="<li>"+padd+"</li>"),content=(forcedRootBlockName=Settings_getForcedRootBlock(editor))&&editor.schema.isValidChild(body.nodeName.toLowerCase(),forcedRootBlockName.toLowerCase())?(content=padd,editor.dom.createHTML(forcedRootBlockName,editor.settings.forced_root_block_attrs,content)):content||'<br data-mce-bogus="1">',setEditorHtml(editor,content),editor.fire("SetContent",args)):("raw"!==args.format&&(content=Serializer({validate:editor.validate},editor.schema).serialize(editor.parser.parse(content,{isRootContent:!0,insert:!0}))),args.content=isWsPreserveElement(Element.fromDom(body))?content:Tools.trim(content),setEditorHtml(editor,args.content),args.no_events||editor.fire("SetContent",args)),args.content}(editor,body,content,args)})}function safeDestroy(x){return Option.from(x).each(function(x){return x.destroy()})}function remove$6(editor){if(!editor.removed){var _selectionOverrides=editor._selectionOverrides,editorUpload=editor.editorUpload,body=editor.getBody(),element=editor.getElement();body&&editor.save({is_removing:!0}),editor.removed=!0,editor.unbindAllNativeEvents(),editor.hasHiddenInput&&element&&DOM$3.remove(element.nextSibling),function(editor){editor.fire("remove")}(editor),editor.editorManager.remove(editor),!editor.inline&&body&&function(editor){DOM$3.setStyle(editor.id,"display",editor.orgDisplay)}(editor),function(editor){editor.fire("detach")}(editor),DOM$3.remove(editor.getContainer()),safeDestroy(_selectionOverrides),safeDestroy(editorUpload),editor.destroy()}}function destroy(editor,automatic){var selection=editor.selection,dom=editor.dom;editor.destroyed||(automatic||editor.removed?(automatic||(editor.editorManager.off("beforeunload",editor._beforeUnload),editor.theme&&editor.theme.destroy&&editor.theme.destroy(),safeDestroy(selection),safeDestroy(dom)),function(editor){var form=editor.formElement;form&&(form._mceOldSubmit&&(form.submit=form._mceOldSubmit,form._mceOldSubmit=null),DOM$3.unbind(form,"submit reset",editor.formEventDelegate))}(editor),function(editor){editor.contentAreaContainer=editor.formElement=editor.container=editor.editorContainer=null,editor.bodyElement=editor.contentDocument=editor.contentWindow=null,editor.iframeElement=editor.targetElm=null,editor.selection&&(editor.selection=editor.selection.win=editor.selection.dom=editor.selection.dom.doc=null)}(editor),editor.destroyed=!0):editor.remove())}function normalizePlugins(plugins){var pluginNames=isArray(plugins)?plugins.join(" "):plugins,trimmedPlugins=map(isString(pluginNames)?pluginNames.split(" "):[],trim);return filter(trimmedPlugins,function(item){return 0<item.length})}function extractSections(keys,settings){var result=bifilter(settings,function(value,key){return contains(keys,key)});return sectionResult(result.t,result.f)}function hasSection(sectionResult,name){return sectionResult.sections().hasOwnProperty(name)}function getToolbarMode(settings,defaultVal){return get(settings,"toolbar_mode").orThunk(function(){return get(settings,"toolbar_drawer").map(function(val){return!1===val?"wrap":val})}).getOr(defaultVal)}function processPlugins(isMobileDevice,sectionResult,defaultOverrideSettings,settings){var forcedPlugins=normalizePlugins(defaultOverrideSettings.forced_plugins),desktopPlugins=normalizePlugins(settings.plugins),mobileConfig=function(sectionResult,name){return hasSection(sectionResult,name)?sectionResult.sections()[name]:{}}(sectionResult,"mobile"),mobilePlugins=mobileConfig.plugins?normalizePlugins(mobileConfig.plugins):desktopPlugins,combinedPlugins=function(forcedPlugins,plugins){return[].concat(normalizePlugins(forcedPlugins)).concat(normalizePlugins(plugins))}(forcedPlugins,isMobileDevice&&function(sectionResult,name,theme){var section=sectionResult.sections();return hasSection(sectionResult,name)&&section[name].theme===theme}(sectionResult,"mobile","mobile")?function(plugins){return filter(plugins,curry(contains,legacyMobilePlugins))}(mobilePlugins):isMobileDevice&&hasSection(sectionResult,"mobile")?mobilePlugins:desktopPlugins);return Tools.extend(settings,{plugins:combinedPlugins.join(" ")})}function combineSettings(isMobileDevice,isPhone,defaultSettings,defaultOverrideSettings,settings){var defaultDeviceSettings=isMobileDevice?{mobile:function(settings,isPhone){var defaultMobileSettings={resize:!1,toolbar_mode:getToolbarMode(settings,"scrolling"),toolbar_sticky:!1};return __assign(__assign(__assign({},defaultTouchSettings),defaultMobileSettings),isPhone?{menubar:!1}:{})}(settings,isPhone)}:{},sectionResult=extractSections(["mobile"],deepMerge(defaultDeviceSettings,settings)),extendedSettings=Tools.extend(defaultSettings,defaultOverrideSettings,sectionResult.settings(),function(isMobileDevice,sectionResult){return isMobileDevice&&hasSection(sectionResult,"mobile")}(isMobileDevice,sectionResult)?function(sectionResult,name,defaults){void 0===defaults&&(defaults={});var sections=sectionResult.sections(),sectionSettings=sections.hasOwnProperty(name)?sections[name]:{};return Tools.extend({},defaults,sectionSettings)}(sectionResult,"mobile"):{},{validate:!0,external_plugins:function(overrideSettings,settings){var userDefinedExternalPlugins=settings.external_plugins?settings.external_plugins:{};return overrideSettings&&overrideSettings.external_plugins?Tools.extend({},overrideSettings.external_plugins,userDefinedExternalPlugins):userDefinedExternalPlugins}(defaultOverrideSettings,sectionResult.settings())});return processPlugins(isMobileDevice,sectionResult,defaultOverrideSettings,extendedSettings)}function getEditorSettings(editor,id,documentBaseUrl,defaultOverrideSettings,settings){var defaultSettings=function(settings,id,documentBaseUrl,isTouch,editor){var baseDefaults={id:id,theme:"silver",toolbar_mode:getToolbarMode(settings,"floating"),plugins:"",document_base_url:documentBaseUrl,add_form_submit_trigger:!0,submit_patch:!0,add_unload_trigger:!0,convert_urls:!0,relative_urls:!0,remove_script_host:!0,object_resizing:!0,doctype:"<!DOCTYPE html>",visual:!0,font_size_legacy_values:"xx-small,small,medium,large,x-large,xx-large,300%",forced_root_block:"p",hidden_input:!0,inline_styles:!0,convert_fonts_to_spans:!0,indent:!0,indent_before:"p,h1,h2,h3,h4,h5,h6,blockquote,div,title,style,pre,script,td,th,ul,ol,li,dl,dt,dd,area,table,thead,tfoot,tbody,tr,section,summary,article,hgroup,aside,figure,figcaption,option,optgroup,datalist",indent_after:"p,h1,h2,h3,h4,h5,h6,blockquote,div,title,style,pre,script,td,th,ul,ol,li,dl,dt,dd,area,table,thead,tfoot,tbody,tr,section,summary,article,hgroup,aside,figure,figcaption,option,optgroup,datalist",entity_encoding:"named",url_converter:editor.convertURL,url_converter_scope:editor};return __assign(__assign({},baseDefaults),isTouch?defaultTouchSettings:{})}(settings,id,documentBaseUrl,isTouch,editor);return combineSettings(isPhone||isTablet,isPhone,defaultSettings,defaultOverrideSettings,settings)}function getFiltered(predicate,editor,name){return Option.from(editor.settings[name]).filter(predicate)}function getParam(editor,name,defaultVal,type){var value=name in editor.settings?editor.settings[name]:defaultVal;return"hash"===type?function(value){var output={};return"string"==typeof value?each(0<value.indexOf("=")?value.split(/[;,](?![^=;,]*(?:[;,]|$))/):value.split(","),function(val){var arr=val.split("=");1<arr.length?output[Tools.trim(arr[0])]=Tools.trim(arr[1]):output[Tools.trim(arr[0])]=Tools.trim(arr[0])}):output=value,output}(value):"string"===type?getFiltered(isString,editor,name).getOr(defaultVal):"number"===type?getFiltered(isNumber,editor,name).getOr(defaultVal):"boolean"===type?getFiltered(isBoolean,editor,name).getOr(defaultVal):"object"===type?getFiltered(isObject,editor,name).getOr(defaultVal):"array"===type?getFiltered(isArray,editor,name).getOr(defaultVal):"string[]"===type?getFiltered(function(p){return function(a){return isArray(a)&&forall(a,p)}}(isString),editor,name).getOr(defaultVal):"function"===type?getFiltered(isFunction,editor,name).getOr(defaultVal):value}function getProp(propName,elm){return elm.dom()[propName]}function getComputedSizeProp(propName,elm){return parseInt(get$4(elm,propName),10)}var documentFocusInHandler,merger,lookup,SaxParser$1=SaxParser,TrimHtml={trimExternal:trimInternal,trimInternal:trimInternal},makeMap$3=Tools.makeMap,traverse=function(node,fn){fn(node),node.firstChild&&traverse(node.firstChild,fn),node.next&&traverse(node.next,fn)},Adt_generate=function(cases){if(!isArray(cases))throw new Error("cases must be an array");if(0===cases.length)throw new Error("there must be at least one case");var constructors=[],adt={};return each(cases,function(acase,count){var keys$1=keys(acase);if(1!==keys$1.length)throw new Error("one and only one name per case");var key=keys$1[0],value=acase[key];if(void 0!==adt[key])throw new Error("duplicate key detected:"+key);if("cata"===key)throw new Error("cannot have a case named cata (sorry)");if(!isArray(value))throw new Error("case arguments must be an array");constructors.push(key),adt[key]=function(){var argLength=arguments.length;if(argLength!==value.length)throw new Error("Wrong number of arguments to case "+key+". Expected "+value.length+" ("+value+"), got "+argLength);for(var args=new Array(argLength),i=0;i<args.length;i++)args[i]=arguments[i];return{fold:function(){if(arguments.length!==cases.length)throw new Error("Wrong number of arguments to fold. Expected "+cases.length+", got "+arguments.length);return arguments[count].apply(null,args)},match:function(branches){var branchKeys=keys(branches);if(constructors.length!==branchKeys.length)throw new Error("Wrong number of arguments to match. Expected: "+constructors.join(",")+"\nActual: "+branchKeys.join(","));if(!forall(constructors,function(reqKey){return contains(branchKeys,reqKey)}))throw new Error("Not all branches were specified when using match. Specified: "+branchKeys.join(", ")+"\nRequired: "+constructors.join(", "));return branches[key].apply(null,args)},log:function(label){domGlobals.console.log(label,{constructors:constructors,constructor:key,params:args})}}}}),adt},SimRange={create:Immutable("start","soffset","finish","foffset")},adt=Adt_generate([{before:["element"]},{on:["element","offset"]},{after:["element"]}]),Situ_getStart=(adt.before,adt.on,adt.after,function(situ){return situ.fold(identity,identity,identity)}),adt$1=Adt_generate([{domRange:["rng"]},{relative:["startSitu","finishSitu"]},{exact:["start","soffset","finish","foffset"]}]),Selection={domRange:adt$1.domRange,relative:adt$1.relative,exact:adt$1.exact,exactFromRange:function(simRange){return adt$1.exact(simRange.start(),simRange.soffset(),simRange.finish(),simRange.foffset())},getWin:function(selection){var start=function(selection){return selection.match({domRange:function(rng){return Element.fromDom(rng.startContainer)},relative:function(startSitu,finishSitu){return Situ_getStart(startSitu)},exact:function(start,soffset,finish,foffset){return start}})}(selection);return defaultView(start)},range:SimRange.create},browser$4=detect$3().browser,SelectionBookmark_store=function(editor){var newBookmark=shouldStore(editor)?getBookmark$2(Element.fromDom(editor.getBody())):Option.none();editor.bookmark=newBookmark.isSome()?newBookmark:editor.bookmark},SelectionBookmark_storeNative=function(editor,rng){var root=Element.fromDom(editor.getBody()),newBookmark=(shouldStore(editor)?Option.from(rng):Option.none()).map(nativeRangeToSelectionRange).filter(isRngInRoot(root));editor.bookmark=newBookmark.isSome()?newBookmark:editor.bookmark},SelectionBookmark_restore=function(editor){getRng(editor).each(function(rng){editor.selection.setRng(rng)})},SelectionBookmark_getRng=getRng,FocusManager={isEditorUIElement:function(elm){var className=elm.className.toString();return-1!==className.indexOf("tox-")||-1!==className.indexOf("mce-")}},SelectionRestore_register=function(editor){var throttledStore=first(function(){SelectionBookmark_store(editor)},0);editor.on("init",function(){editor.inline&&function(editor,throttledStore){function mouseUpPage(){throttledStore.throttle()}DOMUtils$1.DOM.bind(domGlobals.document,"mouseup",mouseUpPage),editor.on("remove",function(){DOMUtils$1.DOM.unbind(domGlobals.document,"mouseup",mouseUpPage)})}(editor,throttledStore),registerEditorEvents(editor,throttledStore)}),editor.on("remove",function(){throttledStore.cancel()})},DOM$2=DOMUtils$1.DOM,FocusController_setup=function(editorManager){editorManager.on("AddEditor",curry(registerEvents,editorManager)),editorManager.on("RemoveEditor",curry(unregisterDocumentEvents,editorManager))},FocusController_isEditorContentAreaElement=function(elm){var classList=elm.classList;return void 0!==classList&&(classList.contains("tox-edit-area")||classList.contains("tox-edit-area__iframe")||classList.contains("mce-content-body"))},FocusController_isUIElement=isUIElement,activateEditor=function(editor){return editor.editorManager.setActive(editor)},EditorFocus_focus=function(editor,skipFocus){editor.removed||(skipFocus?activateEditor(editor):function(editor){var selection=editor.selection,body=editor.getBody(),rng=selection.getRng();editor.quirks.refreshContentEditable(),void 0!==editor.bookmark&&!1===hasFocus$1(editor)&&SelectionBookmark_getRng(editor).each(function(bookmarkRng){editor.selection.setRng(bookmarkRng),rng=bookmarkRng});var contentEditableHost=function(editor,node){return editor.dom.getParent(node,function(node){return"true"===editor.dom.getContentEditable(node)})}(editor,selection.getNode());if(editor.$.contains(body,contentEditableHost))return focusBody(contentEditableHost),normalizeSelection(editor,rng),activateEditor(editor);editor.inline||(Env.opera||focusBody(body),editor.getWin().focus()),(Env.gecko||editor.inline)&&(focusBody(body),normalizeSelection(editor,rng)),activateEditor(editor)}(editor))},EditorFocus_hasFocus=hasFocus$1,EditorFocus_hasEditorOrUiFocus=function(editor){return hasFocus$1(editor)||function(editor){return active().filter(function(elem){return!FocusController_isEditorContentAreaElement(elem.dom())&&FocusController_isUIElement(editor,elem.dom())}).isSome()}(editor)},DOM$3=DOMUtils$1.DOM,hasOwnProperty$2=Object.prototype.hasOwnProperty,deepMerge=(merger=function(old,nu){return isObject(old)&&isObject(nu)?deepMerge(old,nu):nu},function(){for(var objects=new Array(arguments.length),i=0;i<objects.length;i++)objects[i]=arguments[i];if(0===objects.length)throw new Error("Can't merge zero objects");for(var ret={},j=0;j<objects.length;j++){var curObject=objects[j];for(var key in curObject)hasOwnProperty$2.call(curObject,key)&&(ret[key]=merger(ret[key],curObject[key]))}return ret}),sectionResult=Immutable("sections","settings"),deviceDetection=detect$3().deviceType,isTouch=deviceDetection.isTouch(),isPhone=deviceDetection.isPhone(),isTablet=deviceDetection.isTablet(),legacyMobilePlugins=["lists","autolink","autosave"],defaultTouchSettings={table_grid:!1,object_resizing:!1,resize:!1},IconManager=(lookup={},{add:function(id,iconPack){lookup[id]=iconPack},get:function(id){return lookup[id]?lookup[id]:{icons:{}}},has:function(id){return has(lookup,id)}}),getClientWidth=curry(getProp,"clientWidth"),getClientHeight=curry(getProp,"clientHeight"),getMarginTop=curry(getComputedSizeProp,"margin-top"),getMarginLeft=curry(getComputedSizeProp,"margin-left"),EditorView_isXYInContentArea=function(editor,clientX,clientY){var bodyElm=Element.fromDom(editor.getBody()),targetElm=editor.inline?bodyElm:function(element){return Element.fromDom(element.dom().ownerDocument.documentElement)}(bodyElm),transposedPoint=function(inline,elm,clientX,clientY){var clientRect=function(elm){return elm.dom().getBoundingClientRect()}(elm);return{x:clientX-(inline?clientRect.left+elm.dom().clientLeft+getMarginLeft(elm):0),y:clientY-(inline?clientRect.top+elm.dom().clientTop+getMarginTop(elm):0)}}(editor.inline,targetElm,clientX,clientY);return function(bodyElm,clientX,clientY){var clientWidth=getClientWidth(bodyElm),clientHeight=getClientHeight(bodyElm);return 0<=clientX&&0<=clientY&&clientX<=clientWidth&&clientY<=clientHeight}(targetElm,transposedPoint.x,transposedPoint.y)},EditorView_isEditorAttachedToDom=function(editor){return function(node){return Option.from(node).map(Element.fromDom)}(editor.inline?editor.getBody():editor.getContentAreaContainer()).map(function(container){return contains$2(owner(container),container)}).getOr(!1)};function NotificationManager(editor){function getImplementation(){var theme=editor.theme;return theme&&theme.getNotificationManagerImpl?theme.getNotificationManagerImpl():function(){function unimplemented(){throw new Error("Theme did not provide a NotificationManager implementation.")}return{open:unimplemented,close:unimplemented,reposition:unimplemented,getArgs:unimplemented}}()}function reposition(){0<notifications.length&&getImplementation().reposition(notifications)}function closeNotification(notification){findIndex(notifications,function(otherNotification){return otherNotification===notification}).each(function(index){notifications.splice(index,1)})}function open(spec){if(!editor.removed&&EditorView_isEditorAttachedToDom(editor))return find(notifications,function(notification){return function(a,b){return!(a.type!==b.type||a.text!==b.text||a.progressBar||a.timeout||b.progressBar||b.timeout)}(getImplementation().getArgs(notification),spec)}).getOrThunk(function(){editor.editorManager.setActive(editor);var notification=getImplementation().open(spec,function(){closeNotification(notification),reposition()});return function(notification){notifications.push(notification)}(notification),reposition(),notification})}var notifications=[];return function(editor){editor.on("SkinLoaded",function(){var serviceMessage=editor.settings.service_message;serviceMessage&&open({text:serviceMessage,type:"warning",timeout:0})}),editor.on("ResizeEditor ResizeWindow NodeChange",function(){Delay.requestAnimationFrame(reposition)}),editor.on("remove",function(){each(notifications.slice(),function(notification){getImplementation().close(notification)})})}(editor),{open:open,close:function(){Option.from(notifications[0]).each(function(notification){getImplementation().close(notification),closeNotification(notification),reposition()})},getNotifications:function(){return notifications}}}var PluginManager=AddOnManager$1.PluginManager,ThemeManager=AddOnManager$1.ThemeManager;function WindowManager(editor){function getImplementation(){var theme=editor.theme;return theme&&theme.getWindowManagerImpl?theme.getWindowManagerImpl():function(){function unimplemented(){throw new Error("Theme did not provide a WindowManager implementation.")}return{open:unimplemented,openUrl:unimplemented,alert:unimplemented,confirm:unimplemented,close:unimplemented,getParams:unimplemented,setParams:unimplemented}}()}function funcBind(scope,f){return function(){return f?f.apply(scope,arguments):void 0}}function addDialog(dialog){dialogs.push(dialog),function(dialog){editor.fire("OpenWindow",{dialog:dialog})}(dialog)}function closeDialog(dialog){!function(dialog){editor.fire("CloseWindow",{dialog:dialog})}(dialog),0===(dialogs=filter(dialogs,function(otherDialog){return otherDialog!==dialog})).length&&editor.focus()}function storeSelectionAndOpenDialog(openDialog){editor.editorManager.setActive(editor),SelectionBookmark_store(editor);var dialog=openDialog();return addDialog(dialog),dialog}var dialogs=[];return editor.on("remove",function(){each(dialogs,function(dialog){getImplementation().close(dialog)})}),{open:function(args,params){return storeSelectionAndOpenDialog(function(){return getImplementation().open(args,params,closeDialog)})},openUrl:function(args){return storeSelectionAndOpenDialog(function(){return getImplementation().openUrl(args,closeDialog)})},alert:function(message,callback,scope){getImplementation().alert(message,funcBind(scope||this,callback))},confirm:function(message,callback,scope){getImplementation().confirm(message,funcBind(scope||this,callback))},close:function(){Option.from(dialogs[dialogs.length-1]).each(function(dialog){getImplementation().close(dialog),closeDialog(dialog)})}}}function displayNotification(editor,message){editor.notificationManager.open({type:"error",text:message})}function displayError(editor,message){editor._skinLoaded?displayNotification(editor,message):editor.on("SkinLoaded",function(){displayNotification(editor,message)})}function logError(editor,errorType,msg){!function(editor,errorType,error){editor.fire(errorType,error)}(editor,errorType,{message:msg}),domGlobals.console.error(msg)}function createLoadError(type,url,name){return name?"Failed to load "+type+": "+name+" from url "+url:"Failed to load "+type+" url: "+url}function appendContentCssFromSettings(editor){editor.contentCSS=editor.contentCSS.concat(function(editor){var contentCss=Settings_getContentCss(editor),skinUrl=editor.editorManager.baseURL+"/skins/content",contentCssFile="content"+editor.editorManager.suffix+".css",inline=!0===editor.inline;return map(contentCss,function(url){return function(url){return/^[a-z0-9\-]+$/i.test(url)}(url)&&!inline?skinUrl+"/"+url+"/"+contentCssFile:editor.documentBaseURI.toAbsolute(url)})}(editor))}var initError=function(message){for(var x=[],_i=1;_i<arguments.length;_i++)x[_i-1]=arguments[_i];var console=domGlobals.window.console;console&&(console.error?console.error.apply(console,arguments):console.log.apply(console,arguments))},ErrorReporter={pluginLoadError:function(editor,url,name){logError(editor,"PluginLoadError",createLoadError("plugin",url,name))},iconsLoadError:function(editor,url,name){logError(editor,"IconsLoadError",createLoadError("icons",url,name))},languageLoadError:function(editor,url,name){logError(editor,"LanguageLoadError",createLoadError("language",url,name))},pluginInitError:function(editor,name,err){var message=I18n.translate(["Failed to initialize plugin: {0}",name]);initError(message,err),displayError(editor,message)},uploadError:function(editor,message){displayError(editor,I18n.translate(["Failed to upload image: {0}",message]))},displayError:displayError,initError:initError};function BookmarkManager(selection){return{getBookmark:curry(Bookmarks_getBookmark,selection),moveToBookmark:curry(Bookmarks_moveToBookmark,selection)}}!function(BookmarkManager){BookmarkManager.isBookmarkNode=Bookmarks_isBookmarkNode}(BookmarkManager=BookmarkManager||{});function ControlSelection(selection,editor){var selectedElm,selectedElmGhost,resizeHelper,resizeHandles,selectedHandle,startX,startY,selectedElmX,selectedElmY,startW,startH,ratio,resizeStarted,width,height,startScrollWidth,startScrollHeight,dom=editor.dom,each=Tools.each,editableDoc=editor.getDoc(),rootDocument=domGlobals.document,abs=Math.abs,round=Math.round,rootElement=editor.getBody();function isImage(elm){return elm&&("IMG"===elm.nodeName||editor.dom.is(elm,"figure.image"))}function contextMenuSelectImage(evt){var target=evt.target;!function(evt,range){if("longpress"!==evt.type&&0!==evt.type.indexOf("touch"))return isImage(evt.target)&&!RangePoint_isXYWithinRange(evt.clientX,evt.clientY,range);var touch=evt.touches[0];return isImage(evt.target)&&!RangePoint_isXYWithinRange(touch.clientX,touch.clientY,range)}(evt,editor.selection.getRng())||evt.isDefaultPrevented()||editor.selection.select(target)}function getResizeTarget(elm){return editor.dom.is(elm,"figure.image")?elm.querySelector("img"):elm}function isResizable(elm){var selector=Settings_getObjectResizing(editor);return!1!==selector&&!Env.iOS&&("string"!=typeof selector&&(selector="table,img,figure.image,div"),"false"!==elm.getAttribute("data-mce-resize")&&(elm!==editor.getBody()&&is(Element.fromDom(elm),selector)))}function resizeGhostElement(e){var deltaX,deltaY,resizeHelperX,resizeHelperY;deltaX=e.screenX-startX,deltaY=e.screenY-startY,width=deltaX*selectedHandle[2]+startW,height=deltaY*selectedHandle[3]+startH,width=width<5?5:width,height=height<5?5:height,(isImage(selectedElm)&&!1!==Settings_getResizeImgProportional(editor)?!VK.modifierPressed(e):VK.modifierPressed(e))&&(abs(deltaX)>abs(deltaY)?(height=round(width*ratio),width=round(height/ratio)):(width=round(height/ratio),height=round(width*ratio))),dom.setStyles(getResizeTarget(selectedElmGhost),{width:width,height:height}),resizeHelperX=0<(resizeHelperX=selectedHandle.startPos.x+deltaX)?resizeHelperX:0,resizeHelperY=0<(resizeHelperY=selectedHandle.startPos.y+deltaY)?resizeHelperY:0,dom.setStyles(resizeHelper,{left:resizeHelperX,top:resizeHelperY,display:"block"}),resizeHelper.innerHTML=width+" &times; "+height,selectedHandle[2]<0&&selectedElmGhost.clientWidth<=width&&dom.setStyle(selectedElmGhost,"left",selectedElmX+(startW-width)),selectedHandle[3]<0&&selectedElmGhost.clientHeight<=height&&dom.setStyle(selectedElmGhost,"top",selectedElmY+(startH-height)),(deltaX=rootElement.scrollWidth-startScrollWidth)+(deltaY=rootElement.scrollHeight-startScrollHeight)!==0&&dom.setStyles(resizeHelper,{left:resizeHelperX-deltaX,top:resizeHelperY-deltaY}),resizeStarted||(function(editor,target,width,height){editor.fire("ObjectResizeStart",{target:target,width:width,height:height})}(editor,selectedElm,startW,startH),resizeStarted=!0)}function updateResizeRect(e){function isChildOrEqual(node,parent){if(node)do{if(node===parent)return!0}while(node=node.parentNode)}var controlElm;resizeStarted||editor.removed||(each(dom.select("img[data-mce-selected],hr[data-mce-selected]"),function(img){img.removeAttribute("data-mce-selected")}),controlElm="mousedown"===e.type?e.target:selection.getNode(),isChildOrEqual(controlElm=dom.$(controlElm).closest("table,img,figure.image,hr")[0],rootElement)&&(disableGeckoResize(),isChildOrEqual(selection.getStart(!0),controlElm)&&isChildOrEqual(selection.getEnd(!0),controlElm))?showResizeRect(controlElm):hideResizeRect())}function isWithinContentEditableFalse(elm){return isContentEditableFalse$6(function(root,node){for(;node&&node!==root;){if(isContentEditableTrue$2(node)||isContentEditableFalse$6(node))return node;node=node.parentNode}return null}(editor.getBody(),elm))}resizeHandles={nw:[0,0,-1,-1],ne:[1,0,1,-1],se:[1,1,1,1],sw:[0,1,-1,1]};var endGhostResize=function(){resizeStarted=!1;function setSizeProp(name,value){value&&(selectedElm.style[name]||!editor.schema.isValid(selectedElm.nodeName.toLowerCase(),name)?dom.setStyle(getResizeTarget(selectedElm),name,value):dom.setAttrib(getResizeTarget(selectedElm),name,value))}setSizeProp("width",width),setSizeProp("height",height),dom.unbind(editableDoc,"mousemove",resizeGhostElement),dom.unbind(editableDoc,"mouseup",endGhostResize),rootDocument!==editableDoc&&(dom.unbind(rootDocument,"mousemove",resizeGhostElement),dom.unbind(rootDocument,"mouseup",endGhostResize)),dom.remove(selectedElmGhost),dom.remove(resizeHelper),showResizeRect(selectedElm),function(editor,target,width,height){editor.fire("ObjectResized",{target:target,width:width,height:height})}(editor,selectedElm,width,height),dom.setAttrib(selectedElm,"style",dom.getAttrib(selectedElm,"style")),editor.nodeChanged()},showResizeRect=function(targetElm){var position,targetWidth,targetHeight,e,rect;hideResizeRect(),unbindResizeHandleEvents(),position=dom.getPos(targetElm,rootElement),selectedElmX=position.x,selectedElmY=position.y,rect=targetElm.getBoundingClientRect(),targetWidth=rect.width||rect.right-rect.left,targetHeight=rect.height||rect.bottom-rect.top,selectedElm!==targetElm&&(selectedElm=targetElm,width=height=0),e=editor.fire("ObjectSelected",{target:targetElm}),isResizable(targetElm)&&!e.isDefaultPrevented()?each(resizeHandles,function(handle,name){var handleElm;(handleElm=dom.get("mceResizeHandle"+name))&&dom.remove(handleElm),handleElm=dom.add(rootElement,"div",{id:"mceResizeHandle"+name,"data-mce-bogus":"all",class:"mce-resizehandle",unselectable:!0,style:"cursor:"+name+"-resize; margin:0; padding:0"}),11===Env.ie&&(handleElm.contentEditable=!1),dom.bind(handleElm,"mousedown",function(e){e.stopImmediatePropagation(),e.preventDefault(),function(e){startX=e.screenX,startY=e.screenY,startW=getResizeTarget(selectedElm).clientWidth,startH=getResizeTarget(selectedElm).clientHeight,ratio=startH/startW,(selectedHandle=handle).startPos={x:targetWidth*handle[0]+selectedElmX,y:targetHeight*handle[1]+selectedElmY},startScrollWidth=rootElement.scrollWidth,startScrollHeight=rootElement.scrollHeight,selectedElmGhost=selectedElm.cloneNode(!0),dom.addClass(selectedElmGhost,"mce-clonedresizable"),dom.setAttrib(selectedElmGhost,"data-mce-bogus","all"),selectedElmGhost.contentEditable=!1,selectedElmGhost.unSelectabe=!0,dom.setStyles(selectedElmGhost,{left:selectedElmX,top:selectedElmY,margin:0}),selectedElmGhost.removeAttribute("data-mce-selected"),rootElement.appendChild(selectedElmGhost),dom.bind(editableDoc,"mousemove",resizeGhostElement),dom.bind(editableDoc,"mouseup",endGhostResize),rootDocument!==editableDoc&&(dom.bind(rootDocument,"mousemove",resizeGhostElement),dom.bind(rootDocument,"mouseup",endGhostResize)),resizeHelper=dom.add(rootElement,"div",{class:"mce-resize-helper","data-mce-bogus":"all"},startW+" &times; "+startH)}(e)}),handle.elm=handleElm,dom.setStyles(handleElm,{left:targetWidth*handle[0]+selectedElmX-handleElm.offsetWidth/2,top:targetHeight*handle[1]+selectedElmY-handleElm.offsetHeight/2})}):hideResizeRect(),selectedElm.setAttribute("data-mce-selected","1")},hideResizeRect=function(){var name,handleElm;for(name in unbindResizeHandleEvents(),selectedElm&&selectedElm.removeAttribute("data-mce-selected"),resizeHandles)(handleElm=dom.get("mceResizeHandle"+name))&&(dom.unbind(handleElm),dom.remove(handleElm))},unbindResizeHandleEvents=function(){for(var name_1 in resizeHandles){var handle=resizeHandles[name_1];handle.elm&&(dom.unbind(handle.elm),delete handle.elm)}},disableGeckoResize=function(){try{editor.getDoc().execCommand("enableObjectResizing",!1,!1)}catch(ex){}};return editor.on("init",function(){if(disableGeckoResize(),Env.browser.isIE()||Env.browser.isEdge()){editor.on("mousedown click",function(e){var target=e.target,nodeName=target.nodeName;resizeStarted||!/^(TABLE|IMG|HR)$/.test(nodeName)||isWithinContentEditableFalse(target)||(2!==e.button&&editor.selection.select(target,"TABLE"===nodeName),"mousedown"===e.type&&editor.nodeChanged())});var handleMSControlSelect_1=function(e){function delayedSelect(node){Delay.setEditorTimeout(editor,function(){return editor.selection.select(node)})}if(isWithinContentEditableFalse(e.target))return e.preventDefault(),void delayedSelect(e.target);/^(TABLE|IMG|HR)$/.test(e.target.nodeName)&&(e.preventDefault(),"IMG"===e.target.tagName&&delayedSelect(e.target))};dom.bind(rootElement,"mscontrolselect",handleMSControlSelect_1),editor.on("remove",function(){return dom.unbind(rootElement,"mscontrolselect",handleMSControlSelect_1)})}var throttledUpdateResizeRect=Delay.throttle(function(e){editor.composing||updateResizeRect(e)});editor.on("nodechange ResizeEditor ResizeWindow drop FullscreenStateChanged",throttledUpdateResizeRect),editor.on("keyup compositionend",function(e){selectedElm&&"TABLE"===selectedElm.nodeName&&throttledUpdateResizeRect(e)}),editor.on("hide blur",hideResizeRect),editor.on("contextmenu longpress",contextMenuSelectImage,!0)}),editor.on("remove",unbindResizeHandleEvents),{isResizable:isResizable,showResizeRect:showResizeRect,hideResizeRect:hideResizeRect,updateResizeRect:updateResizeRect,destroy:function(){selectedElm=selectedElmGhost=null}}}var BookmarkManager$1=BookmarkManager,RangePoint_isXYWithinRange=function(clientX,clientY,range){if(range.collapsed)return!1;if(Env.browser.isIE()&&range.startOffset===range.endOffset-1&&range.startContainer===range.endContainer){var elm=range.startContainer.childNodes[range.startOffset];if(NodeType.isElement(elm))return exists(elm.getClientRects(),function(rect){return containsXY(rect,clientX,clientY)})}return exists(range.getClientRects(),function(rect){return containsXY(rect,clientX,clientY)})},VK={BACKSPACE:8,DELETE:46,DOWN:40,ENTER:13,LEFT:37,RIGHT:39,SPACEBAR:32,TAB:9,UP:38,END:35,HOME:36,modifierPressed:function(e){return e.shiftKey||e.ctrlKey||e.altKey||this.metaKeyPressed(e)},metaKeyPressed:function(e){return Env.mac?e.metaKey:e.ctrlKey&&!e.altKey}},isContentEditableFalse$6=NodeType.isContentEditableFalse,isContentEditableTrue$2=NodeType.isContentEditableTrue;function find$3(element){var doc=Element.fromDom(domGlobals.document),scroll=get$1(doc),frames=function(element,navigation){var d=navigation.owner(element);return walkUp(navigation,d)}(element,Navigation),offset=viewport(element),r=foldr(frames,function(b,a){var loc=viewport(a);return{left:b.left+loc.left(),top:b.top+loc.top()}},{left:0,top:0});return Position(r.left+offset.left()+scroll.left(),r.top+offset.top()+scroll.top())}function excludeFromDescend(element){return"textarea"===name(element)}function markerInfo(element,cleanupFun){var pos=function(element){var doc=element.dom().ownerDocument,body=doc.body,win=doc.defaultView,html=doc.documentElement;if(body===element.dom())return Position(body.offsetLeft,body.offsetTop);var scrollTop=firstDefinedOrZero(win.pageYOffset,html.scrollTop),scrollLeft=firstDefinedOrZero(win.pageXOffset,html.scrollLeft),clientTop=firstDefinedOrZero(html.clientTop,body.clientTop),clientLeft=firstDefinedOrZero(html.clientLeft,body.clientLeft);return viewport(element).translate(scrollLeft-clientLeft,scrollTop-clientTop)}(element),height=function(element){return api$1.get(element)}(element);return{element:element,bottom:pos.top()+height,height:height,pos:pos,cleanup:cleanupFun}}function createMarker(element,offset){var startPoint=function(element,offset){var children$1=children(element);if(0===children$1.length||excludeFromDescend(element))return{element:element,offset:offset};if(offset<children$1.length&&!excludeFromDescend(children$1[offset]))return{element:children$1[offset],offset:0};var last=children$1[children$1.length-1];return excludeFromDescend(last)?{element:element,offset:offset}:"img"===name(last)?{element:last,offset:1}:isText(last)?{element:last,offset:get$7(last).length}:{element:last,offset:children(last).length}}(element,offset),span=Element.fromHtml('<span data-mce-bogus="all">'+Zwsp.ZWSP+"</span>");return before(startPoint.element,span),markerInfo(span,function(){return remove(span)})}function withMarker(editor,f,rng,alignToTop){preserveWith(editor,function(_s,_e){return applyWithMarker(editor,f,rng,alignToTop)},rng)}function withScrollEvents(editor,doc,f,marker,alignToTop){var data={elm:marker.element.dom(),alignToTop:alignToTop};!function(editor,data){return editor.fire("ScrollIntoView",data).isDefaultPrevented()}(editor,data)&&(f(doc,get$1(doc).top(),marker,alignToTop),function(editor,data){editor.fire("AfterScrollIntoView",data)}(editor,data))}function withElement(editor,element,f,alignToTop){var doc=Element.fromDom(editor.getDoc());withScrollEvents(editor,doc,f,function(element){return markerInfo(Element.fromDom(element),noop)}(element),alignToTop)}function scrollToMarker(marker,viewHeight,alignToTop,doc){var pos=marker.pos;if(alignToTop)to(pos.left(),pos.top(),doc);else{var y=pos.top()-viewHeight+marker.height;to(pos.left(),y,doc)}}function intoWindowIfNeeded(doc,scrollTop,viewHeight,marker,alignToTop){var viewportBottom=viewHeight+scrollTop,markerTop=marker.pos.top(),markerBottom=marker.bottom,largerThanViewport=viewHeight<=markerBottom-markerTop;if(markerTop<scrollTop)scrollToMarker(marker,viewHeight,!1!==alignToTop,doc);else if(viewportBottom<markerTop){scrollToMarker(marker,viewHeight,largerThanViewport?!1!==alignToTop:!0===alignToTop,doc)}else viewportBottom<markerBottom&&!largerThanViewport&&scrollToMarker(marker,viewHeight,!0===alignToTop,doc)}function intoWindow(doc,scrollTop,marker,alignToTop){var viewHeight=doc.dom().defaultView.innerHeight;intoWindowIfNeeded(doc,scrollTop,viewHeight,marker,alignToTop)}function intoFrame(doc,scrollTop,marker,alignToTop){var frameViewHeight=doc.dom().defaultView.innerHeight;intoWindowIfNeeded(doc,scrollTop,frameViewHeight,marker,alignToTop);var op=find$3(marker.element),viewportBounds=getBounds(domGlobals.window);op.top()<viewportBounds.y()?intoView(marker.element,!1!==alignToTop):op.top()>viewportBounds.bottom()&&intoView(marker.element,!0===alignToTop)}function rangeIntoWindow(editor,rng,alignToTop){return withMarker(editor,intoWindow,rng,alignToTop)}function elementIntoWindow(editor,element,alignToTop){return withElement(editor,element,intoWindow,alignToTop)}function rangeIntoFrame(editor,rng,alignToTop){return withMarker(editor,intoFrame,rng,alignToTop)}function elementIntoFrame(editor,element,alignToTop){return withElement(editor,element,intoFrame,alignToTop)}function hasCeProperty(node){return NodeType.isContentEditableTrue(node)||NodeType.isContentEditableFalse(node)}function fromElements(elements,scope){var fragment=(scope||domGlobals.document).createDocumentFragment();return each(elements,function(element){fragment.appendChild(element.dom())}),Element.fromDom(fragment)}function parentsUntil$1(start,root,predicate){return contains$2(root,start)?function(xs){return xs.slice(0,-1)}(function(element,isRoot){for(var stop=isFunction(isRoot)?isRoot:never,dom=element.dom(),ret=[];null!==dom.parentNode&&void 0!==dom.parentNode;){var rawParent=dom.parentNode,p=Element.fromDom(rawParent);if(ret.push(p),!0===stop(p))break;dom=rawParent}return ret}(start,function(elm){return predicate(elm)||eq(elm,root)})):[]}function parents$1(start,root){return parentsUntil$1(start,root,constant(!1))}function hasAllContentsSelected(elm,rng){return lift2(function(rng){var sc=rng.startContainer,so=rng.startOffset;return NodeType.isText(sc)?0===so?Option.some(Element.fromDom(sc)):Option.none():Option.from(sc.childNodes[so]).map(Element.fromDom)}(rng),function(rng){var ec=rng.endContainer,eo=rng.endOffset;return NodeType.isText(ec)?eo===ec.data.length?Option.some(Element.fromDom(ec)):Option.none():Option.from(ec.childNodes[eo-1]).map(Element.fromDom)}(rng),function(startNode,endNode){var start=find(getFirstChildren(elm),curry(eq,startNode)),end=find(getLastChildren(elm),curry(eq,endNode));return start.isSome()&&end.isSome()}).getOr(!1)}function moveEndPoint$1(dom,rng,node,start){var root=node,walker=new TreeWalker(node,root),nonEmptyElementsMap=dom.schema.getNonEmptyElements();do{if(3===node.nodeType&&0!==Tools.trim(node.nodeValue).length)return void(start?rng.setStart(node,0):rng.setEnd(node,node.nodeValue.length));if(nonEmptyElementsMap[node.nodeName]&&!/^(TD|TH)$/.test(node.nodeName))return void(start?rng.setStartBefore(node):"BR"===node.nodeName?rng.setEndBefore(node):rng.setEndAfter(node))}while(node=start?walker.next():walker.prev());"BODY"===root.nodeName&&(start?rng.setStart(root,0):rng.setEnd(root,root.childNodes.length))}function hasAnyRanges(editor){var sel=editor.selection.getSel();return sel&&0<sel.rangeCount}function getSpan(td,key){var value=parseInt(get$3(td,key),10);return isNaN(value)?1:value}function cellExists(table,x,y){var rows=table.rows();return!!(rows[y]?rows[y].cells():[])[x]}function getWidth(rows){return foldl(rows,function(acc,row){return row.cells().length>acc?row.cells().length:acc},0)}function findElementPos(table,element){for(var rows=table.rows(),y=0;y<rows.length;y++)for(var cells=rows[y].cells(),x=0;x<cells.length;x++)if(eq(cells[x],element))return Option.some(cellPosition(x,y));return Option.none()}function extractRows(table,sx,sy,ex,ey){for(var newRows=[],rows=table.rows(),y=sy;y<=ey;y++){var cells=rows[y].cells(),slice=sx<ex?cells.slice(sx,ex+1):cells.slice(ex,sx+1);newRows.push(tableRow(rows[y].element(),slice))}return newRows}function getRanges(selection){var ranges=[];if(selection)for(var i=0;i<selection.rangeCount;i++)ranges.push(selection.getRangeAt(i));return ranges}function getCellsFromRanges(ranges){return filter(MultiRange_getSelectedNodes(ranges),isTableCell)}function getCellsFromElement(elm){return descendants$1(elm,"td[data-mce-selected],th[data-mce-selected]")}function getCellsFromElementOrRanges(ranges,element){var selectedCells=getCellsFromElement(element),rangeCells=getCellsFromRanges(ranges);return 0<selectedCells.length?selectedCells:rangeCells}function getFullySelectedListWrappers(parents,rng){return find(parents,function(elm){return"li"===name(elm)&&hasAllContentsSelected(elm,rng)}).fold(constant([]),function(li){return function(parents){return find(parents,function(elm){return"ul"===name(elm)||"ol"===name(elm)})}(parents).map(function(listCont){return[Element.fromTag("li"),Element.fromTag(name(listCont))]}).getOr([])})}function getWrapElements(rootNode,rng){var commonAnchorContainer=Element.fromDom(rng.commonAncestorContainer),parents=Parents_parentsAndSelf(commonAnchorContainer,rootNode),wrapElements=filter(parents,function(elm){return isInline(elm)||isHeading(elm)}),listWrappers=getFullySelectedListWrappers(parents,rng),allWrappers=wrapElements.concat(listWrappers.length?listWrappers:function(commonAnchorContainer){return isListItem(commonAnchorContainer)?parent(commonAnchorContainer).filter(isList).fold(constant([]),function(listElm){return[commonAnchorContainer,listElm]}):isList(commonAnchorContainer)?[commonAnchorContainer]:[]}(commonAnchorContainer));return map(allWrappers,shallow)}function emptyFragment(){return fromElements([])}function getFragmentFromRange(rootNode,rng){return function(innerElm,elms){var wrapped=foldl(elms,function(acc,elm){return append(elm,acc),elm},innerElm);return 0<elms.length?fromElements([wrapped]):wrapped}(Element.fromDom(rng.cloneContents()),getWrapElements(rootNode,rng))}function getTableFragment(rootNode,selectedTableCells){return function(rootElm,cell){return ancestor$1(cell,"table",curry(eq,rootElm))}(rootNode,selectedTableCells[0]).bind(function(tableElm){var firstCell=selectedTableCells[0],lastCell=selectedTableCells[selectedTableCells.length-1],fullTableModel=SimpleTableModel_fromDom(tableElm);return SimpleTableModel_subsection(fullTableModel,firstCell,lastCell).map(function(sectionedTableModel){return fromElements([SimpleTableModel_toDom(sectionedTableModel)])})}).getOrThunk(emptyFragment)}function hasParent(node,rootNode,predicate){return null!==function(node,rootNode,predicate){for(;node&&node!==rootNode;){if(predicate(node))return node;node=node.parentNode}return null}(node,rootNode,predicate)}function hasParentWithName(node,rootNode,name){return hasParent(node,rootNode,function(node){return node.nodeName===name})}function isTable$3(node){return node&&"TABLE"===node.nodeName}function isTableCell$2(node){return node&&/^(TD|TH|CAPTION)$/.test(node.nodeName)}function isCeFalseCaretContainer(node,rootNode){return isCaretContainer(node)&&!1===hasParent(node,rootNode,isCaretNode)}function hasBrBeforeAfter(dom,node,left){for(var walker=new TreeWalker(node,dom.getParent(node.parentNode,dom.isBlock)||dom.getRoot());node=walker[left?"prev":"next"]();)if(NodeType.isBr(node))return!0}function findTextNodeRelative(dom,isAfterNode,collapsed,left,startNode){var lastInlineElement,node,body=dom.getRoot(),nonEmptyElementsMap=dom.schema.getNonEmptyElements(),parentBlockContainer=dom.getParent(startNode.parentNode,dom.isBlock)||body;if(left&&NodeType.isBr(startNode)&&isAfterNode&&dom.isEmpty(parentBlockContainer))return Option.some(CaretPosition(startNode.parentNode,dom.nodeIndex(startNode)));for(var walker=new TreeWalker(startNode,parentBlockContainer);node=walker[left?"prev":"next"]();){if("false"===dom.getContentEditableParent(node)||isCeFalseCaretContainer(node,body))return Option.none();if(NodeType.isText(node)&&0<node.nodeValue.length)return!1===hasParentWithName(node,body,"A")?Option.some(CaretPosition(node,left?node.nodeValue.length:0)):Option.none();if(dom.isBlock(node)||nonEmptyElementsMap[node.nodeName.toLowerCase()])return Option.none();lastInlineElement=node}return collapsed&&lastInlineElement?Option.some(CaretPosition(lastInlineElement,0)):Option.none()}function normalizeEndPoint(dom,collapsed,start,rng){var container,offset,node,nonEmptyElementsMap,directionLeft,isAfterNode,body=dom.getRoot(),normalized=!1;if(container=rng[(start?"start":"end")+"Container"],offset=rng[(start?"start":"end")+"Offset"],isAfterNode=NodeType.isElement(container)&&offset===container.childNodes.length,nonEmptyElementsMap=dom.schema.getNonEmptyElements(),directionLeft=start,isCaretContainer(container))return Option.none();if(NodeType.isElement(container)&&offset>container.childNodes.length-1&&(directionLeft=!1),NodeType.isDocument(container)&&(container=body,offset=0),container===body){if(directionLeft&&(node=container.childNodes[0<offset?offset-1:0])){if(isCaretContainer(node))return Option.none();if(nonEmptyElementsMap[node.nodeName]||isTable$3(node))return Option.none()}if(container.hasChildNodes()){if(offset=Math.min(!directionLeft&&0<offset?offset-1:offset,container.childNodes.length-1),container=container.childNodes[offset],offset=NodeType.isText(container)&&isAfterNode?container.data.length:0,!collapsed&&container===body.lastChild&&isTable$3(container))return Option.none();if(function(body,node){for(;node&&node!==body;){if(NodeType.isContentEditableFalse(node))return!0;node=node.parentNode}return!1}(body,container)||isCaretContainer(container))return Option.none();if(container.hasChildNodes()&&!1===isTable$3(container)){var walker=new TreeWalker(node=container,body);do{if(NodeType.isContentEditableFalse(node)||isCaretContainer(node)){normalized=!1;break}if(NodeType.isText(node)&&0<node.nodeValue.length){offset=directionLeft?0:node.nodeValue.length,container=node,normalized=!0;break}if(nonEmptyElementsMap[node.nodeName.toLowerCase()]&&!isTableCell$2(node)){offset=dom.nodeIndex(node),container=node.parentNode,directionLeft||offset++,normalized=!0;break}}while(node=directionLeft?walker.next():walker.prev())}}}return collapsed&&(NodeType.isText(container)&&0===offset&&findTextNodeRelative(dom,isAfterNode,collapsed,!0,container).each(function(pos){container=pos.container(),offset=pos.offset(),normalized=!0}),NodeType.isElement(container)&&(!(node=(node=container.childNodes[offset])||container.childNodes[offset-1])||!NodeType.isBr(node)||function(node,name){return node.previousSibling&&node.previousSibling.nodeName===name}(node,"A")||hasBrBeforeAfter(dom,node,!1)||hasBrBeforeAfter(dom,node,!0)||findTextNodeRelative(dom,isAfterNode,collapsed,!0,node).each(function(pos){container=pos.container(),offset=pos.offset(),normalized=!0}))),directionLeft&&!collapsed&&NodeType.isText(container)&&offset===container.nodeValue.length&&findTextNodeRelative(dom,isAfterNode,collapsed,!1,container).each(function(pos){container=pos.container(),offset=pos.offset(),normalized=!0}),normalized?Option.some(CaretPosition(container,offset)):Option.none()}function removeEmpty(text){return 0===text.dom().length?(remove(text),Option.none()):Option.some(text)}function getEndpointElement(root,rng,start,real,resolve){var container=start?rng.startContainer:rng.endContainer,offset=start?rng.startOffset:rng.endOffset;return Option.from(container).map(Element.fromDom).map(function(elm){return real&&rng.collapsed?elm:child(elm,resolve(elm,offset)).getOr(elm)}).bind(function(elm){return isElement(elm)?Option.some(elm):parent(elm)}).map(function(elm){return elm.dom()}).getOr(root)}function getStart$2(root,rng,real){return getEndpointElement(root,rng,!0,real,function(elm,offset){return Math.min(function(element){return element.dom().childNodes.length}(elm),offset)})}function getEnd(root,rng,real){return getEndpointElement(root,rng,!1,real,function(elm,offset){return 0<offset?offset-1:offset})}function skipEmptyTextNodes(node,forwards){for(var orig=node;node&&NodeType.isText(node)&&0===node.length;)node=forwards?node.nextSibling:node.previousSibling;return node||orig}function deleteFromCallbackMap(callbackMap,selector,callback){if(callbackMap&&callbackMap.hasOwnProperty(selector)){var newCallbacks=filter(callbackMap[selector],function(cb){return cb!==callback});0===newCallbacks.length?delete callbackMap[selector]:callbackMap[selector]=newCallbacks}}var api$1=function(name,getOffset){function get(element){var r=getOffset(element);if(r<=0||null===r){var css=get$4(element,name);return parseFloat(css)||0}return r}function aggregate(element,properties){return foldl(properties,function(acc,property){var val=get$4(element,property),value=void 0===val?0:parseInt(val,10);return isNaN(value)?acc:acc+value},0)}return{set:function(element,h){if(!isNumber(h)&&!h.match(/^[0-9]+$/))throw new Error(name+".set accepts only positive integer values. Value was "+h);var dom=element.dom();isSupported(dom)&&(dom.style[name]=h+"px")},get:get,getOuter:get,aggregate:aggregate,max:function(element,value,properties){var cumulativeInclusions=aggregate(element,properties);return cumulativeInclusions<value?value-cumulativeInclusions:0}}}("height",function(element){var dom=element.dom();return inBody(element)?dom.getBoundingClientRect().height:dom.offsetHeight}),walkUp=function(navigation,doc){return navigation.view(doc).fold(constant([]),function(f){var parent=navigation.owner(f),rest=walkUp(navigation,parent);return[f].concat(rest)})},Navigation=Object.freeze({__proto__:null,view:function(doc){return(doc.dom()===domGlobals.document?Option.none():Option.from(doc.dom().defaultView.frameElement)).map(Element.fromDom)},owner:function(element){return owner(element)}}),applyWithMarker=function(editor,f,rng,alignToTop){var body=Element.fromDom(editor.getBody()),doc=Element.fromDom(editor.getDoc());!function(e){e.dom().offsetWidth}(body);var marker=createMarker(Element.fromDom(rng.startContainer),rng.startOffset);withScrollEvents(editor,doc,f,marker,alignToTop),marker.cleanup()},preserveWith=function(editor,f,rng){var startElement=rng.startContainer,startOffset=rng.startOffset,endElement=rng.endContainer,endOffset=rng.endOffset;f(Element.fromDom(startElement),Element.fromDom(endElement));var newRng=editor.dom.createRng();newRng.setStart(startElement,startOffset),newRng.setEnd(endElement,endOffset),editor.selection.setRng(rng)},ScrollIntoView_scrollElementIntoView=function(editor,element,alignToTop){(editor.inline?elementIntoWindow:elementIntoFrame)(editor,element,alignToTop)},ScrollIntoView_scrollRangeIntoView=function(editor,rng,alignToTop){(editor.inline?rangeIntoWindow:rangeIntoFrame)(editor,rng,alignToTop)},CaretRangeFromPoint_fromPoint=function(clientX,clientY,doc){var rng,point,pointDoc=doc;if(pointDoc.caretPositionFromPoint)(point=pointDoc.caretPositionFromPoint(clientX,clientY))&&((rng=doc.createRange()).setStart(point.offsetNode,point.offset),rng.collapse(!0));else if(doc.caretRangeFromPoint)rng=doc.caretRangeFromPoint(clientX,clientY);else if(pointDoc.body.createTextRange){rng=pointDoc.body.createTextRange();try{rng.moveToPoint(clientX,clientY),rng.collapse(!0)}catch(ex){rng=function(clientX,clientY,doc){var element,rng,rects;if(element=doc.elementFromPoint(clientX,clientY),rng=doc.body.createTextRange(),element&&"HTML"!==element.tagName||(element=doc.body),rng.moveToElementText(element),0<(rects=(rects=Tools.toArray(rng.getClientRects())).sort(function(a,b){return(a=Math.abs(Math.max(a.top-clientY,a.bottom-clientY)))-(b=Math.abs(Math.max(b.top-clientY,b.bottom-clientY)))})).length){clientY=(rects[0].bottom+rects[0].top)/2;try{return rng.moveToPoint(clientX,clientY),rng.collapse(!0),rng}catch(ex){}}return null}(clientX,clientY,doc)}return function(rng,rootNode){var parentElement=rng&&rng.parentElement?rng.parentElement():null;return NodeType.isContentEditableFalse(function(node,rootNode,predicate){for(;node&&node!==rootNode;){if(predicate(node))return node;node=node.parentNode}return null}(parentElement,rootNode,hasCeProperty))?null:rng}(rng,doc.body)}return rng},EventProcessRanges_processRanges=function(editor,ranges){return map(ranges,function(range){var evt=editor.fire("GetSelectionRange",{range:range});return evt.range!==range?evt.range:range})},Parents_parents=parents$1,Parents_parentsAndSelf=function(start,root){return[start].concat(parents$1(start,root))},getFirstChildren=function(node){return firstChild(node).fold(constant([node]),function(child){return[node].concat(getFirstChildren(child))})},getLastChildren=function(node){return lastChild(node).fold(constant([node]),function(child){return"br"===name(child)?prevSibling(child).map(function(sibling){return[node].concat(getLastChildren(sibling))}).getOr([]):[node].concat(getLastChildren(child))})},tableModel=Immutable("element","width","rows"),tableRow=Immutable("element","cells"),cellPosition=Immutable("x","y"),SimpleTableModel_fromDom=function(tableElm){var table=tableModel(shallow(tableElm),0,[]);return each(descendants$1(tableElm,"tr"),function(tr,y){each(descendants$1(tr,"td,th"),function(td,x){!function(table,x,y,tr,td){for(var rowspan=getSpan(td,"rowspan"),colspan=getSpan(td,"colspan"),rows=table.rows(),y2=y;y2<y+rowspan;y2++){rows[y2]||(rows[y2]=tableRow(deep(tr),[]));for(var x2=x;x2<x+colspan;x2++){rows[y2].cells()[x2]=y2===y&&x2===x?td:shallow(td)}}}(table,function(table,x,y){for(;cellExists(table,x,y);)x++;return x}(table,x,y),y,tr,td)})}),tableModel(table.element(),getWidth(table.rows()),table.rows())},SimpleTableModel_toDom=function(table){return function(table,rows){var tableElement=shallow(table.element()),tableBody=Element.fromTag("tbody");return append$1(tableBody,rows),append(tableElement,tableBody),tableElement}(table,function(table){return map(table.rows(),function(row){var cells=map(row.cells(),function(cell){var td=deep(cell);return remove$1(td,"colspan"),remove$1(td,"rowspan"),td}),tr=shallow(row.element());return append$1(tr,cells),tr})}(table))},SimpleTableModel_subsection=function(table,startElement,endElement){return findElementPos(table,startElement).bind(function(startPos){return findElementPos(table,endElement).map(function(endPos){return function(table,startPos,endPos){var sx=startPos.x(),sy=startPos.y(),ex=endPos.x(),ey=endPos.y(),newRows=sy<ey?extractRows(table,sx,sy,ex,ey):extractRows(table,sx,ey,ex,sy);return tableModel(table.element(),getWidth(newRows),newRows)}(table,startPos,endPos)})})},MultiRange_getRanges=getRanges,MultiRange_getSelectedNodes=function(ranges){return bind(ranges,function(range){var node=getSelectedNode(range);return node?[Element.fromDom(node)]:[]})},MultiRange_hasMultipleRanges=function(selection){return 1<getRanges(selection).length},TableCellSelection_getCellsFromElementOrRanges=getCellsFromElementOrRanges,TableCellSelection_getCellsFromEditor=function(editor){return getCellsFromElementOrRanges(MultiRange_getRanges(editor.selection.getSel()),Element.fromDom(editor.getBody()))},FragmentReader_read=function(rootNode,ranges){var selectedCells=TableCellSelection_getCellsFromElementOrRanges(ranges,rootNode);return 0<selectedCells.length?getTableFragment(rootNode,selectedCells):function(rootNode,ranges){return 0<ranges.length&&ranges[0].collapsed?emptyFragment():getFragmentFromRange(rootNode,ranges[0])}(rootNode,ranges)},GetSelectionContent_getContent=function(editor,args){if(void 0===args&&(args={}),args.get=!0,args.format=args.format||"html",args.selection=!0,(args=editor.fire("BeforeGetContent",args)).isDefaultPrevented())return editor.fire("GetContent",args),args.content;if("text"===args.format)return function(editor){return Option.from(editor.selection.getRng()).map(function(rng){var bin=editor.dom.add(editor.getBody(),"div",{"data-mce-bogus":"all",style:"overflow: hidden; opacity: 0;"},rng.cloneContents()),text=Zwsp.trim(bin.innerText);return editor.dom.remove(bin),text}).getOr("")}(editor);args.getInner=!0;var content=function(editor,args){var fragment,rng=editor.selection.getRng(),tmpElm=editor.dom.create("body"),sel=editor.selection.getSel(),ranges=EventProcessRanges_processRanges(editor,MultiRange_getRanges(sel));return(fragment=args.contextual?FragmentReader_read(Element.fromDom(editor.getBody()),ranges).dom():rng.cloneContents())&&tmpElm.appendChild(fragment),editor.selection.serializer.serialize(tmpElm,args)}(editor,args);return"tree"===args.format?content:(args.content=editor.selection.isCollapsed()?"":content,editor.fire("GetContent",args),args.content)},RangeCompare_isEq=function(rng1,rng2){return rng1&&rng2&&rng1.startContainer===rng2.startContainer&&rng1.startOffset===rng2.startOffset&&rng1.endContainer===rng2.endContainer&&rng1.endOffset===rng2.endOffset},NormalizeRange_normalize=function(dom,rng){var collapsed=rng.collapsed,normRng=rng.cloneRange(),startPos=CaretPosition.fromRangeStart(rng);return normalizeEndPoint(dom,collapsed,!0,normRng).each(function(pos){collapsed&&CaretPosition.isAbove(startPos,pos)||normRng.setStart(pos.container(),pos.offset())}),collapsed||normalizeEndPoint(dom,collapsed,!1,normRng).each(function(pos){normRng.setEnd(pos.container(),pos.offset())}),collapsed&&normRng.collapse(!0),RangeCompare_isEq(rng,normRng)?Option.none():Option.some(normRng)},SetSelectionContent_setContent=function(editor,content,args){if((args=function(args,content){return(args=args||{format:"html"}).set=!0,args.selection=!0,args.content=content,args}(args,content)).no_events||!(args=editor.fire("BeforeSetContent",args)).isDefaultPrevented()){var rng=editor.selection.getRng();!function(rng,fragment){var firstChild=Option.from(fragment.firstChild).map(Element.fromDom),lastChild=Option.from(fragment.lastChild).map(Element.fromDom);rng.deleteContents(),rng.insertNode(fragment);var prevText=firstChild.bind(prevSibling).filter(isText).bind(removeEmpty),nextText=lastChild.bind(nextSibling).filter(isText).bind(removeEmpty);lift2(prevText,firstChild.filter(isText),function(prev,start){!function(target,data){target.insertData(0,data)}(start.dom(),prev.dom().data),remove(prev)}),lift2(nextText,lastChild.filter(isText),function(next,end){var oldLength=end.dom().length;end.dom().appendData(next.dom().data),rng.setEnd(end.dom(),oldLength),remove(next)}),rng.collapse(!1)}(rng,rng.createContextualFragment(args.content)),editor.selection.setRng(rng),ScrollIntoView_scrollRangeIntoView(editor,rng),args.no_events||editor.fire("SetContent",args)}else editor.fire("SetContent",args)};function isNativeIeSelection(rng){return!!rng.select}function isAttachedToDom(node){return!(!node||!node.ownerDocument)&&contains$2(Element.fromDom(node.ownerDocument),Element.fromDom(node))}function Selection$1(dom,win,serializer,editor){function setContent(content,args){return SetSelectionContent_setContent(editor,content,args)}function isForward(){var anchorRange,focusRange,sel=getSel();return!(sel&&sel.anchorNode&&sel.focusNode)||((anchorRange=dom.createRng()).setStart(sel.anchorNode,sel.anchorOffset),anchorRange.collapse(!0),(focusRange=dom.createRng()).setStart(sel.focusNode,sel.focusOffset),focusRange.collapse(!0),anchorRange.compareBoundaryPoints(anchorRange.START_TO_START,focusRange)<=0)}var bookmarkManager,controlSelection,selectedRange,explicitRange,selectorChangedWithUnbind=function(dom,editor){var selectorChangedData,currentSelectors;return{selectorChangedWithUnbind:function(selector,callback){return selectorChangedData||(selectorChangedData={},currentSelectors={},editor.on("NodeChange",function(e){var node=e.element,parents=dom.getParents(node,null,dom.getRoot()),matchedSelectors={};Tools.each(selectorChangedData,function(callbacks,selector){Tools.each(parents,function(node){if(dom.is(node,selector))return currentSelectors[selector]||(Tools.each(callbacks,function(callback){callback(!0,{node:node,selector:selector,parents:parents})}),currentSelectors[selector]=callbacks),matchedSelectors[selector]=callbacks,!1})}),Tools.each(currentSelectors,function(callbacks,selector){matchedSelectors[selector]||(delete currentSelectors[selector],Tools.each(callbacks,function(callback){callback(!1,{node:node,selector:selector,parents:parents})}))})})),selectorChangedData[selector]||(selectorChangedData[selector]=[]),selectorChangedData[selector].push(callback),{unbind:function(){deleteFromCallbackMap(selectorChangedData,selector,callback),deleteFromCallbackMap(currentSelectors,selector,callback)}}}}}(dom,editor).selectorChangedWithUnbind,collapse=function(toStart){var rng=getRng();rng.collapse(!!toStart),setRng(rng)},getSel=function(){return win.getSelection?win.getSelection():win.document.selection},getRng=function(){function tryCompareBoundaryPoints(how,sourceRange,destinationRange){try{return sourceRange.compareBoundaryPoints(how,destinationRange)}catch(ex){return-1}}var selection,rng,elm,doc;if(!win)return null;if(null==(doc=win.document))return null;if(void 0!==editor.bookmark&&!1===EditorFocus_hasFocus(editor)){var bookmark=SelectionBookmark_getRng(editor);if(bookmark.isSome())return bookmark.map(function(r){return EventProcessRanges_processRanges(editor,[r])[0]}).getOr(doc.createRange())}try{(selection=getSel())&&!NodeType.isRestrictedNode(selection.anchorNode)&&(rng=0<selection.rangeCount?selection.getRangeAt(0):selection.createRange?selection.createRange():doc.createRange())}catch(ex){}return(rng=(rng=EventProcessRanges_processRanges(editor,[rng])[0])||(doc.createRange?doc.createRange():doc.body.createTextRange())).setStart&&9===rng.startContainer.nodeType&&rng.collapsed&&(elm=dom.getRoot(),rng.setStart(elm,0),rng.setEnd(elm,0)),selectedRange&&explicitRange&&(0===tryCompareBoundaryPoints(rng.START_TO_START,rng,selectedRange)&&0===tryCompareBoundaryPoints(rng.END_TO_END,rng,selectedRange)?rng=explicitRange:explicitRange=selectedRange=null),rng},setRng=function(rng,forward){var sel,node;if(function(rng){return!!rng&&(!!isNativeIeSelection(rng)||isAttachedToDom(rng.startContainer)&&isAttachedToDom(rng.endContainer))}(rng)){var ieRange=isNativeIeSelection(rng)?rng:null;if(ieRange){explicitRange=null;try{ieRange.select()}catch(ex){}}else{if(sel=getSel(),rng=editor.fire("SetSelectionRange",{range:rng,forward:forward}).range,sel){explicitRange=rng;try{sel.removeAllRanges(),sel.addRange(rng)}catch(ex){}!1===forward&&sel.extend&&(sel.collapse(rng.endContainer,rng.endOffset),sel.extend(rng.startContainer,rng.startOffset)),selectedRange=0<sel.rangeCount?sel.getRangeAt(0):null}rng.collapsed||rng.startContainer!==rng.endContainer||!sel.setBaseAndExtent||Env.ie||rng.endOffset-rng.startOffset<2&&rng.startContainer.hasChildNodes()&&(node=rng.startContainer.childNodes[rng.startOffset])&&"IMG"===node.tagName&&(sel.setBaseAndExtent(rng.startContainer,rng.startOffset,rng.endContainer,rng.endOffset),sel.anchorNode===rng.startContainer&&sel.focusNode===rng.endContainer||sel.setBaseAndExtent(node,0,node,1)),editor.fire("AfterSetSelectionRange",{range:rng,forward:forward})}}},exports={bookmarkManager:null,controlSelection:null,dom:dom,win:win,serializer:serializer,editor:editor,collapse:collapse,setCursorLocation:function(node,offset){var rng=dom.createRng();node?(rng.setStart(node,offset),rng.setEnd(node,offset),setRng(rng),collapse(!1)):(moveEndPoint$1(dom,rng,editor.getBody(),!0),setRng(rng))},getContent:function(args){return GetSelectionContent_getContent(editor,args)},setContent:setContent,getBookmark:function(type,normalized){return bookmarkManager.getBookmark(type,normalized)},moveToBookmark:function(bookmark){return bookmarkManager.moveToBookmark(bookmark)},select:function(node,content){return function(dom,node,content){return Option.from(node).map(function(node){var idx=dom.nodeIndex(node),rng=dom.createRng();return rng.setStart(node.parentNode,idx),rng.setEnd(node.parentNode,idx+1),content&&(moveEndPoint$1(dom,rng,node,!0),moveEndPoint$1(dom,rng,node,!1)),rng})}(dom,node,content).each(setRng),node},isCollapsed:function(){var rng=getRng(),sel=getSel();return!(!rng||rng.item)&&(rng.compareEndPoints?0===rng.compareEndPoints("StartToEnd",rng):!sel||rng.collapsed)},isForward:isForward,setNode:function(elm){return setContent(dom.getOuterHTML(elm)),elm},getNode:function(){return function(root,rng){var elm,startContainer,endContainer,startOffset,endOffset;return rng?(startContainer=rng.startContainer,endContainer=rng.endContainer,startOffset=rng.startOffset,endOffset=rng.endOffset,elm=rng.commonAncestorContainer,!rng.collapsed&&(startContainer===endContainer&&endOffset-startOffset<2&&startContainer.hasChildNodes()&&(elm=startContainer.childNodes[startOffset]),3===startContainer.nodeType&&3===endContainer.nodeType&&(startContainer=startContainer.length===startOffset?skipEmptyTextNodes(startContainer.nextSibling,!0):startContainer.parentNode,endContainer=0===endOffset?skipEmptyTextNodes(endContainer.previousSibling,!1):endContainer.parentNode,startContainer&&startContainer===endContainer))?startContainer:elm&&3===elm.nodeType?elm.parentNode:elm):root}(editor.getBody(),getRng())},getSel:getSel,setRng:setRng,getRng:getRng,getStart:function(real){return getStart$2(editor.getBody(),getRng(),real)},getEnd:function(real){return getEnd(editor.getBody(),getRng(),real)},getSelectedBlocks:function(startElm,endElm){return function(dom,rng,startElm,endElm){var node,root,selectedBlocks=[];if(root=dom.getRoot(),startElm=dom.getParent(startElm||getStart$2(root,rng,rng.collapsed),dom.isBlock),endElm=dom.getParent(endElm||getEnd(root,rng,rng.collapsed),dom.isBlock),startElm&&startElm!==root&&selectedBlocks.push(startElm),startElm&&endElm&&startElm!==endElm)for(var walker=new TreeWalker(node=startElm,root);(node=walker.next())&&node!==endElm;)dom.isBlock(node)&&selectedBlocks.push(node);return endElm&&startElm!==endElm&&endElm!==root&&selectedBlocks.push(endElm),selectedBlocks}(dom,getRng(),startElm,endElm)},normalize:function(){var rng=getRng(),sel=getSel();if(MultiRange_hasMultipleRanges(sel)||!hasAnyRanges(editor))return rng;var normRng=NormalizeRange_normalize(dom,rng);return normRng.each(function(normRng){setRng(normRng,isForward())}),normRng.getOr(rng)},selectorChanged:function(selector,callback){return selectorChangedWithUnbind(selector,callback),exports},selectorChangedWithUnbind:selectorChangedWithUnbind,getScrollContainer:function(){for(var scrollContainer,node=dom.getRoot();node&&"BODY"!==node.nodeName;){if(node.scrollHeight>node.clientHeight){scrollContainer=node;break}node=node.parentNode}return scrollContainer},scrollIntoView:function(elm,alignToTop){return ScrollIntoView_scrollElementIntoView(editor,elm,alignToTop)},placeCaretAt:function(clientX,clientY){return setRng(CaretRangeFromPoint_fromPoint(clientX,clientY,editor.getDoc()))},getBoundingClientRect:function(){var rng=getRng();return rng.collapsed?CaretPosition$1.fromRangeStart(rng).getClientRects()[0]:rng.getBoundingClientRect()},destroy:function(){win=selectedRange=explicitRange=null,controlSelection.destroy()}};return bookmarkManager=BookmarkManager$1(exports),controlSelection=ControlSelection(exports,editor),exports.bookmarkManager=bookmarkManager,exports.controlSelection=controlSelection,exports}function addFontToSpansFilter(domParser,styles,fontSizes){domParser.addNodeFilter("font",function(nodes){each(nodes,function(node){var props=styles.parse(node.attr("style")),color=node.attr("color"),face=node.attr("face"),size=node.attr("size");color&&(props.color=color),face&&(props["font-family"]=face),size&&(props["font-size"]=fontSizes[parseInt(node.attr("size"),10)-1]),node.name="span",node.attr("style",styles.serialize(props)),function(node,names){each(names,function(name){node.attr(name,null)})}(node,["color","face","size"])})})}function addFilters(domParser,settings){var styles=Styles();settings.convert_fonts_to_spans&&addFontToSpansFilter(domParser,styles,Tools.explode(settings.font_size_legacy_values)),function(domParser,styles){domParser.addNodeFilter("strike",function(nodes){each(nodes,function(node){var props=styles.parse(node.attr("style"));props["text-decoration"]="line-through",node.name="span",node.attr("style",styles.serialize(props))})})}(domParser,styles)}function paddEmptyNode(settings,args,blockElements,node){(settings.padd_empty_with_br||args.insert)&&blockElements[node.name]?node.empty().append(new Node$1("br",1)).shortEnded=!0:node.empty().append(new Node$1("#text",3)).value=""}function isEmpty$1(schema,nonEmptyElements,whitespaceElements,node){return node.isEmpty(nonEmptyElements,whitespaceElements,function(node){return function(schema,node){var rule=schema.getElementRule(node.name);return rule&&rule.paddEmpty}(schema,node)})}function register$2(parser,settings){var schema=parser.schema;settings.remove_trailing_brs&&parser.addNodeFilter("br",function(nodes,_,args){var i,node,parent,lastParent,prev,prevName,elementRule,textNode,l=nodes.length,blockElements=Tools.extend({},schema.getBlockElements()),nonEmptyElements=schema.getNonEmptyElements(),whiteSpaceElements=schema.getNonEmptyElements();for(blockElements.body=1,i=0;i<l;i++)if(parent=(node=nodes[i]).parent,blockElements[node.parent.name]&&node===parent.lastChild){for(prev=node.prev;prev;){if("span"!==(prevName=prev.name)||"bookmark"!==prev.attr("data-mce-type")){if("br"!==prevName)break;if("br"===prevName){node=null;break}}prev=prev.prev}node&&(node.remove(),isEmpty$1(schema,nonEmptyElements,whiteSpaceElements,parent)&&(elementRule=schema.getElementRule(parent.name))&&(elementRule.removeEmpty?parent.remove():elementRule.paddEmpty&&paddEmptyNode(settings,args,blockElements,parent)))}else{for(lastParent=node;parent&&parent.firstChild===lastParent&&parent.lastChild===lastParent&&!blockElements[(lastParent=parent).name];)parent=parent.parent;lastParent===parent&&!0!==settings.padd_empty_with_br&&((textNode=new Node$1("#text",3)).value="",node.replace(textNode))}}),parser.addAttributeFilter("href",function(nodes){var node,rel,newRel,i=nodes.length;if(!settings.allow_unsafe_link_target)for(;i--;)"a"===(node=nodes[i]).name&&"_blank"===node.attr("target")&&node.attr("rel",(rel=node.attr("rel"),void 0,newRel=rel?Tools.trim(rel):"",/\b(noopener)\b/g.test(newRel)?newRel:function(rel){return rel.split(" ").filter(function(p){return 0<p.length}).concat(["noopener"]).sort().join(" ")}(newRel)))}),settings.allow_html_in_named_anchor||parser.addAttributeFilter("id,name",function(nodes){for(var sibling,prevSibling,parent,node,i=nodes.length;i--;)if("a"===(node=nodes[i]).name&&node.firstChild&&!node.attr("href"))for(parent=node.parent,sibling=node.lastChild;prevSibling=sibling.prev,parent.insert(sibling,node),sibling=prevSibling;);}),settings.fix_list_elements&&parser.addNodeFilter("ul,ol",function(nodes){for(var node,parentNode,i=nodes.length;i--;)if("ul"===(parentNode=(node=nodes[i]).parent).name||"ol"===parentNode.name)if(node.prev&&"li"===node.prev.name)node.prev.append(node);else{var li=new Node$1("li",1);li.attr("style","list-style-type: none"),node.wrap(li)}}),settings.validate&&schema.getValidClasses()&&parser.addAttributeFilter("class",function(nodes){for(var node,classList,ci,className,classValue,validClassesMap,valid,i=nodes.length,validClasses=schema.getValidClasses();i--;){for(classList=(node=nodes[i]).attr("class").split(" "),classValue="",ci=0;ci<classList.length;ci++)className=classList[ci],valid=!1,(validClassesMap=validClasses["*"])&&validClassesMap[className]&&(valid=!0),validClassesMap=validClasses[node.name],!valid&&validClassesMap&&validClassesMap[className]&&(valid=!0),valid&&(classValue&&(classValue+=" "),classValue+=className);classValue.length||(classValue=null),node.attr("class",classValue)}})}function DomParser(settings,schema){void 0===schema&&(schema=Schema());var nodeFilters={},attributeFilters=[],matchedNodes={},matchedAttributes={};(settings=settings||{}).validate=!("validate"in settings)||settings.validate,settings.root_name=settings.root_name||"body";var filterNode=function(node){var i,name,list;(name=node.name)in nodeFilters&&((list=matchedNodes[name])?list.push(node):matchedNodes[name]=[node]),i=attributeFilters.length;for(;i--;)(name=attributeFilters[i].name)in node.attributes.map&&((list=matchedAttributes[name])?list.push(node):matchedAttributes[name]=[node]);return node},exports={schema:schema,addAttributeFilter:function(name,callback){each$8(explode$2(name),function(name){var i;for(i=0;i<attributeFilters.length;i++)if(attributeFilters[i].name===name)return void attributeFilters[i].callbacks.push(callback);attributeFilters.push({name:name,callbacks:[callback]})})},getAttributeFilters:function(){return[].concat(attributeFilters)},addNodeFilter:function(name,callback){each$8(explode$2(name),function(name){var list=nodeFilters[name];list||(nodeFilters[name]=list=[]),list.push(callback)})},getNodeFilters:function(){var out=[];for(var name_1 in nodeFilters)nodeFilters.hasOwnProperty(name_1)&&out.push({name:name_1,callbacks:nodeFilters[name_1]});return out},filterNode:filterNode,parse:function(html,args){var parser,nodes,i,l,fi,fl,list,name,blockElements,isInWhiteSpacePreservedElement,node,invalidChildren=[];args=args||{},matchedNodes={},matchedAttributes={},blockElements=extend$2(makeMap$4("script,style,head,html,body,title,meta,param"),schema.getBlockElements());var nonEmptyElements=schema.getNonEmptyElements(),children=schema.children,validate=settings.validate,rootBlockName=function(name){return!1===name?"":!0===name?"p":name}("forced_root_block"in args?args.forced_root_block:settings.forced_root_block),whiteSpaceElements=schema.getWhiteSpaceElements(),startWhiteSpaceRegExp=/^[ \t\r\n]+/,endWhiteSpaceRegExp=/[ \t\r\n]+$/,allWhiteSpaceRegExp=/[ \t\r\n]+/g,isAllWhiteSpaceRegExp=/^[ \t\r\n]+$/;isInWhiteSpacePreservedElement=whiteSpaceElements.hasOwnProperty(args.context)||whiteSpaceElements.hasOwnProperty(settings.root_name);function removeWhitespaceBefore(node){var textNode,textNodeNext,textVal,sibling,blockElements=schema.getBlockElements();for(textNode=node.prev;textNode&&3===textNode.type;){if(0<(textVal=textNode.value.replace(endWhiteSpaceRegExp,"")).length)return void(textNode.value=textVal);if(textNodeNext=textNode.next){if(3===textNodeNext.type&&textNodeNext.value.length){textNode=textNode.prev;continue}if(!blockElements[textNodeNext.name]&&"script"!==textNodeNext.name&&"style"!==textNodeNext.name){textNode=textNode.prev;continue}}sibling=textNode.prev,textNode.remove(),textNode=sibling}}var createNode=function(name,type){var list,node=new Node$1(name,type);return name in nodeFilters&&((list=matchedNodes[name])?list.push(node):matchedNodes[name]=[node]),node};parser=SaxParser$1({validate:validate,allow_script_urls:settings.allow_script_urls,allow_conditional_comments:settings.allow_conditional_comments,preserve_cdata:settings.preserve_cdata,self_closing_elements:function(input){var name,output={};for(name in input)"li"!==name&&"p"!==name&&(output[name]=input[name]);return output}(schema.getSelfClosingElements()),cdata:function(text){node.append(createNode("#cdata",4)).value=text},text:function(text,raw){var textNode;isInWhiteSpacePreservedElement||(text=text.replace(allWhiteSpaceRegExp," "),function(node,blockElements){return node&&(blockElements[node.name]||"br"===node.name)}(node.lastChild,blockElements)&&(text=text.replace(startWhiteSpaceRegExp,""))),0!==text.length&&((textNode=createNode("#text",3)).raw=!!raw,node.append(textNode).value=text)},comment:function(text){node.append(createNode("#comment",8)).value=text},pi:function(name,text){node.append(createNode(name,7)).value=text,removeWhitespaceBefore(node)},doctype:function(text){node.append(createNode("#doctype",10)).value=text,removeWhitespaceBefore(node)},start:function(name,attrs,empty){var newNode,attrFiltersLen,elementRule,attrName,parent;if(elementRule=validate?schema.getElementRule(name):{}){for((newNode=createNode(elementRule.outputName||name,1)).attributes=attrs,newNode.shortEnded=empty,node.append(newNode),(parent=children[node.name])&&children[newNode.name]&&!parent[newNode.name]&&invalidChildren.push(newNode),attrFiltersLen=attributeFilters.length;attrFiltersLen--;)(attrName=attributeFilters[attrFiltersLen].name)in attrs.map&&((list=matchedAttributes[attrName])?list.push(newNode):matchedAttributes[attrName]=[newNode]);blockElements[name]&&removeWhitespaceBefore(newNode),empty||(node=newNode),!isInWhiteSpacePreservedElement&&whiteSpaceElements[name]&&(isInWhiteSpacePreservedElement=!0)}},end:function(name){var textNode,elementRule,text,sibling,tempNode;if(elementRule=validate?schema.getElementRule(name):{}){if(blockElements[name]&&!isInWhiteSpacePreservedElement){if((textNode=node.firstChild)&&3===textNode.type)if(0<(text=textNode.value.replace(startWhiteSpaceRegExp,"")).length)textNode.value=text,textNode=textNode.next;else for(sibling=textNode.next,textNode.remove(),textNode=sibling;textNode&&3===textNode.type;)text=textNode.value,sibling=textNode.next,0!==text.length&&!isAllWhiteSpaceRegExp.test(text)||(textNode.remove(),textNode=sibling),textNode=sibling;if((textNode=node.lastChild)&&3===textNode.type)if(0<(text=textNode.value.replace(endWhiteSpaceRegExp,"")).length)textNode.value=text,textNode=textNode.prev;else for(sibling=textNode.prev,textNode.remove(),textNode=sibling;textNode&&3===textNode.type;)text=textNode.value,sibling=textNode.prev,0!==text.length&&!isAllWhiteSpaceRegExp.test(text)||(textNode.remove(),textNode=sibling),textNode=sibling}if(isInWhiteSpacePreservedElement&&whiteSpaceElements[name]&&(isInWhiteSpacePreservedElement=!1),elementRule.removeEmpty&&isEmpty$1(schema,nonEmptyElements,whiteSpaceElements,node))return tempNode=node.parent,blockElements[node.name]?node.empty().remove():node.unwrap(),void(node=tempNode);elementRule.paddEmpty&&(function(node){return hasOnlyChild(node,"#text")&&""===node.firstChild.value}(node)||isEmpty$1(schema,nonEmptyElements,whiteSpaceElements,node))&&paddEmptyNode(settings,args,blockElements,node),node=node.parent}}},schema);var rootNode=node=new Node$1(args.context||settings.root_name,11);if(parser.parse(html,args.format),validate&&invalidChildren.length&&(args.context?args.invalid=!0:function(nodes){var ni,node,parent,parents,newParent,currentNode,tempNode,childNode,i,nonEmptyElements,whitespaceElements,nonSplitableElements,textBlockElements,specialElements,sibling,nextNode;for(nonSplitableElements=makeMap$4("tr,td,th,tbody,thead,tfoot,table"),nonEmptyElements=schema.getNonEmptyElements(),whitespaceElements=schema.getWhiteSpaceElements(),textBlockElements=schema.getTextBlockElements(),specialElements=schema.getSpecialElements(),ni=0;ni<nodes.length;ni++)if((node=nodes[ni]).parent&&!node.fixed)if(textBlockElements[node.name]&&"li"===node.parent.name){for(sibling=node.next;sibling&&textBlockElements[sibling.name];)sibling.name="li",sibling.fixed=!0,node.parent.insert(sibling,node.parent),sibling=sibling.next;node.unwrap(node)}else{for(parents=[node],parent=node.parent;parent&&!schema.isValidChild(parent.name,node.name)&&!nonSplitableElements[parent.name];parent=parent.parent)parents.push(parent);if(parent&&1<parents.length){for(parents.reverse(),newParent=currentNode=filterNode(parents[0].clone()),i=0;i<parents.length-1;i++){for(schema.isValidChild(currentNode.name,parents[i].name)?(tempNode=filterNode(parents[i].clone()),currentNode.append(tempNode)):tempNode=currentNode,childNode=parents[i].firstChild;childNode&&childNode!==parents[i+1];)nextNode=childNode.next,tempNode.append(childNode),childNode=nextNode;currentNode=tempNode}isEmpty$1(schema,nonEmptyElements,whitespaceElements,newParent)?parent.insert(node,parents[0],!0):(parent.insert(newParent,parents[0],!0),parent.insert(node,newParent)),parent=parents[0],(isEmpty$1(schema,nonEmptyElements,whitespaceElements,parent)||hasOnlyChild(parent,"br"))&&parent.empty().remove()}else if(node.parent){if("li"===node.name){if((sibling=node.prev)&&("ul"===sibling.name||"ul"===sibling.name)){sibling.append(node);continue}if((sibling=node.next)&&("ul"===sibling.name||"ul"===sibling.name)){sibling.insert(node,sibling.firstChild,!0);continue}node.wrap(filterNode(new Node$1("ul",1)));continue}schema.isValidChild(node.parent.name,"div")&&schema.isValidChild("div",node.name)?node.wrap(filterNode(new Node$1("div",1))):specialElements[node.name]?node.empty().remove():node.unwrap()}}}(invalidChildren)),rootBlockName&&("body"===rootNode.name||args.isRootContent)&&function(){function trim(rootBlockNode){rootBlockNode&&((node=rootBlockNode.firstChild)&&3===node.type&&(node.value=node.value.replace(startWhiteSpaceRegExp,"")),(node=rootBlockNode.lastChild)&&3===node.type&&(node.value=node.value.replace(endWhiteSpaceRegExp,"")))}var next,rootBlockNode,node=rootNode.firstChild;if(schema.isValidChild(rootNode.name,rootBlockName.toLowerCase())){for(;node;)next=node.next,3===node.type||1===node.type&&"p"!==node.name&&!blockElements[node.name]&&!node.attr("data-mce-type")?(rootBlockNode||((rootBlockNode=createNode(rootBlockName,1)).attr(settings.forced_root_block_attrs),rootNode.insert(rootBlockNode,node)),rootBlockNode.append(node)):(trim(rootBlockNode),rootBlockNode=null),node=next;trim(rootBlockNode)}}(),!args.invalid){for(name in matchedNodes)if(matchedNodes.hasOwnProperty(name)){for(list=nodeFilters[name],fi=(nodes=matchedNodes[name]).length;fi--;)nodes[fi].parent||nodes.splice(fi,1);for(i=0,l=list.length;i<l;i++)list[i](nodes,name,args)}for(i=0,l=attributeFilters.length;i<l;i++)if((list=attributeFilters[i]).name in matchedAttributes){for(fi=(nodes=matchedAttributes[list.name]).length;fi--;)nodes[fi].parent||nodes.splice(fi,1);for(fi=0,fl=list.callbacks.length;fi<fl;fi++)list.callbacks[fi](nodes,list.name,args)}}return rootNode}};return register$2(exports,settings),LegacyFilter_register(exports,settings),exports}function addTempAttr(htmlParser,tempAttrs,name){-1===Tools.inArray(tempAttrs,name)&&(htmlParser.addAttributeFilter(name,function(nodes,name){for(var i=nodes.length;i--;)nodes[i].attr(name,null)}),tempAttrs.push(name))}function toHtml(editor,settings,schema,rootNode,args){return function(editor,args,content){return args.no_events||!editor?content:function(editor,args){return editor.fire("PostProcess",args)}(editor,__assign(__assign({},args),{content:content})).content}(editor,args,function(settings,schema,node){return Serializer(settings,schema).serialize(node)}(settings,schema,rootNode))}function DomSerializer(settings,editor){var tempAttrs=["data-mce-selected"],dom=editor&&editor.dom?editor.dom:DOMUtils$1.DOM,schema=editor&&editor.schema?editor.schema:Schema(settings);settings.entity_encoding=settings.entity_encoding||"named",settings.remove_trailing_brs=!("remove_trailing_brs"in settings)||settings.remove_trailing_brs;var htmlParser=DomParser(settings,schema);return DomSerializerFilters_register(htmlParser,settings,dom),{schema:schema,addNodeFilter:htmlParser.addNodeFilter,addAttributeFilter:htmlParser.addAttributeFilter,serialize:function(node,parserArgs){void 0===parserArgs&&(parserArgs={});var args=__assign({format:"html"},parserArgs),targetNode=DomSerializerPreProcess_process(editor,node,args),html=function(dom,node,args){var html=Zwsp.trim(args.getInner?node.innerHTML:dom.getOuterHTML(node));return args.selection||isWsPreserveElement(Element.fromDom(node))?html:Tools.trim(html)}(dom,targetNode,args),rootNode=function(htmlParser,html,args){var parserArgs=args.selection?__assign({forced_root_block:!1},args):args,rootNode=htmlParser.parse(html,parserArgs);return DomSerializerFilters_trimTrailingBr(rootNode),rootNode}(htmlParser,html,args);return"tree"===args.format?rootNode:toHtml(editor,settings,schema,rootNode,args)},addRules:function(rules){schema.addValidElements(rules)},setRules:function(rules){schema.setValidElements(rules)},addTempAttr:curry(addTempAttr,htmlParser,tempAttrs),getTempAttrs:function(){return tempAttrs},getNodeFilters:htmlParser.getNodeFilters,getAttributeFilters:htmlParser.getAttributeFilters}}function Serializer$1(settings,editor){var domSerializer=DomSerializer(settings,editor);return{schema:domSerializer.schema,addNodeFilter:domSerializer.addNodeFilter,addAttributeFilter:domSerializer.addAttributeFilter,serialize:domSerializer.serialize,addRules:domSerializer.addRules,setRules:domSerializer.setRules,addTempAttr:domSerializer.addTempAttr,getTempAttrs:domSerializer.getTempAttrs,getNodeFilters:domSerializer.getNodeFilters,getAttributeFilters:domSerializer.getAttributeFilters}}function parseDataUri(uri){var type,matches,uriParts=decodeURIComponent(uri).split(",");return(matches=/data:([^;]+)/.exec(uriParts[0]))&&(type=matches[1]),{type:type,data:uriParts[1]}}function uniqueId(prefix){return(prefix||"blobid")+count++}var LegacyFilter_register=function(domParser,settings){settings.inline_styles&&addFilters(domParser,settings)},hasOnlyChild=function(node,name){return node&&node.firstChild&&node.firstChild===node.lastChild&&node.firstChild.name===name},makeMap$4=Tools.makeMap,each$8=Tools.each,explode$2=Tools.explode,extend$2=Tools.extend,DomSerializerFilters_register=function(htmlParser,settings,dom){htmlParser.addAttributeFilter("data-mce-tabindex",function(nodes,name){for(var node,i=nodes.length;i--;)(node=nodes[i]).attr("tabindex",node.attr("data-mce-tabindex")),node.attr(name,null)}),htmlParser.addAttributeFilter("src,href,style",function(nodes,name){for(var node,value,i=nodes.length,internalName="data-mce-"+name,urlConverter=settings.url_converter,urlConverterScope=settings.url_converter_scope;i--;)void 0!==(value=(node=nodes[i]).attr(internalName))?(node.attr(name,0<value.length?value:null),node.attr(internalName,null)):(value=node.attr(name),"style"===name?value=dom.serializeStyle(dom.parseStyle(value),node.name):urlConverter&&(value=urlConverter.call(urlConverterScope,value,name,node.name)),node.attr(name,0<value.length?value:null))}),htmlParser.addAttributeFilter("class",function(nodes){for(var node,value,i=nodes.length;i--;)(value=(node=nodes[i]).attr("class"))&&(value=node.attr("class").replace(/(?:^|\s)mce-item-\w+(?!\S)/g,""),node.attr("class",0<value.length?value:null))}),htmlParser.addAttributeFilter("data-mce-type",function(nodes,name,args){for(var node,i=nodes.length;i--;){if("bookmark"===(node=nodes[i]).attr("data-mce-type")&&!args.cleanup)Option.from(node.firstChild).exists(function(firstChild){return!Zwsp.isZwsp(firstChild.value)})?node.unwrap():node.remove()}}),htmlParser.addNodeFilter("noscript",function(nodes){for(var node,i=nodes.length;i--;)(node=nodes[i].firstChild)&&(node.value=Entities.decode(node.value))}),htmlParser.addNodeFilter("script,style",function(nodes,name){for(var node,value,type,i=nodes.length,trim=function(value){return value.replace(/(<!--\[CDATA\[|\]\]-->)/g,"\n").replace(/^[\r\n]*|[\r\n]*$/g,"").replace(/^\s*((<!--)?(\s*\/\/)?\s*<!\[CDATA\[|(<!--\s*)?\/\*\s*<!\[CDATA\[\s*\*\/|(\/\/)?\s*<!--|\/\*\s*<!--\s*\*\/)\s*[\r\n]*/gi,"").replace(/\s*(\/\*\s*\]\]>\s*\*\/(-->)?|\s*\/\/\s*\]\]>(-->)?|\/\/\s*(-->)?|\]\]>|\/\*\s*-->\s*\*\/|\s*-->\s*)\s*$/g,"")};i--;)value=(node=nodes[i]).firstChild?node.firstChild.value:"","script"===name?((type=node.attr("type"))&&node.attr("type","mce-no/type"===type?null:type.replace(/^mce\-/,"")),"xhtml"===settings.element_format&&0<value.length&&(node.firstChild.value="// <![CDATA[\n"+trim(value)+"\n// ]]>")):"xhtml"===settings.element_format&&0<value.length&&(node.firstChild.value="\x3c!--\n"+trim(value)+"\n--\x3e")}),htmlParser.addNodeFilter("#comment",function(nodes){for(var node,i=nodes.length;i--;)node=nodes[i],settings.preserve_cdata&&0===node.value.indexOf("[CDATA[")?(node.name="#cdata",node.type=4,node.value=dom.decode(node.value.replace(/^\[CDATA\[|\]\]$/g,""))):0===node.value.indexOf("mce:protected ")&&(node.name="#text",node.type=3,node.raw=!0,node.value=unescape(node.value).substr(14))}),htmlParser.addNodeFilter("xml:namespace,input",function(nodes,name){for(var node,i=nodes.length;i--;)7===(node=nodes[i]).type?node.remove():1===node.type&&("input"!==name||node.attr("type")||node.attr("type","text"))}),htmlParser.addAttributeFilter("data-mce-type",function(nodes){each(nodes,function(node){"format-caret"===node.attr("data-mce-type")&&(node.isEmpty(htmlParser.schema.getNonEmptyElements())?node.remove():node.unwrap())})}),htmlParser.addAttributeFilter("data-mce-src,data-mce-href,data-mce-style,data-mce-selected,data-mce-expando,data-mce-type,data-mce-resize,data-mce-placeholder",function(nodes,name){for(var i=nodes.length;i--;)nodes[i].attr(name,null)})},DomSerializerFilters_trimTrailingBr=function(rootNode){function isBr(node){return node&&"br"===node.name}var brNode1,brNode2;isBr(brNode1=rootNode.lastChild)&&isBr(brNode2=brNode1.prev)&&(brNode1.remove(),brNode2.remove())},DomSerializerPreProcess_process=function(editor,node,args){return function(editor,args){return editor&&editor.hasEventListeners("PreProcess")&&!args.no_events}(editor,args)?function(editor,node,args){var impl,doc,oldDoc,dom=editor.dom;return node=node.cloneNode(!0),(impl=domGlobals.document.implementation).createHTMLDocument&&(doc=impl.createHTMLDocument(""),Tools.each("BODY"===node.nodeName?node.childNodes:[node],function(node){doc.body.appendChild(doc.importNode(node,!0))}),node="BODY"!==node.nodeName?doc.body.firstChild:doc.body,oldDoc=dom.doc,dom.doc=doc),function(editor,args){editor.fire("PreProcess",args)}(editor,__assign(__assign({},args),{node:node})),oldDoc&&(dom.doc=oldDoc),node}(editor,node,args):node},Conversions_uriToBlob=function(url){return 0===url.indexOf("blob:")?function(url){return new promiseObj(function(resolve,reject){function rejectWithError(){reject("Cannot convert "+url+" to Blob. Resource might not exist or is inaccessible.")}try{var xhr=new domGlobals.XMLHttpRequest;xhr.open("GET",url,!0),xhr.responseType="blob",xhr.onload=function(){200===this.status?resolve(this.response):rejectWithError()},xhr.onerror=rejectWithError,xhr.send()}catch(ex){rejectWithError()}})}(url):0===url.indexOf("data:")?function(uri){return new promiseObj(function(resolve){var str,arr,i,uriParts=parseDataUri(uri);try{str=domGlobals.atob(uriParts.data)}catch(e){return void resolve(new domGlobals.Blob([]))}for(arr=new Uint8Array(str.length),i=0;i<arr.length;i++)arr[i]=str.charCodeAt(i);resolve(new domGlobals.Blob([arr],{type:uriParts.type}))})}(url):null},Conversions_blobToDataUri=function(blob){return new promiseObj(function(resolve){var reader=new domGlobals.FileReader;reader.onloadend=function(){resolve(reader.result)},reader.readAsDataURL(blob)})},Conversions_parseDataUri=parseDataUri,count=0;function ImageScanner(uploadStatus,blobCache){var cachedPromises={};return{findAll:function(elm,predicate){var images;predicate=predicate||constant(!0),images=filter(function(elm){return elm?from$1(elm.getElementsByTagName("img")):[]}(elm),function(img){var src=img.src;return!!Env.fileApi&&(!img.hasAttribute("data-mce-bogus")&&(!img.hasAttribute("data-mce-placeholder")&&(!(!src||src===Env.transparentSrc)&&(0===src.indexOf("blob:")?!uploadStatus.isUploaded(src)&&predicate(img):0===src.indexOf("data:")&&predicate(img)))))});var promises=map(images,function(img){if(cachedPromises[img.src])return new promiseObj(function(resolve){cachedPromises[img.src].then(function(imageInfo){if("string"==typeof imageInfo)return imageInfo;resolve({image:img,blobInfo:imageInfo.blobInfo})})});var newPromise=new promiseObj(function(resolve,reject){!function(blobCache,img,resolve,reject){var base64,blobInfo;0!==img.src.indexOf("blob:")?(base64=Conversions_parseDataUri(img.src).data,(blobInfo=blobCache.findFirst(function(cachedBlobInfo){return cachedBlobInfo.base64()===base64}))?resolve({image:img,blobInfo:blobInfo}):Conversions_uriToBlob(img.src).then(function(blob){blobInfo=blobCache.create(uniqueId(),blob,base64),blobCache.add(blobInfo),resolve({image:img,blobInfo:blobInfo})},function(err){reject(err)})):(blobInfo=blobCache.getByUri(img.src))?resolve({image:img,blobInfo:blobInfo}):Conversions_uriToBlob(img.src).then(function(blob){Conversions_blobToDataUri(blob).then(function(dataUri){base64=Conversions_parseDataUri(dataUri).data,blobInfo=blobCache.create(uniqueId(),blob,base64),blobCache.add(blobInfo),resolve({image:img,blobInfo:blobInfo})})},function(err){reject(err)})}(blobCache,img,resolve,reject)}).then(function(result){return delete cachedPromises[result.image.src],result}).catch(function(error){return delete cachedPromises[img.src],error});return cachedPromises[img.src]=newPromise});return promiseObj.all(promises)}}}function Uploader(uploadStatus,settings){function defaultHandler(blobInfo,success,failure,progress){var xhr,formData;(xhr=new domGlobals.XMLHttpRequest).open("POST",settings.url),xhr.withCredentials=settings.credentials,xhr.upload.onprogress=function(e){progress(e.loaded/e.total*100)},xhr.onerror=function(){failure("Image upload failed due to a XHR Transport error. Code: "+xhr.status)},xhr.onload=function(){var json;xhr.status<200||300<=xhr.status?failure("HTTP Error: "+xhr.status):(json=JSON.parse(xhr.responseText))&&"string"==typeof json.location?success(function(path1,path2){return path1?path1.replace(/\/$/,"")+"/"+path2.replace(/^\//,""):path2}(settings.basePath,json.location)):failure("Invalid JSON: "+xhr.responseText)},(formData=new domGlobals.FormData).append("file",blobInfo.blob(),blobInfo.filename()),xhr.send(formData)}function handlerSuccess(blobInfo,url){return{url:url,blobInfo:blobInfo,status:!0}}function handlerFailure(blobInfo,error){return{url:"",blobInfo:blobInfo,status:!1,error:error}}function resolvePending(blobUri,result){Tools.each(pendingPromises[blobUri],function(resolve){resolve(result)}),delete pendingPromises[blobUri]}function uploadBlobs(blobInfos,openNotification){return blobInfos=Tools.grep(blobInfos,function(blobInfo){return!uploadStatus.isUploaded(blobInfo.blobUri())}),promiseObj.all(Tools.map(blobInfos,function(blobInfo){return uploadStatus.isPending(blobInfo.blobUri())?function(blobInfo){var blobUri=blobInfo.blobUri();return new promiseObj(function(resolve){pendingPromises[blobUri]=pendingPromises[blobUri]||[],pendingPromises[blobUri].push(resolve)})}(blobInfo):function(blobInfo,handler,openNotification){return uploadStatus.markPending(blobInfo.blobUri()),new promiseObj(function(resolve){function noop(){}var notification;try{var closeNotification_1=function(){notification&&(notification.close(),noop)};handler(blobInfo,function(url){closeNotification_1(),uploadStatus.markUploaded(blobInfo.blobUri(),url),resolvePending(blobInfo.blobUri(),handlerSuccess(blobInfo,url)),resolve(handlerSuccess(blobInfo,url))},function(error){closeNotification_1(),uploadStatus.removeFailed(blobInfo.blobUri()),resolvePending(blobInfo.blobUri(),handlerFailure(blobInfo,error)),resolve(handlerFailure(blobInfo,error))},function(percent){percent<0||100<percent||(notification=notification||openNotification()).progressBar.value(percent)})}catch(ex){resolve(handlerFailure(blobInfo,ex.message))}})}(blobInfo,settings.handler,openNotification)}))}var pendingPromises={};return!1===isFunction(settings.handler)&&(settings.handler=defaultHandler),{upload:function(blobInfos,openNotification){return!settings.url&&function(handler){return handler===defaultHandler}(settings.handler)?new promiseObj(function(resolve){resolve([])}):uploadBlobs(blobInfos,openNotification)}}}function UploadStatus(){function createStatus(status,resultUri){return{status:status,resultUri:resultUri}}function hasBlobUri(blobUri){return blobUri in blobUriStatuses}var blobUriStatuses={};return{hasBlobUri:hasBlobUri,getResultUri:function(blobUri){var result=blobUriStatuses[blobUri];return result?result.resultUri:null},isPending:function(blobUri){return!!hasBlobUri(blobUri)&&1===blobUriStatuses[blobUri].status},isUploaded:function(blobUri){return!!hasBlobUri(blobUri)&&2===blobUriStatuses[blobUri].status},markPending:function(blobUri){blobUriStatuses[blobUri]=createStatus(1,null)},markUploaded:function(blobUri,resultUri){blobUriStatuses[blobUri]=createStatus(2,resultUri)},removeFailed:function(blobUri){delete blobUriStatuses[blobUri]},destroy:function(){blobUriStatuses={}}}}function EditorUpload(editor){function aliveGuard(callback){return function(result){return editor.selection?callback(result):[]}}function replaceString(content,search,replace){for(var index=0;-1!==(index=content.indexOf(search,index))&&(content=content.substring(0,index)+replace+content.substr(index+search.length),index+=replace.length-search.length+1),-1!==index;);return content}function replaceImageUrl(content,targetUrl,replacementUrl){return content=replaceString(content,'src="'+targetUrl+'"','src="'+replacementUrl+'"'),content=replaceString(content,'data-mce-src="'+targetUrl+'"','data-mce-src="'+replacementUrl+'"')}function replaceUrlInUndoStack(targetUrl,replacementUrl){each(editor.undoManager.data,function(level){"fragmented"===level.type?level.fragments=map(level.fragments,function(fragment){return replaceImageUrl(fragment,targetUrl,replacementUrl)}):level.content=replaceImageUrl(level.content,targetUrl,replacementUrl)})}function openNotification(){return editor.notificationManager.open({text:editor.translate("Image uploading..."),type:"info",timeout:-1,progressBar:!0})}function replaceImageUri(image,resultUri){blobCache.removeByUri(image.src),replaceUrlInUndoStack(image.src,resultUri),editor.$(image).attr({src:Settings_shouldReuseFileName(editor)?function(url){return url+(-1===url.indexOf("?")?"?":"&")+(new Date).getTime()}(resultUri):resultUri,"data-mce-src":editor.convertURL(resultUri,"src")})}function uploadImages(callback){return uploader=uploader||Uploader(uploadStatus,{url:Settings_getImageUploadUrl(editor),basePath:Settings_getImageUploadBasePath(editor),credentials:Settings_getImagesUploadCredentials(editor),handler:Settings_getImagesUploadHandler(editor)}),scanForImages().then(aliveGuard(function(imageInfos){var blobInfos=map(imageInfos,function(imageInfo){return imageInfo.blobInfo});return uploader.upload(blobInfos,openNotification).then(aliveGuard(function(result){var filteredResult=map(result,function(uploadInfo,index){var image=imageInfos[index].image;return uploadInfo.status&&Settings_shouldReplaceBlobUris(editor)?replaceImageUri(image,uploadInfo.url):uploadInfo.error&&ErrorReporter.uploadError(editor,uploadInfo.error),{element:image,status:uploadInfo.status}});return callback&&callback(filteredResult),filteredResult}))}))}function uploadImagesAuto(callback){if(Settings_isAutomaticUploadsEnabled(editor))return uploadImages(callback)}function isValidDataUriImage(imgElm){return!1!==forall(urlFilters,function(filter){return filter(imgElm)})&&(0!==imgElm.getAttribute("src").indexOf("data:")||Settings_getImagesDataImgFilter(editor)(imgElm))}function replaceBlobUris(content){return content.replace(/src="(blob:[^"]+)"/g,function(match,blobUri){var resultUri=uploadStatus.getResultUri(blobUri);if(resultUri)return'src="'+resultUri+'"';var blobInfo=blobCache.getByUri(blobUri);return(blobInfo=blobInfo||foldl(editor.editorManager.get(),function(result,editor){return result||editor.editorUpload&&editor.editorUpload.blobCache.getByUri(blobUri)},null))?'src="data:'+blobInfo.blob().type+";base64,"+blobInfo.base64()+'"':match})}var uploader,imageScanner,blobCache=function(){var cache=[],toBlobInfo=function(o){var id,name;if(!o.blob||!o.base64)throw new Error("blob and base64 representations of the image are required for BlobInfo to be created");return id=o.id||Uuid_uuid("blobid"),name=o.name||id,{id:constant(id),name:constant(name),filename:constant(name+"."+function(mime){return{"image/jpeg":"jpg","image/jpg":"jpg","image/gif":"gif","image/png":"png"}[mime.toLowerCase()]||"dat"}(o.blob.type)),blob:constant(o.blob),base64:constant(o.base64),blobUri:constant(o.blobUri||domGlobals.URL.createObjectURL(o.blob)),uri:constant(o.uri)}},get=function(id){return findFirst(function(cachedBlobInfo){return cachedBlobInfo.id()===id})},findFirst=function(predicate){return filter(cache,predicate)[0]};return{create:function(o,blob,base64,filename){if(isString(o))return toBlobInfo({id:o,name:filename,blob:blob,base64:base64});if(isObject(o))return toBlobInfo(o);throw new Error("Unknown input type")},add:function(blobInfo){get(blobInfo.id())||cache.push(blobInfo)},get:get,getByUri:function(blobUri){return findFirst(function(blobInfo){return blobInfo.blobUri()===blobUri})},findFirst:findFirst,removeByUri:function(blobUri){cache=filter(cache,function(blobInfo){return blobInfo.blobUri()!==blobUri||(domGlobals.URL.revokeObjectURL(blobInfo.blobUri()),!1)})},destroy:function(){each(cache,function(cachedBlobInfo){domGlobals.URL.revokeObjectURL(cachedBlobInfo.blobUri())}),cache=[]}}}(),uploadStatus=UploadStatus(),urlFilters=[],scanForImages=function(){return(imageScanner=imageScanner||ImageScanner(uploadStatus,blobCache)).findAll(editor.getBody(),isValidDataUriImage).then(aliveGuard(function(result){return result=filter(result,function(resultItem){return"string"!=typeof resultItem||(ErrorReporter.displayError(editor,resultItem),!1)}),each(result,function(resultItem){replaceUrlInUndoStack(resultItem.image.src,resultItem.blobInfo.blobUri()),resultItem.image.src=resultItem.blobInfo.blobUri(),resultItem.image.removeAttribute("data-mce-src")}),result}))};return editor.on("SetContent",function(){Settings_isAutomaticUploadsEnabled(editor)?uploadImagesAuto():scanForImages()}),editor.on("RawSaveContent",function(e){e.content=replaceBlobUris(e.content)}),editor.on("GetContent",function(e){e.source_view||"raw"===e.format||(e.content=replaceBlobUris(e.content))}),editor.on("PostRender",function(){editor.parser.addNodeFilter("img",function(images){each(images,function(img){var src=img.attr("src");if(!blobCache.getByUri(src)){var resultUri=uploadStatus.getResultUri(src);resultUri&&img.attr("src",resultUri)}})})}),{blobCache:blobCache,addFilter:function(filter){urlFilters.push(filter)},uploadImages:uploadImages,uploadImagesAuto:uploadImagesAuto,scanForImages:scanForImages,destroy:function(){blobCache.destroy(),uploadStatus.destroy(),imageScanner=uploader=null}}}function matchesUnInheritedFormatSelector(ed,node,name){var formatList=ed.formatter.get(name);if(formatList)for(var i=0;i<formatList.length;i++)if(!1===formatList[i].inherit&&ed.dom.is(node,formatList[i].selector))return!0;return!1}function matchParents(editor,node,name,vars){var root=editor.dom.getRoot();return node!==root&&(node=editor.dom.getParent(node,function(node){return!!matchesUnInheritedFormatSelector(editor,node,name)||(node.parentNode===root||!!matchNode(editor,node,name,vars,!0))}),matchNode(editor,node,name,vars))}function matchName(dom,node,format){return!!isEq$2(node,format.inline)||(!!isEq$2(node,format.block)||(format.selector?1===node.nodeType&&dom.is(node,format.selector):void 0))}function matchItems(dom,node,format,itemName,similar,vars){var key,value,i,items=format[itemName];if(format.onmatch)return format.onmatch(node,format,itemName);if(items)if(void 0===items.length){for(key in items)if(items.hasOwnProperty(key)){if(value="attributes"===itemName?dom.getAttrib(node,key):getStyle(dom,node,key),similar&&!value&&!format.exact)return;if((!similar||format.exact)&&!isEq$2(value,normalizeStyleValue(dom,replaceVars(items[key],vars),key)))return}}else for(i=0;i<items.length;i++)if("attributes"===itemName?dom.getAttrib(node,items[i]):getStyle(dom,node,items[i]))return format;return format}function match(editor,name,vars,node){var startNode;return node?matchParents(editor,node,name,vars):(node=editor.selection.getNode(),!!matchParents(editor,node,name,vars)||!((startNode=editor.selection.getStart())===node||!matchParents(editor,startNode,name,vars)))}function matchAll(editor,names,vars){var startElement,matchedFormatNames=[],checkedMap={};return startElement=editor.selection.getStart(),editor.dom.getParent(startElement,function(node){var i,name;for(i=0;i<names.length;i++)name=names[i],!checkedMap[name]&&matchNode(editor,node,name,vars)&&(checkedMap[name]=!0,matchedFormatNames.push(name))},editor.dom.getRoot()),matchedFormatNames}function canApply(editor,name){var startNode,parents,i,x,selector,formatList=editor.formatter.get(name),dom=editor.dom;if(formatList)for(startNode=editor.selection.getStart(),parents=getParents$1(dom,startNode),x=formatList.length-1;0<=x;x--){if(!(selector=formatList[x].selector)||formatList[x].defaultBlock)return!0;for(i=parents.length-1;0<=i;i--)if(dom.is(parents[i],selector))return!0}return!1}function splitText(node,offset){return node.splitText(offset)}function split$1(rng){var startContainer=rng.startContainer,startOffset=rng.startOffset,endContainer=rng.endContainer,endOffset=rng.endOffset;return startContainer===endContainer&&NodeType.isText(startContainer)?0<startOffset&&startOffset<startContainer.nodeValue.length&&(startContainer=(endContainer=splitText(startContainer,startOffset)).previousSibling,startOffset<endOffset?(startContainer=endContainer=splitText(endContainer,endOffset-=startOffset).previousSibling,endOffset=endContainer.nodeValue.length,startOffset=0):endOffset=0):(NodeType.isText(startContainer)&&0<startOffset&&startOffset<startContainer.nodeValue.length&&(startContainer=splitText(startContainer,startOffset),startOffset=0),NodeType.isText(endContainer)&&0<endOffset&&endOffset<endContainer.nodeValue.length&&(endOffset=(endContainer=splitText(endContainer,endOffset).previousSibling).nodeValue.length)),{startContainer:startContainer,startOffset:startOffset,endContainer:endContainer,endOffset:endOffset}}function normalize$1(node,offset,count){if(0!==count){var whitespace=node.data.slice(offset,offset+count),isEndOfContent=offset+count>=node.data.length,isStartOfContent=0===offset;node.replaceData(offset,count,function(content,isStartOfContent,isEndOfContent){return foldl(content,function(acc,c){return isWhiteSpace$1(c)||isNbsp(c)?acc.previousCharIsSpace||""===acc.str&&isStartOfContent||acc.str.length===content.length-1&&isEndOfContent?{previousCharIsSpace:!1,str:acc.str+""}:{previousCharIsSpace:!0,str:acc.str+" "}:{previousCharIsSpace:!1,str:acc.str+c}},{previousCharIsSpace:!1,str:""}).str}(whitespace,isStartOfContent,isEndOfContent))}}function normalizeWhitespaceAfter(node,offset){var content=node.data.slice(offset),whitespaceCount=content.length-function(str){return str.replace(/^\s+/g,"")}(content).length;return normalize$1(node,offset,whitespaceCount)}function hasWhitespacePreserveParent(rootNode,node){var rootElement=Element.fromDom(rootNode);return function(scope,selector,isRoot){return ancestor$1(scope,selector,isRoot).isSome()}(Element.fromDom(node),"pre,code",curry(eq,rootElement))}function isContent$1(rootNode,node){return isCaretCandidate(node)&&!1===function(rootNode,node){return NodeType.isText(node)&&/^[ \t\r\n]*$/.test(node.data)&&!1===hasWhitespacePreserveParent(rootNode,node)}(rootNode,node)||function(node){return NodeType.isElement(node)&&"A"===node.nodeName&&node.hasAttribute("name")}(node)||isBookmark(node)}function reposition(elm,pos){return function(pos,elm){var container=pos.container(),offset=pos.offset();return!1===CaretPosition$1.isTextPosition(pos)&&container===elm.parentNode&&offset>CaretPosition$1.before(elm).offset()}(pos,elm)?CaretPosition$1(pos.container(),pos.offset()-1):pos}function getPreviousSiblingCaretPosition(elm){return isCaretCandidate(elm.previousSibling)?Option.some(function(node){return NodeType.isText(node)?CaretPosition$1(node,node.data.length):CaretPosition$1.after(node)}(elm.previousSibling)):elm.previousSibling?CaretFinder.lastPositionIn(elm.previousSibling):Option.none()}function getNextSiblingCaretPosition(elm){return isCaretCandidate(elm.nextSibling)?Option.some(function(node){return NodeType.isText(node)?CaretPosition$1(node,0):CaretPosition$1.before(node)}(elm.nextSibling)):elm.nextSibling?CaretFinder.firstPositionIn(elm.nextSibling):Option.none()}function findCaretPositionBackwards(rootElement,elm){return getPreviousSiblingCaretPosition(elm).orThunk(function(){return getNextSiblingCaretPosition(elm)}).orThunk(function(){return function(rootElement,elm){var startPosition=CaretPosition$1.before(elm.previousSibling?elm.previousSibling:elm.parentNode);return CaretFinder.prevPosition(rootElement,startPosition).fold(function(){return CaretFinder.nextPosition(rootElement,CaretPosition$1.after(elm))},Option.some)}(rootElement,elm)})}function findCaretPositionForward(rootElement,elm){return getNextSiblingCaretPosition(elm).orThunk(function(){return getPreviousSiblingCaretPosition(elm)}).orThunk(function(){return function(rootElement,elm){return CaretFinder.nextPosition(rootElement,CaretPosition$1.after(elm)).fold(function(){return CaretFinder.prevPosition(rootElement,CaretPosition$1.before(elm))},Option.some)}(rootElement,elm)})}function findCaretPosOutsideElmAfterDelete(forward,rootElement,elm){return function(forward,rootElement,elm){return forward?findCaretPositionForward(rootElement,elm):findCaretPositionBackwards(rootElement,elm)}(forward,rootElement,elm).map(curry(reposition,elm))}function setSelection(editor,forward,pos){pos.fold(function(){editor.focus()},function(pos){editor.selection.setRng(pos.toRange(),forward)})}function isBlock$2(editor,elm){return elm&&editor.schema.getBlockElements().hasOwnProperty(name(elm))}function paddEmptyBlock(elm){if(Empty_isEmpty(elm)){var br=Element.fromHtml('<br data-mce-bogus="1">');return empty(elm),append(elm,br),Option.some(CaretPosition$1.before(br.dom()))}return Option.none()}function deleteNormalized(elm,afterDeletePosOpt,normalizeWhitespace){var prevTextOpt=prevSibling(elm).filter(isText),nextTextOpt=nextSibling(elm).filter(isText);return remove(elm),function(oa,ob,oc,f){return oa.isSome()&&ob.isSome()&&oc.isSome()?Option.some(f(oa.getOrDie(),ob.getOrDie(),oc.getOrDie())):Option.none()}(prevTextOpt,nextTextOpt,afterDeletePosOpt,function(prev,next,pos){var prevNode=prev.dom(),nextNode=next.dom(),offset=prevNode.data.length;return function(prevNode,nextNode,normalizeWhitespace){var whitespaceOffset=rTrim(prevNode.data).length;prevNode.appendData(nextNode.data),remove(Element.fromDom(nextNode)),normalizeWhitespace&&normalizeWhitespaceAfter(prevNode,whitespaceOffset)}(prevNode,nextNode,normalizeWhitespace),pos.container()===nextNode?CaretPosition$1(prevNode,offset):pos}).orThunk(function(){return normalizeWhitespace&&(prevTextOpt.each(function(elm){return function(node,offset){var content=node.data.slice(0,offset),whitespaceCount=content.length-rTrim(content).length;return normalize$1(node,offset-whitespaceCount,whitespaceCount)}(elm.dom(),elm.dom().length)}),nextTextOpt.each(function(elm){return normalizeWhitespaceAfter(elm.dom(),0)})),afterDeletePosOpt})}function isCaretContainerEmpty(node){return 0<function(node){for(var nodes=[];node;){if(3===node.nodeType&&node.nodeValue!==ZWSP$1||1<node.childNodes.length)return[];1===node.nodeType&&nodes.push(node),node=node.firstChild}return nodes}(node).length}function findFirstTextNode(node){if(node){var walker=new TreeWalker(node,node);for(node=walker.current();node;node=walker.next())if(NodeType.isText(node))return node}return null}function createCaretContainer(fill){var caretContainer=Element.fromTag("span");return setAll(caretContainer,{id:"_mce_caret","data-mce-bogus":"1","data-mce-type":"format-caret"}),fill&&append(caretContainer,Element.fromText(ZWSP$1)),caretContainer}function removeCaretContainerNode(editor,node,moveCaret){void 0===moveCaret&&(moveCaret=!0);var dom=editor.dom,selection=editor.selection;if(isCaretContainerEmpty(node))DeleteElement_deleteElement(editor,!1,Element.fromDom(node),moveCaret);else{var rng=selection.getRng(),block=dom.getParent(node,dom.isBlock),textNode=function(caretContainerNode){var textNode=findFirstTextNode(caretContainerNode);return textNode&&textNode.nodeValue.charAt(0)===ZWSP$1&&textNode.deleteData(0,1),textNode}(node);rng.startContainer===textNode&&0<rng.startOffset&&rng.setStart(textNode,rng.startOffset-1),rng.endContainer===textNode&&0<rng.endOffset&&rng.setEnd(textNode,rng.endOffset-1),dom.remove(node,!0),block&&dom.isEmpty(block)&&PaddingBr_fillWithPaddingBr(Element.fromDom(block)),selection.setRng(rng)}}function removeCaretContainer(editor,node,moveCaret){void 0===moveCaret&&(moveCaret=!0);var dom=editor.dom,selection=editor.selection;if(node)removeCaretContainerNode(editor,node,moveCaret);else if(!(node=getParentCaretContainer(editor.getBody(),selection.getStart())))for(;node=dom.get("_mce_caret");)removeCaretContainerNode(editor,node,!1)}function insertCaretContainerNode(editor,caretContainer,formatNode){var dom=editor.dom,block=dom.getParent(formatNode,curry(isTextBlock$1,editor));block&&dom.isEmpty(block)?formatNode.parentNode.replaceChild(caretContainer,formatNode):(PaddingBr_removeTrailingBr(Element.fromDom(formatNode)),dom.isEmpty(formatNode)?formatNode.parentNode.replaceChild(caretContainer,formatNode):dom.insertAfter(caretContainer,formatNode))}function appendNode(parentNode,node){return parentNode.appendChild(node),node}function insertFormatNodesIntoCaretContainer(formatNodes,caretContainer){var innerMostFormatNode=foldr(formatNodes,function(parentNode,formatNode){return appendNode(parentNode,formatNode.cloneNode(!1))},caretContainer);return appendNode(innerMostFormatNode,innerMostFormatNode.ownerDocument.createTextNode(ZWSP$1))}function setup$3(editor){editor.on("mouseup keydown",function(e){!function(editor,keyCode){var selection=editor.selection,body=editor.getBody();removeCaretContainer(editor,null,!1),8!==keyCode&&46!==keyCode||!selection.isCollapsed()||selection.getStart().innerHTML!==ZWSP$1||removeCaretContainer(editor,getParentCaretContainer(body,selection.getStart())),37!==keyCode&&39!==keyCode||removeCaretContainer(editor,getParentCaretContainer(body,selection.getStart()))}(editor,e.keyCode)})}function isFormatElement(editor,element){return editor.schema.getTextInlineElements().hasOwnProperty(name(element))&&!isCaretNode(element.dom())&&!NodeType.isBogus(element.dom())}var count$1=0,Uuid_uuid=function(prefix){return prefix+count$1+++function(){function rnd(){return Math.round(4294967295*Math.random()).toString(36)}return"s"+(new Date).getTime().toString(36)+rnd()+rnd()+rnd()}()},PaddingBr_removeTrailingBr=function(elm){var allBrs=descendants$1(elm,"br"),brs=filter(function(elm){for(var children=[],rawNode=elm.dom();rawNode;)children.push(Element.fromDom(rawNode)),rawNode=rawNode.lastChild;return children}(elm).slice(-1),isBr$1);allBrs.length===brs.length&&each(brs,remove)},PaddingBr_fillWithPaddingBr=function(elm){empty(elm),append(elm,Element.fromHtml('<br data-mce-bogus="1">'))},PaddingBr_trimBlockTrailingBr=function(elm){lastChild(elm).each(function(lastChild){prevSibling(lastChild).each(function(lastChildPrevSibling){isBlock(elm)&&isBr$1(lastChild)&&isBlock(lastChildPrevSibling)&&remove(lastChild)})})},isEq$2=isEq,matchNode=function(ed,node,name,vars,similar){var format,i,x,classes,formatList=ed.formatter.get(name),dom=ed.dom;if(formatList&&node)for(i=0;i<formatList.length;i++)if(format=formatList[i],matchName(ed.dom,node,format)&&matchItems(dom,node,format,"attributes",similar,vars)&&matchItems(dom,node,format,"styles",similar,vars)){if(classes=format.classes)for(x=0;x<classes.length;x++)if(!ed.dom.hasClass(node,classes[x]))return;return format}},isBookmark=NodeType.hasAttribute("data-mce-bookmark"),isBogus$2=NodeType.hasAttribute("data-mce-bogus"),isBogusAll$1=NodeType.hasAttributeValue("data-mce-bogus","all"),Empty_isEmpty=function(elm,skipBogus){return void 0===skipBogus&&(skipBogus=!0),function(targetNode,skipBogus){var node,brCount=0;if(isContent$1(targetNode,targetNode))return!1;if(!(node=targetNode.firstChild))return!0;var walker=new TreeWalker(node,targetNode);do{if(skipBogus){if(isBogusAll$1(node)){node=walker.next(!0);continue}if(isBogus$2(node)){node=walker.next();continue}}if(NodeType.isBr(node))brCount++,node=walker.next();else{if(isContent$1(targetNode,node))return!1;node=walker.next()}}while(node);return brCount<=1}(elm.dom(),skipBogus)},DeleteElement_deleteElement=function(editor,forward,elm,moveCaret){void 0===moveCaret&&(moveCaret=!0);var afterDeletePos=findCaretPosOutsideElmAfterDelete(forward,editor.getBody(),elm.dom()),parentBlock=ancestor(elm,curry(isBlock$2,editor),function(rawNode){return function(elm){return elm.dom()===rawNode}}(editor.getBody())),normalizedAfterDeletePos=deleteNormalized(elm,afterDeletePos,function(editor,element){return has(editor.schema.getTextInlineElements(),name(element))}(editor,elm));editor.dom.isEmpty(editor.getBody())?(editor.setContent(""),editor.selection.setCursorLocation()):parentBlock.bind(paddEmptyBlock).fold(function(){moveCaret&&setSelection(editor,forward,normalizedAfterDeletePos)},function(paddPos){moveCaret&&setSelection(editor,forward,Option.some(paddPos))})},ZWSP$1=Zwsp.ZWSP,postProcessHooks={},filter$4=ArrUtils.filter,each$9=ArrUtils.each;!function(name,hook){var hooks=postProcessHooks[name];hooks||(postProcessHooks[name]=hooks=[]),postProcessHooks[name].push(hook)}("pre",function(editor){var isPre,blocks,rng=editor.selection.getRng();isPre=NodeType.matchNodeNames(["pre"]),rng.collapsed||(blocks=editor.selection.getSelectedBlocks(),each$9(filter$4(filter$4(blocks,isPre),function(pre){return isPre(pre.previousSibling)&&-1!==ArrUtils.indexOf(blocks,pre.previousSibling)}),function(pre){!function(pre1,pre2){DomQuery(pre2).remove(),DomQuery(pre1).append("<br><br>").append(pre2.childNodes)}(pre.previousSibling,pre)}))});function ElementUtils(dom){this.compare=function(node1,node2){if(node1.nodeName!==node2.nodeName)return!1;function getAttribs(node){var attribs={};return each$a(dom.getAttribs(node),function(attr){var name=attr.nodeName.toLowerCase();0!==name.indexOf("_")&&"style"!==name&&0!==name.indexOf("data-")&&(attribs[name]=dom.getAttrib(node,name))}),attribs}function compareObjects(obj1,obj2){var value,name;for(name in obj1)if(obj1.hasOwnProperty(name)){if(void 0===(value=obj2[name]))return!1;if(obj1[name]!==value)return!1;delete obj2[name]}for(name in obj2)if(obj2.hasOwnProperty(name))return!1;return!0}return!!compareObjects(getAttribs(node1),getAttribs(node2))&&(!!compareObjects(dom.parseStyle(dom.getAttrib(node1,"style")),dom.parseStyle(dom.getAttrib(node2,"style")))&&(!Bookmarks_isBookmarkNode(node1)&&!Bookmarks_isBookmarkNode(node2)))}}function isChildOfInlineParent(dom,node,parent){return dom.isChildOf(node,parent)&&node!==parent&&!dom.isBlock(parent)}function getContainer(ed,rng,start){var container,offset;if(container=rng[start?"startContainer":"endContainer"],offset=rng[start?"startOffset":"endOffset"],NodeType.isElement(container)){var lastIdx=container.childNodes.length-1;!start&&offset&&offset--,container=container.childNodes[lastIdx<offset?lastIdx:offset]}return NodeType.isText(container)&&start&&offset>=container.nodeValue.length&&(container=new TreeWalker(container,ed.getBody()).next()||container),NodeType.isText(container)&&!start&&0===offset&&(container=new TreeWalker(container,ed.getBody()).prev()||container),container}function wrap$3(dom,node,name,attrs){var wrapper=dom.create(name,attrs);return node.parentNode.insertBefore(wrapper,node),wrapper.appendChild(node),wrapper}function wrapWithSiblings(dom,node,next,name,attrs){var start=Element.fromDom(node),wrapper=Element.fromDom(dom.create(name,attrs)),siblings=next?nextSiblings(start):prevSiblings(start);return append$1(wrapper,siblings),next?(before(start,wrapper),prepend(wrapper,start)):(after(start,wrapper),append(wrapper,start)),wrapper.dom()}function find$4(dom,node,next,inc){return!(node=getNonWhiteSpaceSibling(node,next,inc))||"BR"===node.nodeName||dom.isBlock(node)}function removeFormat(ed,format,vars,node,compareNode){var stylesModified,dom=ed.dom;if(!function(dom,node,format){return!!isEq$3(node,format.inline)||(!!isEq$3(node,format.block)||(format.selector?NodeType.isElement(node)&&dom.is(node,format.selector):void 0))}(dom,node,format)&&!function(node,format){return format.links&&"A"===node.nodeName}(node,format))return!1;var elm=node;if("all"!==format.remove){each$b(format.styles,function(value,name){value=normalizeStyleValue(dom,replaceVars(value,vars),name),"number"==typeof name&&(name=value,compareNode=null),!format.remove_similar&&compareNode&&!isEq$3(getStyle(dom,compareNode,name),value)||dom.setStyle(elm,name,""),stylesModified=!0}),stylesModified&&""===dom.getAttrib(elm,"style")&&(elm.removeAttribute("style"),elm.removeAttribute("data-mce-style")),each$b(format.attributes,function(value,name){var valueOut;if(value=replaceVars(value,vars),"number"==typeof name&&(name=value,compareNode=null),format.remove_similar||!compareNode||isEq$3(dom.getAttrib(compareNode,name),value)){if("class"===name&&(value=dom.getAttrib(elm,name))&&(valueOut="",each$b(value.split(/\s+/),function(cls){/mce\-\w+/.test(cls)&&(valueOut+=(valueOut?" ":"")+cls)}),valueOut))return void dom.setAttrib(elm,name,valueOut);"class"===name&&elm.removeAttribute("className"),MCE_ATTR_RE.test(name)&&elm.removeAttribute("data-mce-"+name),elm.removeAttribute(name)}}),each$b(format.classes,function(value){value=replaceVars(value,vars),compareNode&&!dom.hasClass(compareNode,value)||dom.removeClass(elm,value)});for(var attrs=dom.getAttribs(elm),i=0;i<attrs.length;i++){var attrName=attrs[i].nodeName;if(0!==attrName.indexOf("_")&&0!==attrName.indexOf("data-"))return!1}}return"none"!==format.remove?(function(ed,node,format){var rootBlockElm,parentNode=node.parentNode,dom=ed.dom,forcedRootBlock=Settings_getForcedRootBlock(ed);format.block&&(forcedRootBlock?parentNode===dom.getRoot()&&(format.list_block&&isEq$3(node,format.list_block)||each$b(Tools.grep(node.childNodes),function(node){isValid(ed,forcedRootBlock,node.nodeName.toLowerCase())?rootBlockElm?rootBlockElm.appendChild(node):(rootBlockElm=wrap$3(dom,node,forcedRootBlock),dom.setAttribs(rootBlockElm,ed.settings.forced_root_block_attrs)):rootBlockElm=0})):dom.isBlock(node)&&!dom.isBlock(parentNode)&&(find$4(dom,node,!1)||find$4(dom,node.firstChild,!0,!0)||node.insertBefore(dom.create("br"),node.firstChild),find$4(dom,node,!0)||find$4(dom,node.lastChild,!1,!0)||node.appendChild(dom.create("br")))),format.selector&&format.inline&&!isEq$3(format.inline,node)||dom.remove(node,!0)}(ed,elm,format),!0):void 0}function remove$7(ed,name,vars,node,similar){function splitToFormatRoot(container){var formatRoot=function(editor,container,name,vars,similar){var formatRoot;return each$b(getParents$1(editor.dom,container.parentNode).reverse(),function(parent){var format;formatRoot||"_start"===parent.id||"_end"===parent.id||(format=matchNode(editor,parent,name,vars,similar))&&!1!==format.split&&(formatRoot=parent)}),formatRoot}(ed,container,name,vars,similar);return function(editor,formatList,formatRoot,container,target,split,format,vars){var parent,clone,lastClone,firstClone,i,formatRootParent,dom=editor.dom;if(formatRoot){for(formatRootParent=formatRoot.parentNode,parent=container.parentNode;parent&&parent!==formatRootParent;parent=parent.parentNode){for(clone=dom.clone(parent,!1),i=0;i<formatList.length;i++)if(removeFormat(editor,formatList[i],vars,clone,clone)){clone=0;break}clone&&(lastClone&&clone.appendChild(lastClone),firstClone=firstClone||clone,lastClone=clone)}!split||format.mixed&&dom.isBlock(formatRoot)||(container=dom.split(formatRoot,container)),lastClone&&(target.parentNode.insertBefore(lastClone,target),firstClone.appendChild(target))}return container}(ed,formatList,formatRoot,container,container,!0,format,vars)}function unwrap(start){var node=dom.get(start?"_start":"_end"),out=node[start?"firstChild":"lastChild"];return function(node){return Bookmarks_isBookmarkNode(node)&&NodeType.isElement(node)&&("_start"===node.id||"_end"===node.id)}(out)&&(out=out[start?"firstChild":"lastChild"]),NodeType.isText(out)&&0===out.data.length&&(out=start?node.previousSibling||node.nextSibling:node.nextSibling||node.previousSibling),dom.remove(node,!0),out}function removeRngStyle(rng){var startContainer,endContainer,commonAncestorContainer=rng.commonAncestorContainer,expandedRng=expandRng(ed,rng,formatList,!0);if(format.split){if(expandedRng=split$1(expandedRng),(startContainer=getContainer(ed,expandedRng,!0))!==(endContainer=getContainer(ed,expandedRng))){if(/^(TR|TH|TD)$/.test(startContainer.nodeName)&&startContainer.firstChild&&(startContainer="TR"===startContainer.nodeName?startContainer.firstChild.firstChild||startContainer:startContainer.firstChild||startContainer),commonAncestorContainer&&/^T(HEAD|BODY|FOOT|R)$/.test(commonAncestorContainer.nodeName)&&function(node){return/^(TH|TD)$/.test(node.nodeName)}(endContainer)&&endContainer.firstChild&&(endContainer=endContainer.firstChild||endContainer),isChildOfInlineParent(dom,startContainer,endContainer)){var marker=Option.from(startContainer.firstChild).getOr(startContainer);return splitToFormatRoot(wrapWithSiblings(dom,marker,!0,"span",{id:"_start","data-mce-type":"bookmark"})),void unwrap(!0)}if(isChildOfInlineParent(dom,endContainer,startContainer)){marker=Option.from(endContainer.lastChild).getOr(endContainer);return splitToFormatRoot(wrapWithSiblings(dom,marker,!1,"span",{id:"_end","data-mce-type":"bookmark"})),void unwrap(!1)}startContainer=wrap$3(dom,startContainer,"span",{id:"_start","data-mce-type":"bookmark"}),endContainer=wrap$3(dom,endContainer,"span",{id:"_end","data-mce-type":"bookmark"});var newRng=dom.createRng();newRng.setStartAfter(startContainer),newRng.setEndBefore(endContainer),RangeWalk_walk(dom,newRng,function(nodes){each(nodes,function(n){Bookmarks_isBookmarkNode(n)||Bookmarks_isBookmarkNode(n.parentNode)||splitToFormatRoot(n)})}),splitToFormatRoot(startContainer),splitToFormatRoot(endContainer),startContainer=unwrap(!0),endContainer=unwrap()}else startContainer=endContainer=splitToFormatRoot(startContainer);expandedRng.startContainer=startContainer.parentNode?startContainer.parentNode:startContainer,expandedRng.startOffset=dom.nodeIndex(startContainer),expandedRng.endContainer=endContainer.parentNode?endContainer.parentNode:endContainer,expandedRng.endOffset=dom.nodeIndex(endContainer)+1}RangeWalk_walk(dom,expandedRng,function(nodes){each$b(nodes,function(node){process(node),NodeType.isElement(node)&&"underline"===ed.dom.getStyle(node,"text-decoration")&&node.parentNode&&"underline"===getTextDecoration(dom,node.parentNode)&&removeFormat(ed,{deep:!1,exact:!0,inline:"span",styles:{textDecoration:"underline"}},null,node)})})}var bookmark,rng,formatList=ed.formatter.get(name),format=formatList[0],contentEditable=!0,dom=ed.dom,selection=ed.selection,process=function(node){var children,i,l,lastContentEditable,hasContentEditableState;if(NodeType.isElement(node)&&dom.getContentEditable(node)&&(lastContentEditable=contentEditable,contentEditable="true"===dom.getContentEditable(node),hasContentEditableState=!0),children=Tools.grep(node.childNodes),contentEditable&&!hasContentEditableState)for(i=0,l=formatList.length;i<l&&!removeFormat(ed,formatList[i],vars,node,node);i++);if(format.deep&&children.length){for(i=0,l=children.length;i<l;i++)process(children[i]);hasContentEditableState&&(contentEditable=lastContentEditable)}};if(node)isNode(node)?((rng=dom.createRng()).setStartBefore(node),rng.setEndAfter(node),removeRngStyle(rng)):removeRngStyle(node);else if("false"!==dom.getContentEditable(selection.getNode()))selection.isCollapsed()&&format.inline&&!dom.select("td[data-mce-selected],th[data-mce-selected]").length?function(editor,name,vars,similar){var container,offset,bookmark,hasContentAfter,node,formatNode,caretContainer,dom=editor.dom,selection=editor.selection,parents=[],rng=selection.getRng();for(container=rng.startContainer,offset=rng.startOffset,3===(node=container).nodeType&&(offset!==container.nodeValue.length&&(hasContentAfter=!0),node=node.parentNode);node;){if(matchNode(editor,node,name,vars,similar)){formatNode=node;break}node.nextSibling&&(hasContentAfter=!0),parents.push(node),node=node.parentNode}if(formatNode)if(hasContentAfter){bookmark=selection.getBookmark(),rng.collapse(!0);var expandedRng=expandRng(editor,rng,editor.formatter.get(name),!0);expandedRng=split$1(expandedRng),editor.formatter.remove(name,vars,expandedRng),selection.moveToBookmark(bookmark)}else{caretContainer=getParentCaretContainer(editor.getBody(),formatNode);var newCaretContainer=createCaretContainer(!1).dom(),caretNode=insertFormatNodesIntoCaretContainer(parents,newCaretContainer);insertCaretContainerNode(editor,newCaretContainer,caretContainer||formatNode),removeCaretContainerNode(editor,caretContainer,!1),selection.setCursorLocation(caretNode,1),dom.isEmpty(formatNode)&&dom.remove(formatNode)}}(ed,name,vars,similar):(bookmark=GetBookmark.getPersistentBookmark(ed.selection,!0),removeRngStyle(selection.getRng()),selection.moveToBookmark(bookmark),format.inline&&match(ed,name,vars,selection.getStart())&&moveStart(dom,selection,selection.getRng()),ed.nodeChanged());else{node=selection.getNode();for(var i=0,l=formatList.length;i<l&&(!formatList[i].ceFalseOverride||!removeFormat(ed,formatList[i],vars,node,node));i++);}}function isElementNode(node){return NodeType.isElement(node)&&!Bookmarks_isBookmarkNode(node)&&!isCaretNode(node)&&!NodeType.isBogus(node)}function findElementSibling(node,siblingName){var sibling;for(sibling=node;sibling;sibling=sibling[siblingName]){if(NodeType.isText(sibling)&&0!==sibling.nodeValue.length)return node;if(NodeType.isElement(sibling)&&!Bookmarks_isBookmarkNode(sibling))return sibling}return node}function mergeSiblingsNodes(dom,prev,next){var sibling,tmpSibling,elementUtils=new ElementUtils(dom);if(prev&&next&&(prev=findElementSibling(prev,"previousSibling"),next=findElementSibling(next,"nextSibling"),elementUtils.compare(prev,next))){for(sibling=prev.nextSibling;sibling&&sibling!==next;)sibling=(tmpSibling=sibling).nextSibling,prev.appendChild(tmpSibling);return dom.remove(next),Tools.each(Tools.grep(next.childNodes),function(node){prev.appendChild(node)}),prev}return next}function hasStyle(dom,name){return curry(function(name,node){return!(!node||!getStyle(dom,node,name))},name)}function applyStyle(dom,name,value){return curry(function(name,value,node){dom.setStyle(node,name,value),""===node.getAttribute("style")&&node.removeAttribute("style"),unwrapEmptySpan(dom,node)},name,value)}function processTextDecorationsAndColor(dom,node){if(1===node.nodeType&&node.parentNode&&1===node.parentNode.nodeType){var textDecoration=getTextDecoration(dom,node.parentNode);dom.getStyle(node,"color")&&textDecoration?dom.setStyle(node,"text-decoration",textDecoration):dom.getStyle(node,"text-decoration")===textDecoration&&dom.setStyle(node,"text-decoration",null)}}function mergeWithChildren(editor,formatList,vars,node){each$c(formatList,function(format){each$c(editor.dom.select(format.inline,node),function(child){isElementNode(child)&&removeFormat(editor,format,vars,child,format.exact?child:null)}),function(dom,format,node){if(format.clear_child_styles){var selector=format.links?"*:not(a)":"*";each$c(dom.select(selector,node),function(node){isElementNode(node)&&each$c(format.styles,function(value,name){dom.setStyle(node,name,"")})})}}(editor.dom,format,node)})}function normalizeBlockSelectionRange(rng){var startPos=CaretPosition$1.fromRangeStart(rng),endPos=CaretPosition$1.fromRangeEnd(rng),rootNode=rng.commonAncestorContainer;return CaretFinder.fromPosition(!1,rootNode,endPos).map(function(newEndPos){return!isInSameBlock(startPos,endPos,rootNode)&&isInSameBlock(startPos,newEndPos,rootNode)?function(sc,so,ec,eo){var rng=domGlobals.document.createRange();return rng.setStart(sc,so),rng.setEnd(ec,eo),rng}(startPos.container(),startPos.offset(),newEndPos.container(),newEndPos.offset()):rng}).getOr(rng)}function formatChanged(editor,registeredFormatListeners,formats,callback,similar){return null===registeredFormatListeners.get()&&function(registeredFormatListeners,editor){var currentFormats=Cell({});registeredFormatListeners.set({}),editor.on("NodeChange",function(e){updateAndFireChangeCallbacks(editor,e.element,currentFormats,registeredFormatListeners.get())})}(registeredFormatListeners,editor),function(registeredFormatListeners,formats,callback,similar){var formatChangeItems=registeredFormatListeners.get();each(formats.split(","),function(format){formatChangeItems[format]||(formatChangeItems[format]={similar:similar,callbacks:[]}),formatChangeItems[format].callbacks.push(callback)}),registeredFormatListeners.set(formatChangeItems)}(registeredFormatListeners,formats,callback,similar),{unbind:function(){return function(registeredFormatListeners,formats,callback){var formatChangeItems=registeredFormatListeners.get();each(formats.split(","),function(format){formatChangeItems[format].callbacks=filter(formatChangeItems[format].callbacks,function(c){return c!==callback}),0===formatChangeItems[format].callbacks.length&&delete formatChangeItems[format]}),registeredFormatListeners.set(formatChangeItems)}(registeredFormatListeners,formats,callback)}}}var each$a=Tools.each,MCE_ATTR_RE=/^(src|href|style)$/,each$b=Tools.each,isEq$3=isEq,each$c=Tools.each,processChildElements=function(node,filter,process){each$c(node.childNodes,function(node){isElementNode(node)&&(filter(node)&&process(node),node.hasChildNodes()&&processChildElements(node,filter,process))})},unwrapEmptySpan=function(dom,node){"SPAN"===node.nodeName&&0===dom.getAttribs(node).length&&dom.remove(node,!0)},RangeNormalizer_normalize=function(rng){return rng.collapsed?rng:normalizeBlockSelectionRange(rng)},each$d=Tools.each,applyFormat=function(ed,name,vars,node){function setElementFormat(elm,fmt){if(fmt=fmt||format,elm){if(fmt.onformat&&fmt.onformat(elm,fmt,vars,node),each$d(fmt.styles,function(value,name){dom.setStyle(elm,name,replaceVars(value,vars))}),fmt.styles){var styleVal=dom.getAttrib(elm,"style");styleVal&&dom.setAttrib(elm,"data-mce-style",styleVal)}each$d(fmt.attributes,function(value,name){dom.setAttrib(elm,name,replaceVars(value,vars))}),each$d(fmt.classes,function(value){value=replaceVars(value,vars),dom.hasClass(elm,value)||dom.addClass(elm,value)})}}function applyNodeStyle(formatList,node){var found=!1;return!!format.selector&&(each$d(formatList,function(format){if(!("collapsed"in format&&format.collapsed!==isCollapsed))return dom.is(node,format.selector)&&!isCaretNode(node)?(setElementFormat(node,format),!(found=!0)):void 0}),found)}function applyRngStyle(dom,rng,bookmark,nodeSpecific){var wrapName,wrapElm,newWrappers=[],contentEditable=!0;wrapName=format.inline||format.block,wrapElm=dom.create(wrapName),setElementFormat(wrapElm),RangeWalk_walk(dom,rng,function(nodes){var currentWrapElm,process=function(node){var hasContentEditableState=!1,lastContentEditable=contentEditable,nodeName=node.nodeName.toLowerCase(),parentName=node.parentNode.nodeName.toLowerCase();if(NodeType.isElement(node)&&dom.getContentEditable(node)&&(lastContentEditable=contentEditable,contentEditable="true"===dom.getContentEditable(node),hasContentEditableState=!0),isEq(nodeName,"br"))return currentWrapElm=0,void(format.block&&dom.remove(node));if(format.wrapper&&matchNode(ed,node,name,vars))currentWrapElm=0;else{if(contentEditable&&!hasContentEditableState&&format.block&&!format.wrapper&&isTextBlock$1(ed,nodeName)&&isValid(ed,parentName,wrapName))return node=dom.rename(node,wrapName),setElementFormat(node),newWrappers.push(node),void(currentWrapElm=0);if(format.selector){var found=applyNodeStyle(formatList,node);if(!format.inline||found)return void(currentWrapElm=0)}!contentEditable||hasContentEditableState||!isValid(ed,wrapName,nodeName)||!isValid(ed,parentName,wrapName)||!nodeSpecific&&3===node.nodeType&&1===node.nodeValue.length&&65279===node.nodeValue.charCodeAt(0)||isCaretNode(node)||format.inline&&dom.isBlock(node)?(currentWrapElm=0,each$d(Tools.grep(node.childNodes),process),hasContentEditableState&&(contentEditable=lastContentEditable),currentWrapElm=0):(currentWrapElm||(currentWrapElm=dom.clone(wrapElm,!1),node.parentNode.insertBefore(currentWrapElm,node),newWrappers.push(currentWrapElm)),currentWrapElm.appendChild(node))}};each$d(nodes,process)}),!0===format.links&&each$d(newWrappers,function(node){var process=function(node){"A"===node.nodeName&&setElementFormat(node,format),each$d(Tools.grep(node.childNodes),process)};process(node)}),each$d(newWrappers,function(node){function getChildElementNode(root){var child=!1;return each$d(root.childNodes,function(node){if(function(node){return node&&1===node.nodeType&&!Bookmarks_isBookmarkNode(node)&&!isCaretNode(node)&&!NodeType.isBogus(node)}(node))return child=node,!1}),child}var childCount;childCount=function(node){var count=0;return each$d(node.childNodes,function(node){(function(node){return node&&NodeType.isText(node)&&0===node.length})(node)||Bookmarks_isBookmarkNode(node)||count++}),count}(node),!(1<newWrappers.length)&&dom.isBlock(node)||0!==childCount?(format.inline||format.wrapper)&&(format.exact||1!==childCount||(node=function(node){var child,clone;return(child=getChildElementNode(node))&&!Bookmarks_isBookmarkNode(child)&&matchName(dom,child,format)&&(clone=dom.clone(child,!1),setElementFormat(clone),dom.replace(clone,node,!0),dom.remove(child,!0)),clone||node}(node)),mergeWithChildren(ed,formatList,vars,node),function(editor,format,name,vars,node){matchNode(editor,node.parentNode,name,vars)&&removeFormat(editor,format,vars,node)||format.merge_with_parents&&editor.dom.getParent(node.parentNode,function(parent){if(matchNode(editor,parent,name,vars))return removeFormat(editor,format,vars,node),!0})}(ed,format,name,vars,node),function(dom,format,vars,node){format.styles&&format.styles.backgroundColor&&processChildElements(node,hasStyle(dom,"fontSize"),applyStyle(dom,"backgroundColor",replaceVars(format.styles.backgroundColor,vars)))}(dom,format,vars,node),function(dom,format,vars,node){format.styles&&(format.styles.color||format.styles.textDecoration)&&(Tools.walk(node,curry(processTextDecorationsAndColor,dom),"childNodes"),processTextDecorationsAndColor(dom,node))}(dom,format,0,node),function(dom,format,vars,node){"sub"!==format.inline&&"sup"!==format.inline||(processChildElements(node,hasStyle(dom,"fontSize"),applyStyle(dom,"fontSize","")),dom.remove(dom.select("sup"===format.inline?"sub":"sup",node),!0))}(dom,format,0,node),function(dom,format,vars,node){node&&!1!==format.merge_siblings&&(node=mergeSiblingsNodes(dom,getNonWhiteSpaceSibling(node),node),node=mergeSiblingsNodes(dom,node,getNonWhiteSpaceSibling(node,!0)))}(dom,format,0,node)):dom.remove(node,!0)})}var bookmark,rng,formatList=ed.formatter.get(name),format=formatList[0],isCollapsed=!node&&ed.selection.isCollapsed(),dom=ed.dom,selection=ed.selection;if("false"!==dom.getContentEditable(selection.getNode())){if(format){if(node)isNode(node)?applyNodeStyle(formatList,node)||((rng=dom.createRng()).setStartBefore(node),rng.setEndAfter(node),applyRngStyle(dom,expandRng(ed,rng,formatList),0,!0)):applyRngStyle(dom,node,0,!0);else if(isCollapsed&&format.inline&&!dom.select("td[data-mce-selected],th[data-mce-selected]").length)!function(editor,name,vars){var rng,caretContainer,textNode,offset,bookmark,text,selection=editor.selection;offset=(rng=selection.getRng()).startOffset,text=rng.startContainer.nodeValue,(caretContainer=getParentCaretContainer(editor.getBody(),selection.getStart()))&&(textNode=findFirstTextNode(caretContainer));var wordcharRegex=/[^\s\u00a0\u00ad\u200b\ufeff]/;text&&0<offset&&offset<text.length&&wordcharRegex.test(text.charAt(offset))&&wordcharRegex.test(text.charAt(offset-1))?(bookmark=selection.getBookmark(),rng.collapse(!0),rng=expandRng(editor,rng,editor.formatter.get(name)),rng=split$1(rng),editor.formatter.apply(name,vars,rng),selection.moveToBookmark(bookmark)):(caretContainer&&textNode.nodeValue===ZWSP$1||(textNode=(caretContainer=function(ownerDocument,node){return ownerDocument.importNode(node,!0)}(editor.getDoc(),createCaretContainer(!0).dom())).firstChild,rng.insertNode(caretContainer),offset=1),editor.formatter.apply(name,vars,caretContainer),selection.setCursorLocation(textNode,offset))}(ed,name,vars);else{var curSelNode=ed.selection.getNode();ed.settings.forced_root_block||!formatList[0].defaultBlock||dom.getParent(curSelNode,dom.isBlock)||applyFormat(ed,formatList[0].defaultBlock),ed.selection.setRng(RangeNormalizer_normalize(ed.selection.getRng())),bookmark=GetBookmark.getPersistentBookmark(ed.selection,!0),applyRngStyle(dom,expandRng(ed,selection.getRng(),formatList)),selection.moveToBookmark(bookmark),moveStart(dom,selection,selection.getRng()),ed.nodeChanged()}!function(name,editor){each$9(postProcessHooks[name],function(hook){hook(editor)})}(name,ed)}}else{node=selection.getNode();for(var i=0,l=formatList.length;i<l;i++)if(formatList[i].ceFalseOverride&&dom.is(node,formatList[i].selector))return void setElementFormat(node,formatList[i])}},updateAndFireChangeCallbacks=function(editor,elm,currentFormats,formatChangeData){var formatsList=keys(currentFormats.get()),newFormats={},matchedFormats={},parents=filter(getParents$1(editor.dom,elm),function(node){return 1===node.nodeType&&!node.getAttribute("data-mce-bogus")});each$1(formatChangeData,function(data,format){Tools.each(parents,function(node){return editor.formatter.matchNode(node,format,{},data.similar)?(-1===formatsList.indexOf(format)&&(each(data.callbacks,function(callback){callback(!0,{node:node,format:format,parents:parents})}),newFormats[format]=data.callbacks),matchedFormats[format]=data.callbacks,!1):!matchesUnInheritedFormatSelector(editor,node,format)&&void 0})});var remainingFormats=filterRemainingFormats(currentFormats.get(),matchedFormats,elm,parents);currentFormats.set(__assign(__assign({},newFormats),remainingFormats))},filterRemainingFormats=function(currentFormats,matchedFormats,elm,parents){return bifilter(currentFormats,function(callbacks,format){return!!has(matchedFormats,format)||(each(callbacks,function(callback){callback(!1,{node:elm,format:format,parents:parents})}),!1)}).t},DefaultFormats_get=function(dom){var formats={valigntop:[{selector:"td,th",styles:{verticalAlign:"top"}}],valignmiddle:[{selector:"td,th",styles:{verticalAlign:"middle"}}],valignbottom:[{selector:"td,th",styles:{verticalAlign:"bottom"}}],alignleft:[{selector:"figure.image",collapsed:!1,classes:"align-left",ceFalseOverride:!0,preview:"font-family font-size"},{selector:"figure,p,h1,h2,h3,h4,h5,h6,td,th,tr,div,ul,ol,li",styles:{textAlign:"left"},inherit:!1,preview:!1,defaultBlock:"div"},{selector:"img,table",collapsed:!1,styles:{float:"left"},preview:"font-family font-size"}],aligncenter:[{selector:"figure,p,h1,h2,h3,h4,h5,h6,td,th,tr,div,ul,ol,li",styles:{textAlign:"center"},inherit:!1,preview:"font-family font-size",defaultBlock:"div"},{selector:"figure.image",collapsed:!1,classes:"align-center",ceFalseOverride:!0,preview:"font-family font-size"},{selector:"img",collapsed:!1,styles:{display:"block",marginLeft:"auto",marginRight:"auto"},preview:!1},{selector:"table",collapsed:!1,styles:{marginLeft:"auto",marginRight:"auto"},preview:"font-family font-size"}],alignright:[{selector:"figure.image",collapsed:!1,classes:"align-right",ceFalseOverride:!0,preview:"font-family font-size"},{selector:"figure,p,h1,h2,h3,h4,h5,h6,td,th,tr,div,ul,ol,li",styles:{textAlign:"right"},inherit:!1,preview:"font-family font-size",defaultBlock:"div"},{selector:"img,table",collapsed:!1,styles:{float:"right"},preview:"font-family font-size"}],alignjustify:[{selector:"figure,p,h1,h2,h3,h4,h5,h6,td,th,tr,div,ul,ol,li",styles:{textAlign:"justify"},inherit:!1,defaultBlock:"div",preview:"font-family font-size"}],bold:[{inline:"strong",remove:"all"},{inline:"span",styles:{fontWeight:"bold"}},{inline:"b",remove:"all"}],italic:[{inline:"em",remove:"all"},{inline:"span",styles:{fontStyle:"italic"}},{inline:"i",remove:"all"}],underline:[{inline:"span",styles:{textDecoration:"underline"},exact:!0},{inline:"u",remove:"all"}],strikethrough:[{inline:"span",styles:{textDecoration:"line-through"},exact:!0},{inline:"strike",remove:"all"}],forecolor:{inline:"span",styles:{color:"%value"},links:!0,remove_similar:!0,clear_child_styles:!0},hilitecolor:{inline:"span",styles:{backgroundColor:"%value"},links:!0,remove_similar:!0,clear_child_styles:!0},fontname:{inline:"span",toggle:!1,styles:{fontFamily:"%value"},clear_child_styles:!0},fontsize:{inline:"span",toggle:!1,styles:{fontSize:"%value"},clear_child_styles:!0},fontsize_class:{inline:"span",attributes:{class:"%value"}},blockquote:{block:"blockquote",wrapper:!0,remove:"all"},subscript:{inline:"sub"},superscript:{inline:"sup"},code:{inline:"code"},link:{inline:"a",selector:"a",remove:"all",split:!0,deep:!0,onmatch:function(){return!0},onformat:function(elm,fmt,vars){Tools.each(vars,function(value,key){dom.setAttrib(elm,key,value)})}},removeformat:[{selector:"b,strong,em,i,font,u,strike,sub,sup,dfn,code,samp,kbd,var,cite,mark,q,del,ins",remove:"all",split:!0,expand:!1,block_expand:!0,deep:!0},{selector:"span",attributes:["style","class"],remove:"empty",split:!0,expand:!1,deep:!0},{selector:"*",attributes:["style","class"],split:!1,expand:!1,deep:!0}]};return Tools.each("p h1 h2 h3 h4 h5 h6 div address pre div dt dd samp".split(/\s/),function(name){formats[name]={block:name,remove:"all"}}),formats};function parsedSelectorToHtml(ancestry,editor){function createElement(sItem){var elm;return item="string"==typeof sItem?{name:sItem,classes:[],attrs:{}}:sItem,function(elm,item){item.classes.length&&dom.addClass(elm,item.classes.join(" ")),dom.setAttribs(elm,item.attrs)}(elm=dom.create(item.name),item),elm}var elm,item,fragment,schema=editor&&editor.schema||Schema({}),wrapInHtml=function(elm,ancestry,siblings){var parent,parentCandidate,parentRequired,ancestor=0<ancestry.length&&ancestry[0],ancestorName=ancestor&&ancestor.name;if(parentRequired=function(elm,candidate){var name="string"!=typeof elm?elm.nodeName.toLowerCase():elm,elmRule=schema.getElementRule(name),parentsRequired=elmRule&&elmRule.parentsRequired;return!(!parentsRequired||!parentsRequired.length)&&(candidate&&-1!==Tools.inArray(parentsRequired,candidate)?candidate:parentsRequired[0])}(elm,ancestorName))ancestorName===parentRequired?(parentCandidate=ancestry[0],ancestry=ancestry.slice(1)):parentCandidate=parentRequired;else if(ancestor)parentCandidate=ancestry[0],ancestry=ancestry.slice(1);else if(!siblings)return elm;return parentCandidate&&(parent=createElement(parentCandidate)).appendChild(elm),siblings&&(parent||(parent=dom.create("div")).appendChild(elm),Tools.each(siblings,function(sibling){var siblingElm=createElement(sibling);parent.insertBefore(siblingElm,elm)})),wrapInHtml(parent,ancestry,parentCandidate&&parentCandidate.siblings)};return ancestry&&ancestry.length?(item=ancestry[0],elm=createElement(item),(fragment=dom.create("div")).appendChild(wrapInHtml(elm,ancestry.slice(1),item.siblings)),fragment):""}function parseSelectorItem(item){var tagName,obj={classes:[],attrs:{}};return"*"!==(item=obj.selector=Tools.trim(item))&&(tagName=item.replace(/(?:([#\.]|::?)([\w\-]+)|(\[)([^\]]+)\]?)/g,function($0,$1,$2,$3,$4){switch($1){case"#":obj.attrs.id=$2;break;case".":obj.classes.push($2);break;case":":-1!==Tools.inArray("checked disabled enabled read-only required".split(" "),$2)&&(obj.attrs[$2]=$2)}if("["===$3){var m=$4.match(/([\w\-]+)(?:\=\"([^\"]+))?/);m&&(obj.attrs[m[1]]=m[2])}return""})),obj.name=tagName||"div",obj}function getCssText(editor,format){var name,previewFrag,previewElm,items,parentFontSize,previewStyles,previewCss="";if(!1===(previewStyles=editor.settings.preview_styles))return"";function removeVars(val){return val.replace(/%(\w+)/g,"")}if("string"!=typeof previewStyles&&(previewStyles="font-family font-size font-weight font-style text-decoration text-transform color background-color border border-radius outline text-shadow"),"string"==typeof format){if(!(format=editor.formatter.get(format)))return;format=format[0]}return"preview"in format&&!1===(previewStyles=format.preview)?"":(name=format.block||format.inline||"span",previewFrag=(items=function(selector){return selector&&"string"==typeof selector?(selector=(selector=selector.split(/\s*,\s*/)[0]).replace(/\s*(~\+|~|\+|>)\s*/g,"$1"),Tools.map(selector.split(/(?:>|\s+(?![^\[\]]+\]))/),function(item){var siblings=Tools.map(item.split(/(?:~\+|~|\+)/),parseSelectorItem),obj=siblings.pop();return siblings.length&&(obj.siblings=siblings),obj}).reverse()):[]}(format.selector)).length?(items[0].name||(items[0].name=name),name=format.selector,parsedSelectorToHtml(items,editor)):parsedSelectorToHtml([name],editor),previewElm=dom.select(name,previewFrag)[0]||previewFrag.firstChild,each$e(format.styles,function(value,name){(value=removeVars(value))&&dom.setStyle(previewElm,name,value)}),each$e(format.attributes,function(value,name){(value=removeVars(value))&&dom.setAttrib(previewElm,name,value)}),each$e(format.classes,function(value){value=removeVars(value),dom.hasClass(previewElm,value)||dom.addClass(previewElm,value)}),editor.fire("PreviewFormats"),dom.setStyles(previewFrag,{position:"absolute",left:-65535}),editor.getBody().appendChild(previewFrag),parentFontSize=dom.getStyle(editor.getBody(),"fontSize",!0),parentFontSize=/px$/.test(parentFontSize)?parseInt(parentFontSize,10):0,each$e(previewStyles.split(" "),function(name){var value=dom.getStyle(previewElm,name,!0);if(!("background-color"===name&&/transparent|rgba\s*\([^)]+,\s*0\)/.test(value)&&(value=dom.getStyle(editor.getBody(),name,!0),"#ffffff"===dom.toHex(value).toLowerCase())||"color"===name&&"#000000"===dom.toHex(value).toLowerCase())){if("font-size"===name&&/em|%$/.test(value)){if(0===parentFontSize)return;value=parseFloat(value)/(/%$/.test(value)?100:1)*parentFontSize+"px"}"border"===name&&value&&(previewCss+="padding:0 2px;"),previewCss+=name+":"+value+";"}}),editor.fire("AfterPreviewFormats"),dom.remove(previewFrag),previewCss)}function toggle(editor,formats,name,vars,node){var fmt=formats.get(name);!match(editor,name,vars,node)||"toggle"in fmt[0]&&!fmt[0].toggle?applyFormat(editor,name,vars,node):remove$7(editor,name,vars,node)}function Formatter(editor){var formats=function(editor){var formats={},register=function(name,format){name&&("string"!=typeof name?Tools.each(name,function(format,name){register(name,format)}):(isArray(format)||(format=[format]),Tools.each(format,function(format){void 0===format.deep&&(format.deep=!format.selector),void 0===format.split&&(format.split=!format.selector||format.inline),void 0===format.remove&&format.selector&&!format.inline&&(format.remove="none"),format.selector&&format.inline&&(format.mixed=!0,format.block_expand=!0),"string"==typeof format.classes&&(format.classes=format.classes.split(/\s+/))}),formats[name]=format))};return register(DefaultFormats_get(editor.dom)),register(editor.settings.formats),{get:function(name){return name?formats[name]:formats},has:function(name){return has(formats,name)},register:register,unregister:function(name){return name&&formats[name]&&delete formats[name],formats}}}(editor),formatChangeState=Cell(null);return FormatShortcuts_setup(editor),setup$3(editor),{get:formats.get,has:formats.has,register:formats.register,unregister:formats.unregister,apply:curry(applyFormat,editor),remove:curry(remove$7,editor),toggle:curry(toggle,editor,formats),match:curry(match,editor),matchAll:curry(matchAll,editor),matchNode:curry(matchNode,editor),canApply:curry(canApply,editor),formatChanged:curry(formatChanged,editor,formatChangeState),getCssText:curry(getCssText,editor)}}function getOuterHtml(elm){return NodeType.isElement(elm)?elm.outerHTML:NodeType.isText(elm)?Entities.encodeRaw(elm.data,!1):NodeType.isComment(elm)?"\x3c!--"+elm.data+"--\x3e":""}function insertAt(elm,html,index){var fragment=function(html){var frag,node,container;for(container=domGlobals.document.createElement("div"),frag=domGlobals.document.createDocumentFragment(),html&&(container.innerHTML=html);node=container.firstChild;)frag.appendChild(node);return frag}(html);if(elm.hasChildNodes()&&index<elm.childNodes.length){var target=elm.childNodes[index];target.parentNode.insertBefore(fragment,target)}else elm.appendChild(fragment)}function createFragmentedLevel(fragments){return{type:"fragmented",fragments:fragments,content:"",bookmark:null,beforeBookmark:null}}function createCompleteLevel(content){return{type:"complete",fragments:null,content:content,bookmark:null,beforeBookmark:null}}function getLevelContent(level){return"fragmented"===level.type?level.fragments.join(""):level.content}function getCleanLevelContent(level){var elm=Element.fromTag("body",undoLevelDocument.get().getOrThunk(function(){var doc=domGlobals.document.implementation.createHTMLDocument("undo");return undoLevelDocument.set(Option.some(doc)),doc}));return set$1(elm,getLevelContent(level)),each(descendants$1(elm,"*[data-mce-bogus]"),unwrap),function(element){return element.dom().innerHTML}(elm)}function isUnlocked(locks){return 0===locks.get()}function setTyping(undoManager,typing,locks){isUnlocked(locks)&&(undoManager.typing=typing)}function endTyping(undoManager,locks){undoManager.typing&&(setTyping(undoManager,!1,locks),undoManager.add())}function registerEvents$1(editor,undoManager,locks){function addNonTypingUndoLevel(e){setTyping(undoManager,!1,locks),undoManager.add({},e)}var isFirstTypedCharacter=Cell(!1);editor.on("init",function(){undoManager.add()}),editor.on("BeforeExecCommand",function(e){var cmd=e.command;"Undo"!==cmd&&"Redo"!==cmd&&"mceRepaint"!==cmd&&(endTyping(undoManager,locks),undoManager.beforeChange())}),editor.on("ExecCommand",function(e){var cmd=e.command;"Undo"!==cmd&&"Redo"!==cmd&&"mceRepaint"!==cmd&&addNonTypingUndoLevel(e)}),editor.on("ObjectResizeStart cut",function(){undoManager.beforeChange()}),editor.on("SaveContent ObjectResized blur",addNonTypingUndoLevel),editor.on("dragend",addNonTypingUndoLevel),editor.on("keyup",function(e){var keyCode=e.keyCode;e.isDefaultPrevented()||((33<=keyCode&&keyCode<=36||37<=keyCode&&keyCode<=40||45===keyCode||e.ctrlKey)&&(addNonTypingUndoLevel(),editor.nodeChanged()),46!==keyCode&&8!==keyCode||editor.nodeChanged(),isFirstTypedCharacter.get()&&undoManager.typing&&!1===Levels_isEq(Levels_createFromEditor(editor),undoManager.data[0])&&(!1===editor.isDirty()&&(editor.setDirty(!0),editor.fire("change",{level:undoManager.data[0],lastLevel:null})),editor.fire("TypingUndo"),isFirstTypedCharacter.set(!1),editor.nodeChanged()))}),editor.on("keydown",function(e){var keyCode=e.keyCode;if(!e.isDefaultPrevented())if(33<=keyCode&&keyCode<=36||37<=keyCode&&keyCode<=40||45===keyCode)undoManager.typing&&addNonTypingUndoLevel(e);else{var modKey=e.ctrlKey&&!e.altKey||e.metaKey;!(keyCode<16||20<keyCode)||224===keyCode||91===keyCode||undoManager.typing||modKey||(undoManager.beforeChange(),setTyping(undoManager,!0,locks),undoManager.add({},e),isFirstTypedCharacter.set(!0))}}),editor.on("mousedown",function(e){undoManager.typing&&addNonTypingUndoLevel(e)}),editor.on("input",function(e){e.inputType&&(function(event){return"insertReplacementText"===event.inputType}(e)||function(event){return"insertText"===event.inputType&&null===event.data}(e))&&addNonTypingUndoLevel(e)}),editor.on("AddUndo Undo Redo ClearUndos",function(e){e.isDefaultPrevented()||editor.nodeChanged()})}function UndoManager(editor){var beforeBookmark=Cell(Option.none()),locks=Cell(0),index=Cell(0),undoManager={data:[],typing:!1,beforeChange:function(){!function(editor,locks,beforeBookmark){isUnlocked(locks)&&beforeBookmark.set(Option.some(GetBookmark.getUndoBookmark(editor.selection)))}(editor,locks,beforeBookmark)},add:function(level,event){return function(editor,undoManager,index,locks,beforeBookmark,level,event){var settings=editor.settings,currentLevel=Levels_createFromEditor(editor);if(level=level||{},level=Tools.extend(level,currentLevel),!1===isUnlocked(locks)||editor.removed)return null;var lastLevel=undoManager.data[index.get()];if(editor.fire("BeforeAddUndo",{level:level,lastLevel:lastLevel,originalEvent:event}).isDefaultPrevented())return null;if(lastLevel&&Levels_isEq(lastLevel,level))return null;if(undoManager.data[index.get()]&&beforeBookmark.get().each(function(bm){undoManager.data[index.get()].beforeBookmark=bm}),settings.custom_undo_redo_levels&&undoManager.data.length>settings.custom_undo_redo_levels){for(var i=0;i<undoManager.data.length-1;i++)undoManager.data[i]=undoManager.data[i+1];undoManager.data.length--,index.set(undoManager.data.length)}level.bookmark=GetBookmark.getUndoBookmark(editor.selection),index.get()<undoManager.data.length-1&&(undoManager.data.length=index.get()+1),undoManager.data.push(level),index.set(undoManager.data.length-1);var args={level:level,lastLevel:lastLevel,originalEvent:event};return editor.fire("AddUndo",args),0<index.get()&&(editor.setDirty(!0),editor.fire("change",args)),level}(editor,undoManager,index,locks,beforeBookmark,level,event)},undo:function(){return function(editor,undoManager,locks,index){var level;return undoManager.typing&&(undoManager.add(),undoManager.typing=!1,setTyping(undoManager,!1,locks)),0<index.get()&&(index.set(index.get()-1),level=undoManager.data[index.get()],Levels_applyToEditor(editor,level,!0),editor.setDirty(!0),editor.fire("Undo",{level:level})),level}(editor,undoManager,locks,index)},redo:function(){return function(editor,index,data){var level;return index.get()<data.length-1&&(index.set(index.get()+1),level=data[index.get()],Levels_applyToEditor(editor,level,!1),editor.setDirty(!0),editor.fire("Redo",{level:level})),level}(editor,index,undoManager.data)},clear:function(){!function(editor,undoManager,index){undoManager.data=[],index.set(0),undoManager.typing=!1,editor.fire("ClearUndos")}(editor,undoManager,index)},reset:function(){!function(undoManager){undoManager.clear(),undoManager.add()}(undoManager)},hasUndo:function(){return function(editor,undoManager,index){return 0<index.get()||undoManager.typing&&undoManager.data[0]&&!Levels_isEq(Levels_createFromEditor(editor),undoManager.data[0])}(editor,undoManager,index)},hasRedo:function(){return function(undoManager,index){return index.get()<undoManager.data.length-1&&!undoManager.typing}(undoManager,index)},transact:function(callback){return function(undoManager,locks,callback){return endTyping(undoManager,locks),undoManager.beforeChange(),undoManager.ignore(callback),undoManager.add()}(undoManager,locks,callback)},ignore:function(callback){!function(locks,callback){try{locks.set(locks.get()+1),callback()}finally{locks.set(locks.get()-1)}}(locks,callback)},extra:function(callback1,callback2){!function(editor,undoManager,index,callback1,callback2){if(undoManager.transact(callback1)){var bookmark=undoManager.data[index.get()].bookmark,lastLevel=undoManager.data[index.get()-1];Levels_applyToEditor(editor,lastLevel,!0),undoManager.transact(callback2)&&(undoManager.data[index.get()-1].beforeBookmark=bookmark)}}(editor,undoManager,index,callback1,callback2)}};return registerEvents$1(editor,undoManager,locks),function(editor){editor.addShortcut("meta+z","","Undo"),editor.addShortcut("meta+y,meta+shift+z","","Redo")}(editor),undoManager}function isKeyboardEvent(e){return"keydown"===e.type||"keyup"===e.type}function isDeleteEvent(e){var keyCode=e.keyCode;return keyCode===VK.BACKSPACE||keyCode===VK.DELETE}function setup$6(editor){var dom=editor.dom,rootBlock=Settings_getForcedRootBlock(editor),placeholder=Settings_getPlaceholder(editor),updatePlaceholder=function(e,initial){if(!function(e){if(isKeyboardEvent(e)){var keyCode=e.keyCode;return!isDeleteEvent(e)&&(VK.metaKeyPressed(e)||e.altKey||112<=keyCode&&keyCode<=123||contains(nonTypingKeycodes,keyCode))}return!1}(e)){var body=editor.getBody(),showPlaceholder=!function(e){return isKeyboardEvent(e)&&!(isDeleteEvent(e)||"keyup"===e.type&&229===e.keyCode)}(e)&&function(dom,rootElm,forcedRootBlock){if(Empty_isEmpty(Element.fromDom(rootElm),!1)){var isForcedRootBlockFalse=""===forcedRootBlock,firstElement=rootElm.firstElementChild;return!firstElement||!dom.getStyle(rootElm.firstElementChild,"padding-left")&&!dom.getStyle(rootElm.firstElementChild,"padding-right")&&(isForcedRootBlockFalse?!dom.isBlock(firstElement):forcedRootBlock===firstElement.nodeName.toLowerCase())}return!1}(dom,body,rootBlock);""!==dom.getAttrib(body,"data-mce-placeholder")===showPlaceholder&&!initial||(dom.setAttrib(body,"data-mce-placeholder",showPlaceholder?placeholder:null),dom.setAttrib(body,"aria-placeholder",showPlaceholder?placeholder:null),function(editor,state){editor.fire("PlaceholderToggle",{state:state})}(editor,showPlaceholder),editor.on(showPlaceholder?"keydown":"keyup",updatePlaceholder),editor.off(showPlaceholder?"keyup":"keydown",updatePlaceholder))}};placeholder&&editor.on("init",function(e){updatePlaceholder(e,!0),editor.on("change SetContent ExecCommand",updatePlaceholder),editor.on("remove",function(){var body=editor.getBody();dom.setAttrib(body,"data-mce-placeholder",null),dom.setAttrib(body,"aria-placeholder",null)})})}function getTouch(event){return void 0===event.touches||1!==event.touches.length?Option.none():Option.some(event.touches[0])}function isBlockElement(blockElements,node){return blockElements.hasOwnProperty(node.nodeName)}function isValidTarget(blockElements,node){return!!NodeType.isText(node)||!!NodeType.isElement(node)&&(!isBlockElement(blockElements,node)&&!Bookmarks_isBookmarkNode(node))}function shouldRemoveTextNode(blockElements,node){if(NodeType.isText(node)){if(0===node.nodeValue.length)return!0;if(/^\s+$/.test(node.nodeValue)&&(!node.nextSibling||isBlockElement(blockElements,node.nextSibling)))return!0}return!1}function addRootBlocks(editor){var rng,startContainer,startOffset,endContainer,endOffset,rootBlockNode,tempNode,wrapped,restoreSelection,rootNodeName,dom=editor.dom,selection=editor.selection,schema=editor.schema,blockElements=schema.getBlockElements(),node=selection.getStart(),rootNode=editor.getBody(),forcedRootBlock=Settings_getForcedRootBlock(editor);if(node&&NodeType.isElement(node)&&forcedRootBlock&&(rootNodeName=rootNode.nodeName.toLowerCase(),schema.isValidChild(rootNodeName,forcedRootBlock.toLowerCase())&&!function(blockElements,root,node){return exists(Parents_parents(Element.fromDom(node),Element.fromDom(root)),function(elm){return isBlockElement(blockElements,elm.dom())})}(blockElements,rootNode,node))){for(startContainer=(rng=selection.getRng()).startContainer,startOffset=rng.startOffset,endContainer=rng.endContainer,endOffset=rng.endOffset,restoreSelection=EditorFocus_hasFocus(editor),node=rootNode.firstChild;node;)if(isValidTarget(blockElements,node)){if(shouldRemoveTextNode(blockElements,node)){node=(tempNode=node).nextSibling,dom.remove(tempNode);continue}rootBlockNode||(rootBlockNode=dom.create(forcedRootBlock,Settings_getForcedRootBlockAttrs(editor)),node.parentNode.insertBefore(rootBlockNode,node),wrapped=!0),node=(tempNode=node).nextSibling,rootBlockNode.appendChild(tempNode)}else rootBlockNode=null,node=node.nextSibling;wrapped&&restoreSelection&&(rng.setStart(startContainer,startOffset),rng.setEnd(endContainer,endOffset),selection.setRng(rng),editor.nodeChanged())}}function startsWithCaretContainer$1(node){return isText$8(node)&&node.data[0]===Zwsp.ZWSP}function endsWithCaretContainer$1(node){return isText$8(node)&&node.data[node.data.length-1]===Zwsp.ZWSP}function createZwsp(node){return node.ownerDocument.createTextNode(Zwsp.ZWSP)}function insertInline$1(before,node){return before?function(node){if(isText$8(node.previousSibling))return endsWithCaretContainer$1(node.previousSibling)||node.previousSibling.appendData(Zwsp.ZWSP),node.previousSibling;if(isText$8(node))return startsWithCaretContainer$1(node)||node.insertData(0,Zwsp.ZWSP),node;var newNode=createZwsp(node);return node.parentNode.insertBefore(newNode,node),newNode}(node):function(node){if(isText$8(node.nextSibling))return startsWithCaretContainer$1(node.nextSibling)||node.nextSibling.insertData(0,Zwsp.ZWSP),node.nextSibling;if(isText$8(node))return endsWithCaretContainer$1(node)||node.appendData(Zwsp.ZWSP),node;var newNode=createZwsp(node);return node.nextSibling?node.parentNode.insertBefore(newNode,node.nextSibling):node.parentNode.appendChild(newNode),newNode}(node)}function insertInlinePos(pos,before){return NodeType.isText(pos.container())?insertInline$1(before,pos.container()):insertInline$1(before,pos.getNode())}function isPosCaretContainer(pos,caret){var caretNode=caret.get();return caretNode&&pos.container()===caretNode&&isCaretContainerInline(caretNode)}function normalizePosition(forward,pos){if(!pos)return pos;var container=pos.container(),offset=pos.offset();return forward?isCaretContainerInline(container)?NodeType.isText(container.nextSibling)?CaretPosition$1(container.nextSibling,0):CaretPosition$1.after(container):isBeforeInline(pos)?CaretPosition$1(container,offset+1):pos:isCaretContainerInline(container)?NodeType.isText(container.previousSibling)?CaretPosition$1(container.previousSibling,container.previousSibling.data.length):CaretPosition$1.before(container):isAfterInline(pos)?CaretPosition$1(container,offset-1):pos}function rescope(rootNode,node){var parentBlock=getParentBlock(node,rootNode);return parentBlock||rootNode}function before$4(isInlineTarget,rootNode,pos){var nPos=InlineUtils.normalizeForwards(pos),scope=rescope(rootNode,nPos.container());return InlineUtils.findRootInline(isInlineTarget,scope,nPos).fold(function(){return CaretFinder.nextPosition(scope,nPos).bind(curry(InlineUtils.findRootInline,isInlineTarget,scope)).map(function(inline){return Location.before(inline)})},Option.none)}function isNotInsideFormatCaretContainer(rootNode,elm){return null===getParentCaretContainer(rootNode,elm)}function findInsideRootInline(isInlineTarget,rootNode,pos){return InlineUtils.findRootInline(isInlineTarget,rootNode,pos).filter(curry(isNotInsideFormatCaretContainer,rootNode))}function start(isInlineTarget,rootNode,pos){var nPos=InlineUtils.normalizeBackwards(pos);return findInsideRootInline(isInlineTarget,rootNode,nPos).bind(function(inline){return CaretFinder.prevPosition(inline,nPos).isNone()?Option.some(Location.start(inline)):Option.none()})}function end(isInlineTarget,rootNode,pos){var nPos=InlineUtils.normalizeForwards(pos);return findInsideRootInline(isInlineTarget,rootNode,nPos).bind(function(inline){return CaretFinder.nextPosition(inline,nPos).isNone()?Option.some(Location.end(inline)):Option.none()})}function after$3(isInlineTarget,rootNode,pos){var nPos=InlineUtils.normalizeBackwards(pos),scope=rescope(rootNode,nPos.container());return InlineUtils.findRootInline(isInlineTarget,scope,nPos).fold(function(){return CaretFinder.prevPosition(scope,nPos).bind(curry(InlineUtils.findRootInline,isInlineTarget,scope)).map(function(inline){return Location.after(inline)})},Option.none)}function isValidLocation(location){return!1===InlineUtils.isRtl(getElement(location))}function readLocation(isInlineTarget,rootNode,pos){return LazyEvaluator_evaluateUntil([before$4,start,end,after$3],[isInlineTarget,rootNode,pos]).filter(isValidLocation)}function getName(location){return location.fold(constant("before"),constant("start"),constant("end"),constant("after"))}function outside(location){return location.fold(Location.before,Location.before,Location.after,Location.after)}function betweenInlines(forward,isInlineTarget,rootNode,from,to,location){return lift2(InlineUtils.findRootInline(isInlineTarget,rootNode,from),InlineUtils.findRootInline(isInlineTarget,rootNode,to),function(fromInline,toInline){return fromInline!==toInline&&InlineUtils.hasSameParentBlock(rootNode,fromInline,toInline)?Location.after(forward?fromInline:toInline):location}).getOr(location)}function skipNoMovement(fromLocation,toLocation){return fromLocation.fold(constant(!0),function(fromLocation){return!function(location1,location2){return getName(location1)===getName(location2)&&getElement(location1)===getElement(location2)}(fromLocation,toLocation)})}function findLocationSimple(forward,location){return forward?location.fold(compose(Option.some,Location.start),Option.none,compose(Option.some,Location.after),Option.none):location.fold(Option.none,compose(Option.some,Location.before),Option.none,compose(Option.some,Location.end))}function findLocation(forward,isInlineTarget,rootNode,pos){var from=InlineUtils.normalizePosition(forward,pos),fromLocation=readLocation(isInlineTarget,rootNode,from);return readLocation(isInlineTarget,rootNode,from).bind(curry(findLocationSimple,forward)).orThunk(function(){return function(forward,isInlineTarget,rootNode,fromLocation,pos){var from=InlineUtils.normalizePosition(forward,pos);return CaretFinder.fromPosition(forward,rootNode,from).map(curry(InlineUtils.normalizePosition,forward)).fold(function(){return fromLocation.map(outside)},function(to){return readLocation(isInlineTarget,rootNode,to).map(curry(betweenInlines,forward,isInlineTarget,rootNode,from,to)).filter(curry(skipNoMovement,fromLocation))}).filter(isValidLocation)}(forward,isInlineTarget,rootNode,fromLocation,pos)})}function hasSelectionModifyApi(editor){return isFunction(editor.selection.getSel().modify)}function moveRel(forward,selection,pos){var delta=forward?1:-1;return selection.setRng(CaretPosition$1(pos.container(),pos.offset()+delta).toRange()),selection.getSel().modify("move",forward?"forward":"backward","word"),!0}function setCaretPosition(editor,pos){var rng=editor.dom.createRng();rng.setStart(pos.container(),pos.offset()),rng.setEnd(pos.container(),pos.offset()),editor.selection.setRng(rng)}function isFeatureEnabled(editor){return!1!==editor.settings.inline_boundaries}function setSelected(state,elm){state?elm.setAttribute("data-mce-selected","inline-boundary"):elm.removeAttribute("data-mce-selected")}function renderCaretLocation(editor,caret,location){return BoundaryCaret_renderCaret(caret,location).map(function(pos){return setCaretPosition(editor,pos),location})}function moveWord(forward,editor,caret){return function(){return!!isFeatureEnabled(editor)&&WordSelection_moveByWord(forward,editor)}}function getNodeClientRects(node){function toArrayWithNode(clientRects){return map(clientRects,function(clientRect){return(clientRect=clone$1(clientRect)).node=node,clientRect})}if(NodeType.isElement(node))return toArrayWithNode(node.getClientRects());if(NodeType.isText(node)){var rng=node.ownerDocument.createRange();return rng.setStart(node,0),rng.setEnd(node,node.data.length),toArrayWithNode(rng.getClientRects())}}function getClientRects(node){return foldl(node,function(result,node){return result.concat(getNodeClientRects(node))},[])}var VDirection,each$e=Tools.each,dom=DOMUtils$1.DOM,FormatShortcuts_setup=function(editor){editor.addShortcut("meta+b","","Bold"),editor.addShortcut("meta+i","","Italic"),editor.addShortcut("meta+u","","Underline");for(var i=1;i<=6;i++)editor.addShortcut("access+"+i,"",["FormatBlock",!1,"h"+i]);editor.addShortcut("access+7","",["FormatBlock",!1,"p"]),editor.addShortcut("access+8","",["FormatBlock",!1,"div"]),editor.addShortcut("access+9","",["FormatBlock",!1,"address"])},Diff_KEEP=0,Diff_DELETE=2,Diff_INSERT=1,Diff_diff=function(left,right){function buildSnake(start,diag,end1,end2){for(var end=start;end-diag<end2&&end<end1&&left[end]===right[end-diag];)++end;return function(start,end,diag){return{start:start,end:end,diag:diag}}(start,end,diag)}var size=left.length+right.length+2,vDown=new Array(size),vUp=new Array(size),buildScript=function(start1,end1,start2,end2,script){var middle=getMiddleSnake(start1,end1,start2,end2);if(null===middle||middle.start===end1&&middle.diag===end1-end2||middle.end===start1&&middle.diag===start1-start2)for(var i=start1,j=start2;i<end1||j<end2;)i<end1&&j<end2&&left[i]===right[j]?(script.push([0,left[i]]),++i,++j):end2-start2<end1-start1?(script.push([2,left[i]]),++i):(script.push([1,right[j]]),++j);else{buildScript(start1,middle.start,start2,middle.start-middle.diag,script);for(var i2=middle.start;i2<middle.end;++i2)script.push([0,left[i2]]);buildScript(middle.end,end1,middle.end-middle.diag,end2,script)}},getMiddleSnake=function(start1,end1,start2,end2){var m=end1-start1,n=end2-start2;if(0==m||0==n)return null;var d,k,i,x,y,delta=m-n,sum=n+m,offset=(sum%2==0?sum:1+sum)/2;for(vDown[1+offset]=start1,vUp[1+offset]=end1+1,d=0;d<=offset;++d){for(k=-d;k<=d;k+=2){for(i=k+offset,k===-d||k!==d&&vDown[i-1]<vDown[i+1]?vDown[i]=vDown[i+1]:vDown[i]=vDown[i-1]+1,y=(x=vDown[i])-start1+start2-k;x<end1&&y<end2&&left[x]===right[y];)vDown[i]=++x,++y;if(delta%2!=0&&delta-d<=k&&k<=delta+d&&vUp[i-delta]<=vDown[i])return buildSnake(vUp[i-delta],k+start1-start2,end1,end2)}for(k=delta-d;k<=delta+d;k+=2){for(i=k+offset-delta,k===delta-d||k!==delta+d&&vUp[i+1]<=vUp[i-1]?vUp[i]=vUp[i+1]-1:vUp[i]=vUp[i-1],y=(x=vUp[i]-1)-start1+start2-k;start1<=x&&start2<=y&&left[x]===right[y];)vUp[i]=x--,y--;if(delta%2==0&&-d<=k&&k<=d&&vUp[i]<=vDown[i+delta])return buildSnake(vUp[i],k+start1-start2,end1,end2)}}},script=[];return buildScript(0,left.length,0,right.length,script),script},Fragments_read=function(elm){return filter(map(from$1(elm.childNodes),getOuterHtml),function(item){return 0<item.length})},Fragments_write=function(fragments,elm){var currentFragments=map(from$1(elm.childNodes),getOuterHtml);return function(diff,elm){var index=0;each(diff,function(action){action[0]===Diff_KEEP?index++:action[0]===Diff_INSERT?(insertAt(elm,action[1],index),index++):action[0]===Diff_DELETE&&function(elm,index){if(elm.hasChildNodes()&&index<elm.childNodes.length){var target=elm.childNodes[index];target.parentNode.removeChild(target)}}(elm,index)})}(Diff_diff(currentFragments,fragments),elm),elm},undoLevelDocument=Cell(Option.none()),Levels_createFromEditor=function(editor){var fragments,content,trimmedFragments;return fragments=Fragments_read(editor.getBody()),function(html){return-1!==html.indexOf("</iframe>")}(content=(trimmedFragments=bind(fragments,function(html){var trimmed=TrimHtml.trimInternal(editor.serializer,html);return 0<trimmed.length?[trimmed]:[]})).join(""))?createFragmentedLevel(trimmedFragments):createCompleteLevel(content)},Levels_applyToEditor=function(editor,level,before){"fragmented"===level.type?Fragments_write(level.fragments,editor.getBody()):editor.setContent(level.content,{format:"raw"}),editor.selection.moveToBookmark(before?level.beforeBookmark:level.bookmark)},Levels_isEq=function(level1,level2){return!(!level1||!level2)&&(!!function(level1,level2){return getLevelContent(level1)===getLevelContent(level2)}(level1,level2)||function(level1,level2){return getCleanLevelContent(level1)===getCleanLevelContent(level2)}(level1,level2))},nonTypingKeycodes=[9,27,VK.HOME,VK.END,19,20,44,144,145,33,34,45,16,17,18,91,92,93,VK.DOWN,VK.UP,VK.LEFT,VK.RIGHT].concat(Env.browser.isFirefox()?[224]:[]),TouchEvents_setup=function(editor){var startData=Cell(Option.none()),longpressFired=Cell(!1),debounceLongpress=last$2(function(e){editor.fire("longpress",__assign(__assign({},e),{type:"longpress"})),longpressFired.set(!0)},400);editor.on("touchstart",function(e){getTouch(e).each(function(touch){debounceLongpress.cancel();var data={x:constant(touch.clientX),y:constant(touch.clientY),target:constant(e.target)};debounceLongpress.throttle(e),longpressFired.set(!1),startData.set(Option.some(data))})},!0),editor.on("touchmove",function(e){debounceLongpress.cancel(),getTouch(e).each(function(touch){startData.get().each(function(data){!function(touch,data){var distX=Math.abs(touch.clientX-data.x()),distY=Math.abs(touch.clientY-data.y());return 5<distX||5<distY}(touch,data)||(startData.set(Option.none()),longpressFired.set(!1),editor.fire("longpresscancel"))})})},!0),editor.on("touchend touchcancel",function(e){debounceLongpress.cancel(),"touchcancel"!==e.type&&startData.get().filter(function(data){return data.target().isEqualNode(e.target)}).each(function(){longpressFired.get()?e.preventDefault():editor.fire("tap",__assign(__assign({},e),{type:"tap"}))})},!0)},ForceBlocks_setup=function(editor){Settings_getForcedRootBlock(editor)&&editor.on("NodeChange",curry(addRootBlocks,editor))},isText$8=NodeType.isText,insertInlineBefore=curry(insertInline$1,!0),insertInlineAfter=curry(insertInline$1,!1),BoundaryCaret_renderCaret=function(caret,location){return location.fold(function(element){CaretContainerRemove.remove(caret.get());var text=insertInlineBefore(element);return caret.set(text),Option.some(CaretPosition$1(text,text.length-1))},function(element){return CaretFinder.firstPositionIn(element).map(function(pos){if(isPosCaretContainer(pos,caret))return CaretPosition$1(caret.get(),1);CaretContainerRemove.remove(caret.get());var text=insertInlinePos(pos,!0);return caret.set(text),CaretPosition$1(text,1)})},function(element){return CaretFinder.lastPositionIn(element).map(function(pos){if(isPosCaretContainer(pos,caret))return CaretPosition$1(caret.get(),caret.get().length-1);CaretContainerRemove.remove(caret.get());var text=insertInlinePos(pos,!1);return caret.set(text),CaretPosition$1(text,text.length-1)})},function(element){CaretContainerRemove.remove(caret.get());var text=insertInlineAfter(element);return caret.set(text),Option.some(CaretPosition$1(text,1))})},strongRtl=/[\u0591-\u07FF\uFB1D-\uFDFF\uFE70-\uFEFC]/,InlineUtils={isInlineTarget:function(editor,elm){return is(Element.fromDom(elm),Settings_getInlineBoundarySelector(editor))},findRootInline:function(isInlineTarget,rootNode,pos){var parents=function(isInlineTarget,rootNode,pos){return filter(DOMUtils$1.DOM.getParents(pos.container(),"*",rootNode),isInlineTarget)}(isInlineTarget,rootNode,pos);return Option.from(parents[parents.length-1])},isRtl:function(element){return"rtl"===DOMUtils$1.DOM.getStyle(element,"direction",!0)||function(text){return strongRtl.test(text)}(element.textContent)},isAtZwsp:function(pos){return isBeforeInline(pos)||isAfterInline(pos)},normalizePosition:normalizePosition,normalizeForwards:curry(normalizePosition,!0),normalizeBackwards:curry(normalizePosition,!1),hasSameParentBlock:function(rootNode,node1,node2){var block1=getParentBlock(node1,rootNode),block2=getParentBlock(node2,rootNode);return block1&&block1===block2}},LazyEvaluator_evaluateUntil=function(fns,args){for(var i=0;i<fns.length;i++){var result=fns[i].apply(null,args);if(result.isSome())return result}return Option.none()},Location=Adt_generate([{before:["element"]},{start:["element"]},{end:["element"]},{after:["element"]}]),getElement=function(location){return location.fold(identity,identity,identity,identity)},BoundaryLocation_readLocation=readLocation,BoundaryLocation_findLocation=findLocation,BoundaryLocation_outside=(curry(findLocation,!1),curry(findLocation,!0),outside),BoundaryLocation_inside=function(location){return location.fold(Location.start,Location.start,Location.end,Location.end)},WordSelection_moveByWord=function(forward,editor){var rng=editor.selection.getRng(),pos=forward?CaretPosition$1.fromRangeEnd(rng):CaretPosition$1.fromRangeStart(rng);return!!hasSelectionModifyApi(editor)&&(forward&&isBeforeInline(pos)?moveRel(!0,editor.selection,pos):!(forward||!isAfterInline(pos))&&moveRel(!1,editor.selection,pos))},BoundarySelection={move:function(editor,caret,forward){return function(){return!!isFeatureEnabled(editor)&&function(editor,caret,forward){var rootNode=editor.getBody(),from=CaretPosition$1.fromRangeStart(editor.selection.getRng()),isInlineTarget=curry(InlineUtils.isInlineTarget,editor);return BoundaryLocation_findLocation(forward,isInlineTarget,rootNode,from).bind(function(location){return renderCaretLocation(editor,caret,location)})}(editor,caret,forward).isSome()}},moveNextWord:curry(moveWord,!0),movePrevWord:curry(moveWord,!1),setupSelectedState:function(editor){var caret=Cell(null),isInlineTarget=curry(InlineUtils.isInlineTarget,editor);return editor.on("NodeChange",function(e){!isFeatureEnabled(editor)||Env.browser.isIE()&&e.initial||(function(isInlineTarget,dom,elms){var selectedInlines=filter(dom.select('*[data-mce-selected="inline-boundary"]'),isInlineTarget),targetInlines=filter(elms,isInlineTarget);each(difference(selectedInlines,targetInlines),curry(setSelected,!1)),each(difference(targetInlines,selectedInlines),curry(setSelected,!0))}(isInlineTarget,editor.dom,e.parents),function(editor,caret){if(editor.selection.isCollapsed()&&!0!==editor.composing&&caret.get()){var pos=CaretPosition$1.fromRangeStart(editor.selection.getRng());CaretPosition$1.isTextPosition(pos)&&!1===InlineUtils.isAtZwsp(pos)&&(setCaretPosition(editor,CaretContainerRemove.removeAndReposition(caret.get(),pos)),caret.set(null))}}(editor,caret),function(isInlineTarget,editor,caret,elms){if(editor.selection.isCollapsed()){var inlines=filter(elms,isInlineTarget);each(inlines,function(inline){var pos=CaretPosition$1.fromRangeStart(editor.selection.getRng());BoundaryLocation_readLocation(isInlineTarget,editor.getBody(),pos).bind(function(location){return renderCaretLocation(editor,caret,location)})})}}(isInlineTarget,editor,caret,e.parents))}),caret},setCaretPosition:setCaretPosition};!function(VDirection){VDirection[VDirection.Up=-1]="Up",VDirection[VDirection.Down=1]="Down"}(VDirection=VDirection||{});function walkUntil(direction,isAboveFn,isBeflowFn,root,predicateFn,caretPosition){function add(node){var i,clientRect,clientRects;for(clientRects=getClientRects([node]),-1===direction&&(clientRects=clientRects.reverse()),i=0;i<clientRects.length;i++)if(clientRect=clientRects[i],!isBeflowFn(clientRect,targetClientRect)){if(0<result.length&&isAboveFn(clientRect,ArrUtils.last(result))&&line++,clientRect.line=line,predicateFn(clientRect))return!0;result.push(clientRect)}}var node,targetClientRect,line=0,result=[];return(targetClientRect=ArrUtils.last(caretPosition.getClientRects()))&&(add(node=caretPosition.getNode()),function(direction,root,predicateFn,node){for(;node=findNode(node,direction,isEditableCaretCandidate,root);)if(predicateFn(node))return}(direction,root,add,node)),result}function isAboveLine(lineNumber){return function(clientRect){return function(lineNumber,clientRect){return clientRect.line>lineNumber}(lineNumber,clientRect)}}function isLine(lineNumber){return function(clientRect){return function(lineNumber,clientRect){return clientRect.line===lineNumber}(lineNumber,clientRect)}}function distanceToRectLeft(clientRect,clientX){return Math.abs(clientRect.left-clientX)}function distanceToRectRight(clientRect,clientX){return Math.abs(clientRect.right-clientX)}function isInside(clientX,clientRect){return clientX>=clientRect.left&&clientX<=clientRect.right}function findClosestClientRect(clientRects,clientX){return ArrUtils.reduce(clientRects,function(oldClientRect,clientRect){var oldDistance,newDistance;return oldDistance=Math.min(distanceToRectLeft(oldClientRect,clientX),distanceToRectRight(oldClientRect,clientX)),newDistance=Math.min(distanceToRectLeft(clientRect,clientX),distanceToRectRight(clientRect,clientX)),isInside(clientX,clientRect)?clientRect:isInside(clientX,oldClientRect)?oldClientRect:newDistance===oldDistance&&isContentEditableFalse$7(clientRect.node)?clientRect:newDistance<oldDistance?clientRect:oldClientRect})}function walkUntil$1(direction,root,predicateFn,node){for(;node=findNode$1(node,direction,isEditableCaretCandidate,root);)if(predicateFn(node))return}function findLineNodeRects(root,targetNodeRect){function collect(checkPosFn,node){var lineRects;return lineRects=filter(getClientRects([node]),function(clientRect){return!checkPosFn(clientRect,targetNodeRect)}),clientRects=clientRects.concat(lineRects),0===lineRects.length}var clientRects=[];return clientRects.push(targetNodeRect),walkUntil$1(VDirection.Up,root,curry(collect,isAbove),targetNodeRect.node),walkUntil$1(VDirection.Down,root,curry(collect,isBelow),targetNodeRect.node),clientRects}function closestCaret(root,clientX,clientY){var closestNodeRect,contentEditableFalseNodeRects=getClientRects(function(root){return filter(from$1(root.getElementsByTagName("*")),isFakeCaretTarget)}(root)),targetNodeRects=filter(contentEditableFalseNodeRects,function(rect){return clientY>=rect.top&&clientY<=rect.bottom});return(closestNodeRect=(closestNodeRect=findClosestClientRect(targetNodeRects,clientX))&&findClosestClientRect(findLineNodeRects(root,closestNodeRect),clientX))&&isFakeCaretTarget(closestNodeRect.node)?function(clientRect,clientX){return{node:clientRect.node,before:distanceToRectLeft(clientRect,clientX)<distanceToRectRight(clientRect,clientX)}}(closestNodeRect,clientX):null}function showCaret(direction,editor,node,before,scrollIntoView){return editor._selectionOverrides.showCaret(direction,node,before,scrollIntoView)}function selectNode(editor,node){return editor.fire("BeforeObjectSelected",{target:node}).isDefaultPrevented()?null:function(node){var rng=node.ownerDocument.createRange();return rng.selectNode(node),rng}(node)}function renderCaretAtRange(editor,range,scrollIntoView){var normalizedRange=normalizeRange(1,editor.getBody(),range),caretPosition=CaretPosition$1.fromRangeStart(normalizedRange),caretPositionNode=caretPosition.getNode();if(isContentEditableFalse$8(caretPositionNode))return showCaret(1,editor,caretPositionNode,!caretPosition.isAtEnd(),!1);var caretPositionBeforeNode=caretPosition.getNode(!0);if(isContentEditableFalse$8(caretPositionBeforeNode))return showCaret(1,editor,caretPositionBeforeNode,!1,!1);var ceRoot=editor.dom.getParent(caretPosition.getNode(),function(node){return isContentEditableFalse$8(node)||isContentEditableTrue$3(node)});return isContentEditableFalse$8(ceRoot)?showCaret(1,editor,ceRoot,!1,scrollIntoView):null}function renderRangeCaret(editor,range,scrollIntoView){if(!range||!range.collapsed)return range;var caretRange=renderCaretAtRange(editor,range,scrollIntoView);return caretRange||range}function isChar(forward,predicate,pos){return Option.from(pos.container()).filter(NodeType.isText).exists(function(text){var delta=forward?0:-1;return predicate(text.data.charAt(pos.offset()+delta))})}function isEmptyText(pos){var container=pos.container();return NodeType.isText(container)&&0===container.data.length}function matchesElementPosition(before,predicate){return function(pos){return Option.from(getChildNodeAtRelativeOffset(before?0:-1,pos)).filter(predicate).isSome()}}function isImageBlock(node){return"IMG"===node.nodeName&&"block"===get$4(Element.fromDom(node),"display")}function isCefNode(node){return NodeType.isContentEditableFalse(node)&&!NodeType.isBogusAll(node)}var BreakType,upUntil=curry(walkUntil,VDirection.Up,isAbove,isBelow),downUntil=curry(walkUntil,VDirection.Down,isBelow,isAbove),isContentEditableFalse$7=NodeType.isContentEditableFalse,findNode$1=findNode,isContentEditableTrue$3=NodeType.isContentEditableTrue,isContentEditableFalse$8=NodeType.isContentEditableFalse,isBeforeSpace=curry(isChar,!0,isWhiteSpace$1),isAfterSpace=curry(isChar,!1,isWhiteSpace$1),isBeforeImageBlock=matchesElementPosition(!0,isImageBlock),isAfterImageBlock=matchesElementPosition(!1,isImageBlock),isBeforeTable=matchesElementPosition(!0,NodeType.isTable),isAfterTable=matchesElementPosition(!1,NodeType.isTable),isBeforeContentEditableFalse=matchesElementPosition(!0,isCefNode),isAfterContentEditableFalse=matchesElementPosition(!1,isCefNode);!function(BreakType){BreakType[BreakType.Br=0]="Br",BreakType[BreakType.Block=1]="Block",BreakType[BreakType.Wrap=2]="Wrap",BreakType[BreakType.Eol=3]="Eol"}(BreakType=BreakType||{});function flip(direction,positions){return direction===HDirection.Backwards?reverse(positions):positions}function walk$3(direction,caretWalker,pos){return direction===HDirection.Forwards?caretWalker.next(pos):caretWalker.prev(pos)}function getBreakType(scope,direction,currentPos,nextPos){return NodeType.isBr(nextPos.getNode(direction===HDirection.Forwards))?BreakType.Br:!1===isInSameBlock(currentPos,nextPos)?BreakType.Block:BreakType.Wrap}function getPositionsUntil(predicate,direction,scope,start){for(var nextPos,caretWalker=CaretWalker(scope),currentPos=start,positions=[];currentPos&&(nextPos=walk$3(direction,caretWalker,currentPos));){if(NodeType.isBr(nextPos.getNode(!1)))return direction===HDirection.Forwards?{positions:flip(direction,positions).concat([nextPos]),breakType:BreakType.Br,breakAt:Option.some(nextPos)}:{positions:flip(direction,positions),breakType:BreakType.Br,breakAt:Option.some(nextPos)};if(nextPos.isVisible()){if(predicate(currentPos,nextPos)){var breakType=getBreakType(0,direction,currentPos,nextPos);return{positions:flip(direction,positions),breakType:breakType,breakAt:Option.some(nextPos)}}positions.push(nextPos),currentPos=nextPos}else currentPos=nextPos}return{positions:flip(direction,positions),breakType:BreakType.Eol,breakAt:Option.none()}}function getAdjacentLinePositions(direction,getPositionsUntilBreak,scope,start){return getPositionsUntilBreak(scope,start).breakAt.map(function(pos){var positions=getPositionsUntilBreak(scope,pos).positions;return direction===HDirection.Backwards?positions.concat(pos):[pos].concat(positions)}).getOr([])}function findClosestHorizontalPositionFromPoint(positions,x){return foldl(positions,function(acc,newPos){return acc.fold(function(){return Option.some(newPos)},function(lastPos){return lift2(head(lastPos.getClientRects()),head(newPos.getClientRects()),function(lastRect,newRect){var lastDist=Math.abs(x-lastRect.left);return Math.abs(x-newRect.left)<=lastDist?newPos:lastPos}).or(acc)})},Option.none())}function findClosestHorizontalPosition(positions,pos){return head(pos.getClientRects()).bind(function(targetRect){return findClosestHorizontalPositionFromPoint(positions,targetRect.left)})}function moveToCeFalseHorizontally(direction,editor,getNextPosFn,range){var forwards=direction===HDirection.Forwards,isBeforeContentEditableFalseFn=forwards?isBeforeContentEditableFalse:isAfterContentEditableFalse;if(!range.collapsed){var node=getSelectedNode$1(range);if(isContentEditableFalse$9(node))return showCaret(direction,editor,node,direction===HDirection.Backwards,!0)}var rangeIsInContainerBlock=function(range){return isCaretContainerBlock(range.startContainer)}(range),caretPosition=getNormalizedRangeEndPoint(direction,editor.getBody(),range);if(isBeforeContentEditableFalseFn(caretPosition))return selectNode(editor,caretPosition.getNode(!forwards));var nextCaretPosition=InlineUtils.normalizePosition(forwards,getNextPosFn(caretPosition));if(!nextCaretPosition)return rangeIsInContainerBlock?range:null;if(isBeforeContentEditableFalseFn(nextCaretPosition))return showCaret(direction,editor,nextCaretPosition.getNode(!forwards),forwards,!0);var peekCaretPosition=getNextPosFn(nextCaretPosition);return peekCaretPosition&&isBeforeContentEditableFalseFn(peekCaretPosition)&&isMoveInsideSameBlock(nextCaretPosition,peekCaretPosition)?showCaret(direction,editor,peekCaretPosition.getNode(!forwards),forwards,!0):rangeIsInContainerBlock?renderRangeCaret(editor,nextCaretPosition.toRange(),!0):null}function moveToCeFalseVertically(direction,editor,walkerFn,range){var caretPosition,linePositions,nextLinePositions,closestNextLineRect,caretClientRect,clientX,dist1,dist2,contentEditableFalseNode;if(contentEditableFalseNode=getSelectedNode$1(range),caretPosition=getNormalizedRangeEndPoint(direction,editor.getBody(),range),linePositions=walkerFn(editor.getBody(),isAboveLine(1),caretPosition),nextLinePositions=filter(linePositions,isLine(1)),caretClientRect=ArrUtils.last(caretPosition.getClientRects()),(isBeforeContentEditableFalse(caretPosition)||isBeforeTable(caretPosition))&&(contentEditableFalseNode=caretPosition.getNode()),(isAfterContentEditableFalse(caretPosition)||isAfterTable(caretPosition))&&(contentEditableFalseNode=caretPosition.getNode(!0)),!caretClientRect)return null;if(clientX=caretClientRect.left,(closestNextLineRect=findClosestClientRect(nextLinePositions,clientX))&&isContentEditableFalse$9(closestNextLineRect.node))return dist1=Math.abs(clientX-closestNextLineRect.left),dist2=Math.abs(clientX-closestNextLineRect.right),showCaret(direction,editor,closestNextLineRect.node,dist1<dist2,!0);if(contentEditableFalseNode){var caretPositions=function(direction,root,predicateFn,node){function getClientRect(caretPosition){return ArrUtils.last(caretPosition.getClientRects())}var walkFn,isBelowFn,isAboveFn,caretPosition,clientRect,targetClientRect,caretWalker=CaretWalker(root),result=[],line=0;targetClientRect=getClientRect(caretPosition=1===direction?(walkFn=caretWalker.next,isBelowFn=isBelow,isAboveFn=isAbove,CaretPosition$1.after(node)):(walkFn=caretWalker.prev,isBelowFn=isAbove,isAboveFn=isBelow,CaretPosition$1.before(node)));do{if(caretPosition.isVisible()&&!isAboveFn(clientRect=getClientRect(caretPosition),targetClientRect)){if(0<result.length&&isBelowFn(clientRect,ArrUtils.last(result))&&line++,(clientRect=clone$1(clientRect)).position=caretPosition,clientRect.line=line,predicateFn(clientRect))return result;result.push(clientRect)}}while(caretPosition=walkFn(caretPosition));return result}(direction,editor.getBody(),isAboveLine(1),contentEditableFalseNode);if(closestNextLineRect=findClosestClientRect(filter(caretPositions,isLine(1)),clientX))return renderRangeCaret(editor,closestNextLineRect.position.toRange(),!0);if(closestNextLineRect=ArrUtils.last(filter(caretPositions,isLine(0))))return renderRangeCaret(editor,closestNextLineRect.position.toRange(),!0)}}function exitPreBlock(editor,direction,range){var pre,newBlock,caretWalker=CaretWalker(editor.getBody()),getNextVisualCaretPosition=curry(getVisualCaretPosition,caretWalker.next),getPrevVisualCaretPosition=curry(getVisualCaretPosition,caretWalker.prev);if(range.collapsed&&editor.settings.forced_root_block){if(!(pre=editor.dom.getParent(range.startContainer,"PRE")))return;(1===direction?getNextVisualCaretPosition(CaretPosition$1.fromRangeStart(range)):getPrevVisualCaretPosition(CaretPosition$1.fromRangeStart(range)))||(newBlock=function(editor){var textBlock=editor.dom.create(Settings_getForcedRootBlock(editor));return(!Env.ie||11<=Env.ie)&&(textBlock.innerHTML='<br data-mce-bogus="1">'),textBlock}(editor),1===direction?editor.$(pre).after(newBlock):editor.$(pre).before(newBlock),editor.selection.select(newBlock,!0),editor.selection.collapse())}}function moveH(editor,forward){return function(){var newRng=function(editor,forward){var newRange,caretWalker=CaretWalker(editor.getBody()),getNextVisualCaretPosition=curry(getVisualCaretPosition,caretWalker.next),getPrevVisualCaretPosition=curry(getVisualCaretPosition,caretWalker.prev),direction=forward?HDirection.Forwards:HDirection.Backwards,getNextPosFn=forward?getNextVisualCaretPosition:getPrevVisualCaretPosition,range=editor.selection.getRng();return(newRange=moveToCeFalseHorizontally(direction,editor,getNextPosFn,range))?newRange:(newRange=exitPreBlock(editor,direction,range))||null}(editor,forward);return!!newRng&&(editor.selection.setRng(newRng),!0)}}function moveV(editor,down){return function(){var newRng=function(editor,down){var newRange,direction=down?1:-1,walkerFn=down?downUntil:upUntil,range=editor.selection.getRng();return(newRange=moveToCeFalseVertically(direction,editor,walkerFn,range))?newRange:(newRange=exitPreBlock(editor,direction,range))||null}(editor,down);return!!newRng&&(editor.selection.setRng(newRng),!0)}}function moveToLineEndPoint(editor,forward){return function(){var from=forward?CaretPosition$1.fromRangeEnd(editor.selection.getRng()):CaretPosition$1.fromRangeStart(editor.selection.getRng()),result=forward?getPositionsUntilNextLine(editor.getBody(),from):getPositionsUntilPreviousLine(editor.getBody(),from);return(forward?last(result.positions):head(result.positions)).filter(function(forward){return function(pos){return forward?isAfterContentEditableFalse(pos):isBeforeContentEditableFalse(pos)}}(forward)).fold(constant(!1),function(pos){return editor.selection.setRng(pos.toRange()),!0})}}function getClosestCell(getYAxisValue,isTargetCorner,table,x,y){var cells=descendants$1(Element.fromDom(table),"td,th,caption").map(function(e){return e.dom()});return function(corners,x,y){return foldl(corners,function(acc,newCorner){return acc.fold(function(){return Option.some(newCorner)},function(oldCorner){var oldDist=Math.sqrt(Math.abs(oldCorner.x-x)+Math.abs(oldCorner.y-y)),newDist=Math.sqrt(Math.abs(newCorner.x-x)+Math.abs(newCorner.y-y));return Option.some(newDist<oldDist?newCorner:oldCorner)})},Option.none())}(filter(function(getYAxisValue,tds){return bind(tds,function(td){var rect=function(rect,delta){return{left:rect.left-delta,top:rect.top-delta,right:rect.right+2*delta,bottom:rect.bottom+2*delta,width:rect.width+delta,height:rect.height+delta}}(clone$1(td.getBoundingClientRect()),-1);return[{x:rect.left,y:getYAxisValue(rect),cell:td},{x:rect.right,y:getYAxisValue(rect),cell:td}]})}(getYAxisValue,cells),function(corner){return isTargetCorner(corner,y)}),x,y).map(function(corner){return corner.cell})}function findClosestPositionInAboveCell(table,pos){return head(pos.getClientRects()).bind(function(rect){return getClosestCellAbove(table,rect.left,rect.top)}).bind(function(cell){return findClosestHorizontalPosition(function(scope){return CaretFinder.lastPositionIn(scope).map(function(pos){return getPositionsUntilPreviousLine(scope,pos).positions.concat(pos)}).getOr([])}(cell),pos)})}function findClosestPositionInBelowCell(table,pos){return last(pos.getClientRects()).bind(function(rect){return getClosestCellBelow(table,rect.left,rect.top)}).bind(function(cell){return findClosestHorizontalPosition(function(scope){return CaretFinder.firstPositionIn(scope).map(function(pos){return[pos].concat(getPositionsUntilNextLine(scope,pos).positions)}).getOr([])}(cell),pos)})}function moveToRange(editor,rng){editor.selection.setRng(rng),ScrollIntoView_scrollRangeIntoView(editor,rng)}function isAtTableCellLine(getPositionsUntil,scope,pos){var lineInfo=getPositionsUntil(scope,pos);return function(lineInfo){return lineInfo.breakType===BreakType.Wrap&&0===lineInfo.positions.length}(lineInfo)||!NodeType.isBr(pos.getNode())&&function(lineInfo){return lineInfo.breakType===BreakType.Br&&1===lineInfo.positions.length}(lineInfo)?!function(getPositionsUntil,scope,lineInfo){return lineInfo.breakAt.map(function(breakPos){return getPositionsUntil(scope,breakPos).breakAt.isSome()}).getOr(!1)}(getPositionsUntil,scope,lineInfo):lineInfo.breakAt.isNone()}function navigateHorizontally(editor,forward,table,td){var rng=editor.selection.getRng(),direction=forward?1:-1;if(isFakeCaretTableBrowser()&&function(forward,rng,table){var caretPos=CaretPosition$1.fromRangeStart(rng);return CaretFinder.positionIn(!forward,table).map(function(pos){return pos.isEqual(caretPos)}).getOr(!1)}(forward,rng,table)){var newRng=showCaret(direction,editor,table,!forward,!0);return moveToRange(editor,newRng),!0}return!1}function getTable(previous,pos){var node=pos.getNode(previous);return NodeType.isElement(node)&&"TABLE"===node.nodeName?Option.some(node):Option.none()}function moveCaret(editor,down,pos){var table=getTable(!!down,pos),last=!1===down;table.fold(function(){return moveToRange(editor,pos.toRange())},function(table){return CaretFinder.positionIn(last,editor.getBody()).filter(function(lastPos){return lastPos.isEqual(pos)}).fold(function(){return moveToRange(editor,pos.toRange())},function(_){return function(down,editor,table,pos){var forcedRootBlock=Settings_getForcedRootBlock(editor);forcedRootBlock?editor.undoManager.transact(function(){var element=Element.fromTag(forcedRootBlock);setAll(element,Settings_getForcedRootBlockAttrs(editor)),append(element,Element.fromTag("br")),down?after(Element.fromDom(table),element):before(Element.fromDom(table),element);var rng=editor.dom.createRng();rng.setStart(element.dom(),0),rng.setEnd(element.dom(),0),moveToRange(editor,rng)}):moveToRange(editor,pos.toRange())}(down,editor,table,pos)})})}function navigateVertically(editor,down,table,td){var rng=editor.selection.getRng(),pos=CaretPosition$1.fromRangeStart(rng),root=editor.getBody();if(!down&&isAtFirstTableCellLine(td,pos)){var newPos=function(root,table,start){return findClosestPositionInAboveCell(table,start).orThunk(function(){return head(start.getClientRects()).bind(function(rect){return findClosestHorizontalPositionFromPoint(getPositionsAbove(root,CaretPosition$1.before(table)),rect.left)})}).getOr(CaretPosition$1.before(table))}(root,table,pos);return moveCaret(editor,down,newPos),!0}if(down&&isAtLastTableCellLine(td,pos)){newPos=function(root,table,start){return findClosestPositionInBelowCell(table,start).orThunk(function(){return head(start.getClientRects()).bind(function(rect){return findClosestHorizontalPositionFromPoint(getPositionsBelow(root,CaretPosition$1.after(table)),rect.left)})}).getOr(CaretPosition$1.after(table))}(root,table,pos);return moveCaret(editor,down,newPos),!0}return!1}function moveH$1(editor,forward){return function(){return Option.from(editor.dom.getParent(editor.selection.getNode(),"td,th")).bind(function(td){return Option.from(editor.dom.getParent(td,"table")).map(function(table){return navigateHorizontally(editor,forward,table)})}).getOr(!1)}}function moveV$1(editor,forward){return function(){return Option.from(editor.dom.getParent(editor.selection.getNode(),"td,th")).bind(function(td){return Option.from(editor.dom.getParent(td,"table")).map(function(table){return navigateVertically(editor,forward,table,td)})}).getOr(!1)}}function isTarget(node){return contains(["figcaption"],name(node))}function rangeBefore(target){var rng=domGlobals.document.createRange();return rng.setStartBefore(target.dom()),rng.setEndBefore(target.dom()),rng}function insertElement(root,elm,forward){forward?append(root,elm):prepend(root,elm)}function insertEmptyLine(root,rootBlockName,attrs,forward){return""===rootBlockName?function(root,forward){var br=Element.fromTag("br");return insertElement(root,br,forward),rangeBefore(br)}(root,forward):function(root,forward,blockName,attrs){var block=Element.fromTag(blockName),br=Element.fromTag("br");return setAll(block,attrs),append(block,br),insertElement(root,block,forward),rangeBefore(br)}(root,forward,rootBlockName,attrs)}function isAtFirstOrLastLine(root,forward,pos){return forward?function(scope,pos){return getPositionsUntilNextLine(scope,pos).breakAt.isNone()}(root.dom(),pos):function(scope,pos){return getPositionsUntilPreviousLine(scope,pos).breakAt.isNone()}(root.dom(),pos)}function moveCaretToNewEmptyLine(editor,forward){var root=Element.fromDom(editor.getBody()),pos=CaretPosition$1.fromRangeStart(editor.selection.getRng()),rootBlock=Settings_getForcedRootBlock(editor),rootBlockAttrs=Settings_getForcedRootBlockAttrs(editor);return function(pos,root){var isRoot=curry(eq,root);return closest(Element.fromDom(pos.container()),isBlock,isRoot).filter(isTarget)}(pos,root).exists(function(){if(isAtFirstOrLastLine(root,forward,pos)){var rng=insertEmptyLine(root,rootBlock,rootBlockAttrs,forward);return editor.selection.setRng(rng),!0}return!1})}function moveV$2(editor,forward){return function(){return!!editor.selection.isCollapsed()&&moveCaretToNewEmptyLine(editor,forward)}}function match$1(patterns,evt){return bind(function(patterns){return map(patterns,function(pattern){return __assign({shiftKey:!1,altKey:!1,ctrlKey:!1,metaKey:!1,keyCode:0,action:noop},pattern)})}(patterns),function(pattern){return function(pattern,evt){return evt.keyCode===pattern.keyCode&&evt.shiftKey===pattern.shiftKey&&evt.altKey===pattern.altKey&&evt.ctrlKey===pattern.ctrlKey&&evt.metaKey===pattern.metaKey}(pattern,evt)?[pattern]:[]})}function blockBoundary(from,to){return{from:constant(from),to:constant(to)}}function getBlockPosition(rootNode,pos){var rootElm=Element.fromDom(rootNode),containerElm=Element.fromDom(pos.container());return DeleteUtils_getParentBlock(rootElm,containerElm).map(function(block){return function(block,position){return{block:constant(block),position:constant(position)}}(block,pos)})}function readFromRange(rootNode,forward,rng){var fromBlockPos=getBlockPosition(rootNode,CaretPosition$1.fromRangeStart(rng)),toBlockPos=fromBlockPos.bind(function(blockPos){return CaretFinder.fromPosition(forward,rootNode,blockPos.position()).bind(function(to){return getBlockPosition(rootNode,to).map(function(blockPos){return function(rootNode,forward,blockPosition){return NodeType.isBr(blockPosition.position().getNode())&&!1===Empty_isEmpty(blockPosition.block())?CaretFinder.positionIn(!1,blockPosition.block().dom()).bind(function(lastPositionInBlock){return lastPositionInBlock.isEqual(blockPosition.position())?CaretFinder.fromPosition(forward,rootNode,lastPositionInBlock).bind(function(to){return getBlockPosition(rootNode,to)}):Option.some(blockPosition)}).getOr(blockPosition):blockPosition}(rootNode,forward,blockPos)})})});return lift2(fromBlockPos,toBlockPos,blockBoundary).filter(function(blockBoundary){return function(blockBoundary){return!1===eq(blockBoundary.from().block(),blockBoundary.to().block())}(blockBoundary)&&function(blockBoundary){return parent(blockBoundary.from().block()).bind(function(parent1){return parent(blockBoundary.to().block()).filter(function(parent2){return eq(parent1,parent2)})}).isSome()}(blockBoundary)&&function(blockBoundary){return!1===NodeType.isContentEditableFalse(blockBoundary.from().block().dom())&&!1===NodeType.isContentEditableFalse(blockBoundary.to().block().dom())}(blockBoundary)})}function getChildrenUntilBlockBoundary(block){var children$1=children(block);return findIndex(children$1,isBlock).fold(function(){return children$1},function(index){return children$1.slice(0,index)})}function extractChildren(block){var children=getChildrenUntilBlockBoundary(block);return each(children,remove),children}function removeEmptyRoot(rootNode,block){var parents=Parents_parentsAndSelf(block,rootNode);return find(parents.reverse(),function(element){return Empty_isEmpty(element)}).each(remove)}function nestedBlockMerge(rootNode,fromBlock,toBlock,insertionPoint){if(Empty_isEmpty(toBlock))return PaddingBr_fillWithPaddingBr(toBlock),CaretFinder.firstPositionIn(toBlock.dom());(function(el){return 0===filter(prevSiblings(el),function(el){return!Empty_isEmpty(el)}).length})(insertionPoint)&&Empty_isEmpty(fromBlock)&&before(insertionPoint,Element.fromTag("br"));var position=CaretFinder.prevPosition(toBlock.dom(),CaretPosition$1.before(insertionPoint.dom()));return each(extractChildren(fromBlock),function(child){before(insertionPoint,child)}),removeEmptyRoot(rootNode,fromBlock),position}function sidelongBlockMerge(rootNode,fromBlock,toBlock){if(Empty_isEmpty(toBlock))return remove(toBlock),Empty_isEmpty(fromBlock)&&PaddingBr_fillWithPaddingBr(fromBlock),CaretFinder.firstPositionIn(fromBlock.dom());var position=CaretFinder.lastPositionIn(toBlock.dom());return each(extractChildren(fromBlock),function(child){append(toBlock,child)}),removeEmptyRoot(rootNode,fromBlock),position}function getInsertionPoint(fromBlock,toBlock){return contains$2(toBlock,fromBlock)?function(toBlock,block){var parentsAndSelf=Parents_parentsAndSelf(block,toBlock);return Option.from(parentsAndSelf[parentsAndSelf.length-1])}(toBlock,fromBlock):Option.none()}function trimBr(first,block){CaretFinder.positionIn(first,block.dom()).map(function(position){return position.getNode()}).map(Element.fromDom).filter(isBr$1).each(remove)}function mergeBlockInto(rootNode,fromBlock,toBlock){return trimBr(!0,fromBlock),trimBr(!1,toBlock),getInsertionPoint(fromBlock,toBlock).fold(curry(sidelongBlockMerge,rootNode,fromBlock,toBlock),curry(nestedBlockMerge,rootNode,fromBlock,toBlock))}function isRawNodeInTable(root,rawNode){var node=Element.fromDom(rawNode),isRoot=curry(eq,root);return ancestor(node,isTableCell,isRoot).isSome()}function isEverythingSelected(root,rng){var noPrevious=CaretFinder.prevPosition(root.dom(),CaretPosition$1.fromRangeStart(rng)).isNone(),noNext=CaretFinder.nextPosition(root.dom(),CaretPosition$1.fromRangeEnd(rng)).isNone();return!function(root,rng){return isRawNodeInTable(root,rng.startContainer)||isRawNodeInTable(root,rng.endContainer)}(root,rng)&&noPrevious&&noNext}function deleteRange(editor){var rootNode=Element.fromDom(editor.getBody()),rng=editor.selection.getRng();return isEverythingSelected(rootNode,rng)?function(editor){return editor.setContent(""),editor.selection.setCursorLocation(),!0}(editor):function(rootNode,selection){var rng=selection.getRng();return lift2(DeleteUtils_getParentBlock(rootNode,Element.fromDom(rng.startContainer)),DeleteUtils_getParentBlock(rootNode,Element.fromDom(rng.endContainer)),function(block1,block2){return!1===eq(block1,block2)&&(rng.deleteContents(),MergeBlocks_mergeBlocks(rootNode,!0,block1,block2).each(function(pos){selection.setRng(pos.toRange())}),!0)}).getOr(!1)}(rootNode,editor.selection)}function isBr$5(pos){return getElementFromPosition(pos).exists(isBr$1)}function findBr(forward,root,pos){var parentBlocks=filter(Parents_parentsAndSelf(Element.fromDom(pos.container()),root),isBlock),scope=head(parentBlocks).getOr(root);return CaretFinder.fromPosition(forward,scope.dom(),pos).filter(isBr$5)}function isBeforeBr(root,pos){return getElementFromPosition(pos).exists(isBr$1)||findBr(!0,root,pos).isSome()}function isAfterBr(root,pos){return function(pos){return Option.from(pos.getNode(!0)).map(Element.fromDom)}(pos).exists(isBr$1)||findBr(!1,root,pos).isSome()}function isDeleteFromCefDifferentBlocks(root,forward,from,to){function inSameBlock(elm){return isInline(Element.fromDom(elm))&&!isInSameBlock(from,to,root)}return getRelativeCefElm(!forward,from).fold(function(){return getRelativeCefElm(forward,to).fold(constant(!1),inSameBlock)},inSameBlock)}function deleteEmptyBlockOrMoveToCef(root,forward,from,to){var toCefElm=to.getNode(!1===forward);return DeleteUtils_getParentBlock(Element.fromDom(root),Element.fromDom(from.getNode())).map(function(blockElm){return Empty_isEmpty(blockElm)?DeleteAction.remove(blockElm.dom()):DeleteAction.moveToElement(toCefElm)}).orThunk(function(){return Option.some(DeleteAction.moveToElement(toCefElm))})}function findCefPosition(root,forward,from){return CaretFinder.fromPosition(forward,root,from).bind(function(to){return function(node){return isTableCell(Element.fromDom(node))||isListItem(Element.fromDom(node))}(to.getNode())?Option.none():isDeleteFromCefDifferentBlocks(root,forward,from,to)?Option.none():forward&&NodeType.isContentEditableFalse(to.getNode())?deleteEmptyBlockOrMoveToCef(root,forward,from,to):!1===forward&&NodeType.isContentEditableFalse(to.getNode(!0))?deleteEmptyBlockOrMoveToCef(root,forward,from,to):forward&&isAfterContentEditableFalse(from)?Option.some(DeleteAction.moveToPosition(to)):!1===forward&&isBeforeContentEditableFalse(from)?Option.some(DeleteAction.moveToPosition(to)):Option.none()})}function getContentEditableAction(root,forward,from){return function(forward,from){var elm=from.getNode(!1===forward),caretLocation=forward?"after":"before";return NodeType.isElement(elm)&&elm.getAttribute("data-mce-caret")===caretLocation}(forward,from)?function(forward,elm){return forward&&NodeType.isContentEditableFalse(elm.nextSibling)?Option.some(DeleteAction.moveToElement(elm.nextSibling)):!1===forward&&NodeType.isContentEditableFalse(elm.previousSibling)?Option.some(DeleteAction.moveToElement(elm.previousSibling)):Option.none()}(forward,from.getNode(!1===forward)).fold(function(){return findCefPosition(root,forward,from)},Option.some):findCefPosition(root,forward,from).bind(function(deleteAction){return function(root,from,deleteAction){return deleteAction.fold(function(elm){return Option.some(DeleteAction.remove(elm))},function(elm){return Option.some(DeleteAction.moveToElement(elm))},function(to){return isInSameBlock(from,to,root)?Option.none():Option.some(DeleteAction.moveToPosition(to))})}(root,from,deleteAction)})}function getAncestorCe(editor,node){return Option.from(getContentEditableRoot$1(editor.getBody(),node))}function backspaceDeleteCaret(editor,forward){var selectedNode=editor.selection.getNode();return getAncestorCe(editor,selectedNode).filter(NodeType.isContentEditableFalse).fold(function(){return function(root,forward,rng){var normalizedRange=normalizeRange(forward?1:-1,root,rng),from=CaretPosition$1.fromRangeStart(normalizedRange),rootElement=Element.fromDom(root);return!1===forward&&isAfterContentEditableFalse(from)?Option.some(DeleteAction.remove(from.getNode(!0))):forward&&isBeforeContentEditableFalse(from)?Option.some(DeleteAction.remove(from.getNode())):!1===forward&&isBeforeContentEditableFalse(from)&&isAfterBr(rootElement,from)?findPreviousBr(rootElement,from).map(function(br){return DeleteAction.remove(br.getNode())}):forward&&isAfterContentEditableFalse(from)&&isBeforeBr(rootElement,from)?findNextBr(rootElement,from).map(function(br){return DeleteAction.remove(br.getNode())}):getContentEditableAction(root,forward,from)}(editor.getBody(),forward,editor.selection.getRng()).map(function(deleteAction){return deleteAction.fold(function(editor,forward){return function(element){return editor._selectionOverrides.hideFakeCaret(),DeleteElement_deleteElement(editor,forward,Element.fromDom(element)),!0}}(editor,forward),function(editor,forward){return function(element){var pos=forward?CaretPosition$1.before(element):CaretPosition$1.after(element);return editor.selection.setRng(pos.toRange()),!0}}(editor,forward),function(editor){return function(pos){return editor.selection.setRng(pos.toRange()),!0}}(editor))}).getOr(!1)},function(){return!0})}function backspaceDeleteRange(editor,forward){var selectedNode=editor.selection.getNode();return!!NodeType.isContentEditableFalse(selectedNode)&&getAncestorCe(editor,selectedNode.parentNode).filter(NodeType.isContentEditableFalse).fold(function(){return function(rootElement){each(descendants$1(rootElement,".mce-offscreen-selection"),remove)}(Element.fromDom(editor.getBody())),DeleteElement_deleteElement(editor,forward,Element.fromDom(editor.selection.getNode())),DeleteUtils_paddEmptyBody(editor),!0},function(){return!0})}function deleteContentAndShowCaret(editor,range,node,direction,forward,peekCaretPosition){var caretRange=showCaret(direction,editor,peekCaretPosition.getNode(!forward),forward,!0);if(range.collapsed){var deleteRange=range.cloneRange();forward?deleteRange.setEnd(caretRange.startContainer,caretRange.startOffset):deleteRange.setStart(caretRange.endContainer,caretRange.endOffset),deleteRange.deleteContents()}else range.deleteContents();return editor.selection.setRng(caretRange),function(dom,node){NodeType.isText(node)&&0===node.data.length&&dom.remove(node)}(editor.dom,node),!0}function setCaretLocation(editor,caret){return function(location){return BoundaryCaret_renderCaret(caret,location).map(function(pos){return BoundarySelection.setCaretPosition(editor,pos),!0}).getOr(!1)}}function deleteFromTo(editor,caret,from,to){var rootNode=editor.getBody(),isInlineTarget=curry(InlineUtils.isInlineTarget,editor);editor.undoManager.ignore(function(){editor.selection.setRng(function(from,to){var range=domGlobals.document.createRange();return range.setStart(from.container(),from.offset()),range.setEnd(to.container(),to.offset()),range}(from,to)),editor.execCommand("Delete"),BoundaryLocation_readLocation(isInlineTarget,rootNode,CaretPosition$1.fromRangeStart(editor.selection.getRng())).map(BoundaryLocation_inside).map(setCaretLocation(editor,caret))}),editor.nodeChanged()}function backspaceDeleteCollapsed(editor,caret,forward,from){var rootNode=function(rootNode,node){var parentBlock=getParentBlock(node,rootNode);return parentBlock||rootNode}(editor.getBody(),from.container()),isInlineTarget=curry(InlineUtils.isInlineTarget,editor),fromLocation=BoundaryLocation_readLocation(isInlineTarget,rootNode,from);return fromLocation.bind(function(location){return forward?location.fold(constant(Option.some(BoundaryLocation_inside(location))),Option.none,constant(Option.some(BoundaryLocation_outside(location))),Option.none):location.fold(Option.none,constant(Option.some(BoundaryLocation_outside(location))),Option.none,constant(Option.some(BoundaryLocation_inside(location))))}).map(setCaretLocation(editor,caret)).getOrThunk(function(){var toPosition=CaretFinder.navigate(forward,rootNode,from),toLocation=toPosition.bind(function(pos){return BoundaryLocation_readLocation(isInlineTarget,rootNode,pos)});return fromLocation.isSome()&&toLocation.isSome()?InlineUtils.findRootInline(isInlineTarget,rootNode,from).map(function(elm){return!!function(elm){return lift2(CaretFinder.firstPositionIn(elm),CaretFinder.lastPositionIn(elm),function(firstPos,lastPos){var normalizedFirstPos=InlineUtils.normalizePosition(!0,firstPos),normalizedLastPos=InlineUtils.normalizePosition(!1,lastPos);return CaretFinder.nextPosition(elm,normalizedFirstPos).map(function(pos){return pos.isEqual(normalizedLastPos)}).getOr(!0)}).getOr(!0)}(elm)&&(DeleteElement_deleteElement(editor,forward,Element.fromDom(elm)),!0)}).getOr(!1):toLocation.bind(function(_){return toPosition.map(function(to){return forward?deleteFromTo(editor,caret,from,to):deleteFromTo(editor,caret,to,from),!0})}).getOr(!1)})}function hasOnlyOneChild(elm){return 1===children(elm).length}function deleteLastPosition(forward,editor,target,parentInlines){var isFormatElement$1=curry(isFormatElement,editor),formatNodes=map(filter(parentInlines,isFormatElement$1),function(elm){return elm.dom()});if(0===formatNodes.length)DeleteElement_deleteElement(editor,forward,target);else{var pos=function(targetNode,formatNodes){var caretContainer=createCaretContainer(!1),innerMost=insertFormatNodesIntoCaretContainer(formatNodes,caretContainer.dom());return before(Element.fromDom(targetNode),caretContainer),remove(Element.fromDom(targetNode)),CaretPosition$1(innerMost,0)}(target.dom(),formatNodes);editor.selection.setRng(pos.toRange())}}function deleteCaret(editor,forward){var rootElm=Element.fromDom(editor.getBody()),startElm=Element.fromDom(editor.selection.getStart()),parentInlines=filter(function(rootElm,startElm){var parents=Parents_parentsAndSelf(startElm,rootElm);return findIndex(parents,isBlock).fold(constant(parents),function(index){return parents.slice(0,index)})}(rootElm,startElm),hasOnlyOneChild);return last(parentInlines).map(function(target){var fromPos=CaretPosition$1.fromRangeStart(editor.selection.getRng());return!(!DeleteUtils_willDeleteLastPositionInElement(forward,fromPos,target.dom())||function(element){return isCaretNode(element.dom())&&isCaretContainerEmpty(element.dom())}(target))&&(deleteLastPosition(forward,editor,target,parentInlines),!0)}).getOr(!1)}function tableCellRng(start,end){return{start:constant(start),end:constant(end)}}function getClosestCell$1(container,isRoot){return closest$1(Element.fromDom(container),"td,th",isRoot)}function getClosestTable(cell,isRoot){return ancestor$1(cell,"table",isRoot)}function isExpandedCellRng(cellRng){return!1===eq(cellRng.start(),cellRng.end())}function getTableFromCellRng(cellRng,isRoot){return getClosestTable(cellRng.start(),isRoot).bind(function(startParentTable){return getClosestTable(cellRng.end(),isRoot).bind(function(endParentTable){return function(b,a){return b?Option.some(a):Option.none()}(eq(startParentTable,endParentTable),startParentTable)})})}function getTableCells(table){return descendants$1(table,"td,th")}function partialSelection(isRoot,rng){var startCell=getClosestCell$1(rng.startContainer,isRoot),endCell=getClosestCell$1(rng.endContainer,isRoot);return rng.collapsed?Option.none():lift2(startCell,endCell,tableCellRng).fold(function(){return startCell.fold(function(){return endCell.bind(function(endCell){return getClosestTable(endCell,isRoot).bind(function(table){return head(getTableCells(table)).map(function(startCell){return tableCellRng(startCell,endCell)})})})},function(startCell){return getClosestTable(startCell,isRoot).bind(function(table){return last(getTableCells(table)).map(function(endCell){return tableCellRng(startCell,endCell)})})})},function(cellRng){return isWithinSameTable(isRoot,cellRng)?Option.none():function(cellRng,isRoot){return getClosestTable(cellRng.start(),isRoot).bind(function(table){return last(getTableCells(table)).map(function(endCell){return tableCellRng(cellRng.start(),endCell)})})}(cellRng,isRoot)})}function getTableSelectionFromCellRng(cellRng,isRoot){return getTableFromCellRng(cellRng,isRoot).map(function(table){return function(rng,table,cells){return{rng:constant(rng),table:constant(table),cells:constant(cells)}}(cellRng,table,getTableCells(table))})}function getTableSelectionFromRng(root,rng){var isRoot=function(root){return function(cur){return eq(root,cur)}}(root);return function(rng,isRoot){var startCell=getClosestCell$1(rng.startContainer,isRoot),endCell=getClosestCell$1(rng.endContainer,isRoot);return lift2(startCell,endCell,tableCellRng).filter(isExpandedCellRng).filter(function(cellRng){return isWithinSameTable(isRoot,cellRng)}).orThunk(function(){return partialSelection(isRoot,rng)})}(rng,isRoot).bind(function(cellRng){return getTableSelectionFromCellRng(cellRng,isRoot)})}function getCellIndex(cells,cell){return findIndex(cells,function(x){return eq(x,cell)})}function getAction(tableSelection){return function(tableSelection){return lift2(getCellIndex(tableSelection.cells(),tableSelection.rng().start()),getCellIndex(tableSelection.cells(),tableSelection.rng().end()),function(startIndex,endIndex){return tableSelection.cells().slice(startIndex,endIndex+1)})}(tableSelection).map(function(selected){var cells=tableSelection.cells();return selected.length===cells.length?deleteAction.removeTable(tableSelection.table()):deleteAction.emptyCells(selected)})}function emptyCells(editor,cells){return each(cells,PaddingBr_fillWithPaddingBr),editor.selection.setCursorLocation(cells[0].dom(),0),!0}function deleteTableElement(editor,table){return DeleteElement_deleteElement(editor,!1,table),!0}function deleteCellRange(editor,rootElm,rng){return function(root,rng){return getTableSelectionFromRng(root,rng).bind(getAction)}(rootElm,rng).map(function(action){return action.fold(curry(deleteTableElement,editor),curry(emptyCells,editor))})}function deleteTableRange(editor,rootElm,rng,startElm){return getParentCaption(rootElm,startElm).fold(function(){return deleteCellRange(editor,rootElm,rng)},function(caption){return function(editor,caption){return emptyElement(editor,caption)}(editor,caption)}).getOr(!1)}function getParentCell(rootElm,elm){return find(Parents_parentsAndSelf(elm,rootElm),isTableCell)}function deleteCaretInsideCaption(editor,rootElm,forward,fromCaption,from){return CaretFinder.navigate(forward,editor.getBody(),from).bind(function(to){return function(fromCaption,forward,from,to){return CaretFinder.firstPositionIn(fromCaption.dom()).bind(function(first){return CaretFinder.lastPositionIn(fromCaption.dom()).map(function(last){return forward?from.isEqual(first)&&to.isEqual(last):from.isEqual(last)&&to.isEqual(first)})}).getOr(!0)}(fromCaption,forward,from,to)?function(editor,elm){return emptyElement(editor,elm)}(editor,fromCaption):function(rootElm,fromCaption,to){return getParentCaption(rootElm,Element.fromDom(to.getNode())).map(function(toCaption){return!1===eq(toCaption,fromCaption)})}(rootElm,fromCaption,to)}).or(Option.some(!0))}function deleteCaretCells(editor,forward,rootElm,startElm){var from=CaretPosition$1.fromRangeStart(editor.selection.getRng());return getParentCell(rootElm,startElm).bind(function(fromCell){return Empty_isEmpty(fromCell)?emptyElement(editor,fromCell):function(editor,rootElm,forward,fromCell,from){return CaretFinder.navigate(forward,editor.getBody(),from).bind(function(to){return getParentCell(rootElm,Element.fromDom(to.getNode())).map(function(toCell){return!1===eq(toCell,fromCell)})})}(editor,rootElm,forward,fromCell,from)}).getOr(!1)}function isNearTable(forward,pos){return forward?isBeforeTable(pos):isAfterTable(pos)}function deleteCaret$1(editor,forward,startElm){var rootElm=Element.fromDom(editor.getBody());return getParentCaption(rootElm,startElm).fold(function(){return deleteCaretCells(editor,forward,rootElm,startElm)||function(editor,forward){var fromPos=CaretPosition$1.fromRangeStart(editor.selection.getRng());return isNearTable(forward,fromPos)||CaretFinder.fromPosition(forward,editor.getBody(),fromPos).map(function(pos){return isNearTable(forward,pos)}).getOr(!1)}(editor,forward)},function(fromCaption){return function(editor,forward,rootElm,fromCaption){var from=CaretPosition$1.fromRangeStart(editor.selection.getRng());return Empty_isEmpty(fromCaption)?emptyElement(editor,fromCaption):deleteCaretInsideCaption(editor,rootElm,forward,fromCaption,from)}(editor,forward,rootElm,fromCaption).getOr(!1)})}function parseIndentValue(value){var number=parseInt(value,10);return isNaN(number)?0:number}function getIndentStyleName(useMargin,element){return(useMargin||function(node){return"table"===name(node)}(element)?"margin":"padding")+("rtl"===get$4(element,"direction")?"-right":"-left")}function canOutdent(editor){var blocks=getBlocksToIndent(editor);return!editor.mode.isReadOnly()&&(1<blocks.length||function(editor,blocks){return forall(blocks,function(block){var indentStyleName=getIndentStyleName(Settings_shouldIndentUseMargin(editor),block),intentValue=getRaw(block,indentStyleName).map(parseIndentValue).getOr(0);return"false"!==editor.dom.getContentEditable(block.dom())&&0<intentValue})}(editor,blocks))}function isListComponent(el){return isList(el)||isListItem(el)}function handle(editor,command){var dom=editor.dom,selection=editor.selection,formatter=editor.formatter,indentation=Settings_getIndentation(editor),indentUnit=/[a-z%]+$/i.exec(indentation)[0],indentValue=parseInt(indentation,10),useMargin=Settings_shouldIndentUseMargin(editor),forcedRootBlock=Settings_getForcedRootBlock(editor);editor.queryCommandState("InsertUnorderedList")||editor.queryCommandState("InsertOrderedList")||""!==forcedRootBlock||dom.getParent(selection.getNode(),dom.isBlock)||formatter.apply("div"),each(getBlocksToIndent(editor),function(block){!function(dom,command,useMargin,value,unit,element){var indentStyleName=getIndentStyleName(useMargin,Element.fromDom(element));if("outdent"===command){var styleValue=Math.max(0,parseIndentValue(element.style[indentStyleName])-value);dom.setStyle(element,indentStyleName,styleValue?styleValue+unit:"")}else{styleValue=parseIndentValue(element.style[indentStyleName])+value+unit;dom.setStyle(element,indentStyleName,styleValue)}}(dom,command,useMargin,indentValue,indentUnit,block.dom())})}function navigateIgnoreEmptyTextNodes(forward,root,from){return CaretFinder.navigateIgnore(forward,root,from,isEmptyText)}function getClosestBlock(root,pos){return find(Parents_parentsAndSelf(Element.fromDom(pos.container()),root),isBlock)}function isAtBeforeAfterBlockBoundary(forward,root,pos){return navigateIgnoreEmptyTextNodes(forward,root.dom(),pos).forall(function(newPos){return getClosestBlock(root,pos).fold(function(){return!1===isInSameBlock(newPos,pos,root.dom())},function(fromBlock){return!1===isInSameBlock(newPos,pos,root.dom())&&contains$2(fromBlock,Element.fromDom(newPos.container()))})})}function isAtBlockBoundary(forward,root,pos){return getClosestBlock(root,pos).fold(function(){return navigateIgnoreEmptyTextNodes(forward,root.dom(),pos).forall(function(newPos){return!1===isInSameBlock(newPos,pos,root.dom())})},function(parent){return navigateIgnoreEmptyTextNodes(forward,parent.dom(),pos).isNone()})}function getParentBlock$2(editor){return Option.from(editor.dom.getParent(editor.selection.getStart(!0),editor.dom.isBlock))}function hasParent$1(elm,parentName){return elm&&elm.parentNode&&elm.parentNode.nodeName===parentName}function isListBlock(elm){return elm&&/^(OL|UL|LI)$/.test(elm.nodeName)}function getContainerBlock(containerBlock){var containerBlockParent=containerBlock.parentNode;return/^(LI|DT|DD)$/.test(containerBlockParent.nodeName)?containerBlockParent:containerBlock}function isFirstOrLastLi(containerBlock,parentBlock,first){for(var node=containerBlock[first?"firstChild":"lastChild"];node&&!NodeType.isElement(node);)node=node[first?"nextSibling":"previousSibling"];return node===parentBlock}function isEmptyAnchor(dom,elm){return elm&&"A"===elm.nodeName&&dom.isEmpty(elm)}function emptyBlock(elm){elm.innerHTML='<br data-mce-bogus="1">'}function containerAndSiblingName(container,nodeName){return container.nodeName===nodeName||container.previousSibling&&container.previousSibling.nodeName===nodeName}function canSplitBlock(dom,node){return node&&dom.isBlock(node)&&!/^(TD|TH|CAPTION|FORM)$/.test(node.nodeName)&&!/^(fixed|absolute)/i.test(node.style.position)&&"true"!==dom.getContentEditable(node)}function normalizeZwspOffset(start,container,offset){return!1===NodeType.isText(container)?offset:start?1===offset&&container.data.charAt(offset-1)===Zwsp.ZWSP?0:offset:offset===container.data.length-1&&container.data.charAt(offset)===Zwsp.ZWSP?container.data.length:offset}function getEditableRoot$1(dom,node){var parent,editableRoot,root=dom.getRoot();for(parent=node;parent!==root&&"false"!==dom.getContentEditable(parent);)"true"===dom.getContentEditable(parent)&&(editableRoot=parent),parent=parent.parentNode;return parent!==root?editableRoot:root}function applyAttributes(editor,node,forcedRootBlockAttrs){Option.from(forcedRootBlockAttrs.style).map(editor.dom.parseStyle).each(function(attrStyles){var currentStyles=function(element){var css={},dom=element.dom();if(isSupported(dom))for(var i=0;i<dom.style.length;i++){var ruleName=dom.style.item(i);css[ruleName]=dom.style[ruleName]}return css}(Element.fromDom(node)),newStyles=__assign(__assign({},currentStyles),attrStyles);editor.dom.setStyles(node,newStyles)});var attrClassesOpt=Option.from(forcedRootBlockAttrs.class).map(function(attrClasses){return attrClasses.split(/\s+/)}),currentClassesOpt=Option.from(node.className).map(function(currentClasses){return filter(currentClasses.split(/\s+/),function(clazz){return""!==clazz})});lift2(attrClassesOpt,currentClassesOpt,function(attrClasses,currentClasses){var filteredClasses=filter(currentClasses,function(clazz){return!contains(attrClasses,clazz)}),newClasses=function(){for(var s=0,i=0,il=arguments.length;i<il;i++)s+=arguments[i].length;var r=Array(s),k=0;for(i=0;i<il;i++)for(var a=arguments[i],j=0,jl=a.length;j<jl;j++,k++)r[k]=a[j];return r}(attrClasses,filteredClasses);editor.dom.setAttrib(node,"class",newClasses.join(" "))});var appliedAttrs=["style","class"],remainingAttrs=function(obj,pred){var t={};return internalFilter(obj,pred,objAcc(t),noop),t}(forcedRootBlockAttrs,function(_,attrs){return!contains(appliedAttrs,attrs)});editor.dom.setAttribs(node,remainingAttrs)}function setForcedBlockAttrs(editor,node){var forcedRootBlockName=Settings_getForcedRootBlock(editor);if(forcedRootBlockName&&forcedRootBlockName.toLowerCase()===node.tagName.toLowerCase()){var forcedRootBlockAttrs=Settings_getForcedRootBlockAttrs(editor);applyAttributes(editor,node,forcedRootBlockAttrs)}}function scrollToBr(dom,selection,brElm){var marker=dom.create("span",{},"&nbsp;");brElm.parentNode.insertBefore(marker,brElm),selection.scrollIntoView(marker),dom.remove(marker)}function moveSelectionToBr(dom,selection,brElm,extraBr){var rng=dom.createRng();extraBr?(rng.setStartBefore(brElm),rng.setEndBefore(brElm)):(rng.setStartAfter(brElm),rng.setEndAfter(brElm)),selection.setRng(rng)}function insertBrAtCaret(editor,evt){var brElm,extraBr,selection=editor.selection,dom=editor.dom,rng=selection.getRng();NormalizeRange_normalize(dom,rng).each(function(normRng){rng.setStart(normRng.startContainer,normRng.startOffset),rng.setEnd(normRng.endContainer,normRng.endOffset)});var offset=rng.startOffset,container=rng.startContainer;if(1===container.nodeType&&container.hasChildNodes()){var isAfterLastNodeInContainer=offset>container.childNodes.length-1;container=container.childNodes[Math.min(offset,container.childNodes.length-1)]||container,offset=isAfterLastNodeInContainer&&3===container.nodeType?container.nodeValue.length:0}var parentBlock=dom.getParent(container,dom.isBlock),containerBlock=parentBlock?dom.getParent(parentBlock.parentNode,dom.isBlock):null,containerBlockName=containerBlock?containerBlock.nodeName.toUpperCase():"",isControlKey=!(!evt||!evt.ctrlKey);"LI"!==containerBlockName||isControlKey||(parentBlock=containerBlock),container&&3===container.nodeType&&offset>=container.nodeValue.length&&!function(schema,container,parentBlock){for(var node,walker=new TreeWalker(container,parentBlock),nonEmptyElementsMap=schema.getNonEmptyElements();node=walker.next();)if(nonEmptyElementsMap[node.nodeName.toLowerCase()]||0<node.length)return!0}(editor.schema,container,parentBlock)&&(brElm=dom.create("br"),rng.insertNode(brElm),rng.setStartAfter(brElm),rng.setEndAfter(brElm),extraBr=!0),brElm=dom.create("br"),rangeInsertNode(dom,rng,brElm),scrollToBr(dom,selection,brElm),moveSelectionToBr(dom,selection,brElm,extraBr),editor.undoManager.add()}function insertBrBefore(editor,inline){var br=Element.fromTag("br");before(Element.fromDom(inline),br),editor.undoManager.add()}function insertBrAfter(editor,inline){hasBrAfter(editor.getBody(),inline)||after(Element.fromDom(inline),Element.fromTag("br"));var br=Element.fromTag("br");after(Element.fromDom(inline),br),scrollToBr(editor.dom,editor.selection,br.dom()),moveSelectionToBr(editor.dom,editor.selection,br.dom(),!1),editor.undoManager.add()}function isAnchorLink(elm){return elm&&"A"===elm.nodeName&&"href"in elm}function isInsideAnchor(location){return location.fold(constant(!1),isAnchorLink,isAnchorLink,constant(!1))}function insertBrOutsideAnchor(editor,location){location.fold(noop,curry(insertBrBefore,editor),curry(insertBrAfter,editor),noop)}function matchesSelector(editor,selector){return NewLineUtils_getParentBlock(editor).filter(function(parentBlock){return 0<selector.length&&is(Element.fromDom(parentBlock),selector)}).isSome()}function shouldBlockNewLine$1(editor,shiftKey){return ContextSelectors_shouldBlockNewLine(editor)}function isBrMode(requiredState){return function(editor,shiftKey){return""===Settings_getForcedRootBlock(editor)===requiredState}}function inListBlock(requiredState){return function(editor,shiftKey){return NewLineUtils_isListItemParentBlock(editor)===requiredState}}function inBlock(blockName,requiredState){return function(editor,shiftKey){return NewLineUtils_getParentBlockName(editor)===blockName.toUpperCase()===requiredState}}function inPreBlock(requiredState){return inBlock("pre",requiredState)}function shouldPutBrInPre$1(requiredState){return function(editor,shiftKey){return Settings_shouldPutBrInPre(editor)===requiredState}}function inBrContext(editor,shiftKey){return ContextSelectors_shouldInsertBr(editor)}function hasShiftKey(editor,shiftKey){return shiftKey}function canInsertIntoEditableRoot(editor){var forcedRootBlock=Settings_getForcedRootBlock(editor),rootEditable=NewLineUtils_getEditableRoot(editor.dom,editor.selection.getStart());return rootEditable&&editor.schema.isValidChild(rootEditable.nodeName,forcedRootBlock||"P")}function match$2(predicates,action){return function(editor,shiftKey){return foldl(predicates,function(res,p){return res&&p(editor,shiftKey)},!0)?Option.some(action):Option.none()}}function insertTextAtPosition(text,pos){var container=pos.container(),offset=pos.offset();return NodeType.isText(container)?(container.insertData(offset,text),Option.some(CaretPosition(container,offset+text.length))):getElementFromPosition(pos).map(function(elm){var textNode=Element.fromText(text);return pos.isAtEnd()?after(elm,textNode):before(elm,textNode),CaretPosition(textNode.dom(),text.length)})}function isInMiddleOfText(pos){return CaretPosition.isTextPosition(pos)&&!pos.isAtStart()&&!pos.isAtEnd()}function getClosestBlock$1(root,pos){var parentBlocks=filter(Parents_parentsAndSelf(Element.fromDom(pos.container()),root),isBlock);return head(parentBlocks).getOr(root)}function hasSpaceBefore(root,pos){return isInMiddleOfText(pos)?isAfterSpace(pos):isAfterSpace(pos)||CaretFinder.prevPosition(getClosestBlock$1(root,pos).dom(),pos).exists(isAfterSpace)}function hasSpaceAfter(root,pos){return isInMiddleOfText(pos)?isBeforeSpace(pos):isBeforeSpace(pos)||CaretFinder.nextPosition(getClosestBlock$1(root,pos).dom(),pos).exists(isBeforeSpace)}function isInPre(pos){return getElementFromPosition(pos).bind(function(elm){return closest(elm,isElement)}).exists(function(elm){return function(value){return contains(["pre","pre-wrap"],value)}(get$4(elm,"white-space"))})}function isAtLineBoundary(root,pos){return function(root,pos){return CaretFinder.prevPosition(root.dom(),pos).isNone()}(root,pos)||function(root,pos){return CaretFinder.nextPosition(root.dom(),pos).isNone()}(root,pos)||isAtStartOfBlock(root,pos)||isAtEndOfBlock(root,pos)||isAfterBr(root,pos)||isBeforeBr(root,pos)}function needsToBeNbspRight(root,pos){var afterPos=function(pos){var container=pos.container(),offset=pos.offset();return NodeType.isText(container)&&offset<container.data.length?CaretPosition(container,offset+1):pos}(pos);return!isInPre(afterPos)&&(isAtEndOfBlock(root,afterPos)||isAfterBlock(root,afterPos)||isBeforeBr(root,afterPos)||hasSpaceAfter(root,afterPos))}function needsToBeNbsp(root,pos){return function(root,pos){return!isInPre(pos)&&(isAtStartOfBlock(root,pos)||isBeforeBlock(root,pos)||isAfterBr(root,pos)||hasSpaceBefore(root,pos))}(root,pos)||needsToBeNbspRight(root,pos)}function isNbspAt(text,offset){return isNbsp(text.charAt(offset))}function hasNbsp(pos){var container=pos.container();return NodeType.isText(container)&&contains$1(container.data,"")}function normalizeNbspInMiddleOfTextNode(node){var text=node.data,newText=function(text){var chars=text.split("");return map(chars,function(chr,i){return isNbsp(chr)&&0<i&&i<chars.length-1&&isContent(chars[i-1])&&isContent(chars[i+1])?" ":chr}).join("")}(text);return newText!==text&&(node.data=newText,!0)}function normalizeNbsps(root,pos){return Option.some(pos).filter(hasNbsp).bind(function(pos){var container=pos.container();return function(root,node){var text=node.data,firstPos=CaretPosition(node,0);return!(!isNbspAt(text,0)||needsToBeNbsp(root,firstPos))&&(node.data=" "+text.slice(1),!0)}(root,container)||normalizeNbspInMiddleOfTextNode(container)||function(root,node){var text=node.data,lastPos=CaretPosition(node,text.length-1);return!(!isNbspAt(text,text.length-1)||needsToBeNbsp(root,lastPos))&&(node.data=text.slice(0,-1)+" ",!0)}(root,container)?Option.some(pos):Option.none()})}function normalizeNbspsInEditor(editor){var root=Element.fromDom(editor.getBody());editor.selection.isCollapsed()&&normalizeNbsps(root,CaretPosition.fromRangeStart(editor.selection.getRng())).each(function(pos){editor.selection.setRng(pos.toRange())})}function insertInlineBoundarySpaceOrNbsp(root,pos){return function(checkPos){return function(root,pos){return!isInPre(pos)&&(isAtLineBoundary(root,pos)||hasSpaceBefore(root,pos)||hasSpaceAfter(root,pos))}(root,checkPos)?insertNbspAtPosition(pos):insertSpaceAtPosition(pos)}}function insertSpaceOrNbspAtSelection(editor){var pos=CaretPosition$1.fromRangeStart(editor.selection.getRng()),root=Element.fromDom(editor.getBody());if(editor.selection.isCollapsed()){var isInlineTarget=curry(InlineUtils.isInlineTarget,editor),caretPosition=CaretPosition$1.fromRangeStart(editor.selection.getRng());return BoundaryLocation_readLocation(isInlineTarget,editor.getBody(),caretPosition).bind(function(root){return function(location){return location.fold(function(element){return CaretFinder.prevPosition(root.dom(),CaretPosition$1.before(element))},function(element){return CaretFinder.firstPositionIn(element)},function(element){return CaretFinder.lastPositionIn(element)},function(element){return CaretFinder.nextPosition(root.dom(),CaretPosition$1.after(element))})}}(root)).bind(insertInlineBoundarySpaceOrNbsp(root,pos)).exists(function(editor){return function(pos){return editor.selection.setRng(pos.toRange()),editor.nodeChanged(),!0}}(editor))}return!1}function showBlockCaretContainer(editor,blockCaretContainer){blockCaretContainer.hasAttribute("data-mce-caret")&&(showCaretContainerBlock(blockCaretContainer),function(editor){editor.selection.setRng(editor.selection.getRng())}(editor),editor.selection.scrollIntoView(blockCaretContainer))}function handleBlockContainer(editor,e){var blockCaretContainer=function(editor){return descendant(Element.fromDom(editor.getBody()),"*[data-mce-caret]").fold(constant(null),function(elm){return elm.dom()})}(editor);if(blockCaretContainer)return"compositionstart"===e.type?(e.preventDefault(),e.stopPropagation(),void showBlockCaretContainer(editor,blockCaretContainer)):void(hasContent(blockCaretContainer)&&(showBlockCaretContainer(editor,blockCaretContainer),editor.undoManager.add()))}function setup$e(editor){!function(editor){var keypressThrotter=first(function(){editor.composing||normalizeNbspsInEditor(editor)},0);browser$5.isIE()&&(editor.on("keypress",function(e){keypressThrotter.throttle()}),editor.on("remove",function(e){keypressThrotter.cancel()}))}(editor),editor.on("input",function(e){!1===e.isComposing&&normalizeNbspsInEditor(editor)})}function setup$h(editor){!function(editor){editor.on("click",function(e){editor.dom.getParent(e.target,"details")&&e.preventDefault()})}(editor),function(editor){editor.parser.addNodeFilter("details",function(elms){each(elms,function(details){details.attr("data-mce-open",details.attr("open")),details.attr("open","open")})}),editor.serializer.addNodeFilter("details",function(elms){each(elms,function(details){var open=details.attr("data-mce-open");details.attr("open",isString(open)?open:null),details.attr("data-mce-open",null)})})}(editor)}function isTextBlockNode(node){return NodeType.isElement(node)&&isTextBlock(Element.fromDom(node))}function setup$i(editor){editor.on("click",function(e){3<=e.detail&&function(editor){var rng=editor.selection.getRng(),startPos=CaretPosition.fromRangeStart(rng),endPos=CaretPosition.fromRangeEnd(rng);if(CaretPosition.isElementPosition(startPos)){var container=startPos.container();isTextBlockNode(container)&&CaretFinder.firstPositionIn(container).each(function(pos){return rng.setStart(pos.container(),pos.offset())})}if(CaretPosition.isElementPosition(endPos)){container=startPos.container();isTextBlockNode(container)&&CaretFinder.lastPositionIn(container).each(function(pos){return rng.setEnd(pos.container(),pos.offset())})}editor.selection.setRng(RangeNormalizer_normalize(rng))}(editor)})}function getAbsolutePosition(elm){var doc,docElem,win,clientRect;return clientRect=elm.getBoundingClientRect(),docElem=(doc=elm.ownerDocument).documentElement,win=doc.defaultView,{top:clientRect.top+win.pageYOffset-docElem.clientTop,left:clientRect.left+win.pageXOffset-docElem.clientLeft}}function removeElement(elm){elm&&elm.parentNode&&elm.parentNode.removeChild(elm)}function start$1(state,editor){return function(e){if(function(e){return 0===e.button}(e)){var ceElm=find(editor.dom.getParents(e.target),Predicate_or(isContentEditableFalse$a,isContentEditableTrue$4)).getOr(null);if(function(rootElm,elm){return isContentEditableFalse$a(elm)&&elm!==rootElm}(editor.getBody(),ceElm)){var elmPos=editor.dom.getPos(ceElm),bodyElm=editor.getBody(),docElm=editor.getDoc().documentElement;state.element=ceElm,state.screenX=e.screenX,state.screenY=e.screenY,state.maxX=(editor.inline?bodyElm.scrollWidth:docElm.offsetWidth)-2,state.maxY=(editor.inline?bodyElm.scrollHeight:docElm.offsetHeight)-2,state.relX=e.pageX-elmPos.x,state.relY=e.pageY-elmPos.y,state.width=ceElm.offsetWidth,state.height=ceElm.offsetHeight,state.ghost=function(editor,elm,width,height){var clonedElm=elm.cloneNode(!0);editor.dom.setStyles(clonedElm,{width:width,height:height}),editor.dom.setAttrib(clonedElm,"data-mce-selected",null);var ghostElm=editor.dom.create("div",{class:"mce-drag-container","data-mce-bogus":"all",unselectable:"on",contenteditable:"false"});return editor.dom.setStyles(ghostElm,{position:"absolute",opacity:.5,overflow:"hidden",border:0,padding:0,margin:0,width:width,height:height}),editor.dom.setStyles(clonedElm,{margin:0,boxSizing:"border-box"}),ghostElm.appendChild(clonedElm),ghostElm}(editor,ceElm,state.width,state.height)}}}}function drop(state,editor){return function(e){if(state.dragging&&function(editor,targetElement,dragElement){return targetElement!==dragElement&&!editor.dom.isChildOf(targetElement,dragElement)&&!isContentEditableFalse$a(targetElement)}(editor,function(selection){var startContainer=selection.getSel().getRangeAt(0).startContainer;return 3===startContainer.nodeType?startContainer.parentNode:startContainer}(editor.selection),state.element)){var targetClone_1=function(elm){var cloneElm=elm.cloneNode(!0);return cloneElm.removeAttribute("data-mce-selected"),cloneElm}(state.element),args=editor.fire("drop",{targetClone:targetClone_1,clientX:e.clientX,clientY:e.clientY});args.isDefaultPrevented()||(targetClone_1=args.targetClone,editor.undoManager.transact(function(){removeElement(state.element),editor.insertContent(editor.dom.getOuterHTML(targetClone_1)),editor._selectionOverrides.hideFakeCaret()}))}removeDragState(state)}}function bindFakeDragEvents(editor){var pageDom,dragStartHandler,dragHandler,dropHandler,dragEndHandler,rootDocument,state={};pageDom=DOMUtils$1.DOM,rootDocument=domGlobals.document,dragStartHandler=start$1(state,editor),dragHandler=function(state,editor){var throttledPlaceCaretAt=Delay.throttle(function(clientX,clientY){editor._selectionOverrides.hideFakeCaret(),editor.selection.placeCaretAt(clientX,clientY)},0);return function(e){var movement=Math.max(Math.abs(e.screenX-state.screenX),Math.abs(e.screenY-state.screenY));if(function(state){return state.element}(state)&&!state.dragging&&10<movement){if(editor.fire("dragstart",{target:state.element}).isDefaultPrevented())return;state.dragging=!0,editor.focus()}if(state.dragging){var targetPos=function(state,position){return{pageX:position.pageX-state.relX,pageY:position.pageY+5}}(state,MousePosition_calc(editor,e));!function(ghostElm,bodyElm){ghostElm.parentNode!==bodyElm&&bodyElm.appendChild(ghostElm)}(state.ghost,editor.getBody()),function(ghostElm,position,width,height,maxX,maxY){var overflowX=0,overflowY=0;ghostElm.style.left=position.pageX+"px",ghostElm.style.top=position.pageY+"px",position.pageX+width>maxX&&(overflowX=position.pageX+width-maxX),position.pageY+height>maxY&&(overflowY=position.pageY+height-maxY),ghostElm.style.width=width-overflowX+"px",ghostElm.style.height=height-overflowY+"px"}(state.ghost,targetPos,state.width,state.height,state.maxX,state.maxY),throttledPlaceCaretAt(e.clientX,e.clientY)}}}(state,editor),dropHandler=drop(state,editor),dragEndHandler=function(state,editor){return function(){state.dragging&&editor.fire("dragend"),removeDragState(state)}}(state,editor),editor.on("mousedown",dragStartHandler),editor.on("mousemove",dragHandler),editor.on("mouseup",dropHandler),pageDom.bind(rootDocument,"mousemove",dragHandler),pageDom.bind(rootDocument,"mouseup",dragEndHandler),editor.on("remove",function(){pageDom.unbind(rootDocument,"mousemove",dragHandler),pageDom.unbind(rootDocument,"mouseup",dragEndHandler)})}function getContentEditableRoot$2(editor,node){for(var root=editor.getBody();node&&node!==root;){if(isContentEditableTrue$5(node)||isContentEditableFalse$b(node))return node;node=node.parentNode}return null}function SelectionOverrides(editor){function setRange(range){range&&editor.selection.setRng(range)}function getRange(){return editor.selection.getRng()}function showCaret(direction,node,before,scrollIntoView){return void 0===scrollIntoView&&(scrollIntoView=!0),editor.fire("ShowCaret",{target:node,direction:direction,before:before}).isDefaultPrevented()?null:(scrollIntoView&&editor.selection.scrollIntoView(node,-1===direction),fakeCaret.show(before,node))}function isWithinCaretContainer(node){return isCaretContainer(node)||startsWithCaretContainer(node)||endsWithCaretContainer(node)}var selectedContentEditableNode,rootNode=editor.getBody(),fakeCaret=FakeCaret(editor,rootNode,function(node){return editor.dom.isBlock(node)},function(){return EditorFocus_hasFocus(editor)}),realSelectionId="sel-"+editor.dom.uniqueId(),isRangeInCaretContainer=function(rng){return isWithinCaretContainer(rng.startContainer)||isWithinCaretContainer(rng.endContainer)},normalizeShortEndedElementSelection=function(rng){var shortEndedElements=editor.schema.getShortEndedElements(),newRng=editor.dom.createRng(),startContainer=rng.startContainer,startOffset=rng.startOffset,endContainer=rng.endContainer,endOffset=rng.endOffset;return has(shortEndedElements,startContainer.nodeName.toLowerCase())?0===startOffset?newRng.setStartBefore(startContainer):newRng.setStartAfter(startContainer):newRng.setStart(startContainer,startOffset),has(shortEndedElements,endContainer.nodeName.toLowerCase())?0===endOffset?newRng.setEndBefore(endContainer):newRng.setEndAfter(endContainer):newRng.setEnd(endContainer,endOffset),newRng},setContentEditableSelection=function(range,forward){var node,$realSelectionContainer,sel,startContainer,startOffset,endOffset,e,caretPosition,targetClone,origTargetClone,$=editor.$,dom=editor.dom;if(!range)return null;if(range.collapsed){if(!isRangeInCaretContainer(range))if(!1===forward){if(caretPosition=getNormalizedRangeEndPoint(-1,rootNode,range),isFakeCaretTarget(caretPosition.getNode(!0)))return showCaret(-1,caretPosition.getNode(!0),!1,!1);if(isFakeCaretTarget(caretPosition.getNode()))return showCaret(-1,caretPosition.getNode(),!caretPosition.isAtEnd(),!1)}else{if(caretPosition=getNormalizedRangeEndPoint(1,rootNode,range),isFakeCaretTarget(caretPosition.getNode()))return showCaret(1,caretPosition.getNode(),!caretPosition.isAtEnd(),!1);if(isFakeCaretTarget(caretPosition.getNode(!0)))return showCaret(1,caretPosition.getNode(!0),!1,!1)}return null}if(startContainer=range.startContainer,startOffset=range.startOffset,endOffset=range.endOffset,3===startContainer.nodeType&&0===startOffset&&isContentEditableFalse$b(startContainer.parentNode)&&(startContainer=startContainer.parentNode,startOffset=dom.nodeIndex(startContainer),startContainer=startContainer.parentNode),1!==startContainer.nodeType)return null;if(endOffset===startOffset+1&&startContainer===range.endContainer&&(node=startContainer.childNodes[startOffset]),!isContentEditableFalse$b(node))return null;if(targetClone=origTargetClone=node.cloneNode(!0),(e=editor.fire("ObjectSelected",{target:node,targetClone:targetClone})).isDefaultPrevented())return null;$realSelectionContainer=descendant(Element.fromDom(editor.getBody()),"#"+realSelectionId).fold(function(){return $([])},function(elm){return $([elm.dom()])}),targetClone=e.targetClone,0===$realSelectionContainer.length&&($realSelectionContainer=$('<div data-mce-bogus="all" class="mce-offscreen-selection"></div>').attr("id",realSelectionId)).appendTo(editor.getBody()),range=editor.dom.createRng(),targetClone===origTargetClone&&Env.ie?($realSelectionContainer.empty().append('<p style="font-size: 0" data-mce-bogus="all"></p>').append(targetClone),range.setStartAfter($realSelectionContainer[0].firstChild.firstChild),range.setEndAfter(targetClone)):($realSelectionContainer.empty().append("").append(targetClone).append(""),range.setStart($realSelectionContainer[0].firstChild,1),range.setEnd($realSelectionContainer[0].lastChild,0)),$realSelectionContainer.css({top:dom.getPos(node,editor.getBody()).y}),$realSelectionContainer[0].focus(),(sel=editor.selection.getSel()).removeAllRanges(),sel.addRange(range);var nodeElm=Element.fromDom(node);return each(descendants$1(Element.fromDom(editor.getBody()),"*[data-mce-selected]"),function(elm){eq(nodeElm,elm)||remove$1(elm,"data-mce-selected")}),editor.dom.getAttrib(node,"data-mce-selected")||node.setAttribute("data-mce-selected","1"),selectedContentEditableNode=node,hideFakeCaret(),range},removeContentEditableSelection=function(){selectedContentEditableNode&&(selectedContentEditableNode.removeAttribute("data-mce-selected"),descendant(Element.fromDom(editor.getBody()),"#"+realSelectionId).each(remove),selectedContentEditableNode=null),descendant(Element.fromDom(editor.getBody()),"#"+realSelectionId).each(remove),selectedContentEditableNode=null},hideFakeCaret=function(){fakeCaret.hide()};return Env.ceFalse&&function(){editor.on("mouseup",function(e){var range=getRange();range.collapsed&&EditorView_isXYInContentArea(editor,e.clientX,e.clientY)&&setRange(renderCaretAtRange(editor,range,!1))}),editor.on("click",function(e){var contentEditableRoot;(contentEditableRoot=getContentEditableRoot$2(editor,e.target))&&(isContentEditableFalse$b(contentEditableRoot)&&(e.preventDefault(),editor.focus()),isContentEditableTrue$5(contentEditableRoot)&&editor.dom.isChildOf(contentEditableRoot,editor.selection.getNode())&&removeContentEditableSelection())}),editor.on("blur NewBlock",function(){removeContentEditableSelection()}),editor.on("ResizeWindow FullscreenStateChanged",function(){return fakeCaret.reposition()});function hasBetterMouseTarget(targetNode,caretNode){var targetBlock=editor.dom.getParent(targetNode,editor.dom.isBlock),caretBlock=editor.dom.getParent(caretNode,editor.dom.isBlock);return!(!targetBlock||!editor.dom.isChildOf(targetBlock,caretBlock)||!1!==isContentEditableFalse$b(getContentEditableRoot$2(editor,targetBlock)))||targetBlock&&!function(node1,node2){return editor.dom.getParent(node1,editor.dom.isBlock)===editor.dom.getParent(node2,editor.dom.isBlock)}(targetBlock,caretBlock)&&function(elm){var caretWalker=CaretWalker(elm);if(!elm.firstChild)return!1;var startPos=CaretPosition$1.before(elm.firstChild),newPos=caretWalker.next(startPos);return newPos&&!isBeforeContentEditableFalse(newPos)&&!isAfterContentEditableFalse(newPos)}(targetBlock)}!function(editor){editor.on("tap",function(e){var contentEditableRoot=getContentEditableRoot$2(editor,e.target);isContentEditableFalse$b(contentEditableRoot)&&(e.preventDefault(),setContentEditableSelection(selectNode(editor,contentEditableRoot)))},!0)}(editor),editor.on("mousedown",function(e){var contentEditableRoot,targetElm=e.target;if((targetElm===rootNode||"HTML"===targetElm.nodeName||editor.dom.isChildOf(targetElm,rootNode))&&!1!==EditorView_isXYInContentArea(editor,e.clientX,e.clientY))if(contentEditableRoot=getContentEditableRoot$2(editor,targetElm))isContentEditableFalse$b(contentEditableRoot)?(e.preventDefault(),setContentEditableSelection(selectNode(editor,contentEditableRoot))):(removeContentEditableSelection(),isContentEditableTrue$5(contentEditableRoot)&&e.shiftKey||RangePoint_isXYWithinRange(e.clientX,e.clientY,editor.selection.getRng())||(hideFakeCaret(),editor.selection.placeCaretAt(e.clientX,e.clientY)));else if(!1===isFakeCaretTarget(targetElm)){removeContentEditableSelection(),hideFakeCaret();var caretInfo=closestCaret(rootNode,e.clientX,e.clientY);if(caretInfo&&!hasBetterMouseTarget(e.target,caretInfo.node)){e.preventDefault();var range=showCaret(1,caretInfo.node,caretInfo.before,!1);editor.getBody().focus(),setRange(range)}}}),editor.on("keypress",function(e){VK.modifierPressed(e)||(e.keyCode,isContentEditableFalse$b(editor.selection.getNode())&&e.preventDefault())}),editor.on("GetSelectionRange",function(e){var rng=e.range;if(selectedContentEditableNode){if(!selectedContentEditableNode.parentNode)return void(selectedContentEditableNode=null);(rng=rng.cloneRange()).selectNode(selectedContentEditableNode),e.range=rng}}),editor.on("SetSelectionRange",function(e){e.range=normalizeShortEndedElementSelection(e.range);var rng=setContentEditableSelection(e.range,e.forward);rng&&(e.range=rng)});editor.on("AfterSetSelectionRange",function(e){var rng=e.range;isRangeInCaretContainer(rng)||function(node){return"mcepastebin"===node.id}(rng.startContainer.parentNode)||hideFakeCaret(),function(elm){return editor.dom.hasClass(elm,"mce-offscreen-selection")}(rng.startContainer.parentNode)||removeContentEditableSelection()}),editor.on("copy",function(e){var clipboardData=e.clipboardData;if(!e.isDefaultPrevented()&&e.clipboardData&&!Env.ie){var realSelectionElement=function(){var container=editor.dom.get(realSelectionId);return container?container.getElementsByTagName("*")[0]:container}();realSelectionElement&&(e.preventDefault(),clipboardData.clearData(),clipboardData.setData("text/html",realSelectionElement.outerHTML),clipboardData.setData("text/plain",realSelectionElement.outerText))}}),DragDropOverrides_init(editor),CefFocus_setup(editor)}(),{showCaret:showCaret,showBlockCaretContainer:function(blockCaretContainer){blockCaretContainer.hasAttribute("data-mce-caret")&&(showCaretContainerBlock(blockCaretContainer),setRange(getRange()),editor.selection.scrollIntoView(blockCaretContainer))},hideFakeCaret:hideFakeCaret,destroy:function(){fakeCaret.destroy(),selectedContentEditableNode=null}}}function Quirks(editor){function setEditorCommandState(cmd,state){try{editor.getDoc().execCommand(cmd,!1,state)}catch(ex){}}function isDefaultPrevented(e){return e.isDefaultPrevented()}function selectAll(){editor.shortcuts.add("meta+a",null,"SelectAll")}function disableBackspaceIntoATable(){editor.on("keydown",function(e){if(!isDefaultPrevented(e)&&e.keyCode===BACKSPACE&&selection.isCollapsed()&&0===selection.getRng().startOffset){var previousSibling=selection.getNode().previousSibling;if(previousSibling&&previousSibling.nodeName&&"table"===previousSibling.nodeName.toLowerCase())return e.preventDefault(),!1}})}function bodyHeight(){editor.inline||(editor.contentStyles.push("body {min-height: 150px}"),editor.on("click",function(e){var rng;if("HTML"===e.target.nodeName){if(11<Env.ie)return void editor.getBody().focus();rng=editor.selection.getRng(),editor.getBody().focus(),editor.selection.setRng(rng),editor.selection.normalize(),editor.nodeChanged()}}))}var each=Tools.each,BACKSPACE=VK.BACKSPACE,DELETE=VK.DELETE,dom=editor.dom,selection=editor.selection,settings=editor.settings,parser=editor.parser,isGecko=Env.gecko,isIE=Env.ie,isWebKit=Env.webkit,mceInternalDataType=isIE?"Text":"URL";function serializeRng(rng){var body=dom.create("body"),contents=rng.cloneContents();return body.appendChild(contents),selection.serializer.serialize(body,{format:"html"})}function getAttributeApplyFunction(){var template=dom.getAttribs(selection.getStart().cloneNode(!1));return function(){var target=selection.getStart();target!==editor.getBody()&&(dom.setAttrib(target,"style",null),each(template,function(attr){target.setAttributeNode(attr.cloneNode(!0))}))}}function isSelectionAcrossElements(){return!selection.isCollapsed()&&dom.getParent(selection.getStart(),dom.isBlock)!==dom.getParent(selection.getEnd(),dom.isBlock)}return editor.on("keydown",function(e){var rng,container,offset,root,parent;if(!isDefaultPrevented(e)&&e.keyCode===VK.BACKSPACE&&(container=(rng=selection.getRng()).startContainer,offset=rng.startOffset,root=dom.getRoot(),parent=container,rng.collapsed&&0===offset)){for(;parent&&parent.parentNode&&parent.parentNode.firstChild===parent&&parent.parentNode!==root;)parent=parent.parentNode;"BLOCKQUOTE"===parent.tagName&&(editor.formatter.toggle("blockquote",null,parent),(rng=dom.createRng()).setStart(container,0),rng.setEnd(container,0),selection.setRng(rng))}}),editor.on("keydown",function(e){var isCollapsed,body,keyCode=e.keyCode;if(!isDefaultPrevented(e)&&(keyCode===DELETE||keyCode===BACKSPACE)){if(isCollapsed=editor.selection.isCollapsed(),body=editor.getBody(),isCollapsed&&!dom.isEmpty(body))return;if(!isCollapsed&&!function(rng){var selection=serializeRng(rng),allRng=dom.createRng();return allRng.selectNode(editor.getBody()),selection===serializeRng(allRng)}(editor.selection.getRng()))return;e.preventDefault(),editor.setContent(""),body.firstChild&&dom.isBlock(body.firstChild)?editor.selection.setCursorLocation(body.firstChild,0):editor.selection.setCursorLocation(body,0),editor.nodeChanged()}}),Env.windowsPhone||editor.on("keyup focusin mouseup",function(e){VK.modifierPressed(e)||selection.normalize()},!0),isWebKit&&(editor.inline||dom.bind(editor.getDoc(),"mousedown mouseup",function(e){var rng;if(e.target===editor.getDoc().documentElement)if(rng=selection.getRng(),editor.getBody().focus(),"mousedown"===e.type){if(isCaretContainer(rng.startContainer))return;selection.placeCaretAt(e.clientX,e.clientY)}else selection.setRng(rng)}),editor.on("click",function(e){var target=e.target;/^(IMG|HR)$/.test(target.nodeName)&&"false"!==dom.getContentEditableParent(target)&&(e.preventDefault(),editor.selection.select(target),editor.nodeChanged()),"A"===target.nodeName&&dom.hasClass(target,"mce-item-anchor")&&(e.preventDefault(),selection.select(target))}),settings.forced_root_block&&editor.on("init",function(){setEditorCommandState("DefaultParagraphSeparator",Settings_getForcedRootBlock(editor))}),editor.on("init",function(){editor.dom.bind(editor.getBody(),"submit",function(e){e.preventDefault()})}),disableBackspaceIntoATable(),parser.addNodeFilter("br",function(nodes){for(var i=nodes.length;i--;)"Apple-interchange-newline"===nodes[i].attr("class")&&nodes[i].remove()}),Env.iOS?(editor.inline||editor.on("keydown",function(){domGlobals.document.activeElement===domGlobals.document.body&&editor.getWin().focus()}),bodyHeight(),editor.on("click",function(e){var elm=e.target;do{if("A"===elm.tagName)return void e.preventDefault()}while(elm=elm.parentNode)}),editor.contentStyles.push(".mce-content-body {-webkit-touch-callout: none}")):selectAll()),11<=Env.ie&&(bodyHeight(),disableBackspaceIntoATable()),Env.ie&&(selectAll(),setEditorCommandState("AutoUrlDetect",!1),editor.on("dragstart",function(e){!function(e){var selectionHtml,internalContent;e.dataTransfer&&(editor.selection.isCollapsed()&&"IMG"===e.target.tagName&&selection.select(e.target),0<(selectionHtml=editor.selection.getContent()).length&&(internalContent="data:text/mce-internal,"+escape(editor.id)+","+escape(selectionHtml),e.dataTransfer.setData(mceInternalDataType,internalContent)))}(e)}),editor.on("drop",function(e){if(!isDefaultPrevented(e)){var internalContent=function(e){var internalContent;return e.dataTransfer&&(internalContent=e.dataTransfer.getData(mceInternalDataType))&&0<=internalContent.indexOf("data:text/mce-internal,")?(internalContent=internalContent.substr("data:text/mce-internal,".length).split(","),{id:unescape(internalContent[0]),html:unescape(internalContent[1])}):null}(e);if(internalContent&&internalContent.id!==editor.id){e.preventDefault();var rng=CaretRangeFromPoint_fromPoint(e.x,e.y,editor.getDoc());selection.setRng(rng),function(content,internal){editor.queryCommandSupported("mceInsertClipboardContent")?editor.execCommand("mceInsertClipboardContent",!1,{content:content,internal:internal}):editor.execCommand("mceInsertContent",!1,content)}(internalContent.html,!0)}}})),isGecko&&(editor.on("keydown",function(e){if(!isDefaultPrevented(e)&&e.keyCode===BACKSPACE){if(!editor.getBody().getElementsByTagName("hr").length)return;if(selection.isCollapsed()&&0===selection.getRng().startOffset){var node=selection.getNode(),previousSibling=node.previousSibling;if("HR"===node.nodeName)return dom.remove(node),void e.preventDefault();previousSibling&&previousSibling.nodeName&&"hr"===previousSibling.nodeName.toLowerCase()&&(dom.remove(previousSibling),e.preventDefault())}}}),domGlobals.Range.prototype.getClientRects||editor.on("mousedown",function(e){if(!isDefaultPrevented(e)&&"HTML"===e.target.nodeName){var body_1=editor.getBody();body_1.blur(),Delay.setEditorTimeout(editor,function(){body_1.focus()})}}),editor.on("keypress",function(e){var applyAttributes;if(!isDefaultPrevented(e)&&(8===e.keyCode||46===e.keyCode)&&isSelectionAcrossElements())return applyAttributes=getAttributeApplyFunction(),editor.getDoc().execCommand("delete",!1,null),applyAttributes(),e.preventDefault(),!1}),dom.bind(editor.getDoc(),"cut",function(e){var applyAttributes;!isDefaultPrevented(e)&&isSelectionAcrossElements()&&(applyAttributes=getAttributeApplyFunction(),Delay.setEditorTimeout(editor,function(){applyAttributes()}))}),settings.readonly||editor.on("BeforeExecCommand mousedown",function(){setEditorCommandState("StyleWithCSS",!1),setEditorCommandState("enableInlineTableEditing",!1),settings.object_resizing||setEditorCommandState("enableObjectResizing",!1)}),editor.on("SetContent ExecCommand",function(e){"setcontent"!==e.type&&"mceInsertLink"!==e.command||each(dom.select("a"),function(node){var parentNode=node.parentNode,root=dom.getRoot();if(parentNode.lastChild===node){for(;parentNode&&!dom.isBlock(parentNode);){if(parentNode.parentNode.lastChild!==parentNode||parentNode===root)return;parentNode=parentNode.parentNode}dom.add(parentNode,"br",{"data-mce-bogus":1})}})}),editor.contentStyles.push("img:-moz-broken {-moz-force-broken-image-icon:1;min-width:24px;min-height:24px}"),Env.mac&&editor.on("keydown",function(e){!VK.metaKeyPressed(e)||e.shiftKey||37!==e.keyCode&&39!==e.keyCode||(e.preventDefault(),editor.selection.getSel().modify("move",37===e.keyCode?"backward":"forward","lineboundary"))}),disableBackspaceIntoATable()),{refreshContentEditable:function(){},isHidden:function(){var sel;return!(!isGecko||editor.removed)&&(!(sel=editor.selection.getSel())||!sel.rangeCount||0===sel.rangeCount)}}}function initEditor(editor){editor.bindPendingEventDelegates(),editor.initialized=!0,function(editor){editor.fire("Init")}(editor),editor.focus(!0),function(editor){var root=editor.dom.getRoot();editor.inline||hasAnyRanges(editor)&&editor.selection.getStart(!0)!==root||CaretFinder.firstPositionIn(root).each(function(pos){var node=pos.getNode(),caretPos=NodeType.isTable(node)?CaretFinder.firstPositionIn(node).getOr(pos):pos;Env.browser.isIE()?SelectionBookmark_storeNative(editor,caretPos.toRange()):editor.selection.setRng(caretPos.toRange())})}(editor),editor.nodeChanged({initial:!0}),editor.execCallback("init_instance_callback",editor),function(editor){editor.settings.auto_focus&&Delay.setEditorTimeout(editor,function(){var focusEditor;(focusEditor=!0===editor.settings.auto_focus?editor:editor.editorManager.get(editor.settings.auto_focus)).destroyed||focusEditor.focus()},100)}(editor)}function createIframe(editor,o){var title=editor.editorManager.translate("Rich Text Area. Press ALT-0 for help."),ifr=function(id,title,height,customAttrs){var iframe=Element.fromTag("iframe");return setAll(iframe,customAttrs),setAll(iframe,{id:id+"_ifr",frameBorder:"0",allowTransparency:"true",title:title}),add$3(iframe,"tox-edit-area__iframe"),iframe}(editor.id,title,o.height,Settings_getIframeAttrs(editor)).dom();ifr.onload=function(){ifr.onload=null,editor.fire("load")};var isDomainRelaxed=function(editor,ifr){if(domGlobals.document.domain!==domGlobals.window.location.hostname&&Env.browser.isIE()){var bodyUuid=Uuid_uuid("mce");editor[bodyUuid]=function(){InitContentBody_initContentBody(editor)};var domainRelaxUrl='javascript:(function(){document.open();document.domain="'+domGlobals.document.domain+'";var ed = window.parent.tinymce.get("'+editor.id+'");document.write(ed.iframeHTML);document.close();ed.'+bodyUuid+"(true);})()";return DOM$5.setAttrib(ifr,"src",domainRelaxUrl),!0}return!1}(editor,ifr);return editor.contentAreaContainer=o.iframeContainer,editor.iframeElement=ifr,editor.iframeHTML=function(editor){var bodyId,bodyClass,iframeHTML;return iframeHTML=Settings_getDocType(editor)+"<html><head>",Settings_getDocumentBaseUrl(editor)!==editor.documentBaseUrl&&(iframeHTML+='<base href="'+editor.documentBaseURI.getURI()+'" />'),iframeHTML+='<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />',bodyId=Settings_getBodyId(editor),bodyClass=Settings_getBodyClass(editor),Settings_getContentSecurityPolicy(editor)&&(iframeHTML+='<meta http-equiv="Content-Security-Policy" content="'+Settings_getContentSecurityPolicy(editor)+'" />'),iframeHTML+='</head><body id="'+bodyId+'" class="mce-content-body '+bodyClass+'" data-id="'+editor.id+'"><br></body></html>'}(editor),DOM$5.add(o.iframeContainer,ifr),isDomainRelaxed}function trimLegacyPrefix(name){return name.replace(/^\-/,"")}function createThemeFalseResult(element){return{editorContainer:element,iframeContainer:element}}function renderThemeFalse(editor){var targetElement=editor.getElement();return editor.inline?createThemeFalseResult(null):function(targetElement){var iframeContainer=DOM$6.create("div");return DOM$6.insertAfter(iframeContainer,targetElement),createThemeFalseResult(iframeContainer)}(targetElement)}function hasSkipLoadPrefix(name){return"-"===name.charAt(0)}function loadIcons(scriptLoader,editor){(function(editor){return Option.from(Settings_getIconsUrl(editor)).filter(function(url){return 0<url.length}).map(function(url){return{url:url,name:Option.none()}})})(editor).orThunk(function(){return function(editor){return Option.from(Settings_getIconPackName(editor)).filter(function(name){return 0<name.length&&!IconManager.has(name)}).map(function(name){return{url:editor.editorManager.baseURL+"/icons/"+name+"/icons.js",name:Option.some(name)}})}(editor)}).each(function(urlMeta){scriptLoader.add(urlMeta.url,noop,void 0,function(){ErrorReporter.iconsLoadError(editor,urlMeta.url,urlMeta.name.getOrUndefined())})})}function loadScripts(editor,suffix){var scriptLoader=ScriptLoader.ScriptLoader;!function(scriptLoader,editor,suffix,callback){var settings=editor.settings,theme=settings.theme;if(isString(theme)){if(!hasSkipLoadPrefix(theme)&&!ThemeManager.urls.hasOwnProperty(theme)){var themeUrl=settings.theme_url;themeUrl?ThemeManager.load(theme,editor.documentBaseURI.toAbsolute(themeUrl)):ThemeManager.load(theme,"themes/"+theme+"/theme"+suffix+".js")}scriptLoader.loadQueue(function(){ThemeManager.waitFor(theme,callback)})}else callback()}(scriptLoader,editor,suffix,function(){!function(scriptLoader,editor){var languageCode=Settings_getLanguageCode(editor),languageUrl=Settings_getLanguageUrl(editor);if(!1===I18n.hasCode(languageCode)&&"en"!==languageCode){var url_1=""!==languageUrl?languageUrl:editor.editorManager.baseURL+"/langs/"+languageCode+".js";scriptLoader.add(url_1,noop,void 0,function(){ErrorReporter.languageLoadError(editor,url_1,languageCode)})}}(scriptLoader,editor),loadIcons(scriptLoader,editor),function(editor,settings,suffix){isArray(settings.plugins)&&(settings.plugins=settings.plugins.join(" ")),Tools.each(settings.external_plugins,function(url,name){PluginManager.load(name,url,noop,void 0,function(){ErrorReporter.pluginLoadError(editor,url,name)}),settings.plugins+=" "+name}),Tools.each(settings.plugins.split(/[ ,]/),function(plugin){if((plugin=Tools.trim(plugin))&&!PluginManager.urls[plugin])if(hasSkipLoadPrefix(plugin)){plugin=plugin.substr(1,plugin.length);var dependencies=PluginManager.dependencies(plugin);Tools.each(dependencies,function(depPlugin){var defaultSettings={prefix:"plugins/",resource:depPlugin,suffix:"/plugin"+suffix+".js"},dep=PluginManager.createUrl(defaultSettings,depPlugin);PluginManager.load(dep.resource,dep,noop,void 0,function(){ErrorReporter.pluginLoadError(editor,dep.prefix+dep.resource+dep.suffix,dep.resource)})})}else{var url_2={prefix:"plugins/",resource:plugin,suffix:"/plugin"+suffix+".js"};PluginManager.load(plugin,url_2,noop,void 0,function(){ErrorReporter.pluginLoadError(editor,url_2.prefix+url_2.resource+url_2.suffix,plugin)})}})}(editor,editor.settings,suffix),scriptLoader.loadQueue(function(){editor.removed||Init_init(editor)},editor,function(){editor.removed||Init_init(editor)})})}function listItems$1(elm){return Tools.grep(elm.childNodes,function(child){return"LI"===child.nodeName})}function isListItemPadded(node){return node&&node.firstChild&&node.firstChild===node.lastChild&&function(node){return""===node.data||NodeType.isBr(node)}(node.firstChild)}function trimListItems(elms){return 0<elms.length&&function(elm){return!elm.firstChild||isListItemPadded(elm)}(elms[elms.length-1])?elms.slice(0,-1):elms}function getParentLi(dom,node){var parentBlock=dom.getParent(node,dom.isBlock);return parentBlock&&"LI"===parentBlock.nodeName?parentBlock:null}function findLastOf(node,rootNode){var caretPos=CaretPosition$1.after(node),newCaretPos=CaretWalker(rootNode).prev(caretPos);return newCaretPos?newCaretPos.toRange():null}function insertBefore$1(target,elms,rootNode){var parentElm=target.parentNode;return Tools.each(elms,function(elm){parentElm.insertBefore(elm,target)}),function(node,rootNode){var caretPos=CaretPosition$1.before(node),newCaretPos=CaretWalker(rootNode).next(caretPos);return newCaretPos?newCaretPos.toRange():null}(target,rootNode)}function trimOrPadLeftRight(rng,html){var container,offset;function hasSiblingText(siblingName){return container[siblingName]&&3===container[siblingName].nodeType}return container=rng.startContainer,offset=rng.startOffset,3===container.nodeType&&(0<offset?html=html.replace(/^&nbsp;/," "):hasSiblingText("previousSibling")||(html=html.replace(/^ /,"&nbsp;")),offset<container.length?html=html.replace(/&nbsp;(<br>|)$/," "):hasSiblingText("nextSibling")||(html=html.replace(/(&nbsp;| )(<br>|)$/,"&nbsp;"))),html}function selectionSetContent(editor,content){var rng=editor.selection.getRng(),container=rng.startContainer,offset=rng.startOffset;rng.collapsed&&function(container,offset){return NodeType.isText(container)&&""===container.nodeValue[offset-1]}(container,offset)&&NodeType.isText(container)&&(container.insertData(offset-1," "),container.deleteData(offset,1),rng.setStart(container,offset),rng.setEnd(container,offset),editor.selection.setRng(rng)),editor.selection.setContent(content)}function insertHtmlAtCaret(editor,value,details){var parser,serializer,parentNode,rootNode,fragment,args,marker,rng,node,bookmarkHtml,merge,selection=editor.selection,dom=editor.dom;if(/^ | $/.test(value)&&(value=trimOrPadLeftRight(selection.getRng(),value)),parser=editor.parser,merge=details.merge,serializer=Serializer({validate:editor.settings.validate},editor.schema),bookmarkHtml='<span id="mce_marker" data-mce-type="bookmark">&#xFEFF;&#x200B;</span>',args={content:value,format:"html",selection:!0,paste:details.paste},(args=editor.fire("BeforeSetContent",args)).isDefaultPrevented())editor.fire("SetContent",{content:args.content,format:"html",selection:!0,paste:details.paste});else{-1===(value=args.content).indexOf("{$caret}")&&(value+="{$caret}"),value=value.replace(/\{\$caret\}/,bookmarkHtml);var caretElement=(rng=selection.getRng()).startContainer||(rng.parentElement?rng.parentElement():null),body=editor.getBody();caretElement===body&&selection.isCollapsed()&&dom.isBlock(body.firstChild)&&function(editor,node){return node&&!editor.schema.getShortEndedElements()[node.nodeName]}(editor,body.firstChild)&&dom.isEmpty(body.firstChild)&&((rng=dom.createRng()).setStart(body.firstChild,0),rng.setEnd(body.firstChild,0),selection.setRng(rng)),selection.isCollapsed()||(editor.selection.setRng(RangeNormalizer_normalize(editor.selection.getRng())),editor.getDoc().execCommand("Delete",!1,null),value=function(rng,value){var container,offset;return container=rng.startContainer,offset=rng.startOffset,3===container.nodeType&&rng.collapsed&&(""===container.data[offset]?(container.deleteData(offset,1),/[\u00a0| ]$/.test(value)||(value+=" ")):""===container.data[offset-1]&&(container.deleteData(offset-1,1),/[\u00a0| ]$/.test(value)||(value=" "+value))),value}(editor.selection.getRng(),value));var parserArgs={context:(parentNode=selection.getNode()).nodeName.toLowerCase(),data:details.data,insert:!0};if(fragment=parser.parse(value,parserArgs),!0===details.paste&&InsertList_isListFragment(editor.schema,fragment)&&InsertList_isParentBlockLi(dom,parentNode))return rng=InsertList_insertAtCaret(serializer,dom,editor.selection.getRng(),fragment),editor.selection.setRng(rng),void editor.fire("SetContent",args);if(!function(fragment){for(var node=fragment;node=node.walk();)1===node.type&&node.attr("data-mce-fragment","1")}(fragment),"mce_marker"===(node=fragment.lastChild).attr("id"))for(node=(marker=node).prev;node;node=node.walk(!0))if(3===node.type||!dom.isBlock(node.name)){editor.schema.isValidChild(node.parent.name,"span")&&node.parent.insert(marker,node,"br"===node.name);break}if(editor._selectionOverrides.showBlockCaretContainer(parentNode),parserArgs.invalid){for(selectionSetContent(editor,bookmarkHtml),parentNode=selection.getNode(),rootNode=editor.getBody(),9===parentNode.nodeType?parentNode=node=rootNode:node=parentNode;node!==rootNode;)node=(parentNode=node).parentNode;value=parentNode===rootNode?rootNode.innerHTML:dom.getOuterHTML(parentNode),value=serializer.serialize(parser.parse(value.replace(/<span (id="mce_marker"|id=mce_marker).+?<\/span>/i,function(){return serializer.serialize(fragment)}))),parentNode===rootNode?dom.setHTML(rootNode,value):dom.setOuterHTML(parentNode,value)}else!function(editor,value,parentNode){if("all"===parentNode.getAttribute("data-mce-bogus"))parentNode.parentNode.insertBefore(editor.dom.createFragment(value),parentNode);else{var node=parentNode.firstChild,node2=parentNode.lastChild;!node||node===node2&&"BR"===node.nodeName?editor.dom.setHTML(parentNode,value):selectionSetContent(editor,value)}}(editor,value=serializer.serialize(fragment),parentNode);!function(editor,merge){var textInlineElements=editor.schema.getTextInlineElements(),dom=editor.dom;if(merge){var root_1=editor.getBody(),elementUtils_1=new ElementUtils(dom);Tools.each(dom.select("*[data-mce-fragment]"),function(node){for(var testNode=node.parentNode;testNode&&testNode!==root_1;testNode=testNode.parentNode)textInlineElements[node.nodeName.toLowerCase()]&&elementUtils_1.compare(testNode,node)&&dom.remove(node,!0)})}}(editor,merge),function(editor,marker){var parentEditableFalseElm,parentBlock,nextRng,node,node2,dom=editor.dom,selection=editor.selection;if(marker){if(editor.selection.scrollIntoView(marker),parentEditableFalseElm=function(node){for(var root=editor.getBody();node&&node!==root;node=node.parentNode)if("false"===editor.dom.getContentEditable(node))return node;return null}(marker))return dom.remove(marker),selection.select(parentEditableFalseElm);var rng=dom.createRng();(node=marker.previousSibling)&&3===node.nodeType?(rng.setStart(node,node.nodeValue.length),Env.ie||(node2=marker.nextSibling)&&3===node2.nodeType&&(node.appendData(node2.data),node2.parentNode.removeChild(node2))):(rng.setStartBefore(marker),rng.setEndBefore(marker));parentBlock=dom.getParent(marker,dom.isBlock),dom.remove(marker),parentBlock&&dom.isEmpty(parentBlock)&&(editor.$(parentBlock).empty(),rng.setStart(parentBlock,0),rng.setEnd(parentBlock,0),isTableCell$5(parentBlock)||function(node){return!!node.getAttribute("data-mce-fragment")}(parentBlock)||!(nextRng=function(rng){var caretPos=CaretPosition$1.fromRangeStart(rng);if(caretPos=CaretWalker(editor.getBody()).next(caretPos))return caretPos.toRange()}(rng))?dom.add(parentBlock,dom.create("br",{"data-mce-bogus":"1"})):(rng=nextRng,dom.remove(parentBlock))),selection.setRng(rng)}}(editor,dom.get("mce_marker")),function(elm){Tools.each(elm.getElementsByTagName("*"),function(elm){elm.removeAttribute("data-mce-fragment")})}(editor.getBody()),function(dom,elm){Option.from(dom.getParent(elm,"td,th")).map(Element.fromDom).each(PaddingBr_trimBlockTrailingBr)}(editor.dom,editor.selection.getStart()),editor.fire("SetContent",args),editor.addVisual()}}function nativeCommand(editor,command){editor.getDoc().execCommand(command,!1,null)}function closest$2(scope,transform,isRoot){return transform(scope).orThunk(function(){return isRoot(scope)?Option.none():function(scope,transform,isRoot){for(var element=scope.dom(),stop=isFunction(isRoot)?isRoot:constant(!1);element.parentNode;){element=element.parentNode;var el=Element.fromDom(element),transformed=transform(el);if(transformed.isSome())return transformed;if(stop(el))break}return Option.none()}(scope,transform,isRoot)})}function getSpecifiedFontProp(propName,rootElm,elm){function getProperty(elm){return getRaw(elm,propName).orThunk(function(){return"font"===name(elm)?get(legacyPropNames,propName).bind(function(legacyPropName){return function(element,key){return Option.from(get$3(element,key))}(elm,legacyPropName)}):Option.none()})}return closest$2(Element.fromDom(elm),function(elm){return getProperty(elm)},function(elm){return eq(Element.fromDom(rootElm),elm)})}function getFontProp(propName){return function(rootElm,elm){return Option.from(elm).map(Element.fromDom).filter(isElement).bind(function(element){return getSpecifiedFontProp(propName,rootElm,element.dom()).or(function(propName,elm){return Option.from(DOMUtils$1.DOM.getStyle(elm,propName,!0))}(propName,element.dom()))}).getOr("")}}function findFirstCaretElement(editor){return CaretFinder.firstPositionIn(editor.getBody()).map(function(caret){var container=caret.container();return NodeType.isText(container)?container.parentNode:container})}function getCaretElement(editor){return Option.from(editor.selection.getRng()).bind(function(rng){return function(rng,root){return rng.startContainer===root&&0===rng.startOffset}(rng,editor.getBody())?Option.none():Option.from(editor.selection.getStart(!0))})}function fromFontSizeNumber(editor,value){if(/^[0-9\.]+$/.test(value)){var fontSizeNumber=parseInt(value,10);if(1<=fontSizeNumber&&fontSizeNumber<=7){var fontSizes=Settings_getFontStyleValues(editor),fontClasses=Settings_getFontSizeClasses(editor);return fontClasses?fontClasses[fontSizeNumber-1]||value:fontSizes[fontSizeNumber-1]||value}return value}return value}function fontNameAction(editor,value){var font=fromFontSizeNumber(editor,value);editor.formatter.toggle("fontname",{value:function(font){var fonts=font.split(/\s*,\s*/);return map(fonts,function(font){return-1===font.indexOf(" ")||startsWith(font,'"')||startsWith(font,"'")?font:"'"+font+"'"}).join(",")}(font)}),editor.nodeChanged()}function getEventDispatcher(obj){return obj._eventDispatcher||(obj._eventDispatcher=new EventDispatcher({scope:obj,toggleEvent:function(name,state){EventDispatcher.isNative(name)&&obj.toggleNativeEvent&&obj.toggleNativeEvent(name,state)}})),obj._eventDispatcher}function toggleClass(elm,cls,state){has$2(elm,cls)&&!1===state?function(element,clazz){supports(element)?element.dom().classList.remove(clazz):remove$3(element,clazz);cleanClass(element)}(elm,cls):state&&add$3(elm,cls)}function setEditorCommandState(editor,cmd,state){try{editor.getDoc().execCommand(cmd,!1,state)}catch(ex){}}function setContentEditable(elm,state){elm.dom().contentEditable=state?"true":"false"}function toggleReadOnly(editor,state){var body=Element.fromDom(editor.getBody());toggleClass(body,"mce-content-readonly",state),state?(editor.selection.controlSelection.hideResizeRect(),editor._selectionOverrides.hideFakeCaret(),function(editor){Option.from(editor.selection.getNode()).each(function(elm){elm.removeAttribute("data-mce-selected")})}(editor),editor.readonly=!0,setContentEditable(body,!1),function(elm){each(descendants$1(elm,'*[contenteditable="true"]'),function(elm){set(elm,"data-mce-contenteditable","true"),setContentEditable(elm,!1)})}(body)):(editor.readonly=!1,setContentEditable(body,!0),function(elm){each(descendants$1(elm,'*[data-mce-contenteditable="true"]'),function(elm){remove$1(elm,"data-mce-contenteditable"),setContentEditable(elm,!0)})}(body),setEditorCommandState(editor,"StyleWithCSS",!1),setEditorCommandState(editor,"enableInlineTableEditing",!1),setEditorCommandState(editor,"enableObjectResizing",!1),EditorFocus_hasEditorOrUiFocus(editor)&&editor.focus(),function(editor){editor.selection.setRng(editor.selection.getRng())}(editor),editor.nodeChanged())}function isReadOnly(editor){return editor.readonly}function registerFilters(editor){editor.parser.addAttributeFilter("contenteditable",function(nodes){isReadOnly(editor)&&each(nodes,function(node){node.attr("data-mce-contenteditable",node.attr("contenteditable")),node.attr("contenteditable","false")})}),editor.serializer.addAttributeFilter("data-mce-contenteditable",function(nodes){isReadOnly(editor)&&each(nodes,function(node){node.attr("contenteditable",node.attr("data-mce-contenteditable"))})}),editor.serializer.addTempAttr("data-mce-contenteditable")}function getEventTarget(editor,eventName){return"selectionchange"===eventName?editor.getDoc():!editor.inline&&/^mouse|touch|click|contextmenu|drop|dragover|dragend/.test(eventName)?editor.getDoc().documentElement:editor.settings.event_root?(editor.eventRoot||(editor.eventRoot=DOM$8.select(editor.settings.event_root)[0]),editor.eventRoot):editor.getBody()}function fireEvent(editor,eventName,e){!function(editor){return!editor.hidden&&!isReadOnly(editor)}(editor)?isReadOnly(editor)&&function(editor,e){var target=e.target;!function(e){return"click"===e.type}(e)||VK.metaKeyPressed(e)||!function(editor,target){return null!==editor.dom.getParent(target,"a")}(editor,target)||e.preventDefault()}(editor,e):editor.fire(eventName,e)}function bindEventDelegate(editor,eventName){var eventRootElm,delegate;if(editor.delegates||(editor.delegates={}),!editor.delegates[eventName]&&!editor.removed)if(eventRootElm=getEventTarget(editor,eventName),editor.settings.event_root){if(customEventRootDelegates||(customEventRootDelegates={},editor.editorManager.on("removeEditor",function(){var name;if(!editor.editorManager.activeEditor&&customEventRootDelegates){for(name in customEventRootDelegates)editor.dom.unbind(getEventTarget(editor,name));customEventRootDelegates=null}})),customEventRootDelegates[eventName])return;delegate=function(e){for(var target=e.target,editors=editor.editorManager.get(),i=editors.length;i--;){var body=editors[i].getBody();body!==target&&!DOM$8.isChildOf(target,body)||fireEvent(editors[i],eventName,e)}},customEventRootDelegates[eventName]=delegate,DOM$8.bind(eventRootElm,eventName,delegate)}else delegate=function(e){fireEvent(editor,eventName,e)},DOM$8.bind(eventRootElm,eventName,delegate),editor.delegates[eventName]=delegate}function switchToMode(editor,activeMode,availableModes,mode){var oldMode=availableModes[activeMode.get()],newMode=availableModes[mode];try{newMode.activate()}catch(e){return void domGlobals.console.error("problem while activating editor mode "+mode+":",e)}oldMode.deactivate(),oldMode.editorReadOnly!==newMode.editorReadOnly&&toggleReadOnly(editor,newMode.editorReadOnly),activeMode.set(mode),function(editor,mode){editor.fire("SwitchMode",{mode:mode})}(editor,mode)}function create$4(editor){var activeMode=Cell("design"),availableModes=Cell({design:{activate:noop,deactivate:noop,editorReadOnly:!1},readonly:{activate:noop,deactivate:noop,editorReadOnly:!0}});return function(editor){editor.serializer?registerFilters(editor):editor.on("PreInit",function(){registerFilters(editor)})}(editor),function(editor){editor.on("ShowCaret",function(e){isReadOnly(editor)&&e.preventDefault()}),editor.on("ObjectSelected",function(e){isReadOnly(editor)&&e.preventDefault()})}(editor),{isReadOnly:function(){return isReadOnly(editor)},set:function(mode){return function(editor,availableModes,activeMode,mode){if(mode!==activeMode.get()){if(!has(availableModes,mode))throw new Error("Editor mode '"+mode+"' is invalid");editor.initialized?switchToMode(editor,activeMode,availableModes,mode):editor.on("init",function(){return switchToMode(editor,activeMode,availableModes,mode)})}}(editor,availableModes.get(),activeMode,mode)},get:function(){return activeMode.get()},register:function(mode,api){availableModes.set(function(availableModes,mode,api){var _a;if(contains(defaultModes,mode))throw new Error("Cannot override default mode "+mode);return __assign(__assign({},availableModes),((_a={})[mode]=__assign(__assign({},api),{deactivate:function(){try{api.deactivate()}catch(e){domGlobals.console.error("problem while deactivating editor mode "+mode+":",e)}}}),_a))}(availableModes.get(),mode,api))}}}function create$5(){function add(collection,type){return function(name,spec){return collection[name.toLowerCase()]=__assign(__assign({},spec),{type:type})}}var buttons={},menuItems={},popups={},icons={},contextMenus={},contextToolbars={},sidebars={};return{addButton:add(buttons,"button"),addGroupToolbarButton:add(buttons,"grouptoolbarbutton"),addToggleButton:add(buttons,"togglebutton"),addMenuButton:add(buttons,"menubutton"),addSplitButton:add(buttons,"splitbutton"),addMenuItem:add(menuItems,"menuitem"),addNestedMenuItem:add(menuItems,"nestedmenuitem"),addToggleMenuItem:add(menuItems,"togglemenuitem"),addAutocompleter:add(popups,"autocompleter"),addContextMenu:add(contextMenus,"contextmenu"),addContextToolbar:add(contextToolbars,"contexttoolbar"),addContextForm:add(contextToolbars,"contextform"),addSidebar:add(sidebars,"sidebar"),addIcon:function(name,svgData){return icons[name.toLowerCase()]=svgData},getAll:function(){return{buttons:buttons,menuItems:menuItems,icons:icons,popups:popups,contextMenus:contextMenus,contextToolbars:contextToolbars,sidebars:sidebars}}}}function globalEventDelegate(e){var type=e.type;each$j(EditorManager.get(),function(editor){switch(type){case"scroll":editor.fire("ScrollWindow",e);break;case"resize":editor.fire("ResizeWindow",e)}})}function toggleGlobalEvents(state){state!==boundGlobalEvents&&(state?DomQuery(window).on("resize scroll",globalEventDelegate):DomQuery(window).off("resize scroll",globalEventDelegate),boundGlobalEvents=state)}function removeEditorFromList(targetEditor){var oldEditors=editors;delete legacyEditors[targetEditor.id];for(var i=0;i<legacyEditors.length;i++)if(legacyEditors[i]===targetEditor){legacyEditors.splice(i,1);break}return editors=filter(editors,function(editor){return targetEditor!==editor}),EditorManager.activeEditor===targetEditor&&(EditorManager.activeEditor=0<editors.length?editors[0]:null),EditorManager.focusedEditor===targetEditor&&(EditorManager.focusedEditor=null),oldEditors.length!==editors.length}var customEventRootDelegates,beforeUnloadDelegate,getPositionsUntilPreviousLine=curry(getPositionsUntil,CaretPosition.isAbove,-1),getPositionsUntilNextLine=curry(getPositionsUntil,CaretPosition.isBelow,1),getPositionsAbove=curry(getAdjacentLinePositions,-1,getPositionsUntilPreviousLine),getPositionsBelow=curry(getAdjacentLinePositions,1,getPositionsUntilNextLine),isContentEditableFalse$9=NodeType.isContentEditableFalse,getSelectedNode$1=getSelectedNode,getClosestCellAbove=curry(getClosestCell,function(rect){return rect.bottom},function(corner,y){return corner.y<y}),getClosestCellBelow=curry(getClosestCell,function(rect){return rect.top},function(corner,y){return corner.y>y}),isAtFirstTableCellLine=curry(isAtTableCellLine,getPositionsUntilPreviousLine),isAtLastTableCellLine=curry(isAtTableCellLine,getPositionsUntilNextLine),MatchKeys_action=function(f){for(var x=[],_i=1;_i<arguments.length;_i++)x[_i-1]=arguments[_i];var args=Array.prototype.slice.call(arguments,1);return function(){return f.apply(null,args)}},MatchKeys_execute=function(patterns,evt){return find(match$1(patterns,evt),function(pattern){return pattern.action()})},ArrowKeys_setup=function(editor,caret){editor.on("keydown",function(evt){!1===evt.isDefaultPrevented()&&function(editor,caret,evt){var os=detect$3().os;MatchKeys_execute([{keyCode:VK.RIGHT,action:moveH(editor,!0)},{keyCode:VK.LEFT,action:moveH(editor,!1)},{keyCode:VK.UP,action:moveV(editor,!1)},{keyCode:VK.DOWN,action:moveV(editor,!0)},{keyCode:VK.RIGHT,action:moveH$1(editor,!0)},{keyCode:VK.LEFT,action:moveH$1(editor,!1)},{keyCode:VK.UP,action:moveV$1(editor,!1)},{keyCode:VK.DOWN,action:moveV$1(editor,!0)},{keyCode:VK.RIGHT,action:BoundarySelection.move(editor,caret,!0)},{keyCode:VK.LEFT,action:BoundarySelection.move(editor,caret,!1)},{keyCode:VK.RIGHT,ctrlKey:!os.isOSX(),altKey:os.isOSX(),action:BoundarySelection.moveNextWord(editor,caret)},{keyCode:VK.LEFT,ctrlKey:!os.isOSX(),altKey:os.isOSX(),action:BoundarySelection.movePrevWord(editor,caret)},{keyCode:VK.UP,action:moveV$2(editor,!1)},{keyCode:VK.DOWN,action:moveV$2(editor,!0)}],evt).each(function(_){evt.preventDefault()})}(editor,caret,evt)})},DeleteUtils_getParentBlock=function(rootNode,elm){return contains$2(rootNode,elm)?closest(elm,function(element){return isTextBlock(element)||isListItem(element)},function(rootNode){return function(elm){return eq(rootNode,Element.fromDom(elm.dom().parentNode))}}(rootNode)):Option.none()},DeleteUtils_paddEmptyBody=function(editor){editor.dom.isEmpty(editor.getBody())&&(editor.setContent(""),function(editor){var body=editor.getBody(),node=body.firstChild&&editor.dom.isBlock(body.firstChild)?body.firstChild:body;editor.selection.setCursorLocation(node,0)}(editor))},DeleteUtils_willDeleteLastPositionInElement=function(forward,fromPos,elm){return lift2(CaretFinder.firstPositionIn(elm),CaretFinder.lastPositionIn(elm),function(firstPos,lastPos){var normalizedFirstPos=InlineUtils.normalizePosition(!0,firstPos),normalizedLastPos=InlineUtils.normalizePosition(!1,lastPos),normalizedFromPos=InlineUtils.normalizePosition(!1,fromPos);return forward?CaretFinder.nextPosition(elm,normalizedFromPos).map(function(nextPos){return nextPos.isEqual(normalizedLastPos)&&fromPos.isEqual(normalizedFirstPos)}).getOr(!1):CaretFinder.prevPosition(elm,normalizedFromPos).map(function(prevPos){return prevPos.isEqual(normalizedFirstPos)&&fromPos.isEqual(normalizedLastPos)}).getOr(!1)}).getOr(!0)},BlockMergeBoundary_read=function(rootNode,forward,rng){return rng.collapsed?readFromRange(rootNode,forward,rng):Option.none()},MergeBlocks_mergeBlocks=function(rootNode,forward,block1,block2){return forward?mergeBlockInto(rootNode,block2,block1):mergeBlockInto(rootNode,block1,block2)},BlockBoundaryDelete_backspaceDelete=function(editor,forward){var rootNode=Element.fromDom(editor.getBody()),position=BlockMergeBoundary_read(rootNode.dom(),forward,editor.selection.getRng()).bind(function(blockBoundary){return MergeBlocks_mergeBlocks(rootNode,forward,blockBoundary.from().block(),blockBoundary.to().block())});return position.each(function(pos){editor.selection.setRng(pos.toRange())}),position.isSome()},BlockRangeDelete_backspaceDelete=function(editor,forward){return!editor.selection.isCollapsed()&&deleteRange(editor)},findPreviousBr=curry(findBr,!1),findNextBr=curry(findBr,!0),DeleteAction=Adt_generate([{remove:["element"]},{moveToElement:["element"]},{moveToPosition:["position"]}]),getContentEditableRoot$1=function(root,node){for(;node&&node!==root;){if(NodeType.isContentEditableTrue(node)||NodeType.isContentEditableFalse(node))return node;node=node.parentNode}return null},CefDelete_backspaceDelete=function(editor,forward){return editor.selection.isCollapsed()?backspaceDeleteCaret(editor,forward):backspaceDeleteRange(editor,forward)},CefDelete_paddEmptyElement=function(editor){var br,ceRoot=getContentEditableRoot$1(editor.getBody(),editor.selection.getNode());return NodeType.isContentEditableTrue(ceRoot)&&editor.dom.isBlock(ceRoot)&&editor.dom.isEmpty(ceRoot)&&(br=editor.dom.create("br",{"data-mce-bogus":"1"}),editor.dom.setHTML(ceRoot,""),ceRoot.appendChild(br),editor.selection.setRng(CaretPosition$1.before(br).toRange())),!0},CefBoundaryDelete_backspaceDelete=function(editor,forward){return function(editor,forward){var range=editor.selection.getRng();if(!NodeType.isText(range.commonAncestorContainer))return!1;var direction=forward?HDirection.Forwards:HDirection.Backwards,caretWalker=CaretWalker(editor.getBody()),getNextVisualCaretPosition=curry(getVisualCaretPosition,caretWalker.next),getPrevVisualCaretPosition=curry(getVisualCaretPosition,caretWalker.prev),getNextPosFn=forward?getNextVisualCaretPosition:getPrevVisualCaretPosition,isBeforeContentEditableFalseFn=forward?isBeforeContentEditableFalse:isAfterContentEditableFalse,caretPosition=getNormalizedRangeEndPoint(direction,editor.getBody(),range),nextCaretPosition=InlineUtils.normalizePosition(forward,getNextPosFn(caretPosition));if(!nextCaretPosition||!isMoveInsideSameBlock(caretPosition,nextCaretPosition))return!1;if(isBeforeContentEditableFalseFn(nextCaretPosition))return deleteContentAndShowCaret(editor,range,caretPosition.getNode(),direction,forward,nextCaretPosition);var peekCaretPosition=getNextPosFn(nextCaretPosition);return!!(peekCaretPosition&&isBeforeContentEditableFalseFn(peekCaretPosition)&&isMoveInsideSameBlock(nextCaretPosition,peekCaretPosition))&&deleteContentAndShowCaret(editor,range,caretPosition.getNode(),direction,forward,peekCaretPosition)}(editor,forward)},BoundaryDelete_backspaceDelete=function(editor,caret,forward){if(editor.selection.isCollapsed()&&function(editor){return!1!==editor.settings.inline_boundaries}(editor)){var from=CaretPosition$1.fromRangeStart(editor.selection.getRng());return backspaceDeleteCollapsed(editor,caret,forward,from)}return!1},InlineFormatDelete_backspaceDelete=function(editor,forward){return!!editor.selection.isCollapsed()&&deleteCaret(editor,forward)},deleteAction=Adt_generate([{removeTable:["element"]},{emptyCells:["cells"]}]),isWithinSameTable=function(isRoot,cellRng){return getTableFromCellRng(cellRng,isRoot).isSome()},getParentCaption=function(rootElm,elm){return find(Parents_parentsAndSelf(elm,rootElm),function(elm){return"caption"===name(elm)})},emptyElement=function(editor,elm){return PaddingBr_fillWithPaddingBr(elm),editor.selection.setCursorLocation(elm.dom(),0),Option.some(!0)},TableDelete_backspaceDelete=function(editor,forward){var startElm=Element.fromDom(editor.selection.getStart(!0)),cells=TableCellSelection_getCellsFromEditor(editor);return editor.selection.isCollapsed()&&0===cells.length?deleteCaret$1(editor,forward,startElm):function(editor,startElm){var rootNode=Element.fromDom(editor.getBody()),rng=editor.selection.getRng(),selectedCells=TableCellSelection_getCellsFromEditor(editor);return 0!==selectedCells.length?emptyCells(editor,selectedCells):deleteTableRange(editor,rootNode,rng,startElm)}(editor,startElm)},PageBreakDelete_backspaceDelete=function(editor,forward){return!!editor.selection.isCollapsed()&&function(editor,forward){var fromPos=CaretPosition$1.fromRangeStart(editor.selection.getRng());return CaretFinder.fromPosition(forward,editor.getBody(),fromPos).filter(function(pos){return forward?isBeforeImageBlock(pos):isAfterImageBlock(pos)}).bind(function(pos){return Option.from(getChildNodeAtRelativeOffset(forward?0:-1,pos))}).map(function(elm){return editor.selection.select(elm),!0}).getOr(!1)}(editor,forward)},getBlocksToIndent=function(editor){return filter(map(editor.selection.getSelectedBlocks(),Element.fromDom),function(el){return!isListComponent(el)&&!function(el){return parent(el).map(isListComponent).getOr(!1)}(el)&&function(target){return closest(target,function(elm){return NodeType.isContentEditableTrue(elm.dom())||NodeType.isContentEditableFalse(elm.dom())}).exists(function(elm){return NodeType.isContentEditableTrue(elm.dom())})}(el)})},isAtStartOfBlock=curry(isAtBlockBoundary,!1),isAtEndOfBlock=curry(isAtBlockBoundary,!0),isBeforeBlock=curry(isAtBeforeAfterBlockBoundary,!1),isAfterBlock=curry(isAtBeforeAfterBlockBoundary,!0),Outdent_backspaceDelete=function(editor,_caret,_forward){if(editor.selection.isCollapsed()&&canOutdent(editor)){var dom=editor.dom,rng=editor.selection.getRng(),pos=CaretPosition$1.fromRangeStart(rng),block=dom.getParent(rng.startContainer,dom.isBlock);if(null!==block&&isAtStartOfBlock(Element.fromDom(block),pos))return handle(editor,"outdent"),!0}return!1},DeleteBackspaceKeys_setup=function(editor,caret){editor.on("keydown",function(evt){!1===evt.isDefaultPrevented()&&function(editor,caret,evt){MatchKeys_execute([{keyCode:VK.BACKSPACE,action:MatchKeys_action(Outdent_backspaceDelete,editor,!1)},{keyCode:VK.BACKSPACE,action:MatchKeys_action(CefDelete_backspaceDelete,editor,!1)},{keyCode:VK.DELETE,action:MatchKeys_action(CefDelete_backspaceDelete,editor,!0)},{keyCode:VK.BACKSPACE,action:MatchKeys_action(CefBoundaryDelete_backspaceDelete,editor,!1)},{keyCode:VK.DELETE,action:MatchKeys_action(CefBoundaryDelete_backspaceDelete,editor,!0)},{keyCode:VK.BACKSPACE,action:MatchKeys_action(BoundaryDelete_backspaceDelete,editor,caret,!1)},{keyCode:VK.DELETE,action:MatchKeys_action(BoundaryDelete_backspaceDelete,editor,caret,!0)},{keyCode:VK.BACKSPACE,action:MatchKeys_action(TableDelete_backspaceDelete,editor,!1)},{keyCode:VK.DELETE,action:MatchKeys_action(TableDelete_backspaceDelete,editor,!0)},{keyCode:VK.BACKSPACE,action:MatchKeys_action(PageBreakDelete_backspaceDelete,editor,!1)},{keyCode:VK.DELETE,action:MatchKeys_action(PageBreakDelete_backspaceDelete,editor,!0)},{keyCode:VK.BACKSPACE,action:MatchKeys_action(BlockRangeDelete_backspaceDelete,editor,!1)},{keyCode:VK.DELETE,action:MatchKeys_action(BlockRangeDelete_backspaceDelete,editor,!0)},{keyCode:VK.BACKSPACE,action:MatchKeys_action(BlockBoundaryDelete_backspaceDelete,editor,!1)},{keyCode:VK.DELETE,action:MatchKeys_action(BlockBoundaryDelete_backspaceDelete,editor,!0)},{keyCode:VK.BACKSPACE,action:MatchKeys_action(InlineFormatDelete_backspaceDelete,editor,!1)},{keyCode:VK.DELETE,action:MatchKeys_action(InlineFormatDelete_backspaceDelete,editor,!0)}],evt).each(function(_){evt.preventDefault()})}(editor,caret,evt)}),editor.on("keyup",function(evt){!1===evt.isDefaultPrevented()&&function(editor,evt){MatchKeys_execute([{keyCode:VK.BACKSPACE,action:MatchKeys_action(CefDelete_paddEmptyElement,editor)},{keyCode:VK.DELETE,action:MatchKeys_action(CefDelete_paddEmptyElement,editor)}],evt)}(editor,evt)})},NewLineUtils_moveToCaretPosition=function(editor,root){var node,rng,lastNode=root,dom=editor.dom,moveCaretBeforeOnEnterElementsMap=editor.schema.getMoveCaretBeforeOnEnterElements();if(root){if(/^(LI|DT|DD)$/.test(root.nodeName)){var firstChild=function(node){for(;node;){if(1===node.nodeType||3===node.nodeType&&node.data&&/[\r\n\s]/.test(node.data))return node;node=node.nextSibling}}(root.firstChild);firstChild&&/^(UL|OL|DL)$/.test(firstChild.nodeName)&&root.insertBefore(dom.doc.createTextNode(""),root.firstChild)}if(rng=dom.createRng(),root.normalize(),root.hasChildNodes()){for(var walker=new TreeWalker(root,root);node=walker.current();){if(NodeType.isText(node)){rng.setStart(node,0),rng.setEnd(node,0);break}if(moveCaretBeforeOnEnterElementsMap[node.nodeName.toLowerCase()]){rng.setStartBefore(node),rng.setEndBefore(node);break}lastNode=node,node=walker.next()}node||(rng.setStart(lastNode,0),rng.setEnd(lastNode,0))}else NodeType.isBr(root)?root.nextSibling&&dom.isBlock(root.nextSibling)?(rng.setStartBefore(root),rng.setEndBefore(root)):(rng.setStartAfter(root),rng.setEndAfter(root)):(rng.setStart(root,0),rng.setEnd(root,0));editor.selection.setRng(rng),ScrollIntoView_scrollRangeIntoView(editor,rng)}},NewLineUtils_getEditableRoot=function(dom,node){var parent,editableRoot,root=dom.getRoot();for(parent=node;parent!==root&&"false"!==dom.getContentEditable(parent);)"true"===dom.getContentEditable(parent)&&(editableRoot=parent),parent=parent.parentNode;return parent!==root?editableRoot:root},NewLineUtils_getParentBlock=getParentBlock$2,NewLineUtils_getParentBlockName=function(editor){return getParentBlock$2(editor).fold(constant(""),function(parentBlock){return parentBlock.nodeName.toUpperCase()})},NewLineUtils_isListItemParentBlock=function(editor){return getParentBlock$2(editor).filter(function(elm){return isListItem(Element.fromDom(elm))}).isSome()},InsertLi_insert=function(editor,createNewBlock,containerBlock,parentBlock,newBlockName){var dom=editor.dom,rng=editor.selection.getRng();if(containerBlock!==editor.getBody()){!function(elm){return isListBlock(elm)&&isListBlock(elm.parentNode)}(containerBlock)||(newBlockName="LI");var newBlock=newBlockName?createNewBlock(newBlockName):dom.create("BR");if(isFirstOrLastLi(containerBlock,parentBlock,!0)&&isFirstOrLastLi(containerBlock,parentBlock,!1))hasParent$1(containerBlock,"LI")?dom.insertAfter(newBlock,getContainerBlock(containerBlock)):dom.replace(newBlock,containerBlock);else if(isFirstOrLastLi(containerBlock,parentBlock,!0))hasParent$1(containerBlock,"LI")?(dom.insertAfter(newBlock,getContainerBlock(containerBlock)),newBlock.appendChild(dom.doc.createTextNode(" ")),newBlock.appendChild(containerBlock)):containerBlock.parentNode.insertBefore(newBlock,containerBlock);else if(isFirstOrLastLi(containerBlock,parentBlock,!1))dom.insertAfter(newBlock,getContainerBlock(containerBlock));else{containerBlock=getContainerBlock(containerBlock);var tmpRng=rng.cloneRange();tmpRng.setStartAfter(parentBlock),tmpRng.setEndAfter(containerBlock);var fragment=tmpRng.extractContents();"LI"===newBlockName&&function(elm,name){return elm.firstChild&&elm.firstChild.nodeName===name}(fragment,"LI")?(newBlock=fragment.firstChild,dom.insertAfter(fragment,containerBlock)):(dom.insertAfter(fragment,containerBlock),dom.insertAfter(newBlock,containerBlock))}dom.remove(parentBlock),NewLineUtils_moveToCaretPosition(editor,newBlock)}},InsertBlock_insert=function(editor,evt){function createNewBlock(name){var block,clonedNode,caretNode,node=container,textInlineElements=schema.getTextInlineElements();if(caretNode=block=name||"TABLE"===parentBlockName||"HR"===parentBlockName?dom.create(name||newBlockName):parentBlock.cloneNode(!1),!1===Settings_shouldKeepStyles(editor))dom.setAttrib(block,"style",null),dom.setAttrib(block,"class",null);else do{if(textInlineElements[node.nodeName]){if(isCaretNode(node)||Bookmarks_isBookmarkNode(node))continue;clonedNode=node.cloneNode(!1),dom.setAttrib(clonedNode,"id",""),block.hasChildNodes()?clonedNode.appendChild(block.firstChild):caretNode=clonedNode,block.appendChild(clonedNode)}}while((node=node.parentNode)&&node!==editableRoot);return setForcedBlockAttrs(editor,block),emptyBlock(caretNode),block}function isCaretAtStartOrEndOfBlock(start){var node,name,normalizedOffset=normalizeZwspOffset(start,container,offset);if(NodeType.isText(container)&&(start?0<normalizedOffset:normalizedOffset<container.nodeValue.length))return!1;if(container.parentNode===parentBlock&&isAfterLastNodeInContainer&&!start)return!0;if(start&&NodeType.isElement(container)&&container===parentBlock.firstChild)return!0;if(containerAndSiblingName(container,"TABLE")||containerAndSiblingName(container,"HR"))return isAfterLastNodeInContainer&&!start||!isAfterLastNodeInContainer&&start;var walker=new TreeWalker(container,parentBlock);for(NodeType.isText(container)&&(start&&0===normalizedOffset?walker.prev():start||normalizedOffset!==container.nodeValue.length||walker.next());node=walker.current();){if(NodeType.isElement(node)){if(!node.getAttribute("data-mce-bogus")&&(name=node.nodeName.toLowerCase(),nonEmptyElementsMap[name]&&"br"!==name))return!1}else if(NodeType.isText(node)&&!/^[ \t\r\n]*$/.test(node.nodeValue))return!1;start?walker.prev():walker.next()}return!0}function insertNewBlockAfter(){newBlock=/^(H[1-6]|PRE|FIGURE)$/.test(parentBlockName)&&"HGROUP"!==containerBlockName?createNewBlock(newBlockName):createNewBlock(),Settings_shouldEndContainerOnEmptyBlock(editor)&&canSplitBlock(dom,containerBlock)&&dom.isEmpty(parentBlock)?newBlock=dom.split(containerBlock,parentBlock):dom.insertAfter(newBlock,parentBlock),NewLineUtils_moveToCaretPosition(editor,newBlock)}var tmpRng,editableRoot,container,offset,parentBlock,shiftKey,newBlock,fragment,containerBlock,parentBlockName,containerBlockName,newBlockName,isAfterLastNodeInContainer,dom=editor.dom,schema=editor.schema,nonEmptyElementsMap=schema.getNonEmptyElements(),rng=editor.selection.getRng();NormalizeRange_normalize(dom,rng).each(function(normRng){rng.setStart(normRng.startContainer,normRng.startOffset),rng.setEnd(normRng.endContainer,normRng.endOffset)}),container=rng.startContainer,offset=rng.startOffset,newBlockName=Settings_getForcedRootBlock(editor),shiftKey=!(!evt||!evt.shiftKey);var ctrlKey=!(!evt||!evt.ctrlKey);NodeType.isElement(container)&&container.hasChildNodes()&&(isAfterLastNodeInContainer=offset>container.childNodes.length-1,container=container.childNodes[Math.min(offset,container.childNodes.length-1)]||container,offset=isAfterLastNodeInContainer&&NodeType.isText(container)?container.nodeValue.length:0),(editableRoot=getEditableRoot$1(dom,container))&&((newBlockName&&!shiftKey||!newBlockName&&shiftKey)&&(container=function(editor,newBlockName,rng,container,offset){var newBlock,parentBlock,startNode,node,next,rootBlockName,blockName=newBlockName||"P",dom=editor.dom,editableRoot=getEditableRoot$1(dom,container);if(!(parentBlock=dom.getParent(container,dom.isBlock))||!canSplitBlock(dom,parentBlock)){if(rootBlockName=(parentBlock=parentBlock||editableRoot)===editor.getBody()||function(node){return node&&/^(TD|TH|CAPTION)$/.test(node.nodeName)}(parentBlock)?parentBlock.nodeName.toLowerCase():parentBlock.parentNode.nodeName.toLowerCase(),!parentBlock.hasChildNodes())return newBlock=dom.create(blockName),setForcedBlockAttrs(editor,newBlock),parentBlock.appendChild(newBlock),rng.setStart(newBlock,0),rng.setEnd(newBlock,0),newBlock;for(node=container;node.parentNode!==parentBlock;)node=node.parentNode;for(;node&&!dom.isBlock(node);)node=(startNode=node).previousSibling;if(startNode&&editor.schema.isValidChild(rootBlockName,blockName.toLowerCase())){for(newBlock=dom.create(blockName),setForcedBlockAttrs(editor,newBlock),startNode.parentNode.insertBefore(newBlock,startNode),node=startNode;node&&!dom.isBlock(node);)next=node.nextSibling,newBlock.appendChild(node),node=next;rng.setStart(container,offset),rng.setEnd(container,offset)}}return container}(editor,newBlockName,rng,container,offset)),parentBlock=dom.getParent(container,dom.isBlock),containerBlock=parentBlock?dom.getParent(parentBlock.parentNode,dom.isBlock):null,parentBlockName=parentBlock?parentBlock.nodeName.toUpperCase():"","LI"!==(containerBlockName=containerBlock?containerBlock.nodeName.toUpperCase():"")||ctrlKey||(containerBlock=(parentBlock=containerBlock).parentNode,parentBlockName=containerBlockName),/^(LI|DT|DD)$/.test(parentBlockName)&&dom.isEmpty(parentBlock)?InsertLi_insert(editor,createNewBlock,containerBlock,parentBlock,newBlockName):newBlockName&&parentBlock===editor.getBody()||(newBlockName=newBlockName||"P",isCaretContainerBlock(parentBlock)?(newBlock=showCaretContainerBlock(parentBlock),dom.isEmpty(parentBlock)&&emptyBlock(parentBlock),setForcedBlockAttrs(editor,newBlock),NewLineUtils_moveToCaretPosition(editor,newBlock)):isCaretAtStartOrEndOfBlock()?insertNewBlockAfter():isCaretAtStartOrEndOfBlock(!0)?(newBlock=parentBlock.parentNode.insertBefore(createNewBlock(),parentBlock),NewLineUtils_moveToCaretPosition(editor,containerAndSiblingName(parentBlock,"HR")?newBlock:parentBlock)):((tmpRng=function(rng){var newRng=rng.cloneRange();return newRng.setStart(rng.startContainer,normalizeZwspOffset(!0,rng.startContainer,rng.startOffset)),newRng.setEnd(rng.endContainer,normalizeZwspOffset(!1,rng.endContainer,rng.endOffset)),newRng}(rng).cloneRange()).setEndAfter(parentBlock),function(fragment){each(descendants(Element.fromDom(fragment),isText),function(text){var rawNode=text.dom();rawNode.nodeValue=Zwsp.trim(rawNode.nodeValue)})}(fragment=tmpRng.extractContents()),function(node){for(;NodeType.isText(node)&&(node.nodeValue=node.nodeValue.replace(/^[\r\n]+/,"")),node=node.firstChild;);}(fragment),newBlock=fragment.firstChild,dom.insertAfter(fragment,parentBlock),function(dom,nonEmptyElementsMap,block){var i,node=block,firstChilds=[];if(node){for(;node=node.firstChild;){if(dom.isBlock(node))return;NodeType.isElement(node)&&!nonEmptyElementsMap[node.nodeName.toLowerCase()]&&firstChilds.push(node)}for(i=firstChilds.length;i--;)!(node=firstChilds[i]).hasChildNodes()||node.firstChild===node.lastChild&&""===node.firstChild.nodeValue?dom.remove(node):isEmptyAnchor(dom,node)&&dom.remove(node)}}(dom,nonEmptyElementsMap,newBlock),function(dom,block){var lastChild;block.normalize(),(lastChild=block.lastChild)&&!/^(left|right)$/gi.test(dom.getStyle(lastChild,"float",!0))||dom.add(block,"br")}(dom,parentBlock),dom.isEmpty(parentBlock)&&emptyBlock(parentBlock),newBlock.normalize(),dom.isEmpty(newBlock)?(dom.remove(newBlock),insertNewBlockAfter()):(setForcedBlockAttrs(editor,newBlock),NewLineUtils_moveToCaretPosition(editor,newBlock))),dom.setAttrib(newBlock,"id",""),editor.fire("NewBlock",{newBlock:newBlock})))},hasBrAfter=function(rootNode,startNode){return!!function(pos){return NodeType.isBr(pos.getNode())}(CaretPosition$1.after(startNode))||CaretFinder.nextPosition(rootNode,CaretPosition$1.after(startNode)).map(function(pos){return NodeType.isBr(pos.getNode())}).getOr(!1)},InsertBr_insert=function(editor,evt){var anchorLocation=function(editor){var isInlineTarget=curry(InlineUtils.isInlineTarget,editor),position=CaretPosition$1.fromRangeStart(editor.selection.getRng());return BoundaryLocation_readLocation(isInlineTarget,editor.getBody(),position).filter(isInsideAnchor)}(editor);anchorLocation.isSome()?anchorLocation.each(curry(insertBrOutsideAnchor,editor)):insertBrAtCaret(editor,evt)},ContextSelectors_shouldInsertBr=function(editor){return matchesSelector(editor,Settings_getBrNewLineSelector(editor))},ContextSelectors_shouldBlockNewLine=function(editor){return matchesSelector(editor,Settings_getNoNewLineSelector(editor))},newLineAction=Adt_generate([{br:[]},{block:[]},{none:[]}]),NewLineAction_getAction=function(editor,evt){return LazyEvaluator_evaluateUntil([match$2([shouldBlockNewLine$1],newLineAction.none()),match$2([inBlock("summary",!0)],newLineAction.br()),match$2([inPreBlock(!0),shouldPutBrInPre$1(!1),hasShiftKey],newLineAction.br()),match$2([inPreBlock(!0),shouldPutBrInPre$1(!1)],newLineAction.block()),match$2([inPreBlock(!0),shouldPutBrInPre$1(!0),hasShiftKey],newLineAction.block()),match$2([inPreBlock(!0),shouldPutBrInPre$1(!0)],newLineAction.br()),match$2([inListBlock(!0),hasShiftKey],newLineAction.br()),match$2([inListBlock(!0)],newLineAction.block()),match$2([isBrMode(!0),hasShiftKey,canInsertIntoEditableRoot],newLineAction.block()),match$2([isBrMode(!0)],newLineAction.br()),match$2([inBrContext],newLineAction.br()),match$2([isBrMode(!1),hasShiftKey],newLineAction.br()),match$2([canInsertIntoEditableRoot],newLineAction.block())],[editor,!(!evt||!evt.shiftKey)]).getOr(newLineAction.none())},InsertNewLine_insert=function(editor,evt){NewLineAction_getAction(editor,evt).fold(function(){InsertBr_insert(editor,evt)},function(){InsertBlock_insert(editor,evt)},noop)},EnterKey_setup=function(editor){editor.on("keydown",function(event){event.keyCode===VK.ENTER&&function(editor,event){event.isDefaultPrevented()||(event.preventDefault(),function(undoManager){undoManager.typing&&(undoManager.typing=!1,undoManager.add())}(editor.undoManager),editor.undoManager.transact(function(){!1===editor.selection.isCollapsed()&&editor.execCommand("Delete"),InsertNewLine_insert(editor,event)}))}(editor,event)})},insertNbspAtPosition=curry(insertTextAtPosition,""),insertSpaceAtPosition=curry(insertTextAtPosition," "),SpaceKey_setup=function(editor){editor.on("keydown",function(evt){!1===evt.isDefaultPrevented()&&function(editor,evt){MatchKeys_execute([{keyCode:VK.SPACEBAR,action:MatchKeys_action(insertSpaceOrNbspAtSelection,editor)}],evt).each(function(_){evt.preventDefault()})}(editor,evt)})},CaretContainerInput_setup=function(editor){editor.on("keyup compositionstart",curry(handleBlockContainer,editor))},browser$5=detect$3().browser,HomeEndKeys_setup=function(editor){editor.on("keydown",function(evt){!1===evt.isDefaultPrevented()&&function(editor,evt){MatchKeys_execute([{keyCode:VK.END,action:moveToLineEndPoint(editor,!0)},{keyCode:VK.HOME,action:moveToLineEndPoint(editor,!1)}],evt).each(function(_){evt.preventDefault()})}(editor,evt)})},KeyboardOverrides_setup=function(editor){var caret=BoundarySelection.setupSelectedState(editor);CaretContainerInput_setup(editor),ArrowKeys_setup(editor,caret),DeleteBackspaceKeys_setup(editor,caret),EnterKey_setup(editor),SpaceKey_setup(editor),setup$e(editor),HomeEndKeys_setup(editor)},NodeChange=function(){function NodeChange(editor){var lastRng;this.lastPath=[],this.editor=editor;var self=this;"onselectionchange"in editor.getDoc()||editor.on("NodeChange click mouseup keyup focus",function(e){var nativeRng,fakeRng;fakeRng={startContainer:(nativeRng=editor.selection.getRng()).startContainer,startOffset:nativeRng.startOffset,endContainer:nativeRng.endContainer,endOffset:nativeRng.endOffset},"nodechange"!==e.type&&RangeCompare_isEq(fakeRng,lastRng)||editor.fire("SelectionChange"),lastRng=fakeRng}),editor.on("contextmenu",function(){editor.fire("SelectionChange")}),editor.on("SelectionChange",function(){var startElm=editor.selection.getStart(!0);!startElm||!Env.range&&editor.selection.isCollapsed()||hasAnyRanges(editor)&&!self.isSameElementPath(startElm)&&editor.dom.isChildOf(startElm,editor.getBody())&&editor.nodeChanged({selectionChange:!0})}),editor.on("mouseup",function(e){!e.isDefaultPrevented()&&hasAnyRanges(editor)&&("IMG"===editor.selection.getNode().nodeName?Delay.setEditorTimeout(editor,function(){editor.nodeChanged()}):editor.nodeChanged())})}return NodeChange.prototype.nodeChanged=function(args){var node,parents,root,selection=this.editor.selection;this.editor.initialized&&selection&&!this.editor.settings.disable_nodechange&&!this.editor.mode.isReadOnly()&&(root=this.editor.getBody(),(node=selection.getStart(!0)||root).ownerDocument===this.editor.getDoc()&&this.editor.dom.isChildOf(node,root)||(node=root),parents=[],this.editor.dom.getParent(node,function(node){if(node===root)return!0;parents.push(node)}),(args=args||{}).element=node,args.parents=parents,this.editor.fire("NodeChange",args))},NodeChange.prototype.isSameElementPath=function(startElm){var i,currentPath;if((currentPath=this.editor.$(startElm).parentsUntil(this.editor.getBody()).add(startElm)).length===this.lastPath.length){for(i=currentPath.length;0<=i&&currentPath[i]===this.lastPath[i];i--);if(-1===i)return this.lastPath=currentPath,!0}return this.lastPath=currentPath,!1},NodeChange}(),MousePosition_calc=function(editor,event){return function(bodyPosition,scrollPosition,mousePosition){return{pageX:mousePosition.left-bodyPosition.left+scrollPosition.left,pageY:mousePosition.top-bodyPosition.top+scrollPosition.top}}(function(editor){return editor.inline?getAbsolutePosition(editor.getBody()):{left:0,top:0}}(editor),function(editor){var body=editor.getBody();return editor.inline?{left:body.scrollLeft,top:body.scrollTop}:{left:0,top:0}}(editor),function(editor,event){if(event.target.ownerDocument===editor.getDoc())return{left:event.pageX,top:event.pageY};var iframePosition=getAbsolutePosition(editor.getContentAreaContainer()),scrollPosition=function(editor){var body=editor.getBody(),docElm=editor.getDoc().documentElement,inlineScroll={left:body.scrollLeft,top:body.scrollTop},iframeScroll={left:body.scrollLeft||docElm.scrollLeft,top:body.scrollTop||docElm.scrollTop};return editor.inline?inlineScroll:iframeScroll}(editor);return{left:event.pageX-iframePosition.left+scrollPosition.left,top:event.pageY-iframePosition.top+scrollPosition.top}}(editor,event))},isContentEditableFalse$a=NodeType.isContentEditableFalse,isContentEditableTrue$4=NodeType.isContentEditableTrue,removeDragState=function(state){state.dragging=!1,state.element=null,removeElement(state.ghost)},DragDropOverrides_init=function(editor){bindFakeDragEvents(editor),function(editor){editor.on("drop",function(e){var realTarget=void 0!==e.clientX?editor.getDoc().elementFromPoint(e.clientX,e.clientY):null;(isContentEditableFalse$a(realTarget)||isContentEditableFalse$a(editor.dom.getContentEditableParent(realTarget)))&&e.preventDefault()})}(editor)},CefFocus_setup=function(editor){var renderFocusCaret=first(function(){if(!editor.removed&&editor.getBody().contains(domGlobals.document.activeElement)&&editor.selection.getRng().collapsed){var caretRange=renderRangeCaret(editor,editor.selection.getRng(),!1);editor.selection.setRng(caretRange)}},0);editor.on("focus",function(){renderFocusCaret.throttle()}),editor.on("blur",function(){renderFocusCaret.cancel()})},isContentEditableTrue$5=NodeType.isContentEditableTrue,isContentEditableFalse$b=NodeType.isContentEditableFalse,DOM$4=DOMUtils$1.DOM,InitContentBody_initContentBody=function(editor,skipWrite){var body,contentCssText,settings=editor.settings,targetElm=editor.getElement(),doc=editor.getDoc();settings.inline||(editor.getElement().style.visibility=editor.orgVisibility),skipWrite||editor.inline||(doc.open(),doc.write(editor.iframeHTML),doc.close()),editor.inline&&(editor.on("remove",function(){var bodyEl=this.getBody();DOM$4.removeClass(bodyEl,"mce-content-body"),DOM$4.removeClass(bodyEl,"mce-edit-focus"),DOM$4.setAttrib(bodyEl,"contentEditable",null)}),DOM$4.addClass(targetElm,"mce-content-body"),editor.contentDocument=doc=domGlobals.document,editor.contentWindow=domGlobals.window,editor.bodyElement=targetElm,editor.contentAreaContainer=targetElm,settings.root_name=targetElm.nodeName.toLowerCase()),(body=editor.getBody()).disabled=!0,editor.readonly=!!settings.readonly,editor.readonly||(editor.inline&&"static"===DOM$4.getStyle(body,"position",!0)&&(body.style.position="relative"),body.contentEditable=editor.getParam("content_editable_state",!0)),body.disabled=!1,editor.editorUpload=EditorUpload(editor),editor.schema=Schema(settings),editor.dom=DOMUtils$1(doc,{keep_values:!0,url_converter:editor.convertURL,url_converter_scope:editor,hex_colors:settings.force_hex_style_colors,update_styles:!0,root_element:editor.inline?editor.getBody():null,collect:function(){return editor.inline},schema:editor.schema,contentCssCors:Settings_shouldUseContentCssCors(editor),referrerPolicy:Settings_getReferrerPolicy(editor),onSetAttrib:function(e){editor.fire("SetAttrib",e)}}),editor.parser=function(editor){var parser=DomParser(editor.settings,editor.schema);return parser.addAttributeFilter("src,href,style,tabindex",function(nodes,name){for(var node,value,i=nodes.length,dom=editor.dom,internalName="data-mce-"+name;i--;)if((value=(node=nodes[i]).attr(name))&&!node.attr(internalName)){if(0===value.indexOf("data:")||0===value.indexOf("blob:"))continue;"style"===name?((value=dom.serializeStyle(dom.parseStyle(value),node.name)).length||(value=null),node.attr(internalName,value),node.attr(name,value)):"tabindex"===name?(node.attr(internalName,value),node.attr(name,null)):node.attr(internalName,editor.convertURL(value,name,node.name))}}),parser.addNodeFilter("script",function(nodes){for(var node,type,i=nodes.length;i--;)0!==(type=(node=nodes[i]).attr("type")||"no/type").indexOf("mce-")&&node.attr("type","mce-"+type)}),editor.settings.preserve_cdata&&parser.addNodeFilter("#cdata",function(nodes){for(var node,i=nodes.length;i--;)(node=nodes[i]).type=8,node.name="#comment",node.value="[CDATA["+editor.dom.encode(node.value)+"]]"}),parser.addNodeFilter("p,h1,h2,h3,h4,h5,h6,div",function(nodes){for(var node,i=nodes.length,nonEmptyElements=editor.schema.getNonEmptyElements();i--;)(node=nodes[i]).isEmpty(nonEmptyElements)&&0===node.getAll("br").length&&(node.append(new Node$1("br",1)).shortEnded=!0)}),parser}(editor),editor.serializer=Serializer$1(settings,editor),editor.selection=Selection$1(editor.dom,editor.getWin(),editor.serializer,editor),editor.annotator=Annotator(editor),editor.formatter=Formatter(editor),editor.undoManager=UndoManager(editor),editor._nodeChangeDispatcher=new NodeChange(editor),editor._selectionOverrides=SelectionOverrides(editor),TouchEvents_setup(editor),setup$h(editor),setup$i(editor),KeyboardOverrides_setup(editor),ForceBlocks_setup(editor),setup$6(editor),function(editor){editor.fire("PreInit")}(editor),settings.browser_spellcheck||settings.gecko_spellcheck||(doc.body.spellcheck=!1,DOM$4.setAttrib(body,"spellcheck","false")),editor.quirks=Quirks(editor),function(editor){editor.fire("PostRender")}(editor);var directionality=Settings_getDirectionality(editor);void 0!==directionality&&(body.dir=directionality),settings.protect&&editor.on("BeforeSetContent",function(e){Tools.each(settings.protect,function(pattern){e.content=e.content.replace(pattern,function(str){return"\x3c!--mce:protected "+escape(str)+"--\x3e"})})}),editor.on("SetContent",function(){editor.addVisual(editor.getBody())}),editor.load({initial:!0,format:"html"}),editor.startContent=editor.getContent({format:"raw"}),editor.on("compositionstart compositionend",function(e){editor.composing="compositionstart"===e.type}),0<editor.contentStyles.length&&(contentCssText="",Tools.each(editor.contentStyles,function(style){contentCssText+=style+"\r\n"}),editor.dom.addStyle(contentCssText)),function(editor){return editor.inline?DOM$4.styleSheetLoader:editor.dom.styleSheetLoader}(editor).loadAll(editor.contentCSS,function(_){initEditor(editor)},function(urls){initEditor(editor)}),settings.content_style&&function(editor,text){var head=Element.fromDom(editor.getDoc().head),tag=Element.fromTag("style");set(tag,"type","text/css"),append(tag,Element.fromText(text)),append(head,tag)}(editor,settings.content_style)},DOM$5=DOMUtils$1.DOM,InitIframe_init=function(editor,boxInfo){var isDomainRelaxed=createIframe(editor,boxInfo);boxInfo.editorContainer&&(DOM$5.get(boxInfo.editorContainer).style.display=editor.orgDisplay,editor.hidden=DOM$5.isHidden(boxInfo.editorContainer)),editor.getElement().style.display="none",DOM$5.setAttrib(editor.id,"aria-hidden","true"),isDomainRelaxed||InitContentBody_initContentBody(editor)},DOM$6=DOMUtils$1.DOM,initPlugin=function(editor,initializedPlugins,plugin){var Plugin=PluginManager.get(plugin),pluginUrl=PluginManager.urls[plugin]||editor.documentBaseUrl.replace(/\/$/,"");if(plugin=Tools.trim(plugin),Plugin&&-1===Tools.inArray(initializedPlugins,plugin)){if(Tools.each(PluginManager.dependencies(plugin),function(dep){initPlugin(editor,initializedPlugins,dep)}),editor.plugins[plugin])return;try{var pluginInstance=new Plugin(editor,pluginUrl,editor.$);(editor.plugins[plugin]=pluginInstance).init&&(pluginInstance.init(editor,pluginUrl),initializedPlugins.push(plugin))}catch(e){ErrorReporter.pluginInitError(editor,plugin,e)}}},Init_init=function(editor){editor.fire("ScriptsLoaded"),function(editor){var iconPackName=Tools.trim(editor.settings.icons),currentIcons=editor.ui.registry.getAll().icons,loadIcons=__assign(__assign({},{"accessibility-check":'<svg width="24" height="24"><path d="M12 2a2 2 0 0 1 2 2 2 2 0 0 1-2 2 2 2 0 0 1-2-2c0-1.1.9-2 2-2zm8 7h-5v12c0 .6-.4 1-1 1a1 1 0 0 1-1-1v-5c0-.6-.4-1-1-1a1 1 0 0 0-1 1v5c0 .6-.4 1-1 1a1 1 0 0 1-1-1V9H4a1 1 0 1 1 0-2h16c.6 0 1 .4 1 1s-.4 1-1 1z" fill-rule="nonzero"/></svg>',"action-next":'<svg width="24" height="24"><path fill-rule="nonzero" d="M5.7 7.3a1 1 0 0 0-1.4 1.4l7.7 7.7 7.7-7.7a1 1 0 1 0-1.4-1.4L12 13.6 5.7 7.3z"/></svg>',"action-prev":'<svg width="24" height="24"><path fill-rule="nonzero" d="M18.3 15.7a1 1 0 0 0 1.4-1.4L12 6.6l-7.7 7.7a1 1 0 0 0 1.4 1.4L12 9.4l6.3 6.3z"/></svg>',"align-center":'<svg width="24" height="24"><path d="M5 5h14c.6 0 1 .4 1 1s-.4 1-1 1H5a1 1 0 1 1 0-2zm3 4h8c.6 0 1 .4 1 1s-.4 1-1 1H8a1 1 0 1 1 0-2zm0 8h8c.6 0 1 .4 1 1s-.4 1-1 1H8a1 1 0 0 1 0-2zm-3-4h14c.6 0 1 .4 1 1s-.4 1-1 1H5a1 1 0 0 1 0-2z" fill-rule="evenodd"/></svg>',"align-justify":'<svg width="24" height="24"><path d="M5 5h14c.6 0 1 .4 1 1s-.4 1-1 1H5a1 1 0 1 1 0-2zm0 4h14c.6 0 1 .4 1 1s-.4 1-1 1H5a1 1 0 1 1 0-2zm0 4h14c.6 0 1 .4 1 1s-.4 1-1 1H5a1 1 0 0 1 0-2zm0 4h14c.6 0 1 .4 1 1s-.4 1-1 1H5a1 1 0 0 1 0-2z" fill-rule="evenodd"/></svg>',"align-left":'<svg width="24" height="24"><path d="M5 5h14c.6 0 1 .4 1 1s-.4 1-1 1H5a1 1 0 1 1 0-2zm0 4h8c.6 0 1 .4 1 1s-.4 1-1 1H5a1 1 0 1 1 0-2zm0 8h8c.6 0 1 .4 1 1s-.4 1-1 1H5a1 1 0 0 1 0-2zm0-4h14c.6 0 1 .4 1 1s-.4 1-1 1H5a1 1 0 0 1 0-2z" fill-rule="evenodd"/></svg>',"align-none":'<svg width="24" height="24"><path d="M14.2 5L13 7H5a1 1 0 1 1 0-2h9.2zm4 0h.8a1 1 0 0 1 0 2h-2l1.2-2zm-6.4 4l-1.2 2H5a1 1 0 0 1 0-2h6.8zm4 0H19a1 1 0 0 1 0 2h-4.4l1.2-2zm-6.4 4l-1.2 2H5a1 1 0 0 1 0-2h4.4zm4 0H19a1 1 0 0 1 0 2h-6.8l1.2-2zM7 17l-1.2 2H5a1 1 0 0 1 0-2h2zm4 0h8a1 1 0 0 1 0 2H9.8l1.2-2zm5.2-13.5l1.3.7-9.7 16.3-1.3-.7 9.7-16.3z" fill-rule="evenodd"/></svg>',"align-right":'<svg width="24" height="24"><path d="M5 5h14c.6 0 1 .4 1 1s-.4 1-1 1H5a1 1 0 1 1 0-2zm6 4h8c.6 0 1 .4 1 1s-.4 1-1 1h-8a1 1 0 0 1 0-2zm0 8h8c.6 0 1 .4 1 1s-.4 1-1 1h-8a1 1 0 0 1 0-2zm-6-4h14c.6 0 1 .4 1 1s-.4 1-1 1H5a1 1 0 0 1 0-2z" fill-rule="evenodd"/></svg>',"arrow-left":'<svg width="24" height="24"><path d="M5.6 13l12 6a1 1 0 0 0 1.4-1V6a1 1 0 0 0-1.4-.9l-12 6a1 1 0 0 0 0 1.8z" fill-rule="evenodd"/></svg>',"arrow-right":'<svg width="24" height="24"><path d="M18.5 13l-12 6A1 1 0 0 1 5 18V6a1 1 0 0 1 1.4-.9l12 6a1 1 0 0 1 0 1.8z" fill-rule="evenodd"/></svg>',bold:'<svg width="24" height="24"><path d="M7.8 19c-.3 0-.5 0-.6-.2l-.2-.5V5.7c0-.2 0-.4.2-.5l.6-.2h5c1.5 0 2.7.3 3.5 1 .7.6 1.1 1.4 1.1 2.5a3 3 0 0 1-.6 1.9c-.4.6-1 1-1.6 1.2.4.1.9.3 1.3.6s.8.7 1 1.2c.4.4.5 1 .5 1.6 0 1.3-.4 2.3-1.3 3-.8.7-2.1 1-3.8 1H7.8zm5-8.3c.6 0 1.2-.1 1.6-.5.4-.3.6-.7.6-1.3 0-1.1-.8-1.7-2.3-1.7H9.3v3.5h3.4zm.5 6c.7 0 1.3-.1 1.7-.4.4-.4.6-.9.6-1.5s-.2-1-.7-1.4c-.4-.3-1-.4-2-.4H9.4v3.8h4z" fill-rule="evenodd"/></svg>',bookmark:'<svg width="24" height="24"><path d="M6 4v17l6-4 6 4V4c0-.6-.4-1-1-1H7a1 1 0 0 0-1 1z" fill-rule="nonzero"/></svg>',"border-width":'<svg width="24" height="24"><path d="M5 14.8h14a1 1 0 0 1 0 2H5a1 1 0 0 1 0-2zm-.5 3.7h15c.3 0 .5.2.5.5s-.2.5-.5.5h-15a.5.5 0 1 1 0-1zm.5-8.3h14c.6 0 1 .4 1 1v1c0 .5-.4 1-1 1H5a1 1 0 0 1-1-1v-1c0-.6.4-1 1-1zm0-5.7h14c.6 0 1 .4 1 1v2c0 .6-.4 1-1 1H5a1 1 0 0 1-1-1v-2c0-.6.4-1 1-1z" fill-rule="evenodd"/></svg>',brightness:'<svg width="24" height="24"><path d="M12 17c.3 0 .5.1.7.3.2.2.3.4.3.7v1c0 .3-.1.5-.3.7a1 1 0 0 1-.7.3 1 1 0 0 1-.7-.3 1 1 0 0 1-.3-.7v-1c0-.3.1-.5.3-.7.2-.2.4-.3.7-.3zm0-10a1 1 0 0 1-.7-.3A1 1 0 0 1 11 6V5c0-.3.1-.5.3-.7.2-.2.4-.3.7-.3.3 0 .5.1.7.3.2.2.3.4.3.7v1c0 .3-.1.5-.3.7a1 1 0 0 1-.7.3zm7 4c.3 0 .5.1.7.3.2.2.3.4.3.7 0 .3-.1.5-.3.7a1 1 0 0 1-.7.3h-1a1 1 0 0 1-.7-.3 1 1 0 0 1-.3-.7c0-.3.1-.5.3-.7.2-.2.4-.3.7-.3h1zM7 12c0 .3-.1.5-.3.7a1 1 0 0 1-.7.3H5a1 1 0 0 1-.7-.3A1 1 0 0 1 4 12c0-.3.1-.5.3-.7.2-.2.4-.3.7-.3h1c.3 0 .5.1.7.3.2.2.3.4.3.7zm10 3.5l.7.8c.2.1.3.4.3.6 0 .3-.1.6-.3.8a1 1 0 0 1-.8.3 1 1 0 0 1-.6-.3l-.8-.7a1 1 0 0 1-.3-.8c0-.2.1-.5.3-.7a1 1 0 0 1 1.4 0zm-10-7l-.7-.8a1 1 0 0 1-.3-.6c0-.3.1-.6.3-.8.2-.2.5-.3.8-.3.2 0 .5.1.7.3l.7.7c.2.2.3.5.3.8 0 .2-.1.5-.3.7a1 1 0 0 1-.7.3 1 1 0 0 1-.8-.3zm10 0a1 1 0 0 1-.8.3 1 1 0 0 1-.7-.3 1 1 0 0 1-.3-.7c0-.3.1-.6.3-.8l.8-.7c.1-.2.4-.3.6-.3.3 0 .6.1.8.3.2.2.3.5.3.8 0 .2-.1.5-.3.7l-.7.7zm-10 7c.2-.2.5-.3.8-.3.2 0 .5.1.7.3a1 1 0 0 1 0 1.4l-.8.8a1 1 0 0 1-.6.3 1 1 0 0 1-.8-.3 1 1 0 0 1-.3-.8c0-.2.1-.5.3-.6l.7-.8zM12 8a4 4 0 0 1 3.7 2.4 4 4 0 0 1 0 3.2A4 4 0 0 1 12 16a4 4 0 0 1-3.7-2.4 4 4 0 0 1 0-3.2A4 4 0 0 1 12 8zm0 6.5c.7 0 1.3-.2 1.8-.7.5-.5.7-1.1.7-1.8s-.2-1.3-.7-1.8c-.5-.5-1.1-.7-1.8-.7s-1.3.2-1.8.7c-.5.5-.7 1.1-.7 1.8s.2 1.3.7 1.8c.5.5 1.1.7 1.8.7z" fill-rule="evenodd"/></svg>',browse:'<svg width="24" height="24"><path d="M19 4a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2h-4v-2h4V8H5v10h4v2H5a2 2 0 0 1-2-2V6c0-1.1.9-2 2-2h14zm-8 9.4l-2.3 2.3a1 1 0 1 1-1.4-1.4l4-4a1 1 0 0 1 1.4 0l4 4a1 1 0 0 1-1.4 1.4L13 13.4V20a1 1 0 0 1-2 0v-6.6z" fill-rule="nonzero"/></svg>',cancel:'<svg width="24" height="24"><path d="M12 4.6a7.4 7.4 0 1 1 0 14.8 7.4 7.4 0 0 1 0-14.8zM12 3a9 9 0 1 0 0 18 9 9 0 0 0 0-18zm0 8L14.8 8l1 1.1-2.7 2.8 2.7 2.7-1.1 1.1-2.7-2.7-2.7 2.7-1-1.1 2.6-2.7-2.7-2.7 1-1.1 2.8 2.7z" fill-rule="nonzero"/></svg>',"change-case":'<svg width="24" height="24"><path d="M18.4 18.2v-.6c-.5.8-1.3 1.2-2.4 1.2-2.2 0-3.3-1.6-3.3-4.8 0-3.1 1-4.7 3.3-4.7 1.1 0 1.8.3 2.4 1.1v-.6c0-.5.4-.8.8-.8s.8.3.8.8v8.4c0 .5-.4.8-.8.8a.8.8 0 0 1-.8-.8zm-2-7.4c-1.3 0-1.8.9-1.8 3.2 0 2.4.5 3.3 1.7 3.3 1.3 0 1.8-.9 1.8-3.2 0-2.4-.5-3.3-1.7-3.3zM10 15.7H5.5l-.8 2.6a1 1 0 0 1-1 .7h-.2a.7.7 0 0 1-.7-1l4-12a1 1 0 1 1 2 0l4 12a.7.7 0 0 1-.8 1h-.2a1 1 0 0 1-1-.7l-.8-2.6zm-.3-1.5l-2-6.5-1.9 6.5h3.9z" fill-rule="evenodd"/></svg>',"character-count":'<svg width="24" height="24"><path d="M4 11.5h16v1H4v-1zm4.8-6.8V10H7.7V5.8h-1v-1h2zM11 8.3V9h2v1h-3V7.7l2-1v-.9h-2v-1h3v2.4l-2 1zm6.3-3.4V10h-3.1V9h2.1V8h-2.1V6.8h2.1v-1h-2.1v-1h3.1zM5.8 16.4c0-.5.2-.8.5-1 .2-.2.6-.3 1.2-.3l.8.1c.2 0 .4.2.5.3l.4.4v2.8l.2.3H8.2v-.1-.2l-.6.3H7c-.4 0-.7 0-1-.2a1 1 0 0 1-.3-.9c0-.3 0-.6.3-.8.3-.2.7-.4 1.2-.4l.6-.2h.3v-.2l-.1-.2a.8.8 0 0 0-.5-.1 1 1 0 0 0-.4 0l-.3.4h-1zm2.3.8h-.2l-.2.1-.4.1a1 1 0 0 0-.4.2l-.2.2.1.3.5.1h.4l.4-.4v-.6zm2-3.4h1.2v1.7l.5-.3h.5c.5 0 .9.1 1.2.5.3.4.5.8.5 1.4 0 .6-.2 1.1-.5 1.5-.3.4-.7.6-1.3.6l-.6-.1-.4-.4v.4h-1.1v-5.4zm1.1 3.3c0 .3 0 .6.2.8a.7.7 0 0 0 1.2 0l.2-.8c0-.4 0-.6-.2-.8a.7.7 0 0 0-.6-.3l-.6.3-.2.8zm6.1-.5c0-.2 0-.3-.2-.4a.8.8 0 0 0-.5-.2c-.3 0-.5.1-.6.3l-.2.9c0 .3 0 .6.2.8.1.2.3.3.6.3.2 0 .4 0 .5-.2l.2-.4h1.1c0 .5-.3.8-.6 1.1a2 2 0 0 1-1.3.4c-.5 0-1-.2-1.3-.6a2 2 0 0 1-.5-1.4c0-.6.1-1.1.5-1.5.3-.4.8-.5 1.4-.5.5 0 1 0 1.2.3.4.3.5.7.5 1.2h-1v-.1z" fill-rule="evenodd"/></svg>',"checklist-rtl":'<svg width="24" height="24"><path d="M5 17h8c.6 0 1 .4 1 1s-.4 1-1 1H5a1 1 0 0 1 0-2zm0-6h8c.6 0 1 .4 1 1s-.4 1-1 1H5a1 1 0 0 1 0-2zm0-6h8c.6 0 1 .4 1 1s-.4 1-1 1H5a1 1 0 1 1 0-2zm14.2 11c.2-.4.6-.5.9-.3.3.2.4.6.2 1L18 20c-.2.3-.7.4-1 0l-1.3-1.3a.7.7 0 0 1 0-1c.3-.2.7-.2 1 0l.7.9 1.7-2.8zm0-6c.2-.4.6-.5.9-.3.3.2.4.6.2 1L18 14c-.2.3-.7.4-1 0l-1.3-1.3a.7.7 0 0 1 0-1c.3-.2.7-.2 1 0l.7.9 1.7-2.8zm0-6c.2-.4.6-.5.9-.3.3.2.4.6.2 1L18 8c-.2.3-.7.4-1 0l-1.3-1.3a.7.7 0 0 1 0-1c.3-.2.7-.2 1 0l.7.9 1.7-2.8z" fill-rule="evenodd"/></svg>',checklist:'<svg width="24" height="24"><path d="M11 17h8c.6 0 1 .4 1 1s-.4 1-1 1h-8a1 1 0 0 1 0-2zm0-6h8c.6 0 1 .4 1 1s-.4 1-1 1h-8a1 1 0 0 1 0-2zm0-6h8a1 1 0 0 1 0 2h-8a1 1 0 0 1 0-2zM7.2 16c.2-.4.6-.5.9-.3.3.2.4.6.2 1L6 20c-.2.3-.7.4-1 0l-1.3-1.3a.7.7 0 0 1 0-1c.3-.2.7-.2 1 0l.7.9 1.7-2.8zm0-6c.2-.4.6-.5.9-.3.3.2.4.6.2 1L6 14c-.2.3-.7.4-1 0l-1.3-1.3a.7.7 0 0 1 0-1c.3-.2.7-.2 1 0l.7.9 1.7-2.8zm0-6c.2-.4.6-.5.9-.3.3.2.4.6.2 1L6 8c-.2.3-.7.4-1 0L3.8 6.9a.7.7 0 0 1 0-1c.3-.2.7-.2 1 0l.7.9 1.7-2.8z" fill-rule="evenodd"/></svg>',checkmark:'<svg width="24" height="24"><path d="M18.2 5.4a1 1 0 0 1 1.6 1.2l-8 12a1 1 0 0 1-1.5.1l-5-5a1 1 0 1 1 1.4-1.4l4.1 4.1 7.4-11z" fill-rule="nonzero"/></svg>',"chevron-down":'<svg width="10" height="10"><path d="M8.7 2.2c.3-.3.8-.3 1 0 .4.4.4.9 0 1.2L5.7 7.8c-.3.3-.9.3-1.2 0L.2 3.4a.8.8 0 0 1 0-1.2c.3-.3.8-.3 1.1 0L5 6l3.7-3.8z" fill-rule="nonzero"/></svg>',"chevron-left":'<svg width="10" height="10"><path d="M7.8 1.3L4 5l3.8 3.7c.3.3.3.8 0 1-.4.4-.9.4-1.2 0L2.2 5.7a.8.8 0 0 1 0-1.2L6.6.2C7 0 7.4 0 7.8.2c.3.3.3.8 0 1.1z" fill-rule="nonzero"/></svg>',"chevron-right":'<svg width="10" height="10"><path d="M2.2 1.3a.8.8 0 0 1 0-1c.4-.4.9-.4 1.2 0l4.4 4.1c.3.4.3.9 0 1.2L3.4 9.8c-.3.3-.8.3-1.2 0a.8.8 0 0 1 0-1.1L6 5 2.2 1.3z" fill-rule="nonzero"/></svg>',"chevron-up":'<svg width="10" height="10"><path d="M8.7 7.8L5 4 1.3 7.8c-.3.3-.8.3-1 0a.8.8 0 0 1 0-1.2l4.1-4.4c.3-.3.9-.3 1.2 0l4.2 4.4c.3.3.3.9 0 1.2-.3.3-.8.3-1.1 0z" fill-rule="nonzero"/></svg>',close:'<svg width="24" height="24"><path d="M17.3 8.2L13.4 12l3.9 3.8a1 1 0 0 1-1.5 1.5L12 13.4l-3.8 3.9a1 1 0 0 1-1.5-1.5l3.9-3.8-3.9-3.8a1 1 0 0 1 1.5-1.5l3.8 3.9 3.8-3.9a1 1 0 0 1 1.5 1.5z" fill-rule="evenodd"/></svg>',"code-sample":'<svg width="24" height="26"><path d="M7.1 11a2.8 2.8 0 0 1-.8 2 2.8 2.8 0 0 1 .8 2v1.7c0 .3.1.6.4.8.2.3.5.4.8.4.3 0 .4.2.4.4v.8c0 .2-.1.4-.4.4-.7 0-1.4-.3-2-.8-.5-.6-.8-1.3-.8-2V15c0-.3-.1-.6-.4-.8-.2-.3-.5-.4-.8-.4a.4.4 0 0 1-.4-.4v-.8c0-.2.2-.4.4-.4.3 0 .6-.1.8-.4.3-.2.4-.5.4-.8V9.3c0-.7.3-1.4.8-2 .6-.5 1.3-.8 2-.8.3 0 .4.2.4.4v.8c0 .2-.1.4-.4.4-.3 0-.6.1-.8.4-.3.2-.4.5-.4.8V11zm9.8 0V9.3c0-.3-.1-.6-.4-.8-.2-.3-.5-.4-.8-.4a.4.4 0 0 1-.4-.4V7c0-.2.1-.4.4-.4.7 0 1.4.3 2 .8.5.6.8 1.3.8 2V11c0 .3.1.6.4.8.2.3.5.4.8.4.2 0 .4.2.4.4v.8c0 .2-.2.4-.4.4-.3 0-.6.1-.8.4-.3.2-.4.5-.4.8v1.7c0 .7-.3 1.4-.8 2-.6.5-1.3.8-2 .8a.4.4 0 0 1-.4-.4v-.8c0-.2.1-.4.4-.4.3 0 .6-.1.8-.4.3-.2.4-.5.4-.8V15a2.8 2.8 0 0 1 .8-2 2.8 2.8 0 0 1-.8-2zm-3.3-.4c0 .4-.1.8-.5 1.1-.3.3-.7.5-1.1.5-.4 0-.8-.2-1.1-.5-.4-.3-.5-.7-.5-1.1 0-.5.1-.9.5-1.2.3-.3.7-.4 1.1-.4.4 0 .8.1 1.1.4.4.3.5.7.5 1.2zM12 13c.4 0 .8.1 1.1.5.4.3.5.7.5 1.1 0 1-.1 1.6-.5 2a3 3 0 0 1-1.1 1c-.4.3-.8.4-1.1.4a.5.5 0 0 1-.5-.5V17a3 3 0 0 0 1-.2l.6-.6c-.6 0-1-.2-1.3-.5-.2-.3-.3-.7-.3-1 0-.5.1-1 .5-1.2.3-.4.7-.5 1.1-.5z" fill-rule="evenodd"/></svg>',"color-levels":'<svg width="24" height="24"><path d="M17.5 11.4A9 9 0 0 1 18 14c0 .5 0 1-.2 1.4 0 .4-.3.9-.5 1.3a6.2 6.2 0 0 1-3.7 3 5.7 5.7 0 0 1-3.2 0A5.9 5.9 0 0 1 7.6 18a6.2 6.2 0 0 1-1.4-2.6 6.7 6.7 0 0 1 0-2.8c0-.4.1-.9.3-1.3a13.6 13.6 0 0 1 2.3-4A20 20 0 0 1 12 4a26.4 26.4 0 0 1 3.2 3.4 18.2 18.2 0 0 1 2.3 4zm-2 4.5c.4-.7.5-1.4.5-2a7.3 7.3 0 0 0-1-3.2c.2.6.2 1.2.2 1.9a4.5 4.5 0 0 1-1.3 3 5.3 5.3 0 0 1-2.3 1.5 4.9 4.9 0 0 1-2 .1 4.3 4.3 0 0 0 2.4.8 4 4 0 0 0 2-.6 4 4 0 0 0 1.5-1.5z" fill-rule="evenodd"/></svg>',"color-picker":'<svg width="24" height="24"><path d="M12 3a9 9 0 0 0 0 18 1.5 1.5 0 0 0 1.1-2.5c-.2-.3-.4-.6-.4-1 0-.8.7-1.5 1.5-1.5H16a5 5 0 0 0 5-5c0-4.4-4-8-9-8zm-5.5 9a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3zm3-4a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3zm5 0a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3zm3 4a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3z" fill-rule="nonzero"/></svg>',"color-swatch-remove-color":'<svg width="24" height="24"><path stroke="#000" stroke-width="2" d="M21 3L3 21" fill-rule="evenodd"/></svg>',"color-swatch":'<svg width="24" height="24"><rect x="3" y="3" width="18" height="18" rx="1" fill-rule="evenodd"/></svg>',"comment-add":'<svg width="24" height="24"><g fill-rule="nonzero"><path d="M9 19l3-2h7c.6 0 1-.4 1-1V6c0-.6-.4-1-1-1H5a1 1 0 0 0-1 1v10c0 .6.4 1 1 1h4v2zm-2 4v-4H5a3 3 0 0 1-3-3V6a3 3 0 0 1 3-3h14a3 3 0 0 1 3 3v10a3 3 0 0 1-3 3h-6.4L7 23z"/><path d="M13 10h2a1 1 0 0 1 0 2h-2v2a1 1 0 0 1-2 0v-2H9a1 1 0 0 1 0-2h2V8a1 1 0 0 1 2 0v2z"/></g></svg>',comment:'<svg width="24" height="24"><path fill-rule="nonzero" d="M9 19l3-2h7c.6 0 1-.4 1-1V6c0-.6-.4-1-1-1H5a1 1 0 0 0-1 1v10c0 .6.4 1 1 1h4v2zm-2 4v-4H5a3 3 0 0 1-3-3V6a3 3 0 0 1 3-3h14a3 3 0 0 1 3 3v10a3 3 0 0 1-3 3h-6.4L7 23z"/></svg>',contrast:'<svg width="24" height="24"><path d="M12 4a7.8 7.8 0 0 1 5.7 2.3A8 8 0 1 1 12 4zm-6 8a6 6 0 0 0 6 6V6a6 6 0 0 0-6 6z" fill-rule="evenodd"/></svg>',copy:'<svg width="24" height="24"><path d="M16 3H6a2 2 0 0 0-2 2v11h2V5h10V3zm1 4a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2h-7a2 2 0 0 1-2-2V9c0-1.2.9-2 2-2h7zm0 12V9h-7v10h7z" fill-rule="nonzero"/></svg>',crop:'<svg width="24" height="24"><path d="M17 8v7h2c.6 0 1 .4 1 1s-.4 1-1 1h-2v2c0 .6-.4 1-1 1a1 1 0 0 1-1-1v-2H7V9H5a1 1 0 1 1 0-2h2V5c0-.6.4-1 1-1s1 .4 1 1v2h7l3-3 1 1-3 3zM9 9v5l5-5H9zm1 6h5v-5l-5 5z" fill-rule="evenodd"/></svg>',cut:'<svg width="24" height="24"><path d="M18 15c.6.7 1 1.4 1 2.3 0 .8-.2 1.5-.7 2l-.8.5-1 .2c-.4 0-.8 0-1.2-.3a3.9 3.9 0 0 1-2.1-2.2c-.2-.5-.3-1-.2-1.5l-1-1-1 1c0 .5 0 1-.2 1.5-.1.5-.4 1-.9 1.4-.3.4-.7.6-1.2.8l-1.2.3c-.4 0-.7 0-1-.2-.3 0-.6-.3-.8-.5-.5-.5-.8-1.2-.7-2 0-.9.4-1.6 1-2.2A3.7 3.7 0 0 1 8.6 14H9l1-1-4-4-.5-1a3.3 3.3 0 0 1 0-2c0-.4.3-.7.5-1l6 6 6-6 .5 1a3.3 3.3 0 0 1 0 2c0 .4-.3.7-.5 1l-4 4 1 1h.5c.4 0 .8 0 1.2.3.5.2.9.4 1.2.8zm-8.5 2.2l.1-.4v-.3-.4a1 1 0 0 0-.2-.5 1 1 0 0 0-.4-.2 1.6 1.6 0 0 0-.8 0 2.6 2.6 0 0 0-.8.3 2.5 2.5 0 0 0-.9 1.1l-.1.4v.7l.2.5.5.2h.7a2.5 2.5 0 0 0 .8-.3 2.8 2.8 0 0 0 1-1zm2.5-2.8c.4 0 .7-.1 1-.4.3-.3.4-.6.4-1s-.1-.7-.4-1c-.3-.3-.6-.4-1-.4s-.7.1-1 .4c-.3.3-.4.6-.4 1s.1.7.4 1c.3.3.6.4 1 .4zm5.4 4l.2-.5v-.4-.3a2.6 2.6 0 0 0-.3-.8 2.4 2.4 0 0 0-.7-.7 2.5 2.5 0 0 0-.8-.3 1.5 1.5 0 0 0-.8 0 1 1 0 0 0-.4.2 1 1 0 0 0-.2.5 1.5 1.5 0 0 0 0 .7v.4l.3.4.3.4a2.8 2.8 0 0 0 .8.5l.4.1h.7l.5-.2z" fill-rule="evenodd"/></svg>',"document-properties":'<svg width="24" height="24"><path d="M14.4 3H7a2 2 0 0 0-2 2v14c0 1.1.9 2 2 2h10a2 2 0 0 0 2-2V7.6L14.4 3zM17 19H7V5h6v4h4v10z" fill-rule="nonzero"/></svg>',drag:'<svg width="24" height="24"><path d="M13 5h2v2h-2V5zm0 4h2v2h-2V9zM9 9h2v2H9V9zm4 4h2v2h-2v-2zm-4 0h2v2H9v-2zm0 4h2v2H9v-2zm4 0h2v2h-2v-2zM9 5h2v2H9V5z" fill-rule="evenodd"/></svg>',duplicate:'<svg width="24" height="24"><g fill-rule="nonzero"><path d="M16 3v2H6v11H4V5c0-1.1.9-2 2-2h10zm3 8h-2V9h-7v10h9a2 2 0 0 1-2 2h-7a2 2 0 0 1-2-2V9c0-1.2.9-2 2-2h7a2 2 0 0 1 2 2v2z"/><path d="M17 14h1a1 1 0 0 1 0 2h-1v1a1 1 0 0 1-2 0v-1h-1a1 1 0 0 1 0-2h1v-1a1 1 0 0 1 2 0v1z"/></g></svg>',"edit-block":'<svg width="24" height="24"><path fill-rule="nonzero" d="M19.8 8.8l-9.4 9.4c-.2.2-.5.4-.9.4l-5.4 1.2 1.2-5.4.5-.8 9.4-9.4c.7-.7 1.8-.7 2.5 0l2.1 2.1c.7.7.7 1.8 0 2.5zm-2-.2l1-.9v-.3l-2.2-2.2a.3.3 0 0 0-.3 0l-1 1L18 8.5zm-1 1l-2.5-2.4-6 6 2.5 2.5 6-6zm-7 7.1l-2.6-2.4-.3.3-.1.2-.7 3 3.1-.6h.1l.4-.5z"/></svg>',"edit-image":'<svg width="24" height="24"><path d="M18 16h2V7a2 2 0 0 0-2-2H7v2h11v9zM6 17h15a1 1 0 0 1 0 2h-1v1a1 1 0 0 1-2 0v-1H6a2 2 0 0 1-2-2V7H3a1 1 0 1 1 0-2h1V4a1 1 0 1 1 2 0v13zm3-5.3l1.3 2 3-4.7 3.7 6H7l2-3.3z" fill-rule="nonzero"/></svg>',"embed-page":'<svg width="24" height="24"><path d="M19 6V5H5v14h2A13 13 0 0 1 19 6zm0 1.4c-.8.8-1.6 2.4-2.2 4.6H19V7.4zm0 5.6h-2.4c-.4 1.8-.6 3.8-.6 6h3v-6zm-4 6c0-2.2.2-4.2.6-6H13c-.7 1.8-1.1 3.8-1.1 6h3zm-4 0c0-2.2.4-4.2 1-6H9.6A12 12 0 0 0 8 19h3zM4 3h16c.6 0 1 .4 1 1v16c0 .6-.4 1-1 1H4a1 1 0 0 1-1-1V4c0-.6.4-1 1-1zm11.8 9c.4-1.9 1-3.4 1.8-4.5a9.2 9.2 0 0 0-4 4.5h2.2zm-3.4 0a12 12 0 0 1 2.8-4 12 12 0 0 0-5 4h2.2z" fill-rule="nonzero"/></svg>',embed:'<svg width="24" height="24"><path d="M4 3h16c.6 0 1 .4 1 1v16c0 .6-.4 1-1 1H4a1 1 0 0 1-1-1V4c0-.6.4-1 1-1zm1 2v14h14V5H5zm4.8 2.6l5.6 4a.5.5 0 0 1 0 .8l-5.6 4A.5.5 0 0 1 9 16V8a.5.5 0 0 1 .8-.4z" fill-rule="nonzero"/></svg>',emoji:'<svg width="24" height="24"><path d="M9 11c.6 0 1-.4 1-1s-.4-1-1-1a1 1 0 0 0-1 1c0 .6.4 1 1 1zm6 0c.6 0 1-.4 1-1s-.4-1-1-1a1 1 0 0 0-1 1c0 .6.4 1 1 1zm-3 5.5c2.1 0 4-1.5 4.4-3.5H7.6c.5 2 2.3 3.5 4.4 3.5zM12 4a8 8 0 1 0 0 16 8 8 0 0 0 0-16zm0 14.5a6.5 6.5 0 1 1 0-13 6.5 6.5 0 0 1 0 13z" fill-rule="nonzero"/></svg>',fill:'<svg width="24" height="26"><path d="M16.6 12l-9-9-1.4 1.4 2.4 2.4-5.2 5.1c-.5.6-.5 1.6 0 2.2L9 19.6a1.5 1.5 0 0 0 2.2 0l5.5-5.5c.5-.6.5-1.6 0-2.2zM5.2 13L10 8.2l4.8 4.8H5.2zM19 14.5s-2 2.2-2 3.5c0 1.1.9 2 2 2a2 2 0 0 0 2-2c0-1.3-2-3.5-2-3.5z" fill-rule="nonzero"/></svg>',"flip-horizontally":'<svg width="24" height="24"><path d="M14 19h2v-2h-2v2zm4-8h2V9h-2v2zM4 7v10c0 1.1.9 2 2 2h3v-2H6V7h3V5H6a2 2 0 0 0-2 2zm14-2v2h2a2 2 0 0 0-2-2zm-7 16h2V3h-2v18zm7-6h2v-2h-2v2zm-4-8h2V5h-2v2zm4 12a2 2 0 0 0 2-2h-2v2z" fill-rule="nonzero"/></svg>',"flip-vertically":'<svg width="24" height="24"><path d="M5 14v2h2v-2H5zm8 4v2h2v-2h-2zm4-14H7a2 2 0 0 0-2 2v3h2V6h10v3h2V6a2 2 0 0 0-2-2zm2 14h-2v2a2 2 0 0 0 2-2zM3 11v2h18v-2H3zm6 7v2h2v-2H9zm8-4v2h2v-2h-2zM5 18c0 1.1.9 2 2 2v-2H5z" fill-rule="nonzero"/></svg>',"format-painter":'<svg width="24" height="24"><path d="M18 5V4c0-.5-.4-1-1-1H5a1 1 0 0 0-1 1v4c0 .6.5 1 1 1h12c.6 0 1-.4 1-1V7h1v4H9v9c0 .6.4 1 1 1h2c.6 0 1-.4 1-1v-7h8V5h-3z" fill-rule="nonzero"/></svg>',format:'<svg width="24" height="24"><path fill-rule="evenodd" d="M17 5a1 1 0 0 1 0 2h-4v11a1 1 0 0 1-2 0V7H7a1 1 0 1 1 0-2h10z"/></svg>',fullscreen:'<svg width="24" height="24"><path d="M15.3 10l-1.2-1.3 2.9-3h-2.3a.9.9 0 1 1 0-1.7H19c.5 0 .9.4.9.9v4.4a.9.9 0 1 1-1.8 0V7l-2.9 3zm0 4l3 3v-2.3a.9.9 0 1 1 1.7 0V19c0 .5-.4.9-.9.9h-4.4a.9.9 0 1 1 0-1.8H17l-3-2.9 1.3-1.2zM10 15.4l-2.9 3h2.3a.9.9 0 1 1 0 1.7H5a.9.9 0 0 1-.9-.9v-4.4a.9.9 0 1 1 1.8 0V17l2.9-3 1.2 1.3zM8.7 10L5.7 7v2.3a.9.9 0 0 1-1.7 0V5c0-.5.4-.9.9-.9h4.4a.9.9 0 0 1 0 1.8H7l3 2.9-1.3 1.2z" fill-rule="nonzero"/></svg>',gallery:'<svg width="24" height="24"><path fill-rule="nonzero" d="M5 15.7l2.3-2.2c.3-.3.7-.3 1 0L11 16l5.1-5c.3-.4.8-.4 1 0l2 1.9V8H5v7.7zM5 18V19h3l1.8-1.9-2-2L5 17.9zm14-3l-2.5-2.4-6.4 6.5H19v-4zM4 6h16c.6 0 1 .4 1 1v13c0 .6-.4 1-1 1H4a1 1 0 0 1-1-1V7c0-.6.4-1 1-1zm6 7a2 2 0 1 1 0-4 2 2 0 0 1 0 4zM4.5 4h15a.5.5 0 1 1 0 1h-15a.5.5 0 0 1 0-1zm2-2h11a.5.5 0 1 1 0 1h-11a.5.5 0 0 1 0-1z"/></svg>',gamma:'<svg width="24" height="24"><path d="M4 3h16c.6 0 1 .4 1 1v16c0 .6-.4 1-1 1H4a1 1 0 0 1-1-1V4c0-.6.4-1 1-1zm1 2v14h14V5H5zm6.5 11.8V14L9.2 8.7a5.1 5.1 0 0 0-.4-.8l-.1-.2H8 8v-1l.3-.1.3-.1h.7a1 1 0 0 1 .6.5l.1.3a8.5 8.5 0 0 1 .3.6l1.9 4.6 2-5.2a1 1 0 0 1 1-.6.5.5 0 0 1 .5.6L13 14v2.8a.7.7 0 0 1-1.4 0z" fill-rule="nonzero"/></svg>',help:'<svg width="24" height="24"><g fill-rule="evenodd"><path d="M12 5.5a6.5 6.5 0 0 0-6 9 6.3 6.3 0 0 0 1.4 2l1 1a6.3 6.3 0 0 0 3.6 1 6.5 6.5 0 0 0 6-9 6.3 6.3 0 0 0-1.4-2l-1-1a6.3 6.3 0 0 0-3.6-1zM12 4a7.8 7.8 0 0 1 5.7 2.3A8 8 0 1 1 12 4z"/><path d="M9.6 9.7a.7.7 0 0 1-.7-.8c0-1.1 1.5-1.8 3.2-1.8 1.8 0 3.2.8 3.2 2.4 0 1.4-.4 2.1-1.5 2.8-.2 0-.3.1-.3.2a2 2 0 0 0-.8.8.8.8 0 0 1-1.4-.6c.3-.7.8-1 1.3-1.5l.4-.2c.7-.4.8-.6.8-1.5 0-.5-.6-.9-1.7-.9-.5 0-1 .1-1.4.3-.2 0-.3.1-.3.2v-.2c0 .4-.4.8-.8.8z" fill-rule="nonzero"/><circle cx="12" cy="16" r="1"/></g></svg>',"highlight-bg-color":'<svg width="24" height="24"><g fill-rule="evenodd"><path id="tox-icon-highlight-bg-color__color" d="M3 18h18v3H3z"/><path fill-rule="nonzero" d="M7.7 16.7H3l3.3-3.3-.7-.8L10.2 8l4 4.1-4 4.2c-.2.2-.6.2-.8 0l-.6-.7-1.1 1.1zm5-7.5L11 7.4l3-2.9a2 2 0 0 1 2.6 0L18 6c.7.7.7 2 0 2.7l-2.9 2.9-1.8-1.8-.5-.6"/></g></svg>',home:'<svg width="24" height="24"><path fill-rule="nonzero" d="M10 20v-6h4v6h5v-8h3L12 3 2 12h3v8z"/></svg>',"horizontal-rule":'<svg width="24" height="24"><path d="M4 11h16v2H4z" fill-rule="evenodd"/></svg>',"image-options":'<svg width="24" height="24"><path d="M6 10a2 2 0 0 0-2 2c0 1.1.9 2 2 2a2 2 0 0 0 2-2 2 2 0 0 0-2-2zm12 0a2 2 0 0 0-2 2c0 1.1.9 2 2 2a2 2 0 0 0 2-2 2 2 0 0 0-2-2zm-6 0a2 2 0 0 0-2 2c0 1.1.9 2 2 2a2 2 0 0 0 2-2 2 2 0 0 0-2-2z" fill-rule="nonzero"/></svg>',image:'<svg width="24" height="24"><path d="M5 15.7l3.3-3.2c.3-.3.7-.3 1 0L12 15l4.1-4c.3-.4.8-.4 1 0l2 1.9V5H5v10.7zM5 18V19h3l2.8-2.9-2-2L5 17.9zm14-3l-2.5-2.4-6.4 6.5H19v-4zM4 3h16c.6 0 1 .4 1 1v16c0 .6-.4 1-1 1H4a1 1 0 0 1-1-1V4c0-.6.4-1 1-1zm6 8a2 2 0 1 0 0-4 2 2 0 0 0 0 4z" fill-rule="nonzero"/></svg>',indent:'<svg width="24" height="24"><path d="M7 5h12c.6 0 1 .4 1 1s-.4 1-1 1H7a1 1 0 1 1 0-2zm5 4h7c.6 0 1 .4 1 1s-.4 1-1 1h-7a1 1 0 0 1 0-2zm0 4h7c.6 0 1 .4 1 1s-.4 1-1 1h-7a1 1 0 0 1 0-2zm-5 4h12a1 1 0 0 1 0 2H7a1 1 0 0 1 0-2zm-2.6-3.8L6.2 12l-1.8-1.2a1 1 0 0 1 1.2-1.6l3 2a1 1 0 0 1 0 1.6l-3 2a1 1 0 1 1-1.2-1.6z" fill-rule="evenodd"/></svg>',info:'<svg width="24" height="24"><path d="M12 4a7.8 7.8 0 0 1 5.7 2.3A8 8 0 1 1 12 4zm-1 3v2h2V7h-2zm3 10v-1h-1v-5h-3v1h1v4h-1v1h4z" fill-rule="evenodd"/></svg>',"insert-character":'<svg width="24" height="24"><path d="M15 18h4l1-2v4h-6v-3.3l1.4-1a6 6 0 0 0 1.8-2.9 6.3 6.3 0 0 0-.1-4.1 5.8 5.8 0 0 0-3-3.2c-.6-.3-1.3-.5-2.1-.5a5.1 5.1 0 0 0-3.9 1.8 6.3 6.3 0 0 0-1.3 6 6.2 6.2 0 0 0 1.8 3l1.4.9V20H4v-4l1 2h4v-.5l-2-1L5.4 15A6.5 6.5 0 0 1 4 11c0-1 .2-1.9.6-2.7A7 7 0 0 1 6.3 6C7.1 5.4 8 5 9 4.5c1-.3 2-.5 3.1-.5a8.8 8.8 0 0 1 5.7 2 7 7 0 0 1 1.7 2.3 6 6 0 0 1 .2 4.8c-.2.7-.6 1.3-1 1.9a7.6 7.6 0 0 1-3.6 2.5v.5z" fill-rule="evenodd"/></svg>',"insert-time":'<svg width="24" height="24"><g fill-rule="nonzero"><path d="M12 19a7 7 0 1 0 0-14 7 7 0 0 0 0 14zm0 2a9 9 0 1 1 0-18 9 9 0 0 1 0 18z"/><path d="M16 12h-3V7c0-.6-.4-1-1-1a1 1 0 0 0-1 1v7h5c.6 0 1-.4 1-1s-.4-1-1-1z"/></g></svg>',invert:'<svg width="24" height="24"><path d="M18 19.3L16.5 18a5.8 5.8 0 0 1-3.1 1.9 6.1 6.1 0 0 1-5.5-1.6A5.8 5.8 0 0 1 6 14v-.3l.1-1.2A13.9 13.9 0 0 1 7.7 9l-3-3 .7-.8 2.8 2.9 9 8.9 1.5 1.6-.7.6zm0-5.5v.3l-.1 1.1-.4 1-1.2-1.2a4.3 4.3 0 0 0 .2-1v-.2c0-.4 0-.8-.2-1.3l-.5-1.4a14.8 14.8 0 0 0-3-4.2L12 6a26.1 26.1 0 0 0-2.2 2.5l-1-1a20.9 20.9 0 0 1 2.9-3.3L12 4l1 .8a22.2 22.2 0 0 1 4 5.4c.6 1.2 1 2.4 1 3.6z" fill-rule="evenodd"/></svg>',italic:'<svg width="24" height="24"><path d="M16.7 4.7l-.1.9h-.3c-.6 0-1 0-1.4.3-.3.3-.4.6-.5 1.1l-2.1 9.8v.6c0 .5.4.8 1.4.8h.2l-.2.8H8l.2-.8h.2c1.1 0 1.8-.5 2-1.5l2-9.8.1-.5c0-.6-.4-.8-1.4-.8h-.3l.2-.9h5.8z" fill-rule="evenodd"/></svg>',line:'<svg width="24" height="24"><path d="M15 9l-8 8H4v-3l8-8 3 3zm1-1l-3-3 1-1h1c-.2 0 0 0 0 0l2 2s0 .2 0 0v1l-1 1zM4 18h16v2H4v-2z" fill-rule="evenodd"/></svg>',link:'<svg width="24" height="24"><path d="M6.2 12.3a1 1 0 0 1 1.4 1.4l-2.1 2a2 2 0 1 0 2.7 2.8l4.8-4.8a1 1 0 0 0 0-1.4 1 1 0 1 1 1.4-1.3 2.9 2.9 0 0 1 0 4L9.6 20a3.9 3.9 0 0 1-5.5-5.5l2-2zm11.6-.6a1 1 0 0 1-1.4-1.4l2-2a2 2 0 1 0-2.6-2.8L11 10.3a1 1 0 0 0 0 1.4A1 1 0 1 1 9.6 13a2.9 2.9 0 0 1 0-4L14.4 4a3.9 3.9 0 0 1 5.5 5.5l-2 2z" fill-rule="nonzero"/></svg>',"list-bull-circle":'<svg width="48" height="48"><g fill-rule="evenodd"><path d="M11 16a2 2 0 1 0 0-4 2 2 0 0 0 0 4zm0 1a3 3 0 1 1 0-6 3 3 0 0 1 0 6zM11 26a2 2 0 1 0 0-4 2 2 0 0 0 0 4zm0 1a3 3 0 1 1 0-6 3 3 0 0 1 0 6zM11 36a2 2 0 1 0 0-4 2 2 0 0 0 0 4zm0 1a3 3 0 1 1 0-6 3 3 0 0 1 0 6z" fill-rule="nonzero"/><path opacity=".2" d="M18 12h22v4H18zM18 22h22v4H18zM18 32h22v4H18z"/></g></svg>',"list-bull-default":'<svg width="48" height="48"><g fill-rule="evenodd"><circle cx="11" cy="14" r="3"/><circle cx="11" cy="24" r="3"/><circle cx="11" cy="34" r="3"/><path opacity=".2" d="M18 12h22v4H18zM18 22h22v4H18zM18 32h22v4H18z"/></g></svg>',"list-bull-square":'<svg width="48" height="48"><g fill-rule="evenodd"><path d="M8 11h6v6H8zM8 21h6v6H8zM8 31h6v6H8z"/><path opacity=".2" d="M18 12h22v4H18zM18 22h22v4H18zM18 32h22v4H18z"/></g></svg>',"list-num-default-rtl":'<svg width="48" height="48"><g fill-rule="evenodd"><path opacity=".2" d="M8 12h22v4H8zM8 22h22v4H8zM8 32h22v4H8z"/><path d="M37.4 17v-4.8l-1.6 1v-1.1l1.6-1h1.2V17zM33.3 17.1c-.5 0-.8-.3-.8-.7 0-.4.3-.7.8-.7.4 0 .7.3.7.7 0 .4-.3.7-.7.7zm1.7 5.7c0-1.2 1-2 2.2-2 1.3 0 2.1.8 2.1 1.8 0 .7-.3 1.2-1.3 2.2l-1.2 1v.2h2.6v1h-4.3v-.9l2-1.9c.8-.8 1-1.1 1-1.5 0-.5-.4-.8-1-.8-.5 0-.9.3-.9.9H35zm-1.7 4.3c-.5 0-.8-.3-.8-.7 0-.4.3-.7.8-.7.4 0 .7.3.7.7 0 .4-.3.7-.7.7zm3.2 7.3v-1h.7c.6 0 1-.3 1-.8 0-.4-.4-.7-1-.7s-1 .3-1 .8H35c0-1.1 1-1.8 2.2-1.8 1.2 0 2.1.6 2.1 1.6 0 .7-.4 1.2-1 1.3v.1c.7.1 1.3.7 1.3 1.4 0 1-1 1.9-2.4 1.9-1.3 0-2.2-.8-2.3-2h1.2c0 .6.5 1 1.1 1 .6 0 1-.4 1-1 0-.5-.3-.8-1-.8h-.7zm-3.3 2.7c-.4 0-.7-.3-.7-.7 0-.4.3-.7.7-.7.5 0 .8.3.8.7 0 .4-.3.7-.8.7z"/></g></svg>',"list-num-default":'<svg width="48" height="48"><g fill-rule="evenodd"><path opacity=".2" d="M18 12h22v4H18zM18 22h22v4H18zM18 32h22v4H18z"/><path d="M10 17v-4.8l-1.5 1v-1.1l1.6-1h1.2V17h-1.2zm3.6.1c-.4 0-.7-.3-.7-.7 0-.4.3-.7.7-.7.5 0 .7.3.7.7 0 .4-.2.7-.7.7zm-5 5.7c0-1.2.8-2 2.1-2s2.1.8 2.1 1.8c0 .7-.3 1.2-1.4 2.2l-1.1 1v.2h2.6v1H8.6v-.9l2-1.9c.8-.8 1-1.1 1-1.5 0-.5-.4-.8-1-.8-.5 0-.9.3-.9.9H8.5zm6.3 4.3c-.5 0-.7-.3-.7-.7 0-.4.2-.7.7-.7.4 0 .7.3.7.7 0 .4-.3.7-.7.7zM10 34.4v-1h.7c.6 0 1-.3 1-.8 0-.4-.4-.7-1-.7s-1 .3-1 .8H8.6c0-1.1 1-1.8 2.2-1.8 1.3 0 2.1.6 2.1 1.6 0 .7-.4 1.2-1 1.3v.1c.8.1 1.3.7 1.3 1.4 0 1-1 1.9-2.4 1.9-1.3 0-2.2-.8-2.3-2h1.2c0 .6.5 1 1.1 1 .7 0 1-.4 1-1 0-.5-.3-.8-1-.8h-.7zm4.7 2.7c-.4 0-.7-.3-.7-.7 0-.4.3-.7.7-.7.5 0 .8.3.8.7 0 .4-.3.7-.8.7z"/></g></svg>',"list-num-lower-alpha-rtl":'<svg width="48" height="48"><g fill-rule="evenodd"><path opacity=".2" d="M8 12h22v4H8zM8 22h22v4H8zM8 32h22v4H8z"/><path d="M36.5 16c-.9 0-1.5-.5-1.5-1.3s.6-1.3 1.8-1.4h1v-.4c0-.4-.2-.6-.7-.6-.4 0-.7.1-.8.4h-1.1c0-.8.8-1.4 2-1.4S39 12 39 13V16h-1.2v-.6c-.3.4-.8.7-1.4.7zm.4-.8c.6 0 1-.4 1-.9V14h-1c-.5.1-.7.3-.7.6 0 .4.3.6.7.6zM33.1 16.1c-.4 0-.7-.3-.7-.7 0-.4.3-.7.7-.7.5 0 .8.3.8.7 0 .4-.3.7-.8.7zM37.7 26c-.7 0-1.2-.2-1.5-.7v.7H35v-6.3h1.2v2.5c.3-.5.8-.9 1.5-.9 1.1 0 1.8 1 1.8 2.4 0 1.5-.7 2.4-1.8 2.4zm-.5-3.6c-.6 0-1 .5-1 1.3s.4 1.4 1 1.4c.7 0 1-.6 1-1.4 0-.8-.3-1.3-1-1.3zM33.2 26.1c-.4 0-.7-.3-.7-.7 0-.4.3-.7.7-.7.5 0 .8.3.8.7 0 .4-.3.7-.8.7zm6 7h-1c-.1-.5-.4-.8-1-.8s-1 .5-1 1.4c0 1 .4 1.4 1 1.4.5 0 .9-.2 1-.7h1c0 1-.8 1.7-2 1.7-1.4 0-2.2-.9-2.2-2.4s.8-2.4 2.2-2.4c1.2 0 2 .7 2 1.7zm-6.1 3c-.5 0-.7-.3-.7-.7 0-.4.2-.7.7-.7.4 0 .7.3.7.7 0 .4-.3.7-.7.7z"/></g></svg>',"list-num-lower-alpha":'<svg width="48" height="48"><g fill-rule="evenodd"><path opacity=".2" d="M18 12h22v4H18zM18 22h22v4H18zM18 32h22v4H18z"/><path d="M10.3 15.2c.5 0 1-.4 1-.9V14h-1c-.5.1-.8.3-.8.6 0 .4.3.6.8.6zm-.4.9c-1 0-1.5-.6-1.5-1.4 0-.8.6-1.3 1.7-1.4h1.1v-.4c0-.4-.2-.6-.7-.6-.5 0-.8.1-.9.4h-1c0-.8.8-1.4 2-1.4 1.1 0 1.8.6 1.8 1.6V16h-1.1v-.6h-.1c-.2.4-.7.7-1.3.7zm4.6 0c-.5 0-.7-.3-.7-.7 0-.4.2-.7.7-.7.4 0 .7.3.7.7 0 .4-.3.7-.7.7zm-3.2 10c-.6 0-1.2-.3-1.4-.8v.7H8.5v-6.3H10v2.5c.3-.5.8-.9 1.4-.9 1.2 0 1.9 1 1.9 2.4 0 1.5-.7 2.4-1.9 2.4zm-.4-3.7c-.7 0-1 .5-1 1.3s.3 1.4 1 1.4c.6 0 1-.6 1-1.4 0-.8-.4-1.3-1-1.3zm4 3.7c-.5 0-.7-.3-.7-.7 0-.4.2-.7.7-.7.4 0 .7.3.7.7 0 .4-.3.7-.7.7zm-2.2 7h-1.2c0-.5-.4-.8-.9-.8-.6 0-1 .5-1 1.4 0 1 .4 1.4 1 1.4.5 0 .8-.2 1-.7h1c0 1-.8 1.7-2 1.7-1.4 0-2.2-.9-2.2-2.4s.8-2.4 2.2-2.4c1.2 0 2 .7 2 1.7zm1.8 3c-.5 0-.8-.3-.8-.7 0-.4.3-.7.8-.7.4 0 .7.3.7.7 0 .4-.3.7-.7.7z"/></g></svg>',"list-num-lower-greek-rtl":'<svg width="48" height="48"><g fill-rule="evenodd"><path opacity=".2" d="M8 12h22v4H8zM8 22h22v4H8zM8 32h22v4H8z"/><path d="M37.4 16c-1.2 0-2-.8-2-2.3 0-1.5.8-2.4 2-2.4.6 0 1 .4 1.3 1v-.9H40v3.2c0 .4.1.5.4.5h.2v.9h-.6c-.6 0-1-.2-1-.7h-.2c-.2.4-.7.8-1.3.8zm.3-1c.6 0 1-.5 1-1.3s-.4-1.3-1-1.3-1 .5-1 1.3.4 1.4 1 1.4zM33.3 16.1c-.5 0-.8-.3-.8-.7 0-.4.3-.7.8-.7.4 0 .7.3.7.7 0 .4-.3.7-.7.7zM36 21.9c0-1.5.8-2.3 2.1-2.3 1.2 0 2 .6 2 1.6 0 .6-.3 1-.9 1.3.9.3 1.3.8 1.3 1.7 0 1.2-.7 1.9-1.8 1.9-.6 0-1.1-.3-1.4-.8v2.2H36V22zm1.8 1.2v-1h.3c.5 0 .9-.2.9-.7 0-.5-.3-.8-.9-.8-.5 0-.8.3-.8 1v2.2c0 .8.4 1.3 1 1.3s1-.4 1-1-.4-1-1.2-1h-.3zM33.3 26.1c-.5 0-.8-.3-.8-.7 0-.4.3-.7.8-.7.4 0 .7.3.7.7 0 .4-.3.7-.7.7zM37.1 34.6L34.8 30h1.4l1.7 3.5 1.7-3.5h1.1l-2.2 4.6v.1c.5.8.7 1.4.7 1.8 0 .4-.2.8-.4 1-.2.2-.6.3-1 .3-.9 0-1.3-.4-1.3-1.2 0-.5.2-1 .5-1.7l.1-.2zm.7 1a2 2 0 0 0-.4.9c0 .3.1.4.4.4.3 0 .4-.1.4-.4 0-.2-.1-.6-.4-1zM33.3 36.1c-.5 0-.8-.3-.8-.7 0-.4.3-.7.8-.7.4 0 .7.3.7.7 0 .4-.3.7-.7.7z"/></g></svg>',"list-num-lower-greek":'<svg width="48" height="48"><g fill-rule="evenodd"><path opacity=".2" d="M18 12h22v4H18zM18 22h22v4H18zM18 32h22v4H18z"/><path d="M10.5 15c.7 0 1-.5 1-1.3s-.3-1.3-1-1.3c-.5 0-.9.5-.9 1.3s.4 1.4 1 1.4zm-.3 1c-1.1 0-1.8-.8-1.8-2.3 0-1.5.7-2.4 1.8-2.4.7 0 1.1.4 1.3 1h.1v-.9h1.2v3.2c0 .4.1.5.4.5h.2v.9h-.6c-.6 0-1-.2-1.1-.7h-.1c-.2.4-.7.8-1.4.8zm5 .1c-.5 0-.8-.3-.8-.7 0-.4.3-.7.7-.7.5 0 .8.3.8.7 0 .4-.3.7-.8.7zm-4.9 7v-1h.3c.6 0 1-.2 1-.7 0-.5-.4-.8-1-.8-.5 0-.8.3-.8 1v2.2c0 .8.4 1.3 1.1 1.3.6 0 1-.4 1-1s-.5-1-1.3-1h-.3zM8.6 22c0-1.5.7-2.3 2-2.3 1.2 0 2 .6 2 1.6 0 .6-.3 1-.8 1.3.8.3 1.3.8 1.3 1.7 0 1.2-.8 1.9-1.9 1.9-.6 0-1.1-.3-1.3-.8v2.2H8.5V22zm6.2 4.2c-.4 0-.7-.3-.7-.7 0-.4.3-.7.7-.7.5 0 .7.3.7.7 0 .4-.2.7-.7.7zm-4.5 8.5L8 30h1.4l1.7 3.5 1.7-3.5h1.1l-2.2 4.6v.1c.5.8.7 1.4.7 1.8 0 .4-.1.8-.4 1-.2.2-.6.3-1 .3-.9 0-1.3-.4-1.3-1.2 0-.5.2-1 .5-1.7l.1-.2zm.7 1a2 2 0 0 0-.4.9c0 .3.1.4.4.4.3 0 .4-.1.4-.4 0-.2-.1-.6-.4-1zm4.5.5c-.5 0-.8-.3-.8-.7 0-.4.3-.7.8-.7.4 0 .7.3.7.7 0 .4-.3.7-.7.7z"/></g></svg>',"list-num-lower-roman-rtl":'<svg width="48" height="48"><g fill-rule="evenodd"><path opacity=".2" d="M8 12h22v4H8zM8 22h22v4H8zM8 32h22v4H8z"/><path d="M32.9 16v-1.2h-1.3V16H33zm0 10v-1.2h-1.3V26H33zm0 10v-1.2h-1.3V36H33z"/><path fill-rule="nonzero" d="M36 21h-1.5v5H36zM36 31h-1.5v5H36zM39 21h-1.5v5H39zM39 31h-1.5v5H39zM42 31h-1.5v5H42zM36 11h-1.5v5H36zM36 19h-1.5v1H36zM36 29h-1.5v1H36zM39 19h-1.5v1H39zM39 29h-1.5v1H39zM42 29h-1.5v1H42zM36 9h-1.5v1H36z"/></g></svg>',"list-num-lower-roman":'<svg width="48" height="48"><g fill-rule="evenodd"><path opacity=".2" d="M18 12h22v4H18zM18 22h22v4H18zM18 32h22v4H18z"/><path d="M15.1 16v-1.2h1.3V16H15zm0 10v-1.2h1.3V26H15zm0 10v-1.2h1.3V36H15z"/><path fill-rule="nonzero" d="M12 21h1.5v5H12zM12 31h1.5v5H12zM9 21h1.5v5H9zM9 31h1.5v5H9zM6 31h1.5v5H6zM12 11h1.5v5H12zM12 19h1.5v1H12zM12 29h1.5v1H12zM9 19h1.5v1H9zM9 29h1.5v1H9zM6 29h1.5v1H6zM12 9h1.5v1H12z"/></g></svg>',"list-num-upper-alpha-rtl":'<svg width="48" height="48"><g fill-rule="evenodd"><path opacity=".2" d="M8 12h22v4H8zM8 22h22v4H8zM8 32h22v4H8z"/><path d="M39.3 17l-.5-1.4h-2l-.5 1.4H35l2-6h1.6l2 6h-1.3zm-1.6-4.7l-.7 2.3h1.6l-.8-2.3zM33.4 17c-.4 0-.7-.3-.7-.7 0-.4.3-.7.7-.7.5 0 .7.3.7.7 0 .4-.2.7-.7.7zm4.7 9.9h-2.7v-6H38c1.2 0 1.9.6 1.9 1.5 0 .6-.5 1.2-1 1.3.7.1 1.3.7 1.3 1.5 0 1-.8 1.7-2 1.7zm-1.4-5v1.5h1c.6 0 1-.3 1-.8 0-.4-.4-.7-1-.7h-1zm0 4h1.1c.7 0 1.1-.3 1.1-.8 0-.6-.4-.9-1.1-.9h-1.1V26zM33 27.1c-.5 0-.8-.3-.8-.7 0-.4.3-.7.8-.7.4 0 .7.3.7.7 0 .4-.3.7-.7.7zm4.9 10c-1.8 0-2.8-1.1-2.8-3.1s1-3.1 2.8-3.1c1.4 0 2.5.9 2.6 2.2h-1.3c0-.7-.6-1.1-1.3-1.1-1 0-1.6.7-1.6 2s.6 2 1.6 2c.7 0 1.2-.4 1.4-1h1.2c-.1 1.3-1.2 2.2-2.6 2.2zm-4.5 0c-.5 0-.8-.3-.8-.7 0-.4.3-.7.8-.7.4 0 .7.3.7.7 0 .4-.3.7-.7.7z"/></g></svg>',"list-num-upper-alpha":'<svg width="48" height="48"><g fill-rule="evenodd"><path opacity=".2" d="M18 12h22v4H18zM18 22h22v4H18zM18 32h22v4H18z"/><path d="M12.6 17l-.5-1.4h-2L9.5 17H8.3l2-6H12l2 6h-1.3zM11 12.3l-.7 2.3h1.6l-.8-2.3zm4.7 4.8c-.4 0-.7-.3-.7-.7 0-.4.3-.7.7-.7.5 0 .7.3.7.7 0 .4-.2.7-.7.7zM11.4 27H8.7v-6h2.6c1.2 0 1.9.6 1.9 1.5 0 .6-.5 1.2-1 1.3.7.1 1.3.7 1.3 1.5 0 1-.8 1.7-2 1.7zM10 22v1.5h1c.6 0 1-.3 1-.8 0-.4-.4-.7-1-.7h-1zm0 4H11c.7 0 1.1-.3 1.1-.8 0-.6-.4-.9-1.1-.9H10V26zm5.4 1.1c-.5 0-.8-.3-.8-.7 0-.4.3-.7.8-.7.4 0 .7.3.7.7 0 .4-.3.7-.7.7zm-4.1 10c-1.8 0-2.8-1.1-2.8-3.1s1-3.1 2.8-3.1c1.4 0 2.5.9 2.6 2.2h-1.3c0-.7-.6-1.1-1.3-1.1-1 0-1.6.7-1.6 2s.6 2 1.6 2c.7 0 1.2-.4 1.4-1h1.2c-.1 1.3-1.2 2.2-2.6 2.2zm4.5 0c-.5 0-.8-.3-.8-.7 0-.4.3-.7.8-.7.4 0 .7.3.7.7 0 .4-.3.7-.7.7z"/></g></svg>',"list-num-upper-roman-rtl":'<svg width="48" height="48"><g fill-rule="evenodd"><path opacity=".2" d="M8 12h22v4H8zM8 22h22v4H8zM8 32h22v4H8z"/><path d="M31.6 17v-1.2H33V17h-1.3zm0 10v-1.2H33V27h-1.3zm0 10v-1.2H33V37h-1.3z"/><path fill-rule="nonzero" d="M34.5 20H36v7h-1.5zM34.5 30H36v7h-1.5zM37.5 20H39v7h-1.5zM37.5 30H39v7h-1.5zM40.5 30H42v7h-1.5zM34.5 10H36v7h-1.5z"/></g></svg>',"list-num-upper-roman":'<svg width="48" height="48"><g fill-rule="evenodd"><path opacity=".2" d="M18 12h22v4H18zM18 22h22v4H18zM18 32h22v4H18z"/><path d="M15.1 17v-1.2h1.3V17H15zm0 10v-1.2h1.3V27H15zm0 10v-1.2h1.3V37H15z"/><path fill-rule="nonzero" d="M12 20h1.5v7H12zM12 30h1.5v7H12zM9 20h1.5v7H9zM9 30h1.5v7H9zM6 30h1.5v7H6zM12 10h1.5v7H12z"/></g></svg>',lock:'<svg width="24" height="24"><path d="M16.3 11c.2 0 .3 0 .5.2l.2.6v7.4c0 .3 0 .4-.2.6l-.6.2H7.8c-.3 0-.4 0-.6-.2a.7.7 0 0 1-.2-.6v-7.4c0-.3 0-.4.2-.6l.5-.2H8V8c0-.8.3-1.5.9-2.1.6-.6 1.3-.9 2.1-.9h2c.8 0 1.5.3 2.1.9.6.6.9 1.3.9 2.1v3h.3zM10 8v3h4V8a1 1 0 0 0-.3-.7A1 1 0 0 0 13 7h-2a1 1 0 0 0-.7.3 1 1 0 0 0-.3.7z" fill-rule="evenodd"/></svg>',ltr:'<svg width="24" height="24"><path d="M11 5h7a1 1 0 0 1 0 2h-1v11a1 1 0 0 1-2 0V7h-2v11a1 1 0 0 1-2 0v-6c-.5 0-1 0-1.4-.3A3.4 3.4 0 0 1 7.8 10a3.3 3.3 0 0 1 0-2.8 3.4 3.4 0 0 1 1.8-1.8L11 5zM4.4 16.2L6.2 15l-1.8-1.2a1 1 0 0 1 1.2-1.6l3 2a1 1 0 0 1 0 1.6l-3 2a1 1 0 1 1-1.2-1.6z" fill-rule="evenodd"/></svg>',"more-drawer":'<svg width="24" height="24"><path d="M6 10a2 2 0 0 0-2 2c0 1.1.9 2 2 2a2 2 0 0 0 2-2 2 2 0 0 0-2-2zm12 0a2 2 0 0 0-2 2c0 1.1.9 2 2 2a2 2 0 0 0 2-2 2 2 0 0 0-2-2zm-6 0a2 2 0 0 0-2 2c0 1.1.9 2 2 2a2 2 0 0 0 2-2 2 2 0 0 0-2-2z" fill-rule="nonzero"/></svg>',"new-document":'<svg width="24" height="24"><path d="M14.4 3H7a2 2 0 0 0-2 2v14c0 1.1.9 2 2 2h10a2 2 0 0 0 2-2V7.6L14.4 3zM17 19H7V5h6v4h4v10z" fill-rule="nonzero"/></svg>',"new-tab":'<svg width="24" height="24"><path d="M15 13l2-2v8H5V7h8l-2 2H7v8h8v-4zm4-8v5.5l-2-2-5.6 5.5H10v-1.4L15.5 7l-2-2H19z" fill-rule="evenodd"/></svg>',"non-breaking":'<svg width="24" height="24"><path d="M11 11H8a1 1 0 1 1 0-2h3V6c0-.6.4-1 1-1s1 .4 1 1v3h3c.6 0 1 .4 1 1s-.4 1-1 1h-3v3c0 .6-.4 1-1 1a1 1 0 0 1-1-1v-3zm10 4v5H3v-5c0-.6.4-1 1-1s1 .4 1 1v3h14v-3c0-.6.4-1 1-1s1 .4 1 1z" fill-rule="evenodd"/></svg>',notice:'<svg width="24" height="24"><path d="M17.8 9.8L15.4 4 20 8.5v7L15.5 20h-7L4 15.5v-7L8.5 4h7l2.3 5.8zm0 0l2.2 5.7-2.3-5.8zM13 17v-2h-2v2h2zm0-4V7h-2v6h2z" fill-rule="evenodd"/></svg>',"ordered-list-rtl":'<svg width="24" height="24"><path d="M6 17h8a1 1 0 0 1 0 2H6a1 1 0 0 1 0-2zm0-6h8a1 1 0 0 1 0 2H6a1 1 0 0 1 0-2zm0-6h8a1 1 0 0 1 0 2H6a1 1 0 1 1 0-2zm13-1v3.5a.5.5 0 1 1-1 0V5h-.5a.5.5 0 1 1 0-1H19zm-1 8.8l.2.2h1.3a.5.5 0 1 1 0 1h-1.6a1 1 0 0 1-.9-1V13c0-.4.3-.8.6-1l1.2-.4.2-.3a.2.2 0 0 0-.2-.2h-1.3a.5.5 0 0 1-.5-.5c0-.3.2-.5.5-.5h1.6c.5 0 .9.4.9 1v.1c0 .4-.3.8-.6 1l-1.2.4-.2.3zm2 4.2v2c0 .6-.4 1-1 1h-1.5a.5.5 0 0 1 0-1h1.2a.3.3 0 1 0 0-.6h-1.3a.4.4 0 1 1 0-.8h1.3a.3.3 0 0 0 0-.6h-1.2a.5.5 0 1 1 0-1H19c.6 0 1 .4 1 1z" fill-rule="evenodd"/></svg>',"ordered-list":'<svg width="24" height="24"><path d="M10 17h8c.6 0 1 .4 1 1s-.4 1-1 1h-8a1 1 0 0 1 0-2zm0-6h8c.6 0 1 .4 1 1s-.4 1-1 1h-8a1 1 0 0 1 0-2zm0-6h8c.6 0 1 .4 1 1s-.4 1-1 1h-8a1 1 0 1 1 0-2zM6 4v3.5c0 .3-.2.5-.5.5a.5.5 0 0 1-.5-.5V5h-.5a.5.5 0 0 1 0-1H6zm-1 8.8l.2.2h1.3c.3 0 .5.2.5.5s-.2.5-.5.5H4.9a1 1 0 0 1-.9-1V13c0-.4.3-.8.6-1l1.2-.4.2-.3a.2.2 0 0 0-.2-.2H4.5a.5.5 0 0 1-.5-.5c0-.3.2-.5.5-.5h1.6c.5 0 .9.4.9 1v.1c0 .4-.3.8-.6 1l-1.2.4-.2.3zM7 17v2c0 .6-.4 1-1 1H4.5a.5.5 0 0 1 0-1h1.2c.2 0 .3-.1.3-.3 0-.2-.1-.3-.3-.3H4.4a.4.4 0 1 1 0-.8h1.3c.2 0 .3-.1.3-.3 0-.2-.1-.3-.3-.3H4.5a.5.5 0 1 1 0-1H6c.6 0 1 .4 1 1z" fill-rule="evenodd"/></svg>',orientation:'<svg width="24" height="24"><path d="M7.3 6.4L1 13l6.4 6.5 6.5-6.5-6.5-6.5zM3.7 13l3.6-3.7L11 13l-3.7 3.7-3.6-3.7zM12 6l2.8 2.7c.3.3.3.8 0 1-.3.4-.9.4-1.2 0L9.2 5.7a.8.8 0 0 1 0-1.2L13.6.2c.3-.3.9-.3 1.2 0 .3.3.3.8 0 1.1L12 4h1a9 9 0 1 1-4.3 16.9l1.5-1.5A7 7 0 1 0 13 6h-1z" fill-rule="nonzero"/></svg>',outdent:'<svg width="24" height="24"><path d="M7 5h12c.6 0 1 .4 1 1s-.4 1-1 1H7a1 1 0 1 1 0-2zm5 4h7c.6 0 1 .4 1 1s-.4 1-1 1h-7a1 1 0 0 1 0-2zm0 4h7c.6 0 1 .4 1 1s-.4 1-1 1h-7a1 1 0 0 1 0-2zm-5 4h12a1 1 0 0 1 0 2H7a1 1 0 0 1 0-2zm1.6-3.8a1 1 0 0 1-1.2 1.6l-3-2a1 1 0 0 1 0-1.6l3-2a1 1 0 0 1 1.2 1.6L6.8 12l1.8 1.2z" fill-rule="evenodd"/></svg>',"page-break":'<svg width="24" height="24"><g fill-rule="evenodd"><path d="M5 11c.6 0 1 .4 1 1s-.4 1-1 1a1 1 0 0 1 0-2zm3 0h1c.6 0 1 .4 1 1s-.4 1-1 1H8a1 1 0 0 1 0-2zm4 0c.6 0 1 .4 1 1s-.4 1-1 1a1 1 0 0 1 0-2zm3 0h1c.6 0 1 .4 1 1s-.4 1-1 1h-1a1 1 0 0 1 0-2zm4 0c.6 0 1 .4 1 1s-.4 1-1 1a1 1 0 0 1 0-2zM7 3v5h10V3c0-.6.4-1 1-1s1 .4 1 1v7H5V3c0-.6.4-1 1-1s1 .4 1 1zM6 22a1 1 0 0 1-1-1v-7h14v7c0 .6-.4 1-1 1a1 1 0 0 1-1-1v-5H7v5c0 .6-.4 1-1 1z"/></g></svg>',paragraph:'<svg width="24" height="24"><path fill-rule="evenodd" d="M10 5h7a1 1 0 0 1 0 2h-1v11a1 1 0 0 1-2 0V7h-2v11a1 1 0 0 1-2 0v-6c-.5 0-1 0-1.4-.3A3.4 3.4 0 0 1 6.8 10a3.3 3.3 0 0 1 0-2.8 3.4 3.4 0 0 1 1.8-1.8L10 5z"/></svg>',"paste-text":'<svg width="24" height="24"><path d="M18 9V5h-2v1c0 .6-.4 1-1 1H9a1 1 0 0 1-1-1V5H6v13h3V9h9zM9 20H6a2 2 0 0 1-2-2V5c0-1.1.9-2 2-2h3.2A3 3 0 0 1 12 1a3 3 0 0 1 2.8 2H18a2 2 0 0 1 2 2v4h1v12H9v-1zm1.5-9.5v9h9v-9h-9zM12 3a1 1 0 0 0-1 1c0 .5.4 1 1 1s1-.5 1-1-.4-1-1-1zm0 9h6v2h-.5l-.5-1h-1v4h.8v1h-3.6v-1h.8v-4h-1l-.5 1H12v-2z" fill-rule="nonzero"/></svg>',paste:'<svg width="24" height="24"><path d="M18 9V5h-2v1c0 .6-.4 1-1 1H9a1 1 0 0 1-1-1V5H6v13h3V9h9zM9 20H6a2 2 0 0 1-2-2V5c0-1.1.9-2 2-2h3.2A3 3 0 0 1 12 1a3 3 0 0 1 2.8 2H18a2 2 0 0 1 2 2v4h1v12H9v-1zm1.5-9.5v9h9v-9h-9zM12 3a1 1 0 0 0-1 1c0 .5.4 1 1 1s1-.5 1-1-.4-1-1-1z" fill-rule="nonzero"/></svg>',"permanent-pen":'<svg width="24" height="24"><path d="M10.5 17.5L8 20H3v-3l3.5-3.5a2 2 0 0 1 0-3L14 3l1 1-7.3 7.3a1 1 0 0 0 0 1.4l3.6 3.6c.4.4 1 .4 1.4 0L20 9l1 1-7.6 7.6a2 2 0 0 1-2.8 0l-.1-.1z" fill-rule="nonzero"/></svg>',plus:'<svg width="24" height="24"><path d="M12 4c.5 0 1 .4 1 .9V11h6a1 1 0 0 1 .1 2H13v6a1 1 0 0 1-2 .1V13H5a1 1 0 0 1-.1-2H11V5c0-.6.4-1 1-1z"/></svg>',preferences:'<svg width="24" height="24"><path d="M20.1 13.5l-1.9.2a5.8 5.8 0 0 1-.6 1.5l1.2 1.5c.4.4.3 1 0 1.4l-.7.7a1 1 0 0 1-1.4 0l-1.5-1.2a6.2 6.2 0 0 1-1.5.6l-.2 1.9c0 .5-.5.9-1 .9h-1a1 1 0 0 1-1-.9l-.2-1.9a5.8 5.8 0 0 1-1.5-.6l-1.5 1.2a1 1 0 0 1-1.4 0l-.7-.7a1 1 0 0 1 0-1.4l1.2-1.5a6.2 6.2 0 0 1-.6-1.5l-1.9-.2a1 1 0 0 1-.9-1v-1c0-.5.4-1 .9-1l1.9-.2a5.8 5.8 0 0 1 .6-1.5L5.2 7.3a1 1 0 0 1 0-1.4l.7-.7a1 1 0 0 1 1.4 0l1.5 1.2a6.2 6.2 0 0 1 1.5-.6l.2-1.9c0-.5.5-.9 1-.9h1c.5 0 1 .4 1 .9l.2 1.9a5.8 5.8 0 0 1 1.5.6l1.5-1.2a1 1 0 0 1 1.4 0l.7.7c.3.4.4 1 0 1.4l-1.2 1.5a6.2 6.2 0 0 1 .6 1.5l1.9.2c.5 0 .9.5.9 1v1c0 .5-.4 1-.9 1zM12 15a3 3 0 1 0 0-6 3 3 0 0 0 0 6z" fill-rule="evenodd"/></svg>',preview:'<svg width="24" height="24"><path d="M3.5 12.5c.5.8 1.1 1.6 1.8 2.3 2 2 4.2 3.2 6.7 3.2s4.7-1.2 6.7-3.2a16.2 16.2 0 0 0 2.1-2.8 15.7 15.7 0 0 0-2.1-2.8c-2-2-4.2-3.2-6.7-3.2a9.3 9.3 0 0 0-6.7 3.2A16.2 16.2 0 0 0 3.2 12c0 .2.2.3.3.5zm-2.4-1l.7-1.2L4 7.8C6.2 5.4 8.9 4 12 4c3 0 5.8 1.4 8.1 3.8a18.2 18.2 0 0 1 2.8 3.7v1l-.7 1.2-2.1 2.5c-2.3 2.4-5 3.8-8.1 3.8-3 0-5.8-1.4-8.1-3.8a18.2 18.2 0 0 1-2.8-3.7 1 1 0 0 1 0-1zm12-3.3a2 2 0 1 0 2.7 2.6 4 4 0 1 1-2.6-2.6z" fill-rule="nonzero"/></svg>',print:'<svg width="24" height="24"><path d="M18 8H6a3 3 0 0 0-3 3v6h2v3h14v-3h2v-6a3 3 0 0 0-3-3zm-1 10H7v-4h10v4zm.5-5c-.8 0-1.5-.7-1.5-1.5s.7-1.5 1.5-1.5 1.5.7 1.5 1.5-.7 1.5-1.5 1.5zm.5-8H6v2h12V5z" fill-rule="nonzero"/></svg>',quote:'<svg width="24" height="24"><path d="M7.5 17h.9c.4 0 .7-.2.9-.6L11 13V8c0-.6-.4-1-1-1H6a1 1 0 0 0-1 1v4c0 .6.4 1 1 1h2l-1.3 2.7a1 1 0 0 0 .8 1.3zm8 0h.9c.4 0 .7-.2.9-.6L19 13V8c0-.6-.4-1-1-1h-4a1 1 0 0 0-1 1v4c0 .6.4 1 1 1h2l-1.3 2.7a1 1 0 0 0 .8 1.3z" fill-rule="nonzero"/></svg>',redo:'<svg width="24" height="24"><path d="M17.6 10H12c-2.8 0-4.4 1.4-4.9 3.5-.4 2 .3 4 1.4 4.6a1 1 0 1 1-1 1.8c-2-1.2-2.9-4.1-2.3-6.8.6-3 3-5.1 6.8-5.1h5.6l-3.3-3.3a1 1 0 1 1 1.4-1.4l5 5a1 1 0 0 1 0 1.4l-5 5a1 1 0 0 1-1.4-1.4l3.3-3.3z" fill-rule="nonzero"/></svg>',reload:'<svg width="24" height="24"><g fill-rule="nonzero"><path d="M5 22.1l-1.2-4.7v-.2a1 1 0 0 1 1-1l5 .4a1 1 0 1 1-.2 2l-2.2-.2a7.8 7.8 0 0 0 8.4.2 7.5 7.5 0 0 0 3.5-6.4 1 1 0 1 1 2 0 9.5 9.5 0 0 1-4.5 8 9.9 9.9 0 0 1-10.2 0l.4 1.4a1 1 0 1 1-2 .5zM13.6 7.4c0-.5.5-1 1-.9l2.8.2a8 8 0 0 0-9.5-1 7.5 7.5 0 0 0-3.6 7 1 1 0 0 1-2 0 9.5 9.5 0 0 1 4.5-8.6 10 10 0 0 1 10.9.3l-.3-1a1 1 0 0 1 2-.5l1.1 4.8a1 1 0 0 1-1 1.2l-5-.4a1 1 0 0 1-.9-1z"/></g></svg>',"remove-formatting":'<svg width="24" height="24"><path d="M13.2 6a1 1 0 0 1 0 .2l-2.6 10a1 1 0 0 1-1 .8h-.2a.8.8 0 0 1-.8-1l2.6-10H8a1 1 0 1 1 0-2h9a1 1 0 0 1 0 2h-3.8zM5 18h7a1 1 0 0 1 0 2H5a1 1 0 0 1 0-2zm13 1.5L16.5 18 15 19.5a.7.7 0 0 1-1-1l1.5-1.5-1.5-1.5a.7.7 0 0 1 1-1l1.5 1.5 1.5-1.5a.7.7 0 0 1 1 1L17.5 17l1.5 1.5a.7.7 0 0 1-1 1z" fill-rule="evenodd"/></svg>',remove:'<svg width="24" height="24"><path d="M16 7h3a1 1 0 0 1 0 2h-1v9a3 3 0 0 1-3 3H9a3 3 0 0 1-3-3V9H5a1 1 0 1 1 0-2h3V6a3 3 0 0 1 3-3h2a3 3 0 0 1 3 3v1zm-2 0V6c0-.6-.4-1-1-1h-2a1 1 0 0 0-1 1v1h4zm2 2H8v9c0 .6.4 1 1 1h6c.6 0 1-.4 1-1V9zm-7 3a1 1 0 0 1 2 0v4a1 1 0 0 1-2 0v-4zm4 0a1 1 0 0 1 2 0v4a1 1 0 0 1-2 0v-4z" fill-rule="nonzero"/></svg>',"resize-handle":'<svg width="10" height="10"><g fill-rule="nonzero"><path d="M8.1 1.1A.5.5 0 1 1 9 2l-7 7A.5.5 0 1 1 1 8l7-7zM8.1 5.1A.5.5 0 1 1 9 6l-3 3A.5.5 0 1 1 5 8l3-3z"/></g></svg>',resize:'<svg width="24" height="24"><path d="M4 5c0-.3.1-.5.3-.7.2-.2.4-.3.7-.3h6c.3 0 .5.1.7.3.2.2.3.4.3.7 0 .3-.1.5-.3.7a1 1 0 0 1-.7.3H7.4L18 16.6V13c0-.3.1-.5.3-.7.2-.2.4-.3.7-.3.3 0 .5.1.7.3.2.2.3.4.3.7v6c0 .3-.1.5-.3.7a1 1 0 0 1-.7.3h-6a1 1 0 0 1-.7-.3 1 1 0 0 1-.3-.7c0-.3.1-.5.3-.7.2-.2.4-.3.7-.3h3.6L6 7.4V11c0 .3-.1.5-.3.7a1 1 0 0 1-.7.3 1 1 0 0 1-.7-.3A1 1 0 0 1 4 11V5z" fill-rule="evenodd"/></svg>',"restore-draft":'<svg width="24" height="24"><g fill-rule="evenodd"><path d="M17 13c0 .6-.4 1-1 1h-4V8c0-.6.4-1 1-1s1 .4 1 1v4h2c.6 0 1 .4 1 1z"/><path d="M4.7 10H9a1 1 0 0 1 0 2H3a1 1 0 0 1-1-1V5a1 1 0 1 1 2 0v3l2.5-2.4a9.2 9.2 0 0 1 10.8-1.5A9 9 0 0 1 13.4 21c-2.4.1-4.7-.7-6.5-2.2a1 1 0 1 1 1.3-1.5 7.2 7.2 0 0 0 11.6-3.7 7 7 0 0 0-3.5-7.7A7.2 7.2 0 0 0 8 7L4.7 10z" fill-rule="nonzero"/></g></svg>',"rotate-left":'<svg width="24" height="24"><path d="M4.7 10H9a1 1 0 0 1 0 2H3a1 1 0 0 1-1-1V5a1 1 0 1 1 2 0v3l2.5-2.4a9.2 9.2 0 0 1 10.8-1.5A9 9 0 0 1 13.4 21c-2.4.1-4.7-.7-6.5-2.2a1 1 0 1 1 1.3-1.5 7.2 7.2 0 0 0 11.6-3.7 7 7 0 0 0-3.5-7.7A7.2 7.2 0 0 0 8 7L4.7 10z" fill-rule="nonzero"/></svg>',"rotate-right":'<svg width="24" height="24"><path d="M20 8V5a1 1 0 0 1 2 0v6c0 .6-.4 1-1 1h-6a1 1 0 0 1 0-2h4.3L16 7A7.2 7.2 0 0 0 7.7 6a7 7 0 0 0 3 13.1c1.9.1 3.7-.5 5-1.7a1 1 0 0 1 1.4 1.5A9.2 9.2 0 0 1 2.2 14c-.9-3.9 1-8 4.5-9.9 3.5-1.9 8-1.3 10.8 1.5L20 8z" fill-rule="nonzero"/></svg>',rtl:'<svg width="24" height="24"><path d="M8 5h8v2h-2v12h-2V7h-2v12H8v-7c-.5 0-1 0-1.4-.3A3.4 3.4 0 0 1 4.8 10a3.3 3.3 0 0 1 0-2.8 3.4 3.4 0 0 1 1.8-1.8L8 5zm12 11.2a1 1 0 1 1-1 1.6l-3-2a1 1 0 0 1 0-1.6l3-2a1 1 0 1 1 1 1.6L18.4 15l1.8 1.2z" fill-rule="evenodd"/></svg>',save:'<svg width="24" height="24"><path d="M5 16h14a2 2 0 0 1 2 2v2a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-2c0-1.1.9-2 2-2zm0 2v2h14v-2H5zm10 0h2v2h-2v-2zm-4-6.4L8.7 9.3a1 1 0 1 0-1.4 1.4l4 4c.4.4 1 .4 1.4 0l4-4a1 1 0 1 0-1.4-1.4L13 11.6V4a1 1 0 0 0-2 0v7.6z" fill-rule="nonzero"/></svg>',search:'<svg width="24" height="24"><path d="M16 17.3a8 8 0 1 1 1.4-1.4l4.3 4.4a1 1 0 0 1-1.4 1.4l-4.4-4.3zm-5-.3a6 6 0 1 0 0-12 6 6 0 0 0 0 12z" fill-rule="nonzero"/></svg>',"select-all":'<svg width="24" height="24"><path d="M3 5h2V3a2 2 0 0 0-2 2zm0 8h2v-2H3v2zm4 8h2v-2H7v2zM3 9h2V7H3v2zm10-6h-2v2h2V3zm6 0v2h2a2 2 0 0 0-2-2zM5 21v-2H3c0 1.1.9 2 2 2zm-2-4h2v-2H3v2zM9 3H7v2h2V3zm2 18h2v-2h-2v2zm8-8h2v-2h-2v2zm0 8a2 2 0 0 0 2-2h-2v2zm0-12h2V7h-2v2zm0 8h2v-2h-2v2zm-4 4h2v-2h-2v2zm0-16h2V3h-2v2zM7 17h10V7H7v10zm2-8h6v6H9V9z" fill-rule="nonzero"/></svg>',selected:'<svg width="24" height="24"><path fill-rule="nonzero" d="M6 4h12a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6c0-1.1.9-2 2-2zm3.6 10.9L7 12.3a.7.7 0 0 0-1 1L9.6 17 18 8.6a.7.7 0 0 0 0-1 .7.7 0 0 0-1 0l-7.4 7.3z"/></svg>',settings:'<svg width="24" height="24"><path d="M11 6h8c.6 0 1 .4 1 1s-.4 1-1 1h-8v.3c0 .2 0 .3-.2.5l-.6.2H7.8c-.3 0-.4 0-.6-.2a.7.7 0 0 1-.2-.6V8H5a1 1 0 1 1 0-2h2v-.3c0-.2 0-.3.2-.5l.5-.2h2.5c.3 0 .4 0 .6.2l.2.5V6zM8 8h2V6H8v2zm9 2.8v.2h2c.6 0 1 .4 1 1s-.4 1-1 1h-2v.3c0 .2 0 .3-.2.5l-.6.2h-2.4c-.3 0-.4 0-.6-.2a.7.7 0 0 1-.2-.6V13H5a1 1 0 0 1 0-2h8v-.3c0-.2 0-.3.2-.5l.6-.2h2.4c.3 0 .4 0 .6.2l.2.6zM14 13h2v-2h-2v2zm-3 2.8v.2h8c.6 0 1 .4 1 1s-.4 1-1 1h-8v.3c0 .2 0 .3-.2.5l-.6.2H7.8c-.3 0-.4 0-.6-.2a.7.7 0 0 1-.2-.6V18H5a1 1 0 0 1 0-2h2v-.3c0-.2 0-.3.2-.5l.5-.2h2.5c.3 0 .4 0 .6.2l.2.6zM8 18h2v-2H8v2z" fill-rule="evenodd"/></svg>',sharpen:'<svg width="24" height="24"><path d="M16 6l4 4-8 9-8-9 4-4h8zm-4 10.2l5.5-6.2-.1-.1H12v-.3h5.1l-.2-.2H12V9h4.6l-.2-.2H12v-.3h4.1l-.2-.2H12V8h3.6l-.2-.2H8.7L6.5 10l.1.1H12v.3H6.9l.2.2H12v.3H7.3l.2.2H12v.3H7.7l.3.2h4v.3H8.2l.2.2H12v.3H8.6l.3.2H12v.3H9l.3.2H12v.3H9.5l.2.2H12v.3h-2l.2.2H12v.3h-1.6l.2.2H12v.3h-1.1l.2.2h.9v.3h-.7l.2.2h.5v.3h-.3l.3.2z" fill-rule="evenodd"/></svg>',"sort-asc":'<svg width="24" height="24"><g fill-rule="evenodd"><path d="M4 8h5a1 1 0 1 1 0 2H4a1 1 0 1 1 0-2zm0 8h8a1 1 0 0 1 0 2H4a1 1 0 0 1 0-2zm0-4h7a1 1 0 0 1 0 2H4a1 1 0 0 1 0-2z"/><path fill-rule="nonzero" d="M16 8.4l-2.3 2.3a1 1 0 0 1-1.4-1.4l4-4a1 1 0 0 1 1.4 0l4 4a1 1 0 1 1-1.4 1.4L18 8.4V18a1 1 0 0 1-2 0V8.4z"/></g></svg>',"sort-dsc":'<svg width="24" height="24"><g fill-rule="evenodd"><path d="M4 16h5a1 1 0 0 0 0-2H4a1 1 0 0 0 0 2zm0-8h8a1 1 0 0 0 0-2H4a1 1 0 1 0 0 2zm0 4h7a1 1 0 0 0 0-2H4a1 1 0 0 0 0 2z"/><path fill-rule="nonzero" d="M16 15.6l-2.3-2.3a1 1 0 0 0-1.4 1.4l4 4c.4.4 1 .4 1.4 0l4-4a1 1 0 0 0-1.4-1.4L18 15.6V6a1 1 0 0 0-2 0v9.6z"/></g></svg>',sourcecode:'<svg width="24" height="24"><g fill-rule="nonzero"><path d="M9.8 15.7c.3.3.3.8 0 1-.3.4-.9.4-1.2 0l-4.4-4.1a.8.8 0 0 1 0-1.2l4.4-4.2c.3-.3.9-.3 1.2 0 .3.3.3.8 0 1.1L6 12l3.8 3.7zM14.2 15.7c-.3.3-.3.8 0 1 .4.4.9.4 1.2 0l4.4-4.1c.3-.3.3-.9 0-1.2l-4.4-4.2a.8.8 0 0 0-1.2 0c-.3.3-.3.8 0 1.1L18 12l-3.8 3.7z"/></g></svg>',"spell-check":'<svg width="24" height="24"><path d="M6 8v3H5V5c0-.3.1-.5.3-.7.2-.2.4-.3.7-.3h2c.3 0 .5.1.7.3.2.2.3.4.3.7v6H8V8H6zm0-3v2h2V5H6zm13 0h-3v5h3v1h-3a1 1 0 0 1-.7-.3 1 1 0 0 1-.3-.7V5c0-.3.1-.5.3-.7.2-.2.4-.3.7-.3h3v1zm-5 1.5l-.1.7c-.1.2-.3.3-.6.3.3 0 .5.1.6.3l.1.7V10c0 .3-.1.5-.3.7a1 1 0 0 1-.7.3h-3V4h3c.3 0 .5.1.7.3.2.2.3.4.3.7v1.5zM13 10V8h-2v2h2zm0-3V5h-2v2h2zm3 5l1 1-6.5 7L7 15.5l1.3-1 2.2 2.2L16 12z" fill-rule="evenodd"/></svg>',"strike-through":'<svg width="24" height="24"><g fill-rule="evenodd"><path d="M15.6 8.5c-.5-.7-1-1.1-1.3-1.3-.6-.4-1.3-.6-2-.6-2.7 0-2.8 1.7-2.8 2.1 0 1.6 1.8 2 3.2 2.3 4.4.9 4.6 2.8 4.6 3.9 0 1.4-.7 4.1-5 4.1A6.2 6.2 0 0 1 7 16.4l1.5-1.1c.4.6 1.6 2 3.7 2 1.6 0 2.5-.4 3-1.2.4-.8.3-2-.8-2.6-.7-.4-1.6-.7-2.9-1-1-.2-3.9-.8-3.9-3.6C7.6 6 10.3 5 12.4 5c2.9 0 4.2 1.6 4.7 2.4l-1.5 1.1z"/><path d="M5 11h14a1 1 0 0 1 0 2H5a1 1 0 0 1 0-2z" fill-rule="nonzero"/></g></svg>',subscript:'<svg width="24" height="24"><path d="M10.4 10l4.6 4.6-1.4 1.4L9 11.4 4.4 16 3 14.6 7.6 10 3 5.4 4.4 4 9 8.6 13.6 4 15 5.4 10.4 10zM21 19h-5v-1l1-.8 1.7-1.6c.3-.4.5-.8.5-1.2 0-.3 0-.6-.2-.7-.2-.2-.5-.3-.9-.3a2 2 0 0 0-.8.2l-.7.3-.4-1.1 1-.6 1.2-.2c.8 0 1.4.3 1.8.7.4.4.6.9.6 1.5s-.2 1.1-.5 1.6a8 8 0 0 1-1.3 1.3l-.6.6h2.6V19z" fill-rule="nonzero"/></svg>',superscript:'<svg width="24" height="24"><path d="M15 9.4L10.4 14l4.6 4.6-1.4 1.4L9 15.4 4.4 20 3 18.6 7.6 14 3 9.4 4.4 8 9 12.6 13.6 8 15 9.4zm5.9 1.6h-5v-1l1-.8 1.7-1.6c.3-.5.5-.9.5-1.3 0-.3 0-.5-.2-.7-.2-.2-.5-.3-.9-.3l-.8.2-.7.4-.4-1.2c.2-.2.5-.4 1-.5.3-.2.8-.2 1.2-.2.8 0 1.4.2 1.8.6.4.4.6 1 .6 1.6 0 .5-.2 1-.5 1.5l-1.3 1.4-.6.5h2.6V11z" fill-rule="nonzero"/></svg>',"table-cell-properties":'<svg width="24" height="24"><path fill-rule="nonzero" d="M19 4a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V6c0-1.1.9-2 2-2h14zm-8 9H5v5h6v-5zm8 0h-6v5h6v-5zm-8-7H5v5h6V6z"/></svg>',"table-cell-select-all":'<svg width="24" height="24"><g fill-rule="evenodd"><path fill-rule="nonzero" d="M19 4a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V6c0-1.1.9-2 2-2h14zm0 2H5v12h14V6z"/><path d="M13 6v5h6v2h-6v5h-2v-5H5v-2h6V6h2z" opacity=".2"/></g></svg>',"table-cell-select-inner":'<svg width="24" height="24"><g fill-rule="evenodd"><path fill-rule="nonzero" d="M19 4a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V6c0-1.1.9-2 2-2h14zm0 2H5v12h14V6z" opacity=".2"/><path d="M13 6v5h6v2h-6v5h-2v-5H5v-2h6V6h2z"/></g></svg>',"table-delete-column":'<svg width="24" height="24"><path fill-rule="nonzero" d="M19 4a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V6c0-1.1.9-2 2-2h14zm-4 4h-2V6h-2v2H9V6H5v12h4v-2h2v2h2v-2h2v2h4V6h-4v2zm.3.5l1 1.2-3 2.3 3 2.3-1 1.2L12 13l-3.3 2.6-1-1.2 3-2.3-3-2.3 1-1.2L12 11l3.3-2.5z"/></svg>',"table-delete-row":'<svg width="24" height="24"><path fill-rule="nonzero" d="M19 4a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V6c0-1.1.9-2 2-2h14zm0 2H5v3h2.5v2H5v2h2.5v2H5v3h14v-3h-2.5v-2H19v-2h-2.5V9H19V6zm-4.7 1.8l1.2 1L13 12l2.6 3.3-1.2 1-2.3-3-2.3 3-1.2-1L11 12 8.5 8.7l1.2-1 2.3 3 2.3-3z"/></svg>',"table-delete-table":'<svg width="24" height="24"><g fill-rule="nonzero"><path d="M19 4a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V6c0-1.1.9-2 2-2h14zM5 6v12h14V6H5z"/><path d="M14.4 8.6l1 1-2.3 2.4 2.3 2.4-1 1-2.4-2.3-2.4 2.3-1-1 2.3-2.4-2.3-2.4 1-1 2.4 2.3z"/></g></svg>',"table-insert-column-after":'<svg width="24" height="24"><path fill-rule="nonzero" d="M20 4c.6 0 1 .4 1 1v2a1 1 0 0 1-2 0V6h-8v12h8v-1a1 1 0 0 1 2 0v2c0 .5-.4 1-.9 1H5a2 2 0 0 1-2-2V6c0-1.1.9-2 2-2h15zM9 13H5v5h4v-5zm7-5c.5 0 1 .4 1 .9V11h2a1 1 0 0 1 .1 2H17v2a1 1 0 0 1-2 .1V13h-2a1 1 0 0 1-.1-2H15V9c0-.6.4-1 1-1zM9 6H5v5h4V6z"/></svg>',"table-insert-column-before":'<svg width="24" height="24"><path fill-rule="nonzero" d="M19 4a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H4a1 1 0 0 1-1-1v-2a1 1 0 0 1 2 0v1h8V6H5v1a1 1 0 1 1-2 0V5c0-.6.4-1 1-1h15zm0 9h-4v5h4v-5zM8 8c.5 0 1 .4 1 .9V11h2a1 1 0 0 1 .1 2H9v2a1 1 0 0 1-2 .1V13H5a1 1 0 0 1-.1-2H7V9c0-.6.4-1 1-1zm11-2h-4v5h4V6z"/></svg>',"table-insert-row-above":'<svg width="24" height="24"><path fill-rule="nonzero" d="M6 4a1 1 0 1 1 0 2H5v6h14V6h-1a1 1 0 0 1 0-2h2c.6 0 1 .4 1 1v13a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5c0-.6.4-1 1-1h2zm5 10H5v4h6v-4zm8 0h-6v4h6v-4zM12 3c.5 0 1 .4 1 .9V6h2a1 1 0 0 1 0 2h-2v2a1 1 0 0 1-2 .1V8H9a1 1 0 0 1 0-2h2V4c0-.6.4-1 1-1z"/></svg>',"table-insert-row-after":'<svg width="24" height="24"><path fill-rule="nonzero" d="M12 13c.5 0 1 .4 1 .9V16h2a1 1 0 0 1 .1 2H13v2a1 1 0 0 1-2 .1V18H9a1 1 0 0 1-.1-2H11v-2c0-.6.4-1 1-1zm6 7a1 1 0 0 1 0-2h1v-6H5v6h1a1 1 0 0 1 0 2H4a1 1 0 0 1-1-1V6c0-1.1.9-2 2-2h14a2 2 0 0 1 2 2v13c0 .5-.4 1-.9 1H18zM11 6H5v4h6V6zm8 0h-6v4h6V6z"/></svg>',"table-left-header":'<svg width="24" height="24"><path d="M19 4a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V6c0-1.1.9-2 2-2h14zm0 9h-4v5h4v-5zm-6 0H9v5h4v-5zm0-7H9v5h4V6zm6 0h-4v5h4V6z"/></svg>',"table-merge-cells":'<svg width="24" height="24"><path fill-rule="nonzero" d="M19 4a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V6c0-1.1.9-2 2-2h14zM5 15.5V18h3v-2.5H5zm14-5h-9V18h9v-7.5zM19 6h-4v2.5h4V6zM8 6H5v2.5h3V6zm5 0h-3v2.5h3V6zm-8 7.5h3v-3H5v3z"/></svg>',"table-row-properties":'<svg width="24" height="24"><path fill-rule="nonzero" d="M19 4a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V6c0-1.1.9-2 2-2h14zM5 15v3h6v-3H5zm14 0h-6v3h6v-3zm0-9h-6v3h6V6zM5 9h6V6H5v3z"/></svg>',"table-split-cells":'<svg width="24" height="24"><path fill-rule="nonzero" d="M19 4a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V6c0-1.1.9-2 2-2h14zM8 15.5H5V18h3v-2.5zm11-5h-9V18h9v-7.5zm-2.5 1l1 1-2 2 2 2-1 1-2-2-2 2-1-1 2-2-2-2 1-1 2 2 2-2zm-8.5-1H5v3h3v-3zM19 6h-4v2.5h4V6zM8 6H5v2.5h3V6zm5 0h-3v2.5h3V6z"/></svg>',"table-top-header":'<svg width="24" height="24"><path d="M19 4a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V6c0-1.1.9-2 2-2h14zm-8 11H5v3h6v-3zm8 0h-6v3h6v-3zm0-5h-6v3h6v-3zM5 13h6v-3H5v3z"/></svg>',table:'<svg width="24" height="24"><path fill-rule="nonzero" d="M19 4a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V6c0-1.1.9-2 2-2h14zM5 14v4h6v-4H5zm14 0h-6v4h6v-4zm0-6h-6v4h6V8zM5 12h6V8H5v4z"/></svg>',template:'<svg width="24" height="24"><path d="M19 19v-1H5v1h14zM9 16v-4a5 5 0 1 1 6 0v4h4a2 2 0 0 1 2 2v3H3v-3c0-1.1.9-2 2-2h4zm4 0v-5l.8-.6a3 3 0 1 0-3.6 0l.8.6v5h2z" fill-rule="nonzero"/></svg>',"temporary-placeholder":'<svg width="24" height="24"><g fill-rule="evenodd"><path d="M9 7.6V6h2.5V4.5a.5.5 0 1 1 1 0V6H15v1.6a8 8 0 1 1-6 0zm-2.6 5.3a.5.5 0 0 0 .3.6c.3 0 .6 0 .6-.3l.1-.2a5 5 0 0 1 3.3-2.8c.3-.1.4-.4.4-.6-.1-.3-.4-.5-.6-.4a6 6 0 0 0-4.1 3.7z"/><circle cx="14" cy="4" r="1"/><circle cx="12" cy="2" r="1"/><circle cx="10" cy="4" r="1"/></g></svg>',"text-color":'<svg width="24" height="24"><g fill-rule="evenodd"><path id="tox-icon-text-color__color" d="M3 18h18v3H3z"/><path d="M8.7 16h-.8a.5.5 0 0 1-.5-.6l2.7-9c.1-.3.3-.4.5-.4h2.8c.2 0 .4.1.5.4l2.7 9a.5.5 0 0 1-.5.6h-.8a.5.5 0 0 1-.4-.4l-.7-2.2c0-.3-.3-.4-.5-.4h-3.4c-.2 0-.4.1-.5.4l-.7 2.2c0 .3-.2.4-.4.4zm2.6-7.6l-.6 2a.5.5 0 0 0 .5.6h1.6a.5.5 0 0 0 .5-.6l-.6-2c0-.3-.3-.4-.5-.4h-.4c-.2 0-.4.1-.5.4z"/></g></svg>',toc:'<svg width="24" height="24"><path d="M5 5c.6 0 1 .4 1 1s-.4 1-1 1a1 1 0 1 1 0-2zm3 0h11c.6 0 1 .4 1 1s-.4 1-1 1H8a1 1 0 1 1 0-2zm-3 8c.6 0 1 .4 1 1s-.4 1-1 1a1 1 0 0 1 0-2zm3 0h11c.6 0 1 .4 1 1s-.4 1-1 1H8a1 1 0 0 1 0-2zm0-4c.6 0 1 .4 1 1s-.4 1-1 1a1 1 0 1 1 0-2zm3 0h8c.6 0 1 .4 1 1s-.4 1-1 1h-8a1 1 0 0 1 0-2zm-3 8c.6 0 1 .4 1 1s-.4 1-1 1a1 1 0 0 1 0-2zm3 0h8c.6 0 1 .4 1 1s-.4 1-1 1h-8a1 1 0 0 1 0-2z" fill-rule="evenodd"/></svg>',translate:'<svg width="24" height="24"><path d="M12.7 14.3l-.3.7-.4.7-2.2-2.2-3.1 3c-.3.4-.8.4-1 0a.7.7 0 0 1 0-1l3.1-3A12.4 12.4 0 0 1 6.7 9H8a10.1 10.1 0 0 0 1.7 2.4c.5-.5 1-1.1 1.4-1.8l.9-2H4.7a.7.7 0 1 1 0-1.5h4.4v-.7c0-.4.3-.8.7-.8.4 0 .7.4.7.8v.7H15c.4 0 .8.3.8.7 0 .4-.4.8-.8.8h-1.4a12.3 12.3 0 0 1-1 2.4 13.5 13.5 0 0 1-1.7 2.3l1.9 1.8zm4.3-3l2.7 7.3a.5.5 0 0 1-.4.7 1 1 0 0 1-1-.7l-.6-1.5h-3.4l-.6 1.5a1 1 0 0 1-1 .7.5.5 0 0 1-.4-.7l2.7-7.4a1 1 0 1 1 2 0zm-2.2 4.4h2.4L16 12.5l-1.2 3.2z" fill-rule="evenodd"/></svg>',underline:'<svg width="24" height="24"><path d="M16 5c.6 0 1 .4 1 1v5.5a4 4 0 0 1-.4 1.8l-1 1.4a5.3 5.3 0 0 1-5.5 1 5 5 0 0 1-1.6-1c-.5-.4-.8-.9-1.1-1.4a4 4 0 0 1-.4-1.8V6c0-.6.4-1 1-1s1 .4 1 1v5.5c0 .3 0 .6.2 1l.6.7a3.3 3.3 0 0 0 2.2.8 3.4 3.4 0 0 0 2.2-.8c.3-.2.4-.5.6-.8l.2-.9V6c0-.6.4-1 1-1zM8 17h8c.6 0 1 .4 1 1s-.4 1-1 1H8a1 1 0 0 1 0-2z" fill-rule="evenodd"/></svg>',undo:'<svg width="24" height="24"><path d="M6.4 8H12c3.7 0 6.2 2 6.8 5.1.6 2.7-.4 5.6-2.3 6.8a1 1 0 0 1-1-1.8c1.1-.6 1.8-2.7 1.4-4.6-.5-2.1-2.1-3.5-4.9-3.5H6.4l3.3 3.3a1 1 0 1 1-1.4 1.4l-5-5a1 1 0 0 1 0-1.4l5-5a1 1 0 0 1 1.4 1.4L6.4 8z" fill-rule="nonzero"/></svg>',unlink:'<svg width="24" height="24"><path d="M6.2 12.3a1 1 0 0 1 1.4 1.4l-2 2a2 2 0 1 0 2.6 2.8l4.8-4.8a1 1 0 0 0 0-1.4 1 1 0 1 1 1.4-1.3 2.9 2.9 0 0 1 0 4L9.6 20a3.9 3.9 0 0 1-5.5-5.5l2-2zm11.6-.6a1 1 0 0 1-1.4-1.4l2.1-2a2 2 0 1 0-2.7-2.8L11 10.3a1 1 0 0 0 0 1.4A1 1 0 1 1 9.6 13a2.9 2.9 0 0 1 0-4L14.4 4a3.9 3.9 0 0 1 5.5 5.5l-2 2zM7.6 6.3a.8.8 0 0 1-1 1.1L3.3 4.2a.7.7 0 1 1 1-1l3.2 3.1zM5.1 8.6a.8.8 0 0 1 0 1.5H3a.8.8 0 0 1 0-1.5H5zm5-3.5a.8.8 0 0 1-1.5 0V3a.8.8 0 0 1 1.5 0V5zm6 11.8a.8.8 0 0 1 1-1l3.2 3.2a.8.8 0 0 1-1 1L16 17zm-2.2 2a.8.8 0 0 1 1.5 0V21a.8.8 0 0 1-1.5 0V19zm5-3.5a.7.7 0 1 1 0-1.5H21a.8.8 0 0 1 0 1.5H19z" fill-rule="nonzero"/></svg>',unlock:'<svg width="24" height="24"><path d="M16 5c.8 0 1.5.3 2.1.9.6.6.9 1.3.9 2.1v3h-2V8a1 1 0 0 0-.3-.7A1 1 0 0 0 16 7h-2a1 1 0 0 0-.7.3 1 1 0 0 0-.3.7v3h.3c.2 0 .3 0 .5.2l.2.6v7.4c0 .3 0 .4-.2.6l-.6.2H4.8c-.3 0-.4 0-.6-.2a.7.7 0 0 1-.2-.6v-7.4c0-.3 0-.4.2-.6l.5-.2H11V8c0-.8.3-1.5.9-2.1.6-.6 1.3-.9 2.1-.9h2z" fill-rule="evenodd"/></svg>',"unordered-list":'<svg width="24" height="24"><path d="M11 5h8c.6 0 1 .4 1 1s-.4 1-1 1h-8a1 1 0 0 1 0-2zm0 6h8c.6 0 1 .4 1 1s-.4 1-1 1h-8a1 1 0 0 1 0-2zm0 6h8c.6 0 1 .4 1 1s-.4 1-1 1h-8a1 1 0 0 1 0-2zM4.5 6c0-.4.1-.8.4-1 .3-.4.7-.5 1.1-.5.4 0 .8.1 1 .4.4.3.5.7.5 1.1 0 .4-.1.8-.4 1-.3.4-.7.5-1.1.5-.4 0-.8-.1-1-.4-.4-.3-.5-.7-.5-1.1zm0 6c0-.4.1-.8.4-1 .3-.4.7-.5 1.1-.5.4 0 .8.1 1 .4.4.3.5.7.5 1.1 0 .4-.1.8-.4 1-.3.4-.7.5-1.1.5-.4 0-.8-.1-1-.4-.4-.3-.5-.7-.5-1.1zm0 6c0-.4.1-.8.4-1 .3-.4.7-.5 1.1-.5.4 0 .8.1 1 .4.4.3.5.7.5 1.1 0 .4-.1.8-.4 1-.3.4-.7.5-1.1.5-.4 0-.8-.1-1-.4-.4-.3-.5-.7-.5-1.1z" fill-rule="evenodd"/></svg>',unselected:'<svg width="24" height="24"><path fill-rule="nonzero" d="M6 4h12a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6c0-1.1.9-2 2-2zm0 1a1 1 0 0 0-1 1v12c0 .6.4 1 1 1h12c.6 0 1-.4 1-1V6c0-.6-.4-1-1-1H6z"/></svg>',upload:'<svg width="24" height="24"><path d="M18 19v-2a1 1 0 0 1 2 0v3c0 .6-.4 1-1 1H5a1 1 0 0 1-1-1v-3a1 1 0 0 1 2 0v2h12zM11 6.4L8.7 8.7a1 1 0 0 1-1.4-1.4l4-4a1 1 0 0 1 1.4 0l4 4a1 1 0 1 1-1.4 1.4L13 6.4V16a1 1 0 0 1-2 0V6.4z" fill-rule="nonzero"/></svg>',user:'<svg width="24" height="24"><path d="M12 24a12 12 0 1 1 0-24 12 12 0 0 1 0 24zm-8.7-5.3a11 11 0 0 0 17.4 0C19.4 16.3 14.6 15 12 15c-2.6 0-7.4 1.3-8.7 3.7zM12 13c2.2 0 4-2 4-4.5S14.2 4 12 4 8 6 8 8.5 9.8 13 12 13z" fill-rule="nonzero"/></svg>',visualblocks:'<svg width="24" height="24"><path d="M9 19v2H7v-2h2zm-4 0v2a2 2 0 0 1-2-2h2zm8 0v2h-2v-2h2zm8 0a2 2 0 0 1-2 2v-2h2zm-4 0v2h-2v-2h2zM15 7a1 1 0 0 1 0 2v7a1 1 0 0 1-2 0V9h-1v7a1 1 0 0 1-2 0v-4a2.5 2.5 0 0 1-.2-5H15zM5 15v2H3v-2h2zm16 0v2h-2v-2h2zM5 11v2H3v-2h2zm16 0v2h-2v-2h2zM5 7v2H3V7h2zm16 0v2h-2V7h2zM5 3v2H3c0-1.1.9-2 2-2zm8 0v2h-2V3h2zm6 0a2 2 0 0 1 2 2h-2V3zM9 3v2H7V3h2zm8 0v2h-2V3h2z" fill-rule="evenodd"/></svg>',visualchars:'<svg width="24" height="24"><path d="M10 5h7a1 1 0 0 1 0 2h-1v11a1 1 0 0 1-2 0V7h-2v11a1 1 0 0 1-2 0v-6c-.5 0-1 0-1.4-.3A3.4 3.4 0 0 1 6.8 10a3.3 3.3 0 0 1 0-2.8 3.4 3.4 0 0 1 1.8-1.8L10 5z" fill-rule="evenodd"/></svg>',warning:'<svg width="24" height="24"><path d="M19.8 18.3c.2.5.3.9 0 1.2-.1.3-.5.5-1 .5H5.2c-.5 0-.9-.2-1-.5-.3-.3-.2-.7 0-1.2L11 4.7l.5-.5.5-.2c.2 0 .3 0 .5.2.2 0 .3.3.5.5l6.8 13.6zM12 18c.3 0 .5-.1.7-.3.2-.2.3-.4.3-.7a1 1 0 0 0-.3-.7 1 1 0 0 0-.7-.3 1 1 0 0 0-.7.3 1 1 0 0 0-.3.7c0 .3.1.5.3.7.2.2.4.3.7.3zm.7-3l.3-4a1 1 0 0 0-.3-.7 1 1 0 0 0-.7-.3 1 1 0 0 0-.7.3 1 1 0 0 0-.3.7l.3 4h1.4z" fill-rule="evenodd"/></svg>',"zoom-in":'<svg width="24" height="24"><path d="M16 17.3a8 8 0 1 1 1.4-1.4l4.3 4.4a1 1 0 0 1-1.4 1.4l-4.4-4.3zm-5-.3a6 6 0 1 0 0-12 6 6 0 0 0 0 12zm-1-9a1 1 0 0 1 2 0v6a1 1 0 0 1-2 0V8zm-2 4a1 1 0 0 1 0-2h6a1 1 0 0 1 0 2H8z" fill-rule="nonzero"/></svg>',"zoom-out":'<svg width="24" height="24"><path d="M16 17.3a8 8 0 1 1 1.4-1.4l4.3 4.4a1 1 0 0 1-1.4 1.4l-4.4-4.3zm-5-.3a6 6 0 1 0 0-12 6 6 0 0 0 0 12zm-3-5a1 1 0 0 1 0-2h6a1 1 0 0 1 0 2H8z" fill-rule="nonzero"/></svg>'}),IconManager.get(iconPackName).icons);each$1(loadIcons,function(svgData,icon){has(currentIcons,icon)||editor.ui.registry.addIcon(icon,svgData)})}(editor),function(editor){var theme=editor.settings.theme;if(isString(theme)){editor.settings.theme=trimLegacyPrefix(theme);var Theme=ThemeManager.get(theme);editor.theme=new Theme(editor,ThemeManager.urls[theme]),editor.theme.init&&editor.theme.init(editor,ThemeManager.urls[theme]||editor.documentBaseUrl.replace(/\/$/,""),editor.$)}else editor.theme={}}(editor),function(editor){var initializedPlugins=[];Tools.each(editor.settings.plugins.split(/[ ,]/),function(name){initPlugin(editor,initializedPlugins,trimLegacyPrefix(name))})}(editor);var boxInfo=function(editor){var elm=editor.getElement();return editor.orgDisplay=elm.style.display,isString(editor.settings.theme)?function(editor){return editor.theme.renderUI()}(editor):isFunction(editor.settings.theme)?function(editor){var elm=editor.getElement(),info=(0,editor.settings.theme)(editor,elm);return info.editorContainer.nodeType&&(info.editorContainer.id=info.editorContainer.id||editor.id+"_parent"),info.iframeContainer&&info.iframeContainer.nodeType&&(info.iframeContainer.id=info.iframeContainer.id||editor.id+"_iframecontainer"),info.height=info.iframeHeight?info.iframeHeight:elm.offsetHeight,info}(editor):renderThemeFalse(editor)}(editor);return editor.editorContainer=boxInfo.editorContainer?boxInfo.editorContainer:null,appendContentCssFromSettings(editor),editor.inline?InitContentBody_initContentBody(editor):InitIframe_init(editor,boxInfo)},DOM$7=DOMUtils$1.DOM,Render_render=function(editor){var settings=editor.settings,id=editor.id;I18n.setCode(Settings_getLanguageCode(editor));var readyHandler=function(){DOM$7.unbind(domGlobals.window,"ready",readyHandler),editor.render()};if(EventUtils.Event.domLoaded){if(editor.getElement()&&Env.contentEditable){settings.inline?editor.inline=!0:(editor.orgVisibility=editor.getElement().style.visibility,editor.getElement().style.visibility="hidden");var form=editor.getElement().form||DOM$7.getParent(id,"form");form&&(editor.formElement=form,settings.hidden_input&&!NodeType.isTextareaOrInput(editor.getElement())&&(DOM$7.insertAfter(DOM$7.create("input",{type:"hidden",name:id}),id),editor.hasHiddenInput=!0),editor.formEventDelegate=function(e){editor.fire(e.type,e)},DOM$7.bind(form,"submit reset",editor.formEventDelegate),editor.on("reset",function(){editor.resetContent()}),!settings.submit_patch||form.submit.nodeType||form.submit.length||form._mceOldSubmit||(form._mceOldSubmit=form.submit,form.submit=function(){return editor.editorManager.triggerSave(),editor.setDirty(!1),form._mceOldSubmit(form)})),editor.windowManager=WindowManager(editor),editor.notificationManager=NotificationManager(editor),"xml"===settings.encoding&&editor.on("GetContent",function(e){e.save&&(e.content=DOM$7.encode(e.content))}),settings.add_form_submit_trigger&&editor.on("submit",function(){editor.initialized&&editor.save()}),settings.add_unload_trigger&&(editor._beforeUnload=function(){!editor.initialized||editor.destroyed||editor.isHidden()||editor.save({format:"raw",no_events:!0,set_dirty:!1})},editor.editorManager.on("BeforeUnload",editor._beforeUnload)),editor.editorManager.add(editor),loadScripts(editor,editor.suffix)}}else DOM$7.bind(domGlobals.window,"ready",readyHandler)},InsertList_isListFragment=function(schema,fragment){var firstChild=fragment.firstChild,lastChild=fragment.lastChild;return firstChild&&"meta"===firstChild.name&&(firstChild=firstChild.next),lastChild&&"mce_marker"===lastChild.attr("id")&&(lastChild=lastChild.prev),function(schema,node){var nonEmptyElements=schema.getNonEmptyElements();return node&&(node.isEmpty(nonEmptyElements)||function(schema,node){return schema.getBlockElements()[node.name]&&function(node){return node.firstChild&&node.firstChild===node.lastChild}(node)&&function(node){return"br"===node.name||""===node.value}(node.firstChild)}(schema,node))}(schema,lastChild)&&(lastChild=lastChild.prev),!(!firstChild||firstChild!==lastChild)&&("ul"===firstChild.name||"ol"===firstChild.name)},InsertList_insertAtCaret=function(serializer,dom,rng,fragment){function isAt(location){var caretPos=CaretPosition$1.fromRangeStart(rng),caretWalker=CaretWalker(dom.getRoot()),newPos=1===location?caretWalker.prev(caretPos):caretWalker.next(caretPos);return!newPos||getParentLi(dom,newPos.getNode())!==liTarget}var domFragment=function(dom,serializer,fragment){var html=serializer.serialize(fragment);return function(domFragment){var firstChild=domFragment.firstChild,lastChild=domFragment.lastChild;return firstChild&&"META"===firstChild.nodeName&&firstChild.parentNode.removeChild(firstChild),lastChild&&"mce_marker"===lastChild.id&&lastChild.parentNode.removeChild(lastChild),domFragment}(dom.createFragment(html))}(dom,serializer,fragment),liTarget=getParentLi(dom,rng.startContainer),liElms=trimListItems(listItems$1(domFragment.firstChild)),rootNode=dom.getRoot();return isAt(1)?insertBefore$1(liTarget,liElms,rootNode):isAt(2)?function(target,elms,rootNode,dom){return dom.insertAfter(elms.reverse(),target),findLastOf(elms[0],rootNode)}(liTarget,liElms,rootNode,dom):function(target,elms,rootNode,rng){var parts=function(parentNode,rng){var beforeRng=rng.cloneRange(),afterRng=rng.cloneRange();return beforeRng.setStartBefore(parentNode),afterRng.setEndAfter(parentNode),[beforeRng.cloneContents(),afterRng.cloneContents()]}(target,rng),parentElm=target.parentNode;return parentElm.insertBefore(parts[0],target),Tools.each(elms,function(li){parentElm.insertBefore(li,target)}),parentElm.insertBefore(parts[1],target),parentElm.removeChild(target),findLastOf(elms[elms.length-1],rootNode)}(liTarget,liElms,rootNode,rng)},InsertList_isParentBlockLi=function(dom,node){return!!getParentLi(dom,node)},isTableCell$5=NodeType.matchNodeNames(["td","th"]),InsertContent_insertAtCaret=function(editor,value){var result=function(value){var details;return"string"!=typeof value?(details=Tools.extend({paste:value.paste,data:{paste:value.paste}},value),{content:value.content,details:details}):{content:value,details:{}}}(value);insertHtmlAtCaret(editor,result.content,result.details)},DeleteCommands_deleteCommand=function(editor){Outdent_backspaceDelete(editor,!1)||CefDelete_backspaceDelete(editor,!1)||CefBoundaryDelete_backspaceDelete(editor,!1)||BoundaryDelete_backspaceDelete(editor,!1)||BlockBoundaryDelete_backspaceDelete(editor,!1)||TableDelete_backspaceDelete(editor)||BlockRangeDelete_backspaceDelete(editor,!1)||InlineFormatDelete_backspaceDelete(editor,!1)||(nativeCommand(editor,"Delete"),DeleteUtils_paddEmptyBody(editor))},DeleteCommands_forwardDeleteCommand=function(editor){CefDelete_backspaceDelete(editor,!0)||CefBoundaryDelete_backspaceDelete(editor,!0)||BoundaryDelete_backspaceDelete(editor,!0)||BlockBoundaryDelete_backspaceDelete(editor,!0)||TableDelete_backspaceDelete(editor)||BlockRangeDelete_backspaceDelete(editor,!0)||InlineFormatDelete_backspaceDelete(editor,!0)||nativeCommand(editor,"ForwardDelete")},legacyPropNames={"font-size":"size","font-family":"face"},FontInfo={getFontSize:getFontProp("font-size"),getFontFamily:compose(function(fontFamily){return fontFamily.replace(/[\'\"\\]/g,"").replace(/,\s+/g,",")},getFontProp("font-family")),toPt:function(fontSize,precision){return/[0-9.]+px$/.test(fontSize)?function(number,precision){var factor=Math.pow(10,precision);return Math.round(number*factor)/factor}(72*parseInt(fontSize,10)/96,precision||0)+"pt":fontSize}},each$f=Tools.each,map$3=Tools.map,inArray$2=Tools.inArray,EditorCommands=function(){function EditorCommands(editor){this.commands={state:{},exec:{},value:{}},this.editor=editor,this.setupCommands(editor)}return EditorCommands.prototype.execCommand=function(command,ui,value,args){var func,customCommand,state=!1,self=this;if(!self.editor.removed){if(/^(mceAddUndoLevel|mceEndUndoLevel|mceBeginUndoLevel|mceRepaint)$/.test(command)||args&&args.skip_focus?SelectionBookmark_restore(self.editor):self.editor.focus(),(args=self.editor.fire("BeforeExecCommand",{command:command,ui:ui,value:value})).isDefaultPrevented())return!1;if(customCommand=command.toLowerCase(),func=self.commands.exec[customCommand])return func(customCommand,ui,value),self.editor.fire("ExecCommand",{command:command,ui:ui,value:value}),!0;if(each$f(this.editor.plugins,function(p){if(p.execCommand&&p.execCommand(command,ui,value))return self.editor.fire("ExecCommand",{command:command,ui:ui,value:value}),!(state=!0)}),state)return state;if(self.editor.theme&&self.editor.theme.execCommand&&self.editor.theme.execCommand(command,ui,value))return self.editor.fire("ExecCommand",{command:command,ui:ui,value:value}),!0;try{state=self.editor.getDoc().execCommand(command,ui,value)}catch(ex){}return!!state&&(self.editor.fire("ExecCommand",{command:command,ui:ui,value:value}),!0)}},EditorCommands.prototype.queryCommandState=function(command){var func;if(!this.editor.quirks.isHidden()&&!this.editor.removed){if(command=command.toLowerCase(),func=this.commands.state[command])return func(command);try{return this.editor.getDoc().queryCommandState(command)}catch(ex){}return!1}},EditorCommands.prototype.queryCommandValue=function(command){var func;if(!this.editor.quirks.isHidden()&&!this.editor.removed){if(command=command.toLowerCase(),func=this.commands.value[command])return func(command);try{return this.editor.getDoc().queryCommandValue(command)}catch(ex){}}},EditorCommands.prototype.addCommands=function(commandList,type){var self=this;type=type||"exec",each$f(commandList,function(callback,command){each$f(command.toLowerCase().split(","),function(command){self.commands[type][command]=callback})})},EditorCommands.prototype.addCommand=function(command,callback,scope){var _this=this;command=command.toLowerCase(),this.commands.exec[command]=function(command,ui,value,args){return callback.call(scope||_this.editor,ui,value,args)}},EditorCommands.prototype.queryCommandSupported=function(command){if(command=command.toLowerCase(),this.commands.exec[command])return!0;try{return this.editor.getDoc().queryCommandSupported(command)}catch(ex){}return!1},EditorCommands.prototype.addQueryStateHandler=function(command,callback,scope){var _this=this;command=command.toLowerCase(),this.commands.state[command]=function(){return callback.call(scope||_this.editor)}},EditorCommands.prototype.addQueryValueHandler=function(command,callback,scope){var _this=this;command=command.toLowerCase(),this.commands.value[command]=function(){return callback.call(scope||_this.editor)}},EditorCommands.prototype.hasCustomCommand=function(command){return command=command.toLowerCase(),!!this.commands.exec[command]},EditorCommands.prototype.execNativeCommand=function(command,ui,value){return void 0===ui&&(ui=!1),void 0===value&&(value=null),this.editor.getDoc().execCommand(command,ui,value)},EditorCommands.prototype.isFormatMatch=function(name){return this.editor.formatter.match(name)},EditorCommands.prototype.toggleFormat=function(name,value){this.editor.formatter.toggle(name,value?{value:value}:void 0),this.editor.nodeChanged()},EditorCommands.prototype.storeSelection=function(type){this.selectionBookmark=this.editor.selection.getBookmark(type)},EditorCommands.prototype.restoreSelection=function(){this.editor.selection.moveToBookmark(this.selectionBookmark)},EditorCommands.prototype.setupCommands=function(editor){var self=this;this.addCommands({"mceResetDesignMode,mceBeginUndoLevel":function(){},"mceEndUndoLevel,mceAddUndoLevel":function(){editor.undoManager.add()},"Cut,Copy,Paste":function(command){var failed,doc=editor.getDoc();try{self.execNativeCommand(command)}catch(ex){failed=!0}if("paste"!==command||doc.queryCommandEnabled(command)||(failed=!0),failed||!doc.queryCommandSupported(command)){var msg=editor.translate("Your browser doesn't support direct access to the clipboard. Please use the Ctrl+X/C/V keyboard shortcuts instead.");Env.mac&&(msg=msg.replace(/Ctrl\+/g,"+")),editor.notificationManager.open({text:msg,type:"error"})}},unlink:function(){if(editor.selection.isCollapsed()){var elm=editor.dom.getParent(editor.selection.getStart(),"a");elm&&editor.dom.remove(elm,!0)}else editor.formatter.remove("link")},"JustifyLeft,JustifyCenter,JustifyRight,JustifyFull,JustifyNone":function(command){var align=command.substring(7);"full"===align&&(align="justify"),each$f("left,center,right,justify".split(","),function(name){align!==name&&editor.formatter.remove("align"+name)}),"none"!==align&&self.toggleFormat("align"+align)},"InsertUnorderedList,InsertOrderedList":function(command){var listElm,listParent;self.execNativeCommand(command),(listElm=editor.dom.getParent(editor.selection.getNode(),"ol,ul"))&&(listParent=listElm.parentNode,/^(H[1-6]|P|ADDRESS|PRE)$/.test(listParent.nodeName)&&(self.storeSelection(),editor.dom.split(listParent,listElm),self.restoreSelection()))},"Bold,Italic,Underline,Strikethrough,Superscript,Subscript":function(command){self.toggleFormat(command)},"ForeColor,HiliteColor":function(command,ui,value){self.toggleFormat(command,value)},FontName:function(command,ui,value){fontNameAction(editor,value)},FontSize:function(command,ui,value){!function(editor,value){editor.formatter.toggle("fontsize",{value:fromFontSizeNumber(editor,value)}),editor.nodeChanged()}(editor,value)},RemoveFormat:function(command){editor.formatter.remove(command)},mceBlockQuote:function(){self.toggleFormat("blockquote")},FormatBlock:function(command,ui,value){return self.toggleFormat(value||"p")},mceCleanup:function(){var bookmark=editor.selection.getBookmark();editor.setContent(editor.getContent()),editor.selection.moveToBookmark(bookmark)},mceRemoveNode:function(command,ui,value){var node=value||editor.selection.getNode();node!==editor.getBody()&&(self.storeSelection(),editor.dom.remove(node,!0),self.restoreSelection())},mceSelectNodeDepth:function(command,ui,value){var counter=0;editor.dom.getParent(editor.selection.getNode(),function(node){if(1===node.nodeType&&counter++===value)return editor.selection.select(node),!1},editor.getBody())},mceSelectNode:function(command,ui,value){editor.selection.select(value)},mceInsertContent:function(command,ui,value){InsertContent_insertAtCaret(editor,value)},mceInsertRawHTML:function(command,ui,value){editor.selection.setContent("tiny_mce_marker");var content=editor.getContent();editor.setContent(content.replace(/tiny_mce_marker/g,function(){return value}))},mceInsertNewLine:function(command,ui,value){InsertNewLine_insert(editor,value)},mceToggleFormat:function(command,ui,value){self.toggleFormat(value)},mceSetContent:function(command,ui,value){editor.setContent(value)},"Indent,Outdent":function(command){handle(editor,command)},mceRepaint:function(){},InsertHorizontalRule:function(){editor.execCommand("mceInsertContent",!1,"<hr />")},mceToggleVisualAid:function(){editor.hasVisual=!editor.hasVisual,editor.addVisual()},mceReplaceContent:function(command,ui,value){editor.execCommand("mceInsertContent",!1,value.replace(/\{\$selection\}/g,editor.selection.getContent({format:"text"})))},mceInsertLink:function(command,ui,value){var anchor;"string"==typeof value&&(value={href:value}),anchor=editor.dom.getParent(editor.selection.getNode(),"a"),value.href=value.href.replace(/ /g,"%20"),anchor&&value.href||editor.formatter.remove("link"),value.href&&editor.formatter.apply("link",value,anchor)},selectAll:function(){var editingHost=editor.dom.getParent(editor.selection.getStart(),NodeType.isContentEditableTrue);if(editingHost){var rng=editor.dom.createRng();rng.selectNodeContents(editingHost),editor.selection.setRng(rng)}},delete:function(){DeleteCommands_deleteCommand(editor)},forwardDelete:function(){DeleteCommands_forwardDeleteCommand(editor)},mceNewDocument:function(){editor.setContent("")},InsertLineBreak:function(command,ui,value){return InsertBr_insert(editor,value),!0}});function alignStates(name){return function(){var nodes=editor.selection.isCollapsed()?[editor.dom.getParent(editor.selection.getNode(),editor.dom.isBlock)]:editor.selection.getSelectedBlocks(),matches=map$3(nodes,function(node){return!!editor.formatter.matchNode(node,name)});return-1!==inArray$2(matches,!0)}}self.addCommands({JustifyLeft:alignStates("alignleft"),JustifyCenter:alignStates("aligncenter"),JustifyRight:alignStates("alignright"),JustifyFull:alignStates("alignjustify"),"Bold,Italic,Underline,Strikethrough,Superscript,Subscript":function(command){return self.isFormatMatch(command)},mceBlockQuote:function(){return self.isFormatMatch("blockquote")},Outdent:function(){return canOutdent(editor)},"InsertUnorderedList,InsertOrderedList":function(command){var list=editor.dom.getParent(editor.selection.getNode(),"ul,ol");return list&&("insertunorderedlist"===command&&"UL"===list.tagName||"insertorderedlist"===command&&"OL"===list.tagName)}},"state"),self.addCommands({Undo:function(){editor.undoManager.undo()},Redo:function(){editor.undoManager.redo()}}),self.addQueryValueHandler("FontName",function(){return function(editor){return getCaretElement(editor).fold(function(){return findFirstCaretElement(editor).map(function(caretElement){return FontInfo.getFontFamily(editor.getBody(),caretElement)}).getOr("")},function(caretElement){return FontInfo.getFontFamily(editor.getBody(),caretElement)})}(editor)},this),self.addQueryValueHandler("FontSize",function(){return function(editor){return getCaretElement(editor).fold(function(){return findFirstCaretElement(editor).map(function(caretElement){return FontInfo.getFontSize(editor.getBody(),caretElement)}).getOr("")},function(caretElement){return FontInfo.getFontSize(editor.getBody(),caretElement)})}(editor)},this)},EditorCommands}(),nativeEvents=Tools.makeMap("focus blur focusin focusout click dblclick mousedown mouseup mousemove mouseover beforepaste paste cut copy selectionchange mouseout mouseenter mouseleave wheel keydown keypress keyup input beforeinput contextmenu dragstart dragend dragover draggesture dragdrop drop drag submit compositionstart compositionend compositionupdate touchstart touchmove touchend touchcancel"," "),EventDispatcher=function(){function EventDispatcher(settings){this.bindings={},this.settings=settings||{},this.scope=this.settings.scope||this,this.toggleEvent=this.settings.toggleEvent||never}return EventDispatcher.isNative=function(name){return!!nativeEvents[name.toLowerCase()]},EventDispatcher.prototype.fire=function(name,args){var handlers,i,l,callback;if(name=name.toLowerCase(),(args=args||{}).type=name,args.target||(args.target=this.scope),args.preventDefault||(args.preventDefault=function(){args.isDefaultPrevented=always},args.stopPropagation=function(){args.isPropagationStopped=always},args.stopImmediatePropagation=function(){args.isImmediatePropagationStopped=always},args.isDefaultPrevented=never,args.isPropagationStopped=never,args.isImmediatePropagationStopped=never),this.settings.beforeFire&&this.settings.beforeFire(args),handlers=this.bindings[name])for(i=0,l=handlers.length;i<l;i++){if((callback=handlers[i]).once&&this.off(name,callback.func),args.isImmediatePropagationStopped())return args.stopPropagation(),args;if(!1===callback.func.call(this.scope,args))return args.preventDefault(),args}return args},EventDispatcher.prototype.on=function(name,callback,prepend,extra){var handlers,names,i;if(!1===callback&&(callback=never),callback){var wrappedCallback={func:callback};for(extra&&Tools.extend(wrappedCallback,extra),i=(names=name.toLowerCase().split(" ")).length;i--;)name=names[i],(handlers=this.bindings[name])||(handlers=this.bindings[name]=[],this.toggleEvent(name,!0)),prepend?handlers.unshift(wrappedCallback):handlers.push(wrappedCallback)}return this},EventDispatcher.prototype.off=function(name,callback){var i,handlers,bindingName,names,hi;if(name)for(i=(names=name.toLowerCase().split(" ")).length;i--;){if(name=names[i],handlers=this.bindings[name],!name){for(bindingName in this.bindings)this.toggleEvent(bindingName,!1),delete this.bindings[bindingName];return this}if(handlers){if(callback)for(hi=handlers.length;hi--;)handlers[hi].func===callback&&(handlers=handlers.slice(0,hi).concat(handlers.slice(hi+1)),this.bindings[name]=handlers);else handlers.length=0;handlers.length||(this.toggleEvent(name,!1),delete this.bindings[name])}}else{for(name in this.bindings)this.toggleEvent(name,!1);this.bindings={}}return this},EventDispatcher.prototype.once=function(name,callback,prepend){return this.on(name,callback,prepend,{once:!0})},EventDispatcher.prototype.has=function(name){return name=name.toLowerCase(),!(!this.bindings[name]||0===this.bindings[name].length)},EventDispatcher}(),Observable={fire:function(name,args,bubble){if(this.removed&&"remove"!==name&&"detach"!==name)return args;var dispatcherArgs=getEventDispatcher(this).fire(name,args);if(!1!==bubble&&this.parent)for(var parent_1=this.parent();parent_1&&!dispatcherArgs.isPropagationStopped();)parent_1.fire(name,dispatcherArgs,!1),parent_1=parent_1.parent();return dispatcherArgs},on:function(name,callback,prepend){return getEventDispatcher(this).on(name,callback,prepend)},off:function(name,callback){return getEventDispatcher(this).off(name,callback)},once:function(name,callback){return getEventDispatcher(this).once(name,callback)},hasEventListeners:function(name){return getEventDispatcher(this).has(name)}},DOM$8=DOMUtils$1.DOM,EditorObservable=__assign(__assign({},Observable),{bindPendingEventDelegates:function(){var self=this;Tools.each(self._pendingNativeEvents,function(name){bindEventDelegate(self,name)})},toggleNativeEvent:function(name,state){"focus"!==name&&"blur"!==name&&(state?this.initialized?bindEventDelegate(this,name):this._pendingNativeEvents?this._pendingNativeEvents.push(name):this._pendingNativeEvents=[name]:this.initialized&&(this.dom.unbind(getEventTarget(this,name),name,this.delegates[name]),delete this.delegates[name]))},unbindAllNativeEvents:function(){var name,body=this.getBody(),dom=this.dom;if(this.delegates){for(name in this.delegates)this.dom.unbind(getEventTarget(this,name),name,this.delegates[name]);delete this.delegates}!this.inline&&body&&dom&&(body.onload=null,dom.unbind(this.getWin()),dom.unbind(this.getDoc())),dom&&(dom.unbind(body),dom.unbind(this.getContainer()))}}),defaultModes=["design","readonly"],each$g=Tools.each,explode$3=Tools.explode,keyCodeLookup={f1:112,f2:113,f3:114,f4:115,f5:116,f6:117,f7:118,f8:119,f9:120,f10:121,f11:122,f12:123},modifierNames=Tools.makeMap("alt,ctrl,shift,meta,access"),Shortcuts=function(){function Shortcuts(editor){this.shortcuts={},this.pendingPatterns=[],this.editor=editor;var self=this;editor.on("keyup keypress keydown",function(e){!self.hasModifier(e)&&!self.isFunctionKey(e)||e.isDefaultPrevented()||(each$g(self.shortcuts,function(shortcut){if(self.matchShortcut(e,shortcut))return self.pendingPatterns=shortcut.subpatterns.slice(0),"keydown"===e.type&&self.executeShortcutAction(shortcut),!0}),self.matchShortcut(e,self.pendingPatterns[0])&&(1===self.pendingPatterns.length&&"keydown"===e.type&&self.executeShortcutAction(self.pendingPatterns[0]),self.pendingPatterns.shift()))})}return Shortcuts.prototype.add=function(pattern,desc,cmdFunc,scope){var cmd,self=this;return"string"==typeof(cmd=cmdFunc)?cmdFunc=function(){self.editor.execCommand(cmd,!1,null)}:Tools.isArray(cmd)&&(cmdFunc=function(){self.editor.execCommand(cmd[0],cmd[1],cmd[2])}),each$g(explode$3(Tools.trim(pattern)),function(pattern){var shortcut=self.createShortcut(pattern,desc,cmdFunc,scope);self.shortcuts[shortcut.id]=shortcut}),!0},Shortcuts.prototype.remove=function(pattern){var shortcut=this.createShortcut(pattern);return!!this.shortcuts[shortcut.id]&&(delete this.shortcuts[shortcut.id],!0)},Shortcuts.prototype.parseShortcut=function(pattern){var id,key,shortcut={};for(key in each$g(explode$3(pattern.toLowerCase(),"+"),function(value){value in modifierNames?shortcut[value]=!0:/^[0-9]{2,}$/.test(value)?shortcut.keyCode=parseInt(value,10):(shortcut.charCode=value.charCodeAt(0),shortcut.keyCode=keyCodeLookup[value]||value.toUpperCase().charCodeAt(0))}),id=[shortcut.keyCode],modifierNames)shortcut[key]?id.push(key):shortcut[key]=!1;return shortcut.id=id.join(","),shortcut.access&&(shortcut.alt=!0,Env.mac?shortcut.ctrl=!0:shortcut.shift=!0),shortcut.meta&&(Env.mac?shortcut.meta=!0:(shortcut.ctrl=!0,shortcut.meta=!1)),shortcut},Shortcuts.prototype.createShortcut=function(pattern,desc,cmdFunc,scope){var shortcuts;return(shortcuts=Tools.map(explode$3(pattern,">"),this.parseShortcut))[shortcuts.length-1]=Tools.extend(shortcuts[shortcuts.length-1],{func:cmdFunc,scope:scope||this.editor}),Tools.extend(shortcuts[0],{desc:this.editor.translate(desc),subpatterns:shortcuts.slice(1)})},Shortcuts.prototype.hasModifier=function(e){return e.altKey||e.ctrlKey||e.metaKey},Shortcuts.prototype.isFunctionKey=function(e){return"keydown"===e.type&&112<=e.keyCode&&e.keyCode<=123},Shortcuts.prototype.matchShortcut=function(e,shortcut){return!!shortcut&&(shortcut.ctrl===e.ctrlKey&&shortcut.meta===e.metaKey&&(shortcut.alt===e.altKey&&shortcut.shift===e.shiftKey&&(!!(e.keyCode===shortcut.keyCode||e.charCode&&e.charCode===shortcut.charCode)&&(e.preventDefault(),!0))))},Shortcuts.prototype.executeShortcutAction=function(shortcut){return shortcut.func?shortcut.func.call(shortcut.scope):null},Shortcuts}(),each$h=Tools.each,trim$4=Tools.trim,queryParts="source protocol authority userInfo user password host port relative path directory file query anchor".split(" "),DEFAULT_PORTS={ftp:21,http:80,https:443,mailto:25},URI=function(){function URI(url,settings){url=trim$4(url),this.settings=settings||{};var baseUri=this.settings.base_uri,self=this;if(/^([\w\-]+):([^\/]{2})/i.test(url)||/^\s*#/.test(url))self.source=url;else{var isProtocolRelative=0===url.indexOf("//");if(0!==url.indexOf("/")||isProtocolRelative||(url=(baseUri&&baseUri.protocol||"http")+"://mce_host"+url),!/^[\w\-]*:?\/\//.test(url)){var baseUrl=this.settings.base_uri?this.settings.base_uri.path:new URI(domGlobals.document.location.href).directory;if(this.settings.base_uri&&""==this.settings.base_uri.protocol)url="//mce_host"+self.toAbsPath(baseUrl,url);else{var match=/([^#?]*)([#?]?.*)/.exec(url);url=(baseUri&&baseUri.protocol||"http")+"://mce_host"+self.toAbsPath(baseUrl,match[1])+match[2]}}url=url.replace(/@@/g,"(mce_at)");var urlMatch=/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@\/]*):?([^:@\/]*))?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/.exec(url);each$h(queryParts,function(v,i){var part=urlMatch[i];part=part&&part.replace(/\(mce_at\)/g,"@@"),self[v]=part}),baseUri&&(self.protocol||(self.protocol=baseUri.protocol),self.userInfo||(self.userInfo=baseUri.userInfo),self.port||"mce_host"!==self.host||(self.port=baseUri.port),self.host&&"mce_host"!==self.host||(self.host=baseUri.host),self.source=""),isProtocolRelative&&(self.protocol="")}}return URI.parseDataUri=function(uri){var type,uriComponents=decodeURIComponent(uri).split(","),matches=/data:([^;]+)/.exec(uriComponents[0]);return matches&&(type=matches[1]),{type:type,data:uriComponents[1]}},URI.getDocumentBaseUrl=function(loc){var baseUrl;return baseUrl=0!==loc.protocol.indexOf("http")&&"file:"!==loc.protocol?loc.href:loc.protocol+"//"+loc.host+loc.pathname,/^[^:]+:\/\/\/?[^\/]+\//.test(baseUrl)&&(baseUrl=baseUrl.replace(/[\?#].*$/,"").replace(/[\/\\][^\/]+$/,""),/[\/\\]$/.test(baseUrl)||(baseUrl+="/")),baseUrl},URI.prototype.setPath=function(path){var pathMatch=/^(.*?)\/?(\w+)?$/.exec(path);this.path=pathMatch[0],this.directory=pathMatch[1],this.file=pathMatch[2],this.source="",this.getURI()},URI.prototype.toRelative=function(uri){var output;if("./"===uri)return uri;var relativeUri=new URI(uri,{base_uri:this});if("mce_host"!==relativeUri.host&&this.host!==relativeUri.host&&relativeUri.host||this.port!==relativeUri.port||this.protocol!==relativeUri.protocol&&""!==relativeUri.protocol)return relativeUri.getURI();var tu=this.getURI(),uu=relativeUri.getURI();return tu===uu||"/"===tu.charAt(tu.length-1)&&tu.substr(0,tu.length-1)===uu?tu:(output=this.toRelPath(this.path,relativeUri.path),relativeUri.query&&(output+="?"+relativeUri.query),relativeUri.anchor&&(output+="#"+relativeUri.anchor),output)},URI.prototype.toAbsolute=function(uri,noHost){var absoluteUri=new URI(uri,{base_uri:this});return absoluteUri.getURI(noHost&&this.isSameOrigin(absoluteUri))},URI.prototype.isSameOrigin=function(uri){if(this.host==uri.host&&this.protocol==uri.protocol){if(this.port==uri.port)return!0;var defaultPort=DEFAULT_PORTS[this.protocol];if(defaultPort&&(this.port||defaultPort)==(uri.port||defaultPort))return!0}return!1},URI.prototype.toRelPath=function(base,path){var items,i,l,breakPoint=0,out="",normalizedBase=base.substring(0,base.lastIndexOf("/")).split("/");if(items=path.split("/"),normalizedBase.length>=items.length)for(i=0,l=normalizedBase.length;i<l;i++)if(i>=items.length||normalizedBase[i]!==items[i]){breakPoint=i+1;break}if(normalizedBase.length<items.length)for(i=0,l=items.length;i<l;i++)if(i>=normalizedBase.length||normalizedBase[i]!==items[i]){breakPoint=i+1;break}if(1===breakPoint)return path;for(i=0,l=normalizedBase.length-(breakPoint-1);i<l;i++)out+="../";for(i=breakPoint-1,l=items.length;i<l;i++)out+=i!==breakPoint-1?"/"+items[i]:items[i];return out},URI.prototype.toAbsPath=function(base,path){var i,tr,outPath,nb=0,o=[];tr=/\/$/.test(path)?"/":"";var normalizedBase=base.split("/"),normalizedPath=path.split("/");for(each$h(normalizedBase,function(k){k&&o.push(k)}),normalizedBase=o,i=normalizedPath.length-1,o=[];0<=i;i--)0!==normalizedPath[i].length&&"."!==normalizedPath[i]&&(".."!==normalizedPath[i]?0<nb?nb--:o.push(normalizedPath[i]):nb++);return 0!==(outPath=(i=normalizedBase.length-nb)<=0?reverse(o).join("/"):normalizedBase.slice(0,i).join("/")+"/"+reverse(o).join("/")).indexOf("/")&&(outPath="/"+outPath),tr&&outPath.lastIndexOf("/")!==outPath.length-1&&(outPath+=tr),outPath},URI.prototype.getURI=function(noProtoHost){var s;return void 0===noProtoHost&&(noProtoHost=!1),this.source&&!noProtoHost||(s="",noProtoHost||(this.protocol?s+=this.protocol+"://":s+="//",this.userInfo&&(s+=this.userInfo+"@"),this.host&&(s+=this.host),this.port&&(s+=":"+this.port)),this.path&&(s+=this.path),this.query&&(s+="?"+this.query),this.anchor&&(s+="#"+this.anchor),this.source=s),this.source},URI}(),DOM$9=DOMUtils$1.DOM,extend$3=Tools.extend,each$i=Tools.each,resolve$3=Tools.resolve,ie$1=Env.ie,Editor=function(){function Editor(id,settings,editorManager){var _this=this;this.plugins={},this.contentCSS=[],this.contentStyles=[],this.loadedCSS={},this.isNotDirty=!1,this.editorManager=editorManager,this.documentBaseUrl=editorManager.documentBaseURL,extend$3(this,EditorObservable),this.settings=getEditorSettings(this,id,this.documentBaseUrl,editorManager.defaultSettings,settings),this.settings.suffix&&(editorManager.suffix=this.settings.suffix),this.suffix=editorManager.suffix,this.settings.base_url&&editorManager._setBaseUrl(this.settings.base_url),this.baseUri=editorManager.baseURI,this.settings.referrer_policy&&(ScriptLoader.ScriptLoader._setReferrerPolicy(this.settings.referrer_policy),DOMUtils$1.DOM.styleSheetLoader._setReferrerPolicy(this.settings.referrer_policy)),AddOnManager$1.languageLoad=this.settings.language_load,AddOnManager$1.baseURL=editorManager.baseURL,this.id=id,this.setDirty(!1),this.documentBaseURI=new URI(this.settings.document_base_url,{base_uri:this.baseUri}),this.baseURI=this.baseUri,this.inline=!!this.settings.inline,this.shortcuts=new Shortcuts(this),this.editorCommands=new EditorCommands(this),this.settings.cache_suffix&&(Env.cacheSuffix=this.settings.cache_suffix.replace(/^[\?\&]+/,"")),this.ui={registry:function(){var bridge=create$5();return{addAutocompleter:bridge.addAutocompleter,addButton:bridge.addButton,addContextForm:bridge.addContextForm,addContextMenu:bridge.addContextMenu,addContextToolbar:bridge.addContextToolbar,addIcon:bridge.addIcon,addMenuButton:bridge.addMenuButton,addMenuItem:bridge.addMenuItem,addNestedMenuItem:bridge.addNestedMenuItem,addSidebar:bridge.addSidebar,addSplitButton:bridge.addSplitButton,addToggleButton:bridge.addToggleButton,addGroupToolbarButton:bridge.addGroupToolbarButton,addToggleMenuItem:bridge.addToggleMenuItem,getAll:bridge.getAll}}()};var modeInstance=create$4(this);this.mode=modeInstance,this.setMode=modeInstance.set,editorManager.fire("SetupEditor",{editor:this}),this.execCallback("setup",this),this.$=DomQuery.overrideDefaults(function(){return{context:_this.inline?_this.getBody():_this.getDoc(),element:_this.getBody()}})}return Editor.prototype.render=function(){Render_render(this)},Editor.prototype.focus=function(skipFocus){EditorFocus_focus(this,skipFocus)},Editor.prototype.hasFocus=function(){return EditorFocus_hasFocus(this)},Editor.prototype.execCallback=function(name){for(var x=[],_i=1;_i<arguments.length;_i++)x[_i-1]=arguments[_i];var scope,callback=this.settings[name];if(callback)return this.callbackLookup&&(scope=this.callbackLookup[name])&&(callback=scope.func,scope=scope.scope),"string"==typeof callback&&(scope=(scope=callback.replace(/\.\w+$/,""))?resolve$3(scope):0,callback=resolve$3(callback),this.callbackLookup=this.callbackLookup||{},this.callbackLookup[name]={func:callback,scope:scope}),callback.apply(scope||this,Array.prototype.slice.call(arguments,1))},Editor.prototype.translate=function(text){return I18n.translate(text)},Editor.prototype.getParam=function(name,defaultVal,type){return getParam(this,name,defaultVal,type)},Editor.prototype.nodeChanged=function(args){this._nodeChangeDispatcher.nodeChanged(args)},Editor.prototype.addCommand=function(name,callback,scope){this.editorCommands.addCommand(name,callback,scope)},Editor.prototype.addQueryStateHandler=function(name,callback,scope){this.editorCommands.addQueryStateHandler(name,callback,scope)},Editor.prototype.addQueryValueHandler=function(name,callback,scope){this.editorCommands.addQueryValueHandler(name,callback,scope)},Editor.prototype.addShortcut=function(pattern,desc,cmdFunc,scope){this.shortcuts.add(pattern,desc,cmdFunc,scope)},Editor.prototype.execCommand=function(cmd,ui,value,args){return this.editorCommands.execCommand(cmd,ui,value,args)},Editor.prototype.queryCommandState=function(cmd){return this.editorCommands.queryCommandState(cmd)},Editor.prototype.queryCommandValue=function(cmd){return this.editorCommands.queryCommandValue(cmd)},Editor.prototype.queryCommandSupported=function(cmd){return this.editorCommands.queryCommandSupported(cmd)},Editor.prototype.show=function(){this.hidden&&(this.hidden=!1,this.inline?this.getBody().contentEditable="true":(DOM$9.show(this.getContainer()),DOM$9.hide(this.id)),this.load(),this.fire("show"))},Editor.prototype.hide=function(){var doc=this.getDoc();this.hidden||(ie$1&&doc&&!this.inline&&doc.execCommand("SelectAll"),this.save(),this.inline?(this.getBody().contentEditable="false",this===this.editorManager.focusedEditor&&(this.editorManager.focusedEditor=null)):(DOM$9.hide(this.getContainer()),DOM$9.setStyle(this.id,"display",this.orgDisplay)),this.hidden=!0,this.fire("hide"))},Editor.prototype.isHidden=function(){return!!this.hidden},Editor.prototype.setProgressState=function(state,time){this.fire("ProgressState",{state:state,time:time})},Editor.prototype.load=function(args){var html,elm=this.getElement();if(this.removed)return"";if(elm){(args=args||{}).load=!0;var value=NodeType.isTextareaOrInput(elm)?elm.value:elm.innerHTML;return html=this.setContent(value,args),args.element=elm,args.no_events||this.fire("LoadContent",args),args.element=elm=null,html}},Editor.prototype.save=function(args){var html,form,self=this,elm=self.getElement();if(elm&&self.initialized&&!self.removed)return(args=args||{}).save=!0,args.element=elm,args.content=self.getContent(args),args.no_events||self.fire("SaveContent",args),"raw"===args.format&&self.fire("RawSaveContent",args),html=args.content,NodeType.isTextareaOrInput(elm)?elm.value=html:(!args.is_removing&&self.inline||(elm.innerHTML=html),(form=DOM$9.getParent(self.id,"form"))&&each$i(form.elements,function(elm){if(elm.name===self.id)return elm.value=html,!1})),args.element=elm=null,!1!==args.set_dirty&&self.setDirty(!1),html},Editor.prototype.setContent=function(content,args){return setContent(this,content,args)},Editor.prototype.getContent=function(args){return function(editor,args){return void 0===args&&(args={}),Option.from(editor.getBody()).fold(constant("tree"===args.format?new Node$1("body",11):""),function(body){return getContentFromBody(editor,args,body)})}(this,args)},Editor.prototype.insertContent=function(content,args){args&&(content=extend$3({content:content},args)),this.execCommand("mceInsertContent",!1,content)},Editor.prototype.resetContent=function(initialContent){void 0===initialContent?setContent(this,this.startContent,{format:"raw"}):setContent(this,initialContent),this.undoManager.reset(),this.setDirty(!1),this.nodeChanged()},Editor.prototype.isDirty=function(){return!this.isNotDirty},Editor.prototype.setDirty=function(state){var oldState=!this.isNotDirty;this.isNotDirty=!state,state&&state!==oldState&&this.fire("dirty")},Editor.prototype.getContainer=function(){return this.container||(this.container=DOM$9.get(this.editorContainer||this.id+"_parent")),this.container},Editor.prototype.getContentAreaContainer=function(){return this.contentAreaContainer},Editor.prototype.getElement=function(){return this.targetElm||(this.targetElm=DOM$9.get(this.id)),this.targetElm},Editor.prototype.getWin=function(){var elm;return this.contentWindow||(elm=this.iframeElement)&&(this.contentWindow=elm.contentWindow),this.contentWindow},Editor.prototype.getDoc=function(){var win;return this.contentDocument||(win=this.getWin())&&(this.contentDocument=win.document),this.contentDocument},Editor.prototype.getBody=function(){var doc=this.getDoc();return this.bodyElement||(doc?doc.body:null)},Editor.prototype.convertURL=function(url,name,elm){var settings=this.settings;return settings.urlconverter_callback?this.execCallback("urlconverter_callback",url,elm,!0,name):!settings.convert_urls||elm&&"LINK"===elm.nodeName||0===url.indexOf("file:")||0===url.length?url:settings.relative_urls?this.documentBaseURI.toRelative(url):url=this.documentBaseURI.toAbsolute(url,settings.remove_script_host)},Editor.prototype.addVisual=function(elm){var cls,self=this,settings=self.settings,dom=self.dom;elm=elm||self.getBody(),void 0===self.hasVisual&&(self.hasVisual=settings.visual),each$i(dom.select("table,a",elm),function(elm){var value;switch(elm.nodeName){case"TABLE":return cls=settings.visual_table_class||"mce-item-table",void((value=dom.getAttrib(elm,"border"))&&"0"!==value||!self.hasVisual?dom.removeClass(elm,cls):dom.addClass(elm,cls));case"A":return void(dom.getAttrib(elm,"href")||(value=dom.getAttrib(elm,"name")||elm.id,cls=settings.visual_anchor_class||"mce-item-anchor",value&&self.hasVisual?dom.addClass(elm,cls):dom.removeClass(elm,cls)))}}),self.fire("VisualAid",{element:elm,hasVisual:self.hasVisual})},Editor.prototype.remove=function(){remove$6(this)},Editor.prototype.destroy=function(automatic){destroy(this,automatic)},Editor.prototype.uploadImages=function(callback){return this.editorUpload.uploadImages(callback)},Editor.prototype._scanForImages=function(){return this.editorUpload.scanForImages()},Editor.prototype.addButton=function(){throw new Error("editor.addButton has been removed in tinymce 5x, use editor.ui.registry.addButton or editor.ui.registry.addToggleButton or editor.ui.registry.addSplitButton instead")},Editor.prototype.addSidebar=function(){throw new Error("editor.addSidebar has been removed in tinymce 5x, use editor.ui.registry.addSidebar instead")},Editor.prototype.addMenuItem=function(){throw new Error("editor.addMenuItem has been removed in tinymce 5x, use editor.ui.registry.addMenuItem instead")},Editor.prototype.addContextToolbar=function(){throw new Error("editor.addContextToolbar has been removed in tinymce 5x, use editor.ui.registry.addContextToolbar instead")},Editor}(),DOM$a=DOMUtils$1.DOM,explode$4=Tools.explode,each$j=Tools.each,extend$4=Tools.extend,instanceCounter=0,boundGlobalEvents=!1,legacyEditors=[],editors=[],isQuirksMode="CSS1Compat"!==domGlobals.document.compatMode,EditorManager=__assign(__assign({},Observable),{baseURI:null,baseURL:null,defaultSettings:{},documentBaseURL:null,suffix:null,$:DomQuery,majorVersion:"5",minorVersion:"2.2",releaseDate:"2020-04-23",editors:legacyEditors,i18n:I18n,activeEditor:null,focusedEditor:null,settings:{},setup:function(){var baseURL,documentBaseURL,suffix="";documentBaseURL=URI.getDocumentBaseUrl(domGlobals.document.location),/^[^:]+:\/\/\/?[^\/]+\//.test(documentBaseURL)&&(documentBaseURL=documentBaseURL.replace(/[\?#].*$/,"").replace(/[\/\\][^\/]+$/,""),/[\/\\]$/.test(documentBaseURL)||(documentBaseURL+="/"));var preInit=window.tinymce||window.tinyMCEPreInit;if(preInit)baseURL=preInit.base||preInit.baseURL,suffix=preInit.suffix;else{for(var scripts=domGlobals.document.getElementsByTagName("script"),i=0;i<scripts.length;i++){var src;if(""!==(src=scripts[i].src||"")){var srcScript=src.substring(src.lastIndexOf("/"));if(/tinymce(\.full|\.jquery|)(\.min|\.dev|)\.js/.test(src)){-1!==srcScript.indexOf(".min")&&(suffix=".min"),baseURL=src.substring(0,src.lastIndexOf("/"));break}}}if(!baseURL&&domGlobals.document.currentScript)-1!==(src=domGlobals.document.currentScript.src).indexOf(".min")&&(suffix=".min"),baseURL=src.substring(0,src.lastIndexOf("/"))}this.baseURL=new URI(documentBaseURL).toAbsolute(baseURL),this.documentBaseURL=documentBaseURL,this.baseURI=new URI(this.baseURL),this.suffix=suffix,FocusController_setup(this)},overrideDefaults:function(defaultSettings){var baseUrl,suffix;(baseUrl=defaultSettings.base_url)&&this._setBaseUrl(baseUrl),suffix=defaultSettings.suffix,defaultSettings.suffix&&(this.suffix=suffix);var pluginBaseUrls=(this.defaultSettings=defaultSettings).plugin_base_urls;for(var name_1 in pluginBaseUrls)AddOnManager$1.PluginManager.urls[name_1]=pluginBaseUrls[name_1]},init:function(settings){var result,invalidInlineTargets,self=this;invalidInlineTargets=Tools.makeMap("area base basefont br col frame hr img input isindex link meta param embed source wbr track colgroup option table tbody tfoot thead tr th td script noscript style textarea video audio iframe object menu"," ");function createId(elm){var id=elm.id;return id||(id=(id=elm.name)&&!DOM$a.get(id)?elm.name:DOM$a.uniqueId(),elm.setAttribute("id",id)),id}function hasClass(elm,className){return className.constructor===RegExp?className.test(elm.className):DOM$a.hasClass(elm,className)}var provideResults=function(editors){result=editors},initEditors=function(){function createEditor(id,settings,targetElm){var editor=new Editor(id,settings,self);editors.push(editor),editor.on("init",function(){++initCount===targets.length&&provideResults(editors)}),editor.targetElm=editor.targetElm||targetElm,editor.render()}var targets,initCount=0,editors=[];DOM$a.unbind(window,"ready",initEditors),function(name){var callback=settings[name];if(callback)callback.apply(self,Array.prototype.slice.call(arguments,2))}("onpageload"),targets=DomQuery.unique(function(settings){var l,targets=[];if(Env.browser.isIE()&&Env.browser.version.major<11)return ErrorReporter.initError("TinyMCE does not support the browser you are using. For a list of supported browsers please see: https://www.tinymce.com/docs/get-started/system-requirements/"),[];if(isQuirksMode)return ErrorReporter.initError("Failed to initialize the editor as the document is not in standards mode. TinyMCE requires standards mode."),[];if(settings.types)return each$j(settings.types,function(type){targets=targets.concat(DOM$a.select(type.selector))}),targets;if(settings.selector)return DOM$a.select(settings.selector);if(settings.target)return[settings.target];switch(settings.mode){case"exact":0<(l=settings.elements||"").length&&each$j(explode$4(l),function(id){var elm;(elm=DOM$a.get(id))?targets.push(elm):each$j(domGlobals.document.forms,function(f){each$j(f.elements,function(e){e.name===id&&(id="mce_editor_"+instanceCounter++,DOM$a.setAttrib(e,"id",id),targets.push(e))})})});break;case"textareas":case"specific_textareas":each$j(DOM$a.select("textarea"),function(elm){settings.editor_deselector&&hasClass(elm,settings.editor_deselector)||settings.editor_selector&&!hasClass(elm,settings.editor_selector)||targets.push(elm)})}return targets}(settings)),settings.types?each$j(settings.types,function(type){Tools.each(targets,function(elm){return!DOM$a.is(elm,type.selector)||(createEditor(createId(elm),extend$4({},settings,type),elm),!1)})}):(Tools.each(targets,function(elm){!function(editor){editor&&editor.initialized&&!(editor.getContainer()||editor.getBody()).parentNode&&(removeEditorFromList(editor),editor.unbindAllNativeEvents(),editor.destroy(!0),editor.removed=!0,editor=null)}(self.get(elm.id))}),0===(targets=Tools.grep(targets,function(elm){return!self.get(elm.id)})).length?provideResults([]):each$j(targets,function(elm){!function(settings,elm){return settings.inline&&elm.tagName.toLowerCase()in invalidInlineTargets}(settings,elm)?createEditor(createId(elm),settings,elm):ErrorReporter.initError("Could not initialize inline editor on invalid inline target element",elm)}))};return self.settings=settings,DOM$a.bind(window,"ready",initEditors),new promiseObj(function(resolve){result?resolve(result):provideResults=function(editors){resolve(editors)}})},get:function(id){return 0===arguments.length?editors.slice(0):isString(id)?find(editors,function(editor){return editor.id===id}).getOr(null):isNumber(id)&&editors[id]?editors[id]:null},add:function(editor){var self=this;return legacyEditors[editor.id]===editor||(null===self.get(editor.id)&&(function(id){return"length"!==id}(editor.id)&&(legacyEditors[editor.id]=editor),legacyEditors.push(editor),editors.push(editor)),toggleGlobalEvents(!0),self.activeEditor=editor,self.fire("AddEditor",{editor:editor}),beforeUnloadDelegate||(beforeUnloadDelegate=function(e){var event=self.fire("BeforeUnload");if(event.returnValue)return e.preventDefault(),e.returnValue=event.returnValue,event.returnValue},window.addEventListener("beforeunload",beforeUnloadDelegate))),editor},createEditor:function(id,settings){return this.add(new Editor(id,settings,this))},remove:function(selector){var i,editor,self=this;if(selector){if(!isString(selector))return editor=selector,isNull(self.get(editor.id))?null:(removeEditorFromList(editor)&&self.fire("RemoveEditor",{editor:editor}),0===editors.length&&window.removeEventListener("beforeunload",beforeUnloadDelegate),editor.remove(),toggleGlobalEvents(0<editors.length),editor);each$j(DOM$a.select(selector),function(elm){(editor=self.get(elm.id))&&self.remove(editor)})}else for(i=editors.length-1;0<=i;i--)self.remove(editors[i])},execCommand:function(cmd,ui,value){var editor=this.get(value);switch(cmd){case"mceAddEditor":return this.get(value)||new Editor(value,this.settings,this).render(),!0;case"mceRemoveEditor":return editor&&editor.remove(),!0;case"mceToggleEditor":return editor?editor.isHidden()?editor.show():editor.hide():this.execCommand("mceAddEditor",0,value),!0}return!!this.activeEditor&&this.activeEditor.execCommand(cmd,ui,value)},triggerSave:function(){each$j(editors,function(editor){editor.save()})},addI18n:function(code,items){I18n.add(code,items)},translate:function(text){return I18n.translate(text)},setActive:function(editor){var activeEditor=this.activeEditor;this.activeEditor!==editor&&(activeEditor&&activeEditor.fire("deactivate",{relatedTarget:editor}),editor.fire("activate",{relatedTarget:activeEditor})),this.activeEditor=editor},_setBaseUrl:function(baseUrl){this.baseURL=new URI(this.documentBaseURL).toAbsolute(baseUrl.replace(/\/+$/,"")),this.baseURI=new URI(this.baseURL)}});function RangeUtils(dom){return{walk:function(rng,callback){return RangeWalk_walk(dom,rng,callback)},split:split$1,normalize:function(rng){return NormalizeRange_normalize(dom,rng).fold(constant(!1),function(normalizedRng){return rng.setStart(normalizedRng.startContainer,normalizedRng.startOffset),rng.setEnd(normalizedRng.endContainer,normalizedRng.endOffset),!0})}}}EditorManager.setup(),function(RangeUtils){RangeUtils.compareRanges=RangeCompare_isEq,RangeUtils.getCaretRangeFromPoint=CaretRangeFromPoint_fromPoint,RangeUtils.getSelectedNode=getSelectedNode,RangeUtils.getNode=getNode}(RangeUtils=RangeUtils||{});function awaiter(resolveCb,rejectCb,timeout){function complete(completer){return function(){for(var args=[],_i=0;_i<arguments.length;_i++)args[_i]=arguments[_i];done||(done=!0,null!==timer&&(domGlobals.clearTimeout(timer),timer=null),completer.apply(null,args))}}void 0===timeout&&(timeout=1e3);var done=!1,timer=null,resolve=complete(resolveCb),reject=complete(rejectCb);return{start:function(){for(var args=[],_i=0;_i<arguments.length;_i++)args[_i]=arguments[_i];done||null!==timer||(timer=domGlobals.setTimeout(function(){return reject.apply(null,args)},timeout))},resolve:resolve,reject:reject}}function relativePosition(rect,targetRect,rel){var x,y,w,h,targetW,targetH;return x=targetRect.x,y=targetRect.y,w=rect.w,h=rect.h,targetW=targetRect.w,targetH=targetRect.h,"b"===(rel=(rel||"").split(""))[0]&&(y+=targetH),"r"===rel[1]&&(x+=targetW),"c"===rel[0]&&(y+=round$2(targetH/2)),"c"===rel[1]&&(x+=round$2(targetW/2)),"b"===rel[3]&&(y-=h),"r"===rel[4]&&(x-=w),"c"===rel[3]&&(y-=round$2(h/2)),"c"===rel[4]&&(x-=round$2(w/2)),create$7(x,y,w,h)}function Class(){}var tasks,resultFns,extendClass,initializing,RangeUtils$1=RangeUtils,Resource=(tasks={},resultFns={},{load:function(id,url){var loadErrMsg='Script at URL "'+url+'" failed to load',runErrMsg='Script at URL "'+url+"\" did not call `tinymce.Resource.add('"+id+"', data)` within 1 second";if(void 0!==tasks[id])return tasks[id];var task=new promiseObj(function(resolve,reject){var waiter=awaiter(resolve,reject);resultFns[id]=waiter.resolve,ScriptLoader.ScriptLoader.loadScript(url,function(){return waiter.start(runErrMsg)},function(){return waiter.reject(loadErrMsg)})});return tasks[id]=task},add:function(id,data){void 0!==resultFns[id]&&(resultFns[id](data),delete resultFns[id]),tasks[id]=promiseObj.resolve(data)}}),min=Math.min,max=Math.max,round$2=Math.round,create$7=function(x,y,w,h){return{x:x,y:y,w:w,h:h}},Rect={inflate:function(rect,w,h){return create$7(rect.x-w,rect.y-h,rect.w+2*w,rect.h+2*h)},relativePosition:relativePosition,findBestRelativePosition:function(rect,targetRect,constrainRect,rels){var pos,i;for(i=0;i<rels.length;i++)if((pos=relativePosition(rect,targetRect,rels[i])).x>=constrainRect.x&&pos.x+pos.w<=constrainRect.w+constrainRect.x&&pos.y>=constrainRect.y&&pos.y+pos.h<=constrainRect.h+constrainRect.y)return rels[i];return null},intersect:function(rect,cropRect){var x1,y1,x2,y2;return x1=max(rect.x,cropRect.x),y1=max(rect.y,cropRect.y),x2=min(rect.x+rect.w,cropRect.x+cropRect.w),y2=min(rect.y+rect.h,cropRect.y+cropRect.h),x2-x1<0||y2-y1<0?null:create$7(x1,y1,x2-x1,y2-y1)},clamp:function(rect,clampRect,fixedSize){var underflowX1,underflowY1,overflowX2,overflowY2,x1,y1,x2,y2,cx2,cy2;return x1=rect.x,y1=rect.y,x2=rect.x+rect.w,y2=rect.y+rect.h,cx2=clampRect.x+clampRect.w,cy2=clampRect.y+clampRect.h,underflowX1=max(0,clampRect.x-x1),underflowY1=max(0,clampRect.y-y1),overflowX2=max(0,x2-cx2),overflowY2=max(0,y2-cy2),x1+=underflowX1,y1+=underflowY1,fixedSize&&(x2+=underflowX1,y2+=underflowY1,x1-=overflowX2,y1-=overflowY2),create$7(x1,y1,(x2-=overflowX2)-x1,(y2-=overflowY2)-y1)},create:create$7,fromClientRect:function(clientRect){return create$7(clientRect.left,clientRect.top,clientRect.width,clientRect.height)}},each$k=Tools.each,extend$5=Tools.extend;Class.extend=extendClass=function(prop){function Class(){var i,mixins,mixin;if(!initializing&&(this.init&&this.init.apply(this,arguments),mixins=this.Mixins))for(i=mixins.length;i--;)(mixin=mixins[i]).init&&mixin.init.apply(this,arguments)}function dummy(){return this}function createMethod(name,fn){return function(){var ret,tmp=this._super;return this._super=_super[name],ret=fn.apply(this,arguments),this._super=tmp,ret}}var prototype,name,member,_super=this.prototype;for(name in initializing=!0,prototype=new this,initializing=!1,prop.Mixins&&(each$k(prop.Mixins,function(mixin){for(var name_1 in mixin)"init"!==name_1&&(prop[name_1]=mixin[name_1])}),_super.Mixins&&(prop.Mixins=_super.Mixins.concat(prop.Mixins))),prop.Methods&&each$k(prop.Methods.split(","),function(name){prop[name]=dummy}),prop.Properties&&each$k(prop.Properties.split(","),function(name){var fieldName="_"+name;prop[name]=function(value){return void 0!==value?(this[fieldName]=value,this):this[fieldName]}}),prop.Statics&&each$k(prop.Statics,function(func,name){Class[name]=func}),prop.Defaults&&_super.Defaults&&(prop.Defaults=extend$5({},_super.Defaults,prop.Defaults)),prop)"function"==typeof(member=prop[name])&&_super[name]?prototype[name]=createMethod(name,member):prototype[name]=member;return Class.prototype=prototype,(Class.constructor=Class).extend=extendClass,Class};var localStorage,min$1=Math.min,max$1=Math.max,round$3=Math.round,JSONUtils={serialize:function(obj){var data=JSON.stringify(obj);return isString(data)?data.replace(/[\u0080-\uFFFF]/g,function(match){var hexCode=match.charCodeAt(0).toString(16);return"\\u"+"0000".substring(hexCode.length)+hexCode}):data},parse:function(text){try{return JSON.parse(text)}catch(ex){}}},JSONP={callbacks:{},count:0,send:function(settings){var self=this,dom=DOMUtils$1.DOM,count=void 0!==settings.count?settings.count:self.count,id="tinymce_jsonp_"+count;self.callbacks[count]=function(json){dom.remove(id),delete self.callbacks[count],settings.callback(json)},dom.add(dom.doc.body,"script",{id:id,src:settings.url,type:"text/javascript"}),self.count++}},XHR=__assign(__assign({},Observable),{send:function(settings){var xhr,count=0,ready=function(){!settings.async||4===xhr.readyState||1e4<count++?(settings.success&&count<1e4&&200===xhr.status?settings.success.call(settings.success_scope,""+xhr.responseText,xhr,settings):settings.error&&settings.error.call(settings.error_scope,1e4<count?"TIMED_OUT":"GENERAL",xhr,settings),xhr=null):Delay.setTimeout(ready,10)};if(settings.scope=settings.scope||this,settings.success_scope=settings.success_scope||settings.scope,settings.error_scope=settings.error_scope||settings.scope,settings.async=!1!==settings.async,settings.data=settings.data||"",XHR.fire("beforeInitialize",{settings:settings}),xhr=new domGlobals.XMLHttpRequest){if(xhr.overrideMimeType&&xhr.overrideMimeType(settings.content_type),xhr.open(settings.type||(settings.data?"POST":"GET"),settings.url,settings.async),settings.crossDomain&&(xhr.withCredentials=!0),settings.content_type&&xhr.setRequestHeader("Content-Type",settings.content_type),settings.requestheaders&&Tools.each(settings.requestheaders,function(header){xhr.setRequestHeader(header.key,header.value)}),xhr.setRequestHeader("X-Requested-With","XMLHttpRequest"),(xhr=XHR.fire("beforeSend",{xhr:xhr,settings:settings}).xhr).send(settings.data),!settings.async)return ready();Delay.setTimeout(ready,10)}}}),extend$6=Tools.extend,JSONRequest=function(){function JSONRequest(settings){this.settings=extend$6({},settings),this.count=0}return JSONRequest.sendRPC=function(o){return(new JSONRequest).send(o)},JSONRequest.prototype.send=function(args){var ecb=args.error,scb=args.success,xhrArgs=extend$6(this.settings,args);xhrArgs.success=function(c,x){void 0===(c=JSONUtils.parse(c))&&(c={error:"JSON Parse error."}),c.error?ecb.call(xhrArgs.error_scope||xhrArgs.scope,c.error,x):scb.call(xhrArgs.success_scope||xhrArgs.scope,c.result)},xhrArgs.error=function(ty,x){ecb&&ecb.call(xhrArgs.error_scope||xhrArgs.scope,ty,x)},xhrArgs.data=JSONUtils.serialize({id:args.id||"c"+this.count++,method:args.method,params:args.params}),xhrArgs.content_type="application/json",XHR.send(xhrArgs)},JSONRequest}();try{localStorage=domGlobals.window.localStorage}catch(e){localStorage=function(){return data={},keys=[],storage={getItem:function(key){var item=data[key];return item||null},setItem:function(key,value){keys.push(key),data[key]=String(value)},key:function(index){return keys[index]},removeItem:function(key){keys=keys.filter(function(k){return k===key}),delete data[key]},clear:function(){keys=[],data={}},length:0},Object.defineProperty(storage,"length",{get:function(){return keys.length},configurable:!1,enumerable:!1}),storage;var data,keys,storage}()}var publicApi={geom:{Rect:Rect},util:{Promise:promiseObj,Delay:Delay,Tools:Tools,VK:VK,URI:URI,Class:Class,EventDispatcher:EventDispatcher,Observable:Observable,I18n:I18n,XHR:XHR,JSON:JSONUtils,JSONRequest:JSONRequest,JSONP:JSONP,LocalStorage:localStorage,Color:function(value){function parse(value){var matches;return"object"==typeof value?"r"in value?(r=value.r,g=value.g,b=value.b):"v"in value&&function(hue,saturation,brightness){var side,chroma,x,match;if(hue=(parseInt(hue,10)||0)%360,saturation=parseInt(saturation,10)/100,brightness=parseInt(brightness,10)/100,saturation=max$1(0,min$1(saturation,1)),brightness=max$1(0,min$1(brightness,1)),0!==saturation){switch(side=hue/60,x=(chroma=brightness*saturation)*(1-Math.abs(side%2-1)),match=brightness-chroma,Math.floor(side)){case 0:r=chroma,g=x,b=0;break;case 1:r=x,g=chroma,b=0;break;case 2:r=0,g=chroma,b=x;break;case 3:r=0,g=x,b=chroma;break;case 4:r=x,g=0,b=chroma;break;case 5:r=chroma,g=0,b=x;break;default:r=g=b=0}r=round$3(255*(r+match)),g=round$3(255*(g+match)),b=round$3(255*(b+match))}else r=g=b=round$3(255*brightness)}(value.h,value.s,value.v):(matches=/rgb\s*\(\s*([0-9]+)\s*,\s*([0-9]+)\s*,\s*([0-9]+)[^\)]*\)/gi.exec(value))?(r=parseInt(matches[1],10),g=parseInt(matches[2],10),b=parseInt(matches[3],10)):(matches=/#([0-F]{2})([0-F]{2})([0-F]{2})/gi.exec(value))?(r=parseInt(matches[1],16),g=parseInt(matches[2],16),b=parseInt(matches[3],16)):(matches=/#([0-F])([0-F])([0-F])/gi.exec(value))&&(r=parseInt(matches[1]+matches[1],16),g=parseInt(matches[2]+matches[2],16),b=parseInt(matches[3]+matches[3],16)),r=r<0?0:255<r?255:r,g=g<0?0:255<g?255:g,b=b<0?0:255<b?255:b,self}var self={},r=0,g=0,b=0;return value&&parse(value),self.toRgb=function(){return{r:r,g:g,b:b}},self.toHsv=function(){return function(r,g,b){var s,v,minRGB,maxRGB;return v=0,(minRGB=min$1(r/=255,min$1(g/=255,b/=255)))===(maxRGB=max$1(r,max$1(g,b)))?{h:0,s:0,v:100*(v=minRGB)}:(s=(maxRGB-minRGB)/maxRGB,{h:round$3(60*((r===minRGB?3:b===minRGB?1:5)-(r===minRGB?g-b:b===minRGB?r-g:b-r)/((v=maxRGB)-minRGB))),s:round$3(100*s),v:round$3(100*v)})}(r,g,b)},self.toHex=function(){function hex(val){return 1<(val=parseInt(val,10).toString(16)).length?val:"0"+val}return"#"+hex(r)+hex(g)+hex(b)},self.parse=parse,self}},dom:{EventUtils:EventUtils,Sizzle:Sizzle,DomQuery:DomQuery,TreeWalker:TreeWalker,TextSeeker:TextSeeker,DOMUtils:DOMUtils$1,ScriptLoader:ScriptLoader,RangeUtils:RangeUtils$1,Serializer:Serializer$1,ControlSelection:ControlSelection,BookmarkManager:BookmarkManager$1,Selection:Selection$1,Event:EventUtils.Event},html:{Styles:Styles,Entities:Entities,Node:Node$1,Schema:Schema,SaxParser:SaxParser$1,DomParser:DomParser,Writer:Writer,Serializer:Serializer},Env:Env,AddOnManager:AddOnManager$1,Annotator:Annotator,Formatter:Formatter,UndoManager:UndoManager,EditorCommands:EditorCommands,WindowManager:WindowManager,NotificationManager:NotificationManager,EditorObservable:EditorObservable,Shortcuts:Shortcuts,Editor:Editor,FocusManager:FocusManager,EditorManager:EditorManager,DOM:DOMUtils$1.DOM,ScriptLoader:ScriptLoader.ScriptLoader,PluginManager:AddOnManager$1.PluginManager,ThemeManager:AddOnManager$1.ThemeManager,IconManager:IconManager,Resource:Resource,trim:Tools.trim,isArray:Tools.isArray,is:Tools.is,toArray:Tools.toArray,makeMap:Tools.makeMap,each:Tools.each,map:Tools.map,grep:Tools.grep,inArray:Tools.inArray,extend:Tools.extend,create:Tools.create,walk:Tools.walk,createNS:Tools.createNS,resolve:Tools.resolve,explode:Tools.explode,_addCacheSuffix:Tools._addCacheSuffix,isOpera:Env.opera,isWebKit:Env.webkit,isIE:Env.ie,isGecko:Env.gecko,isMac:Env.mac},tinymce=Tools.extend(EditorManager,publicApi);!function(tinymce){window.tinymce=tinymce,window.tinyMCE=tinymce}(tinymce),function(tinymce){if("object"==typeof module)try{module.exports=tinymce}catch(_){}}(tinymce)}(window),function(){var f,c,u,p,d,s=[];function v(){return d.tinymce}d="undefined"!=typeof global?global:window,(p=d.jQuery).fn.tinymce=function(o){var e,t,i,l=this,r="";if(!l.length)return l;if(!o)return v()?v().get(l[0].id):null;function n(){var a=[],c=0;u||(m(),u=!0),l.each(function(e,t){var n,i=t.id,r=o.oninit;i||(t.id=i=v().DOM.uniqueId()),v().get(i)||(n=v().createEditor(i,o),a.push(n),n.on("init",function(){var e,t=r;l.css("visibility",""),r&&++c==a.length&&("string"==typeof t&&(e=-1===t.indexOf(".")?null:v().resolve(t.replace(/\.\w+$/,"")),t=v().resolve(t)),t.apply(e||v(),a))}))}),p.each(a,function(e,t){t.render()})}if(l.css("visibility","hidden"),d.tinymce||c||!(e=o.script_url))1===c?s.push(n):n();else{c=1,t=e.substring(0,e.lastIndexOf("/")),-1!=e.indexOf(".min")&&(r=".min"),d.tinymce=d.tinyMCEPreInit||{base:t,suffix:r},-1!=e.indexOf("gzip")&&(i=o.language||"en",e=e+(/\?/.test(e)?"&":"?")+"js=true&core=true&suffix="+escape(r)+"&themes="+escape(o.theme||"modern")+"&plugins="+escape(o.plugins||"")+"&languages="+(i||""),d.tinyMCE_GZ||(d.tinyMCE_GZ={start:function(){function n(e){v().ScriptLoader.markDone(v().baseURI.toAbsolute(e))}n("langs/"+i+".js"),n("themes/"+o.theme+"/theme"+r+".js"),n("themes/"+o.theme+"/langs/"+i+".js"),p.each(o.plugins.split(","),function(e,t){t&&(n("plugins/"+t+"/plugin"+r+".js"),n("plugins/"+t+"/langs/"+i+".js"))})},end:function(){}}));var a=document.createElement("script");a.type="text/javascript",a.onload=a.onreadystatechange=function(e){e=e||window.event,2===c||"load"!=e.type&&!/complete|loaded/.test(a.readyState)||(v().dom.Event.domLoaded=1,c=2,o.script_loaded&&o.script_loaded(),n(),p.each(s,function(e,t){t()}))},a.src=e,document.body.appendChild(a)}return l},p.extend(p.expr[":"],{tinymce:function(e){var t;return!!(e.id&&"tinymce"in d&&(t=v().get(e.id))&&t.editorManager===v())}});var m=function(){function r(e){"remove"===e&&this.each(function(e,t){var n=u(t);n&&n.remove()}),this.find("span.mceEditor,div.mceEditor").each(function(e,t){var n=v().get(t.id.replace(/_parent$/,""));n&&n.remove()})}function o(i){var e,t=this;if(null!=i)r.call(t),t.each(function(e,t){var n;(n=v().get(t.id))&&n.setContent(i)});else if(0<t.length&&(e=v().get(t[0].id)))return e.getContent()}function l(e){return!!(e&&e.length&&d.tinymce&&e.is(":tinymce"))}var u=function(e){var t=null;return e&&e.id&&d.tinymce&&(t=v().get(e.id)),t},s={};p.each(["text","html","val"],function(e,t){var a=s[t]=p.fn[t],c="text"===t;p.fn[t]=function(e){var t=this;if(!l(t))return a.apply(t,arguments);if(e!==f)return o.call(t.filter(":tinymce"),e),a.apply(t.not(":tinymce"),arguments),t;var i="",r=arguments;return(c?t:t.eq(0)).each(function(e,t){var n=u(t);i+=n?c?n.getContent().replace(/<(?:"[^"]*"|'[^']*'|[^'">])*>/g,""):n.getContent({save:!0}):a.apply(p(t),r)}),i}}),p.each(["append","prepend"],function(e,t){var n=s[t]=p.fn[t],r="prepend"===t;p.fn[t]=function(i){var e=this;return l(e)?i!==f?("string"==typeof i&&e.filter(":tinymce").each(function(e,t){var n=u(t);n&&n.setContent(r?i+n.getContent():n.getContent()+i)}),n.apply(e.not(":tinymce"),arguments),e):void 0:n.apply(e,arguments)}}),p.each(["remove","replaceWith","replaceAll","empty"],function(e,t){var n=s[t]=p.fn[t];p.fn[t]=function(){return r.call(this,t),n.apply(this,arguments)}}),s.attr=p.fn.attr,p.fn.attr=function(e,t){var n=this,i=arguments;if(!e||"value"!==e||!l(n))return s.attr.apply(n,i);if(t!==f)return o.call(n.filter(":tinymce"),t),s.attr.apply(n.not(":tinymce"),i),n;var r=n[0],a=u(r);return a?a.getContent({save:!0}):s.attr.apply(p(r),i)}}}(),function(domGlobals){"use strict";function noop(){}function compose(fa,fb){return function(){for(var args=[],_i=0;_i<arguments.length;_i++)args[_i]=arguments[_i];return fa(fb.apply(null,args))}}function identity(x){return x}var constant=function(value){return function(){return value}};function curry(fn){for(var initialArgs=[],_i=1;_i<arguments.length;_i++)initialArgs[_i-1]=arguments[_i];return function(){for(var restArgs=[],_i=0;_i<arguments.length;_i++)restArgs[_i]=arguments[_i];var all=initialArgs.concat(restArgs);return fn.apply(null,all)}}function not(f){return function(){for(var args=[],_i=0;_i<arguments.length;_i++)args[_i]=arguments[_i];return!f.apply(null,args)}}function die(msg){return function(){throw new Error(msg)}}var never=constant(!1),always=constant(!0),global$1=tinymce.util.Tools.resolve("tinymce.ThemeManager"),__assign=function(){return(__assign=Object.assign||function(t){for(var s,i=1,n=arguments.length;i<n;i++)for(var p in s=arguments[i])Object.prototype.hasOwnProperty.call(s,p)&&(t[p]=s[p]);return t}).apply(this,arguments)};function __rest(s,e){var t={};for(var p in s)Object.prototype.hasOwnProperty.call(s,p)&&e.indexOf(p)<0&&(t[p]=s[p]);if(null!=s&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(p=Object.getOwnPropertySymbols(s);i<p.length;i++)e.indexOf(p[i])<0&&Object.prototype.propertyIsEnumerable.call(s,p[i])&&(t[p[i]]=s[p[i]])}return t}function __spreadArrays(){for(var s=0,i=0,il=arguments.length;i<il;i++)s+=arguments[i].length;var r=Array(s),k=0;for(i=0;i<il;i++)for(var a=arguments[i],j=0,jl=a.length;j<jl;j++,k++)r[k]=a[j];return r}function none(){return NONE}function isType(type){return function(value){return function(x){if(null===x)return"null";var t=typeof x;return"object"==t&&(Array.prototype.isPrototypeOf(x)||x.constructor&&"Array"===x.constructor.name)?"array":"object"==t&&(String.prototype.isPrototypeOf(x)||x.constructor&&"String"===x.constructor.name)?"string":t}(value)===type}}function isArrayOf(value,pred){if(isArray(value)){for(var i=0,len=value.length;i<len;++i)if(!0!==pred(value[i]))return!1;return!0}return!1}function rawIndexOf(ts,t){return nativeIndexOf.call(ts,t)}function exists(xs,pred){for(var i=0,len=xs.length;i<len;i++){if(pred(xs[i],i))return!0}return!1}function chunk(array,size){for(var r=[],i=0;i<array.length;i+=size){var s=nativeSlice.call(array,i,i+size);r.push(s)}return r}function map(xs,f){for(var len=xs.length,r=new Array(len),i=0;i<len;i++){var x=xs[i];r[i]=f(x,i)}return r}function filter(xs,pred){for(var r=[],i=0,len=xs.length;i<len;i++){var x=xs[i];pred(x,i)&&r.push(x)}return r}function foldr(xs,f,acc){return function(xs,f){for(var i=xs.length-1;0<=i;i--){f(xs[i],i)}}(xs,function(x){acc=f(acc,x)}),acc}function foldl(xs,f,acc){return each(xs,function(x){acc=f(acc,x)}),acc}function find(xs,pred){for(var i=0,len=xs.length;i<len;i++){var x=xs[i];if(pred(x,i))return Option.some(x)}return Option.none()}function findIndex(xs,pred){for(var i=0,len=xs.length;i<len;i++){if(pred(xs[i],i))return Option.some(i)}return Option.none()}function flatten(xs){for(var r=[],i=0,len=xs.length;i<len;++i){if(!isArray(xs[i]))throw new Error("Arr.flatten item "+i+" was not an array, input: "+xs);nativePush.apply(r,xs[i])}return r}function bind(xs,f){return flatten(map(xs,f))}function forall(xs,pred){for(var i=0,len=xs.length;i<len;++i){if(!0!==pred(xs[i],i))return!1}return!0}function reverse(xs){var r=nativeSlice.call(xs,0);return r.reverse(),r}function difference(a1,a2){return filter(a1,function(x){return!contains(a2,x)})}function pure(x){return[x]}function sort(xs,comparator){var copy=nativeSlice.call(xs,0);return copy.sort(comparator),copy}function last(xs){return 0===xs.length?Option.none():Option.some(xs[xs.length-1])}function findMap(arr,f){for(var i=0;i<arr.length;i++){var r=f(arr[i],i);if(r.isSome())return r}return Option.none()}function map$1(obj,f){return tupleMap(obj,function(x,i){return{k:i,v:f(x,i)}})}function find$1(obj,pred){for(var props=keys(obj),k=0,len=props.length;k<len;k++){var i=props[k],x=obj[i];if(pred(x,i,obj))return Option.some(x)}return Option.none()}function values(obj){return mapToArray(obj,function(v){return v})}function hasNonNullableKey(obj,key){return has(obj,key)&&void 0!==obj[key]&&null!==obj[key]}function baseMerge(merger){return function(){for(var objects=new Array(arguments.length),i=0;i<objects.length;i++)objects[i]=arguments[i];if(0===objects.length)throw new Error("Can't merge zero objects");for(var ret={},j=0;j<objects.length;j++){var curObject=objects[j];for(var key in curObject)hasOwnProperty$1.call(curObject,key)&&(ret[key]=merger(ret[key],curObject[key]))}return ret}}function cached(f){var r,called=!1;return function(){for(var args=[],_i=0;_i<arguments.length;_i++)args[_i]=arguments[_i];return called||(called=!0,r=f.apply(null,args)),r}}var SimpleResultType,NONE=function(){function eq(o){return o.isNone()}function call(thunk){return thunk()}function id(n){return n}var me={fold:function(n,s){return n()},is:never,isSome:never,isNone:always,getOr:id,getOrThunk:call,getOrDie:function(msg){throw new Error(msg||"error: getOrDie called on none.")},getOrNull:constant(null),getOrUndefined:constant(void 0),or:id,orThunk:call,map:none,each:noop,bind:none,exists:never,forall:always,filter:none,equals:eq,equals_:eq,toArray:function(){return[]},toString:constant("none()")};return Object.freeze&&Object.freeze(me),me}(),some=function(a){function self(){return me}function bind(f){return f(a)}var constant_a=constant(a),me={fold:function(n,s){return s(a)},is:function(v){return a===v},isSome:always,isNone:never,getOr:constant_a,getOrThunk:constant_a,getOrDie:constant_a,getOrNull:constant_a,getOrUndefined:constant_a,or:self,orThunk:self,map:function(f){return some(f(a))},each:function(f){f(a)},bind:bind,exists:bind,forall:bind,filter:function(f){return f(a)?me:NONE},toArray:function(){return[a]},toString:function(){return"some("+a+")"},equals:function(o){return o.is(a)},equals_:function(o,elementEq){return o.fold(never,function(b){return elementEq(a,b)})}};return me},Option={some:some,none:none,from:function(value){return null==value?NONE:some(value)}},value=function(o){return{is:function(v){return o===v},isValue:always,isError:never,getOr:constant(o),getOrThunk:constant(o),getOrDie:constant(o),or:function(opt){return value(o)},orThunk:function(f){return value(o)},fold:function(_,onValue){return onValue(o)},map:function(f){return value(f(o))},mapError:function(f){return value(o)},each:function(f){f(o)},bind:function(f){return f(o)},exists:function(f){return f(o)},forall:function(f){return f(o)},toOption:function(){return Option.some(o)}}},error=function(message){return{is:never,isValue:never,isError:always,getOr:identity,getOrThunk:function(f){return f()},getOrDie:function(){return die(String(message))()},or:function(opt){return opt},orThunk:function(f){return f()},fold:function(onError,_){return onError(message)},map:function(f){return error(message)},mapError:function(f){return error(f(message))},each:noop,bind:function(f){return error(message)},exists:never,forall:always,toOption:Option.none}},Result={value:value,error:error,fromOption:function(opt,err){return opt.fold(function(){return error(err)},value)}},isString=isType("string"),isObject=isType("object"),isArray=isType("array"),isBoolean=isType("boolean"),isFunction=isType("function"),isNumber=isType("number"),nativeSlice=Array.prototype.slice,nativeIndexOf=Array.prototype.indexOf,nativePush=Array.prototype.push,contains=function(xs,x){return-1<rawIndexOf(xs,x)},each=function(xs,f){for(var i=0,len=xs.length;i<len;i++){f(xs[i],i)}},head=function(xs){return 0===xs.length?Option.none():Option.some(xs[0])},from$1=isFunction(Array.from)?Array.from:function(x){return nativeSlice.call(x)},keys=Object.keys,hasOwnProperty=Object.hasOwnProperty,each$1=function(obj,f){for(var props=keys(obj),k=0,len=props.length;k<len;k++){var i=props[k];f(obj[i],i)}},tupleMap=function(obj,f){var r={};return each$1(obj,function(x,i){var tuple=f(x,i);r[tuple.k]=tuple.v}),r},mapToArray=function(obj,f){var r=[];return each$1(obj,function(value,name){r.push(f(value,name))}),r},get=function(obj,key){return has(obj,key)?Option.from(obj[key]):Option.none()},has=function(obj,key){return hasOwnProperty.call(obj,key)},Adt_generate=function(cases){if(!isArray(cases))throw new Error("cases must be an array");if(0===cases.length)throw new Error("there must be at least one case");var constructors=[],adt={};return each(cases,function(acase,count){var keys$1=keys(acase);if(1!==keys$1.length)throw new Error("one and only one name per case");var key=keys$1[0],value=acase[key];if(void 0!==adt[key])throw new Error("duplicate key detected:"+key);if("cata"===key)throw new Error("cannot have a case named cata (sorry)");if(!isArray(value))throw new Error("case arguments must be an array");constructors.push(key),adt[key]=function(){var argLength=arguments.length;if(argLength!==value.length)throw new Error("Wrong number of arguments to case "+key+". Expected "+value.length+" ("+value+"), got "+argLength);for(var args=new Array(argLength),i=0;i<args.length;i++)args[i]=arguments[i];return{fold:function(){if(arguments.length!==cases.length)throw new Error("Wrong number of arguments to fold. Expected "+cases.length+", got "+arguments.length);return arguments[count].apply(null,args)},match:function(branches){var branchKeys=keys(branches);if(constructors.length!==branchKeys.length)throw new Error("Wrong number of arguments to match. Expected: "+constructors.join(",")+"\nActual: "+branchKeys.join(","));if(!forall(constructors,function(reqKey){return contains(branchKeys,reqKey)}))throw new Error("Not all branches were specified when using match. Specified: "+branchKeys.join(", ")+"\nRequired: "+constructors.join(", "));return branches[key].apply(null,args)},log:function(label){domGlobals.console.log(label,{constructors:constructors,constructor:key,params:args})}}}}),adt},hasOwnProperty$1=Object.prototype.hasOwnProperty,deepMerge=baseMerge(function(old,nu){return isObject(old)&&isObject(nu)?deepMerge(old,nu):nu}),merge=baseMerge(function(old,nu){return nu});!function(SimpleResultType){SimpleResultType[SimpleResultType.Error=0]="Error",SimpleResultType[SimpleResultType.Value=1]="Value"}(SimpleResultType=SimpleResultType||{});function fold(res,onError,onValue){return res.stype===SimpleResultType.Error?onError(res.serror):onValue(res.svalue)}function svalue(v){return{stype:SimpleResultType.Value,svalue:v}}function serror(e){return{stype:SimpleResultType.Error,serror:e}}function defaulted(fallback){return adt.defaultedThunk(constant(fallback))}function wrap(key,value){var _a;return(_a={})[key]=value,_a}function exclude$1(obj,fields){return function(obj,fields){var r={};return each$1(obj,function(v,k){contains(fields,k)||(r[k]=v)}),r}(obj,fields)}function wrap$1(key,value){return wrap(key,value)}function wrapAll$1(keyvalues){return function(keyvalues){var r={};return each(keyvalues,function(kv){r[kv.key]=kv.value}),r}(keyvalues)}function consolidate(objs,base){var partitions=function(results){var errors=[],values=[];return each(results,function(result){result.fold(function(err){errors.push(err)},function(value){values.push(value)})}),{errors:errors,values:values}}(objs);return 0<partitions.errors.length?function(errors){return Result.error(flatten(errors))}(partitions.errors):function(values,base){return 0===values.length?Result.value(base):Result.value(deepMerge(base,merge.apply(void 0,values)))}(partitions.values,base)}function mergeErrors$1(errors){return compose(SimpleResult_serror,flatten)(errors)}function formatObj(input){return isObject(input)&&100<keys(input).length?" removed due to size":JSON.stringify(input,null,2)}function nu(path,getErrorInfo){return SimpleResult_serror([{path:path,getErrorInfo:getErrorInfo}])}function strictAccess(path,obj,key){return get(obj,key).fold(function(){return function(path,key,obj){return nu(path,function(){return'Could not find valid *strict* value for "'+key+'" in '+formatObj(obj)})}(path,key,obj)},SimpleResult_svalue)}function fallbackAccess(obj,key,fallbackThunk){var v=get(obj,key).fold(function(){return fallbackThunk(obj)},identity);return SimpleResult_svalue(v)}function cExtractOne(path,obj,field,strength){return field.fold(function(key,okey,presence,prop){function bundle(av){var result=prop.extract(path.concat([key]),strength,av);return SimpleResult_map(result,function(res){return wrap(okey,strength(res))})}function bundleAsOption(optValue){return optValue.fold(function(){var outcome=wrap(okey,strength(Option.none()));return SimpleResult_svalue(outcome)},function(ov){var result=prop.extract(path.concat([key]),strength,ov);return SimpleResult_map(result,function(res){return wrap(okey,strength(Option.some(res)))})})}return presence.fold(function(){return SimpleResult_bind(strictAccess(path,obj,key),bundle)},function(fallbackThunk){return SimpleResult_bind(fallbackAccess(obj,key,fallbackThunk),bundle)},function(){return SimpleResult_bind(function(obj,key){return SimpleResult_svalue(get(obj,key))}(obj,key),bundleAsOption)},function(fallbackThunk){return SimpleResult_bind(function(obj,key,fallback){var opt=get(obj,key).map(function(val){return!0===val?fallback(obj):val});return SimpleResult_svalue(opt)}(obj,key,fallbackThunk),bundleAsOption)},function(baseThunk){var base=baseThunk(obj),result=SimpleResult_map(fallbackAccess(obj,key,constant({})),function(v){return deepMerge(base,v)});return SimpleResult_bind(result,bundle)})},function(okey,instantiator){var state=instantiator(obj);return SimpleResult_svalue(wrap(okey,strength(state)))})}function value$1(validator){return{extract:function(path,strength,val){return SimpleResult_bindError(validator(val,strength),function(err){return function(path,err){return nu(path,function(){return err})}(path,err)})},toString:function(){return"val"}}}function getSetKeys(obj){var keys$1=keys(obj);return filter(keys$1,function(k){return hasNonNullableKey(obj,k)})}function objOfOnly(fields){var delegate=objOf(fields),fieldNames=foldr(fields,function(acc,f){return f.fold(function(key){return deepMerge(acc,wrap$1(key,!0))},constant(acc))},{});return{extract:function(path,strength,o){var keys=isBoolean(o)?[]:getSetKeys(o),extra=filter(keys,function(k){return!hasNonNullableKey(fieldNames,k)});return 0===extra.length?delegate.extract(path,strength,o):function(path,unsupported){return nu(path,function(){return"There are unsupported fields: ["+unsupported.join(", ")+"] specified"})}(path,extra)},toString:delegate.toString}}function arrOf(prop){return{extract:function(path,strength,array){var results=map(array,function(a,i){return prop.extract(path.concat(["["+i+"]"]),strength,a)});return ResultCombine_consolidateArr(results)},toString:function(){return"array("+prop.toString()+")"}}}function setOf(validator,prop){return{extract:function(path,strength,o){var keys$1=keys(o),validatedKeys=function(path,keys){return arrOf(value$1(validator)).extract(path,identity,keys)}(path,keys$1);return SimpleResult_bind(validatedKeys,function(validKeys){var schema=map(validKeys,function(vk){return adt$1.field(vk,vk,strict(),prop)});return objOf(schema).extract(path,strength,o)})},toString:function(){return"setOf("+prop.toString()+")"}}}function chooseFrom(path,strength,input,branches,ch){return get(branches,ch).fold(function(){return function(path,branches,branch){return nu(path,function(){return'The chosen schema: "'+branch+'" did not exist in branches: '+formatObj(branches)})}(path,branches,ch)},function(vp){return vp.extract(path.concat(["branch: "+ch]),strength,input)})}function choose(key,branches){return{extract:function(path,strength,input){return get(input,key).fold(function(){return function(path,key){return nu(path,function(){return'Choice schema did not contain choice key: "'+key+'"'})}(path,key)},function(chosen){return chooseFrom(path,strength,input,branches,chosen)})},toString:function(){return"chooseOn("+key+"). Possible values: "+keys(branches)}}}function arrOfObj$1(objFields){return arrOfObj(objFields)}function valueOf(validator){return value$1(function(v){return validator(v).fold(SimpleResult_serror,SimpleResult_svalue)})}function setOf$1(validator,prop){return setOf(function(v){return SimpleResult_fromResult(validator(v))},prop)}function asRaw(label,prop,obj){return SimpleResult_toResult(function(label,prop,strength,obj){var res=prop.extract([label],strength,obj);return SimpleResult_mapError(res,function(errs){return{input:obj,errors:errs}})}(label,prop,identity,obj))}function getOrDie(extraction){return extraction.fold(function(errInfo){throw new Error(formatError(errInfo))},identity)}function asRawOrDie(label,prop,obj){return getOrDie(asRaw(label,prop,obj))}function chooseProcessor(key,branches){return choose(key,branches)}function choose$1(key,branches){return choose(key,map$1(branches,objOf))}function typedValue(validator,expectedType){return value$1(function(a){var actualType=typeof a;return validator(a)?SimpleResult_svalue(a):SimpleResult_serror("Expected type: "+expectedType+" but got: "+actualType)})}function validateEnum(values){return valueOf(function(value){return contains(values,value)?Result.value(value):Result.error('Unsupported value: "'+value+'", choose one of "'+values.join(", ")+'".')})}function strict$1(key){return field(key,key,strict(),anyValue())}function strictOf(key,schema){return field(key,key,strict(),schema)}function strictString(key){return strictOf(key,string)}function strictStringEnum(key,values){return field(key,key,strict(),validateEnum(values))}function strictFunction(key){return strictOf(key,functionProcessor)}function strictObjOf(key,objSchema){return field(key,key,strict(),objOf(objSchema))}function strictArrayOfObj(key,objFields){return field(key,key,strict(),arrOfObj(objFields))}function strictArrayOf(key,schema){return field(key,key,strict(),arrOf(schema))}function option(key){return field(key,key,asOption(),anyValue())}function optionOf(key,schema){return field(key,key,asOption(),schema)}function optionNumber(key){return optionOf(key,number)}function optionString(key){return optionOf(key,string)}function optionFunction(key){return optionOf(key,functionProcessor)}function optionObjOf(key,objSchema){return optionOf(key,objOf(objSchema))}function defaulted$1(key,fallback){return field(key,key,defaulted(fallback),anyValue())}function defaultedOf(key,fallback,schema){return field(key,key,defaulted(fallback),schema)}function defaultedNumber(key,fallback){return defaultedOf(key,fallback,number)}function defaultedString(key,fallback){return defaultedOf(key,fallback,string)}function defaultedStringEnum(key,fallback,values){return defaultedOf(key,fallback,validateEnum(values))}function defaultedBoolean(key,fallback){return defaultedOf(key,fallback,boolean)}function defaultedFunction(key,fallback){return defaultedOf(key,fallback,functionProcessor)}function defaultedObjOf(key,fallback,objSchema){return defaultedOf(key,fallback,objOf(objSchema))}function state$1(okey,instantiator){return state(okey,instantiator)}function compareDocumentPosition(a,b,match){return 0!=(a.compareDocumentPosition(b)&match)}function find$2(regexes,agent){var r=function(regexes,s){for(var i=0;i<regexes.length;i++){var x=regexes[i];if(x.test(s))return x}}(regexes,agent);if(!r)return{major:0,minor:0};function group(i){return Number(agent.replace(r,"$"+i))}return nu$1(group(1),group(2))}function isBrowser(name,current){return function(){return current===name}}function isOS(name,current){return function(){return current===name}}function detect$1(candidates,userAgent){var agent=String(userAgent).toLowerCase();return find(candidates,function(candidate){return candidate.search(agent)})}function contains$1(str,substr){return-1!==str.indexOf(substr)}function checkContains(target){return function(uastring){return contains$1(uastring,target)}}function detect$3(){return platform.get()}function is(element,selector){var dom=element.dom();if(dom.nodeType!==ELEMENT$1)return!1;var elem=dom;if(void 0!==elem.matches)return elem.matches(selector);if(void 0!==elem.msMatchesSelector)return elem.msMatchesSelector(selector);if(void 0!==elem.webkitMatchesSelector)return elem.webkitMatchesSelector(selector);if(void 0!==elem.mozMatchesSelector)return elem.mozMatchesSelector(selector);throw new Error("Browser lacks native selectors")}function bypassSelector(dom){return dom.nodeType!==ELEMENT$1&&dom.nodeType!==DOCUMENT$1||0===dom.childElementCount}function all(selector,scope){var base=void 0===scope?domGlobals.document:scope.dom();return bypassSelector(base)?[]:map(base.querySelectorAll(selector),Element.fromDom)}function eq(e1,e2){return e1.dom()===e2.dom()}function ancestor(scope,transform,isRoot){for(var element=scope.dom(),stop=isFunction(isRoot)?isRoot:constant(!1);element.parentNode;){element=element.parentNode;var el=Element.fromDom(element),transformed=transform(el);if(transformed.isSome())return transformed;if(stop(el))break}return Option.none()}function isSource(component,simulatedEvent){return eq(component.element(),simulatedEvent.event().target())}function nu$4(parts){if(!hasNonNullableKey(parts,"can")&&!hasNonNullableKey(parts,"abort")&&!hasNonNullableKey(parts,"run"))throw new Error("EventHandler defined by: "+JSON.stringify(parts,null,2)+" does not have can, abort, or run!");return asRawOrDie("Extracting event.handler",objOfOnly([defaulted$1("can",constant(!0)),defaulted$1("abort",constant(!1)),defaulted$1("run",noop)]),parts)}function fuse(handlers){var can=function(handlers,f){return function(){for(var args=[],_i=0;_i<arguments.length;_i++)args[_i]=arguments[_i];return foldl(handlers,function(acc,handler){return acc&&f(handler).apply(void 0,args)},!0)}}(handlers,function(handler){return handler.can}),abort=function(handlers,f){return function(){for(var args=[],_i=0;_i<arguments.length;_i++)args[_i]=arguments[_i];return foldl(handlers,function(acc,handler){return acc||f(handler).apply(void 0,args)},!1)}}(handlers,function(handler){return handler.abort});return nu$4({can:can,abort:abort,run:function(){for(var args=[],_i=0;_i<arguments.length;_i++)args[_i]=arguments[_i];each(handlers,function(handler){handler.run.apply(void 0,args)})}})}function emit(component,event){dispatchWith(component,component.element(),event,{})}function emitWith(component,event,properties){dispatchWith(component,component.element(),event,properties)}function emitExecute(component){emit(component,execute())}function dispatch(component,target,event){dispatchWith(component,target,event,{})}function dispatchEvent(component,target,event,simulatedEvent){component.getSystem().triggerEvent(event,target,simulatedEvent.event())}function derive(configs){return wrapAll$1(configs)}function abort(name,predicate){return{key:name,value:nu$4({abort:predicate})}}function preventDefault(name){return{key:name,value:nu$4({run:function(component,simulatedEvent){simulatedEvent.event().prevent()}})}}function run(name,handler){return{key:name,value:nu$4({run:handler})}}function runActionExtra(name,action,extra){return{key:name,value:nu$4({run:function(component,simulatedEvent){action.apply(void 0,[component,simulatedEvent].concat(extra))}})}}function runOnSourceName(name){return function(handler){return{key:name,value:nu$4({run:function(component,simulatedEvent){isSource(component,simulatedEvent)&&handler(component,simulatedEvent)}})}}}function redirectToPart(name,detail,partName){return function(name,uid){return run(name,function(component,simulatedEvent){component.getSystem().getByUid(uid).each(function(redirectee){dispatchEvent(redirectee,redirectee.element(),name,simulatedEvent)})})}(name,detail.partUids[partName])}function runWithTarget(name,f){return run(name,function(component,simulatedEvent){var ev=simulatedEvent.event(),target=component.getSystem().getByDom(ev.target()).fold(function(){return closest(ev.target(),function(el){return component.getSystem().getByDom(el).toOption()},constant(!1)).getOr(component)},function(c){return c});f(component,target,simulatedEvent)})}function cutter(name){return run(name,function(component,simulatedEvent){simulatedEvent.cut()})}function runOnSource(name,f){return runOnSourceName(name)(f)}function Immutable(){for(var fields=[],_i=0;_i<arguments.length;_i++)fields[_i]=arguments[_i];return function(){for(var values=[],_i=0;_i<arguments.length;_i++)values[_i]=arguments[_i];if(fields.length!==values.length)throw new Error('Wrong number of arguments to struct. Expected "['+fields.length+']", got '+values.length+" arguments");var struct={};return each(fields,function(name,i){struct[name]=constant(values[i])}),struct}}function sort$1(arr){return arr.slice(0).sort()}function validateStrArr(label,array){if(!isArray(array))throw new Error("The "+label+" fields must be an array. Was: "+array+".");each(array,function(a){if(!isString(a))throw new Error("The value "+a+" in the "+label+" fields was not a string.")})}function MixedBag(required,optional){var everything=required.concat(optional);if(0===everything.length)throw new Error("You must specify at least one required or optional field.");return validateStrArr("required",required),validateStrArr("optional",optional),function(everything){var sorted=sort$1(everything);find(sorted,function(s,i){return i<sorted.length-1&&s===sorted[i+1]}).each(function(d){throw new Error("The field: "+d+" occurs more than once in the combined fields: ["+sorted.join(", ")+"].")})}(everything),function(obj){var keys$1=keys(obj);forall(required,function(req){return contains(keys$1,req)})||function(required,keys){throw new Error("All required keys ("+sort$1(required).join(", ")+") were not specified. Specified keys were: "+sort$1(keys).join(", ")+".")}(required,keys$1);var unsupported=filter(keys$1,function(key){return!contains(everything,key)});0<unsupported.length&&function(unsupported){throw new Error("Unsupported keys for object: "+sort$1(unsupported).join(", "))}(unsupported);var r={};return each(required,function(req){r[req]=constant(obj[req])}),each(optional,function(opt){r[opt]=constant(Object.prototype.hasOwnProperty.call(obj,opt)?Option.some(obj[opt]):Option.none())}),r}}function owner(element){return Element.fromDom(element.dom().ownerDocument)}function documentElement(element){return Element.fromDom(element.dom().ownerDocument.documentElement)}function defaultView(element){return Element.fromDom(element.dom().ownerDocument.defaultView)}function parent(element){return Option.from(element.dom().parentNode).map(Element.fromDom)}function offsetParent(element){return Option.from(element.dom().offsetParent).map(Element.fromDom)}function children(element){return map(element.dom().childNodes,Element.fromDom)}function child(element,index){var cs=element.dom().childNodes;return Option.from(cs[index]).map(Element.fromDom)}function before(marker,element){parent(marker).each(function(v){v.dom().insertBefore(element.dom(),marker.dom())})}function after(marker,element){(function(element){return Option.from(element.dom().nextSibling).map(Element.fromDom)})(marker).fold(function(){parent(marker).each(function(v){append(v,element)})},function(v){before(v,element)})}function prepend(parent,element){(function(element){return child(element,0)})(parent).fold(function(){append(parent,element)},function(v){parent.dom().insertBefore(element.dom(),v.dom())})}function append$1(parent,elements){each(elements,function(x){append(parent,x)})}function empty(element){element.dom().textContent="",each(children(element),function(rogue){remove(rogue)})}function unwrap(wrapper){var children$1=children(wrapper);0<children$1.length&&function(marker,elements){each(elements,function(x){before(marker,x)})}(wrapper,children$1),remove(wrapper)}function get$1(element){return element.dom().innerHTML}function set(element,content){var docDom=owner(element).dom(),fragment=Element.fromDom(docDom.createDocumentFragment()),contentElements=function(html,scope){var div=(scope||domGlobals.document).createElement("div");return div.innerHTML=html,children(Element.fromDom(div))}(content,docDom);append$1(fragment,contentElements),empty(element),append(element,fragment)}function name(element){return element.dom().nodeName.toLowerCase()}function isType$1(t){return function(element){return function(element){return element.dom().nodeType}(element)===t}}function rawSet(dom,key,value){if(!(isString(value)||isBoolean(value)||isNumber(value)))throw domGlobals.console.error("Invalid call to Attr.set. Key ",key,":: Value ",value,":: Element ",dom),new Error("Attribute value was not simple");dom.setAttribute(key,value+"")}function set$1(element,key,value){rawSet(element.dom(),key,value)}function get$2(element,key){var v=element.dom().getAttribute(key);return null===v?void 0:v}function getOpt(element,key){return Option.from(get$2(element,key))}function has$1(element,key){var dom=element.dom();return!(!dom||!dom.hasAttribute)&&dom.hasAttribute(key)}function remove$1(element,key){element.dom().removeAttribute(key)}function shallow$1(original){return function(original,isDeep){return Element.fromDom(original.dom().cloneNode(isDeep))}(original,!1)}function getHtml(element){return function(element){var container=Element.fromTag("div"),clone=Element.fromDom(element.dom().cloneNode(!0));return append(container,clone),get$1(container)}(shallow$1(element))}function element(elem){return getHtml(elem)}function generate$1(prefix){var time=(new Date).getTime();return prefix+"_"+Math.floor(1e9*Math.random())+ ++unique+String(time)}function generate$2(prefix){return generate$1(prefix)}function NoContextApi(getComp){function fail(event){return function(){throw new Error("The component must be in a context to send: "+event+(getComp?"\n"+element(getComp().element())+" is not in context.":""))}}return{debugInfo:constant("fake"),triggerEvent:fail("triggerEvent"),triggerFocus:fail("triggerFocus"),triggerEscape:fail("triggerEscape"),build:fail("build"),addToWorld:fail("addToWorld"),removeFromWorld:fail("removeFromWorld"),addToGui:fail("addToGui"),removeFromGui:fail("removeFromGui"),getByUid:fail("getByUid"),getByDom:fail("getByDom"),broadcast:fail("broadcast"),broadcastOn:fail("broadcastOn"),broadcastEvent:fail("broadcastEvent"),isConnected:constant(!1)}}function markAsExtraApi(f,extraName){var delegate=f.toString(),endIndex=delegate.indexOf(")")+1,openBracketIndex=delegate.indexOf("("),parameters=delegate.substring(openBracketIndex+1,endIndex-1).split(/,\s*/);return f.toFunctionAnnotation=function(){return{name:extraName,parameters:cleanParameters(parameters)}},f}function premade(comp){return wrap$1(premadeTag,comp)}function makeApi(f){return function(f,apiFunction){var delegate=apiFunction.toString(),endIndex=delegate.indexOf(")")+1,openBracketIndex=delegate.indexOf("("),parameters=delegate.substring(openBracketIndex+1,endIndex-1).split(/,\s*/);return f.toFunctionAnnotation=function(){return{name:"OVERRIDE",parameters:cleanParameters(parameters.slice(1))}},f}(function(component){for(var rest=[],_i=1;_i<arguments.length;_i++)rest[_i-1]=arguments[_i];return f.apply(void 0,[component.getApis()].concat([component].concat(rest)))},f)}function byInnerKey(data,tuple){var r={};return each$1(data,function(detail,key){each$1(detail,function(value,indexKey){var chain=get(r,indexKey).getOr([]);r[indexKey]=chain.concat([tuple(key,value)])})}),r}function nu$6(s){return{classes:void 0!==s.classes?s.classes:[],attributes:void 0!==s.attributes?s.attributes:{},styles:void 0!==s.styles?s.styles:{}}}function combine(info,baseMod,behaviours,base){var modsByBehaviour=__assign({},baseMod);function combineObjects(objects){return foldr(objects,function(b,a){return __assign(__assign({},a.modification),b)},{})}each(behaviours,function(behaviour){modsByBehaviour[behaviour.name()]=behaviour.exhibit(info,base)});var byAspect=byInnerKey(modsByBehaviour,function(name,modification){return{name:name,modification:modification}}),combinedClasses=foldr(byAspect.classes,function(b,a){return a.modification.concat(b)},[]),combinedAttributes=combineObjects(byAspect.attributes),combinedStyles=combineObjects(byAspect.styles);return nu$6({classes:combinedClasses,attributes:combinedAttributes,styles:combinedStyles})}function getCurried(descHandler){return descHandler.cHandler}function behaviourTuple(name,handler){return{name:constant(name),handler:constant(handler)}}function groupByEvents(info,behaviours,base){var behaviourEvents=__assign(__assign({},base),function(behaviours,info){var r={};return each(behaviours,function(behaviour){r[behaviour.name()]=behaviour.handlers(info)}),r}(behaviours,info));return byInnerKey(behaviourEvents,behaviourTuple)}function assemble(rawHandler){var handler=function(handler){return isFunction(handler)?{can:constant(!0),abort:constant(!1),run:handler}:handler}(rawHandler);return function(component,simulatedEvent){for(var rest=[],_i=2;_i<arguments.length;_i++)rest[_i-2]=arguments[_i];var args=[component,simulatedEvent].concat(rest);handler.abort.apply(void 0,args)?simulatedEvent.stop():handler.can.apply(void 0,args)&&handler.run.apply(void 0,args)}}function fuse$1(tuples,eventOrder,eventName){var order=eventOrder[eventName];return order?function(label,keyName,array,order){try{var sorted=sort(array,function(a,b){var aKey=a[keyName](),bKey=b[keyName](),aIndex=order.indexOf(aKey),bIndex=order.indexOf(bKey);if(-1===aIndex)throw new Error("The ordering for "+label+" does not have an entry for "+aKey+".\nOrder specified: "+JSON.stringify(order,null,2));if(-1===bIndex)throw new Error("The ordering for "+label+" does not have an entry for "+bKey+".\nOrder specified: "+JSON.stringify(order,null,2));return aIndex<bIndex?-1:bIndex<aIndex?1:0});return Result.value(sorted)}catch(err){return Result.error([err])}}("Event: "+eventName,"name",tuples,order).map(function(sortedTuples){var handlers=map(sortedTuples,function(tuple){return tuple.handler()});return fuse(handlers)}):function(eventName,tuples){return Result.error(["The event ("+eventName+') has more than one behaviour that listens to it.\nWhen this occurs, you must specify an event ordering for the behaviours in your spec (e.g. [ "listing", "toggling" ]).\nThe behaviours that can trigger it are: '+JSON.stringify(map(tuples,function(c){return c.name()}),null,2)])}(eventName,tuples)}function toInfo(spec){return asRaw("custom.definition",objOf([field("dom","dom",strict(),objOf([strict$1("tag"),defaulted$1("styles",{}),defaulted$1("classes",[]),defaulted$1("attributes",{}),option("value"),option("innerHtml")])),strict$1("components"),strict$1("uid"),defaulted$1("events",{}),defaulted$1("apis",{}),field("eventOrder","eventOrder",function(base){return adt.mergeWithThunk(constant(base))}({"alloy.execute":["disabling","alloy.base.behaviour","toggling","typeaheadevents"],"alloy.focus":["alloy.base.behaviour","focusing","keying"],"alloy.system.init":["alloy.base.behaviour","disabling","toggling","representing"],input:["alloy.base.behaviour","representing","streaming","invalidating"],"alloy.system.detached":["alloy.base.behaviour","representing","item-events","tooltipping"],mousedown:["focusing","alloy.base.behaviour","item-type-events"],touchstart:["focusing","alloy.base.behaviour","item-type-events"],mouseover:["item-type-events","tooltipping"]}),anyValue$1()),option("domModification")]),spec)}function read$2(element,attr){var value=get$2(element,attr);return void 0===value||""===value?[]:value.split(" ")}function supports(element){return void 0!==element.dom().classList}function add$1(element,clazz){return function(element,attr,id){var nu=read$2(element,attr).concat([id]);return set$1(element,attr,nu.join(" ")),!0}(element,"class",clazz)}function remove$3(element,clazz){return function(element,attr,id){var nu=filter(read$2(element,attr),function(v){return v!==id});return 0<nu.length?set$1(element,attr,nu.join(" ")):remove$1(element,attr),!1}(element,"class",clazz)}function add$2(element,clazz){supports(element)?element.dom().classList.add(clazz):add$1(element,clazz)}function cleanClass(element){0===(supports(element)?element.dom().classList:function(element){return read$2(element,"class")}(element)).length&&remove$1(element,"class")}function remove$4(element,clazz){supports(element)?element.dom().classList.remove(clazz):remove$3(element,clazz),cleanClass(element)}function has$2(element,clazz){return supports(element)&&element.dom().classList.contains(clazz)}function add$3(element,classes){each(classes,function(x){add$2(element,x)})}function remove$5(element,classes){each(classes,function(x){remove$4(element,x)})}function isSupported(dom){return void 0!==dom.style&&isFunction(dom.style.getPropertyValue)}function inBody(element){var dom=isText(element)?element.dom().parentNode:element.dom();return null!=dom&&dom.ownerDocument.body.contains(dom)}function internalSet(dom,property,value){if(!isString(value))throw domGlobals.console.error("Invalid call to CSS.set. Property ",property,":: Value ",value,":: Element ",dom),new Error("CSS value must be a string: "+value);isSupported(dom)&&dom.style.setProperty(property,value)}function internalRemove(dom,property){isSupported(dom)&&dom.style.removeProperty(property)}function set$2(element,property,value){var dom=element.dom();internalSet(dom,property,value)}function setAll$1(element,css){var dom=element.dom();each$1(css,function(v,k){internalSet(dom,k,v)})}function setOptions(element,css){var dom=element.dom();each$1(css,function(v,k){v.fold(function(){internalRemove(dom,k)},function(value){internalSet(dom,k,value)})})}function get$4(element,property){var dom=element.dom(),r=domGlobals.window.getComputedStyle(dom).getPropertyValue(property),v=""!==r||inBody(element)?r:getUnsafeProperty(dom,property);return null===v?void 0:v}function getRaw(element,property){var dom=element.dom(),raw=getUnsafeProperty(dom,property);return Option.from(raw).filter(function(r){return 0<r.length})}function isValidValue(tag,property,value){var element=Element.fromTag(tag);return set$2(element,property,value),getRaw(element,property).isSome()}function remove$6(element,property){var dom=element.dom();internalRemove(dom,property),has$1(element,"style")&&""===function(str){return str.replace(/^\s+|\s+$/g,"")}(get$2(element,"style"))&&remove$1(element,"style")}function reflow(e){return e.dom().offsetWidth}function get$5(element){return element.dom().value}function set$3(element,value){if(void 0===value)throw new Error("Value.set was undefined");element.dom().value=value}function renderToDom(definition){var subject=Element.fromTag(definition.tag);!function(element,attrs){var dom=element.dom();each$1(attrs,function(v,k){rawSet(dom,k,v)})}(subject,definition.attributes),add$3(subject,definition.classes),setAll$1(subject,definition.styles),definition.innerHtml.each(function(html){return set(subject,html)});var children=definition.domChildren;return append$1(subject,children),definition.value.each(function(value){set$3(subject,value)}),definition.uid,writeOnly(subject,definition.uid),subject}function generateFrom$1(spec,all){return function(spec,all){var schema=map(all,function(a){return optionObjOf(a.name(),[strict$1("config"),defaulted$1("state",NoState)])}),validated=asRaw("component.behaviours",objOf(schema),spec.behaviours).fold(function(errInfo){throw new Error(formatError(errInfo)+"\nComplete spec:\n"+JSON.stringify(spec,null,2))},function(v){return v});return{list:all,data:map$1(validated,function(optBlobThunk){var output=optBlobThunk.map(function(blob){return{config:blob.config,state:blob.state.init(blob.config)}});return function(){return output}})}}(spec,all)}function generate$3(spec){var all=function(spec){var behaviours=get(spec,"behaviours").getOr({}),keys$1=filter(keys(behaviours),function(k){return void 0!==behaviours[k]});return map(keys$1,function(k){return behaviours[k].me})}(spec);return generateFrom$1(spec,all)}function getDomDefinition(info,bList,bData){var definition=function(detail){return __assign(__assign({},detail.dom),{uid:detail.uid,domChildren:map(detail.components,function(comp){return comp.element()})})}(info),infoModification=function(detail){return detail.domModification.fold(function(){return nu$6({})},nu$6)}(info),baseModification={"alloy.base.modification":infoModification};return function(defnA,mod){return __assign(__assign({},defnA),{attributes:__assign(__assign({},defnA.attributes),mod.attributes),styles:__assign(__assign({},defnA.styles),mod.styles),classes:defnA.classes.concat(mod.classes)})}(definition,0<bList.length?combine(bData,baseModification,bList,definition):infoModification)}function getEvents(info,bList,bData){var baseEvents={"alloy.base.behaviour":function(info){return info.events}(info)};return function(info,eventOrder,behaviours,base){var byEventName=groupByEvents(info,behaviours,base);return combineGroups(byEventName,eventOrder)}(bData,info.eventOrder,bList,baseEvents).getOrDie()}function buildFromSpec(userSpec){var _a=make(userSpec),specEvents=_a.events,spec=__rest(_a,["events"]),components=function(spec){var components=get(spec,"components").getOr([]);return map(components,build$1)}(spec),completeSpec=__assign(__assign({},spec),{events:__assign(__assign({},DefaultEvents),specEvents),components:components});return Result.value(function(spec){function getMe(){return me}var systemApi=Cell(singleton),info=getOrDie(toInfo(spec)),bBlob=generate$3(spec),bList=function(bData){return bData.list}(bBlob),bData=function(bData){return bData.data}(bBlob),modDefinition=getDomDefinition(info,bList,bData),item=renderToDom(modDefinition),events=getEvents(info,bList,bData),subcomponents=Cell(info.components),me={getSystem:systemApi.get,config:function(behaviour){var b=bData;return(isFunction(b[behaviour.name()])?b[behaviour.name()]:function(){throw new Error("Could not find "+behaviour.name()+" in "+JSON.stringify(spec,null,2))})()},hasConfigured:function(behaviour){return isFunction(bData[behaviour.name()])},spec:constant(spec),readState:function(behaviourName){return bData[behaviourName]().map(function(b){return b.state.readState()}).getOr("not enabled")},getApis:function(){return info.apis},connect:function(newApi){systemApi.set(newApi)},disconnect:function(){systemApi.set(NoContextApi(getMe))},element:constant(item),syncComponents:function(){var children$1=children(item),subs=bind(children$1,function(child){return systemApi.get().getByDom(child).fold(function(){return[]},function(c){return[c]})});subcomponents.set(subs)},components:subcomponents.get,events:constant(events)};return me}(completeSpec))}function text(textContent){var element=Element.fromText(textContent);return external({element:element})}var SimpleResult_fromResult=function(res){return res.fold(serror,svalue)},SimpleResult_toResult=function(res){return fold(res,Result.error,Result.value)},SimpleResult_svalue=svalue,SimpleResult_partition=function(results){var values=[],errors=[];return each(results,function(obj){fold(obj,function(err){return errors.push(err)},function(val){return values.push(val)})}),{values:values,errors:errors}},SimpleResult_serror=serror,SimpleResult_bind=function(res,f){return res.stype===SimpleResultType.Value?f(res.svalue):res},SimpleResult_bindError=function(res,f){return res.stype===SimpleResultType.Error?f(res.serror):res},SimpleResult_map=function(res,f){return res.stype===SimpleResultType.Value?{stype:SimpleResultType.Value,svalue:f(res.svalue)}:res},SimpleResult_mapError=function(res,f){return res.stype===SimpleResultType.Error?{stype:SimpleResultType.Error,serror:f(res.serror)}:res},adt=Adt_generate([{strict:[]},{defaultedThunk:["fallbackThunk"]},{asOption:[]},{asDefaultedOptionThunk:["fallbackThunk"]},{mergeWithThunk:["baseThunk"]}]),strict=adt.strict,asOption=adt.asOption,defaultedThunk=adt.defaultedThunk,mergeWithThunk=(adt.asDefaultedOptionThunk,adt.mergeWithThunk),ResultCombine_consolidateObj=(Adt_generate([{bothErrors:["error1","error2"]},{firstError:["error1","value2"]},{secondError:["value1","error2"]},{bothValues:["value1","value2"]}]),function(objects,base){var partition=SimpleResult_partition(objects);return 0<partition.errors.length?mergeErrors$1(partition.errors):function(values,base){return 0<values.length?SimpleResult_svalue(deepMerge(base,merge.apply(void 0,values))):SimpleResult_svalue(base)}(partition.values,base)}),ResultCombine_consolidateArr=function(objects){var partitions=SimpleResult_partition(objects);return 0<partitions.errors.length?mergeErrors$1(partitions.errors):SimpleResult_svalue(partitions.values)},adt$1=Adt_generate([{field:["key","okey","presence","prop"]},{state:["okey","instantiator"]}]),objOf=function(fields){return{extract:function(path,strength,o){return function(path,obj,fields,strength){var results=map(fields,function(field){return cExtractOne(path,obj,field,strength)});return ResultCombine_consolidateObj(results,{})}(path,o,fields,strength)},toString:function(){return"obj{\n"+map(fields,function(field){return field.fold(function(key,okey,presence,prop){return key+" -> "+prop.toString()},function(okey,instantiator){return"state("+okey+")"})}).join("\n")+"}"}}},anyValue=constant(value$1(SimpleResult_svalue)),arrOfObj=compose(arrOf,objOf),state=adt$1.state,field=adt$1.field,_anyValue=value$1(SimpleResult_svalue),valueThunkOf=function(getDelegate){return{extract:function(path,strength,val){return getDelegate().extract(path,strength,val)},toString:function(){return getDelegate().toString()}}},formatError=function(errInfo){return"Errors: \n"+function(errors){var es=10<errors.length?errors.slice(0,10).concat([{path:[],getErrorInfo:function(){return"... (only showing first ten failures)"}}]):errors;return map(es,function(e){return"Failed path: ("+e.path.join(" > ")+")\n"+e.getErrorInfo()})}(errInfo.errors).join("\n")+"\n\nInput object: "+formatObj(errInfo.input)},anyValue$1=constant(_anyValue),number=typedValue(isNumber,"number"),string=typedValue(isString,"string"),boolean=typedValue(isBoolean,"boolean"),functionProcessor=typedValue(isFunction,"function"),isPostMessageable=function(val){function every(iter,callbackFn){for(var result=iter.next();!result.done;){if(!callbackFn(result.value))return!1;result=iter.next()}return!0}if(Object(val)!==val)return!0;switch({}.toString.call(val).slice(8,-1)){case"Boolean":case"Number":case"String":case"Date":case"RegExp":case"Blob":case"FileList":case"ImageData":case"ImageBitmap":case"ArrayBuffer":return!0;case"Array":case"Object":return Object.keys(val).every(function(prop){return isPostMessageable(val[prop])});case"Map":return every(val.keys(),isPostMessageable)&&every(val.values(),isPostMessageable);case"Set":return every(val.keys(),isPostMessageable);default:return!1}},postMessageable=value$1(function(a){return isPostMessageable(a)?SimpleResult_svalue(a):SimpleResult_serror("Expected value to be acceptable for sending via postMessage")}),Cell=function(initial){function get(){return value}var value=initial;return{get:get,set:function(v){value=v},clone:function(){return Cell(get())}}},fromDom=function(node){if(null==node)throw new Error("Node cannot be null or undefined");return{dom:constant(node)}},Element={fromHtml:function(html,scope){var div=(scope||domGlobals.document).createElement("div");if(div.innerHTML=html,!div.hasChildNodes()||1<div.childNodes.length)throw domGlobals.console.error("HTML does not have a single root node",html),new Error("HTML must have a single root node");return fromDom(div.childNodes[0])},fromTag:function(tag,scope){var node=(scope||domGlobals.document).createElement(tag);return fromDom(node)},fromText:function(text,scope){var node=(scope||domGlobals.document).createTextNode(text);return fromDom(node)},fromDom:fromDom,fromPoint:function(docElm,x,y){var doc=docElm.dom();return Option.from(doc.elementFromPoint(x,y)).map(fromDom)}},Node_documentPositionContainedBy=function(a,b){return compareDocumentPosition(a,b,domGlobals.Node.DOCUMENT_POSITION_CONTAINED_BY)},unknown=function(){return nu$1(0,0)},nu$1=function(major,minor){return{major:major,minor:minor}},Version={nu:nu$1,detect:function(versionRegexes,agent){var cleanedAgent=String(agent).toLowerCase();return 0===versionRegexes.length?unknown():find$2(versionRegexes,cleanedAgent)},unknown:unknown},nu$2=function(info){var current=info.current;return{current:current,version:info.version,isEdge:isBrowser("Edge",current),isChrome:isBrowser("Chrome",current),isIE:isBrowser("IE",current),isOpera:isBrowser("Opera",current),isFirefox:isBrowser("Firefox",current),isSafari:isBrowser("Safari",current)}},Browser={unknown:function(){return nu$2({current:void 0,version:Version.unknown()})},nu:nu$2,edge:constant("Edge"),chrome:constant("Chrome"),ie:constant("IE"),opera:constant("Opera"),firefox:constant("Firefox"),safari:constant("Safari")},nu$3=function(info){var current=info.current;return{current:current,version:info.version,isWindows:isOS("Windows",current),isiOS:isOS("iOS",current),isAndroid:isOS("Android",current),isOSX:isOS("OSX",current),isLinux:isOS("Linux",current),isSolaris:isOS("Solaris",current),isFreeBSD:isOS("FreeBSD",current),isChromeOS:isOS("ChromeOS",current)}},OperatingSystem={unknown:function(){return nu$3({current:void 0,version:Version.unknown()})},nu:nu$3,windows:constant("Windows"),ios:constant("iOS"),android:constant("Android"),linux:constant("Linux"),osx:constant("OSX"),solaris:constant("Solaris"),freebsd:constant("FreeBSD"),chromeos:constant("ChromeOS")},UaString_detectBrowser=function(browsers,userAgent){return detect$1(browsers,userAgent).map(function(browser){var version=Version.detect(browser.versionRegexes,userAgent);return{current:browser.name,version:version}})},UaString_detectOs=function(oses,userAgent){return detect$1(oses,userAgent).map(function(os){var version=Version.detect(os.versionRegexes,userAgent);return{current:os.name,version:version}})},normalVersionRegex=/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,browsers=[{name:"Edge",versionRegexes:[/.*?edge\/ ?([0-9]+)\.([0-9]+)$/],search:function(uastring){return contains$1(uastring,"edge/")&&contains$1(uastring,"chrome")&&contains$1(uastring,"safari")&&contains$1(uastring,"applewebkit")}},{name:"Chrome",versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/,normalVersionRegex],search:function(uastring){return contains$1(uastring,"chrome")&&!contains$1(uastring,"chromeframe")}},{name:"IE",versionRegexes:[/.*?msie\ ?([0-9]+)\.([0-9]+).*/,/.*?rv:([0-9]+)\.([0-9]+).*/],search:function(uastring){return contains$1(uastring,"msie")||contains$1(uastring,"trident")}},{name:"Opera",versionRegexes:[normalVersionRegex,/.*?opera\/([0-9]+)\.([0-9]+).*/],search:checkContains("opera")},{name:"Firefox",versionRegexes:[/.*?firefox\/\ ?([0-9]+)\.([0-9]+).*/],search:checkContains("firefox")},{name:"Safari",versionRegexes:[normalVersionRegex,/.*?cpu os ([0-9]+)_([0-9]+).*/],search:function(uastring){return(contains$1(uastring,"safari")||contains$1(uastring,"mobile/"))&&contains$1(uastring,"applewebkit")}}],oses=[{name:"Windows",search:checkContains("win"),versionRegexes:[/.*?windows\ nt\ ?([0-9]+)\.([0-9]+).*/]},{name:"iOS",search:function(uastring){return contains$1(uastring,"iphone")||contains$1(uastring,"ipad")},versionRegexes:[/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,/.*cpu os ([0-9]+)_([0-9]+).*/,/.*cpu iphone os ([0-9]+)_([0-9]+).*/]},{name:"Android",search:checkContains("android"),versionRegexes:[/.*?android\ ?([0-9]+)\.([0-9]+).*/]},{name:"OSX",search:checkContains("mac os x"),versionRegexes:[/.*?mac\ os\ x\ ?([0-9]+)_([0-9]+).*/]},{name:"Linux",search:checkContains("linux"),versionRegexes:[]},{name:"Solaris",search:checkContains("sunos"),versionRegexes:[]},{name:"FreeBSD",search:checkContains("freebsd"),versionRegexes:[]},{name:"ChromeOS",search:checkContains("cros"),versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/]}],PlatformInfo={browsers:constant(browsers),oses:constant(oses)},PlatformDetection_detect=function(userAgent,mediaMatch){var browsers=PlatformInfo.browsers(),oses=PlatformInfo.oses(),browser=UaString_detectBrowser(browsers,userAgent).fold(Browser.unknown,Browser.nu),os=UaString_detectOs(oses,userAgent).fold(OperatingSystem.unknown,OperatingSystem.nu),deviceType=function(os,browser,userAgent,mediaMatch){var isiPad=os.isiOS()&&!0===/ipad/i.test(userAgent),isiPhone=os.isiOS()&&!isiPad,isMobile=os.isiOS()||os.isAndroid(),isTouch=isMobile||mediaMatch("(pointer:coarse)"),isTablet=isiPad||!isiPhone&&isMobile&&mediaMatch("(min-device-width:768px)"),isPhone=isiPhone||isMobile&&!isTablet,iOSwebview=browser.isSafari()&&os.isiOS()&&!1===/safari/i.test(userAgent),isDesktop=!isPhone&&!isTablet&&!iOSwebview;return{isiPad:constant(isiPad),isiPhone:constant(isiPhone),isTablet:constant(isTablet),isPhone:constant(isPhone),isTouch:constant(isTouch),isAndroid:os.isAndroid,isiOS:os.isiOS,isWebView:constant(iOSwebview),isDesktop:constant(isDesktop)}}(os,browser,userAgent,mediaMatch);return{browser:browser,os:os,deviceType:deviceType}},platform=Cell(PlatformDetection_detect(domGlobals.navigator.userAgent,function(query){return domGlobals.window.matchMedia(query).matches})),DOCUMENT=(domGlobals.Node.ATTRIBUTE_NODE,domGlobals.Node.CDATA_SECTION_NODE,domGlobals.Node.COMMENT_NODE,domGlobals.Node.DOCUMENT_NODE),ELEMENT=(domGlobals.Node.DOCUMENT_TYPE_NODE,domGlobals.Node.DOCUMENT_FRAGMENT_NODE,domGlobals.Node.ELEMENT_NODE),TEXT=domGlobals.Node.TEXT_NODE,ELEMENT$1=(domGlobals.Node.PROCESSING_INSTRUCTION_NODE,domGlobals.Node.ENTITY_REFERENCE_NODE,domGlobals.Node.ENTITY_NODE,domGlobals.Node.NOTATION_NODE,ELEMENT),DOCUMENT$1=DOCUMENT,contains$2=detect$3().browser.isIE()?function(e1,e2){return Node_documentPositionContainedBy(e1.dom(),e2.dom())}:function(e1,e2){var d1=e1.dom(),d2=e2.dom();return d1!==d2&&d1.contains(d2)},closest=function(scope,transform,isRoot){return transform(scope).orThunk(function(){return isRoot(scope)?Option.none():ancestor(scope,transform,isRoot)})},touchstart=constant("touchstart"),touchmove=constant("touchmove"),touchend=constant("touchend"),touchcancel=constant("touchcancel"),mousedown=constant("mousedown"),mousemove=constant("mousemove"),mouseout=constant("mouseout"),mouseup=constant("mouseup"),mouseover=constant("mouseover"),focusin=constant("focusin"),focusout=constant("focusout"),keydown=constant("keydown"),keyup=constant("keyup"),input=constant("input"),change=constant("change"),click=constant("click"),transitionend=constant("transitionend"),selectstart=constant("selectstart"),alloy={tap:constant("alloy.tap")},focus=constant("alloy.focus"),postBlur=constant("alloy.blur.post"),postPaste=constant("alloy.paste.post"),receive=constant("alloy.receive"),execute=constant("alloy.execute"),focusItem=constant("alloy.focus.item"),tap=alloy.tap,longpress=constant("alloy.longpress"),sandboxClose=constant("alloy.sandbox.close"),typeaheadCancel=constant("alloy.typeahead.cancel"),systemInit=constant("alloy.system.init"),documentTouchmove=constant("alloy.system.touchmove"),documentTouchend=constant("alloy.system.touchend"),windowScroll=constant("alloy.system.scroll"),windowResize=constant("alloy.system.resize"),attachedToDom=constant("alloy.system.attached"),detachedFromDom=constant("alloy.system.detached"),dismissRequested=constant("alloy.system.dismissRequested"),repositionRequested=constant("alloy.system.repositionRequested"),focusShifted=constant("alloy.focusmanager.shifted"),slotVisibility=constant("alloy.slotcontainer.visibility"),changeTab=constant("alloy.change.tab"),dismissTab=constant("alloy.dismiss.tab"),highlight=constant("alloy.highlight"),dehighlight=constant("alloy.dehighlight"),dispatchWith=function(component,target,event,properties){var data=__assign({target:target},properties);component.getSystem().triggerEvent(event,target,map$1(data,constant))},runOnAttached=runOnSourceName(attachedToDom()),runOnDetached=runOnSourceName(detachedFromDom()),runOnInit=runOnSourceName(systemInit()),runOnExecute=function(name){return function(handler){return run(name,handler)}}(execute()),append=(Immutable("element","offset"),function(parent,element){parent.dom().appendChild(element.dom())}),remove=function(element){var dom=element.dom();null!==dom.parentNode&&dom.parentNode.removeChild(dom)},isElement=(void 0!==domGlobals.window?domGlobals.window:Function("return this;")(),isType$1(ELEMENT)),isText=isType$1(TEXT),events=derive([function(name,predicate){return{key:name,value:nu$4({can:predicate})}}(focus(),function(component,simulatedEvent){var originator=simulatedEvent.event().originator(),target=simulatedEvent.event().target();return!function(component,originator,target){return eq(originator,component.element())&&!eq(originator,target)}(component,originator,target)||(domGlobals.console.warn(focus()+" did not get interpreted by the desired target. \nOriginator: "+element(originator)+"\nTarget: "+element(target)+"\nCheck the "+focus()+" event handlers"),!1)})]),DefaultEvents=Object.freeze({__proto__:null,events:events}),unique=0,prefix=constant("alloy-id-"),idAttr=constant("data-alloy-id"),prefix$1=prefix(),idAttr$1=idAttr(),writeOnly=function(elem,uid){Object.defineProperty(elem.dom(),idAttr$1,{value:uid,writable:!0})},read$1=function(elem){var id=isElement(elem)?elem.dom()[idAttr$1]:null;return Option.from(id)},make=identity,singleton=NoContextApi(),cleanParameters=function(parameters){return map(parameters,function(p){return function(str,suffix){return function(str,substr,start){return""===substr||!(str.length<substr.length)&&str.substr(start,start+substr.length)===substr}(str,suffix,str.length-suffix.length)}(p,"/*")?p.substring(0,p.length-"/*".length):p})},premadeTag=generate$1("alloy-premade"),NoState={init:function(){return nu$5({readState:function(){return"No State required"}})}},nu$5=function(spec){return spec},curryArgs=function(descHandler,extraArgs){return function(handler,purpose){return{cHandler:handler,purpose:constant(purpose)}}(curry.apply(void 0,[descHandler.handler].concat(extraArgs)),descHandler.purpose())},combineGroups=function(byEventName,eventOrder){var r=mapToArray(byEventName,function(tuples,eventName){return(1===tuples.length?Result.value(tuples[0].handler()):fuse$1(tuples,eventOrder,eventName)).map(function(handler){var assembled=assemble(handler),purpose=1<tuples.length?filter(eventOrder[eventName],function(o){return exists(tuples,function(t){return t.name()===o})}).join(" > "):tuples[0].name();return wrap$1(eventName,function(handler,purpose){return{handler:handler,purpose:constant(purpose)}}(assembled,purpose))})});return consolidate(r,{})},body=cached(function(){return getBody(Element.fromDom(domGlobals.document))}),getBody=function(doc){var b=doc.dom().body;if(null==b)throw new Error("Body is not available yet");return Element.fromDom(b)},getUnsafeProperty=function(dom,property){return isSupported(dom)?dom.style.getPropertyValue(property):""},external=function(spec){var extSpec=asRawOrDie("external.component",objOfOnly([strict$1("element"),option("uid")]),spec),systemApi=Cell(NoContextApi());extSpec.uid.each(function(uid){writeOnly(extSpec.element,uid)});var me={getSystem:systemApi.get,config:Option.none,hasConfigured:constant(!1),connect:function(newApi){systemApi.set(newApi)},disconnect:function(){systemApi.set(NoContextApi(function(){return me}))},getApis:function(){return{}},element:constant(extSpec.element),spec:constant(spec),readState:constant("No state"),syncComponents:noop,components:constant([]),events:constant({})};return premade(me)},uids=generate$2,build$1=function(spec){return function(spec){return get(spec,premadeTag)}(spec).fold(function(){var userSpecWithUid=spec.hasOwnProperty("uid")?spec:__assign({uid:uids("")},spec);return buildFromSpec(userSpecWithUid).getOrDie()},function(prebuilt){return prebuilt})},premade$1=premade;function Dimension(name,getOffset){function get(element){var r=getOffset(element);if(r<=0||null===r){var css=get$4(element,name);return parseFloat(css)||0}return r}function aggregate(element,properties){return foldl(properties,function(acc,property){var val=get$4(element,property),value=void 0===val?0:parseInt(val,10);return isNaN(value)?acc:acc+value},0)}return{set:function(element,h){if(!isNumber(h)&&!h.match(/^[0-9]+$/))throw new Error(name+".set accepts only positive integer values. Value was "+h);var dom=element.dom();isSupported(dom)&&(dom.style[name]=h+"px")},get:get,getOuter:get,aggregate:aggregate,max:function(element,value,properties){var cumulativeInclusions=aggregate(element,properties);return cumulativeInclusions<value?value-cumulativeInclusions:0}}}function get$6(element){return api.get(element)}function getOuter$1(element){return api.getOuter(element)}function firstDefinedOrZero(a,b){return void 0!==a?a:void 0!==b?b:0}function absolute(element){var doc=element.dom().ownerDocument,body=doc.body,win=doc.defaultView,html=doc.documentElement;if(body===element.dom())return Position(body.offsetLeft,body.offsetTop);var scrollTop=firstDefinedOrZero(win.pageYOffset,html.scrollTop),scrollLeft=firstDefinedOrZero(win.pageXOffset,html.scrollLeft),clientTop=firstDefinedOrZero(html.clientTop,body.clientTop),clientLeft=firstDefinedOrZero(html.clientLeft,body.clientLeft);return viewport(element).translate(scrollLeft-clientLeft,scrollTop-clientTop)}function get$7(element){return api$1.get(element)}function getOuter$2(element){return api$1.getOuter(element)}function fromRawEvent(rawEvent){function stop(){rawEvent.stopPropagation()}function prevent(){rawEvent.preventDefault()}var target=Element.fromDom(rawEvent.target),kill=compose(prevent,stop);return function(target,x,y,stop,prevent,kill,raw){return{target:constant(target),x:constant(x),y:constant(y),stop:stop,prevent:prevent,kill:kill,raw:constant(raw)}}(target,rawEvent.clientX,rawEvent.clientY,stop,prevent,kill,rawEvent)}function binder(element,event,filter,handler,useCapture){var wrapped=function(filter,handler){return function(rawEvent){filter(rawEvent)&&handler(fromRawEvent(rawEvent))}}(filter,handler);return element.dom().addEventListener(event,wrapped,useCapture),{unbind:curry(unbind,element,event,wrapped,useCapture)}}function get$8(_DOC){var doc=void 0!==_DOC?_DOC.dom():domGlobals.document,x=doc.body.scrollLeft||doc.documentElement.scrollLeft,y=doc.body.scrollTop||doc.documentElement.scrollTop;return Position(x,y)}function to(x,y,_DOC){(void 0!==_DOC?_DOC.dom():domGlobals.document).defaultView.scrollTo(x,y)}function bounds(x,y,width,height){return{x:constant(x),y:constant(y),width:constant(width),height:constant(height),right:constant(x+width),bottom:constant(y+height)}}function getBounds(_win){var win=void 0===_win?domGlobals.window:_win,doc=win.document,scroll=get$8(Element.fromDom(doc));return function(_win){var win=void 0===_win?domGlobals.window:_win;return Option.from(win.visualViewport)}(win).fold(function(){var html=win.document.documentElement,width=html.clientWidth,height=html.clientHeight;return bounds(scroll.left(),scroll.top(),width,height)},function(visualViewport){return bounds(Math.max(visualViewport.pageLeft,scroll.left()),Math.max(visualViewport.pageTop,scroll.top()),visualViewport.width,visualViewport.height)})}function find$3(element){var doc=Element.fromDom(domGlobals.document),scroll=get$8(doc);return function(element,navigation){var d=navigation.owner(element),paths=walkUp(navigation,d);return Option.some(paths)}(element,Navigation).fold(curry(absolute,element),function(frames){var offset=viewport(element),r=foldr(frames,function(b,a){var loc=viewport(a);return{left:b.left+loc.left(),top:b.top+loc.top()}},{left:0,top:0});return Position(r.left+offset.left()+scroll.left(),r.top+offset.top()+scroll.top())})}function bounds$1(x,y,width,height){return{x:constant(x),y:constant(y),width:constant(width),height:constant(height),right:constant(x+width),bottom:constant(y+height)}}function box(element){var xy=absolute(element),w=getOuter$2(element),h=getOuter$1(element);return bounds$1(xy.left(),xy.top(),w,h)}function absolute$1(element){var position=find$3(element),width=getOuter$2(element),height=getOuter$1(element);return bounds$1(position.left(),position.top(),width,height)}function win(){return getBounds(domGlobals.window)}var api=Dimension("height",function(element){var dom=element.dom();return inBody(element)?dom.getBoundingClientRect().height:dom.offsetHeight}),r=function(left,top){return{left:constant(left),top:constant(top),translate:function(x,y){return r(left+x,top+y)}}},Position=r,viewport=function(element){var dom=element.dom(),body=dom.ownerDocument.body;return body===dom?Position(body.offsetLeft,body.offsetTop):inBody(element)?function(dom){var box=dom.getBoundingClientRect();return Position(box.left,box.top)}(dom):Position(0,0)},api$1=Dimension("width",function(element){return element.dom().offsetWidth}),unbind=function(element,event,handler,useCapture){element.dom().removeEventListener(event,handler,useCapture)},walkUp=(detect$3().browser.isSafari(),function(navigation,doc){return navigation.view(doc).fold(constant([]),function(f){var parent=navigation.owner(f),rest=walkUp(navigation,parent);return[f].concat(rest)})}),Navigation=Object.freeze({__proto__:null,view:function(doc){return(doc.dom()===domGlobals.document?Option.none():Option.from(doc.dom().defaultView.frameElement)).map(Element.fromDom)},owner:function(element){return owner(element)}}),pointed=Immutable("point","width","height"),rect=Immutable("x","y","width","height");function ClosestOrAncestor(is,ancestor,scope,a,isRoot){return is(scope,a)?Option.some(scope):isFunction(isRoot)&&isRoot(scope)?Option.none():ancestor(scope,a,isRoot)}function ancestor$1(scope,predicate,isRoot){for(var element=scope.dom(),stop=isFunction(isRoot)?isRoot:constant(!1);element.parentNode;){element=element.parentNode;var el=Element.fromDom(element);if(predicate(el))return Option.some(el);if(stop(el))break}return Option.none()}function closest$1(scope,predicate,isRoot){return ClosestOrAncestor(function(s,test){return test(s)},ancestor$1,scope,predicate,isRoot)}function closest$2(scope,predicate,isRoot){return closest$1(scope,predicate,isRoot).isSome()}function ancestor$2(scope,selector,isRoot){return ancestor$1(scope,function(e){return is(e,selector)},isRoot)}function descendant$1(scope,selector){return function(selector,scope){var base=void 0===scope?domGlobals.document:scope.dom();return bypassSelector(base)?Option.none():Option.from(base.querySelector(selector)).map(Element.fromDom)}(selector,scope)}function closest$3(scope,selector,isRoot){return ClosestOrAncestor(is,ancestor$2,scope,selector,isRoot)}function manager(){var ariaId=generate$1("aria-owns");return{id:constant(ariaId),link:function(elem){set$1(elem,"aria-owns",ariaId)},unlink:function(elem){remove$1(elem,"aria-owns")}}}function isAriaPartOf(component,queryElem){return function(queryElem){return closest$1(queryElem,function(elem){if(!isElement(elem))return!1;var id=get$2(elem,"id");return void 0!==id&&-1<id.indexOf("aria-owns")}).bind(function(dep){var id=get$2(dep,"id"),doc=owner(dep);return descendant$1(doc,'[aria-owns="'+id+'"]')})}(queryElem).exists(function(owner){return isPartOf(component,owner)})}var EventConfiguration,isPartOf=function(component,queryElem){return closest$2(queryElem,function(el){return eq(el,component.element())},constant(!1))||isAriaPartOf(component,queryElem)};!function(EventConfiguration){EventConfiguration[EventConfiguration.STOP=0]="STOP",EventConfiguration[EventConfiguration.NORMAL=1]="NORMAL",EventConfiguration[EventConfiguration.LOGGING=2]="LOGGING"}(EventConfiguration=EventConfiguration||{});function processEvent(eventName,initialTarget,f){switch(get(eventConfig.get(),eventName).orThunk(function(){var patterns=keys(eventConfig.get());return findMap(patterns,function(p){return-1<eventName.indexOf(p)?Option.some(eventConfig.get()[p]):Option.none()})}).getOr(EventConfiguration.NORMAL)){case EventConfiguration.NORMAL:return f(noLogger());case EventConfiguration.LOGGING:var logger=function(eventName,initialTarget){var sequence=[],startTime=(new Date).getTime();return{logEventCut:function(name,target,purpose){sequence.push({outcome:"cut",target:target,purpose:purpose})},logEventStopped:function(name,target,purpose){sequence.push({outcome:"stopped",target:target,purpose:purpose})},logNoParent:function(name,target,purpose){sequence.push({outcome:"no-parent",target:target,purpose:purpose})},logEventNoHandlers:function(name,target){sequence.push({outcome:"no-handlers-left",target:target})},logEventResponse:function(name,target,purpose){sequence.push({outcome:"response",purpose:purpose,target:target})},write:function(){var finishTime=(new Date).getTime();contains(["mousemove","mouseover","mouseout",systemInit()],eventName)||domGlobals.console.log(eventName,{event:eventName,time:finishTime-startTime,target:initialTarget.dom(),sequence:map(sequence,function(s){return contains(["cut","stopped","response"],s.outcome)?"{"+s.purpose+"} "+s.outcome+" at ("+element(s.target)+")":s.outcome})})}}}(eventName,initialTarget),output=f(logger);return logger.write(),output;case EventConfiguration.STOP:return!0}}function monitorEvent(eventName,initialTarget,f){return processEvent(eventName,initialTarget,f)}function tieredMenuMarkers(){return strictObjOf("markers",[strict$1("backgroundMenu")].concat(menuFields()).concat(itemFields()))}function markers(required){return strictObjOf("markers",map(required,strict$1))}function onPresenceHandler(label,fieldName,presence){return function(){var err=new Error;if(void 0===err.stack)return;var lines=err.stack.split("\n");find(lines,function(line){return 0<line.indexOf("alloy")&&!exists(path,function(p){return-1<line.indexOf(p)})}).getOr("unknown")}(),field(fieldName,fieldName,presence,valueOf(function(f){return Result.value(function(){for(var args=[],_i=0;_i<arguments.length;_i++)args[_i]=arguments[_i];return f.apply(void 0,args)})}))}function onHandler(fieldName){return onPresenceHandler(0,fieldName,defaulted(noop))}function onKeyboardHandler(fieldName){return onPresenceHandler(0,fieldName,defaulted(Option.none))}function onStrictHandler(fieldName){return onPresenceHandler(0,fieldName,strict())}function onStrictKeyboardHandler(fieldName){return onPresenceHandler(0,fieldName,strict())}function output(name,value){return state$1(name,constant(value))}function snapshot(name){return state$1(name,identity)}function boundsRestriction(anchor,restrictions){return function(xs,f){for(var r={},i=0,len=xs.length;i<len;i++){var x=xs[i];r[String(x)]=f(x,i)}return r}(["left","right","top","bottom"],function(dir){return get(restrictions,dir).map(function(restriction){return function(anchor,restriction){switch(restriction){case 1:return anchor.x();case 0:return anchor.x()+anchor.width();case 2:return anchor.y();case 3:return anchor.y()+anchor.height()}}(anchor,restriction)})})}function adjustBounds(bounds,boundsRestrictions,bubbleOffsets){function applyRestriction(dir,current){var bubbleOffset="top"===dir||"bottom"===dir?bubbleOffsets.top():bubbleOffsets.left();return get(boundsRestrictions,dir).bind(identity).bind(function(restriction){return"left"===dir||"top"===dir?current<=restriction?Option.some(restriction):Option.none():restriction<=current?Option.some(restriction):Option.none()}).map(function(restriction){return restriction+bubbleOffset}).getOr(current)}var adjustedLeft=applyRestriction("left",bounds.x()),adjustedTop=applyRestriction("top",bounds.y()),adjustedRight=applyRestriction("right",bounds.right()),adjustedBottom=applyRestriction("bottom",bounds.bottom());return bounds$1(adjustedLeft,adjustedTop,adjustedRight-adjustedLeft,adjustedBottom-adjustedTop)}function eastX(anchor){return anchor.x()}function middleX(anchor,element){return anchor.x()+anchor.width()/2-element.width()/2}function westX(anchor,element){return anchor.x()+anchor.width()-element.width()}function northY(anchor,element){return anchor.y()-element.height()}function southY(anchor){return anchor.y()+anchor.height()}function centreY(anchor,element){return anchor.y()+anchor.height()/2-element.height()/2}function southeast$1(anchor,element,bubbles){return nu$7(eastX(anchor),southY(anchor),bubbles.southeast(),southeast(),boundsRestriction(anchor,{left:1,top:3}),"layout-se")}function southwest$1(anchor,element,bubbles){return nu$7(westX(anchor,element),southY(anchor),bubbles.southwest(),southwest(),boundsRestriction(anchor,{right:0,top:3}),"layout-sw")}function northeast$1(anchor,element,bubbles){return nu$7(eastX(anchor),northY(anchor,element),bubbles.northeast(),northeast(),boundsRestriction(anchor,{left:1,bottom:2}),"layout-ne")}function northwest$1(anchor,element,bubbles){return nu$7(westX(anchor,element),northY(anchor,element),bubbles.northwest(),northwest(),boundsRestriction(anchor,{right:0,bottom:2}),"layout-nw")}function east$1(anchor,element,bubbles){return nu$7(function(anchor){return anchor.x()+anchor.width()}(anchor),centreY(anchor,element),bubbles.east(),east(),boundsRestriction(anchor,{left:0}),"layout-e")}function west$1(anchor,element,bubbles){return nu$7(function(anchor,element){return anchor.x()-element.width()}(anchor,element),centreY(anchor,element),bubbles.west(),west(),boundsRestriction(anchor,{right:1}),"layout-w")}function all$2(){return[southeast$1,southwest$1,northeast$1,northwest$1,south$1,north$1,east$1,west$1]}function allRtl(){return[southwest$1,southeast$1,northwest$1,northeast$1,south$1,north$1,east$1,west$1]}function aboveOrBelow(){return[northeast$1,northwest$1,southeast$1,southwest$1,north$1,south$1]}function belowOrAbove(){return[southeast$1,southwest$1,northeast$1,northwest$1,south$1,north$1]}function belowOrAboveRtl(){return[southwest$1,southeast$1,northwest$1,northeast$1,south$1,north$1]}function loadEvent(bConfig,bState,f){return runOnInit(function(component,simulatedEvent){f(component,bConfig,bState)})}function create(schema,name,active,apis,extra,state){var configSchema=objOfOnly(schema),schemaSchema=optionObjOf(name,[function(key,objSchema){return optionOf(key,objOfOnly(objSchema))}("config",schema)]);return doCreate(configSchema,schemaSchema,name,active,apis,extra,state)}function wrapApi(bName,apiFunction,apiName){return function(f,apiName,apiFunction){var delegate=apiFunction.toString(),endIndex=delegate.indexOf(")")+1,openBracketIndex=delegate.indexOf("("),parameters=delegate.substring(openBracketIndex+1,endIndex-1).split(/,\s*/);return f.toFunctionAnnotation=function(){return{name:apiName,parameters:cleanParameters(parameters.slice(0,1).concat(parameters.slice(3)))}},f}(function(component){for(var rest=[],_i=1;_i<arguments.length;_i++)rest[_i-1]=arguments[_i];var args=[component].concat(rest);return component.config({name:constant(bName)}).fold(function(){throw new Error("We could not find any behaviour configuration for: "+bName+". Using API: "+apiName)},function(info){var rest=Array.prototype.slice.call(args,1);return apiFunction.apply(void 0,[component,info.config,info.state].concat(rest))})},apiName,apiFunction)}function revokeBehaviour(name){return{key:name,value:void 0}}function derive$1(capabilities){return wrapAll$1(capabilities)}function create$1(data){var value=asRawOrDie("Creating behaviour: "+data.name,simpleSchema,data);return create(value.fields,value.name,value.active,value.apis,value.extra,value.state)}function createModes$1(data){var value=asRawOrDie("Creating behaviour: "+data.name,modeSchema,data);return function(modes,name,active,apis,extra,state){var configSchema=modes,schemaSchema=optionObjOf(name,[optionOf("config",modes)]);return doCreate(configSchema,schemaSchema,name,active,apis,extra,state)}(choose$1(value.branchKey,value.branches),value.name,value.active,value.apis,value.extra,value.state)}function focus$1(element){element.dom().focus()}function active(_doc){var doc=void 0!==_doc?_doc.dom():domGlobals.document;return Option.from(doc.activeElement).map(Element.fromDom)}function search(element){return active(owner(element)).filter(function(e){return element.dom().contains(e.dom())})}function preserve(f,container){var ownerDoc=owner(container),refocus=active(ownerDoc).bind(function(focused){function hasFocus(elem){return eq(focused,elem)}return hasFocus(container)?Option.some(container):function(scope,predicate){var descend=function(node){for(var i=0;i<node.childNodes.length;i++){var child_1=Element.fromDom(node.childNodes[i]);if(predicate(child_1))return Option.some(child_1);var res=descend(node.childNodes[i]);if(res.isSome())return res}return Option.none()};return descend(scope.dom())}(container,hasFocus)}),result=f(container);return refocus.each(function(oldFocus){active(ownerDoc).filter(function(newFocus){return eq(newFocus,oldFocus)}).fold(function(){focus$1(oldFocus)},noop)}),result}function applyPositionCss(element,position){function addPx(num){return num+"px"}setOptions(element,{position:Option.some(position.position()),left:position.left().map(addPx),top:position.top().map(addPx),right:position.right().map(addPx),bottom:position.bottom().map(addPx)})}function positionWithDirection(posName,decision,x,y,width,height){var decisionX=decision.x()-x,decisionY=decision.y()-y,decisionRight=width-(decisionX+decision.width()),decisionBottom=height-(decisionY+decision.height()),left=Option.some(decisionX),top=Option.some(decisionY),right=Option.some(decisionRight),bottom=Option.some(decisionBottom),none=Option.none();return function(subject,southeast,southwest,northeast,northwest,south,north,east,west){return subject.fold(southeast,southwest,northeast,northwest,south,north,east,west)}(decision.direction(),function(){return NuPositionCss(posName,left,top,none,none)},function(){return NuPositionCss(posName,none,top,right,none)},function(){return NuPositionCss(posName,left,none,none,bottom)},function(){return NuPositionCss(posName,none,none,right,bottom)},function(){return NuPositionCss(posName,left,top,none,none)},function(){return NuPositionCss(posName,left,none,none,bottom)},function(){return NuPositionCss(posName,left,top,none,none)},function(){return NuPositionCss(posName,none,top,right,none)})}function toBox(origin,element){var rel=curry(find$3,element),position=origin.fold(rel,rel,function(){var scroll=get$8();return find$3(element).translate(-scroll.left(),-scroll.top())}),width=getOuter$2(element),height=getOuter$1(element);return bounds$1(position.left(),position.top(),width,height)}function box$1(anchorBox,origin){return anchor(anchorBox,origin)}function cycleBy(value,delta,min,max){var r=value+delta;return max<r?min:r<min?max:r}function clamp(value,min,max){return Math.min(Math.max(value,min),max)}function attempt(candidate,width,height,bounds){var candidateX=candidate.x(),candidateY=candidate.y(),bubbleOffsets=candidate.bubble().offset(),bubbleLeft=bubbleOffsets.left(),bubbleTop=bubbleOffsets.top(),adjustedBounds=adjustBounds(bounds,candidate.boundsRestriction(),bubbleOffsets),boundsY=adjustedBounds.y(),boundsBottom=adjustedBounds.bottom(),boundsX=adjustedBounds.x(),boundsRight=adjustedBounds.right(),newY=candidateY+bubbleTop,_a=function(newX,newY,width,height,bounds){var boundsX=bounds.x(),boundsY=bounds.y(),boundsWidth=bounds.width(),boundsHeight=bounds.height(),xInBounds=boundsX<=newX,yInBounds=boundsY<=newY,originInBounds=xInBounds&&yInBounds,sizeInBounds=newX+width<=boundsX+boundsWidth&&newY+height<=boundsY+boundsHeight,deltaW=Math.abs(Math.min(width,xInBounds?boundsX+boundsWidth-newX:boundsX-(newX+width))),deltaH=Math.abs(Math.min(height,yInBounds?boundsY+boundsHeight-newY:boundsY-(newY+height))),maxX=Math.max(bounds.x(),bounds.right()-width),maxY=Math.max(bounds.y(),bounds.bottom()-height);return{originInBounds:originInBounds,sizeInBounds:sizeInBounds,limitX:clamp(newX,bounds.x(),maxX),limitY:clamp(newY,bounds.y(),maxY),deltaW:deltaW,deltaH:deltaH}}(candidateX+bubbleLeft,newY,width,height,adjustedBounds),originInBounds=_a.originInBounds,sizeInBounds=_a.sizeInBounds,limitX=_a.limitX,limitY=_a.limitY,deltaW=_a.deltaW,deltaH=_a.deltaH,upAvailable=constant(limitY+deltaH-boundsY),downAvailable=constant(boundsBottom-limitY),maxHeight=function(subject,south,middle,north){return subject.fold(south,south,north,north,south,north,middle,middle)}(candidate.direction(),downAvailable,downAvailable,upAvailable),westAvailable=constant(limitX+deltaW-boundsX),eastAvailable=constant(boundsRight-limitX),maxWidth=function(subject,east,middle,west){return subject.fold(east,west,east,west,middle,middle,east,west)}(candidate.direction(),eastAvailable,eastAvailable,westAvailable),reposition=decision({x:limitX,y:limitY,width:deltaW,height:deltaH,maxHeight:maxHeight,maxWidth:maxWidth,direction:candidate.direction(),classes:{on:candidate.bubble().classesOn(),off:candidate.bubble().classesOff()},label:candidate.label(),candidateYforTest:newY});return originInBounds&&sizeInBounds?adt$4.fit(reposition):adt$4.nofit(reposition,deltaW,deltaH)}function attempts(candidates,anchorBox,elementBox,bubbles,bounds){function attemptBestFit(layout,reposition,deltaW,deltaH){var next=layout(anchorBox,elementBox,bubbles);return attempt(next,panelWidth,panelHeight,bounds).fold(adt$4.fit,function(newReposition,newDeltaW,newDeltaH){return deltaH<newDeltaH||deltaW<newDeltaW?adt$4.nofit(newReposition,newDeltaW,newDeltaH):adt$4.nofit(reposition,deltaW,deltaH)})}var panelWidth=elementBox.width(),panelHeight=elementBox.height();return foldl(candidates,function(b,a){var bestNext=curry(attemptBestFit,a);return b.fold(adt$4.fit,bestNext)},adt$4.nofit(decision({x:anchorBox.x(),y:anchorBox.y(),width:elementBox.width(),height:elementBox.height(),maxHeight:elementBox.height(),maxWidth:elementBox.width(),direction:southeast(),classes:{on:[],off:[]},label:"none",candidateYforTest:anchorBox.y()}),-1,-1)).fold(identity,identity)}function layout(anchorBox,element,bubbles,options){remove$6(element,"max-height"),remove$6(element,"max-width");var elementBox=function(p){return{width:constant(getOuter$2(p)),height:constant(getOuter$1(p))}}(element);return attempts(options.preference(),anchorBox,elementBox,bubbles,options.bounds())}function position(element,decision,options){applyPositionCss(element,function(origin,decision){return origin.fold(function(){return NuPositionCss("absolute",Option.some(decision.x()),Option.some(decision.y()),Option.none(),Option.none())},function(x,y,width,height){return positionWithDirection("absolute",decision,x,y,width,height)},function(x,y,width,height){return positionWithDirection("fixed",decision,x,y,width,height)})}(options.origin(),decision))}function setMaxHeight(element,maxHeight){!function(element,value){var absMax=api.max(element,value,["margin-top","border-top-width","padding-top","padding-bottom","border-bottom-width","margin-bottom"]);set$2(element,"max-height",absMax+"px")}(element,Math.floor(maxHeight))}function defaultOr(options,key,dephault){return void 0===options[key]?dephault:options[key]}function simple(anchor,element,bubble,layouts,getBounds,overrideOptions){var maxHeightFunction=defaultOr(overrideOptions,"maxHeightFunction",anchored()),maxWidthFunction=defaultOr(overrideOptions,"maxWidthFunction",noop),anchorBox=anchor.anchorBox(),origin=anchor.origin(),options=reparteeOptions({bounds:function(origin,getBounds){return getBounds.fold(function(){return origin.fold(win,win,bounds$1)},function(b){return origin.fold(b,b,function(){var bounds=b(),pos=translate(origin,bounds.x(),bounds.y());return bounds$1(pos.left(),pos.top(),bounds.width(),bounds.height())})})}(origin,getBounds),origin:origin,preference:layouts,maxHeightFunction:maxHeightFunction,maxWidthFunction:maxWidthFunction});go(anchorBox,element,bubble,options)}function nu$8(width,yoffset,classes){function getClasses(prop){return get(classes,prop).getOr([])}function make(xDelta,yDelta,alignmentsOn){var alignmentsOff=difference(allAlignments,alignmentsOn);return{offset:function(){return Position(xDelta,yDelta)},classesOn:function(){return bind(alignmentsOn,getClasses)},classesOff:function(){return bind(alignmentsOff,getClasses)}}}return{southeast:function(){return make(-width,yoffset,["top","alignLeft"])},southwest:function(){return make(width,yoffset,["top","alignRight"])},south:function(){return make(-width/2,yoffset,["top","alignCentre"])},northeast:function(){return make(-width,-yoffset,["bottom","alignLeft"])},northwest:function(){return make(width,-yoffset,["bottom","alignRight"])},north:function(){return make(-width/2,-yoffset,["bottom","alignCentre"])},east:function(){return make(width,-yoffset/2,["valignCentre","left"])},west:function(){return make(-width,-yoffset/2,["valignCentre","right"])},innerNorthwest:function(){return make(-width,yoffset,["top","alignRight"])},innerNortheast:function(){return make(width,yoffset,["top","alignLeft"])},innerNorth:function(){return make(-width/2,yoffset,["top","alignCentre"])},innerSouthwest:function(){return make(-width,-yoffset,["bottom","alignRight"])},innerSoutheast:function(){return make(width,-yoffset,["bottom","alignLeft"])},innerSouth:function(){return make(-width/2,-yoffset,["bottom","alignCentre"])},innerWest:function(){return make(width,-yoffset/2,["valignCentre","right"])},innerEast:function(){return make(-width,-yoffset/2,["valignCentre","left"])}}}function fallback(){return nu$8(0,0,{})}function nu$9(x){return x}function onDirection(isLtr,isRtl){return function(element){return"rtl"===getDirection(element)?isRtl:isLtr}}var AttributeValue,eventConfig=Cell({}),path=["alloy/data/Fields","alloy/debugging/Debugging"],noLogger=constant({logEventCut:noop,logEventStopped:noop,logNoParent:noop,logEventNoHandlers:noop,logEventResponse:noop,write:noop}),menuFields=constant([strict$1("menu"),strict$1("selectedMenu")]),itemFields=constant([strict$1("item"),strict$1("selectedItem")]),itemSchema=(constant(objOf(itemFields().concat(menuFields()))),constant(objOf(itemFields()))),_initSize=strictObjOf("initSize",[strict$1("numColumns"),strict$1("numRows")]),initSize=constant(_initSize),nu$7=Immutable("x","y","bubble","direction","boundsRestriction","label"),adt$2=Adt_generate([{southeast:[]},{southwest:[]},{northeast:[]},{northwest:[]},{south:[]},{north:[]},{east:[]},{west:[]}]),southeast=adt$2.southeast,southwest=adt$2.southwest,northeast=adt$2.northeast,northwest=adt$2.northwest,south=adt$2.south,north=adt$2.north,east=adt$2.east,west=adt$2.west,north$1=function(anchor,element,bubbles){return nu$7(middleX(anchor,element),northY(anchor,element),bubbles.north(),north(),boundsRestriction(anchor,{bottom:2}),"layout-n")},south$1=function(anchor,element,bubbles){return nu$7(middleX(anchor,element),southY(anchor),bubbles.south(),south(),boundsRestriction(anchor,{top:3}),"layout-s")},doCreate=function(configSchema,schemaSchema,name,active,apis,extra,state){function getConfig(info){return hasNonNullableKey(info,name)?info[name]():Option.none()}var wrappedApis=map$1(apis,function(apiF,apiName){return wrapApi(name,apiF,apiName)}),wrappedExtra=map$1(extra,function(extraF,extraName){return markAsExtraApi(extraF,extraName)}),me=__assign(__assign(__assign({},wrappedExtra),wrappedApis),{revoke:curry(revokeBehaviour,name),config:function(spec){var prepared=asRawOrDie(name+"-config",configSchema,spec);return{key:name,value:{config:prepared,me:me,configAsRaw:cached(function(){return asRawOrDie(name+"-config",configSchema,spec)}),initialConfig:spec,state:state}}},schema:function(){return schemaSchema},exhibit:function(info,base){return getConfig(info).bind(function(behaviourInfo){return get(active,"exhibit").map(function(exhibitor){return exhibitor(base,behaviourInfo.config,behaviourInfo.state)})}).getOr(nu$6({}))},name:function(){return name},handlers:function(info){return getConfig(info).map(function(behaviourInfo){return get(active,"events").getOr(function(){return{}})(behaviourInfo.config,behaviourInfo.state)}).getOr({})}});return me},simpleSchema=objOfOnly([strict$1("fields"),strict$1("name"),defaulted$1("active",{}),defaulted$1("apis",{}),defaulted$1("state",NoState),defaulted$1("extra",{})]),modeSchema=objOfOnly([strict$1("branchKey"),strict$1("branches"),strict$1("name"),defaulted$1("active",{}),defaulted$1("apis",{}),defaulted$1("state",NoState),defaulted$1("extra",{})]),revoke=constant(void 0),ActiveReceiving=Object.freeze({__proto__:null,events:function(receiveConfig){return derive([run(receive(),function(component,message){var channelMap=receiveConfig.channels,channels=keys(channelMap),receivingData=message,targetChannels=function(channels,message){return message.universal()?channels:filter(channels,function(ch){return contains(message.channels(),ch)})}(channels,receivingData);each(targetChannels,function(ch){var channelInfo=channelMap[ch],channelSchema=channelInfo.schema,data=asRawOrDie("channel["+ch+"] data\nReceiver: "+element(component.element()),channelSchema,receivingData.data());channelInfo.onReceive(component,data)})})])}}),ReceivingSchema=[strictOf("channels",setOf$1(Result.value,objOfOnly([onStrictHandler("onReceive"),defaulted$1("schema",anyValue$1())])))],Receiving=create$1({fields:ReceivingSchema,name:"receiving",active:ActiveReceiving}),ActivePosition=Object.freeze({__proto__:null,exhibit:function(base,posConfig){return nu$6({classes:[],styles:posConfig.useFixed()?{}:{position:"relative"}})}}),NuPositionCss=Immutable("position","left","top","right","bottom"),adt$3=Adt_generate([{none:[]},{relative:["x","y","width","height"]},{fixed:["x","y","width","height"]}]),translate=function(origin,x,y){var pos=Position(x,y);return origin.fold(constant(pos),constant(pos),function(){var outerScroll=get$8();return pos.translate(-outerScroll.left(),-outerScroll.top())})},relative=(adt$3.none,adt$3.relative),fixed=adt$3.fixed,anchor=Immutable("anchorBox","origin"),decision=MixedBag(["x","y","width","height","maxHeight","maxWidth","direction","classes","label","candidateYforTest"],[]),adt$4=Adt_generate([{fit:["reposition"]},{nofit:["reposition","deltaW","deltaH"]}]),anchored=constant(function(element,available){setMaxHeight(element,available),setAll$1(element,{"overflow-x":"hidden","overflow-y":"auto"})}),expandable=constant(function(element,available){setMaxHeight(element,available)}),reparteeOptions=MixedBag(["bounds","origin","preference","maxHeightFunction","maxWidthFunction"],[]),go=function(anchorBox,element,bubble,options){var decision=layout(anchorBox,element,bubble,options);position(element,decision,options),function(element,decision){var classInfo=decision.classes();remove$5(element,classInfo.off),add$3(element,classInfo.on)}(element,decision),function(element,decision,options){options.maxHeightFunction()(element,decision.maxHeight())}(element,decision,options),function(element,decision,options){options.maxWidthFunction()(element,decision.maxWidth())}(element,decision,options)},allAlignments=["valignCentre","alignLeft","alignRight","alignCentre","top","bottom","left","right"],getDirection=function(element){return"rtl"===get$4(element,"direction")?"rtl":"ltr"};!function(AttributeValue){AttributeValue.TopToBottom="toptobottom",AttributeValue.BottomToTop="bottomtotop"}(AttributeValue=AttributeValue||{});function isBottomToTopDir(el){return closest$2(el,function(current){return isElement(current)&&get$2(current,Attribute)===AttributeValue.BottomToTop})}function schema$1(){return optionObjOf("layouts",[strict$1("onLtr"),strict$1("onRtl"),option("onBottomLtr"),option("onBottomRtl")])}function get$a(elem,info,defaultLtr,defaultRtl,defaultBottomLtr,defaultBottomRtl,dirElement){var isBottomToTop=dirElement.map(isBottomToTopDir).getOr(!1),customLtr=info.layouts.map(function(ls){return ls.onLtr(elem)}),customRtl=info.layouts.map(function(ls){return ls.onRtl(elem)}),ltr=isBottomToTop?info.layouts.bind(function(ls){return ls.onBottomLtr.map(function(f){return f(elem)})}).or(customLtr).getOr(defaultBottomLtr):customLtr.getOr(defaultLtr),rtl=isBottomToTop?info.layouts.bind(function(ls){return ls.onBottomRtl.map(function(f){return f(elem)})}).or(customRtl).getOr(defaultBottomRtl):customRtl.getOr(defaultRtl);return onDirection(ltr,rtl)(elem)}function relativeToNative(win,startSitu,finishSitu){var range=win.document.createRange();return function(rng,situ){situ.fold(function(e){rng.setStartBefore(e.dom())},function(e,o){rng.setStart(e.dom(),o)},function(e){rng.setStartAfter(e.dom())})}(range,startSitu),function(rng,situ){situ.fold(function(e){rng.setEndBefore(e.dom())},function(e,o){rng.setEnd(e.dom(),o)},function(e){rng.setEndAfter(e.dom())})}(range,finishSitu),range}function exactToNative(win,start,soffset,finish,foffset){var rng=win.document.createRange();return rng.setStart(start.dom(),soffset),rng.setEnd(finish.dom(),foffset),rng}function toRect(rect){return{left:constant(rect.left),top:constant(rect.top),right:constant(rect.right),bottom:constant(rect.bottom),width:constant(rect.width),height:constant(rect.height)}}function fromRange(win,type,range){return type(Element.fromDom(range.startContainer),range.startOffset,Element.fromDom(range.endContainer),range.endOffset)}function diagnose(win,selection){return function(win,ranges){var rng=ranges.ltr();return rng.collapsed?ranges.rtl().filter(function(rev){return!1===rev.collapsed}).map(function(rev){return adt$7.rtl(Element.fromDom(rev.endContainer),rev.endOffset,Element.fromDom(rev.startContainer),rev.startOffset)}).getOrThunk(function(){return fromRange(0,adt$7.ltr,rng)}):fromRange(0,adt$7.ltr,rng)}(0,function(win,selection){return selection.match({domRange:function(rng){return{ltr:constant(rng),rtl:Option.none}},relative:function(startSitu,finishSitu){return{ltr:cached(function(){return relativeToNative(win,startSitu,finishSitu)}),rtl:cached(function(){return Option.some(relativeToNative(win,finishSitu,startSitu))})}},exact:function(start,soffset,finish,foffset){return{ltr:cached(function(){return exactToNative(win,start,soffset,finish,foffset)}),rtl:cached(function(){return Option.some(exactToNative(win,finish,foffset,start,soffset))})}}})}(win,selection))}var Attribute="data-alloy-vertical-dir",HotspotAnchor=[strict$1("hotspot"),option("bubble"),defaulted$1("overrides",{}),schema$1(),output("placement",function(component,anchorInfo,origin){var hotspot=anchorInfo.hotspot,anchorBox=toBox(origin,hotspot.element()),layouts=get$a(component.element(),anchorInfo,belowOrAbove(),belowOrAboveRtl(),aboveOrBelow(),[northwest$1,northeast$1,southwest$1,southeast$1,north$1,south$1],Option.some(anchorInfo.hotspot.element()));return Option.some(nu$9({anchorBox:anchorBox,bubble:anchorInfo.bubble.getOr(fallback()),overrides:anchorInfo.overrides,layouts:layouts,placer:Option.none()}))})],MakeshiftAnchor=[strict$1("x"),strict$1("y"),defaulted$1("height",0),defaulted$1("width",0),defaulted$1("bubble",fallback()),defaulted$1("overrides",{}),schema$1(),output("placement",function(component,anchorInfo,origin){var pos=translate(origin,anchorInfo.x,anchorInfo.y),anchorBox=bounds$1(pos.left(),pos.top(),anchorInfo.width,anchorInfo.height),layouts=get$a(component.element(),anchorInfo,all$2(),allRtl(),all$2(),allRtl(),Option.none());return Option.some(nu$9({anchorBox:anchorBox,bubble:anchorInfo.bubble,overrides:anchorInfo.overrides,layouts:layouts,placer:Option.none()}))})],SimRange={create:Immutable("start","soffset","finish","foffset")},adt$5=Adt_generate([{before:["element"]},{on:["element","offset"]},{after:["element"]}]),Situ_getStart=(adt$5.before,adt$5.on,adt$5.after,function(situ){return situ.fold(identity,identity,identity)}),adt$6=Adt_generate([{domRange:["rng"]},{relative:["startSitu","finishSitu"]},{exact:["start","soffset","finish","foffset"]}]),Selection={domRange:adt$6.domRange,relative:adt$6.relative,exact:adt$6.exact,exactFromRange:function(simRange){return adt$6.exact(simRange.start(),simRange.soffset(),simRange.finish(),simRange.foffset())},getWin:function(selection){var start=function(selection){return selection.match({domRange:function(rng){return Element.fromDom(rng.startContainer)},relative:function(startSitu,finishSitu){return Situ_getStart(startSitu)},exact:function(start,soffset,finish,foffset){return start}})}(selection);return defaultView(start)},range:SimRange.create},adt$7=Adt_generate([{ltr:["start","soffset","finish","foffset"]},{rtl:["start","soffset","finish","foffset"]}]);adt$7.ltr,adt$7.rtl;function getOption(element){return api$2.getOption(element)}function isCursorPosition(elem){return function(el){return getOption(el).filter(function(text){return 0!==text.trim().length||-1<text.indexOf("")}).isSome()}(elem)||contains(elementsWithCursorPosition,name(elem))}function descendants(scope,selector){return all(selector,scope)}function after$2(start,soffset,finish,foffset){var r=function(start,soffset,finish,foffset){var rng=owner(start).dom().createRange();return rng.setStart(start.dom(),soffset),rng.setEnd(finish.dom(),foffset),rng}(start,soffset,finish,foffset),same=eq(start,finish)&&soffset===foffset;return r.collapsed&&!same}function doGetExact(selection){var anchor=Element.fromDom(selection.anchorNode),focus=Element.fromDom(selection.focusNode);return after$2(anchor,selection.anchorOffset,focus,selection.focusOffset)?Option.some(SimRange.create(anchor,selection.anchorOffset,focus,selection.focusOffset)):function(selection){if(0<selection.rangeCount){var firstRng=selection.getRangeAt(0),lastRng=selection.getRangeAt(selection.rangeCount-1);return Option.some(SimRange.create(Element.fromDom(firstRng.startContainer),firstRng.startOffset,Element.fromDom(lastRng.endContainer),lastRng.endOffset))}return Option.none()}(selection)}function getFirstRect$1(win,selection){return function(rng){var rects=rng.getClientRects(),rect=0<rects.length?rects[0]:rng.getBoundingClientRect();return 0<rect.width||0<rect.height?Option.some(rect).map(toRect):Option.none()}(function(win,selection){return diagnose(win,selection).match({ltr:function(start,soffset,finish,foffset){var rng=win.document.createRange();return rng.setStart(start.dom(),soffset),rng.setEnd(finish.dom(),foffset),rng},rtl:function(start,soffset,finish,foffset){var rng=win.document.createRange();return rng.setStart(finish.dom(),foffset),rng.setEnd(start.dom(),soffset),rng}})}(win,selection))}function descendOnce(element,offset){var children$1=children(element);if(0===children$1.length)return point(element,offset);if(offset<children$1.length)return point(children$1[offset],0);var last=children$1[children$1.length-1],len=isText(last)?function(element){return api$2.get(element)}(last).length:children(last).length;return point(last,len)}function toFixed(pos){return pos.fold(identity,function(point,scrollLeft,scrollTop){return point.translate(-scrollLeft,-scrollTop)})}function toAbsolute(pos){return pos.fold(identity,identity)}function sum(points){return foldl(points,function(b,a){return b.translate(a.left(),a.top())},Position(0,0))}function sumAsAbsolute(positions){var points=map(positions,toAbsolute);return sum(points)}function getRootPoint(component,origin,anchorInfo){var doc=owner(component.element()),outerScroll=get$8(doc),offset=function(component,origin,anchorInfo){var win=defaultView(anchorInfo.root).dom();return Option.from(win.frameElement).map(Element.fromDom).filter(function(frame){var frameOwner=owner(frame),compOwner=owner(component.element());return eq(frameOwner,compOwner)}).map(absolute)}(component,0,anchorInfo).getOr(outerScroll);return absolute$2(offset,outerScroll.left(),outerScroll.top())}function descendOnce$1(element,offset){return isText(element)?point$1(element,offset):descendOnce(element,offset)}function getAnchorSelection(win,anchorInfo){return anchorInfo.getSelection.getOrThunk(function(){return function(){return function(win){return Option.from(win.getSelection()).filter(function(sel){return 0<sel.rangeCount}).bind(doGetExact)}(win)}})().map(function(sel){var modStart=descendOnce$1(sel.start(),sel.soffset()),modFinish=descendOnce$1(sel.finish(),sel.foffset());return Selection.range(modStart.element(),modStart.offset(),modFinish.element(),modFinish.offset())})}function eastX$1(anchor){return anchor.x()+anchor.width()}function westX$1(anchor,element){return anchor.x()-element.width()}function northY$1(anchor,element){return anchor.y()-element.height()+anchor.height()}function southY$1(anchor){return anchor.y()}function southeast$2(anchor,element,bubbles){return nu$7(eastX$1(anchor),southY$1(anchor),bubbles.southeast(),southeast(),boundsRestriction(anchor,{left:0,top:2}),"link-layout-se")}function southwest$2(anchor,element,bubbles){return nu$7(westX$1(anchor,element),southY$1(anchor),bubbles.southwest(),southwest(),boundsRestriction(anchor,{right:1,top:2}),"link-layout-sw")}function northeast$2(anchor,element,bubbles){return nu$7(eastX$1(anchor),northY$1(anchor,element),bubbles.northeast(),northeast(),boundsRestriction(anchor,{left:0,bottom:3}),"link-layout-ne")}function northwest$2(anchor,element,bubbles){return nu$7(westX$1(anchor,element),northY$1(anchor,element),bubbles.northwest(),northwest(),boundsRestriction(anchor,{right:1,bottom:3}),"link-layout-nw")}function all$3(){return[southeast$2,southwest$2,northeast$2,northwest$2]}function allRtl$1(){return[southwest$2,southeast$2,northwest$2,northeast$2]}function place(component,origin,anchoring,getBounds,placee){var anchor=box$1(anchoring.anchorBox,origin);simple(anchor,placee.element(),anchoring.bubble,anchoring.layouts,getBounds,anchoring.overrides)}function attach(parent,child){append(parent.element(),child.element())}function replaceChildren(component,newChildren){var subs=component.components();!function(component){each(component.components(),function(childComp){return remove(childComp.element())}),empty(component.element()),component.syncComponents()}(component);var deleted=difference(subs,newChildren);each(deleted,function(comp){fireDetaching(comp),component.getSystem().removeFromWorld(comp)}),each(newChildren,function(childComp){childComp.getSystem().isConnected()?attach(component,childComp):(component.getSystem().addToWorld(childComp),attach(component,childComp),inBody(component.element())&&fireAttaching(childComp)),component.syncComponents()})}function attach$1(parent,child){attachWith(parent,child,append)}function doDetach(component){fireDetaching(component),remove(component.element()),component.getSystem().removeFromWorld(component)}function detach(component){var parent$1=parent(component.element()).bind(function(p){return component.getSystem().getByDom(p).toOption()});doDetach(component),parent$1.each(function(p){p.syncComponents()})}function detachChildren$1(component){var subs=component.components();each(subs,doDetach),empty(component.element()),component.syncComponents()}function attachSystem(element,guiSystem){attachSystemWith(element,guiSystem,append)}function detachSystem(guiSystem){var children$1=children(guiSystem.element());each(children$1,function(child){guiSystem.getByDom(child).each(fireDetaching)}),remove(guiSystem.element())}function rebuild(sandbox,sConfig,sState,data){sState.get().each(function(data){detachChildren$1(sandbox)});var point=sConfig.getAttachPoint(sandbox);attach$1(point,sandbox);var built=sandbox.getSystem().build(data);return attach$1(sandbox,built),sState.set(built),built}function open(sandbox,sConfig,sState,data){var newState=rebuild(sandbox,sConfig,sState,data);return sConfig.onOpen(sandbox,newState),newState}function close(sandbox,sConfig,sState){sState.get().each(function(data){detachChildren$1(sandbox),detach(sandbox),sConfig.onClose(sandbox,data),sState.clear()})}function isOpen(sandbox,sConfig,sState){return sState.isOpen()}function receivingChannel(rawSpec){var _a,detail=asRawOrDie("Dismissal",schema$2,rawSpec);return(_a={})[dismissPopups()]={schema:objOfOnly([strict$1("target")]),onReceive:function(sandbox,data){Sandboxing.isOpen(sandbox)&&(Sandboxing.isPartOf(sandbox,data.target)||detail.isExtraPart(sandbox,data.target)||detail.fireEventInstead.fold(function(){return Sandboxing.close(sandbox)},function(fe){return emit(sandbox,fe.event)}))}},_a}function receivingChannel$1(rawSpec){var _a,detail=asRawOrDie("Reposition",schema$3,rawSpec);return(_a={})[repositionPopups()]={onReceive:function(sandbox){Sandboxing.isOpen(sandbox)&&detail.fireEventInstead.fold(function(){return detail.doReposition(sandbox)},function(fe){return emit(sandbox,fe.event)})}},_a}function onLoad(component,repConfig,repState){repConfig.store.manager.onLoad(component,repConfig,repState)}function onUnload(component,repConfig,repState){repConfig.store.manager.onUnload(component,repConfig,repState)}function memory(){var data=Cell(null);return nu$5({set:data.set,get:data.get,isNotSet:function(){return null===data.get()},clear:function(){data.set(null)},readState:function(){return{mode:"memory",value:data.get()}}})}function dataset(){var dataByValue=Cell({}),dataByText=Cell({});return nu$5({readState:function(){return{mode:"dataset",dataByValue:dataByValue.get(),dataByText:dataByText.get()}},lookup:function(itemString){return get(dataByValue.get(),itemString).orThunk(function(){return get(dataByText.get(),itemString)})},update:function(items){var currentDataByValue=dataByValue.get(),currentDataByText=dataByText.get(),newDataByValue={},newDataByText={};each(items,function(item){newDataByValue[item.value]=item,get(item,"meta").each(function(meta){get(meta,"text").each(function(text){newDataByText[text]=item})})}),dataByValue.set(__assign(__assign({},currentDataByValue),newDataByValue)),dataByText.set(__assign(__assign({},currentDataByText),newDataByText))},clear:function(){dataByValue.set({}),dataByText.set({})}})}function setValue$1(component,repConfig,repState,data){var store=repConfig.store;repState.update([data]),store.setValue(component,data),repConfig.onSetValue(component,data)}function field$1(name,forbidden){return defaultedObjOf(name,{},map(forbidden,function(f){return function(key,message){return field(key,key,asOption(),value$1(function(v){return SimpleResult_serror("The field: "+key+" is forbidden. "+message)}))}(f.name(),"Cannot configure "+f.name()+" for "+name)}).concat([state$1("dump",identity)]))}function get$c(data){return data.dump}function augment(data,original){return __assign(__assign({},data.dump),derive$1(original))}function isSubstituted(spec){return has(spec,"uiType")}function scan(owner,detail,compSpec,placeholders){return isSubstituted(compSpec)&&"placeholder"===compSpec.uiType?function(owner,detail,compSpec,placeholders){return owner.exists(function(o){return o!==compSpec.owner})?adt$9.single(!0,constant(compSpec)):get(placeholders,compSpec.name).fold(function(){throw new Error("Unknown placeholder component: "+compSpec.name+"\nKnown: ["+keys(placeholders)+"]\nNamespace: "+owner.getOr("none")+"\nSpec: "+JSON.stringify(compSpec,null,2))},function(newSpec){return newSpec.replace()})}(owner,0,compSpec,placeholders):adt$9.single(!1,constant(compSpec))}function substitutePlaces(owner,detail,components,placeholders){var ps=map$1(placeholders,function(ph,name){return function(label,replacements){var called=!1;return{name:constant(label),required:function(){return replacements.fold(function(req,_){return req},function(req,_){return req})},used:function(){return called},replace:function(){if(called)throw new Error("Trying to use the same placeholder more than once: "+label);return called=!0,replacements}}}(name,ph)}),outcome=function(owner,detail,components,placeholders){return bind(components,function(c){return substitute(owner,detail,c,placeholders)})}(owner,detail,components,ps);return each$1(ps,function(p){if(!1===p.used()&&p.required())throw new Error("Placeholder: "+p.name()+" was not found in components list\nNamespace: "+owner.getOr("none")+"\nComponents: "+JSON.stringify(detail.components,null,2))}),outcome}function asNamedPart(part){return part.fold(Option.some,Option.none,Option.some,Option.some)}function name$1(part){function get(data){return data.name}return part.fold(get,get,get,get)}function convert(adtConstructor,partSchema){return function(spec){var data=asRawOrDie("Converting part type",partSchema,spec);return adtConstructor(data)}}function combine$2(detail,data,partSpec,partValidated){return deepMerge(data.defaults(detail,partSpec,partValidated),partSpec,{uid:detail.partUids[data.name]},data.overrides(detail,partSpec,partValidated))}function generate$4(owner,parts){var r={};return each(parts,function(part){asNamedPart(part).each(function(np){var g=doGenerateOne(owner,np.pname);r[np.name]=function(config){var validated=asRawOrDie("Part: "+np.name+" in "+owner,objOf(np.schema),config);return __assign(__assign({},g),{config:config,validated:validated})}})}),r}function generateOne(owner,pname,config){return{uiType:placeholder(),owner:owner,name:pname,config:config,validated:{}}}function schemas(parts){return bind(parts,function(part){return part.fold(Option.none,Option.some,Option.none,Option.none).map(function(data){return strictObjOf(data.name,data.schema.concat([snapshot(original())]))}).toArray()})}function names(parts){return map(parts,name$1)}function substitutes(owner,detail,parts){return function(owner,detail,parts){var internals={},externals={};return each(parts,function(part){part.fold(function(data){internals[data.pname]=single(!0,function(detail,partSpec,partValidated){return data.factory.sketch(combine$2(detail,data,partSpec,partValidated))})},function(data){var partSpec=detail.parts[data.name];externals[data.name]=constant(data.factory.sketch(combine$2(detail,data,partSpec[original()]),partSpec))},function(data){internals[data.pname]=single(!1,function(detail,partSpec,partValidated){return data.factory.sketch(combine$2(detail,data,partSpec,partValidated))})},function(data){internals[data.pname]=multiple(!0,function(detail,_partSpec,_partValidated){var units=detail[data.name];return map(units,function(u){return data.factory.sketch(deepMerge(data.defaults(detail,u,_partValidated),u,data.overrides(detail,u)))})})})}),{internals:constant(internals),externals:constant(externals)}}(0,detail,parts)}function components(owner,detail,internals){return substitutePlaces(Option.some(owner),detail,detail.components,internals)}function getPart(component,detail,partKey){var uid=detail.partUids[partKey];return component.getSystem().getByUid(uid).toOption()}function getPartOrDie(component,detail,partKey){return getPart(component,detail,partKey).getOrDie("Could not find part: "+partKey)}function getParts(component,detail,partKeys){var r={},uids=detail.partUids,system=component.getSystem();return each(partKeys,function(pk){r[pk]=constant(system.getByUid(uids[pk]))}),r}function getAllParts(component,detail){var system=component.getSystem();return map$1(detail.partUids,function(pUid,k){return constant(system.getByUid(pUid))})}function getAllPartNames(detail){return keys(detail.partUids)}function getPartsOrDie(component,detail,partKeys){var r={},uids=detail.partUids,system=component.getSystem();return each(partKeys,function(pk){r[pk]=constant(system.getByUid(uids[pk]).getOrDie())}),r}function defaultUids(baseUid,partTypes){var partNames=names(partTypes);return wrapAll$1(map(partNames,function(pn){return{key:pn,value:baseUid+"-"+pn}}))}function defaultUidsSchema(partTypes){return field("partUids","partUids",mergeWithThunk(function(spec){return defaultUids(spec.uid,partTypes)}),anyValue$1())}function asRawOrDie$1(label,schema,spec,partSchemas,partUidsSchemas){var baseS=function(partSchemas,partUidsSchemas){return(0<partSchemas.length?[strictObjOf("parts",partSchemas)]:[]).concat([strict$1("uid"),defaulted$1("dom",{}),defaulted$1("components",[]),snapshot("originalSpec"),defaulted$1("debug.sketcher",{})]).concat(partUidsSchemas)}(partSchemas,partUidsSchemas);return asRawOrDie(label+" [SpecSchema]",objOfOnly(baseS.concat(schema)),spec)}function composite(owner,schema,partTypes,factory,spec){var specWithUid=supplyUid(spec),partSchemas=schemas(partTypes),partUidsSchema=defaultUidsSchema(partTypes),detail=asRawOrDie$1(owner,schema,specWithUid,partSchemas,[partUidsSchema]),subs=substitutes(0,detail,partTypes);return factory(detail,components(owner,detail,subs.internals()),specWithUid,subs.externals())}var api$2=function(is,name){var getOption=function(element){return is(element)?Option.from(element.dom().nodeValue):Option.none()};return{get:function(element){if(!is(element))throw new Error("Can only get "+name+" value of a "+name+" node");return getOption(element).getOr("")},getOption:getOption,set:function(element,value){if(!is(element))throw new Error("Can only set raw "+name+" value of a "+name+" node");element.dom().nodeValue=value}}}(isText,"text"),elementsWithCursorPosition=["img","br"],descendantRtl=function(scope,predicate){var descend=function(element){for(var children$1=children(element),i=children$1.length-1;0<=i;i--){var child=children$1[i];if(predicate(child))return Option.some(child);var res=descend(child);if(res.isSome())return res}return Option.none()};return descend(scope)},point=Immutable("element","offset"),adt$8=Adt_generate([{screen:["point"]},{absolute:["point","scrollLeft","scrollTop"]}]),screen=adt$8.screen,absolute$2=adt$8.absolute,ContentAnchorCommon_capRect=function(left,top,width,height){var newLeft=left,newTop=top,newWidth=width,newHeight=height;left<0&&(newLeft=0,newWidth=width+left),top<0&&(newTop=0,newHeight=height+top);var point=screen(Position(newLeft,newTop));return Option.some(pointed(point,newWidth,newHeight))},ContentAnchorCommon_calcNewAnchor=function(optBox,rootPoint,anchorInfo,origin,elem){return optBox.map(function(box){var points=[rootPoint,box.point()],topLeft=function(subject,onNone,onRelative,onFixed){return subject.fold(onNone,onRelative,onFixed)}(origin,function(){return sumAsAbsolute(points)},function(){return sumAsAbsolute(points)},function(){return function(positions){var points=map(positions,toFixed);return sum(points)}(points)}),anchorBox=rect(topLeft.left(),topLeft.top(),box.width(),box.height()),layoutsLtr=anchorInfo.showAbove?aboveOrBelow():belowOrAbove(),layoutsRtl=(anchorInfo.showAbove,belowOrAboveRtl()),layouts=get$a(elem,anchorInfo,layoutsLtr,layoutsRtl,layoutsLtr,layoutsRtl,Option.none());return nu$9({anchorBox:anchorBox,bubble:anchorInfo.bubble.getOr(fallback()),overrides:anchorInfo.overrides,layouts:layouts,placer:Option.none()})})},point$1=Immutable("element","offset"),SelectionAnchor=[option("getSelection"),strict$1("root"),option("bubble"),schema$1(),defaulted$1("overrides",{}),defaulted$1("showAbove",!1),output("placement",function(component,anchorInfo,origin){var win=defaultView(anchorInfo.root).dom(),rootPoint=getRootPoint(component,0,anchorInfo),selectionBox=getAnchorSelection(win,anchorInfo).bind(function(sel){return getFirstRect$1(win,Selection.exactFromRange(sel)).orThunk(function(){var x=Element.fromText("\ufeff");return before(sel.start(),x),getFirstRect$1(win,Selection.exact(x,0,x,1)).map(function(rect){return remove(x),rect})}).bind(function(rawRect){return ContentAnchorCommon_capRect(rawRect.left(),rawRect.top(),rawRect.width(),rawRect.height())})}),elem=getAnchorSelection(win,anchorInfo).bind(function(sel){return isElement(sel.start())?Option.some(sel.start()):parent(sel.start())}).getOr(component.element());return ContentAnchorCommon_calcNewAnchor(selectionBox,rootPoint,anchorInfo,origin,elem)})],NodeAnchor=[strict$1("node"),strict$1("root"),option("bubble"),schema$1(),defaulted$1("overrides",{}),defaulted$1("showAbove",!1),output("placement",function(component,anchorInfo,origin){var rootPoint=getRootPoint(component,0,anchorInfo);return anchorInfo.node.bind(function(target){var rect=target.dom().getBoundingClientRect(),nodeBox=ContentAnchorCommon_capRect(rect.left,rect.top,rect.width,rect.height),elem=anchorInfo.node.getOr(component.element());return ContentAnchorCommon_calcNewAnchor(nodeBox,rootPoint,anchorInfo,origin,elem)})})],SubmenuAnchor=[strict$1("item"),schema$1(),defaulted$1("overrides",{}),output("placement",function(component,submenuInfo,origin){var anchorBox=toBox(origin,submenuInfo.item.element()),layouts=get$a(component.element(),submenuInfo,all$3(),allRtl$1(),all$3(),allRtl$1(),Option.none());return Option.some(nu$9({anchorBox:anchorBox,bubble:fallback(),overrides:submenuInfo.overrides,layouts:layouts,placer:Option.none()}))})],AnchorSchema=choose$1("anchor",{selection:SelectionAnchor,node:NodeAnchor,hotspot:HotspotAnchor,submenu:SubmenuAnchor,makeshift:MakeshiftAnchor}),positionWithin=function(component,posConfig,posState,anchor,placee,boxElement){var boundsBox=boxElement.map(box);return positionWithinBounds(component,posConfig,posState,anchor,placee,boundsBox)},positionWithinBounds=function(component,posConfig,posState,anchor,placee,bounds){var anchorage=asRawOrDie("positioning anchor.info",AnchorSchema,anchor);preserve(function(){set$2(placee.element(),"position","fixed");var oldVisibility=getRaw(placee.element(),"visibility");set$2(placee.element(),"visibility","hidden");var origin=posConfig.useFixed()?function(){var html=domGlobals.document.documentElement;return fixed(0,0,html.clientWidth,html.clientHeight)}():function(component){var position=absolute(component.element()),bounds=component.element().dom().getBoundingClientRect();return relative(position.left(),position.top(),bounds.width,bounds.height)}(component),placer=anchorage.placement,getBounds=bounds.map(constant).or(posConfig.getBounds);placer(component,anchorage,origin).each(function(anchoring){anchoring.placer.getOr(place)(component,origin,anchoring,getBounds,placee)}),oldVisibility.fold(function(){remove$6(placee.element(),"visibility")},function(vis){set$2(placee.element(),"visibility",vis)}),getRaw(placee.element(),"left").isNone()&&getRaw(placee.element(),"top").isNone()&&getRaw(placee.element(),"right").isNone()&&getRaw(placee.element(),"bottom").isNone()&&getRaw(placee.element(),"position").is("fixed")&&remove$6(placee.element(),"position")},placee.element())},PositionApis=Object.freeze({__proto__:null,position:function(component,posConfig,posState,anchor,placee){positionWithin(component,posConfig,posState,anchor,placee,Option.none())},positionWithin:positionWithin,positionWithinBounds:positionWithinBounds,getMode:function(component,pConfig,pState){return pConfig.useFixed()?"fixed":"absolute"}}),PositionSchema=[defaulted$1("useFixed",never),option("getBounds")],Positioning=create$1({fields:PositionSchema,name:"positioning",active:ActivePosition,apis:PositionApis}),fireDetaching=function(component){emit(component,detachedFromDom());var children=component.components();each(children,fireDetaching)},fireAttaching=function(component){var children=component.components();each(children,fireAttaching),emit(component,attachedToDom())},attachWith=function(parent,child,insertion){parent.getSystem().addToWorld(child),insertion(parent.element(),child.element()),inBody(parent.element())&&fireAttaching(child),parent.syncComponents()},attachSystemWith=function(element,guiSystem,inserter){inserter(element,guiSystem.element());var children$1=children(guiSystem.element());each(children$1,function(child){guiSystem.getByDom(child).each(fireAttaching)})},cloak=function(sandbox,sConfig,sState){var sink=sConfig.getAttachPoint(sandbox);set$2(sandbox.element(),"position",Positioning.getMode(sink)),function(sandbox,cssKey,attr,newValue){getRaw(sandbox.element(),cssKey).fold(function(){remove$1(sandbox.element(),attr)},function(v){set$1(sandbox.element(),attr,v)}),set$2(sandbox.element(),cssKey,newValue)}(sandbox,"visibility",sConfig.cloakVisibilityAttr,"hidden")},decloak=function(sandbox,sConfig,sState){!function(element){return exists(["top","left","right","bottom"],function(pos){return getRaw(element,pos).isSome()})}(sandbox.element())&&remove$6(sandbox.element(),"position"),function(sandbox,cssKey,attr){if(has$1(sandbox.element(),attr)){var oldValue=get$2(sandbox.element(),attr);set$2(sandbox.element(),cssKey,oldValue)}else remove$6(sandbox.element(),cssKey)}(sandbox,"visibility",sConfig.cloakVisibilityAttr)},SandboxApis=Object.freeze({__proto__:null,cloak:cloak,decloak:decloak,open:open,openWhileCloaked:function(sandbox,sConfig,sState,data,transaction){cloak(sandbox,sConfig),open(sandbox,sConfig,sState,data),transaction(),decloak(sandbox,sConfig)},close:close,isOpen:isOpen,isPartOf:function(sandbox,sConfig,sState,queryElem){return isOpen(0,0,sState)&&sState.get().exists(function(data){return sConfig.isPartOf(sandbox,data,queryElem)})},getState:function(sandbox,sConfig,sState){return sState.get()},setContent:function(sandbox,sConfig,sState,data){return sState.get().map(function(){return rebuild(sandbox,sConfig,sState,data)})}}),ActiveSandbox=Object.freeze({__proto__:null,events:function(sandboxConfig,sandboxState){return derive([run(sandboxClose(),function(sandbox,simulatedEvent){close(sandbox,sandboxConfig,sandboxState)})])}}),SandboxSchema=[onHandler("onOpen"),onHandler("onClose"),strict$1("isPartOf"),strict$1("getAttachPoint"),defaulted$1("cloakVisibilityAttr","data-precloak-visibility")],Sandboxing=create$1({fields:SandboxSchema,name:"sandboxing",active:ActiveSandbox,apis:SandboxApis,state:Object.freeze({__proto__:null,init:function(){var contents=Cell(Option.none()),readState=constant("not-implemented");return nu$5({readState:readState,isOpen:function(){return contents.get().isSome()},clear:function(){contents.set(Option.none())},set:function(comp){contents.set(Option.some(comp))},get:function(){return contents.get()}})}})}),dismissPopups=constant("dismiss.popups"),repositionPopups=constant("reposition.popups"),mouseReleased=constant("mouse.released"),schema$2=objOfOnly([defaulted$1("isExtraPart",constant(!1)),optionObjOf("fireEventInstead",[defaulted$1("event",dismissRequested())])]),schema$3=objOfOnly([optionObjOf("fireEventInstead",[defaulted$1("event",repositionRequested())]),strictFunction("doReposition")]),RepresentApis=Object.freeze({__proto__:null,onLoad:onLoad,onUnload:onUnload,setValue:function(component,repConfig,repState,data){repConfig.store.manager.setValue(component,repConfig,repState,data)},getValue:function(component,repConfig,repState){return repConfig.store.manager.getValue(component,repConfig,repState)},getState:function(component,repConfig,repState){return repState}}),ActiveRepresenting=Object.freeze({__proto__:null,events:function(repConfig,repState){var es=repConfig.resetOnDom?[runOnAttached(function(comp,se){onLoad(comp,repConfig,repState)}),runOnDetached(function(comp,se){onUnload(comp,repConfig,repState)})]:[loadEvent(repConfig,repState,onLoad)];return derive(es)}}),RepresentState=Object.freeze({__proto__:null,memory:memory,dataset:dataset,manual:function(){return nu$5({readState:function(){}})},init:function(spec){return spec.store.manager.state(spec)}}),DatasetStore=[option("initialValue"),strict$1("getFallbackEntry"),strict$1("getDataKey"),strict$1("setValue"),output("manager",{setValue:setValue$1,getValue:function(component,repConfig,repState){var store=repConfig.store,key=store.getDataKey(component);return repState.lookup(key).fold(function(){return store.getFallbackEntry(key)},function(data){return data})},onLoad:function(component,repConfig,repState){repConfig.store.initialValue.each(function(data){setValue$1(component,repConfig,repState,data)})},onUnload:function(component,repConfig,repState){repState.clear()},state:dataset})],ManualStore=[strict$1("getValue"),defaulted$1("setValue",noop),option("initialValue"),output("manager",{setValue:function(component,repConfig,repState,data){repConfig.store.setValue(component,data),repConfig.onSetValue(component,data)},getValue:function(component,repConfig,repState){return repConfig.store.getValue(component)},onLoad:function(component,repConfig,repState){repConfig.store.initialValue.each(function(data){repConfig.store.setValue(component,data)})},onUnload:noop,state:NoState.init})],MemoryStore=[option("initialValue"),output("manager",{setValue:function(component,repConfig,repState,data){repState.set(data),repConfig.onSetValue(component,data)},getValue:function(component,repConfig,repState){return repState.get()},onLoad:function(component,repConfig,repState){repConfig.store.initialValue.each(function(initVal){repState.isNotSet()&&repState.set(initVal)})},onUnload:function(component,repConfig,repState){repState.clear()},state:memory})],RepresentSchema=[defaultedOf("store",{mode:"memory"},choose$1("mode",{memory:MemoryStore,manual:ManualStore,dataset:DatasetStore})),onHandler("onSetValue"),defaulted$1("resetOnDom",!1)],Representing=create$1({fields:RepresentSchema,name:"representing",active:ActiveRepresenting,apis:RepresentApis,extra:{setValueFrom:function(component,source){var value=Representing.getValue(source);Representing.setValue(component,value)}},state:RepresentState}),SketchBehaviours_field=field$1,SketchBehaviours_augment=augment,adt$9=Adt_generate([{single:["required","valueThunk"]},{multiple:["required","valueThunks"]}]),substitute=function(owner,detail,compSpec,placeholders){return scan(owner,0,compSpec,placeholders).fold(function(req,valueThunk){var value=isSubstituted(compSpec)?valueThunk(detail,compSpec.config,compSpec.validated):valueThunk(detail),childSpecs=get(value,"components").getOr([]),substituted=bind(childSpecs,function(c){return substitute(owner,detail,c,placeholders)});return[__assign(__assign({},value),{components:substituted})]},function(req,valuesThunk){if(isSubstituted(compSpec)){var values=valuesThunk(detail,compSpec.config,compSpec.validated);return compSpec.validated.preprocess.getOr(identity)(values)}return valuesThunk(detail)})},single=adt$9.single,multiple=adt$9.multiple,placeholder=constant("placeholder"),adt$a=Adt_generate([{required:["data"]},{external:["data"]},{optional:["data"]},{group:["data"]}]),fFactory=defaulted$1("factory",{sketch:identity}),fSchema=defaulted$1("schema",[]),fName=strict$1("name"),fPname=field("pname","pname",defaultedThunk(function(typeSpec){return"<alloy."+generate$1(typeSpec.name)+">"}),anyValue$1()),fGroupSchema=state$1("schema",function(){return[option("preprocess")]}),fDefaults=defaulted$1("defaults",constant({})),fOverrides=defaulted$1("overrides",constant({})),requiredSpec=objOf([fFactory,fSchema,fName,fPname,fDefaults,fOverrides]),externalSpec=objOf([fFactory,fSchema,fName,fDefaults,fOverrides]),optionalSpec=objOf([fFactory,fSchema,fName,fPname,fDefaults,fOverrides]),groupSpec=objOf([fFactory,fGroupSchema,fName,strict$1("unit"),fPname,fDefaults,fOverrides]),required=convert(adt$a.required,requiredSpec),external$1=convert(adt$a.external,externalSpec),optional=convert(adt$a.optional,optionalSpec),group=convert(adt$a.group,groupSpec),original=constant("entirety"),PartType=Object.freeze({__proto__:null,required:required,external:external$1,optional:optional,group:group,asNamedPart:asNamedPart,name:name$1,asCommon:function(part){return part.fold(identity,identity,identity,identity)},original:original}),doGenerateOne=function(owner,pname){return{uiType:placeholder(),owner:owner,name:pname}},AlloyParts=Object.freeze({__proto__:null,generate:generate$4,generateOne:generateOne,schemas:schemas,names:names,substitutes:substitutes,components:components,defaultUids:defaultUids,defaultUidsSchema:defaultUidsSchema,getAllParts:getAllParts,getAllPartNames:getAllPartNames,getPart:getPart,getPartOrDie:getPartOrDie,getParts:getParts,getPartsOrDie:getPartsOrDie}),supplyUid=function(spec){return function(spec){return has(spec,"uid")}(spec)?spec:__assign(__assign({},spec),{uid:generate$2("uid")})};function single$2(rawConfig){var config=asRawOrDie("Sketcher for "+rawConfig.name,singleSchema,rawConfig),apis=map$1(config.apis,makeApi),extraApis=map$1(config.extraApis,function(f,k){return markAsExtraApi(f,k)});return __assign(__assign({name:constant(config.name),configFields:constant(config.configFields),sketch:function(spec){return function(owner,schema,factory,spec){var specWithUid=supplyUid(spec);return factory(asRawOrDie$1(owner,schema,specWithUid,[],[]),specWithUid)}(config.name,config.configFields,config.factory,spec)}},apis),extraApis)}function composite$1(rawConfig){var config=asRawOrDie("Sketcher for "+rawConfig.name,compositeSchema,rawConfig),parts=generate$4(config.name,config.partFields),apis=map$1(config.apis,makeApi),extraApis=map$1(config.extraApis,function(f,k){return markAsExtraApi(f,k)});return __assign(__assign({name:constant(config.name),partFields:constant(config.partFields),configFields:constant(config.configFields),sketch:function(spec){return composite(config.name,config.configFields,config.partFields,config.factory,spec)},parts:constant(parts)},apis),extraApis)}function cat(arr){for(var r=[],push=function(x){r.push(x)},i=0;i<arr.length;i++)arr[i].each(push);return r}function inside(target){return"input"===name(target)&&"radio"!==get$2(target,"type")||"textarea"===name(target)}function dehighlightAllExcept(component,hConfig,hState,skip){var highlighted=descendants(component.element(),"."+hConfig.highlightClass);each(highlighted,function(h){exists(skip,function(skipComp){return skipComp.element()===h})||(remove$4(h,hConfig.highlightClass),component.getSystem().getByDom(h).each(function(target){hConfig.onDehighlight(component,target),emit(target,dehighlight())}))})}function highlight$1(component,hConfig,hState,target){dehighlightAllExcept(component,hConfig,0,[target]),isHighlighted(component,hConfig,hState,target)||(add$2(target.element(),hConfig.highlightClass),hConfig.onHighlight(component,target),emit(target,highlight()))}function getDelta(component,hConfig,hState,delta){var items=descendants(component.element(),"."+hConfig.itemClass);return findIndex(items,function(item){return has$2(item,hConfig.highlightClass)}).bind(function(selected){var dest=cycleBy(selected,delta,0,items.length-1);return component.getSystem().getByDom(items[dest]).toOption()})}function cyclePrev(values,index,predicate){var before=reverse(values.slice(0,index)),after=reverse(values.slice(index+1));return find(before.concat(after),predicate)}function tryPrev(values,index,predicate){var before=reverse(values.slice(0,index));return find(before,predicate)}function cycleNext(values,index,predicate){var before=values.slice(0,index),after=values.slice(index+1);return find(after.concat(before),predicate)}function tryNext(values,index,predicate){var after=values.slice(index+1);return find(after,predicate)}function inSet(keys){return function(event){var raw=event.raw();return contains(keys,raw.which)}}function and(preds){return function(event){return forall(preds,function(pred){return pred(event)})}}function isShift(event){return!0===event.raw().shiftKey}function isControl(event){return!0===event.raw().ctrlKey}function rule(matches,action){return{matches:matches,classification:action}}function reportFocusShifting(component,prevFocus,newFocus){prevFocus.exists(function(p){return newFocus.exists(function(n){return eq(n,p)})})||emitWith(component,focusShifted(),{prevFocus:prevFocus,newFocus:newFocus})}function dom(){function get(component){return search(component.element())}return{get:get,set:function(component,focusee){var prevFocus=get(component);component.getSystem().triggerFocus(focusee,component.element());var newFocus=get(component);reportFocusShifting(component,prevFocus,newFocus)}}}function highlights(){function get(component){return Highlighting.getHighlighted(component).map(function(item){return item.element()})}return{get:get,set:function(component,element){var prevFocus=get(component);component.getSystem().getByDom(element).fold(noop,function(item){Highlighting.highlight(component,item)});var newFocus=get(component);reportFocusShifting(component,prevFocus,newFocus)}}}var FocusInsideModes,singleSchema=objOfOnly([strict$1("name"),strict$1("factory"),strict$1("configFields"),defaulted$1("apis",{}),defaulted$1("extraApis",{})]),compositeSchema=objOfOnly([strict$1("name"),strict$1("factory"),strict$1("configFields"),strict$1("partFields"),defaulted$1("apis",{}),defaulted$1("extraApis",{})]),ComposeApis=Object.freeze({__proto__:null,getCurrent:function(component,composeConfig,composeState){return composeConfig.find(component)}}),ComposeSchema=[strict$1("find")],Composing=create$1({fields:ComposeSchema,name:"composing",apis:ComposeApis}),isHighlighted=function(component,hConfig,hState,queryTarget){return has$2(queryTarget.element(),hConfig.highlightClass)},getByIndex=function(component,hConfig,hState,index){var items=descendants(component.element(),"."+hConfig.itemClass);return Option.from(items[index]).fold(function(){return Result.error("No element found with index "+index)},component.getSystem().getByDom)},getFirst=function(component,hConfig,hState){return descendant$1(component.element(),"."+hConfig.itemClass).bind(function(e){return component.getSystem().getByDom(e).toOption()})},getLast=function(component,hConfig,hState){var items=descendants(component.element(),"."+hConfig.itemClass);return(0<items.length?Option.some(items[items.length-1]):Option.none()).bind(function(c){return component.getSystem().getByDom(c).toOption()})},getCandidates=function(component,hConfig,hState){var items=descendants(component.element(),"."+hConfig.itemClass);return cat(map(items,function(i){return component.getSystem().getByDom(i).toOption()}))},HighlightApis=Object.freeze({__proto__:null,dehighlightAll:function(component,hConfig,hState){return dehighlightAllExcept(component,hConfig,0,[])},dehighlight:function(component,hConfig,hState,target){isHighlighted(component,hConfig,hState,target)&&(remove$4(target.element(),hConfig.highlightClass),hConfig.onDehighlight(component,target),emit(target,dehighlight()))},highlight:highlight$1,highlightFirst:function(component,hConfig,hState){getFirst(component,hConfig).each(function(firstComp){highlight$1(component,hConfig,hState,firstComp)})},highlightLast:function(component,hConfig,hState){getLast(component,hConfig).each(function(lastComp){highlight$1(component,hConfig,hState,lastComp)})},highlightAt:function(component,hConfig,hState,index){getByIndex(component,hConfig,hState,index).fold(function(err){throw new Error(err)},function(firstComp){highlight$1(component,hConfig,hState,firstComp)})},highlightBy:function(component,hConfig,hState,predicate){var candidates=getCandidates(component,hConfig);find(candidates,predicate).each(function(c){highlight$1(component,hConfig,hState,c)})},isHighlighted:isHighlighted,getHighlighted:function(component,hConfig,hState){return descendant$1(component.element(),"."+hConfig.highlightClass).bind(function(e){return component.getSystem().getByDom(e).toOption()})},getFirst:getFirst,getLast:getLast,getPrevious:function(component,hConfig,hState){return getDelta(component,hConfig,0,-1)},getNext:function(component,hConfig,hState){return getDelta(component,hConfig,0,1)},getCandidates:getCandidates}),HighlightSchema=[strict$1("highlightClass"),strict$1("itemClass"),onHandler("onHighlight"),onHandler("onDehighlight")],Highlighting=create$1({fields:HighlightSchema,name:"highlighting",apis:HighlightApis}),isNotShift=not(isShift);!function(FocusInsideModes){FocusInsideModes.OnFocusMode="onFocus",FocusInsideModes.OnEnterOrSpaceMode="onEnterOrSpace",FocusInsideModes.OnApiMode="onApi"}(FocusInsideModes=FocusInsideModes||{});function typical(infoSchema,stateInit,getKeydownRules,getKeyupRules,optFocusIn){function processKey(component,simulatedEvent,getRules,keyingConfig,keyingState){return function(transitions,event){return find(transitions,function(t){return t.matches(event)}).map(function(t){return t.classification})}(getRules(component,simulatedEvent,keyingConfig,keyingState),simulatedEvent.event()).bind(function(rule){return rule(component,simulatedEvent,keyingConfig,keyingState)})}var me={schema:function(){return infoSchema.concat([defaulted$1("focusManager",dom()),defaultedOf("focusInside","onFocus",valueOf(function(val){return contains(["onFocus","onEnterOrSpace","onApi"],val)?Result.value(val):Result.error("Invalid value for focusInside")})),output("handler",me),output("state",stateInit),output("sendFocusIn",optFocusIn)])},processKey:processKey,toEvents:function(keyingConfig,keyingState){var onFocusHandler=keyingConfig.focusInside!==FocusInsideModes.OnFocusMode?Option.none():optFocusIn(keyingConfig).map(function(focusIn){return run(focus(),function(component,simulatedEvent){focusIn(component,keyingConfig,keyingState),simulatedEvent.stop()})});return derive(onFocusHandler.toArray().concat([run(keydown(),function(component,simulatedEvent){processKey(component,simulatedEvent,getKeydownRules,keyingConfig,keyingState).fold(function(){!function(component,simulatedEvent){var isEnterOrSpace=inSet([32].concat([13]))(simulatedEvent.event());keyingConfig.focusInside===FocusInsideModes.OnEnterOrSpaceMode&&isEnterOrSpace&&isSource(component,simulatedEvent)&&optFocusIn(keyingConfig).each(function(focusIn){focusIn(component,keyingConfig,keyingState),simulatedEvent.stop()})}(component,simulatedEvent)},function(_){simulatedEvent.stop()})}),run(keyup(),function(component,simulatedEvent){processKey(component,simulatedEvent,getKeyupRules,keyingConfig,keyingState).each(function(_){simulatedEvent.stop()})})]))}};return me}function create$3(cyclicField){function isVisible(tabbingConfig,element){var target=tabbingConfig.visibilitySelector.bind(function(sel){return closest$3(element,sel)}).getOr(element);return 0<get$6(target)}function focusIn(component,tabbingConfig,tabbingState){(function(component,tabbingConfig){var tabstops=descendants(component.element(),tabbingConfig.selector),visibles=filter(tabstops,function(elem){return isVisible(tabbingConfig,elem)});return Option.from(visibles[tabbingConfig.firstTabstop])})(component,tabbingConfig).each(function(target){tabbingConfig.focusManager.set(component,target)})}function goFromTabstop(component,tabstops,stopIndex,tabbingConfig,cycle){return cycle(tabstops,stopIndex,function(elem){return function(tabbingConfig,element){return isVisible(tabbingConfig,element)&&tabbingConfig.useTabstopAt(element)}(tabbingConfig,elem)}).fold(function(){return tabbingConfig.cyclic?Option.some(!0):Option.none()},function(target){return tabbingConfig.focusManager.set(component,target),Option.some(!0)})}function go(component,simulatedEvent,tabbingConfig,cycle){var tabstops=descendants(component.element(),tabbingConfig.selector);return function(component,tabbingConfig){return tabbingConfig.focusManager.get(component).bind(function(elem){return closest$3(elem,tabbingConfig.selector)})}(component,tabbingConfig).bind(function(tabstop){return findIndex(tabstops,curry(eq,tabstop)).bind(function(stopIndex){return goFromTabstop(component,tabstops,stopIndex,tabbingConfig,cycle)})})}var schema=[option("onEscape"),option("onEnter"),defaulted$1("selector",'[data-alloy-tabstop="true"]:not(:disabled)'),defaulted$1("firstTabstop",0),defaulted$1("useTabstopAt",constant(!0)),option("visibilitySelector")].concat([cyclicField]),getKeydownRules=constant([rule(and([isShift,inSet([9])]),function(component,simulatedEvent,tabbingConfig){var navigate=tabbingConfig.cyclic?cyclePrev:tryPrev;return go(component,0,tabbingConfig,navigate)}),rule(inSet([9]),function(component,simulatedEvent,tabbingConfig){var navigate=tabbingConfig.cyclic?cycleNext:tryNext;return go(component,0,tabbingConfig,navigate)}),rule(inSet([27]),function(component,simulatedEvent,tabbingConfig){return tabbingConfig.onEscape.bind(function(f){return f(component,simulatedEvent)})}),rule(and([isNotShift,inSet([13])]),function(component,simulatedEvent,tabbingConfig){return tabbingConfig.onEnter.bind(function(f){return f(component,simulatedEvent)})})]),getKeyupRules=constant([]);return typical(schema,NoState.init,getKeydownRules,getKeyupRules,function(){return Option.some(focusIn)})}function defaultExecute(component,simulatedEvent,focused){return inside(focused)&&inSet([32])(simulatedEvent.event())?Option.none():function(component,simulatedEvent,focused){return dispatch(component,focused,execute()),Option.some(!0)}(component,0,focused)}function stopEventForFirefox(component,simulatedEvent){return Option.some(!0)}function execute$1(component,simulatedEvent,executeConfig){return executeConfig.execute(component,simulatedEvent,component.element())}function flatgrid(){var dimensions=Cell(Option.none());return nu$5({readState:function(){return dimensions.get().map(function(d){return{numRows:String(d.numRows()),numColumns:String(d.numColumns())}}).getOr({numRows:"?",numColumns:"?"})},setGridSize:function(numRows,numColumns){dimensions.set(Option.some({numRows:constant(numRows),numColumns:constant(numColumns)}))},getNumRows:function(){return dimensions.get().map(function(d){return d.numRows()})},getNumColumns:function(){return dimensions.get().map(function(d){return d.numColumns()})}})}function useH(movement){return function(component,simulatedEvent,config,state){var move=movement(component.element());return use(move,component,simulatedEvent,config,state)}}function west$2(moveLeft,moveRight){var movement=onDirection(moveLeft,moveRight);return useH(movement)}function east$2(moveLeft,moveRight){var movement=onDirection(moveRight,moveLeft);return useH(movement)}function useV(move){return function(component,simulatedEvent,config,state){return use(move,component,simulatedEvent,config,state)}}function isVisible(element){return!function(dom){return dom.offsetWidth<=0&&dom.offsetHeight<=0}(element.dom())}function locateVisible(container,current,selector){var candidates=descendants(container,selector);return function(candidates,predicate){return findIndex(candidates,predicate).map(function(index){return{index:constant(index),candidates:constant(candidates)}})}(filter(candidates,isVisible),function(x){return eq(x,current)})}function findIndex$1(elements,target){return findIndex(elements,function(elem){return eq(target,elem)})}function withGrid(values,index,numCols,f){return f(Math.floor(index/numCols),index%numCols).bind(function(address){var newIndex=address.row()*numCols+address.column();return 0<=newIndex&&newIndex<values.length?Option.some(values[newIndex]):Option.none()})}function cycleHorizontal(values,index,numRows,numCols,delta){return withGrid(values,index,numCols,function(oldRow,oldColumn){var colsInRow=oldRow===numRows-1?values.length-oldRow*numCols:numCols,newColumn=cycleBy(oldColumn,delta,0,colsInRow-1);return Option.some({row:constant(oldRow),column:constant(newColumn)})})}function cycleVertical(values,index,numRows,numCols,delta){return withGrid(values,index,numCols,function(oldRow,oldColumn){var newRow=cycleBy(oldRow,delta,0,numRows-1),colsInRow=newRow===numRows-1?values.length-newRow*numCols:numCols,newCol=clamp(oldColumn,0,colsInRow-1);return Option.some({row:constant(newRow),column:constant(newCol)})})}function focusIn(component,gridConfig,gridState){descendant$1(component.element(),gridConfig.selector).each(function(first){gridConfig.focusManager.set(component,first)})}function doMove(cycle){return function(element,focused,gridConfig,gridState){return locateVisible(element,focused,gridConfig.selector).bind(function(identified){return cycle(identified.candidates(),identified.index(),gridState.getNumRows().getOr(gridConfig.initSize.numRows),gridState.getNumColumns().getOr(gridConfig.initSize.numColumns))})}}function handleTab(component,simulatedEvent,gridConfig){return gridConfig.captureTab?Option.some(!0):Option.none()}function horizontal(container,selector,current,delta){var tryCycle=function(initial,index,candidates){var newIndex=cycleBy(index,delta,0,candidates.length-1);return newIndex===initial?Option.none():function(candidate){return"button"===name(candidate)&&"disabled"===get$2(candidate,"disabled")}(candidates[newIndex])?tryCycle(initial,newIndex,candidates):Option.from(candidates[newIndex])};return locateVisible(container,current,selector).bind(function(identified){var index=identified.index(),candidates=identified.candidates();return tryCycle(index,index,candidates)})}function execute$3(component,simulatedEvent,flowConfig){return function(component,flowConfig){return flowConfig.focusManager.get(component).bind(function(elem){return closest$3(elem,flowConfig.selector)})}(component,flowConfig).bind(function(focused){return flowConfig.execute(component,simulatedEvent,focused)})}function focusIn$1(component,flowConfig,state){flowConfig.getInitial(component).orThunk(function(){return descendant$1(component.element(),flowConfig.selector)}).each(function(first){flowConfig.focusManager.set(component,first)})}function moveLeft$1(element,focused,info){return horizontal(element,info.selector,focused,-1)}function moveRight$1(element,focused,info){return horizontal(element,info.selector,focused,1)}function doMove$1(movement){return function(component,simulatedEvent,flowConfig,flowState){return movement(component,simulatedEvent,flowConfig,flowState).bind(function(){return flowConfig.executeOnMove?execute$3(component,simulatedEvent,flowConfig):Option.some(!0)})}}function doEscape$1(component,simulatedEvent,flowConfig){return flowConfig.onEscape(component,simulatedEvent)}function toCell(matrix,rowIndex,columnIndex){return Option.from(matrix[rowIndex]).bind(function(row){return Option.from(row[columnIndex]).map(function(cell){return outcome({rowIndex:rowIndex,columnIndex:columnIndex,cell:cell})})})}function cycleHorizontal$1(matrix,rowIndex,startCol,deltaCol){var colsInRow=matrix[rowIndex].length,newColIndex=cycleBy(startCol,deltaCol,0,colsInRow-1);return toCell(matrix,rowIndex,newColIndex)}function cycleVertical$1(matrix,colIndex,startRow,deltaRow){var nextRowIndex=cycleBy(startRow,deltaRow,0,matrix.length-1),colsInNextRow=matrix[nextRowIndex].length,nextColIndex=clamp(colIndex,0,colsInNextRow-1);return toCell(matrix,nextRowIndex,nextColIndex)}function moveHorizontal(matrix,rowIndex,startCol,deltaCol){var colsInRow=matrix[rowIndex].length,newColIndex=clamp(startCol+deltaCol,0,colsInRow-1);return toCell(matrix,rowIndex,newColIndex)}function moveVertical(matrix,colIndex,startRow,deltaRow){var nextRowIndex=clamp(startRow+deltaRow,0,matrix.length-1),colsInNextRow=matrix[nextRowIndex].length,nextColIndex=clamp(colIndex,0,colsInNextRow-1);return toCell(matrix,nextRowIndex,nextColIndex)}function focusIn$2(component,matrixConfig,state){matrixConfig.previousSelector(component).orThunk(function(){var selectors=matrixConfig.selectors;return descendant$1(component.element(),selectors.cell)}).each(function(cell){matrixConfig.focusManager.set(component,cell)})}function doMove$2(ifCycle,ifMove){return function(element,focused,matrixConfig){var move=matrixConfig.cycles?ifCycle:ifMove;return closest$3(focused,matrixConfig.selectors.row).bind(function(inRow){var cellsInRow=descendants(inRow,matrixConfig.selectors.cell);return findIndex$1(cellsInRow,focused).bind(function(colIndex){var allRows=descendants(element,matrixConfig.selectors.row);return findIndex$1(allRows,inRow).bind(function(rowIndex){var matrix=function(rows,matrixConfig){return map(rows,function(row){return descendants(row,matrixConfig.selectors.cell)})}(allRows,matrixConfig);return move(matrix,rowIndex,colIndex).map(function(next){return next.cell()})})})})}}function execute$5(component,simulatedEvent,menuConfig){return menuConfig.focusManager.get(component).bind(function(focused){return menuConfig.execute(component,simulatedEvent,focused)})}function focusIn$3(component,menuConfig,state){descendant$1(component.element(),menuConfig.selector).each(function(first){menuConfig.focusManager.set(component,first)})}function moveUp$1(element,focused,info){return horizontal(element,info.selector,focused,-1)}function moveDown$1(element,focused,info){return horizontal(element,info.selector,focused,1)}function insert(component,replaceConfig,insertion,childSpec){var child=component.getSystem().build(childSpec);attachWith(component,child,insertion)}function remove$7(component,replaceConfig,replaceState,removee){var children=contents(component);find(children,function(child){return eq(removee.element(),child.element())}).each(detach)}function replaceAt(component,replaceConfig,replaceState,replaceeIndex,replacer){var children=contents(component);return Option.from(children[replaceeIndex]).map(function(replacee){return remove$7(component,0,0,replacee),replacer.each(function(r){insert(component,0,function(p,c){!function(parent,element,index){child(parent,index).fold(function(){append(parent,element)},function(v){before(v,element)})}(p,c,replaceeIndex)},r)}),replacee})}function config(name,eventHandlers){return{key:name,value:{config:{},me:function(name,eventHandlers){var events=derive(eventHandlers);return create$1({fields:[strict$1("enabled")],name:name,active:{events:constant(events)}})}(name,eventHandlers),configAsRaw:constant({}),initialConfig:{},state:NoState}}}function focus$2(component,focusConfig){focusConfig.ignore||(focus$1(component.element()),focusConfig.onFocus(component))}function updateAriaState(component,toggleConfig,toggleState){var ariaInfo=toggleConfig.aria;ariaInfo.update(component,ariaInfo,toggleState.get())}function updateClass(component,toggleConfig,toggleState){toggleConfig.toggleClass.each(function(toggleClass){toggleState.get()?add$2(component.element(),toggleClass):remove$4(component.element(),toggleClass)})}function toggle(component,toggleConfig,toggleState){set$6(component,toggleConfig,toggleState,!toggleState.get())}function on$1(component,toggleConfig,toggleState){toggleState.set(!0),updateClass(component,toggleConfig,toggleState),updateAriaState(component,toggleConfig,toggleState)}function off(component,toggleConfig,toggleState){toggleState.set(!1),updateClass(component,toggleConfig,toggleState),updateAriaState(component,toggleConfig,toggleState)}function onLoad$4(component,toggleConfig,toggleState){set$6(component,toggleConfig,toggleState,toggleConfig.selected)}function pointerEvents(){function onClick(component,simulatedEvent){simulatedEvent.stop(),emitExecute(component)}return[run(click(),onClick),run(tap(),onClick),cutter(touchstart()),cutter(mousedown())]}function events$7(optAction){return derive(flatten([optAction.map(function(action){return runOnExecute(function(component,simulatedEvent){action(component),simulatedEvent.stop()})}).toArray(),pointerEvents()]))}function onHover(item){(search(item.element()).isNone()||Focusing.isFocused(item))&&(Focusing.isFocused(item)||Focusing.focus(item),emitWith(item,"alloy.item-hover",{item:item}))}function onFocus(item){emitWith(item,"alloy.item-focus",{item:item})}function generate$5(menus,expansions){var items={};each$1(menus,function(menuItems,menu){each(menuItems,function(item){items[item]=menu})});var byItem=expansions,byMenu=function(obj){return tupleMap(obj,function(v,k){return{k:v,v:k}})}(expansions),menuPaths=map$1(byMenu,function(_triggerItem,submenu){return[submenu].concat(trace(items,byItem,byMenu,submenu))});return map$1(items,function(menu){return get(menuPaths,menu).getOr([menu])})}function makeMenu(detail,menuSandbox,anchor,menuSpec,getBounds){function lazySink(){return detail.lazySink(menuSandbox)}function getSubmenuLayouts(triggeringPaths){return function(triggeringPaths){return 2===triggeringPaths.length}(triggeringPaths)?layouts:{}}var layouts="horizontal"===menuSpec.type?{layouts:{onLtr:function(){return belowOrAbove()},onRtl:function(){return belowOrAboveRtl()}}}:{};return tieredMenu.sketch({dom:{tag:"div"},data:menuSpec.data,markers:menuSpec.menu.markers,highlightImmediately:menuSpec.menu.highlightImmediately,onEscape:function(){return Sandboxing.close(menuSandbox),detail.onEscape.map(function(handler){return handler(menuSandbox)}),Option.some(!0)},onExecute:function(){return Option.some(!0)},onOpenMenu:function(tmenu,menu){Positioning.positionWithinBounds(lazySink().getOrDie(),anchor,menu,getBounds())},onOpenSubmenu:function(tmenu,item,submenu,triggeringPaths){var sink=lazySink().getOrDie();Positioning.position(sink,__assign({anchor:"submenu",item:item},getSubmenuLayouts(triggeringPaths)),submenu)},onRepositionMenu:function(tmenu,primaryMenu,submenuTriggers){var sink=lazySink().getOrDie();Positioning.positionWithinBounds(sink,anchor,primaryMenu,getBounds()),each(submenuTriggers,function(st){var submenuLayouts=getSubmenuLayouts(st.triggeringPath);Positioning.position(sink,__assign({anchor:"submenu",item:st.triggeringItem},submenuLayouts),st.triggeredMenu)})}})}function westEdgeX$1(anchor){return anchor.x()}function middleX$1(anchor,element){return anchor.x()+anchor.width()/2-element.width()/2}function eastEdgeX$1(anchor,element){return anchor.x()+anchor.width()-element.width()}function northY$2(anchor){return anchor.y()}function southY$2(anchor,element){return anchor.y()+anchor.height()-element.height()}function southeast$3(anchor,element,bubbles){return nu$7(eastEdgeX$1(anchor,element),southY$2(anchor,element),bubbles.innerSoutheast(),northwest(),boundsRestriction(anchor,{right:0,bottom:3}),"layout-inner-se")}function southwest$3(anchor,element,bubbles){return nu$7(westEdgeX$1(anchor),southY$2(anchor,element),bubbles.innerSouthwest(),northeast(),boundsRestriction(anchor,{left:1,bottom:3}),"layout-inner-sw")}function northeast$3(anchor,element,bubbles){return nu$7(eastEdgeX$1(anchor,element),northY$2(anchor),bubbles.innerNortheast(),southwest(),boundsRestriction(anchor,{right:0,top:2}),"layout-inner-ne")}function northwest$3(anchor,element,bubbles){return nu$7(westEdgeX$1(anchor),northY$2(anchor),bubbles.innerNorthwest(),southeast(),boundsRestriction(anchor,{left:1,top:2}),"layout-inner-nw")}function getHeightSetting(editor){return editor.getParam("height",Math.max(editor.getElement().offsetHeight,200))}function getWidthSetting(editor){return editor.getParam("width",global$3.DOM.getStyle(editor.getElement(),"width"))}function getMinWidthSetting(editor){return Option.from(editor.settings.min_width).filter(isNumber)}function getMinHeightSetting(editor){return Option.from(editor.settings.min_height).filter(isNumber)}function getMaxWidthSetting(editor){return Option.from(editor.getParam("max_width")).filter(isNumber)}function getMaxHeightSetting(editor){return Option.from(editor.getParam("max_height")).filter(isNumber)}function isMenubarEnabled(editor){return!1!==editor.getParam("menubar",!0,"boolean")}function isToolbarEnabled(editor){var toolbar=editor.getParam("toolbar",!0),isToolbarTrue=!0===toolbar,isToolbarString=isString(toolbar),isToolbarObjectArray=isArray(toolbar)&&0<toolbar.length;return!isMultipleToolbars(editor)&&(isToolbarObjectArray||isToolbarString||isToolbarTrue)}function getMultipleToolbarsSetting(editor){var keys$1=keys(editor.settings),toolbarKeys=filter(keys$1,function(key){return/^toolbar([1-9])$/.test(key)}),toolbars=map(toolbarKeys,function(key){return editor.getParam(key,!1,"string")}),toolbarArray=filter(toolbars,function(toolbar){return"string"==typeof toolbar});return 0<toolbarArray.length?Option.some(toolbarArray):Option.none()}var initialState,ToolbarMode,AcyclicType=create$3(state$1("cyclic",constant(!1))),CyclicType=create$3(state$1("cyclic",constant(!0))),schema$4=[defaulted$1("execute",defaultExecute),defaulted$1("useSpace",!1),defaulted$1("useEnter",!0),defaulted$1("useControlEnter",!1),defaulted$1("useDown",!1)],ExecutionType=typical(schema$4,NoState.init,function(component,simulatedEvent,executeConfig,executeState){var spaceExec=executeConfig.useSpace&&!inside(component.element())?[32]:[],enterExec=executeConfig.useEnter?[13]:[],downExec=executeConfig.useDown?[40]:[],execKeys=spaceExec.concat(enterExec).concat(downExec);return[rule(inSet(execKeys),execute$1)].concat(executeConfig.useControlEnter?[rule(and([isControl,inSet([13])]),execute$1)]:[])},function(component,simulatedEvent,executeConfig,executeState){return executeConfig.useSpace&&!inside(component.element())?[rule(inSet([32]),stopEventForFirefox)]:[]},function(){return Option.none()}),KeyingState=Object.freeze({__proto__:null,flatgrid:flatgrid,init:function(spec){return spec.state(spec)}}),use=function(move,component,simulatedEvent,config,state){return config.focusManager.get(component).bind(function(focused){return move(component.element(),focused,config,state)}).map(function(newFocus){return config.focusManager.set(component,newFocus),!0})},north$2=useV,south$2=useV,move=useV,schema$5=[strict$1("selector"),defaulted$1("execute",defaultExecute),onKeyboardHandler("onEscape"),defaulted$1("captureTab",!1),initSize()],moveLeft=doMove(function(values,index,numRows,numCols){return cycleHorizontal(values,index,numRows,numCols,-1)}),moveRight=doMove(function(values,index,numRows,numCols){return cycleHorizontal(values,index,numRows,numCols,1)}),moveNorth=doMove(function(values,index,numRows,numCols){return cycleVertical(values,index,numRows,numCols,-1)}),moveSouth=doMove(function(values,index,numRows,numCols){return cycleVertical(values,index,numRows,numCols,1)}),getKeydownRules$1=constant([rule(inSet([37]),west$2(moveLeft,moveRight)),rule(inSet([39]),east$2(moveLeft,moveRight)),rule(inSet([38]),north$2(moveNorth)),rule(inSet([40]),south$2(moveSouth)),rule(and([isShift,inSet([9])]),handleTab),rule(and([isNotShift,inSet([9])]),handleTab),rule(inSet([27]),function(component,simulatedEvent,gridConfig){return gridConfig.onEscape(component,simulatedEvent)}),rule(inSet([32].concat([13])),function(component,simulatedEvent,gridConfig,gridState){return function(component,gridConfig){return gridConfig.focusManager.get(component).bind(function(elem){return closest$3(elem,gridConfig.selector)})}(component,gridConfig).bind(function(focused){return gridConfig.execute(component,simulatedEvent,focused)})})]),getKeyupRules$1=constant([rule(inSet([32]),stopEventForFirefox)]),FlatgridType=typical(schema$5,flatgrid,getKeydownRules$1,getKeyupRules$1,function(){return Option.some(focusIn)}),schema$6=[strict$1("selector"),defaulted$1("getInitial",Option.none),defaulted$1("execute",defaultExecute),onKeyboardHandler("onEscape"),defaulted$1("executeOnMove",!1),defaulted$1("allowVertical",!0)],getKeyupRules$2=constant([rule(inSet([32]),stopEventForFirefox)]),FlowType=typical(schema$6,NoState.init,function(_component,_se,flowConfig,_flowState){var westMovers=[37].concat(flowConfig.allowVertical?[38]:[]),eastMovers=[39].concat(flowConfig.allowVertical?[40]:[]);return[rule(inSet(westMovers),doMove$1(west$2(moveLeft$1,moveRight$1))),rule(inSet(eastMovers),doMove$1(east$2(moveLeft$1,moveRight$1))),rule(inSet([13]),execute$3),rule(inSet([32]),execute$3),rule(inSet([27]),doEscape$1)]},getKeyupRules$2,function(){return Option.some(focusIn$1)}),outcome=MixedBag(["rowIndex","columnIndex","cell"],[]),schema$7=[strictObjOf("selectors",[strict$1("row"),strict$1("cell")]),defaulted$1("cycles",!0),defaulted$1("previousSelector",Option.none),defaulted$1("execute",defaultExecute)],moveLeft$3=doMove$2(function(matrix,startRow,startCol){return cycleHorizontal$1(matrix,startRow,startCol,-1)},function(matrix,startRow,startCol){return moveHorizontal(matrix,startRow,startCol,-1)}),moveRight$3=doMove$2(function(matrix,startRow,startCol){return cycleHorizontal$1(matrix,startRow,startCol,1)},function(matrix,startRow,startCol){return moveHorizontal(matrix,startRow,startCol,1)}),moveNorth$1=doMove$2(function(matrix,startRow,startCol){return cycleVertical$1(matrix,startCol,startRow,-1)},function(matrix,startRow,startCol){return moveVertical(matrix,startCol,startRow,-1)}),moveSouth$1=doMove$2(function(matrix,startRow,startCol){return cycleVertical$1(matrix,startCol,startRow,1)},function(matrix,startRow,startCol){return moveVertical(matrix,startCol,startRow,1)}),getKeydownRules$3=constant([rule(inSet([37]),west$2(moveLeft$3,moveRight$3)),rule(inSet([39]),east$2(moveLeft$3,moveRight$3)),rule(inSet([38]),north$2(moveNorth$1)),rule(inSet([40]),south$2(moveSouth$1)),rule(inSet([32].concat([13])),function(component,simulatedEvent,matrixConfig){return search(component.element()).bind(function(focused){return matrixConfig.execute(component,simulatedEvent,focused)})})]),getKeyupRules$3=constant([rule(inSet([32]),stopEventForFirefox)]),MatrixType=typical(schema$7,NoState.init,getKeydownRules$3,getKeyupRules$3,function(){return Option.some(focusIn$2)}),schema$8=[strict$1("selector"),defaulted$1("execute",defaultExecute),defaulted$1("moveOnTab",!1)],getKeydownRules$4=constant([rule(inSet([38]),move(moveUp$1)),rule(inSet([40]),move(moveDown$1)),rule(and([isShift,inSet([9])]),function(component,simulatedEvent,menuConfig,menuState){return menuConfig.moveOnTab?move(moveUp$1)(component,simulatedEvent,menuConfig,menuState):Option.none()}),rule(and([isNotShift,inSet([9])]),function(component,simulatedEvent,menuConfig,menuState){return menuConfig.moveOnTab?move(moveDown$1)(component,simulatedEvent,menuConfig,menuState):Option.none()}),rule(inSet([13]),execute$5),rule(inSet([32]),execute$5)]),getKeyupRules$4=constant([rule(inSet([32]),stopEventForFirefox)]),MenuType=typical(schema$8,NoState.init,getKeydownRules$4,getKeyupRules$4,function(){return Option.some(focusIn$3)}),schema$9=[onKeyboardHandler("onSpace"),onKeyboardHandler("onEnter"),onKeyboardHandler("onShiftEnter"),onKeyboardHandler("onLeft"),onKeyboardHandler("onRight"),onKeyboardHandler("onTab"),onKeyboardHandler("onShiftTab"),onKeyboardHandler("onUp"),onKeyboardHandler("onDown"),onKeyboardHandler("onEscape"),defaulted$1("stopSpaceKeyup",!1),option("focusIn")],SpecialType=typical(schema$9,NoState.init,function(component,simulatedEvent,specialInfo){return[rule(inSet([32]),specialInfo.onSpace),rule(and([isNotShift,inSet([13])]),specialInfo.onEnter),rule(and([isShift,inSet([13])]),specialInfo.onShiftEnter),rule(and([isShift,inSet([9])]),specialInfo.onShiftTab),rule(and([isNotShift,inSet([9])]),specialInfo.onTab),rule(inSet([38]),specialInfo.onUp),rule(inSet([40]),specialInfo.onDown),rule(inSet([37]),specialInfo.onLeft),rule(inSet([39]),specialInfo.onRight),rule(inSet([32]),specialInfo.onSpace),rule(inSet([27]),specialInfo.onEscape)]},function(component,simulatedEvent,specialInfo){return specialInfo.stopSpaceKeyup?[rule(inSet([32]),stopEventForFirefox)]:[]},function(specialInfo){return specialInfo.focusIn}),acyclic=AcyclicType.schema(),cyclic=CyclicType.schema(),flow=FlowType.schema(),flatgrid$1=FlatgridType.schema(),matrix=MatrixType.schema(),execution=ExecutionType.schema(),menu=MenuType.schema(),special=SpecialType.schema(),Keying=createModes$1({branchKey:"mode",branches:Object.freeze({__proto__:null,acyclic:acyclic,cyclic:cyclic,flow:flow,flatgrid:flatgrid$1,matrix:matrix,execution:execution,menu:menu,special:special}),name:"keying",active:{events:function(keyingConfig,keyingState){return keyingConfig.handler.toEvents(keyingConfig,keyingState)}},apis:{focusIn:function(component,keyConfig,keyState){keyConfig.sendFocusIn(keyConfig).fold(function(){component.getSystem().triggerFocus(component.element(),component.element())},function(sendFocusIn){sendFocusIn(component,keyConfig,keyState)})},setGridSize:function(component,keyConfig,keyState,numRows,numColumns){!function(keyState){return hasNonNullableKey(keyState,"setGridSize")}(keyState)?domGlobals.console.error("Layout does not support setGridSize"):keyState.setGridSize(numRows,numColumns)}},state:KeyingState}),contents=function(component,replaceConfig){return component.components()},Replacing=create$1({fields:[],name:"replacing",apis:Object.freeze({__proto__:null,append:function(component,replaceConfig,replaceState,appendee){insert(component,0,append,appendee)},prepend:function(component,replaceConfig,replaceState,prependee){insert(component,0,prepend,prependee)},remove:remove$7,replaceAt:replaceAt,replaceBy:function(component,replaceConfig,replaceState,replaceePred,replacer){var children=contents(component);return findIndex(children,replaceePred).bind(function(replaceeIndex){return replaceAt(component,0,0,replaceeIndex,replacer)})},set:function(component,replaceConfig,replaceState,data){preserve(function(){var newChildren=map(data,component.getSystem().build);replaceChildren(component,newChildren)},component.element())},contents:contents})}),FocusApis=Object.freeze({__proto__:null,focus:focus$2,blur:function(component,focusConfig){focusConfig.ignore||function(element){element.dom().blur()}(component.element())},isFocused:function(component){return function(element){var doc=owner(element).dom();return element.dom()===doc.activeElement}(component.element())}}),ActiveFocus=Object.freeze({__proto__:null,exhibit:function(base,focusConfig){var mod=focusConfig.ignore?{}:{attributes:{tabindex:"-1"}};return nu$6(mod)},events:function(focusConfig){return derive([run(focus(),function(component,simulatedEvent){focus$2(component,focusConfig),simulatedEvent.stop()})].concat(focusConfig.stopMousedown?[run(mousedown(),function(_,simulatedEvent){simulatedEvent.event().prevent()})]:[]))}}),FocusSchema=[onHandler("onFocus"),defaulted$1("stopMousedown",!1),defaulted$1("ignore",!1)],Focusing=create$1({fields:FocusSchema,name:"focusing",active:ActiveFocus,apis:FocusApis}),set$6=function(component,toggleConfig,toggleState,state){(state?on$1:off)(component,toggleConfig,toggleState)},ToggleApis=Object.freeze({__proto__:null,onLoad:onLoad$4,toggle:toggle,isOn:function(component,toggleConfig,toggleState){return toggleState.get()},on:on$1,off:off,set:set$6}),ActiveToggle=Object.freeze({__proto__:null,exhibit:function(){return nu$6({})},events:function(toggleConfig,toggleState){var execute=function(bConfig,bState,executor){return runOnExecute(function(component){executor(component,bConfig,bState)})}(toggleConfig,toggleState,toggle),load=loadEvent(toggleConfig,toggleState,onLoad$4);return derive(flatten([toggleConfig.toggleOnExecute?[execute]:[],[load]]))}}),updateExpanded=function(component,ariaInfo,status){set$1(component.element(),"aria-expanded",status)},ToggleSchema=[defaulted$1("selected",!1),option("toggleClass"),defaulted$1("toggleOnExecute",!0),defaultedOf("aria",{mode:"none"},choose$1("mode",{pressed:[defaulted$1("syncWithExpanded",!1),output("update",function(component,ariaInfo,status){set$1(component.element(),"aria-pressed",status),ariaInfo.syncWithExpanded&&updateExpanded(component,ariaInfo,status)})],checked:[output("update",function(component,ariaInfo,status){set$1(component.element(),"aria-checked",status)})],expanded:[output("update",updateExpanded)],selected:[output("update",function(component,ariaInfo,status){set$1(component.element(),"aria-selected",status)})],none:[output("update",noop)]}))],Toggling=create$1({fields:ToggleSchema,name:"toggling",active:ActiveToggle,apis:ToggleApis,state:(initialState=!1,{init:function(){var cell=Cell(initialState);return{get:function(){return cell.get()},set:function(newState){return cell.set(newState)},clear:function(){return cell.set(initialState)},readState:function(){return cell.get()}}}})}),hover=constant("alloy.item-hover"),focus$3=constant("alloy.item-focus"),schema$a=[strict$1("data"),strict$1("components"),strict$1("dom"),defaulted$1("hasSubmenu",!1),option("toggling"),SketchBehaviours_field("itemBehaviours",[Toggling,Focusing,Keying,Representing]),defaulted$1("ignoreFocus",!1),defaulted$1("domModification",{}),output("builder",function(detail){return{dom:detail.dom,domModification:__assign(__assign({},detail.domModification),{attributes:__assign(__assign(__assign({role:detail.toggling.isSome()?"menuitemcheckbox":"menuitem"},detail.domModification.attributes),{"aria-haspopup":detail.hasSubmenu}),detail.hasSubmenu?{"aria-expanded":!1}:{})}),behaviours:SketchBehaviours_augment(detail.itemBehaviours,[detail.toggling.fold(Toggling.revoke,function(tConfig){return Toggling.config(__assign({aria:{mode:"checked"}},tConfig))}),Focusing.config({ignore:detail.ignoreFocus,stopMousedown:detail.ignoreFocus,onFocus:function(component){onFocus(component)}}),Keying.config({mode:"execution"}),Representing.config({store:{mode:"memory",initialValue:detail.data}}),config("item-type-events",__spreadArrays(pointerEvents(),[run(mouseover(),onHover),run(focusItem(),Focusing.focus)]))]),components:detail.components,eventOrder:detail.eventOrder}}),defaulted$1("eventOrder",{})],schema$b=[strict$1("dom"),strict$1("components"),output("builder",function(detail){return{dom:detail.dom,components:detail.components,events:derive([function(name){return run(name,function(component,simulatedEvent){simulatedEvent.stop()})}(focusItem())])}})],parts=constant([required({name:"widget",overrides:function(detail){return{behaviours:derive$1([Representing.config({store:{mode:"manual",getValue:function(component){return detail.data},setValue:function(){}}})])}}})]),schema$c=[strict$1("uid"),strict$1("data"),strict$1("components"),strict$1("dom"),defaulted$1("autofocus",!1),defaulted$1("ignoreFocus",!1),SketchBehaviours_field("widgetBehaviours",[Representing,Focusing,Keying]),defaulted$1("domModification",{}),defaultUidsSchema(parts()),output("builder",function(detail){function focusWidget(component){return getPart(component,detail,"widget").map(function(widget){return Keying.focusIn(widget),widget})}function onHorizontalArrow(component,simulatedEvent){return inside(simulatedEvent.event().target())||detail.autofocus&&simulatedEvent.setSource(component.element()),Option.none()}var subs=substitutes(0,detail,parts()),components$1=components("item-widget",detail,subs.internals());return{dom:detail.dom,components:components$1,domModification:detail.domModification,events:derive([runOnExecute(function(component,simulatedEvent){focusWidget(component).each(function(widget){simulatedEvent.stop()})}),run(mouseover(),onHover),run(focusItem(),function(component,simulatedEvent){detail.autofocus?focusWidget(component):Focusing.focus(component)})]),behaviours:SketchBehaviours_augment(detail.widgetBehaviours,[Representing.config({store:{mode:"memory",initialValue:detail.data}}),Focusing.config({ignore:detail.ignoreFocus,onFocus:function(component){onFocus(component)}}),Keying.config({mode:"special",focusIn:detail.autofocus?function(component){focusWidget(component)}:revoke(),onLeft:onHorizontalArrow,onRight:onHorizontalArrow,onEscape:function(component,simulatedEvent){return Focusing.isFocused(component)||detail.autofocus?(detail.autofocus&&simulatedEvent.setSource(component.element()),Option.none()):(Focusing.focus(component),Option.some(!0))}})])}})],itemSchema$1=choose$1("type",{widget:schema$c,item:schema$a,separator:schema$b}),parts$1=constant([group({factory:{sketch:function(spec){var itemInfo=asRawOrDie("menu.spec item",itemSchema$1,spec);return itemInfo.builder(itemInfo)}},name:"items",unit:"item",defaults:function(detail,u){return u.hasOwnProperty("uid")?u:__assign(__assign({},u),{uid:generate$2("item")})},overrides:function(detail,u){return{type:u.type,ignoreFocus:detail.fakeFocus,domModification:{classes:[detail.markers.item]}}}})]),schema$d=constant([strict$1("value"),strict$1("items"),strict$1("dom"),strict$1("components"),defaulted$1("eventOrder",{}),field$1("menuBehaviours",[Highlighting,Representing,Composing,Keying]),defaultedOf("movement",{mode:"menu",moveOnTab:!0},choose$1("mode",{grid:[initSize(),output("config",function(detail,movementInfo){return{mode:"flatgrid",selector:"."+detail.markers.item,initSize:{numColumns:movementInfo.initSize.numColumns,numRows:movementInfo.initSize.numRows},focusManager:detail.focusManager}})],matrix:[output("config",function(detail,movementInfo){return{mode:"matrix",selectors:{row:movementInfo.rowSelector,cell:"."+detail.markers.item},focusManager:detail.focusManager}}),strict$1("rowSelector")],menu:[defaulted$1("moveOnTab",!0),output("config",function(detail,movementInfo){return{mode:"menu",selector:"."+detail.markers.item,moveOnTab:movementInfo.moveOnTab,focusManager:detail.focusManager}})]})),strictOf("markers",itemSchema()),defaulted$1("fakeFocus",!1),defaulted$1("focusManager",dom()),onHandler("onHighlight")]),focus$4=constant("alloy.menu-focus"),Menu=composite$1({name:"Menu",configFields:schema$d(),partFields:parts$1(),factory:function(detail,components,spec,externals){return{uid:detail.uid,dom:detail.dom,markers:detail.markers,behaviours:augment(detail.menuBehaviours,[Highlighting.config({highlightClass:detail.markers.selectedItem,itemClass:detail.markers.item,onHighlight:detail.onHighlight}),Representing.config({store:{mode:"memory",initialValue:detail.value}}),Composing.config({find:Option.some}),Keying.config(detail.movement.config(detail,detail.movement))]),events:derive([run(focus$3(),function(menu,simulatedEvent){var event=simulatedEvent.event();menu.getSystem().getByDom(event.target()).each(function(item){Highlighting.highlight(menu,item),simulatedEvent.stop(),emitWith(menu,focus$4(),{menu:menu,item:item})})}),run(hover(),function(menu,simulatedEvent){var item=simulatedEvent.event().item();Highlighting.highlight(menu,item)})]),components:components,eventOrder:detail.eventOrder,domModification:{attributes:{role:"menu"}}}}}),trace=function(items,byItem,byMenu,finish){return get(byMenu,finish).bind(function(triggerItem){return get(items,triggerItem).bind(function(triggerMenu){var rest=trace(items,byItem,byMenu,triggerMenu);return Option.some([triggerMenu].concat(rest))})}).getOr([])},extractPreparedMenu=function(prep){return"prepared"===prep.type?Option.some(prep.menu):Option.none()},LayeredState={init:function(){function getTriggerData(menuValue,getItemByValue,path){return getPreparedMenu(menuValue).bind(function(menu){return function(menuValue){return find$1(expansions.get(),function(v,k){return v===menuValue})}(menuValue).bind(function(triggeringItemValue){return getItemByValue(triggeringItemValue).map(function(triggeredItem){return{triggeredMenu:menu,triggeringItem:triggeredItem,triggeringPath:path}})})})}var expansions=Cell({}),menus=Cell({}),paths=Cell({}),primary=Cell(Option.none()),directory=Cell({}),getPreparedMenu=function(menuValue){return lookupMenu(menuValue).bind(extractPreparedMenu)},lookupMenu=function(menuValue){return get(menus.get(),menuValue)},lookupItem=function(itemValue){return get(expansions.get(),itemValue)};return{setMenuBuilt:function(menuName,built){var _a;menus.set(__assign(__assign({},menus.get()),((_a={})[menuName]={type:"prepared",menu:built},_a)))},setContents:function(sPrimary,sMenus,sExpansions,dir){primary.set(Option.some(sPrimary)),expansions.set(sExpansions),menus.set(sMenus),directory.set(dir);var sPaths=generate$5(dir,sExpansions);paths.set(sPaths)},expand:function(itemValue){return get(expansions.get(),itemValue).map(function(menu){var current=get(paths.get(),itemValue).getOr([]);return[menu].concat(current)})},refresh:function(itemValue){return get(paths.get(),itemValue)},collapse:function(itemValue){return get(paths.get(),itemValue).bind(function(path){return 1<path.length?Option.some(path.slice(1)):Option.none()})},lookupMenu:lookupMenu,lookupItem:lookupItem,otherMenus:function(path){var menuValues=directory.get();return difference(keys(menuValues),path)},getPrimary:function(){return primary.get().bind(getPreparedMenu)},getMenus:function(){return menus.get()},clear:function(){expansions.set({}),menus.set({}),paths.set({}),primary.set(Option.none())},isClear:function(){return primary.get().isNone()},getTriggeringPath:function(itemValue,getItemByValue){var extraPath=filter(lookupItem(itemValue).toArray(),function(menuValue){return getPreparedMenu(menuValue).isSome()});return get(paths.get(),itemValue).bind(function(path){var revPath=reverse(extraPath.concat(path));return function(arr){for(var r=[],i=0;i<arr.length;i++){var x=arr[i];if(!x.isSome())return Option.none();r.push(x.getOrDie())}return Option.some(r)}(bind(revPath,function(menuValue,menuIndex){return getTriggerData(menuValue,getItemByValue,revPath.slice(0,menuIndex+1)).fold(function(){return primary.get().is(menuValue)?[]:[Option.none()]},function(data){return[Option.some(data)]})}))})}}},extractPreparedMenu:extractPreparedMenu},collapseItem=constant("collapse-item"),tieredMenu=single$2({name:"TieredMenu",configFields:[onStrictKeyboardHandler("onExecute"),onStrictKeyboardHandler("onEscape"),onStrictHandler("onOpenMenu"),onStrictHandler("onOpenSubmenu"),onHandler("onRepositionMenu"),onHandler("onCollapseMenu"),defaulted$1("highlightImmediately",!0),strictObjOf("data",[strict$1("primary"),strict$1("menus"),strict$1("expansions")]),defaulted$1("fakeFocus",!1),onHandler("onHighlight"),onHandler("onHover"),tieredMenuMarkers(),strict$1("dom"),defaulted$1("navigateOnHover",!0),defaulted$1("stayInDom",!1),field$1("tmenuBehaviours",[Keying,Highlighting,Composing,Replacing]),defaulted$1("eventOrder",{})],apis:{collapseMenu:function(apis,tmenu){apis.collapseMenu(tmenu)},highlightPrimary:function(apis,tmenu){apis.highlightPrimary(tmenu)},repositionMenus:function(apis,tmenu){apis.repositionMenus(tmenu)}},factory:function(detail,rawUiSpec){function setup(container){var componentMap=function(container,primaryName,menus){return map$1(menus,function(spec,name){function makeSketch(){return Menu.sketch(__assign(__assign({dom:spec.dom},spec),{value:name,items:spec.items,markers:detail.markers,fakeFocus:detail.fakeFocus,onHighlight:detail.onHighlight,focusManager:detail.fakeFocus?highlights():dom()}))}return name===primaryName?{type:"prepared",menu:container.getSystem().build(makeSketch())}:{type:"notbuilt",nbMenu:makeSketch}})}(container,detail.data.primary,detail.data.menus),directory=toDirectory();return layeredState.setContents(detail.data.primary,componentMap,detail.data.expansions,directory),layeredState.getPrimary()}function getItemValue(item){return Representing.getValue(item).value}function setActiveMenu(container,menu){Highlighting.highlight(container,menu),Highlighting.getHighlighted(menu).orThunk(function(){return Highlighting.getFirst(menu)}).each(function(item){dispatch(container,item.element(),focusItem())})}function getMenus(state,menuValues){return cat(map(menuValues,function(mv){return state.lookupMenu(mv).bind(function(prep){return"prepared"===prep.type?Option.some(prep.menu):Option.none()})}))}function closeOthers(container,state,path){var others=getMenus(state,state.otherMenus(path));each(others,function(o){remove$5(o.element(),[detail.markers.backgroundMenu]),detail.stayInDom||Replacing.remove(container,o)})}function updateAriaExpansions(container,path){var parentItems=function(container){return submenuParentItems.get().getOrThunk(function(){var r={},items=descendants(container.element(),"."+detail.markers.item),parentItems=filter(items,function(i){return"true"===get$2(i,"aria-haspopup")});return each(parentItems,function(i){container.getSystem().getByDom(i).each(function(itemComp){var key=getItemValue(itemComp);r[key]=itemComp})}),submenuParentItems.set(Option.some(r)),r})}(container);each$1(parentItems,function(v,k){var expanded=contains(path,k);set$1(v.element(),"aria-expanded",expanded)})}function updateMenuPath(container,state,path){return Option.from(path[0]).bind(function(latestMenuName){return state.lookupMenu(latestMenuName).bind(function(menuPrep){if("notbuilt"===menuPrep.type)return Option.none();var activeMenu=menuPrep.menu,rest=getMenus(state,path.slice(1));return each(rest,function(r){add$2(r.element(),detail.markers.backgroundMenu)}),inBody(activeMenu.element())||Replacing.append(container,premade$1(activeMenu)),remove$5(activeMenu.element(),[detail.markers.backgroundMenu]),setActiveMenu(container,activeMenu),closeOthers(container,state,path),Option.some(activeMenu)})})}var ExpandHighlightDecision,submenuParentItems=Cell(Option.none()),layeredState=LayeredState.init(),toDirectory=function(container){return map$1(detail.data.menus,function(data,menuName){return bind(data.items,function(item){return"separator"===item.type?[]:[item.data.value]})})};!function(ExpandHighlightDecision){ExpandHighlightDecision[ExpandHighlightDecision.HighlightSubmenu=0]="HighlightSubmenu",ExpandHighlightDecision[ExpandHighlightDecision.HighlightParent=1]="HighlightParent"}(ExpandHighlightDecision=ExpandHighlightDecision||{});function expandRight(container,item,decision){void 0===decision&&(decision=ExpandHighlightDecision.HighlightSubmenu);var value=getItemValue(item);return layeredState.expand(value).bind(function(path){return updateAriaExpansions(container,path),Option.from(path[0]).bind(function(menuName){return layeredState.lookupMenu(menuName).bind(function(activeMenuPrep){var activeMenu=function(container,menuName,menuPrep){if("notbuilt"!==menuPrep.type)return menuPrep.menu;var menu=container.getSystem().build(menuPrep.nbMenu());return layeredState.setMenuBuilt(menuName,menu),menu}(container,menuName,activeMenuPrep);return inBody(activeMenu.element())||Replacing.append(container,premade$1(activeMenu)),detail.onOpenSubmenu(container,item,activeMenu,reverse(path)),decision===ExpandHighlightDecision.HighlightSubmenu?(Highlighting.highlightFirst(activeMenu),updateMenuPath(container,layeredState,path)):(Highlighting.dehighlightAll(activeMenu),Option.some(item))})})})}function collapseLeft(container,item){var value=getItemValue(item);return layeredState.collapse(value).bind(function(path){return updateAriaExpansions(container,path),updateMenuPath(container,layeredState,path).map(function(activeMenu){return detail.onCollapseMenu(container,item,activeMenu),activeMenu})})}function keyOnItem(f){return function(container,simulatedEvent){return closest$3(simulatedEvent.getSource(),"."+detail.markers.item).bind(function(target){return container.getSystem().getByDom(target).toOption().bind(function(item){return f(container,item).map(function(){return!0})})})}}function getActiveItem(container){return Highlighting.getHighlighted(container).bind(Highlighting.getHighlighted)}var events=derive([run(focus$4(),function(sandbox,simulatedEvent){var item=simulatedEvent.event().item();layeredState.lookupItem(getItemValue(item)).each(function(){var menu=simulatedEvent.event().menu();Highlighting.highlight(sandbox,menu);var value=getItemValue(simulatedEvent.event().item());layeredState.refresh(value).each(function(path){return closeOthers(sandbox,layeredState,path)})})}),runOnExecute(function(component,simulatedEvent){var target=simulatedEvent.event().target();component.getSystem().getByDom(target).each(function(item){0===getItemValue(item).indexOf("collapse-item")&&collapseLeft(component,item),expandRight(component,item,ExpandHighlightDecision.HighlightSubmenu).fold(function(){detail.onExecute(component,item)},function(){})})}),runOnAttached(function(container,simulatedEvent){setup(container).each(function(primary){Replacing.append(container,premade$1(primary)),detail.onOpenMenu(container,primary),detail.highlightImmediately&&setActiveMenu(container,primary)})})].concat(detail.navigateOnHover?[run(hover(),function(sandbox,simulatedEvent){var item=simulatedEvent.event().item();!function(container,item){var value=getItemValue(item);layeredState.refresh(value).bind(function(path){return updateAriaExpansions(container,path),updateMenuPath(container,layeredState,path)})}(sandbox,item),expandRight(sandbox,item,ExpandHighlightDecision.HighlightParent),detail.onHover(sandbox,item)})]:[])),apis={collapseMenu:function(container){getActiveItem(container).each(function(currentItem){collapseLeft(container,currentItem)})},highlightPrimary:function(container){layeredState.getPrimary().each(function(primary){setActiveMenu(container,primary)})},repositionMenus:function(container){layeredState.getPrimary().bind(function(primary){return getActiveItem(container).bind(function(currentItem){var itemValue=getItemValue(currentItem),allMenus=values(layeredState.getMenus()),preparedMenus=cat(map(allMenus,LayeredState.extractPreparedMenu));return layeredState.getTriggeringPath(itemValue,function(v){return function(container,menus,itemValue){return findMap(menus,function(menu){if(!menu.getSystem().isConnected())return Option.none();var candidates=Highlighting.getCandidates(menu);return find(candidates,function(c){return getItemValue(c)===itemValue})})}(0,preparedMenus,v)})}).map(function(triggeringPath){return{primary:primary,triggeringPath:triggeringPath}})}).fold(function(){(function(container){return Option.from(container.components()[0]).filter(function(comp){return"menu"===get$2(comp.element(),"role")})})(container).each(function(primaryMenu){detail.onRepositionMenu(container,primaryMenu,[])})},function(_a){var primary=_a.primary,triggeringPath=_a.triggeringPath;detail.onRepositionMenu(container,primary,triggeringPath)})}};return{uid:detail.uid,dom:detail.dom,markers:detail.markers,behaviours:augment(detail.tmenuBehaviours,[Keying.config({mode:"special",onRight:keyOnItem(function(container,item){return inside(item.element())?Option.none():expandRight(container,item,ExpandHighlightDecision.HighlightSubmenu)}),onLeft:keyOnItem(function(container,item){return inside(item.element())?Option.none():collapseLeft(container,item)}),onEscape:keyOnItem(function(container,item){return collapseLeft(container,item).orThunk(function(){return detail.onEscape(container,item).map(function(){return container})})}),focusIn:function(container,keyInfo){layeredState.getPrimary().each(function(primary){dispatch(container,primary.element(),focusItem())})}}),Highlighting.config({highlightClass:detail.markers.selectedMenu,itemClass:detail.markers.menu}),Composing.config({find:function(container){return Highlighting.getHighlighted(container)}}),Replacing.config({})]),eventOrder:detail.eventOrder,apis:apis,events:events}},extraApis:{tieredData:function(primary,menus,expansions){return{primary:primary,menus:menus,expansions:expansions}},singleData:function(name,menu){return{primary:name,menus:wrap$1(name,menu),expansions:{}}},collapseItem:function(text){return{value:generate$1(collapseItem()),meta:{text:text}}}}}),InlineView=single$2({name:"InlineView",configFields:[strict$1("lazySink"),onHandler("onShow"),onHandler("onHide"),optionFunction("onEscape"),field$1("inlineBehaviours",[Sandboxing,Representing,Receiving]),optionObjOf("fireDismissalEventInstead",[defaulted$1("event",dismissRequested())]),optionObjOf("fireRepositionEventInstead",[defaulted$1("event",repositionRequested())]),defaulted$1("getRelated",Option.none),defaulted$1("isExtraPart",never),defaulted$1("eventOrder",Option.none)],factory:function(detail,spec){function reposition(sandbox){Sandboxing.isOpen(sandbox)&&Representing.getValue(sandbox).each(function(state){switch(state.mode){case"menu":Sandboxing.getState(sandbox).each(function(tmenu){tieredMenu.repositionMenus(tmenu)});break;case"position":var sink=detail.lazySink(sandbox).getOrDie();Positioning.positionWithinBounds(sink,state.anchor,sandbox,state.getBounds())}})}var showWithin=function(sandbox,anchor,thing,boxElement){showWithinBounds(sandbox,anchor,thing,function(){return boxElement.map(function(elem){return box(elem)})})},showWithinBounds=function(sandbox,anchor,thing,getBounds){var sink=detail.lazySink(sandbox).getOrDie();Sandboxing.openWhileCloaked(sandbox,thing,function(){return Positioning.positionWithinBounds(sink,anchor,sandbox,getBounds())}),Representing.setValue(sandbox,Option.some({mode:"position",anchor:anchor,getBounds:getBounds}))},showMenuWithinBounds=function(sandbox,anchor,menuSpec,getBounds){var menu=makeMenu(detail,sandbox,anchor,menuSpec,getBounds);Sandboxing.open(sandbox,menu),Representing.setValue(sandbox,Option.some({mode:"menu",menu:menu}))},apis={setContent:function(sandbox,thing){Sandboxing.setContent(sandbox,thing)},showAt:function(sandbox,anchor,thing){showWithin(sandbox,anchor,thing,Option.none())},showWithin:showWithin,showWithinBounds:showWithinBounds,showMenuAt:function(sandbox,anchor,menuSpec){showMenuWithinBounds(sandbox,anchor,menuSpec,function(){return Option.none()})},showMenuWithinBounds:showMenuWithinBounds,hide:function(sandbox){Sandboxing.isOpen(sandbox)&&(Representing.setValue(sandbox,Option.none()),Sandboxing.close(sandbox))},getContent:function(sandbox){return Sandboxing.getState(sandbox)},reposition:reposition,isOpen:Sandboxing.isOpen};return{uid:detail.uid,dom:detail.dom,behaviours:augment(detail.inlineBehaviours,[Sandboxing.config({isPartOf:function(sandbox,data,queryElem){return isPartOf(data,queryElem)||function(sandbox,queryElem){return detail.getRelated(sandbox).exists(function(rel){return isPartOf(rel,queryElem)})}(sandbox,queryElem)},getAttachPoint:function(sandbox){return detail.lazySink(sandbox).getOrDie()},onOpen:function(sandbox){detail.onShow(sandbox)},onClose:function(sandbox){detail.onHide(sandbox)}}),Representing.config({store:{mode:"memory",initialValue:Option.none()}}),Receiving.config({channels:__assign(__assign({},receivingChannel(__assign({isExtraPart:spec.isExtraPart},detail.fireDismissalEventInstead.map(function(fe){return{fireEventInstead:{event:fe.event}}}).getOr({})))),receivingChannel$1(__assign(__assign({},detail.fireRepositionEventInstead.map(function(fe){return{fireEventInstead:{event:fe.event}}}).getOr({})),{doReposition:reposition})))})]),eventOrder:detail.eventOrder,apis:apis}},apis:{showAt:function(apis,component,anchor,thing){apis.showAt(component,anchor,thing)},showWithin:function(apis,component,anchor,thing,boxElement){apis.showWithin(component,anchor,thing,boxElement)},showWithinBounds:function(apis,component,anchor,thing,bounds){apis.showWithinBounds(component,anchor,thing,bounds)},showMenuAt:function(apis,component,anchor,menuSpec){apis.showMenuAt(component,anchor,menuSpec)},showMenuWithinBounds:function(apis,component,anchor,menuSpec,bounds){apis.showMenuWithinBounds(component,anchor,menuSpec,bounds)},hide:function(apis,component){apis.hide(component)},isOpen:function(apis,component){return apis.isOpen(component)},getContent:function(apis,component){return apis.getContent(component)},setContent:function(apis,component,thing){apis.setContent(component,thing)},reposition:function(apis,component){apis.reposition(component)}}}),north$3=function(anchor,element,bubbles){return nu$7(middleX$1(anchor,element),northY$2(anchor),bubbles.innerNorth(),south(),boundsRestriction(anchor,{top:2}),"layout-inner-n")},south$3=function(anchor,element,bubbles){return nu$7(middleX$1(anchor,element),southY$2(anchor,element),bubbles.innerSouth(),north(),boundsRestriction(anchor,{bottom:3}),"layout-inner-s")},global$2=tinymce.util.Tools.resolve("tinymce.util.Delay"),global$3=tinymce.util.Tools.resolve("tinymce.dom.DOMUtils"),global$4=tinymce.util.Tools.resolve("tinymce.EditorManager"),isMultipleToolbars=function(editor){return getMultipleToolbarsSetting(editor).fold(function(){return 0<editor.getParam("toolbar",[],"string[]").length},function(){return!0})};!function(ToolbarMode){ToolbarMode.default="wrap",ToolbarMode.floating="floating",ToolbarMode.sliding="sliding",ToolbarMode.scrolling="scrolling"}(ToolbarMode=ToolbarMode||{});function getToolbarMode(editor){return editor.getParam("toolbar_mode","","string")}var ToolbarLocation;!function(ToolbarLocation){ToolbarLocation.top="top",ToolbarLocation.bottom="bottom"}(ToolbarLocation=ToolbarLocation||{});function fixedContainerElement(editor){var selector=function(editor){return editor.getParam("fixed_toolbar_container","","string")}(editor);return 0<selector.length&&editor.inline?descendant$1(body(),selector):Option.none()}function useFixedContainer(editor){return editor.inline&&fixedContainerElement(editor).isSome()}function isDistractionFree(editor){return editor.inline&&!isMenubarEnabled(editor)&&!isToolbarEnabled(editor)&&!isMultipleToolbars(editor)}function record(spec){var uid=function(spec){return void 0!==spec.uid}(spec)&&hasNonNullableKey(spec,"uid")?spec.uid:generate$2("memento");return{get:function(anyInSystem){return anyInSystem.getSystem().getByUid(uid).getOrDie()},getOpt:function(anyInSystem){return anyInSystem.getSystem().getByUid(uid).toOption()},asSpec:function(){return __assign(__assign({},spec),{uid:uid})}}}function defaultIcon(icons){return Option.from(icons()["temporary-placeholder"]).getOr("!not found!")}function get$d(name,icons){return Option.from(icons()[name]).getOrThunk(function(){return defaultIcon(icons)})}var isToolbarLocationTop=function(editor){return editor.getParam("toolbar_location",ToolbarLocation.top,"string")!==ToolbarLocation.bottom},isStickyToolbar=function(editor){return(editor.getParam("toolbar_sticky",!1,"boolean")||editor.inline)&&!useFixedContainer(editor)&&!isDistractionFree(editor)},Button=single$2({name:"Button",factory:function(detail){function lookupAttr(attr){return get(detail.dom,"attributes").bind(function(attrs){return get(attrs,attr)})}var events=events$7(detail.action),tag=detail.dom.tag;return{uid:detail.uid,dom:detail.dom,components:detail.components,events:events,behaviours:SketchBehaviours_augment(detail.buttonBehaviours,[Focusing.config({}),Keying.config({mode:"execution",useSpace:!0,useEnter:!0})]),domModification:{attributes:function(){if("button"!==tag)return{role:lookupAttr("role").getOr("button")};var type=lookupAttr("type").getOr("button"),roleAttrs=lookupAttr("role").map(function(role){return{role:role}}).getOr({});return __assign({type:type},roleAttrs)}()},eventOrder:detail.eventOrder}},configFields:[defaulted$1("uid",void 0),strict$1("dom"),defaulted$1("components",[]),SketchBehaviours_field("buttonBehaviours",[Focusing,Keying]),option("action"),option("role"),defaulted$1("eventOrder",{})]}),notificationIconMap={success:"checkmark",error:"warning",err:"error",warning:"warning",warn:"warning",info:"info"},Notification=single$2({name:"Notification",factory:function(detail){function renderPercentBar(percent){return{dom:{tag:"div",classes:["tox-bar"],attributes:{style:"width: "+percent+"%"}}}}function renderPercentText(percent){return{dom:{tag:"div",classes:["tox-text"],innerHtml:percent+"%"}}}var memBannerText=record({dom:{tag:"p",innerHtml:detail.translationProvider(detail.text)},behaviours:derive$1([Replacing.config({})])}),memBannerProgress=record({dom:{tag:"div",classes:detail.progress?["tox-progress-bar","tox-progress-indicator"]:["tox-progress-bar"]},components:[{dom:{tag:"div",classes:["tox-bar-container"]},components:[renderPercentBar(0)]},renderPercentText(0)],behaviours:derive$1([Replacing.config({})])}),apis={updateProgress:function(comp,percent){comp.getSystem().isConnected()&&memBannerProgress.getOpt(comp).each(function(progress){Replacing.set(progress,[{dom:{tag:"div",classes:["tox-bar-container"]},components:[renderPercentBar(percent)]},renderPercentText(percent)])})},updateText:function(comp,text$1){if(comp.getSystem().isConnected()){var banner=memBannerText.get(comp);Replacing.set(banner,[text(text$1)])}}},iconChoices=flatten([detail.icon.toArray(),detail.level.toArray(),detail.level.bind(function(level){return Option.from(notificationIconMap[level])}).toArray()]);return{uid:detail.uid,dom:{tag:"div",attributes:{role:"alert"},classes:detail.level.map(function(level){return["tox-notification","tox-notification--in","tox-notification--"+level]}).getOr(["tox-notification","tox-notification--in"])},components:[{dom:{tag:"div",classes:["tox-notification__icon"],innerHtml:function(names,icons){return findMap(names,function(name){return Option.from(icons()[name])}).getOrThunk(function(){return defaultIcon(icons)})}(iconChoices,detail.iconProvider)}},{dom:{tag:"div",classes:["tox-notification__body"]},components:[memBannerText.asSpec()],behaviours:derive$1([Replacing.config({})])}].concat(detail.progress?[memBannerProgress.asSpec()]:[]).concat(detail.closeButton?[Button.sketch({dom:{tag:"button",classes:["tox-notification__dismiss","tox-button","tox-button--naked","tox-button--icon"]},components:[{dom:{tag:"div",classes:["tox-icon"],innerHtml:get$d("close",detail.iconProvider),attributes:{"aria-label":detail.translationProvider("Close")}}}],action:function(comp){detail.onAction(comp)}})]:[]),apis:apis}},configFields:[option("level"),strict$1("progress"),strict$1("icon"),strict$1("onAction"),strict$1("text"),strict$1("iconProvider"),strict$1("translationProvider"),defaultedBoolean("closeButton",!0)],apis:{updateProgress:function(apis,comp,percent){apis.updateProgress(comp,percent)},updateText:function(apis,comp,text){apis.updateText(comp,text)}}});function NotificationManagerImpl(editor,extras,uiMothership){var backstage=extras.backstage,isToolbarLocationTop$1=isToolbarLocationTop(editor);return{open:function(settings,closeCallback){function close(){closeCallback(),InlineView.hide(notificationWrapper)}var hideCloseButton=!settings.closeButton&&settings.timeout&&(0<settings.timeout||settings.timeout<0),notification=build$1(Notification.sketch({text:settings.text,level:contains(["success","error","warning","warn","info"],settings.type)?settings.type:void 0,progress:!0===settings.progressBar,icon:Option.from(settings.icon),closeButton:!hideCloseButton,onAction:close,iconProvider:backstage.shared.providers.icons,translationProvider:backstage.shared.providers.translate})),notificationWrapper=build$1(InlineView.sketch(__assign({dom:{tag:"div",classes:["tox-notifications-container"]},lazySink:extras.backstage.shared.getSink,fireDismissalEventInstead:{}},isToolbarLocationTop$1?{}:{fireRepositionEventInstead:{}})));return uiMothership.add(notificationWrapper),0<settings.timeout&&global$2.setTimeout(function(){close()},settings.timeout),{close:close,moveTo:function(x,y){InlineView.showAt(notificationWrapper,{anchor:"makeshift",x:x,y:y},premade$1(notification))},moveRel:function(element,rel){if("banner"!==rel){var layoutDirection_1=function(rel){switch(rel){case"bc-bc":return south$3;case"tc-tc":return north$3;case"tc-bc":return north$1;case"bc-tc":default:return south$1}}(rel),nodeAnchor={anchor:"node",root:body(),node:Option.some(Element.fromDom(element)),layouts:{onRtl:function(){return[layoutDirection_1]},onLtr:function(){return[layoutDirection_1]}}};InlineView.showAt(notificationWrapper,nodeAnchor,premade$1(notification))}else InlineView.showAt(notificationWrapper,extras.backstage.shared.anchors.banner(),premade$1(notification))},text:function(nuText){Notification.updateText(notification,nuText)},settings:settings,getEl:function(){return notification.element().dom()},progressBar:{value:function(percent){Notification.updateProgress(notification,percent)}}}},close:function(notification){notification.close()},reposition:function(notifications){!function(notifications){each(notifications,function(notification){return notification.moveTo(0,0)})}(notifications),function(notifications){0<notifications.length&&(head(notifications).each(function(firstItem){return firstItem.moveRel(null,"banner")}),each(notifications,function(notification,index){0<index&&notification.moveRel(notifications[index-1].getEl(),"bc-tc")}))}(notifications)},getArgs:function(notification){return notification.settings}}}function last$2(fn,rate){var timer=null;return{cancel:function(){null!==timer&&(domGlobals.clearTimeout(timer),timer=null)},throttle:function(){for(var args=[],_i=0;_i<arguments.length;_i++)args[_i]=arguments[_i];null!==timer&&domGlobals.clearTimeout(timer),timer=domGlobals.setTimeout(function(){fn.apply(null,args),timer=null},rate)}}}function repeatLeft(dom,node,offset,process,rootNode){var search=global$5(dom,function(node){return function(dom,node){return dom.isBlock(node)||contains(["BR","IMG","HR","INPUT"],node.nodeName)||"false"===dom.getContentEditable(node)}(dom,node)});return Option.from(search.backwards(node,offset,process,rootNode))}function create$4(editor,range){return detect$4(Element.fromDom(editor.selection.getNode())).getOrThunk(function(){var wrapper=Element.fromHtml('<span data-mce-autocompleter="1" data-mce-bogus="1"></span>',editor.getDoc());return append(wrapper,Element.fromDom(range.extractContents())),range.insertNode(wrapper.dom()),parent(wrapper).each(function(elm){return elm.dom().normalize()}),function(element){return descendantRtl(element,isCursorPosition)}(wrapper).map(function(last){editor.selection.setCursorLocation(last.dom(),function(element){return"img"===name(element)?1:getOption(element).fold(function(){return children(element).length},function(v){return v.length})}(last))}),wrapper})}function getText(rng){return rng.toString().replace(/\u00A0/g," ").replace(/\uFEFF/g,"")}function isWhitespace(chr){return""!==chr&&-1!==" \f\n\r\t\v".indexOf(chr)}function stripTriggerChar(text,triggerCh){return text.substring(triggerCh.length)}function findStart(dom,initRange,ch,minChars){if(void 0===minChars&&(minChars=0),!function(rng){return rng.collapsed&&3===rng.startContainer.nodeType}(initRange))return Option.none();var root=dom.getParent(initRange.startContainer,dom.isBlock)||dom.getRoot();return repeatLeft(dom,initRange.startContainer,initRange.startOffset,function(element,offset,text){return function(text,index,ch){var i;for(i=index-1;0<=i;i--){var char=text.charAt(i);if(isWhitespace(char))return Option.none();if(char===ch)break}return Option.some(i)}(text,offset,ch).getOr(offset)},root).bind(function(spot){var range=initRange.cloneRange();if(range.setStart(spot.container,spot.offset),range.setEnd(initRange.endContainer,initRange.endOffset),range.collapsed)return Option.none();var text=getText(range);return 0!==text.lastIndexOf(ch)||stripTriggerChar(text,ch).length<minChars?Option.none():Option.some({text:stripTriggerChar(text,ch),range:range,triggerChar:ch})})}function getContext(dom,initRange,ch,minChars){return void 0===minChars&&(minChars=0),detect$4(Element.fromDom(initRange.startContainer)).fold(function(){return findStart(dom,initRange,ch,minChars)},function(elm){var range=dom.createRng();range.selectNode(elm.dom());var text=getText(range);return Option.some({range:range,text:stripTriggerChar(text,ch),triggerChar:ch})})}function point$2(container,offset){return{container:container,offset:offset}}function isStartOfWord(dom){return function(rng){var leaf=toLeaf(rng.startContainer,rng.startOffset);return!function(dom,leaf){return repeatLeft(dom,leaf.container,leaf.offset,function(element,offset){return 0===offset?-1:offset},dom.getRoot()).filter(function(spot){var char=spot.container.data.charAt(spot.offset-1);return!isWhitespace(char)}).isSome()}(dom,leaf)}}function lookup(editor,getDatabase){var database=getDatabase(),rng=editor.selection.getRng();return function(dom,initRange,database){return findMap(database.triggerChars,function(ch){return getContext(dom,initRange,ch)})}(editor.dom,rng,database).bind(function(context){return lookupWithContext(editor,getDatabase,context)})}function register(editor){var popups=editor.ui.registry.getAll().popups,dataset=map$1(popups,function(popup){return function(spec){return asRaw("Autocompleter",autocompleterSchema,spec)}(popup).fold(function(err){throw new Error(formatError(err))},function(x){return x})}),triggerChars=function(a){var all={};return each(a,function(key){all[key]={}}),keys(all)}(mapToArray(dataset,function(v){return v.ch})),datasetValues=values(dataset);return{dataset:dataset,triggerChars:triggerChars,lookupByChar:function(ch){return filter(datasetValues,function(dv){return dv.ch===ch})}}}function detectSize(comp,margin,selectorClass){var descendants$1=descendants(comp.element(),"."+selectorClass);if(0<descendants$1.length){var columnLength=findIndex(descendants$1,function(c){var thisTop=c.dom().getBoundingClientRect().top,cTop=descendants$1[0].dom().getBoundingClientRect().top;return Math.abs(thisTop-cTop)>margin}).getOr(descendants$1.length);return Option.some({numColumns:columnLength,numRows:Math.ceil(descendants$1.length/columnLength)})}return Option.none()}function namedEvents(name,handlers){return derive$1([config(name,handlers)])}function hideAllExclusive(component,tConfig,tState){component.getSystem().broadcastOn([ExclusivityChannel],{})}function classForPreset(presets){return get(presetClasses,presets).getOr(navClass)}function renderIcon(iconHtml){return{dom:{tag:"div",classes:["tox-collection__item-icon"],innerHtml:iconHtml}}}function renderText(text$1){return{dom:{tag:"div",classes:[textClass]},components:[text(global$7.translate(text$1))]}}function renderStyledText(style,text$1){return{dom:{tag:"div",classes:[textClass]},components:[{dom:{tag:style.tag,styles:style.styles},components:[text(global$7.translate(text$1))]}]}}function renderShortcut(shortcut){return{dom:{tag:"div",classes:["tox-collection__item-accessory"],innerHtml:ConvertShortcut_convertText(shortcut)}}}function renderCheckmark(icons){return{dom:{tag:"div",classes:["tox-collection__item-icon","tox-collection__item-checkmark"],innerHtml:get$d("checkmark",icons)}}}function renderNormalItemStructure(info,icon,renderIcons,textRender,rtlClass){var leftIcon=renderIcons?info.checkMark.orThunk(function(){return icon.or(Option.some("")).map(renderIcon)}):Option.none(),domTitle=info.ariaLabel.map(function(label){return{attributes:{title:global$7.translate(label)}}}).getOr({});return{dom:__assign({tag:"div",classes:[navClass,selectableClass].concat(rtlClass?["tox-collection__item-icon-rtl"]:[])},domTitle),optComponents:[leftIcon,info.htmlContent.fold(function(){return info.textContent.map(textRender)},function(html){return Option.some(function(html){return{dom:{tag:"div",classes:[textClass],innerHtml:html}}}(html))}),info.shortcutContent.map(renderShortcut),info.caret]}}function renderItemStructure(info,providersBackstage,renderIcons,fallbackIcon){void 0===fallbackIcon&&(fallbackIcon=Option.none());var needRtlClass=global$7.isRtl()&&info.iconContent.exists(function(name){return contains(rtlTransform,name)}),icon=info.iconContent.map(function(name){return global$7.isRtl()&&contains(rtlIcon,name)?name+"-rtl":name}).map(function(iconName){return function(name,icons,fallback){return Option.from(icons()[name]).or(fallback).getOrThunk(function(){return defaultIcon(icons)})}(iconName,providersBackstage.icons,fallbackIcon)}),textRender=Option.from(info.meta).fold(function(){return renderText},function(meta){return has(meta,"style")?curry(renderStyledText,meta.style):renderText});return"color"===info.presets?function(itemText,itemValue,iconSvg,providerBackstage){var icon,baseDom;return{dom:(icon=iconSvg.getOr(""),baseDom={tag:"div",attributes:itemText.map(function(text){return{title:providerBackstage.translate(text)}}).getOr({}),classes:["tox-swatch"]},__assign(__assign({},baseDom),"custom"===itemValue?{tag:"button",classes:__spreadArrays(baseDom.classes,["tox-swatches__picker-btn"]),innerHtml:icon}:"remove"===itemValue?{classes:__spreadArrays(baseDom.classes,["tox-swatch--remove"]),innerHtml:icon}:{attributes:__assign(__assign({},baseDom.attributes),{"data-mce-color":itemValue}),styles:{"background-color":itemValue}})),optComponents:[]}}(info.ariaLabel,info.value,icon,providersBackstage):renderNormalItemStructure(info,icon,renderIcons,textRender,needRtlClass)}function onLoad$5(component,disableConfig,disableState){disableConfig.disabled&&disable(component,disableConfig)}function hasNative(component,config){return!0===config.useNative&&contains(nativeDisabled,name(component.element()))}function nativeDisable(component){set$1(component.element(),"disabled","disabled")}function nativeEnable(component){remove$1(component.element(),"disabled")}function ariaDisable(component){set$1(component.element(),"aria-disabled","true")}function ariaEnable(component){set$1(component.element(),"aria-disabled","false")}function enable(component,disableConfig,disableState){disableConfig.disableClass.each(function(disableClass){remove$4(component.element(),disableClass)}),(hasNative(component,disableConfig)?nativeEnable:ariaEnable)(component),disableConfig.onEnabled(component)}function isDisabled(component,disableConfig){return hasNative(component,disableConfig)?function(component){return has$1(component.element(),"disabled")}(component):function(component){return"true"===get$2(component.element(),"aria-disabled")}(component)}function runWithApi(info,comp){var api=info.getApi(comp);return function(f){f(api)}}function onControlAttached(info,editorOffCell){return runOnAttached(function(comp){runWithApi(info,comp)(function(api){var onDestroy=info.onSetup(api);null!=onDestroy&&editorOffCell.set(onDestroy)})})}function onControlDetached(getApi,editorOffCell){return runOnDetached(function(comp){return runWithApi(getApi,comp)(editorOffCell.get())})}var ItemResponse,global$5=tinymce.util.Tools.resolve("tinymce.dom.TextSeeker"),detect$4=function(elm){return closest$3(elm,"[data-mce-autocompleter]")},AutocompleterEditorEvents_setup=function(api,editor){editor.on("keypress compositionend",api.onKeypress.throttle),editor.on("remove",api.onKeypress.cancel);function redirectKeyToItem(item,e){emitWith(item,keydown(),{raw:e})}editor.on("keydown",function(e){function getItem(){return api.getView().bind(Highlighting.getHighlighted)}8===e.which&&api.onKeypress.throttle(e),api.isActive()&&(27===e.which&&api.cancelIfNecessary(),api.isMenuOpen()?13===e.which?(getItem().each(emitExecute),e.preventDefault()):40===e.which?(getItem().fold(function(){api.getView().each(Highlighting.highlightFirst)},function(item){redirectKeyToItem(item,e)}),e.preventDefault(),e.stopImmediatePropagation()):37!==e.which&&38!==e.which&&39!==e.which||getItem().each(function(item){redirectKeyToItem(item,e),e.preventDefault(),e.stopImmediatePropagation()}):13!==e.which&&38!==e.which&&40!==e.which||api.cancelIfNecessary())}),editor.on("NodeChange",function(e){api.isActive()&&!api.isProcessingAction()&&detect$4(Element.fromDom(e.element)).isNone()&&api.cancelIfNecessary()})},global$6=tinymce.util.Tools.resolve("tinymce.util.Promise"),toLast=function(node){if(function(node){return node.nodeType===domGlobals.Node.TEXT_NODE}(node))return point$2(node,node.data.length);var children=node.childNodes;return 0<children.length?toLast(children[children.length-1]):point$2(node,children.length)},toLeaf=function(node,offset){var children=node.childNodes;return 0<children.length&&offset<children.length?toLeaf(children[offset],0):0<children.length&&function(node){return node.nodeType===domGlobals.Node.ELEMENT_NODE}(node)&&children.length===offset?toLast(children[children.length-1]):point$2(node,offset)},lookupWithContext=function(editor,getDatabase,context,fetchOptions){void 0===fetchOptions&&(fetchOptions={});var database=getDatabase(),startText=editor.selection.getRng().startContainer.nodeValue,autocompleters=filter(database.lookupByChar(context.triggerChar),function(autocompleter){return context.text.length>=autocompleter.minChars&&autocompleter.matches.getOrThunk(function(){return isStartOfWord(editor.dom)})(context.range,startText,context.text)});if(0===autocompleters.length)return Option.none();var lookupData=global$6.all(map(autocompleters,function(ac){return ac.fetch(context.text,ac.maxResults,fetchOptions).then(function(results){return{matchText:context.text,items:results,columns:ac.columns,onAction:ac.onAction}})}));return Option.some({lookupData:lookupData,context:context})},separatorMenuItemSchema=objOf([strictString("type"),optionString("text")]),autocompleterItemSchema=objOf([state$1("type",function(){return"autocompleteitem"}),state$1("active",function(){return!1}),state$1("disabled",function(){return!1}),defaulted$1("meta",{}),strictString("value"),optionString("text"),optionString("icon")]),autocompleterSchema=objOf([strictString("type"),strictString("ch"),defaultedNumber("minChars",1),defaulted$1("columns",1),defaultedNumber("maxResults",10),optionFunction("matches"),strictFunction("fetch"),strictFunction("onAction")]),commonMenuItemFields=[defaultedBoolean("disabled",!1),optionString("text"),optionString("shortcut"),field("value","value",defaultedThunk(function(){return generate$1("menuitem-value")}),anyValue$1()),defaulted$1("meta",{})],menuItemSchema=objOf([strictString("type"),defaultedFunction("onSetup",function(){return noop}),defaultedFunction("onAction",noop),optionString("icon")].concat(commonMenuItemFields)),nestedMenuItemSchema=objOf([strictString("type"),strictFunction("getSubmenuItems"),defaultedFunction("onSetup",function(){return noop}),optionString("icon")].concat(commonMenuItemFields)),toggleMenuItemSchema=objOf([strictString("type"),defaultedBoolean("active",!1),defaultedFunction("onSetup",function(){return noop}),strictFunction("onAction")].concat(commonMenuItemFields)),choiceMenuItemSchema=objOf([strictString("type"),defaultedBoolean("active",!1),optionString("icon")].concat(commonMenuItemFields)),fancyMenuItemSchema=objOf([strictString("type"),strictStringEnum("fancytype",["inserttable","colorswatch"]),defaultedFunction("onAction",noop)]),SimpleBehaviours_unnamedEvents=function(handlers){return namedEvents(generate$1("unnamed-events"),handlers)},TooltippingSchema=[strict$1("lazySink"),strict$1("tooltipDom"),defaulted$1("exclusive",!0),defaulted$1("tooltipComponents",[]),defaulted$1("delay",300),defaultedStringEnum("mode","normal",["normal","follow-highlight"]),defaulted$1("anchor",function(comp){return{anchor:"hotspot",hotspot:comp,layouts:{onLtr:constant([south$1,north$1,southeast$1,northeast$1,southwest$1,northwest$1]),onRtl:constant([south$1,north$1,southeast$1,northeast$1,southwest$1,northwest$1])}}}),onHandler("onHide"),onHandler("onShow")],TooltippingState=Object.freeze({__proto__:null,init:function(){function clearTimer(){timer.get().each(function(t){domGlobals.clearTimeout(t)})}var timer=Cell(Option.none()),popup=Cell(Option.none()),readState=constant("not-implemented");return nu$5({getTooltip:function(){return popup.get()},isShowing:function(){return popup.get().isSome()},setTooltip:function(comp){popup.set(Option.some(comp))},clearTooltip:function(){popup.set(Option.none())},clearTimer:clearTimer,resetTimer:function(f,delay){clearTimer(),timer.set(Option.some(domGlobals.setTimeout(function(){f()},delay)))},readState:readState})}}),ExclusivityChannel=generate$1("tooltip.exclusive"),ShowTooltipEvent=generate$1("tooltip.show"),HideTooltipEvent=generate$1("tooltip.hide"),TooltippingApis=Object.freeze({__proto__:null,hideAllExclusive:hideAllExclusive,setComponents:function(component,tConfig,tState,specs){tState.getTooltip().each(function(tooltip){tooltip.getSystem().isConnected()&&Replacing.set(tooltip,specs)})}}),Tooltipping=create$1({fields:TooltippingSchema,name:"tooltipping",active:Object.freeze({__proto__:null,events:function(tooltipConfig,state){function hide(comp){state.getTooltip().each(function(p){detach(p),tooltipConfig.onHide(comp,p),state.clearTooltip()}),state.clearTimer()}return derive(flatten([[run(ShowTooltipEvent,function(comp){state.resetTimer(function(){!function(comp){if(!state.isShowing()){hideAllExclusive(comp);var sink=tooltipConfig.lazySink(comp).getOrDie(),popup=comp.getSystem().build({dom:tooltipConfig.tooltipDom,components:tooltipConfig.tooltipComponents,events:derive("normal"===tooltipConfig.mode?[run(mouseover(),function(_){emit(comp,ShowTooltipEvent)}),run(mouseout(),function(_){emit(comp,HideTooltipEvent)})]:[]),behaviours:derive$1([Replacing.config({})])});state.setTooltip(popup),attach$1(sink,popup),tooltipConfig.onShow(comp,popup),Positioning.position(sink,tooltipConfig.anchor(comp),popup)}}(comp)},tooltipConfig.delay)}),run(HideTooltipEvent,function(comp){state.resetTimer(function(){hide(comp)},tooltipConfig.delay)}),run(receive(),function(comp,message){contains(message.channels(),ExclusivityChannel)&&hide(comp)}),runOnDetached(function(comp){hide(comp)})],"normal"===tooltipConfig.mode?[run(focusin(),function(comp){emit(comp,ShowTooltipEvent)}),run(postBlur(),function(comp){emit(comp,HideTooltipEvent)}),run(mouseover(),function(comp){emit(comp,ShowTooltipEvent)}),run(mouseout(),function(comp){emit(comp,HideTooltipEvent)})]:[run(highlight(),function(comp,se){emit(comp,ShowTooltipEvent)}),run(dehighlight(),function(comp){emit(comp,HideTooltipEvent)})]]))}}),state:TooltippingState,apis:TooltippingApis}),global$7=tinymce.util.Tools.resolve("tinymce.util.I18n"),navClass="tox-menu-nav__js",selectableClass="tox-collection__item",presetClasses={normal:navClass,color:"tox-swatch"},textClass="tox-collection__item-label",activeClass="tox-collection__item--active",global$8=tinymce.util.Tools.resolve("tinymce.Env"),ConvertShortcut_convertText=function(source){var replace=global$8.mac?{alt:"&#x2325;",ctrl:"&#x2303;",shift:"&#x21E7;",meta:"&#x2318;",access:"&#x2303;&#x2325;"}:{meta:"Ctrl",access:"Shift+Alt"},shortcut=source.split("+"),updated=map(shortcut,function(segment){var search=segment.toLowerCase().trim();return has(replace,search)?replace[search]:segment});return global$8.mac?updated.join(""):updated.join("+")},rtlIcon=["list-num-default","list-num-lower-alpha","list-num-lower-greek","list-num-lower-roman","list-num-upper-alpha","list-num-upper-roman"],rtlTransform=["list-bull-circle","list-bull-default","list-bull-square"],nativeDisabled=["input","button","textarea","select"],disable=function(component,disableConfig,disableState){disableConfig.disableClass.each(function(disableClass){add$2(component.element(),disableClass)}),(hasNative(component,disableConfig)?nativeDisable:ariaDisable)(component),disableConfig.onDisabled(component)},DisableApis=Object.freeze({__proto__:null,enable:enable,disable:disable,isDisabled:isDisabled,onLoad:onLoad$5,set:function(component,disableConfig,disableState,disabled){(disabled?disable:enable)(component,disableConfig,disableState)}}),ActiveDisable=Object.freeze({__proto__:null,exhibit:function(base,disableConfig){return nu$6({classes:disableConfig.disabled?disableConfig.disableClass.map(pure).getOr([]):[]})},events:function(disableConfig,disableState){return derive([abort(execute(),function(component,simulatedEvent){return isDisabled(component,disableConfig)}),loadEvent(disableConfig,disableState,onLoad$5)])}}),DisableSchema=[defaulted$1("disabled",!1),defaulted$1("useNative",!0),option("disableClass"),onHandler("onDisabled"),onHandler("onEnabled")],Disabling=create$1({fields:DisableSchema,name:"disabling",active:ActiveDisable,apis:DisableApis}),DisablingConfigs_item=function(disabled){return Disabling.config({disabled:disabled,disableClass:"tox-collection__item--state-disabled"})},DisablingConfigs_button=function(disabled){return Disabling.config({disabled:disabled})},DisablingConfigs_splitButton=function(disabled){return Disabling.config({disabled:disabled,disableClass:"tox-tbtn--disabled"})},DisablingConfigs_toolbarButton=function(disabled){return Disabling.config({disabled:disabled,disableClass:"tox-tbtn--disabled",useNative:!1})};!function(ItemResponse){ItemResponse[ItemResponse.CLOSE_ON_EXECUTE=0]="CLOSE_ON_EXECUTE",ItemResponse[ItemResponse.BUBBLE_TO_SANDBOX=1]="BUBBLE_TO_SANDBOX"}(ItemResponse=ItemResponse||{});function componentRenderPipeline(xs){return bind(xs,function(o){return o.toArray()})}function renderCommonItem(spec,structure,itemResponse){var editorOffCell=Cell(noop);return{type:"item",dom:structure.dom,components:componentRenderPipeline(structure.optComponents),data:spec.data,eventOrder:menuItemEventOrder,hasSubmenu:spec.triggersSubmenu,itemBehaviours:derive$1([config("item-events",[function(info,itemResponse){return runOnExecute(function(comp,simulatedEvent){runWithApi(info,comp)(info.onAction),info.triggersSubmenu||itemResponse!==ItemResponse$1.CLOSE_ON_EXECUTE||(emit(comp,sandboxClose()),simulatedEvent.stop())})}(spec,itemResponse),onControlAttached(spec,editorOffCell),onControlDetached(spec,editorOffCell)]),DisablingConfigs_item(spec.disabled),Replacing.config({})].concat(spec.itemBehaviours))}}function buildData(source){return{value:source.value,meta:__assign({text:source.text.getOr("")},source.meta)}}function replaceText(text,matchText){var encoded=function(text){return global$3.DOM.encode(text)}(global$7.translate(text));if(0<matchText.length){var escapedMatchRegex=new RegExp(function(text){return text.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}(matchText),"gi");return encoded.replace(escapedMatchRegex,function(match){return'<span class="tox-autocompleter-highlight">'+match+"</span>"})}return encoded}function makeCell(row,col,labelId){function emitExecute(c){return emitWith(c,cellExecuteEvent,{row:row,col:col})}function onClick(c,se){se.stop(),emitExecute(c)}var _a;return build$1({dom:{tag:"div",attributes:(_a={role:"button"},_a["aria-labelledby"]=labelId,_a)},behaviours:derive$1([config("insert-table-picker-cell",[run(mouseover(),Focusing.focus),run(execute(),emitExecute),run(click(),onClick),run(tap(),onClick)]),Toggling.config({toggleClass:"tox-insert-table-picker__selected",toggleOnExecute:!1}),Focusing.config({onFocus:function(c){return emitWith(c,cellOverEvent,{row:row,col:col})}})])})}var ItemResponse$1=ItemResponse,menuItemEventOrder={"alloy.execute":["disabling","alloy.base.behaviour","toggling","item-events"]},parts$2=constant(generate$4("item-widget",parts())),cellOverEvent=generate$1("cell-over"),cellExecuteEvent=generate$1("cell-execute");function hexColour(hexString){return{value:constant(hexString)}}function isHexString(hex){return shorthandRegex.test(hex)||longformRegex.test(hex)}function extractValues(hex){var longForm=function(hex){var hexString=hex.value().replace(shorthandRegex,function(m,r,g,b){return r+r+g+g+b+b});return{value:constant(hexString)}}(hex),splitForm=longformRegex.exec(longForm.value());return null===splitForm?["FFFFFF","FF","FF","FF"]:splitForm}function toHex(component){var hex=component.toString(16);return 1===hex.length?"0"+hex:hex}function fromRgba(rgbaColour){var value=toHex(rgbaColour.red())+toHex(rgbaColour.green())+toHex(rgbaColour.blue());return hexColour(value)}function rgbaColour(red,green,blue,alpha){return{red:constant(red),green:constant(green),blue:constant(blue),alpha:constant(alpha)}}function isRgbaComponent(value){var num=parseInt(value,10);return num.toString()===value&&0<=num&&num<=255}function fromHsv(hsv){var r,g,b,hue=(hsv.hue()||0)%360,saturation=hsv.saturation()/100,brightness=hsv.value()/100;if(saturation=max(0,min(saturation,1)),brightness=max(0,min(brightness,1)),0===saturation)return r=g=b=round(255*brightness),rgbaColour(r,g,b,1);var side=hue/60,chroma=brightness*saturation,x=chroma*(1-Math.abs(side%2-1)),match=brightness-chroma;switch(Math.floor(side)){case 0:r=chroma,g=x,b=0;break;case 1:r=x,g=chroma,b=0;break;case 2:r=0,g=chroma,b=x;break;case 3:r=0,g=x,b=chroma;break;case 4:r=x,g=0,b=chroma;break;case 5:r=chroma,g=0,b=x;break;default:r=g=b=0}return r=round(255*(r+match)),g=round(255*(g+match)),b=round(255*(b+match)),rgbaColour(r,g,b,1)}function fromHex(hexColour){var result=extractValues(hexColour),red=parseInt(result[1],16),green=parseInt(result[2],16),blue=parseInt(result[3],16);return rgbaColour(red,green,blue,1)}function fromStringValues(red,green,blue,alpha){var r=parseInt(red,10),g=parseInt(green,10),b=parseInt(blue,10),a=parseFloat(alpha);return rgbaColour(r,g,b,a)}function toString(rgba){return"rgba("+rgba.red()+","+rgba.green()+","+rgba.blue()+","+rgba.alpha()+")"}var shorthandRegex=/^#?([a-f\d])([a-f\d])([a-f\d])$/i,longformRegex=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i,min=Math.min,max=Math.max,round=Math.round,rgbRegex=/^rgb\((\d+),\s*(\d+),\s*(\d+)\)/,rgbaRegex=/^rgba\((\d+),\s*(\d+),\s*(\d+),\s*(\d?(?:\.\d+)?)\)/,redColour=constant(rgbaColour(255,0,0,1)),global$9=tinymce.util.Tools.resolve("tinymce.util.LocalStorage");function mapColors(colorMap){var colors=[],canvas=domGlobals.document.createElement("canvas");canvas.height=1,canvas.width=1;for(var ctx=canvas.getContext("2d"),byteAsHex=function(colorByte,alphaByte){var alpha=alphaByte/255;return("0"+Math.round(colorByte*alpha+255*(1-alpha)).toString(16)).slice(-2).toUpperCase()},asHexColor=function(color){if(/^[0-9A-Fa-f]{6}$/.test(color))return"#"+color.toUpperCase();ctx.clearRect(0,0,canvas.width,canvas.height),ctx.fillStyle="#FFFFFF",ctx.fillStyle=color,ctx.fillRect(0,0,1,1);var rgba=ctx.getImageData(0,0,1,1).data,r=rgba[0],g=rgba[1],b=rgba[2],a=rgba[3];return"#"+byteAsHex(r,a)+byteAsHex(g,a)+byteAsHex(b,a)},i=0;i<colorMap.length;i+=2)colors.push({text:colorMap[i+1],value:asHexColor(colorMap[i]),type:"choiceitem"});return colors}function getColorMap(editor){return editor.getParam("color_map")}function getCurrentColor(editor,format){var color;return editor.dom.getParents(editor.selection.getStart(),function(elm){var value;(value=elm.style["forecolor"===format?"color":"background-color"])&&(color=color||value)}),color}function calcCols(colors){return Math.max(5,Math.ceil(Math.sqrt(colors)))}function getColorCols$1(editor){var colors=Settings_getColors(editor),defaultCols=calcCols(colors.length);return Settings_getColorCols(editor,defaultCols)}function applyColor(editor,format,value,onChoice){"custom"===value?colorPickerDialog(editor)(function(colorOpt){colorOpt.each(function(color){Settings_addColor(color),editor.execCommand("mceApplyTextcolor",format,color),onChoice(color)})},"#000000"):"remove"===value?(onChoice(""),editor.execCommand("mceRemoveTextcolor",format)):(onChoice(value),editor.execCommand("mceApplyTextcolor",format,value))}function getMenuColors(colors,hasCustom){return colors.concat(Settings_getCurrentColors().concat(function(hasCustom){var remove={type:"choiceitem",text:"Remove color",icon:"color-swatch-remove-color",value:"remove"};return hasCustom?[remove,{type:"choiceitem",text:"Custom color",icon:"color-picker",value:"custom"}]:[remove]}(hasCustom)))}function getFetch(colors,hasCustom){return function(callback){callback(getMenuColors(colors,hasCustom))}}function setIconColor(splitButtonApi,name,newColor){var pathId,color;pathId="forecolor"===name?"tox-icon-text-color__color":"tox-icon-highlight-bg-color__color",color=newColor,splitButtonApi.setIconFill(pathId,color),splitButtonApi.setIconStroke(pathId,color)}function registerTextColorButton(editor,name,format,tooltip,lastColor){editor.ui.registry.addSplitButton(name,{tooltip:tooltip,presets:"color",icon:"forecolor"===name?"text-color":"highlight-bg-color",select:function(value){return Option.from(getCurrentColor(editor,format)).bind(function(currentRgb){return function(rgbaString){if("transparent"===rgbaString)return Option.some(rgbaColour(0,0,0,0));var rgbMatch=rgbRegex.exec(rgbaString);if(null!==rgbMatch)return Option.some(fromStringValues(rgbMatch[1],rgbMatch[2],rgbMatch[3],"1"));var rgbaMatch=rgbaRegex.exec(rgbaString);return null!==rgbaMatch?Option.some(fromStringValues(rgbaMatch[1],rgbaMatch[2],rgbaMatch[3],rgbaMatch[4])):Option.none()}(currentRgb).map(function(rgba){var currentHex=fromRgba(rgba).value();return contains$1(value.toLowerCase(),currentHex)})}).getOr(!1)},columns:getColorCols$1(editor),fetch:getFetch(Settings_getColors(editor),Settings_hasCustomColors(editor)),onAction:function(splitButtonApi){null!==lastColor.get()&&applyColor(editor,format,lastColor.get(),function(){})},onItemAction:function(splitButtonApi,value){applyColor(editor,format,value,function(newColor){lastColor.set(newColor),Events_fireTextColorChange(editor,{name:name,color:newColor})})},onSetup:function(splitButtonApi){null!==lastColor.get()&&setIconColor(splitButtonApi,name,lastColor.get());function handler(e){e.name===name&&setIconColor(splitButtonApi,e.name,e.color)}return editor.on("TextColorChange",handler),function(){editor.off("TextColorChange",handler)}}})}function registerTextColorMenuItem(editor,name,format,text){editor.ui.registry.addNestedMenuItem(name,{text:text,icon:"forecolor"===name?"text-color":"highlight-bg-color",getSubmenuItems:function(){return[{type:"fancymenuitem",fancytype:"colorswatch",onAction:function(data){applyColor(editor,format,data.value,noop)}}]}})}function classes(presets){return{backgroundMenu:"tox-background-menu",selectedMenu:"tox-selected-menu",selectedItem:"tox-collection__item--active",hasIcons:"tox-menu--has-icons",menu:function(presets){return"color"===presets?"tox-swatches":"tox-menu"}(presets),tieredMenu:"tox-tiered-menu"}}function markers$1(presets){var menuClasses=classes(presets);return{backgroundMenu:menuClasses.backgroundMenu,selectedMenu:menuClasses.selectedMenu,menu:menuClasses.menu,selectedItem:menuClasses.selectedItem,item:classForPreset(presets)}}function part(hasIcons,columns,presets){var menuClasses=classes(presets);return{dom:{tag:"div",classes:flatten([[menuClasses.tieredMenu]])},markers:markers$1(presets)}}function chunk$1(rowDom,numColumns){return function(items){var chunks=chunk(items,numColumns);return map(chunks,function(c){return{dom:rowDom,components:c}})}}function preprocessCollection(items,isSeparator){var allSplits=[],currentSplit=[];return each(items,function(item,i){isSeparator(item,i)?(0<currentSplit.length&&allSplits.push(currentSplit),currentSplit=[],has(item.dom,"innerHtml")&&currentSplit.push(item)):currentSplit.push(item)}),0<currentSplit.length&&allSplits.push(currentSplit),map(allSplits,function(s){return{dom:{tag:"div",classes:["tox-collection__group"]},components:s}})}function forCollection(columns,initItems,_hasIcons){return{dom:{tag:"div",classes:["tox-menu","tox-collection"].concat(1===columns?["tox-collection--list"]:["tox-collection--grid"])},components:[Menu.parts().items({preprocess:function(items){return"auto"!==columns&&1<columns?chunk$1({tag:"div",classes:["tox-collection__group"]},columns)(items):preprocessCollection(items,function(_item,i){return"separator"===initItems[i].type})}})]}}function hasIcon(item){return void 0!==item.icon||"togglemenuitem"===item.type||"choicemenuitem"===item.type}function handleError(error){return domGlobals.console.error(formatError(error)),domGlobals.console.log(error),Option.none()}function createHorizontalPartialMenuWithAlloyItems(value,_hasIcons,items,_columns,_presets){var structure=function(initItems){return{dom:{tag:"div",classes:["tox-collection","tox-collection--horizontal"]},components:[Menu.parts().items({preprocess:function(items){return preprocessCollection(items,function(_item,i){return"separator"===initItems[i].type})}})]}}(items);return{value:value,dom:structure.dom,components:structure.components,items:items}}function createPartialMenuWithAlloyItems(value,hasIcons,items,columns,presets){var structure;return"color"===presets?{value:value,dom:(structure=function(columns){return{dom:{tag:"div",classes:["tox-menu","tox-swatches-menu"]},components:[{dom:{tag:"div",classes:["tox-swatches"]},components:[Menu.parts().items({preprocess:"auto"!==columns?chunk$1({tag:"div",classes:["tox-swatches__row"]},columns):identity})]}]}}(columns)).dom,components:structure.components,items:items}:"normal"===presets&&"auto"===columns?{value:value,dom:(structure=forCollection(columns,items)).dom,components:structure.components,items:items}:"normal"===presets&&1===columns?{value:value,dom:(structure=forCollection(1,items)).dom,components:structure.components,items:items}:"normal"===presets?{value:value,dom:(structure=forCollection(columns,items)).dom,components:structure.components,items:items}:"listpreview"!==presets||"auto"===columns?{value:value,dom:function(hasIcons,columns,presets){var menuClasses=classes(presets);return{tag:"div",classes:flatten([[menuClasses.menu,"tox-menu-"+columns+"-column"],hasIcons?[menuClasses.hasIcons]:[]])}}(hasIcons,columns,presets),components:components$1,items:items}:{value:value,dom:(structure=function(columns){return{dom:{tag:"div",classes:["tox-menu","tox-collection","tox-collection--toolbar","tox-collection--toolbar-lg"]},components:[Menu.parts().items({preprocess:chunk$1({tag:"div",classes:["tox-collection__group"]},columns)})]}}(columns)).dom,components:structure.components,items:items}}function createPartialChoiceMenu(value,items,onItemValueHandler,columns,presets,itemResponse,select,providersBackstage){var hasIcons=function(xs){return exists(xs,hasIcon)}(items),alloyItems=createChoiceItems(items,onItemValueHandler,columns,"color"!==presets?"normal":"color",itemResponse,select,providersBackstage);return createPartialMenuWithAlloyItems(value,hasIcons,alloyItems,columns,presets)}function deriveMenuMovement(columns,presets){var menuMarkers=markers$1(presets);return 1===columns?{mode:"menu",moveOnTab:!0}:"auto"===columns?{mode:"grid",selector:"."+menuMarkers.item,initSize:{numColumns:1,numRows:1}}:{mode:"matrix",rowSelector:"."+("color"===presets?"tox-swatches__row":"tox-collection__group")}}var choiceItem="choiceitem",defaultColors=[{type:choiceItem,text:"Light Green",value:"#BFEDD2"},{type:choiceItem,text:"Light Yellow",value:"#FBEEB8"},{type:choiceItem,text:"Light Red",value:"#F8CAC6"},{type:choiceItem,text:"Light Purple",value:"#ECCAFA"},{type:choiceItem,text:"Light Blue",value:"#C2E0F4"},{type:choiceItem,text:"Green",value:"#2DC26B"},{type:choiceItem,text:"Yellow",value:"#F1C40F"},{type:choiceItem,text:"Red",value:"#E03E2D"},{type:choiceItem,text:"Purple",value:"#B96AD9"},{type:choiceItem,text:"Blue",value:"#3598DB"},{type:choiceItem,text:"Dark Turquoise",value:"#169179"},{type:choiceItem,text:"Orange",value:"#E67E23"},{type:choiceItem,text:"Dark Red",value:"#BA372A"},{type:choiceItem,text:"Dark Purple",value:"#843FA1"},{type:choiceItem,text:"Dark Blue",value:"#236FA1"},{type:choiceItem,text:"Light Gray",value:"#ECF0F1"},{type:choiceItem,text:"Medium Gray",value:"#CED4D9"},{type:choiceItem,text:"Gray",value:"#95A5A6"},{type:choiceItem,text:"Dark Gray",value:"#7E8C8D"},{type:choiceItem,text:"Navy Blue",value:"#34495E"},{type:choiceItem,text:"Black",value:"#000000"},{type:choiceItem,text:"White",value:"#ffffff"}],colorCache=function(max){void 0===max&&(max=10);var list,storageString=global$9.getItem("tinymce-custom-colors"),localstorage=isString(storageString)?JSON.parse(storageString):[],cache=max-(list=localstorage).length<0?list.slice(0,max):list,remove=function(idx){cache.splice(idx,1)};return{add:function(key){(function(xs,x){var r=rawIndexOf(xs,x);return-1===r?Option.none():Option.some(r)})(cache,key).each(remove),cache.unshift(key),cache.length>max&&cache.pop(),global$9.setItem("tinymce-custom-colors",JSON.stringify(cache))},state:function(){return cache.slice(0)}}}(10),Settings_getColorCols=function(editor,defaultCols){return editor.getParam("color_cols",defaultCols,"number")},Settings_hasCustomColors=function(editor){return!1!==editor.getParam("custom_colors")},Settings_getColors=function(editor){var unmapped=getColorMap(editor);return void 0!==unmapped?mapColors(unmapped):defaultColors},Settings_getCurrentColors=function(){return map(colorCache.state(),function(color){return{type:choiceItem,text:color,value:color}})},Settings_addColor=function(color){colorCache.add(color)},Events_fireSkinLoaded=function(editor){return editor.fire("SkinLoaded")},Events_fireSkinLoadError=function(editor,error){return editor.fire("SkinLoadError",error)},Events_fireResizeEditor=function(editor){return editor.fire("ResizeEditor")},Events_fireScrollContent=function(editor,e){return editor.fire("ScrollContent",e)},Events_fireResizeContent=function(editor,e){return editor.fire("ResizeContent",e)},Events_fireTextColorChange=function(editor,data){return editor.fire("TextColorChange",data)},colorPickerDialog=function(editor){return function(callback,value){var initialData={colorpicker:value},submit=function(callback){return function(api){var data=api.getData();callback(Option.from(data.colorpicker)),api.close()}}(callback);editor.windowManager.open({title:"Color Picker",size:"normal",body:{type:"panel",items:[{type:"colorpicker",name:"colorpicker",label:"Color"}]},buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"save",text:"Save",primary:!0}],initialData:initialData,onAction:function(api,details){"hex-valid"===details.name&&(details.value?api.enable("ok"):api.disable("ok"))},onSubmit:submit,onClose:function(){},onCancel:function(){callback(Option.none())}})}},ColorSwatch={register:function(editor){!function(editor){editor.addCommand("mceApplyTextcolor",function(format,value){!function(editor,format,value){editor.undoManager.transact(function(){editor.focus(),editor.formatter.apply(format,{value:value}),editor.nodeChanged()})}(editor,format,value)}),editor.addCommand("mceRemoveTextcolor",function(format){!function(editor,format){editor.undoManager.transact(function(){editor.focus(),editor.formatter.remove(format,{value:null},null,!0),editor.nodeChanged()})}(editor,format)})}(editor);var lastForeColor=Cell(null),lastBackColor=Cell(null);registerTextColorButton(editor,"forecolor","forecolor","Text color",lastForeColor),registerTextColorButton(editor,"backcolor","hilitecolor","Background color",lastBackColor),registerTextColorMenuItem(editor,"forecolor","forecolor","Text color"),registerTextColorMenuItem(editor,"backcolor","hilitecolor","Background color")},getColors:getMenuColors,getFetch:getFetch,colorPickerDialog:colorPickerDialog,getCurrentColor:getCurrentColor,getColorCols:getColorCols$1,calcCols:calcCols},components$1=[Menu.parts().items({})],createChoiceItems=function(items,onItemValueHandler,columns,itemPresets,itemResponse,select,providersBackstage){return cat(map(items,function(item){return"choiceitem"===item.type?function(spec){return asRaw("choicemenuitem",choiceMenuItemSchema,spec)}(item).fold(handleError,function(d){return Option.some(function(spec,useText,presets,onItemValueHandler,isSelected,itemResponse,providersBackstage){var structure=renderItemStructure({presets:presets,textContent:useText?spec.text:Option.none(),htmlContent:Option.none(),ariaLabel:spec.text,iconContent:spec.icon,shortcutContent:useText?spec.shortcut:Option.none(),checkMark:useText?Option.some(renderCheckmark(providersBackstage.icons)):Option.none(),caret:Option.none(),value:spec.value},providersBackstage,!0);return deepMerge(renderCommonItem({data:buildData(spec),disabled:spec.disabled,getApi:function(component){return{setActive:function(state){Toggling.set(component,state)},isActive:function(){return Toggling.isOn(component)},isDisabled:function(){return Disabling.isDisabled(component)},setDisabled:function(state){return Disabling.set(component,state)}}},onAction:function(_api){return onItemValueHandler(spec.value)},onSetup:function(api){return api.setActive(isSelected),function(){}},triggersSubmenu:!1,itemBehaviours:[]},structure,itemResponse),{toggling:{toggleClass:"tox-collection__item--enabled",toggleOnExecute:!1,selected:spec.active}})}(d,1===columns,itemPresets,onItemValueHandler,select(item.value),itemResponse,providersBackstage))}):Option.none()}))};var FocusMode,fancyMenuItems={inserttable:function(spec){var sizeLabelId=generate$1("size-label"),cells=function(labelId,numRows,numCols){for(var cells=[],i=0;i<numRows;i++){for(var row=[],j=0;j<numCols;j++)row.push(makeCell(i,j,labelId));cells.push(row)}return cells}(sizeLabelId,10,10),memLabel=record({dom:{tag:"span",classes:["tox-insert-table-picker__label"],attributes:{id:sizeLabelId}},components:[text("0x0")],behaviours:derive$1([Replacing.config({})])});return{type:"widget",data:{value:generate$1("widget-id")},dom:{tag:"div",classes:["tox-fancymenuitem"]},autofocus:!0,components:[parts$2().widget({dom:{tag:"div",classes:["tox-insert-table-picker"]},components:function(cells){return bind(cells,function(cellRow){return map(cellRow,premade$1)})}(cells).concat(memLabel.asSpec()),behaviours:derive$1([config("insert-table-picker",[runWithTarget(cellOverEvent,function(c,t,e){var row=e.event().row(),col=e.event().col();!function(cells,selectedRow,selectedColumn,numRows,numColumns){for(var i=0;i<numRows;i++)for(var j=0;j<numColumns;j++)Toggling.set(cells[i][j],i<=selectedRow&&j<=selectedColumn)}(cells,row,col,10,10),Replacing.set(memLabel.get(c),[function(row,col){return text(col+1+"x"+(row+1))}(row,col)])}),runWithTarget(cellExecuteEvent,function(c,_,e){spec.onAction({numRows:e.event().row()+1,numColumns:e.event().col()+1}),emit(c,sandboxClose())})]),Keying.config({initSize:{numRows:10,numColumns:10},mode:"flatgrid",selector:'[role="button"]'})])})]}},colorswatch:function(spec,backstage){var items=ColorSwatch.getColors(backstage.colorinput.getColors(),backstage.colorinput.hasCustomColors()),columns=backstage.colorinput.getColorCols(),menuSpec=createPartialChoiceMenu(generate$1("menu-value"),items,function(value){spec.onAction({value:value})},columns,"color",ItemResponse$1.CLOSE_ON_EXECUTE,function(){return!1},backstage.shared.providers),widgetSpec=__assign(__assign({},menuSpec),{markers:markers$1("color"),movement:deriveMenuMovement(columns,"color")});return{type:"widget",data:{value:generate$1("widget-id")},dom:{tag:"div",classes:["tox-fancymenuitem"]},autofocus:!0,components:[parts$2().widget(Menu.sketch(widgetSpec))]}}},autocomplete=function(spec,matchText,useText,presets,onItemValueHandler,itemResponse,sharedBackstage,renderIcons){void 0===renderIcons&&(renderIcons=!0);var structure=renderItemStructure({presets:presets,textContent:Option.none(),htmlContent:useText?spec.text.map(function(text){return replaceText(text,matchText)}):Option.none(),ariaLabel:spec.text,iconContent:spec.icon,shortcutContent:Option.none(),checkMark:Option.none(),caret:Option.none(),value:spec.value},sharedBackstage.providers,renderIcons,spec.icon);return renderCommonItem({data:buildData(spec),disabled:spec.disabled,getApi:function(){return{}},onAction:function(_api){return onItemValueHandler(spec.value,spec.meta)},onSetup:function(){return function(){}},triggersSubmenu:!1,itemBehaviours:function(meta,sharedBackstage){return get(meta,"tooltipWorker").map(function(tooltipWorker){return[Tooltipping.config({lazySink:sharedBackstage.getSink,tooltipDom:{tag:"div",classes:["tox-tooltip-worker-container"]},tooltipComponents:[],anchor:function(comp){return{anchor:"submenu",item:comp,overrides:{maxHeightFunction:expandable}}},mode:"follow-highlight",onShow:function(component,_tooltip){tooltipWorker(function(elm){Tooltipping.setComponents(component,[external({element:Element.fromDom(elm)})])})}})]}).getOr([])}(spec.meta,sharedBackstage)},structure,itemResponse)},separator=function(spec){var innerHtml=spec.text.fold(function(){return{}},function(text){return{innerHtml:text}});return{type:"separator",dom:__assign({tag:"div",classes:[selectableClass,"tox-collection__group-heading"]},innerHtml),components:[]}},normal=function(spec,itemResponse,providersBackstage,renderIcons){void 0===renderIcons&&(renderIcons=!0);var structure=renderItemStructure({presets:"normal",iconContent:spec.icon,textContent:spec.text,htmlContent:Option.none(),ariaLabel:spec.text,caret:Option.none(),checkMark:Option.none(),shortcutContent:spec.shortcut},providersBackstage,renderIcons);return renderCommonItem({data:buildData(spec),getApi:function(component){return{isDisabled:function(){return Disabling.isDisabled(component)},setDisabled:function(state){return Disabling.set(component,state)}}},disabled:spec.disabled,onAction:spec.onAction,onSetup:spec.onSetup,triggersSubmenu:!1,itemBehaviours:[]},structure,itemResponse)},nested=function(spec,itemResponse,providersBackstage,renderIcons,downwardsCaret){void 0===renderIcons&&(renderIcons=!0),void 0===downwardsCaret&&(downwardsCaret=!1);var caret=downwardsCaret?function(icons){return{dom:{tag:"div",classes:["tox-collection__item-caret"],innerHtml:get$d("chevron-down",icons)}}}(providersBackstage.icons):function(icons){return{dom:{tag:"div",classes:["tox-collection__item-caret"],innerHtml:get$d("chevron-right",icons)}}}(providersBackstage.icons),structure=renderItemStructure({presets:"normal",iconContent:spec.icon,textContent:spec.text,htmlContent:Option.none(),ariaLabel:spec.text,caret:Option.some(caret),checkMark:Option.none(),shortcutContent:spec.shortcut},providersBackstage,renderIcons);return renderCommonItem({data:buildData(spec),getApi:function(component){return{isDisabled:function(){return Disabling.isDisabled(component)},setDisabled:function(state){return Disabling.set(component,state)}}},disabled:spec.disabled,onAction:noop,onSetup:spec.onSetup,triggersSubmenu:!0,itemBehaviours:[]},structure,itemResponse)},toggle$1=function(spec,itemResponse,providersBackstage){var structure=renderItemStructure({iconContent:Option.none(),textContent:spec.text,htmlContent:Option.none(),ariaLabel:spec.text,checkMark:Option.some(renderCheckmark(providersBackstage.icons)),caret:Option.none(),shortcutContent:spec.shortcut,presets:"normal",meta:spec.meta},providersBackstage,!0);return deepMerge(renderCommonItem({data:buildData(spec),disabled:spec.disabled,getApi:function(component){return{setActive:function(state){Toggling.set(component,state)},isActive:function(){return Toggling.isOn(component)},isDisabled:function(){return Disabling.isDisabled(component)},setDisabled:function(state){return Disabling.set(component,state)}}},onAction:spec.onAction,onSetup:spec.onSetup,triggersSubmenu:!1,itemBehaviours:[]},structure,itemResponse),{toggling:{toggleClass:"tox-collection__item--enabled",toggleOnExecute:!1,selected:spec.active}})},fancy=function(spec,backstage){return function(obj,key){return Object.prototype.hasOwnProperty.call(obj,key)?Option.some(obj[key]):Option.none()}(fancyMenuItems,spec.fancytype).map(function(render){return render(spec,backstage)})};!function(FocusMode){FocusMode[FocusMode.ContentFocus=0]="ContentFocus",FocusMode[FocusMode.UiFocus=1]="UiFocus"}(FocusMode=FocusMode||{});function hasIcon$1(item){return void 0!==item.icon||"togglemenuitem"===item.type||"choicemenuitem"===item.type}function menuHasIcons$1(xs){return exists(xs,hasIcon$1)}function createMenuItemFromBridge(item,itemResponse,backstage,menuHasIcons,isHorizontalMenu){function parseForHorizontalMenu(menuitem){return isHorizontalMenu?__assign(__assign({},menuitem),{shortcut:Option.none(),icon:menuitem.text.isSome()?Option.none():menuitem.icon}):menuitem}var providersBackstage=backstage.shared.providers;switch(item.type){case"menuitem":return function(spec){return asRaw("menuitem",menuItemSchema,spec)}(item).fold(handleError,function(d){return Option.some(normal(parseForHorizontalMenu(d),itemResponse,providersBackstage,menuHasIcons))});case"nestedmenuitem":return function(spec){return asRaw("nestedmenuitem",nestedMenuItemSchema,spec)}(item).fold(handleError,function(d){return Option.some(nested(parseForHorizontalMenu(d),itemResponse,providersBackstage,menuHasIcons,isHorizontalMenu))});case"togglemenuitem":return function(spec){return asRaw("togglemenuitem",toggleMenuItemSchema,spec)}(item).fold(handleError,function(d){return Option.some(toggle$1(parseForHorizontalMenu(d),itemResponse,providersBackstage))});case"separator":return function(spec){return asRaw("separatormenuitem",separatorMenuItemSchema,spec)}(item).fold(handleError,function(d){return Option.some(separator(d))});case"fancymenuitem":return function(spec){return asRaw("fancymenuitem",fancyMenuItemSchema,spec)}(item).fold(handleError,function(d){return fancy(parseForHorizontalMenu(d),backstage)});default:return domGlobals.console.error("Unknown item in general menu",item),Option.none()}}function createAutocompleteItems(items,matchText,onItemValueHandler,columns,itemResponse,sharedBackstage){var renderText=1===columns,renderIcons=!renderText||menuHasIcons$1(items);return cat(map(items,function(item){return"separator"===item.type?function(spec){return asRaw("Autocompleter.Separator",separatorMenuItemSchema,spec)}(item).fold(handleError,function(d){return Option.some(separator(d))}):function(spec){return asRaw("Autocompleter.Item",autocompleterItemSchema,spec)}(item).fold(handleError,function(d){return Option.some(autocomplete(d,matchText,renderText,"normal",onItemValueHandler,itemResponse,sharedBackstage,renderIcons))})}))}function createPartialMenu(value,items,itemResponse,backstage,isHorizontalMenu){var hasIcons=menuHasIcons$1(items),alloyItems=cat(map(items,function(item){function createItem(i){return createMenuItemFromBridge(i,itemResponse,backstage,function(i){return isHorizontalMenu?!i.hasOwnProperty("text"):hasIcons}(i),isHorizontalMenu)}return"nestedmenuitem"===item.type&&item.getSubmenuItems().length<=0?createItem(__assign(__assign({},item),{disabled:!0})):createItem(item)}));return(isHorizontalMenu?createHorizontalPartialMenuWithAlloyItems:createPartialMenuWithAlloyItems)(value,hasIcons,alloyItems,1,"normal")}function createTieredDataFrom(partialMenu){return tieredMenu.singleData(partialMenu.value,partialMenu)}function bind$3(element,event,handler){return function(element,event,filter,handler){return binder(element,event,filter,handler,!1)}(element,event,filter$1,handler)}function capture$1(element,event,handler){return function(element,event,filter,handler){return binder(element,event,filter,handler,!0)}(element,event,filter$1,handler)}function closest$4(scope,selector,isRoot){return closest$3(scope,selector,isRoot).isSome()}var Autocompleter_register=function(editor,sharedBackstage){function isActive(){return activeAutocompleter.get().isSome()}function hideIfNecessary(){isActive()&&InlineView.hide(autocompleter)}function display(ac,context,lookupData,items){ac.matchLength=context.text.length;var columns=findMap(lookupData,function(ld){return Option.from(ld.columns)}).getOr(1);InlineView.showAt(autocompleter,{anchor:"node",root:Element.fromDom(editor.getBody()),node:Option.from(ac.element)},Menu.sketch(function(partialMenu,columns,focusMode,presets){var focusManager=focusMode===FocusMode.ContentFocus?highlights():dom(),movement=deriveMenuMovement(columns,presets),menuMarkers=markers$1(presets);return{dom:partialMenu.dom,components:partialMenu.components,items:partialMenu.items,value:partialMenu.value,markers:{selectedItem:menuMarkers.selectedItem,item:menuMarkers.item},movement:movement,fakeFocus:focusMode===FocusMode.ContentFocus,focusManager:focusManager,menuBehaviours:SimpleBehaviours_unnamedEvents("auto"!==columns?[]:[runOnAttached(function(comp,se){detectSize(comp,4,menuMarkers.item).each(function(_a){var numColumns=_a.numColumns,numRows=_a.numRows;Keying.setGridSize(comp,numRows,numColumns)})})])}}(createPartialMenuWithAlloyItems("autocompleter-value",!0,items,columns,"normal"),columns,FocusMode.ContentFocus,"normal"))),InlineView.getContent(autocompleter).each(Highlighting.highlightFirst)}var activeAutocompleter=Cell(Option.none()),processingAction=Cell(!1),autocompleter=build$1(InlineView.sketch({dom:{tag:"div",classes:["tox-autocompleter"]},components:[],fireDismissalEventInstead:{},inlineBehaviours:derive$1([config("dismissAutocompleter",[run(dismissRequested(),function(){return cancelIfNecessary()})])]),lazySink:sharedBackstage.getSink})),cancelIfNecessary=function(){if(isActive()){var lastElement=activeAutocompleter.get().map(function(ac){return ac.element});detect$4(lastElement.getOr(Element.fromDom(editor.selection.getNode()))).each(unwrap),hideIfNecessary(),activeAutocompleter.set(Option.none()),processingAction.set(!1)}},getAutocompleters=cached(function(){return register(editor)}),load=function(fetchOptions){(function(fetchOptions){return activeAutocompleter.get().map(function(ac){return getContext(editor.dom,editor.selection.getRng(),ac.triggerChar).bind(function(newContext){return lookupWithContext(editor,getAutocompleters,newContext,fetchOptions)})}).getOrThunk(function(){return lookup(editor,getAutocompleters)})})(fetchOptions).fold(cancelIfNecessary,function(lookupInfo){!function(context){if(!isActive()){var wrapper=create$4(editor,context.range);activeAutocompleter.set(Option.some({triggerChar:context.triggerChar,element:wrapper,matchLength:context.text.length})),processingAction.set(!1)}}(lookupInfo.context),lookupInfo.lookupData.then(function(lookupData){activeAutocompleter.get().map(function(ac){var context=lookupInfo.context;if(ac.triggerChar===context.triggerChar){var combinedItems=function(triggerChar,matches){var columns=findMap(matches,function(m){return Option.from(m.columns)}).getOr(1);return bind(matches,function(match){var choices=match.items;return createAutocompleteItems(choices,match.matchText,function(itemValue,itemMeta){var nr=editor.selection.getRng();getContext(editor.dom,nr,triggerChar).fold(function(){return domGlobals.console.error("Lost context. Cursor probably moved")},function(_a){var range=_a.range,autocompleterApi={hide:function(){cancelIfNecessary()},reload:function(fetchOptions){hideIfNecessary(),load(fetchOptions)}};processingAction.set(!0),match.onAction(autocompleterApi,range,itemValue,itemMeta),processingAction.set(!1)})},columns,ItemResponse$1.BUBBLE_TO_SANDBOX,sharedBackstage)})}(context.triggerChar,lookupData);0<combinedItems.length?display(ac,context,lookupData,combinedItems):10<=context.text.length-ac.matchLength?cancelIfNecessary():hideIfNecessary()}})})})},autocompleterUiApi={onKeypress:last$2(function(e){27!==e.which&&load()},50),cancelIfNecessary:cancelIfNecessary,isMenuOpen:function(){return InlineView.isOpen(autocompleter)},isActive:isActive,isProcessingAction:processingAction.get,getView:function(){return InlineView.getContent(autocompleter)}};AutocompleterEditorEvents_setup(autocompleterUiApi,editor)},filter$1=constant(!0),fromRawEvent$1=fromRawEvent;function DelayedFunction(fun,delay){var ref=null;return{cancel:function(){null!==ref&&(domGlobals.clearTimeout(ref),ref=null)},schedule:function(){for(var args=[],_i=0;_i<arguments.length;_i++)args[_i]=arguments[_i];ref=domGlobals.setTimeout(function(){fun.apply(null,args),ref=null},delay)}}}function getTouch(event){var raw=event.raw();return void 0===raw.touches||1!==raw.touches.length?Option.none():Option.some(raw.touches[0])}function monitor(settings){var startData=Cell(Option.none()),longpressFired=Cell(!1),longpress$1=DelayedFunction(function(event){settings.triggerEvent(longpress(),event),longpressFired.set(!0)},400),handlers=wrapAll$1([{key:touchstart(),value:function(event){return getTouch(event).each(function(touch){longpress$1.cancel();var data={x:constant(touch.clientX),y:constant(touch.clientY),target:event.target};longpress$1.schedule(event),longpressFired.set(!1),startData.set(Option.some(data))}),Option.none()}},{key:touchmove(),value:function(event){return longpress$1.cancel(),getTouch(event).each(function(touch){startData.get().each(function(data){!function(touch,data){var distX=Math.abs(touch.clientX-data.x()),distY=Math.abs(touch.clientY-data.y());return 5<distX||5<distY}(touch,data)||startData.set(Option.none())})}),Option.none()}},{key:touchend(),value:function(event){longpress$1.cancel();return startData.get().filter(function(data){return eq(data.target(),event.target())}).map(function(data){return longpressFired.get()?(event.prevent(),!1):settings.triggerEvent(tap(),event)})}}]);return{fireIfReady:function(event,type){return get(handlers,type).bind(function(handler){return handler(event)})}}}function setup$1(container,rawSettings){var settings=asRawOrDie("Getting GUI events settings",settingsSchema,rawSettings),tapEvent=monitor(settings),simpleEvents=map(["touchstart","touchmove","touchend","touchcancel","gesturestart","mousedown","mouseup","mouseover","mousemove","mouseout","click"].concat(["selectstart","input","contextmenu","change","transitionend","drag","dragstart","dragend","dragenter","dragleave","dragover","drop","keyup"]),function(type){return bind$3(container,type,function(event){tapEvent.fireIfReady(event,type).each(function(tapStopped){tapStopped&&event.kill()}),settings.triggerEvent(type,event)&&event.kill()})}),pasteTimeout=Cell(Option.none()),onPaste=bind$3(container,"paste",function(event){tapEvent.fireIfReady(event,"paste").each(function(tapStopped){tapStopped&&event.kill()}),settings.triggerEvent("paste",event)&&event.kill(),pasteTimeout.set(Option.some(domGlobals.setTimeout(function(){settings.triggerEvent(postPaste(),event)},0)))}),onKeydown=bind$3(container,"keydown",function(event){settings.triggerEvent("keydown",event)?event.kill():!0===settings.stopBackspace&&function(event){return 8===event.raw().which&&!contains(["input","textarea"],name(event.target()))&&!closest$4(event.target(),'[contenteditable="true"]')}(event)&&event.prevent()}),onFocusIn=function(container,handler){return isFirefox?capture$1(container,"focus",handler):bind$3(container,"focusin",handler)}(container,function(event){settings.triggerEvent("focusin",event)&&event.kill()}),focusoutTimeout=Cell(Option.none()),onFocusOut=function(container,handler){return isFirefox?capture$1(container,"blur",handler):bind$3(container,"focusout",handler)}(container,function(event){settings.triggerEvent("focusout",event)&&event.kill(),focusoutTimeout.set(Option.some(domGlobals.setTimeout(function(){settings.triggerEvent(postBlur(),event)},0)))});return{unbind:function(){each(simpleEvents,function(e){e.unbind()}),onKeydown.unbind(),onFocusIn.unbind(),onFocusOut.unbind(),onPaste.unbind(),pasteTimeout.get().each(domGlobals.clearTimeout),focusoutTimeout.get().each(domGlobals.clearTimeout)}}}function derive$2(rawEvent,rawTarget){var source=get(rawEvent,"target").map(function(getTarget){return getTarget()}).getOr(rawTarget);return Cell(source)}function doTriggerHandler(lookup,eventType,rawEvent,target,source,logger){var handler=lookup(eventType,target),simulatedEvent=function(event,source){var stopper=Cell(!1),cutter=Cell(!1);return{stop:function(){stopper.set(!0)},cut:function(){cutter.set(!0)},isStopped:stopper.get,isCut:cutter.get,event:constant(event),setSource:source.set,getSource:source.get}}(rawEvent,source);return handler.fold(function(){return logger.logEventNoHandlers(eventType,target),adt$b.complete()},function(handlerInfo){var descHandler=handlerInfo.descHandler();return getCurried(descHandler)(simulatedEvent),simulatedEvent.isStopped()?(logger.logEventStopped(eventType,handlerInfo.element(),descHandler.purpose()),adt$b.stopped()):simulatedEvent.isCut()?(logger.logEventCut(eventType,handlerInfo.element(),descHandler.purpose()),adt$b.complete()):parent(handlerInfo.element()).fold(function(){return logger.logNoParent(eventType,handlerInfo.element(),descHandler.purpose()),adt$b.complete()},function(parent){return logger.logEventResponse(eventType,handlerInfo.element(),descHandler.purpose()),adt$b.resume(parent)})})}function broadcast(listeners,rawEvent,logger){var simulatedEvent=function(event){var stopper=Cell(!1);return{stop:function(){stopper.set(!0)},cut:noop,isStopped:stopper.get,isCut:constant(!1),event:constant(event),setSource:die("Cannot set source of a broadcasted event"),getSource:die("Cannot get source of a broadcasted event")}}(rawEvent);return each(listeners,function(listener){var descHandler=listener.descHandler();getCurried(descHandler)(simulatedEvent)}),simulatedEvent.isStopped()}var isFirefox=detect$3().browser.isFirefox(),settingsSchema=objOfOnly([strictFunction("triggerEvent"),defaulted$1("stopBackspace",!0)]),adt$b=Adt_generate([{stopped:[]},{resume:["element"]},{complete:[]}]),doTriggerOnUntilStopped=function(lookup,eventType,rawEvent,rawTarget,source,logger){return doTriggerHandler(lookup,eventType,rawEvent,rawTarget,source,logger).fold(function(){return!0},function(parent){return doTriggerOnUntilStopped(lookup,eventType,rawEvent,parent,source,logger)},function(){return!1})},triggerOnUntilStopped=function(lookup,eventType,rawEvent,rawTarget,logger){var source=derive$2(rawEvent,rawTarget);return doTriggerOnUntilStopped(lookup,eventType,rawEvent,rawTarget,source,logger)},eventHandler=Immutable("element","descHandler"),broadcastHandler=function(id,handler){return{id:constant(id),descHandler:constant(handler)}};function EventRegistry(){var registry={};return{registerId:function(extraArgs,id,events){each$1(events,function(v,k){var handlers=void 0!==registry[k]?registry[k]:{};handlers[id]=curryArgs(v,extraArgs),registry[k]=handlers})},unregisterId:function(id){each$1(registry,function(handlersById,eventName){handlersById.hasOwnProperty(id)&&delete handlersById[id]})},filterByType:function(type){return get(registry,type).map(function(handlers){return mapToArray(handlers,function(f,id){return broadcastHandler(id,f)})}).getOr([])},find:function(isAboveRoot,type,target){var handlers=get(registry,type);return closest(target,function(elem){return function(handlers,elem){return read$1(elem).fold(function(){return Option.none()},function(id){return handlers.bind(function(h){return get(h,id)}).map(function(descHandler){return eventHandler(elem,descHandler)})})}(handlers,elem)},isAboveRoot)}}}function Registry(){function readOrTag(component){var elem=component.element();return read$1(elem).fold(function(){return function(label,elem){var id=generate$1(prefix$1+label);return writeOnly(elem,id),id}("uid-",component.element())},function(uid){return uid})}var events=EventRegistry(),components={},unregister=function(component){read$1(component.element()).each(function(tagId){delete components[tagId],events.unregisterId(tagId)})};return{find:function(isAboveRoot,type,target){return events.find(isAboveRoot,type,target)},filter:function(type){return events.filterByType(type)},register:function(component){var tagId=readOrTag(component);hasNonNullableKey(components,tagId)&&function(component,tagId){var conflict=components[tagId];if(conflict!==component)throw new Error('The tagId "'+tagId+'" is already used by: '+element(conflict.element())+"\nCannot use it for: "+element(component.element())+"\nThe conflicting element is"+(inBody(conflict.element())?" ":" not ")+"already in the DOM");unregister(component)}(component,tagId);var extraArgs=[component];events.registerId(extraArgs,tagId,component.events()),components[tagId]=component},unregister:unregister,getById:function(id){return get(components,id)}}}function takeover(root){function isAboveRoot(el){return parent(root.element()).fold(function(){return!0},function(parent){return eq(el,parent)})}function lookup(eventName,target){return registry.find(isAboveRoot,eventName,target)}function broadcastData(data){var receivers=registry.filter(receive());each(receivers,function(receiver){var descHandler=receiver.descHandler();getCurried(descHandler)(data)})}var registry=Registry(),domEvents=setup$1(root.element(),{triggerEvent:function(eventName,event){return monitorEvent(eventName,event.target(),function(logger){return function(lookup,eventType,rawEvent,logger){var rawTarget=rawEvent.target();return triggerOnUntilStopped(lookup,eventType,rawEvent,rawTarget,logger)}(lookup,eventName,event,logger)})}}),systemApi={debugInfo:constant("real"),triggerEvent:function(eventName,target,data){monitorEvent(eventName,target,function(logger){return triggerOnUntilStopped(lookup,eventName,data,target,logger)})},triggerFocus:function(target,originator){read$1(target).fold(function(){focus$1(target)},function(_alloyId){monitorEvent(focus(),target,function(logger){return function(lookup,eventType,rawEvent,target,logger){var source=derive$2(rawEvent,target);doTriggerHandler(lookup,eventType,rawEvent,target,source,logger)}(lookup,focus(),{originator:constant(originator),kill:noop,prevent:noop,target:constant(target)},target,logger),!1})})},triggerEscape:function(comp,simulatedEvent){systemApi.triggerEvent("keydown",comp.element(),simulatedEvent.event())},getByUid:function(uid){return getByUid(uid)},getByDom:function(elem){return getByDom(elem)},build:build$1,addToGui:function(c){add(c)},removeFromGui:function(c){remove$1(c)},addToWorld:function(c){addToWorld(c)},removeFromWorld:function(c){removeFromWorld(c)},broadcast:function(message){broadcast$1(message)},broadcastOn:function(channels,message){broadcastOn(channels,message)},broadcastEvent:function(eventName,event){broadcastEvent(eventName,event)},isConnected:constant(!0)},addToWorld=function(component){component.connect(systemApi),isText(component.element())||(registry.register(component),each(component.components(),addToWorld),systemApi.triggerEvent(systemInit(),component.element(),{target:constant(component.element())}))},removeFromWorld=function(component){isText(component.element())||(each(component.components(),removeFromWorld),registry.unregister(component)),component.disconnect()},add=function(component){attach$1(root,component)},remove$1=function(component){detach(component)},broadcast$1=function(message){broadcastData({universal:constant(!0),data:constant(message)})},broadcastOn=function(channels,message){broadcastData({universal:constant(!1),channels:constant(channels),data:constant(message)})},broadcastEvent=function(eventName,event){var listeners=registry.filter(eventName);return broadcast(listeners,event)},getByUid=function(uid){return registry.getById(uid).fold(function(){return Result.error(new Error('Could not find component with uid: "'+uid+'" in system.'))},Result.value)},getByDom=function(elem){var uid=read$1(elem).getOr("not found");return getByUid(uid)};return addToWorld(root),{root:constant(root),element:root.element,destroy:function(){domEvents.unbind(),remove(root.element())},add:add,remove:remove$1,getByUid:getByUid,getByDom:getByDom,addToWorld:addToWorld,removeFromWorld:removeFromWorld,broadcast:broadcast$1,broadcastOn:broadcastOn,broadcastEvent:broadcastEvent}}function focusBehaviours(detail){return derive$1([Focusing.config({onFocus:detail.selectOnFocus?function(component){var input=component.element(),value=get$5(input);input.dom().setSelectionRange(0,value.length)}:noop})])}function dom$2(detail){return{tag:detail.tag,attributes:__assign({type:"text"},detail.inputAttributes),styles:detail.inputStyles,classes:detail.inputClasses}}var Container=single$2({name:"Container",factory:function(detail){var _a=detail.dom,attributes=_a.attributes,domWithoutAttributes=__rest(_a,["attributes"]);return{uid:detail.uid,dom:__assign({tag:"div",attributes:__assign({role:"presentation"},attributes)},domWithoutAttributes),components:detail.components,behaviours:get$c(detail.containerBehaviours),events:detail.events,domModification:detail.domModification,eventOrder:detail.eventOrder}},configFields:[defaulted$1("components",[]),field$1("containerBehaviours",[]),defaulted$1("events",{}),defaulted$1("domModification",{}),defaulted$1("eventOrder",{})]}),formChangeEvent=generate$1("form-component-change"),formCloseEvent=generate$1("form-close"),formCancelEvent=generate$1("form-cancel"),formActionEvent=generate$1("form-action"),formSubmitEvent=generate$1("form-submit"),formBlockEvent=generate$1("form-block"),formUnblockEvent=generate$1("form-unblock"),formTabChangeEvent=generate$1("form-tabchange"),formResizeEvent=generate$1("form-resize"),schema$e=constant([defaulted$1("prefix","form-field"),field$1("fieldBehaviours",[Composing,Representing])]),parts$3=constant([optional({schema:[strict$1("dom")],name:"label"}),optional({factory:{sketch:function(spec){return{uid:spec.uid,dom:{tag:"span",styles:{display:"none"},attributes:{"aria-hidden":"true"},innerHtml:spec.text}}}},schema:[strict$1("text")],name:"aria-descriptor"}),required({factory:{sketch:function(spec){var excludeFactory=exclude$1(spec,["factory"]);return spec.factory.sketch(excludeFactory)}},schema:[strict$1("factory")],name:"field"})]),FormField=composite$1({name:"FormField",configFields:schema$e(),partFields:parts$3(),factory:function(detail,components,spec,externals){var behaviours=augment(detail.fieldBehaviours,[Composing.config({find:function(container){return getPart(container,detail,"field")}}),Representing.config({store:{mode:"manual",getValue:function(field){return Composing.getCurrent(field).bind(Representing.getValue)},setValue:function(field,value){Composing.getCurrent(field).each(function(current){Representing.setValue(current,value)})}}})]),events=derive([runOnAttached(function(component,simulatedEvent){var ps=getParts(component,detail,["label","field","aria-descriptor"]);ps.field().each(function(field){var id=generate$1(detail.prefix);ps.label().each(function(label){set$1(label.element(),"for",id),set$1(field.element(),"id",id)}),ps["aria-descriptor"]().each(function(descriptor){var descriptorId=generate$1(detail.prefix);set$1(descriptor.element(),"id",descriptorId),set$1(field.element(),"aria-describedby",descriptorId)})})})]),apis={getField:function(container){return getPart(container,detail,"field")},getLabel:function(container){return getPart(container,detail,"label")}};return{uid:detail.uid,dom:detail.dom,components:components,behaviours:behaviours,events:events,apis:apis}},apis:{getField:function(apis,comp){return apis.getField(comp)},getLabel:function(apis,comp){return apis.getLabel(comp)}}}),schema$f=constant([option("data"),defaulted$1("inputAttributes",{}),defaulted$1("inputStyles",{}),defaulted$1("tag","input"),defaulted$1("inputClasses",[]),onHandler("onSetValue"),defaulted$1("styles",{}),defaulted$1("eventOrder",{}),field$1("inputBehaviours",[Representing,Focusing]),defaulted$1("selectOnFocus",!0)]),Input=single$2({name:"Input",configFields:schema$f(),factory:function(detail,spec){return{uid:detail.uid,dom:dom$2(detail),components:[],behaviours:function(detail){return __assign(__assign({},focusBehaviours(detail)),augment(detail.inputBehaviours,[Representing.config({store:__assign(__assign({mode:"manual"},detail.data.map(function(data){return{initialValue:data}}).getOr({})),{getValue:function(input){return get$5(input.element())},setValue:function(input,data){get$5(input.element())!==data&&set$3(input.element(),data)}}),onSetValue:detail.onSetValue})]))}(detail),eventOrder:detail.eventOrder}}}),exports$1={},module={exports:exports$1};!function(define,exports,module,require){!function(f){if("object"==typeof exports&&void 0!==module)module.exports=f();else if("function"==typeof define&&define.amd)define([],f);else{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).EphoxContactWrapper=f()}}(function(){return function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c="function"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error("Cannot find module '"+i+"'");throw a.code="MODULE_NOT_FOUND",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){return o(e[i][1][r]||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u="function"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}({1:[function(require,module,exports){var cachedSetTimeout,cachedClearTimeout,process=module.exports={};function defaultSetTimout(){throw new Error("setTimeout has not been defined")}function defaultClearTimeout(){throw new Error("clearTimeout has not been defined")}function runTimeout(fun){if(cachedSetTimeout===setTimeout)return setTimeout(fun,0);if((cachedSetTimeout===defaultSetTimout||!cachedSetTimeout)&&setTimeout)return cachedSetTimeout=setTimeout,setTimeout(fun,0);try{return cachedSetTimeout(fun,0)}catch(e){try{return cachedSetTimeout.call(null,fun,0)}catch(e){return cachedSetTimeout.call(this,fun,0)}}}!function(){try{cachedSetTimeout="function"==typeof setTimeout?setTimeout:defaultSetTimout}catch(e){cachedSetTimeout=defaultSetTimout}try{cachedClearTimeout="function"==typeof clearTimeout?clearTimeout:defaultClearTimeout}catch(e){cachedClearTimeout=defaultClearTimeout}}();var currentQueue,queue=[],draining=!1,queueIndex=-1;function cleanUpNextTick(){draining&&currentQueue&&(draining=!1,currentQueue.length?queue=currentQueue.concat(queue):queueIndex=-1,queue.length&&drainQueue())}function drainQueue(){if(!draining){var timeout=runTimeout(cleanUpNextTick);draining=!0;for(var len=queue.length;len;){for(currentQueue=queue,queue=[];++queueIndex<len;)currentQueue&&currentQueue[queueIndex].run();queueIndex=-1,len=queue.length}currentQueue=null,draining=!1,function(marker){if(cachedClearTimeout===clearTimeout)return clearTimeout(marker);if((cachedClearTimeout===defaultClearTimeout||!cachedClearTimeout)&&clearTimeout)return cachedClearTimeout=clearTimeout,clearTimeout(marker);try{cachedClearTimeout(marker)}catch(e){try{return cachedClearTimeout.call(null,marker)}catch(e){return cachedClearTimeout.call(this,marker)}}}(timeout)}}function Item(fun,array){this.fun=fun,this.array=array}function noop(){}process.nextTick=function(fun){var args=new Array(arguments.length-1);if(1<arguments.length)for(var i=1;i<arguments.length;i++)args[i-1]=arguments[i];queue.push(new Item(fun,args)),1!==queue.length||draining||runTimeout(drainQueue)},Item.prototype.run=function(){this.fun.apply(null,this.array)},process.title="browser",process.browser=!0,process.env={},process.argv=[],process.version="",process.versions={},process.on=noop,process.addListener=noop,process.once=noop,process.off=noop,process.removeListener=noop,process.removeAllListeners=noop,process.emit=noop,process.prependListener=noop,process.prependOnceListener=noop,process.listeners=function(name){return[]},process.binding=function(name){throw new Error("process.binding is not supported")},process.cwd=function(){return"/"},process.chdir=function(dir){throw new Error("process.chdir is not supported")},process.umask=function(){return 0}},{}],2:[function(require,module,exports){(function(setImmediate){function noop(){}function Promise(fn){if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");if("function"!=typeof fn)throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],doResolve(fn,this)}function handle(self,deferred){for(;3===self._state;)self=self._value;0!==self._state?(self._handled=!0,Promise._immediateFn(function(){var cb=1===self._state?deferred.onFulfilled:deferred.onRejected;if(null!==cb){var ret;try{ret=cb(self._value)}catch(e){return void reject(deferred.promise,e)}resolve(deferred.promise,ret)}else(1===self._state?resolve:reject)(deferred.promise,self._value)})):self._deferreds.push(deferred)}function resolve(self,newValue){try{if(newValue===self)throw new TypeError("A promise cannot be resolved with itself.");if(newValue&&("object"==typeof newValue||"function"==typeof newValue)){var then=newValue.then;if(newValue instanceof Promise)return self._state=3,self._value=newValue,void finale(self);if("function"==typeof then)return void doResolve(function(fn,thisArg){return function(){fn.apply(thisArg,arguments)}}(then,newValue),self)}self._state=1,self._value=newValue,finale(self)}catch(e){reject(self,e)}}function reject(self,newValue){self._state=2,self._value=newValue,finale(self)}function finale(self){2===self._state&&0===self._deferreds.length&&Promise._immediateFn(function(){self._handled||Promise._unhandledRejectionFn(self._value)});for(var i=0,len=self._deferreds.length;i<len;i++)handle(self,self._deferreds[i]);self._deferreds=null}function Handler(onFulfilled,onRejected,promise){this.onFulfilled="function"==typeof onFulfilled?onFulfilled:null,this.onRejected="function"==typeof onRejected?onRejected:null,this.promise=promise}function doResolve(fn,self){var done=!1;try{fn(function(value){done||(done=!0,resolve(self,value))},function(reason){done||(done=!0,reject(self,reason))})}catch(ex){if(done)return;done=!0,reject(self,ex)}}var root,setTimeoutFunc;root=this,setTimeoutFunc=setTimeout,Promise.prototype.catch=function(onRejected){return this.then(null,onRejected)},Promise.prototype.then=function(onFulfilled,onRejected){var prom=new this.constructor(noop);return handle(this,new Handler(onFulfilled,onRejected,prom)),prom},Promise.all=function(arr){var args=Array.prototype.slice.call(arr);return new Promise(function(resolve,reject){if(0===args.length)return resolve([]);var remaining=args.length;function res(i,val){try{if(val&&("object"==typeof val||"function"==typeof val)){var then=val.then;if("function"==typeof then)return void then.call(val,function(val){res(i,val)},reject)}args[i]=val,0==--remaining&&resolve(args)}catch(ex){reject(ex)}}for(var i=0;i<args.length;i++)res(i,args[i])})},Promise.resolve=function(value){return value&&"object"==typeof value&&value.constructor===Promise?value:new Promise(function(resolve){resolve(value)})},Promise.reject=function(value){return new Promise(function(resolve,reject){reject(value)})},Promise.race=function(values){return new Promise(function(resolve,reject){for(var i=0,len=values.length;i<len;i++)values[i].then(resolve,reject)})},Promise._immediateFn="function"==typeof setImmediate?function(fn){setImmediate(fn)}:function(fn){setTimeoutFunc(fn,0)},Promise._unhandledRejectionFn=function(err){"undefined"!=typeof console&&console&&console.warn("Possible Unhandled Promise Rejection:",err)},Promise._setImmediateFn=function(fn){Promise._immediateFn=fn},Promise._setUnhandledRejectionFn=function(fn){Promise._unhandledRejectionFn=fn},void 0!==module&&module.exports?module.exports=Promise:root.Promise||(root.Promise=Promise)}).call(this,require("timers").setImmediate)},{timers:3}],3:[function(require,module,exports){(function(setImmediate,clearImmediate){var nextTick=require("process/browser.js").nextTick,apply=Function.prototype.apply,slice=Array.prototype.slice,immediateIds={},nextImmediateId=0;function Timeout(id,clearFn){this._id=id,this._clearFn=clearFn}exports.setTimeout=function(){return new Timeout(apply.call(setTimeout,window,arguments),clearTimeout)},exports.setInterval=function(){return new Timeout(apply.call(setInterval,window,arguments),clearInterval)},exports.clearTimeout=exports.clearInterval=function(timeout){timeout.close()},Timeout.prototype.unref=Timeout.prototype.ref=function(){},Timeout.prototype.close=function(){this._clearFn.call(window,this._id)},exports.enroll=function(item,msecs){clearTimeout(item._idleTimeoutId),item._idleTimeout=msecs},exports.unenroll=function(item){clearTimeout(item._idleTimeoutId),item._idleTimeout=-1},exports._unrefActive=exports.active=function(item){clearTimeout(item._idleTimeoutId);var msecs=item._idleTimeout;0<=msecs&&(item._idleTimeoutId=setTimeout(function(){item._onTimeout&&item._onTimeout()},msecs))},exports.setImmediate="function"==typeof setImmediate?setImmediate:function(fn){var id=nextImmediateId++,args=!(arguments.length<2)&&slice.call(arguments,1);return immediateIds[id]=!0,nextTick(function(){immediateIds[id]&&(args?fn.apply(null,args):fn.call(null),exports.clearImmediate(id))}),id},exports.clearImmediate="function"==typeof clearImmediate?clearImmediate:function(id){delete immediateIds[id]}}).call(this,require("timers").setImmediate,require("timers").clearImmediate)},{"process/browser.js":1,timers:3}],4:[function(require,module,exports){var promisePolyfill=require("promise-polyfill"),Global="undefined"!=typeof window?window:Function("return this;")();module.exports={boltExport:Global.Promise||promisePolyfill}},{"promise-polyfill":2}]},{},[4])(4)})}(void 0,exports$1,module,void 0);function errorReporter(err){domGlobals.setTimeout(function(){throw err},0)}function isAriaElement(elem){var name$1=name(elem);return contains(ariaElements,name$1)}function markValid(component,invalidConfig){var elem=invalidConfig.getRoot(component).getOr(component.element());remove$4(elem,invalidConfig.invalidClass),invalidConfig.notify.each(function(notifyInfo){isAriaElement(component.element())&&set$1(component.element(),"aria-invalid",!1),notifyInfo.getContainer(component).each(function(container){set(container,notifyInfo.validHtml)}),notifyInfo.onValid(component)})}function markInvalid(component,invalidConfig,invalidState,text){var elem=invalidConfig.getRoot(component).getOr(component.element());add$2(elem,invalidConfig.invalidClass),invalidConfig.notify.each(function(notifyInfo){isAriaElement(component.element())&&set$1(component.element(),"aria-invalid",!0),notifyInfo.getContainer(component).each(function(container){set(container,text)}),notifyInfo.onInvalid(component,text)})}function query(component,invalidConfig,invalidState){return invalidConfig.validator.fold(function(){return Future_pure(Result.value(!0))},function(validatorInfo){return validatorInfo.validate(component)})}function run$1(component,invalidConfig,invalidState){return invalidConfig.notify.each(function(notifyInfo){notifyInfo.onValidate(component)}),query(component,invalidConfig).map(function(valid){return component.getSystem().isConnected()?valid.fold(function(err){return markInvalid(component,invalidConfig,0,err),Result.error(err)},function(v){return markValid(component,invalidConfig),Result.value(v)}):Result.error("No longer in system")})}function renderFormFieldWith(pLabel,pField,extraClasses,extraBehaviours){var spec=renderFormFieldSpecWith(pLabel,pField,extraClasses,extraBehaviours);return FormField.sketch(spec)}function renderLabel(label,providersBackstage){return FormField.parts().label({dom:{tag:"label",classes:["tox-label"],innerHtml:providersBackstage.translate(label)}})}var HighlightOnOpen,Promise=module.exports.boltExport,nu$a=function(baseFn){var data=Option.none(),callbacks=[],get=function(nCallback){isReady()?call(nCallback):callbacks.push(nCallback)},isReady=function(){return data.isSome()},run=function(cbs){each(cbs,call)},call=function(cb){data.each(function(x){domGlobals.setTimeout(function(){cb(x)},0)})};return baseFn(function(x){data=Option.some(x),run(callbacks),callbacks=[]}),{get:get,map:function(f){return nu$a(function(nCallback){get(function(data){nCallback(f(data))})})},isReady:isReady}},LazyValue={nu:nu$a,pure:function(a){return nu$a(function(callback){callback(a)})}},make$3=function(run){function get(callback){run().then(callback,errorReporter)}return{map:function(fab){return make$3(function(){return run().then(fab)})},bind:function(aFutureB){return make$3(function(){return run().then(function(v){return aFutureB(v).toPromise()})})},anonBind:function(futureB){return make$3(function(){return run().then(function(){return futureB.toPromise()})})},toLazy:function(){return LazyValue.nu(get)},toCached:function(){var cache=null;return make$3(function(){return null===cache&&(cache=run()),cache})},toPromise:run,get:get}},Future_nu=function(baseFn){return make$3(function(){return new Promise(baseFn)})},Future_pure=function(a){return make$3(function(){return Promise.resolve(a)})},ariaElements=["input","textarea"],InvalidateApis=Object.freeze({__proto__:null,markValid:markValid,markInvalid:markInvalid,query:query,run:run$1,isInvalid:function(component,invalidConfig){var elem=invalidConfig.getRoot(component).getOr(component.element());return has$2(elem,invalidConfig.invalidClass)}}),ActiveInvalidate=Object.freeze({__proto__:null,events:function(invalidConfig,invalidState){return invalidConfig.validator.map(function(validatorInfo){return derive([run(validatorInfo.onEvent,function(component){run$1(component,invalidConfig).get(identity)})].concat(validatorInfo.validateOnLoad?[runOnAttached(function(component){run$1(component,invalidConfig).get(noop)})]:[]))}).getOr({})}}),InvalidateSchema=[strict$1("invalidClass"),defaulted$1("getRoot",Option.none),optionObjOf("notify",[defaulted$1("aria","alert"),defaulted$1("getContainer",Option.none),defaulted$1("validHtml",""),onHandler("onValid"),onHandler("onInvalid"),onHandler("onValidate")]),optionObjOf("validator",[strict$1("validate"),defaulted$1("onEvent","input"),defaulted$1("validateOnLoad",!0)])],Invalidating=create$1({fields:InvalidateSchema,name:"invalidating",active:ActiveInvalidate,apis:InvalidateApis,extra:{validation:function(validator){return function(component){var v=Representing.getValue(component);return Future_pure(validator(v))}}}}),ActiveTabstopping=Object.freeze({__proto__:null,exhibit:function(base,tabConfig){return nu$6({attributes:wrapAll$1([{key:tabConfig.tabAttr,value:"true"}])})}}),TabstopSchema=[defaulted$1("tabAttr","data-alloy-tabstop")],Tabstopping=create$1({fields:TabstopSchema,name:"tabstopping",active:ActiveTabstopping}),renderFormFieldSpecWith=function(pLabel,pField,extraClasses,extraBehaviours){return{dom:renderFormFieldDomWith(extraClasses),components:pLabel.toArray().concat([pField]),fieldBehaviours:derive$1(extraBehaviours)}},renderFormFieldDomWith=function(extraClasses){return{tag:"div",classes:["tox-form__group"].concat(extraClasses)}},CouplingApis=Object.freeze({__proto__:null,getCoupled:function(component,coupleConfig,coupleState,name){return coupleState.getOrCreate(component,coupleConfig,name)}}),CouplingSchema=[strictOf("others",setOf$1(Result.value,anyValue$1()))],Coupling=create$1({fields:CouplingSchema,name:"coupling",apis:CouplingApis,state:Object.freeze({__proto__:null,init:function(){var coupled={},readState=constant({});return nu$5({readState:readState,getOrCreate:function(component,coupleConfig,name){var available=keys(coupleConfig.others);if(available)return get(coupled,name).getOrThunk(function(){var spec=get(coupleConfig.others,name).getOrDie("No information found for coupled component: "+name)(component),built=component.getSystem().build(spec);return coupled[name]=built});throw new Error("Cannot find coupled component: "+name+". Known coupled components: "+JSON.stringify(available,null,2))}})}})}),suffix=constant("sink"),partType=constant(optional({name:suffix(),overrides:constant({dom:{tag:"div"},behaviours:derive$1([Positioning.config({useFixed:always})]),events:derive([cutter(keydown()),cutter(mousedown()),cutter(click())])})}));!function(HighlightOnOpen){HighlightOnOpen[HighlightOnOpen.HighlightFirst=0]="HighlightFirst",HighlightOnOpen[HighlightOnOpen.HighlightNone=1]="HighlightNone"}(HighlightOnOpen=HighlightOnOpen||{});function getAnchor(detail,component){var hotspot=detail.getHotspot(component).getOr(component),overrides=detail.getAnchorOverrides();return detail.layouts.fold(function(){return{anchor:"hotspot",hotspot:hotspot,overrides:overrides}},function(layouts){return{anchor:"hotspot",hotspot:hotspot,overrides:overrides,layouts:layouts}})}function open$1(detail,mapFetch,hotspot,sandbox,externals,onOpenSync,highlightOnOpen){return function(detail,mapFetch,anchor,component,sandbox,externals,highlightOnOpen){var futureData=function(detail,mapFetch,component){return(0,detail.fetch)(component).map(mapFetch)}(detail,mapFetch,component),getLazySink=getSink(component,detail);return futureData.map(function(tdata){return tdata.bind(function(data){return Option.from(tieredMenu.sketch(__assign(__assign({},externals.menu()),{uid:generate$2(""),data:data,highlightImmediately:highlightOnOpen===HighlightOnOpen.HighlightFirst,onOpenMenu:function(tmenu,menu){var sink=getLazySink().getOrDie();Positioning.position(sink,anchor,menu),Sandboxing.decloak(sandbox)},onOpenSubmenu:function(tmenu,item,submenu){var sink=getLazySink().getOrDie();Positioning.position(sink,{anchor:"submenu",item:item},submenu),Sandboxing.decloak(sandbox)},onRepositionMenu:function(tmenu,primaryMenu,submenuTriggers){var sink=getLazySink().getOrDie();Positioning.position(sink,anchor,primaryMenu),each(submenuTriggers,function(st){Positioning.position(sink,{anchor:"submenu",item:st.triggeringItem},st.triggeredMenu)})},onEscape:function(){return Focusing.focus(component),Sandboxing.close(sandbox),Option.some(!0)}})))})})}(detail,mapFetch,getAnchor(detail,hotspot),hotspot,sandbox,externals,highlightOnOpen).map(function(tdata){return tdata.fold(function(){Sandboxing.isOpen(sandbox)&&Sandboxing.close(sandbox)},function(data){Sandboxing.cloak(sandbox),Sandboxing.open(sandbox,data),onOpenSync(sandbox)}),sandbox})}function close$1(detail,mapFetch,component,sandbox,_externals,_onOpenSync,_highlightOnOpen){return Sandboxing.close(sandbox),Future_pure(sandbox)}function togglePopup(detail,mapFetch,hotspot,externals,onOpenSync,highlightOnOpen){var sandbox=Coupling.getCoupled(hotspot,"sandbox");return(Sandboxing.isOpen(sandbox)?close$1:open$1)(detail,mapFetch,hotspot,sandbox,externals,onOpenSync,highlightOnOpen)}function matchWidth(hotspot,container,useMinWidth){var menu=Composing.getCurrent(container).getOr(container),buttonWidth=get$7(hotspot.element());useMinWidth?set$2(menu.element(),"min-width",buttonWidth+"px"):function(element,h){api$1.set(element,h)}(menu.element(),buttonWidth)}function doRepositionMenus(sandbox){Sandboxing.getState(sandbox).each(function(tmenu){tieredMenu.repositionMenus(tmenu)})}function makeSandbox(detail,hotspot,extras){var ariaOwner=manager(),lazySink=getSink(hotspot,detail);return{dom:{tag:"div",classes:detail.sandboxClasses,attributes:{id:ariaOwner.id(),role:"listbox"}},behaviours:SketchBehaviours_augment(detail.sandboxBehaviours,[Representing.config({store:{mode:"memory",initialValue:hotspot}}),Sandboxing.config({onOpen:function(component,menu){var anchor=getAnchor(detail,hotspot);ariaOwner.link(hotspot.element()),detail.matchWidth&&matchWidth(anchor.hotspot,menu,detail.useMinWidth),detail.onOpen(anchor,component,menu),void 0!==extras&&void 0!==extras.onOpen&&extras.onOpen(component,menu)},onClose:function(component,menu){ariaOwner.unlink(hotspot.element()),void 0!==extras&&void 0!==extras.onClose&&extras.onClose(component,menu)},isPartOf:function(container,data,queryElem){return isPartOf(data,queryElem)||isPartOf(hotspot,queryElem)},getAttachPoint:function(){return lazySink().getOrDie()}}),Composing.config({find:function(sandbox){return Sandboxing.getState(sandbox).bind(function(menu){return Composing.getCurrent(menu)})}}),Receiving.config({channels:__assign(__assign({},receivingChannel({isExtraPart:never})),receivingChannel$1({doReposition:doRepositionMenus}))})])}}function repositionMenus(comp){var sandbox=Coupling.getCoupled(comp,"sandbox");doRepositionMenus(sandbox)}function sandboxFields(){return[defaulted$1("sandboxClasses",[]),SketchBehaviours_field("sandboxBehaviours",[Composing,Receiving,Sandboxing,Representing])]}function renderColorInput(spec,sharedBackstage,colorInputBackstage){function emitSwatchChange(colorBit,value){emitWith(colorBit,colorSwatchChangeEvent,{value:value})}var pField=FormField.parts().field({factory:Input,inputClasses:["tox-textfield"],onSetValue:function(c){return Invalidating.run(c).get(function(){})},inputBehaviours:derive$1([Tabstopping.config({}),Invalidating.config({invalidClass:"tox-textbox-field-invalid",getRoot:function(comp){return parent(comp.element())},notify:{onValid:function(comp){var val=Representing.getValue(comp);emitWith(comp,colorInputChangeEvent,{color:val})}},validator:{validateOnLoad:!1,validate:function(input){var inputValue=Representing.getValue(input);if(0===inputValue.length)return Future_pure(Result.value(!0));var span=Element.fromTag("span");set$2(span,"background-color",inputValue);var res=getRaw(span,"background-color").fold(function(){return Result.error("blah")},function(_){return Result.value(inputValue)});return Future_pure(res)}}})]),selectOnFocus:!1}),pLabel=spec.label.map(function(label){return renderLabel(label,sharedBackstage.providers)}),memColorButton=record(function(spec,sharedBackstage){return Dropdown.sketch({dom:spec.dom,components:spec.components,toggleClass:"mce-active",dropdownBehaviours:derive$1([Unselecting.config({}),Tabstopping.config({})]),layouts:spec.layouts,sandboxClasses:["tox-dialog__popups"],lazySink:sharedBackstage.getSink,fetch:function(comp){return Future_nu(function(callback){return spec.fetch(callback)}).map(function(items){return Option.from(createTieredDataFrom(deepMerge(createPartialChoiceMenu(generate$1("menu-value"),items,function(value){spec.onItemAction(comp,value)},spec.columns,spec.presets,ItemResponse$1.CLOSE_ON_EXECUTE,function(){return!1},sharedBackstage.providers),{movement:deriveMenuMovement(spec.columns,spec.presets)})))})},parts:{menu:part(0,0,spec.presets)}})}({dom:{tag:"span",attributes:{"aria-label":sharedBackstage.providers.translate("Color swatch")}},layouts:{onRtl:function(){return[southwest$1,southeast$1,south$1]},onLtr:function(){return[southeast$1,southwest$1,south$1]}},components:[],fetch:ColorSwatch.getFetch(colorInputBackstage.getColors(),colorInputBackstage.hasCustomColors()),columns:colorInputBackstage.getColorCols(),presets:"color",onItemAction:function(comp,value){memColorButton.getOpt(comp).each(function(colorBit){"custom"===value?colorInputBackstage.colorPicker(function(valueOpt){valueOpt.fold(function(){return emit(colorBit,colorPickerCancelEvent)},function(value){emitSwatchChange(colorBit,value),Settings_addColor(value)})},"#ffffff"):emitSwatchChange(colorBit,"remove"===value?"":value)})}},sharedBackstage));return FormField.sketch({dom:{tag:"div",classes:["tox-form__group"]},components:pLabel.toArray().concat([{dom:{tag:"div",classes:["tox-color-input"]},components:[pField,memColorButton.asSpec()]}]),fieldBehaviours:derive$1([config("form-field-events",[run(colorInputChangeEvent,function(comp,se){memColorButton.getOpt(comp).each(function(colorButton){set$2(colorButton.element(),"background-color",se.event().color())}),emitWith(comp,formChangeEvent,{name:spec.name})}),run(colorSwatchChangeEvent,function(comp,se){FormField.getField(comp).each(function(field){Representing.setValue(field,se.event().value()),Composing.getCurrent(comp).each(Focusing.focus)})}),run(colorPickerCancelEvent,function(comp,se){FormField.getField(comp).each(function(field){Composing.getCurrent(comp).each(Focusing.focus)})})])])})}function hsvColour(hue,saturation,value){return{hue:constant(hue),saturation:constant(saturation),value:constant(value)}}function edgePart(name){return optional({name:name+"-edge",overrides:function(detail){return detail.model.manager.edgeActions[name].fold(function(){return{}},function(a){return{events:derive([runActionExtra(touchstart(),function(comp,se,d){return a(comp,d)},[detail]),runActionExtra(mousedown(),function(comp,se,d){return a(comp,d)},[detail]),runActionExtra(mousemove(),function(comp,se,det){det.mouseIsDown.get()&&a(comp,det)},[detail])])}})}})}function getEventSource(simulatedEvent){var evt=simulatedEvent.event().raw();if(function(evt){return-1!==evt.type.indexOf("touch")}(evt)){var touchEvent=evt;return void 0!==touchEvent.touches&&1===touchEvent.touches.length?Option.some(touchEvent.touches[0]).map(function(t){return Position(t.clientX,t.clientY)}):Option.none()}var mouseEvent=evt;return void 0!==mouseEvent.clientX?Option.some(mouseEvent).map(function(me){return Position(me.clientX,me.clientY)}):Option.none()}function minX(detail){return detail.model.minX}function minY(detail){return detail.model.minY}function min1X(detail){return detail.model.minX-1}function min1Y(detail){return detail.model.minY-1}function maxX(detail){return detail.model.maxX}function maxY(detail){return detail.model.maxY}function max1X(detail){return detail.model.maxX+1}function max1Y(detail){return detail.model.maxY+1}function range$2(detail,max,min){return max(detail)-min(detail)}function xRange(detail){return range$2(detail,maxX,minX)}function yRange(detail){return range$2(detail,maxY,minY)}function halfX(detail){return xRange(detail)/2}function halfY(detail){return yRange(detail)/2}function step(detail){return detail.stepSize}function snap(detail){return detail.snapToGrid}function snapStart(detail){return detail.snapStart}function rounded(detail){return detail.rounded}function hasEdge(detail,edgeName){return void 0!==detail[edgeName+"-edge"]}function hasLEdge(detail){return hasEdge(detail,"left")}function hasREdge(detail){return hasEdge(detail,"right")}function hasTEdge(detail){return hasEdge(detail,"top")}function hasBEdge(detail){return hasEdge(detail,"bottom")}function currentValue(detail){return detail.model.value.get()}function xValue(x){return{x:constant(x)}}function yValue(y){return{y:constant(y)}}function xyValue(x,y){return{x:constant(x),y:constant(y)}}function fireSliderChange(component,value){emitWith(component,sliderChangeEvent(),{value:value})}function reduceBy(value,min,max,step){return value<min?value:max<value?max:value===min?min-1:Math.max(min,value-step)}function increaseBy(value,min,max,step){return max<value?value:value<min?min:value===max?max+1:Math.min(max,value+step)}function capValue(value,min,max){return Math.max(min,Math.min(max,value))}function findValueOf(args){var min=args.min,max=args.max,range=args.range,value=args.value,step=args.step,snap=args.snap,snapStart=args.snapStart,rounded=args.rounded,hasMinEdge=args.hasMinEdge,hasMaxEdge=args.hasMaxEdge,minBound=args.minBound,maxBound=args.maxBound,screenRange=args.screenRange,capMin=hasMinEdge?min-1:min,capMax=hasMaxEdge?max+1:max;if(value<minBound)return capMin;if(maxBound<value)return capMax;var offset=function(value,min,max){return Math.min(max,Math.max(value,min))-min}(value,minBound,maxBound),newValue=capValue(offset/screenRange*range+min,capMin,capMax);return snap&&min<=newValue&&newValue<=max?function(value,min,max,step,snapStart){return snapStart.fold(function(){var initValue=value-min,extraValue=Math.round(initValue/step)*step;return capValue(min+extraValue,min-1,max+1)},function(start){var remainder=(value-start)%step,adjustment=Math.round(remainder/step),rawSteps=Math.floor((value-start)/step),maxSteps=Math.floor((max-start)/step),r=start+Math.min(maxSteps,rawSteps+adjustment)*step;return Math.max(start,r)})}(newValue,min,max,step,snapStart):rounded?Math.round(newValue):newValue}function findOffsetOfValue(args){var min=args.min,max=args.max,range=args.range,value=args.value,hasMinEdge=args.hasMinEdge,hasMaxEdge=args.hasMaxEdge,maxBound=args.maxBound,maxOffset=args.maxOffset,centerMinEdge=args.centerMinEdge,centerMaxEdge=args.centerMaxEdge;return value<min?hasMinEdge?0:centerMinEdge:max<value?hasMaxEdge?maxBound:centerMaxEdge:(value-min)/range*maxOffset}function getBounds$1(component){return component.element().dom().getBoundingClientRect()}function getBoundsProperty(bounds,property){return bounds[property]}function getMinXBounds(component){var bounds=getBounds$1(component);return getBoundsProperty(bounds,"left")}function getMaxXBounds(component){var bounds=getBounds$1(component);return getBoundsProperty(bounds,"right")}function getMinYBounds(component){var bounds=getBounds$1(component);return getBoundsProperty(bounds,"top")}function getMaxYBounds(component){var bounds=getBounds$1(component);return getBoundsProperty(bounds,"bottom")}function getXScreenRange(component){var bounds=getBounds$1(component);return getBoundsProperty(bounds,"width")}function getYScreenRange(component){var bounds=getBounds$1(component);return getBoundsProperty(bounds,"height")}function getCenterOffsetOf(componentMinEdge,componentMaxEdge,spectrumMinEdge){return(componentMinEdge+componentMaxEdge)/2-spectrumMinEdge}function getXCenterOffSetOf(component,spectrum){var componentBounds=getBounds$1(component),spectrumBounds=getBounds$1(spectrum),componentMinEdge=getBoundsProperty(componentBounds,"left"),componentMaxEdge=getBoundsProperty(componentBounds,"right"),spectrumMinEdge=getBoundsProperty(spectrumBounds,"left");return getCenterOffsetOf(componentMinEdge,componentMaxEdge,spectrumMinEdge)}function getYCenterOffSetOf(component,spectrum){var componentBounds=getBounds$1(component),spectrumBounds=getBounds$1(spectrum),componentMinEdge=getBoundsProperty(componentBounds,"top"),componentMaxEdge=getBoundsProperty(componentBounds,"bottom"),spectrumMinEdge=getBoundsProperty(spectrumBounds,"top");return getCenterOffsetOf(componentMinEdge,componentMaxEdge,spectrumMinEdge)}function fireSliderChange$1(spectrum,value){emitWith(spectrum,sliderChangeEvent(),{value:value})}function sliderValue(x){return{x:constant(x)}}function findValueOfOffset(spectrum,detail,left){var args={min:minX(detail),max:maxX(detail),range:xRange(detail),value:left,step:step(detail),snap:snap(detail),snapStart:snapStart(detail),rounded:rounded(detail),hasMinEdge:hasLEdge(detail),hasMaxEdge:hasREdge(detail),minBound:getMinXBounds(spectrum),maxBound:getMaxXBounds(spectrum),screenRange:getXScreenRange(spectrum)};return findValueOf(args)}function handleMovement(direction){return function(spectrum,detail){return function(direction,spectrum,detail){var xValue=(0<direction?increaseBy:reduceBy)(currentValue(detail).x(),minX(detail),maxX(detail),step(detail));return fireSliderChange$1(spectrum,sliderValue(xValue)),Option.some(xValue)}(direction,spectrum,detail).map(function(){return!0})}}function findPositionOfValue(slider,spectrum,value,minEdge,maxEdge,detail){var offset=function(spectrum,detail,value,minEdge,maxEdge){var maxOffset=getXScreenRange(spectrum),centerMinEdge=minEdge.bind(function(edge){return Option.some(getXCenterOffSetOf(edge,spectrum))}).getOr(0),centerMaxEdge=maxEdge.bind(function(edge){return Option.some(getXCenterOffSetOf(edge,spectrum))}).getOr(maxOffset),args={min:minX(detail),max:maxX(detail),range:xRange(detail),value:value,hasMinEdge:hasLEdge(detail),hasMaxEdge:hasREdge(detail),minBound:getMinXBounds(spectrum),minOffset:0,maxBound:getMaxXBounds(spectrum),maxOffset:maxOffset,centerMinEdge:centerMinEdge,centerMaxEdge:centerMaxEdge};return findOffsetOfValue(args)}(spectrum,detail,value,minEdge,maxEdge);return getMinXBounds(spectrum)-getMinXBounds(slider)+offset}function fireSliderChange$2(spectrum,value){emitWith(spectrum,sliderChangeEvent(),{value:value})}function sliderValue$1(y){return{y:constant(y)}}function findValueOfOffset$1(spectrum,detail,top){var args={min:minY(detail),max:maxY(detail),range:yRange(detail),value:top,step:step(detail),snap:snap(detail),snapStart:snapStart(detail),rounded:rounded(detail),hasMinEdge:hasTEdge(detail),hasMaxEdge:hasBEdge(detail),minBound:getMinYBounds(spectrum),maxBound:getMaxYBounds(spectrum),screenRange:getYScreenRange(spectrum)};return findValueOf(args)}function handleMovement$1(direction){return function(spectrum,detail){return function(direction,spectrum,detail){var yValue=(0<direction?increaseBy:reduceBy)(currentValue(detail).y(),minY(detail),maxY(detail),step(detail));return fireSliderChange$2(spectrum,sliderValue$1(yValue)),Option.some(yValue)}(direction,spectrum,detail).map(function(){return!0})}}function findPositionOfValue$1(slider,spectrum,value,minEdge,maxEdge,detail){var offset=function(spectrum,detail,value,minEdge,maxEdge){var maxOffset=getYScreenRange(spectrum),centerMinEdge=minEdge.bind(function(edge){return Option.some(getYCenterOffSetOf(edge,spectrum))}).getOr(0),centerMaxEdge=maxEdge.bind(function(edge){return Option.some(getYCenterOffSetOf(edge,spectrum))}).getOr(maxOffset),args={min:minY(detail),max:maxY(detail),range:yRange(detail),value:value,hasMinEdge:hasTEdge(detail),hasMaxEdge:hasBEdge(detail),minBound:getMinYBounds(spectrum),minOffset:0,maxBound:getMaxYBounds(spectrum),maxOffset:maxOffset,centerMinEdge:centerMinEdge,centerMaxEdge:centerMaxEdge};return findOffsetOfValue(args)}(spectrum,detail,value,minEdge,maxEdge);return getMinYBounds(spectrum)-getMinYBounds(slider)+offset}function fireSliderChange$3(spectrum,value){emitWith(spectrum,sliderChangeEvent(),{value:value})}function sliderValue$2(x,y){return{x:constant(x),y:constant(y)}}function handleMovement$2(direction,isVerticalMovement){return function(spectrum,detail){return function(direction,isVerticalMovement,spectrum,detail){var f=0<direction?increaseBy:reduceBy,xValue=isVerticalMovement?currentValue(detail).x():f(currentValue(detail).x(),minX(detail),maxX(detail),step(detail)),yValue=isVerticalMovement?f(currentValue(detail).y(),minY(detail),maxY(detail),step(detail)):currentValue(detail).y();return fireSliderChange$3(spectrum,sliderValue$2(xValue,yValue)),Option.some(xValue)}(direction,isVerticalMovement,spectrum,detail).map(function(){return!0})}}function getPartName(name){return"<alloy.field."+name+">"}function rgbFormFactory(translate,getClass,onValidHexx,onInvalidHexx){function renderTextField(isValid,name,label,description,data){var helptext=translate("colorcustom.rgb.range"),comps=[FormField.parts().label({dom:{tag:"label",innerHtml:label,attributes:{"aria-label":description}}}),FormField.parts().field({data:data,factory:Input,inputAttributes:__assign({type:"text"},"hex"===name?{"aria-live":"polite"}:{}),inputClasses:[getClass("textfield")],inputBehaviours:derive$1([function(label,isValid){return Invalidating.config({invalidClass:getClass("invalid"),notify:{onValidate:function(comp){emitWith(comp,validatingInput,{type:label})},onValid:function(comp){emitWith(comp,validInput,{type:label,value:Representing.getValue(comp)})},onInvalid:function(comp){emitWith(comp,invalidInput,{type:label,value:Representing.getValue(comp)})}},validator:{validate:function(comp){var value=Representing.getValue(comp),res=isValid(value)?Result.value(!0):Result.error(translate("aria.input.invalid"));return Future_pure(res)},validateOnLoad:!1}})}(name,isValid),Tabstopping.config({})]),onSetValue:function(input){Invalidating.isInvalid(input)&&Invalidating.run(input).get(noop)}})],concats="hex"!==name?[FormField.parts()["aria-descriptor"]({text:helptext})]:[];return{dom:{tag:"div",attributes:{role:"presentation"}},components:comps.concat(concats)}}function copyRgbToForm(form,rgb){var red=rgb.red(),green=rgb.green(),blue=rgb.blue();Representing.setValue(form,{red:red,green:green,blue:blue})}function updatePreview(anyInSystem,hex){memPreview.getOpt(anyInSystem).each(function(preview){set$2(preview.element(),"background-color","#"+hex.value())})}var memPreview=record({dom:{tag:"div",classes:[getClass("rgba-preview")],styles:{"background-color":"white"},attributes:{role:"presentation"}}});return single$2({factory:function(){function get(prop){return state[prop]().get()}function set(prop,value){state[prop]().set(value)}function onInvalidInput(form,simulatedEvent){var data=simulatedEvent.event();"hex"!==data.type()?set(data.type(),Option.none()):onInvalidHexx(form)}function onValidRgb(form,prop,value){var val=parseInt(value,10);set(prop,Option.some(val)),get("red").bind(function(red){return get("green").bind(function(green){return get("blue").map(function(blue){return rgbaColour(red,green,blue,1)})})}).each(function(rgb){var hex=function(form,rgba){var hex=fromRgba(rgba);return Form.getField(form,"hex").each(function(hexField){Focusing.isFocused(hexField)||Representing.setValue(form,{hex:hex.value()})}),hex}(form,rgb);updatePreview(form,hex)})}function onValidInput(form,simulatedEvent){var data=simulatedEvent.event();!function(data){return"hex"===data.type()}(data)?onValidRgb(form,data.type(),data.value()):function(form,value){onValidHexx(form);var hex=hexColour(value);set("hex",Option.some(value));var rgb=fromHex(hex);copyRgbToForm(form,rgb),setValueRgb(rgb),emitWith(form,fieldsUpdate(),{hex:hex}),updatePreview(form,hex)}(form,data.value())}function formPartStrings(key){return{label:translate("colorcustom.rgb."+key+".label"),description:translate("colorcustom.rgb."+key+".description")}}var state={red:constant(Cell(Option.some(255))),green:constant(Cell(Option.some(255))),blue:constant(Cell(Option.some(255))),hex:constant(Cell(Option.some("ffffff")))},setValueRgb=function(rgb){var red=rgb.red(),green=rgb.green(),blue=rgb.blue();set("red",Option.some(red)),set("green",Option.some(green)),set("blue",Option.some(blue))},redStrings=formPartStrings("red"),greenStrings=formPartStrings("green"),blueStrings=formPartStrings("blue"),hexStrings=formPartStrings("hex");return deepMerge(Form.sketch(function(parts){return{dom:{tag:"form",classes:[getClass("rgb-form")],attributes:{"aria-label":translate("aria.color.picker")}},components:[parts.field("red",FormField.sketch(renderTextField(isRgbaComponent,"red",redStrings.label,redStrings.description,255))),parts.field("green",FormField.sketch(renderTextField(isRgbaComponent,"green",greenStrings.label,greenStrings.description,255))),parts.field("blue",FormField.sketch(renderTextField(isRgbaComponent,"blue",blueStrings.label,blueStrings.description,255))),parts.field("hex",FormField.sketch(renderTextField(isHexString,"hex",hexStrings.label,hexStrings.description,"ffffff"))),memPreview.asSpec()],formBehaviours:derive$1([Invalidating.config({invalidClass:getClass("form-invalid")}),config("rgb-form-events",[run(validInput,onValidInput),run(invalidInput,onInvalidInput),run(validatingInput,onInvalidInput)])])}}),{apis:{updateHex:function(form,hex){Representing.setValue(form,{hex:hex.value()}),function(form,hex){var rgb=fromHex(hex);copyRgbToForm(form,rgb),setValueRgb(rgb)}(form,hex),updatePreview(form,hex)}}})},name:"RgbForm",configFields:[],apis:{updateHex:function(apis,form,hex){apis.updateHex(form,hex)}},extraApis:{}})}function paletteFactory(_translate,getClass){function setColour(canvas,rgba){var width=canvas.width,height=canvas.height,ctx=canvas.getContext("2d");if(null!==ctx){ctx.fillStyle=rgba,ctx.fillRect(0,0,width,height);var grdWhite=ctx.createLinearGradient(0,0,width,0);grdWhite.addColorStop(0,"rgba(255,255,255,1)"),grdWhite.addColorStop(1,"rgba(255,255,255,0)"),ctx.fillStyle=grdWhite,ctx.fillRect(0,0,width,height);var grdBlack=ctx.createLinearGradient(0,0,0,height);grdBlack.addColorStop(0,"rgba(0,0,0,0)"),grdBlack.addColorStop(1,"rgba(0,0,0,1)"),ctx.fillStyle=grdBlack,ctx.fillRect(0,0,width,height)}}var spectrumPart=Slider.parts().spectrum({dom:{tag:"canvas",attributes:{role:"presentation"},classes:[getClass("sv-palette-spectrum")]}}),thumbPart=Slider.parts().thumb({dom:{tag:"div",attributes:{role:"presentation"},classes:[getClass("sv-palette-thumb")],innerHtml:"<div class="+getClass("sv-palette-inner-thumb")+' role="presentation"></div>'}});return single$2({factory:function(_detail){var getInitialValue=constant({x:constant(0),y:constant(0)}),sliderBehaviours=derive$1([Composing.config({find:Option.some}),Focusing.config({})]);return Slider.sketch({dom:{tag:"div",attributes:{role:"presentation"},classes:[getClass("sv-palette")]},model:{mode:"xy",getInitialValue:getInitialValue},rounded:!1,components:[spectrumPart,thumbPart],onChange:function(slider,_thumb,value){emitWith(slider,paletteUpdate(),{value:value})},onInit:function(_slider,_thumb,spectrum,_value){setColour(spectrum.element().dom(),toString(redColour()))},sliderBehaviours:sliderBehaviours})},name:"SaturationBrightnessPalette",configFields:[],apis:{setRgba:function(_apis,slider,rgba){!function(slider,rgba){var canvas=slider.components()[0].element().dom();setColour(canvas,toString(rgba))}(slider,rgba)}},extraApis:{}})}function makeFactory(translate,getClass){return single$2({name:"ColourPicker",configFields:[strict$1("dom"),defaulted$1("onValidHex",noop),defaulted$1("onInvalidHex",noop)],factory:function(detail){function updatePalette(anyInSystem,hex){memPalette.getOpt(anyInSystem).each(function(palette){var rgba=fromHex(hex);state.paletteRgba().set(rgba),sbPalette.setRgba(palette,rgba)})}function updateFields(anyInSystem,hex){memRgb.getOpt(anyInSystem).each(function(form){rgbForm.updateHex(form,hex)})}function runUpdates(anyInSystem,hex,updates){each(updates,function(update){update(anyInSystem,hex)})}var updates,rgbForm=rgbFormFactory(translate,getClass,detail.onValidHex,detail.onInvalidHex),sbPalette=paletteFactory(0,getClass),state={paletteRgba:constant(Cell(redColour()))},memPalette=record(sbPalette.sketch({})),memRgb=record(rgbForm.sketch({}));return{uid:detail.uid,dom:detail.dom,components:[memPalette.asSpec(),function(translate,getClass){var spectrum=Slider.parts().spectrum({dom:{tag:"div",classes:[getClass("hue-slider-spectrum")],attributes:{role:"presentation"}}}),thumb=Slider.parts().thumb({dom:{tag:"div",classes:[getClass("hue-slider-thumb")],attributes:{role:"presentation"}}});return Slider.sketch({dom:{tag:"div",classes:[getClass("hue-slider")],attributes:{role:"presentation"}},rounded:!1,model:{mode:"y",getInitialValue:constant({y:constant(0)})},components:[spectrum,thumb],sliderBehaviours:derive$1([Focusing.config({})]),onChange:function(slider,_thumb,value){emitWith(slider,sliderUpdate(),{value:value})}})}(0,getClass),memRgb.asSpec()],behaviours:derive$1([config("colour-picker-events",[run(paletteUpdate(),(updates=[updateFields],function(form,simulatedEvent){var value=simulatedEvent.event().value(),hsvColour$1=function(rgbaColour){var s,h=0,v=0,r=rgbaColour.red()/255,g=rgbaColour.green()/255,b=rgbaColour.blue()/255,minRGB=Math.min(r,Math.min(g,b)),maxRGB=Math.max(r,Math.max(g,b));return minRGB===maxRGB?hsvColour(0,0,100*(v=minRGB)):(h=60*((h=r===minRGB?3:b===minRGB?1:5)-(r===minRGB?g-b:b===minRGB?r-g:b-r)/(maxRGB-minRGB)),s=(maxRGB-minRGB)/maxRGB,v=maxRGB,hsvColour(Math.round(h),Math.round(100*s),Math.round(100*v)))}(state.paletteRgba().get()),newHsvColour=hsvColour(hsvColour$1.hue(),value.x(),100-value.y()),rgb=fromHsv(newHsvColour),nuHex=fromRgba(rgb);runUpdates(form,nuHex,updates)})),run(sliderUpdate(),function(){var updates=[updatePalette,updateFields];return function(form,simulatedEvent){var hex=function(value){var hsv=hsvColour((100-value)/100*360,100,100),rgb=fromHsv(hsv);return fromRgba(rgb)}(simulatedEvent.event().value().y());runUpdates(form,hex,updates)}}())]),Composing.config({find:function(comp){return memRgb.getOpt(comp)}}),Keying.config({mode:"acyclic"})])}}})}function translate$1(key){return function(key){return english[key]}(key)}function withComp(optInitialValue,getter,setter){return Representing.config(deepMerge({store:{mode:"manual",getValue:getter,setValue:setter}},optInitialValue.map(function(initialValue){return{store:{initialValue:initialValue}}}).getOr({})))}function withElement(initialValue,getter,setter){return withComp(initialValue,function(c){return getter(c.element())},function(c,v){return setter(c.element(),v)})}function renderDropZone(spec,providersBackstage){function stopper(_,se){se.stop()}function sequence(actions){return function(comp,se){each(actions,function(a){a(comp,se)})}}function onDrop(comp,se){if(!Disabling.isDisabled(comp)){var transferEvent=se.event().raw();handleFiles(comp,transferEvent.dataTransfer.files)}}function onSelect(component,simulatedEvent){var files=simulatedEvent.event().raw().target.files;handleFiles(component,files)}var handleFiles=function(component,files){Representing.setValue(component,function(files){var re=new RegExp("("+".jpg,.jpeg,.png,.gif".split(/\s*,\s*/).join("|")+")$","i");return filter(from$1(files),function(file){return re.test(file.name)})}(files)),emitWith(component,formChangeEvent,{name:spec.name})},memInput=record({dom:{tag:"input",attributes:{type:"file",accept:"image/*"},styles:{display:"none"}},behaviours:derive$1([config("input-file-events",[cutter(click()),cutter(tap())])])}),pLabel=spec.label.map(function(label){return renderLabel(label,providersBackstage)}),pField=FormField.parts().field({factory:{sketch:function(s){return{uid:s.uid,dom:{tag:"div",classes:["tox-dropzone-container"]},behaviours:derive$1([RepresentingConfigs_memory([]),ComposingConfigs_self(),Disabling.config({}),Toggling.config({toggleClass:"dragenter",toggleOnExecute:!1}),config("dropzone-events",[run("dragenter",sequence([stopper,Toggling.toggle])),run("dragleave",sequence([stopper,Toggling.toggle])),run("dragover",stopper),run("drop",sequence([stopper,onDrop])),run(change(),onSelect)])]),components:[{dom:{tag:"div",classes:["tox-dropzone"],styles:{}},components:[{dom:{tag:"p",innerHtml:providersBackstage.translate("Drop an image here")}},Button.sketch({dom:{tag:"button",innerHtml:providersBackstage.translate("Browse for an image"),styles:{position:"relative"},classes:["tox-button","tox-button--secondary"]},components:[memInput.asSpec()],action:function(comp){memInput.get(comp).element().dom().click()},buttonBehaviours:derive$1([Tabstopping.config({})])})]}]}}}});return renderFormFieldWith(pLabel,pField,["tox-form__group--stretched"],[])}function craftWithClasses(classes){return{dom:{tag:"div",styles:{width:"1px",height:"1px",outline:"none"},attributes:{tabindex:"0"},classes:classes},behaviours:derive$1([Focusing.config({ignore:!0}),Tabstopping.config({})])}}function triggerTab(placeholder,shiftKey){emitWith(placeholder,keydown(),{raw:{which:9,shiftKey:shiftKey}})}function renderIFrame(spec,providersBackstage){var isSandbox=platformNeedsSandboxing&&spec.sandboxed,attributes=__assign(__assign({},spec.label.map(function(title){return{title:title}}).getOr({})),isSandbox?{sandbox:"allow-scripts allow-same-origin"}:{}),sourcing=function(isSandbox){var cachedValue=Cell("");return{getValue:function(frameComponent){return cachedValue.get()},setValue:function(frameComponent,html){if(isSandbox)set$1(frameComponent.element(),"srcdoc",html);else{set$1(frameComponent.element(),"src","javascript:''");var doc=frameComponent.element().dom().contentWindow.document;doc.open(),doc.write(html),doc.close()}cachedValue.set(html)}}}(isSandbox),pLabel=spec.label.map(function(label){return renderLabel(label,providersBackstage)}),pField=FormField.parts().field({factory:{sketch:function(newSpec){return NavigableObject_craft({uid:newSpec.uid,dom:{tag:"iframe",attributes:attributes},behaviours:derive$1([Tabstopping.config({}),Focusing.config({}),RepresentingConfigs_withComp(Option.none(),sourcing.getValue,sourcing.setValue)])})}}});return renderFormFieldWith(pLabel,pField,["tox-form__group--stretched"],[])}var getSink=function(anyInSystem,sinkDetail){return anyInSystem.getSystem().getByUid(sinkDetail.uid+"-"+suffix()).map(function(internalSink){return function(){return Result.value(internalSink)}}).getOrThunk(function(){return sinkDetail.lazySink.fold(function(){return function(){return Result.error(new Error("No internal sink is specified, nor could an external sink be found"))}},function(lazySinkFn){return function(){return lazySinkFn(anyInSystem)}})})},schema$g=constant([strict$1("dom"),strict$1("fetch"),onHandler("onOpen"),onKeyboardHandler("onExecute"),defaulted$1("getHotspot",Option.some),defaulted$1("getAnchorOverrides",constant({})),schema$1(),field$1("dropdownBehaviours",[Toggling,Coupling,Keying,Focusing]),strict$1("toggleClass"),defaulted$1("eventOrder",{}),option("lazySink"),defaulted$1("matchWidth",!1),defaulted$1("useMinWidth",!1),option("role")].concat(sandboxFields())),parts$4=constant([external$1({schema:[tieredMenuMarkers()],name:"menu",defaults:function(detail){return{onExecute:detail.onExecute}}}),partType()]),Dropdown=composite$1({name:"Dropdown",configFields:schema$g(),partFields:parts$4(),factory:function(detail,components,_spec,externals){function switchToMenu(sandbox){Sandboxing.getState(sandbox).each(function(tmenu){tieredMenu.highlightPrimary(tmenu)})}function triggerExecute(comp,se){return emitExecute(comp),Option.some(!0)}var _a,attr,apis={expand:function(comp){Toggling.isOn(comp)||togglePopup(detail,function(x){return x},comp,externals,noop,HighlightOnOpen.HighlightNone).get(noop)},open:function(comp){Toggling.isOn(comp)||togglePopup(detail,function(x){return x},comp,externals,noop,HighlightOnOpen.HighlightFirst).get(noop)},isOpen:Toggling.isOn,close:function(comp){Toggling.isOn(comp)&&togglePopup(detail,function(x){return x},comp,externals,noop,HighlightOnOpen.HighlightFirst).get(noop)},repositionMenus:function(comp){Toggling.isOn(comp)&&repositionMenus(comp)}};return{uid:detail.uid,dom:detail.dom,components:components,behaviours:augment(detail.dropdownBehaviours,[Toggling.config({toggleClass:detail.toggleClass,aria:{mode:"expanded"}}),Coupling.config({others:{sandbox:function(hotspot){return makeSandbox(detail,hotspot,{onOpen:function(){Toggling.on(hotspot)},onClose:function(){Toggling.off(hotspot)}})}}}),Keying.config({mode:"special",onSpace:triggerExecute,onEnter:triggerExecute,onDown:function(comp,se){if(Dropdown.isOpen(comp)){var sandbox=Coupling.getCoupled(comp,"sandbox");switchToMenu(sandbox)}else Dropdown.open(comp);return Option.some(!0)},onEscape:function(comp,se){return Dropdown.isOpen(comp)?(Dropdown.close(comp),Option.some(!0)):Option.none()}}),Focusing.config({})]),events:events$7(Option.some(function(component){togglePopup(detail,function(x){return x},component,externals,switchToMenu,HighlightOnOpen.HighlightFirst).get(noop)})),eventOrder:__assign(__assign({},detail.eventOrder),(_a={},_a[execute()]=["disabling","toggling","alloy.base.behaviour"],_a)),apis:apis,domModification:{attributes:__assign(__assign({"aria-haspopup":"true"},detail.role.fold(function(){return{}},function(role){return{role:role}})),"button"===detail.dom.tag?{type:(attr="type",get(detail.dom,"attributes").bind(function(attrs){return get(attrs,attr)})).getOr("button")}:{})}}},apis:{open:function(apis,comp){return apis.open(comp)},expand:function(apis,comp){return apis.expand(comp)},close:function(apis,comp){return apis.close(comp)},isOpen:function(apis,comp){return apis.isOpen(comp)},repositionMenus:function(apis,comp){return apis.repositionMenus(comp)}}}),Unselecting=create$1({fields:[],name:"unselecting",active:Object.freeze({__proto__:null,events:function(){return derive([abort(selectstart(),constant(!0))])},exhibit:function(){return nu$6({styles:{"-webkit-user-select":"none","user-select":"none","-ms-user-select":"none","-moz-user-select":"-moz-none"},attributes:{unselectable:"on"}})}})}),colorInputChangeEvent=generate$1("color-input-change"),colorSwatchChangeEvent=generate$1("color-swatch-change"),colorPickerCancelEvent=generate$1("color-picker-cancel"),fieldsUpdate=constant(generate$1("rgb-hex-update")),sliderUpdate=constant(generate$1("slider-update")),paletteUpdate=constant(generate$1("palette-update")),labelPart=optional({schema:[strict$1("dom")],name:"label"}),tlEdgePart=edgePart("top-left"),tedgePart=edgePart("top"),trEdgePart=edgePart("top-right"),redgePart=edgePart("right"),brEdgePart=edgePart("bottom-right"),bedgePart=edgePart("bottom"),blEdgePart=edgePart("bottom-left"),SliderParts=[labelPart,edgePart("left"),redgePart,tedgePart,bedgePart,tlEdgePart,trEdgePart,blEdgePart,brEdgePart,required({name:"thumb",defaults:constant({dom:{styles:{position:"absolute"}}}),overrides:function(detail){return{events:derive([redirectToPart(touchstart(),detail,"spectrum"),redirectToPart(touchmove(),detail,"spectrum"),redirectToPart(touchend(),detail,"spectrum"),redirectToPart(mousedown(),detail,"spectrum"),redirectToPart(mousemove(),detail,"spectrum"),redirectToPart(mouseup(),detail,"spectrum")])}}}),required({schema:[state$1("mouseIsDown",function(){return Cell(!1)})],name:"spectrum",overrides:function(detail){function setValueFrom(component,simulatedEvent){return model.getValueFromEvent(simulatedEvent).map(function(value){return model.setValueFrom(component,detail,value)})}var model=detail.model.manager;return{behaviours:derive$1([Keying.config({mode:"special",onLeft:function(spectrum){return model.onLeft(spectrum,detail)},onRight:function(spectrum){return model.onRight(spectrum,detail)},onUp:function(spectrum){return model.onUp(spectrum,detail)},onDown:function(spectrum){return model.onDown(spectrum,detail)}}),Focusing.config({})]),events:derive([run(touchstart(),setValueFrom),run(touchmove(),setValueFrom),run(mousedown(),setValueFrom),run(mousemove(),function(spectrum,se){detail.mouseIsDown.get()&&setValueFrom(spectrum,se)})])}}})],sliderChangeEvent=constant("slider.change.value"),onLeft=handleMovement(-1),onRight=handleMovement(1),onUp=Option.none,onDown=Option.none,edgeActions={"top-left":Option.none(),top:Option.none(),"top-right":Option.none(),right:Option.some(function(edge,detail){fireSliderChange(edge,xValue(max1X(detail)))}),"bottom-right":Option.none(),bottom:Option.none(),"bottom-left":Option.none(),left:Option.some(function(edge,detail){fireSliderChange(edge,xValue(min1X(detail)))})},HorizontalModel=Object.freeze({__proto__:null,setValueFrom:function(spectrum,detail,value){var xValue=findValueOfOffset(spectrum,detail,value),sliderVal=sliderValue(xValue);return fireSliderChange$1(spectrum,sliderVal),xValue},setToMin:function(spectrum,detail){var min=minX(detail);fireSliderChange$1(spectrum,sliderValue(min))},setToMax:function(spectrum,detail){var max=maxX(detail);fireSliderChange$1(spectrum,sliderValue(max))},findValueOfOffset:findValueOfOffset,getValueFromEvent:function(simulatedEvent){return getEventSource(simulatedEvent).map(function(p){return p.left()})},findPositionOfValue:findPositionOfValue,setPositionFromValue:function(slider,thumb,detail,edges){var value=currentValue(detail),pos=findPositionOfValue(slider,edges.getSpectrum(slider),value.x(),edges.getLeftEdge(slider),edges.getRightEdge(slider),detail),thumbRadius=get$7(thumb.element())/2;set$2(thumb.element(),"left",pos-thumbRadius+"px")},onLeft:onLeft,onRight:onRight,onUp:onUp,onDown:onDown,edgeActions:edgeActions}),onLeft$1=Option.none,onRight$1=Option.none,onUp$1=handleMovement$1(-1),onDown$1=handleMovement$1(1),edgeActions$1={"top-left":Option.none(),top:Option.some(function(edge,detail){fireSliderChange(edge,yValue(min1Y(detail)))}),"top-right":Option.none(),right:Option.none(),"bottom-right":Option.none(),bottom:Option.some(function(edge,detail){fireSliderChange(edge,yValue(max1Y(detail)))}),"bottom-left":Option.none(),left:Option.none()},VerticalModel=Object.freeze({__proto__:null,setValueFrom:function(spectrum,detail,value){var yValue=findValueOfOffset$1(spectrum,detail,value),sliderVal=sliderValue$1(yValue);return fireSliderChange$2(spectrum,sliderVal),yValue},setToMin:function(spectrum,detail){var min=minY(detail);fireSliderChange$2(spectrum,sliderValue$1(min))},setToMax:function(spectrum,detail){var max=maxY(detail);fireSliderChange$2(spectrum,sliderValue$1(max))},findValueOfOffset:findValueOfOffset$1,getValueFromEvent:function(simulatedEvent){return getEventSource(simulatedEvent).map(function(p){return p.top()})},findPositionOfValue:findPositionOfValue$1,setPositionFromValue:function(slider,thumb,detail,edges){var value=currentValue(detail),pos=findPositionOfValue$1(slider,edges.getSpectrum(slider),value.y(),edges.getTopEdge(slider),edges.getBottomEdge(slider),detail),thumbRadius=get$6(thumb.element())/2;set$2(thumb.element(),"top",pos-thumbRadius+"px")},onLeft:onLeft$1,onRight:onRight$1,onUp:onUp$1,onDown:onDown$1,edgeActions:edgeActions$1}),onLeft$2=handleMovement$2(-1,!1),onRight$2=handleMovement$2(1,!1),onUp$2=handleMovement$2(-1,!0),onDown$2=handleMovement$2(1,!0),edgeActions$2={"top-left":Option.some(function(edge,detail){fireSliderChange(edge,xyValue(min1X(detail),min1Y(detail)))}),top:Option.some(function(edge,detail){fireSliderChange(edge,xyValue(halfX(detail),min1Y(detail)))}),"top-right":Option.some(function(edge,detail){fireSliderChange(edge,xyValue(max1X(detail),min1Y(detail)))}),right:Option.some(function(edge,detail){fireSliderChange(edge,xyValue(max1X(detail),halfY(detail)))}),"bottom-right":Option.some(function(edge,detail){fireSliderChange(edge,xyValue(max1X(detail),max1Y(detail)))}),bottom:Option.some(function(edge,detail){fireSliderChange(edge,xyValue(halfX(detail),max1Y(detail)))}),"bottom-left":Option.some(function(edge,detail){fireSliderChange(edge,xyValue(min1X(detail),max1Y(detail)))}),left:Option.some(function(edge,detail){fireSliderChange(edge,xyValue(min1X(detail),halfY(detail)))})},TwoDModel=Object.freeze({__proto__:null,setValueFrom:function(spectrum,detail,value){var xValue=findValueOfOffset(spectrum,detail,value.left()),yValue=findValueOfOffset$1(spectrum,detail,value.top()),val=sliderValue$2(xValue,yValue);return fireSliderChange$3(spectrum,val),val},setToMin:function(spectrum,detail){var mX=minX(detail),mY=minY(detail);fireSliderChange$3(spectrum,sliderValue$2(mX,mY))},setToMax:function(spectrum,detail){var mX=maxX(detail),mY=maxY(detail);fireSliderChange$3(spectrum,sliderValue$2(mX,mY))},getValueFromEvent:function(simulatedEvent){return getEventSource(simulatedEvent)},setPositionFromValue:function(slider,thumb,detail,edges){var value=currentValue(detail),xPos=findPositionOfValue(slider,edges.getSpectrum(slider),value.x(),edges.getLeftEdge(slider),edges.getRightEdge(slider),detail),yPos=findPositionOfValue$1(slider,edges.getSpectrum(slider),value.y(),edges.getTopEdge(slider),edges.getBottomEdge(slider),detail),thumbXRadius=get$7(thumb.element())/2,thumbYRadius=get$6(thumb.element())/2;set$2(thumb.element(),"left",xPos-thumbXRadius+"px"),set$2(thumb.element(),"top",yPos-thumbYRadius+"px")},onLeft:onLeft$2,onRight:onRight$2,onUp:onUp$2,onDown:onDown$2,edgeActions:edgeActions$2}),Slider=composite$1({name:"Slider",configFields:[defaulted$1("stepSize",1),defaulted$1("onChange",noop),defaulted$1("onChoose",noop),defaulted$1("onInit",noop),defaulted$1("onDragStart",noop),defaulted$1("onDragEnd",noop),defaulted$1("snapToGrid",!1),defaulted$1("rounded",!0),option("snapStart"),strictOf("model",choose$1("mode",{x:[defaulted$1("minX",0),defaulted$1("maxX",100),state$1("value",function(spec){return Cell(spec.mode.minX)}),strict$1("getInitialValue"),output("manager",HorizontalModel)],y:[defaulted$1("minY",0),defaulted$1("maxY",100),state$1("value",function(spec){return Cell(spec.mode.minY)}),strict$1("getInitialValue"),output("manager",VerticalModel)],xy:[defaulted$1("minX",0),defaulted$1("maxX",100),defaulted$1("minY",0),defaulted$1("maxY",100),state$1("value",function(spec){return Cell({x:constant(spec.mode.minX),y:constant(spec.mode.minY)})}),strict$1("getInitialValue"),output("manager",TwoDModel)]})),field$1("sliderBehaviours",[Keying,Representing]),state$1("mouseIsDown",function(){return Cell(!1)})],partFields:SliderParts,factory:function(detail,components,_spec,_externals){function getThumb(component){return getPartOrDie(component,detail,"thumb")}function getSpectrum(component){return getPartOrDie(component,detail,"spectrum")}function getLeftEdge(component){return getPart(component,detail,"left-edge")}function getRightEdge(component){return getPart(component,detail,"right-edge")}function getTopEdge(component){return getPart(component,detail,"top-edge")}function getBottomEdge(component){return getPart(component,detail,"bottom-edge")}function refresh(slider,thumb){model.setPositionFromValue(slider,thumb,detail,{getLeftEdge:getLeftEdge,getRightEdge:getRightEdge,getTopEdge:getTopEdge,getBottomEdge:getBottomEdge,getSpectrum:getSpectrum})}function changeValue(slider,newValue){modelDetail.value.set(newValue);var thumb=getThumb(slider);return refresh(slider,thumb),detail.onChange(slider,thumb,newValue),Option.some(!0)}function choose(slider){var wasDown=detail.mouseIsDown.get();detail.mouseIsDown.set(!1),wasDown&&getPart(slider,detail,"thumb").each(function(thumb){var value=modelDetail.value.get();detail.onChoose(slider,thumb,value)})}function onDragStart(slider,simulatedEvent){simulatedEvent.stop(),detail.mouseIsDown.set(!0),detail.onDragStart(slider,getThumb(slider))}function onDragEnd(slider,simulatedEvent){simulatedEvent.stop(),detail.onDragEnd(slider,getThumb(slider)),choose(slider)}var _a,modelDetail=detail.model,model=modelDetail.manager;return{uid:detail.uid,dom:detail.dom,components:components,behaviours:augment(detail.sliderBehaviours,[Keying.config({mode:"special",focusIn:function(slider){return getPart(slider,detail,"spectrum").map(Keying.focusIn).map(constant(!0))}}),Representing.config({store:{mode:"manual",getValue:function(_){return modelDetail.value.get()}}}),Receiving.config({channels:(_a={},_a[mouseReleased()]={onReceive:choose},_a)})]),events:derive([run(sliderChangeEvent(),function(slider,simulatedEvent){changeValue(slider,simulatedEvent.event().value())}),runOnAttached(function(slider,simulatedEvent){var getInitial=modelDetail.getInitialValue();modelDetail.value.set(getInitial);var thumb=getThumb(slider);refresh(slider,thumb);var spectrum=getSpectrum(slider);detail.onInit(slider,thumb,spectrum,modelDetail.value.get())}),run(touchstart(),onDragStart),run(touchend(),onDragEnd),run(mousedown(),onDragStart),run(mouseup(),onDragEnd)]),apis:{resetToMin:function(slider){model.setToMin(slider,detail)},resetToMax:function(slider){model.setToMax(slider,detail)},changeValue:changeValue,refresh:refresh},domModification:{styles:{position:"relative"}}}},apis:{resetToMin:function(apis,slider){apis.resetToMin(slider)},resetToMax:function(apis,slider){apis.resetToMax(slider)},refresh:function(apis,slider){apis.refresh(slider)}}}),schema$h=[field$1("formBehaviours",[Representing])],make$4=function(detail,components){return{uid:detail.uid,dom:detail.dom,components:components,behaviours:augment(detail.formBehaviours,[Representing.config({store:{mode:"manual",getValue:function(form){var resPs=getAllParts(form,detail);return map$1(resPs,function(resPThunk,pName){return resPThunk().bind(function(v){return function(o,e){return o.fold(function(){return Result.error(e)},Result.value)}(Composing.getCurrent(v),new Error("Cannot find a current component to extract the value from for form part '"+pName+"': "+element(v.element())))}).map(Representing.getValue)})},setValue:function(form,values){each$1(values,function(newValue,key){getPart(form,detail,key).each(function(wrapper){Composing.getCurrent(wrapper).each(function(field){Representing.setValue(field,newValue)})})})}}})]),apis:{getField:function(form,key){return getPart(form,detail,key).bind(Composing.getCurrent)}}}},Form={getField:makeApi(function(apis,component,key){return apis.getField(component,key)}),sketch:function(fSpec){var record,parts=(record=[],{field:function(name,config){return record.push(name),generateOne("form",getPartName(name),config)},record:function(){return record}}),spec=fSpec(parts),partNames=parts.record(),fieldParts=map(partNames,function(n){return required({name:n,pname:getPartName(n)})});return composite("form",schema$h,fieldParts,make$4,spec)}},validInput=generate$1("valid-input"),invalidInput=generate$1("invalid-input"),validatingInput=generate$1("validating-input"),ComposingConfigs_self=function(){return Composing.config({find:Option.some})},ComposingConfigs_memento=function(mem){return Composing.config({find:mem.getOpt})},ComposingConfigs_childAt=function(index){return Composing.config({find:function(comp){return child(comp.element(),index).bind(function(element){return comp.getSystem().getByDom(element).toOption()})}})},english={"colorcustom.rgb.red.label":"R","colorcustom.rgb.red.description":"Red component","colorcustom.rgb.green.label":"G","colorcustom.rgb.green.description":"Green component","colorcustom.rgb.blue.label":"B","colorcustom.rgb.blue.description":"Blue component","colorcustom.rgb.hex.label":"#","colorcustom.rgb.hex.description":"Hex color code","colorcustom.rgb.range":"Range 0 to 255","colorcustom.sb.saturation":"Saturation","colorcustom.sb.brightness":"Brightness","colorcustom.sb.picker":"Saturation and Brightness Picker","colorcustom.sb.palette":"Saturation and Brightness Palette","colorcustom.sb.instructions":"Use arrow keys to select saturation and brightness, on x and y axes","colorcustom.hue.hue":"Hue","colorcustom.hue.slider":"Hue Slider","colorcustom.hue.palette":"Hue Palette","colorcustom.hue.instructions":"Use arrow keys to select a hue","aria.color.picker":"Color Picker","aria.input.invalid":"Invalid input"},global$a=tinymce.util.Tools.resolve("tinymce.Resource"),processors=objOf([defaulted$1("preprocess",identity),defaulted$1("postprocess",identity)]),RepresentingConfigs_memento=function(mem,rawProcessors){var ps=asRawOrDie("RepresentingConfigs.memento processors",processors,rawProcessors);return Representing.config({store:{mode:"manual",getValue:function(comp){var other=mem.get(comp),rawValue=Representing.getValue(other);return ps.postprocess(rawValue)},setValue:function(comp,rawValue){var newValue=ps.preprocess(rawValue),other=mem.get(comp);Representing.setValue(other,newValue)}}})},RepresentingConfigs_withComp=withComp,RepresentingConfigs_domHtml=function(optInitialValue){return withElement(optInitialValue,get$1,set)},RepresentingConfigs_memory=function(initialValue){return Representing.config({store:{mode:"memory",initialValue:initialValue}})},beforeObject=generate$1("alloy-fake-before-tabstop"),afterObject=generate$1("alloy-fake-after-tabstop"),NavigableObject_isPseudoStop=function(element){return closest$4(element,["."+beforeObject,"."+afterObject].join(","),constant(!1))},NavigableObject_onFocus=function(container,targetComp){var target=targetComp.element();has$2(target,beforeObject)?triggerTab(container,!0):has$2(target,afterObject)&&triggerTab(container,!1)},NavigableObject_craft=function(spec){return{dom:{tag:"div",classes:["tox-navobj"]},components:[craftWithClasses([beforeObject]),spec,craftWithClasses([afterObject])],behaviours:derive$1([ComposingConfigs_childAt(1)])}},platformNeedsSandboxing=!(detect$3().browser.isIE()||detect$3().browser.isEdge());function create$5(width,height){return resize(domGlobals.document.createElement("canvas"),width,height)}function clone$1(canvas){var tCanvas=create$5(canvas.width,canvas.height);return get2dContext(tCanvas).drawImage(canvas,0,0),tCanvas}function get2dContext(canvas){return canvas.getContext("2d")}function resize(canvas,width,height){return canvas.width=width,canvas.height=height,canvas}function getWidth(image){return image.naturalWidth||image.width}function getHeight(image){return image.naturalHeight||image.height}var Promise$1=window.Promise?window.Promise:function(){function Promise(fn){if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");if("function"!=typeof fn)throw new TypeError("not a function");this._state=null,this._value=null,this._deferreds=[],doResolve(fn,bind(resolve,this),bind(reject,this))}var asap=Promise.immediateFn||"function"==typeof window.setImmediate&&window.setImmediate||function(fn){domGlobals.setTimeout(fn,1)};function bind(fn,thisArg){return function(){return fn.apply(thisArg,arguments)}}var isArray=Array.isArray||function(value){return"[object Array]"===Object.prototype.toString.call(value)};function handle(deferred){var me=this;null!==this._state?asap(function(){var cb=me._state?deferred.onFulfilled:deferred.onRejected;if(null!==cb){var ret;try{ret=cb(me._value)}catch(e){return void deferred.reject(e)}deferred.resolve(ret)}else(me._state?deferred.resolve:deferred.reject)(me._value)}):this._deferreds.push(deferred)}function resolve(newValue){try{if(newValue===this)throw new TypeError("A promise cannot be resolved with itself.");if(newValue&&("object"==typeof newValue||"function"==typeof newValue)){var then=newValue.then;if("function"==typeof then)return void doResolve(bind(then,newValue),bind(resolve,this),bind(reject,this))}this._state=!0,this._value=newValue,finale.call(this)}catch(e){reject.call(this,e)}}function reject(newValue){this._state=!1,this._value=newValue,finale.call(this)}function finale(){for(var _i=0,_a=this._deferreds;_i<_a.length;_i++){var deferred=_a[_i];handle.call(this,deferred)}this._deferreds=[]}function Handler(onFulfilled,onRejected,resolve,reject){this.onFulfilled="function"==typeof onFulfilled?onFulfilled:null,this.onRejected="function"==typeof onRejected?onRejected:null,this.resolve=resolve,this.reject=reject}function doResolve(fn,onFulfilled,onRejected){var done=!1;try{fn(function(value){done||(done=!0,onFulfilled(value))},function(reason){done||(done=!0,onRejected(reason))})}catch(ex){if(done)return;done=!0,onRejected(ex)}}return Promise.prototype.catch=function(onRejected){return this.then(null,onRejected)},Promise.prototype.then=function(onFulfilled,onRejected){var me=this;return new Promise(function(resolve,reject){handle.call(me,new Handler(onFulfilled,onRejected,resolve,reject))})},Promise.all=function(){for(var values=[],_i=0;_i<arguments.length;_i++)values[_i]=arguments[_i];var args=Array.prototype.slice.call(1===values.length&&isArray(values[0])?values[0]:values);return new Promise(function(resolve,reject){if(0===args.length)return resolve([]);var remaining=args.length;function res(i,val){try{if(val&&("object"==typeof val||"function"==typeof val)){var then=val.then;if("function"==typeof then)return void then.call(val,function(val){res(i,val)},reject)}args[i]=val,0==--remaining&&resolve(args)}catch(ex){reject(ex)}}for(var i=0;i<args.length;i++)res(i,args[i])})},Promise.resolve=function(value){return value&&"object"==typeof value&&value.constructor===Promise?value:new Promise(function(resolve){resolve(value)})},Promise.reject=function(reason){return new Promise(function(resolve,reject){reject(reason)})},Promise.race=function(values){return new Promise(function(resolve,reject){for(var _i=0,values_1=values;_i<values_1.length;_i++){values_1[_i].then(resolve,reject)}})},Promise}();function dataUriToBlob(uri){return new Promise$1(function(resolve,reject){(function(uri){var data=uri.split(","),matches=/data:([^;]+)/.exec(data[0]);if(!matches)return Option.none();for(var mimetype=matches[1],base64=data[1],byteCharacters=domGlobals.atob(base64),bytesLength=byteCharacters.length,slicesCount=Math.ceil(bytesLength/1024),byteArrays=new Array(slicesCount),sliceIndex=0;sliceIndex<slicesCount;++sliceIndex){for(var begin=1024*sliceIndex,end=Math.min(1024+begin,bytesLength),bytes=new Array(end-begin),offset=begin,i=0;offset<end;++i,++offset)bytes[i]=byteCharacters[offset].charCodeAt(0);byteArrays[sliceIndex]=new Uint8Array(bytes)}return Option.some(new domGlobals.Blob(byteArrays,{type:mimetype}))})(uri).fold(function(){reject("uri is not base64: "+uri)},resolve)})}function canvasToBlob(canvas,type,quality){return type=type||"image/png",domGlobals.HTMLCanvasElement.prototype.toBlob?new Promise$1(function(resolve,reject){canvas.toBlob(function(blob){blob?resolve(blob):reject()},type,quality)}):dataUriToBlob(canvas.toDataURL(type,quality))}function blobToCanvas(blob){return function(blob){return new Promise$1(function(resolve,reject){var blobUrl=domGlobals.URL.createObjectURL(blob),image=new domGlobals.Image,removeListeners=function(){image.removeEventListener("load",loaded),image.removeEventListener("error",error)};function loaded(){removeListeners(),resolve(image)}function error(){removeListeners(),reject("Unable to load data of type "+blob.type+": "+blobUrl)}image.addEventListener("load",loaded),image.addEventListener("error",error),image.src=blobUrl,image.complete&&loaded()})}(blob).then(function(image){!function(image){domGlobals.URL.revokeObjectURL(image.src)}(image);var canvas=create$5(getWidth(image),getHeight(image));return get2dContext(canvas).drawImage(image,0,0),canvas})}function create$6(getCanvas,blob,uri){var initialType=blob.type;function toAdjustedDataURL(type,quality){return getCanvas.then(function(canvas){return function(canvas,type,quality){return type=type||"image/png",canvas.toDataURL(type,quality)}(canvas,type,quality)})}return{getType:constant(initialType),toBlob:function(){return Promise$1.resolve(blob)},toDataURL:function(){return uri},toBase64:function(){return uri.split(",")[1]},toAdjustedBlob:function(type,quality){return getCanvas.then(function(canvas){return canvasToBlob(canvas,type,quality)})},toAdjustedDataURL:toAdjustedDataURL,toAdjustedBase64:function(type,quality){return toAdjustedDataURL(type,quality).then(function(dataurl){return dataurl.split(",")[1]})},toCanvas:function(){return getCanvas.then(clone$1)}}}function fromBlob(blob){return function(blob){return new Promise$1(function(resolve){var reader=new domGlobals.FileReader;reader.onloadend=function(){resolve(reader.result)},reader.readAsDataURL(blob)})}(blob).then(function(uri){return create$6(blobToCanvas(blob),blob,uri)})}function fromCanvas(canvas,type){return canvasToBlob(canvas,type).then(function(blob){return create$6(Promise$1.resolve(canvas),blob,canvas.toDataURL())})}function clamp$1(value,min,max){var parsedValue="string"==typeof value?parseFloat(value):value;return max<parsedValue?parsedValue=max:parsedValue<min&&(parsedValue=min),parsedValue}var DELTA_INDEX=[0,.01,.02,.04,.05,.06,.07,.08,.1,.11,.12,.14,.15,.16,.17,.18,.2,.21,.22,.24,.25,.27,.28,.3,.32,.34,.36,.38,.4,.42,.44,.46,.48,.5,.53,.56,.59,.62,.65,.68,.71,.74,.77,.8,.83,.86,.89,.92,.95,.98,1,1.06,1.12,1.18,1.24,1.3,1.36,1.42,1.48,1.54,1.6,1.66,1.72,1.78,1.84,1.9,1.96,2,2.12,2.25,2.37,2.5,2.62,2.75,2.87,3,3.2,3.4,3.6,3.8,4,4.3,4.7,4.9,5,5.5,6,6.5,6.8,7,7.3,7.5,7.8,8,8.4,8.7,9,9.4,9.6,9.8,10];function multiply(matrix1,matrix2){for(var val,col=[],out=new Array(25),i=0;i<5;i++){for(var j=0;j<5;j++)col[j]=matrix2[j+5*i];for(j=0;j<5;j++){for(var k=val=0;k<5;k++)val+=matrix1[j+5*k]*col[k];out[j+5*i]=val}}return out}function colorFilter(ir,matrix){return ir.toCanvas().then(function(canvas){return function(canvas,type,matrix){var context=get2dContext(canvas);var pixels=function(pixelsData,m){for(var r,g,b,a,data=pixelsData.data,m0=m[0],m1=m[1],m2=m[2],m3=m[3],m4=m[4],m5=m[5],m6=m[6],m7=m[7],m8=m[8],m9=m[9],m10=m[10],m11=m[11],m12=m[12],m13=m[13],m14=m[14],m15=m[15],m16=m[16],m17=m[17],m18=m[18],m19=m[19],i=0;i<data.length;i+=4)r=data[i],g=data[i+1],b=data[i+2],a=data[i+3],data[i]=r*m0+g*m1+b*m2+a*m3+m4,data[i+1]=r*m5+g*m6+b*m7+a*m8+m9,data[i+2]=r*m10+g*m11+b*m12+a*m13+m14,data[i+3]=r*m15+g*m16+b*m17+a*m18+m19;return pixelsData}(context.getImageData(0,0,canvas.width,canvas.height),matrix);return context.putImageData(pixels,0,0),fromCanvas(canvas,type)}(canvas,ir.getType(),matrix)})}function convoluteFilter(ir,matrix){return ir.toCanvas().then(function(canvas){return function(canvas,type,matrix){var context=get2dContext(canvas);var pixelsIn=context.getImageData(0,0,canvas.width,canvas.height),pixelsOut=context.getImageData(0,0,canvas.width,canvas.height);return pixelsOut=function(pIn,pOut,aMatrix){function clamp(value,min,max){return max<value?value=max:value<min&&(value=min),value}for(var side=Math.round(Math.sqrt(aMatrix.length)),halfSide=Math.floor(side/2),rgba=pIn.data,drgba=pOut.data,w=pIn.width,h=pIn.height,y=0;y<h;y++)for(var x=0;x<w;x++){for(var r=0,g=0,b=0,cy=0;cy<side;cy++)for(var cx=0;cx<side;cx++){var scx=clamp(x+cx-halfSide,0,w-1),innerOffset=4*(clamp(y+cy-halfSide,0,h-1)*w+scx),wt=aMatrix[cy*side+cx];r+=rgba[innerOffset]*wt,g+=rgba[1+innerOffset]*wt,b+=rgba[2+innerOffset]*wt}var offset=4*(y*w+x);drgba[offset]=clamp(r,0,255),drgba[1+offset]=clamp(g,0,255),drgba[2+offset]=clamp(b,0,255)}return pOut}(pixelsIn,pixelsOut,matrix),context.putImageData(pixelsOut,0,0),fromCanvas(canvas,type)}(canvas,ir.getType(),matrix)})}function complexAdjustableColorFilter(matrixAdjustFn){return function(ir,adjust){return colorFilter(ir,matrixAdjustFn([1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1],adjust))}}function colorize(ir,adjustR,adjustG,adjustB){return colorFilter(ir,function(matrix,adjustR,adjustG,adjustB){return multiply(matrix,[adjustR=clamp$1(adjustR,0,2),0,0,0,0,0,adjustG=clamp$1(adjustG,0,2),0,0,0,0,0,adjustB=clamp$1(adjustB,0,2),0,0,0,0,0,1,0,0,0,0,0,1])}([1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1],adjustR,adjustG,adjustB))}var kernel,colorFn,invert=function(matrix){return function(ir){return colorFilter(ir,matrix)}}([-1,0,0,0,255,0,-1,0,0,255,0,0,-1,0,255,0,0,0,1,0,0,0,0,0,1]),brightness=complexAdjustableColorFilter(function(matrix,value){return multiply(matrix,[1,0,0,0,value=clamp$1(255*value,-255,255),0,1,0,0,value,0,0,1,0,value,0,0,0,1,0,0,0,0,0,1])}),contrast=complexAdjustableColorFilter(function(matrix,value){var x;return value=clamp$1(value,-1,1),multiply(matrix,[(x=(value*=100)<0?127+value/100*127:127*(x=0===(x=value%1)?DELTA_INDEX[value]:DELTA_INDEX[Math.floor(value)]*(1-x)+DELTA_INDEX[Math.floor(value)+1]*x)+127)/127,0,0,0,.5*(127-x),0,x/127,0,0,.5*(127-x),0,0,x/127,0,.5*(127-x),0,0,0,1,0,0,0,0,0,1])}),sharpen=(kernel=[0,-1,0,-1,5,-1,0,-1,0],function(ir){return convoluteFilter(ir,kernel)}),gamma=(colorFn=function(color,value){return 255*Math.pow(color/255,1-value)},function(ir,value){return ir.toCanvas().then(function(canvas){return filterImpl(canvas,ir.getType(),value)})});function filterImpl(canvas,type,value){for(var context=get2dContext(canvas),lookup=new Array(256),i=0;i<lookup.length;i++)lookup[i]=colorFn(i,value);var pixels=function(pixelsData,lookupData){for(var data=pixelsData.data,i=0;i<data.length;i+=4)data[i]=lookupData[data[i]],data[i+1]=lookupData[data[i+1]],data[i+2]=lookupData[data[i+2]];return pixelsData}(context.getImageData(0,0,canvas.width,canvas.height),lookup);return context.putImageData(pixels,0,0),fromCanvas(canvas,type)}function scale(image,dW,dH){var sW=getWidth(image),sH=getHeight(image),wRatio=dW/sW,hRatio=dH/sH,scaleCapped=!1;(wRatio<.5||2<wRatio)&&(wRatio=wRatio<.5?.5:2,scaleCapped=!0),(hRatio<.5||2<hRatio)&&(hRatio=hRatio<.5?.5:2,scaleCapped=!0);var scaled=function(image,wRatio,hRatio){return new Promise$1(function(resolve){var sW=getWidth(image),sH=getHeight(image),dW=Math.floor(sW*wRatio),dH=Math.floor(sH*hRatio),canvas=create$5(dW,dH);get2dContext(canvas).drawImage(image,0,0,sW,sH,0,0,dW,dH),resolve(canvas)})}(image,wRatio,hRatio);return scaleCapped?scaled.then(function(tCanvas){return scale(tCanvas,dW,dH)}):scaled}function rotate(ir,angle){return ir.toCanvas().then(function(canvas){return function(image,type,angle){var canvas=create$5(image.width,image.height),context=get2dContext(canvas),translateX=0,translateY=0;90!==(angle=angle<0?360+angle:angle)&&270!==angle||resize(canvas,canvas.height,canvas.width);90!==angle&&180!==angle||(translateX=canvas.width);270!==angle&&180!==angle||(translateY=canvas.height);return context.translate(translateX,translateY),context.rotate(angle*Math.PI/180),context.drawImage(image,0,0),fromCanvas(canvas,type)}(canvas,ir.getType(),angle)})}function flip(ir,axis){return ir.toCanvas().then(function(canvas){return function(image,type,axis){var canvas=create$5(image.width,image.height),context=get2dContext(canvas);"v"===axis?(context.scale(1,-1),context.drawImage(image,0,-canvas.height)):(context.scale(-1,1),context.drawImage(image,-canvas.width,0));return fromCanvas(canvas,type)}(canvas,ir.getType(),axis)})}function crop(ir,x,y,w,h){return ir.toCanvas().then(function(canvas){return function(image,type,x,y,w,h){var canvas=create$5(w,h);return get2dContext(canvas).drawImage(image,-x,-y),fromCanvas(canvas,type)}(canvas,ir.getType(),x,y,w,h)})}function invert$1(ir){return invert(ir)}function sharpen$1(ir){return sharpen(ir)}function gamma$1(ir,value){return gamma(ir,value)}function brightness$1(ir,adjust){return brightness(ir,adjust)}function contrast$1(ir,adjust){return contrast(ir,adjust)}function flip$1(ir,axis){return flip(ir,axis)}function resize$2(ir,w,h){return function(ir,w,h){return ir.toCanvas().then(function(canvas){return scale(canvas,w,h).then(function(newCanvas){return fromCanvas(newCanvas,ir.getType())})})}(ir,w,h)}function rotate$1(ir,angle){return rotate(ir,angle)}function renderIcon$1(iconHtml,behaviours){return __assign({dom:{tag:"span",innerHtml:iconHtml,classes:["tox-icon","tox-tbtn__icon-wrap"]}},behaviours)}function renderIconFromPack(iconName,iconsProvider){return renderIcon$1(get$d(iconName,iconsProvider),{})}function renderReplacableIconFromPack(iconName,iconsProvider){return renderIcon$1(get$d(iconName,iconsProvider),{behaviours:derive$1([Replacing.config({})])})}function renderLabel$1(text,prefix,providersBackstage){return{dom:{tag:"span",innerHtml:providersBackstage.translate(text),classes:[prefix+"__select-label"]},behaviours:derive$1([Replacing.config({})])}}function renderCommonDropdown(spec,prefix,sharedBackstage){function onLeftOrRightInMenu(comp,se){var dropdown=Representing.getValue(comp);return Focusing.focus(dropdown),emitWith(dropdown,"keydown",{raw:se.event().raw()}),Dropdown.close(dropdown),Option.some(!0)}var editorOffCell=Cell(noop),optMemDisplayText=spec.text.map(function(text){return record(renderLabel$1(text,prefix,sharedBackstage.providers))}),optMemDisplayIcon=spec.icon.map(function(iconName){return record(renderReplacableIconFromPack(iconName,sharedBackstage.providers.icons))}),role=spec.role.fold(function(){return{}},function(role){return{role:role}}),tooltipAttributes=spec.tooltip.fold(function(){return{}},function(tooltip){var translatedTooltip=sharedBackstage.providers.translate(tooltip);return{title:translatedTooltip,"aria-label":translatedTooltip}});return record(Dropdown.sketch(__assign(__assign({},role),{dom:{tag:"button",classes:[prefix,prefix+"--select"].concat(map(spec.classes,function(c){return prefix+"--"+c})),attributes:__assign({},tooltipAttributes)},components:componentRenderPipeline([optMemDisplayIcon.map(function(mem){return mem.asSpec()}),optMemDisplayText.map(function(mem){return mem.asSpec()}),Option.some({dom:{tag:"div",classes:[prefix+"__select-chevron"],innerHtml:get$d("chevron-down",sharedBackstage.providers.icons)}})]),matchWidth:!0,useMinWidth:!0,dropdownBehaviours:derive$1(__spreadArrays(spec.dropdownBehaviours,[DisablingConfigs_button(spec.disabled),Unselecting.config({}),Replacing.config({}),config("dropdown-events",[onControlAttached(spec,editorOffCell),onControlDetached(spec,editorOffCell)]),config("menubutton-update-display-text",[run(updateMenuText,function(comp,se){optMemDisplayText.bind(function(mem){return mem.getOpt(comp)}).each(function(displayText){Replacing.set(displayText,[text(sharedBackstage.providers.translate(se.event().text()))])})}),run(updateMenuIcon,function(comp,se){optMemDisplayIcon.bind(function(mem){return mem.getOpt(comp)}).each(function(displayIcon){Replacing.set(displayIcon,[renderReplacableIconFromPack(se.event().icon(),sharedBackstage.providers.icons)])})})])])),eventOrder:deepMerge(toolbarButtonEventOrder,{mousedown:["focusing","alloy.base.behaviour","item-type-events","normal-dropdown-events"]}),sandboxBehaviours:derive$1([Keying.config({mode:"special",onLeft:onLeftOrRightInMenu,onRight:onLeftOrRightInMenu})]),lazySink:sharedBackstage.getSink,toggleClass:prefix+"--active",parts:{menu:part(0,spec.columns,spec.presets)},fetch:function(){return Future_nu(spec.fetch)}}))).asSpec()}function isSeparator(item){return"separator"===item.type}function unwrapReferences(items,menuItems){var realItems=foldl(items,function(acc,item){return function(item){return isString(item)}(item)?""===item?acc:"|"===item?0<acc.length&&!isSeparator(acc[acc.length-1])?acc.concat([separator$1]):acc:has(menuItems,item.toLowerCase())?acc.concat([menuItems[item.toLowerCase()]]):acc:acc.concat([item])},[]);return 0<realItems.length&&isSeparator(realItems[realItems.length-1])&&realItems.pop(),realItems}function getFromItem(item,menuItems){return function(item){return has(item,"getSubmenuItems")}(item)?function(item,menuItems){var submenuItems=item.getSubmenuItems(),rest=expand(submenuItems,menuItems);return{item:item,menus:deepMerge(rest.menus,wrap$1(item.value,rest.items)),expansions:deepMerge(rest.expansions,wrap$1(item.value,item.value))}}(item,menuItems):{item:item,menus:{},expansions:{}}}function build$2(items,itemResponse,backstage,isHorizontalMenu){var primary=generate$1("primary-menu"),data=expand(items,backstage.shared.providers.menuItems());if(0===data.items.length)return Option.none();var mainMenu=createPartialMenu(primary,data.items,itemResponse,backstage,isHorizontalMenu),submenus=map$1(data.menus,function(menuItems,menuName){return createPartialMenu(menuName,menuItems,itemResponse,backstage,!1)}),menus=deepMerge(submenus,wrap$1(primary,mainMenu));return Option.from(tieredMenu.tieredData(primary,menus,data.expansions))}function getMenuButtonApi(component){return{isDisabled:function(){return Disabling.isDisabled(component)},setDisabled:function(state){return Disabling.set(component,state)},setActive:function(state){var elm=component.element();state?(add$2(elm,"tox-tbtn--enabled"),set$1(elm,"aria-pressed",!0)):(remove$4(elm,"tox-tbtn--enabled"),remove$1(elm,"aria-pressed"))},isActive:function(){return has$2(component.element(),"tox-tbtn--enabled")}}}function renderMenuButton(spec,prefix,backstage,role){return renderCommonDropdown({text:spec.text,icon:spec.icon,tooltip:spec.tooltip,role:role,fetch:function(callback){spec.fetch(function(items){callback(build$2(items,ItemResponse$1.CLOSE_ON_EXECUTE,backstage,!1))})},onSetup:spec.onSetup,getApi:getMenuButtonApi,columns:1,presets:"normal",classes:[],dropdownBehaviours:[Tabstopping.config({})]},prefix,backstage.shared)}function getFetch$1(items,getButton,backstage){return function(success){success(map(items,function(item){var text=item.text.fold(function(){return{}},function(text){return{text:text}});return __assign(__assign({type:item.type,active:!1},text),{onAction:function(item){return function(api){var newValue=!api.isActive();api.setActive(newValue),item.storage.set(newValue),backstage.shared.getSink().each(function(sink){getButton().getOpt(sink).each(function(orig){focus$1(orig.element()),emitWith(orig,formActionEvent,{name:item.name,value:item.storage.get()})})})}}(item),onSetup:function(item){return function(api){api.setActive(item.storage.get())}}(item)})}))}}function renderCommonSpec(spec,actionOpt,extraBehaviours,dom,components){void 0===extraBehaviours&&(extraBehaviours=[]);var action=actionOpt.fold(function(){return{}},function(action){return{action:action}}),common=__assign({buttonBehaviours:derive$1([DisablingConfigs_button(spec.disabled),Tabstopping.config({}),config("button press",[preventDefault("click"),preventDefault("mousedown")])].concat(extraBehaviours)),eventOrder:{click:["button press","alloy.base.behaviour"],mousedown:["button press","alloy.base.behaviour"]}},action),domFinal=deepMerge(common,{dom:dom});return deepMerge(domFinal,{components:components})}function renderIconButtonSpec(spec,action,providersBackstage,extraBehaviours){void 0===extraBehaviours&&(extraBehaviours=[]);var dom={tag:"button",classes:["tox-tbtn"],attributes:spec.tooltip.map(function(tooltip){return{"aria-label":providersBackstage.translate(tooltip),title:providersBackstage.translate(tooltip)}}).getOr({})},icon=spec.icon.map(function(iconName){return renderIconFromPack(iconName,providersBackstage.icons)}),components=componentRenderPipeline([icon]);return renderCommonSpec(spec,action,extraBehaviours,dom,components)}function renderIconButton(spec,action,providersBackstage,extraBehaviours){void 0===extraBehaviours&&(extraBehaviours=[]);var iconButtonSpec=renderIconButtonSpec(spec,Option.some(action),providersBackstage,extraBehaviours);return Button.sketch(iconButtonSpec)}function renderButtonSpec(spec,action,providersBackstage,extraBehaviours,extraClasses){void 0===extraBehaviours&&(extraBehaviours=[]),void 0===extraClasses&&(extraClasses=[]);var translatedText=providersBackstage.translate(spec.text),icon=spec.icon?spec.icon.map(function(iconName){return renderIconFromPack(iconName,providersBackstage.icons)}):Option.none(),components=icon.isSome()?componentRenderPipeline([icon]):[],innerHtml=icon.isSome()?{}:{innerHtml:translatedText},classes=__spreadArrays(spec.primary||spec.borderless?["tox-button"]:["tox-button","tox-button--secondary"],icon.isSome()?["tox-button--icon"]:[],spec.borderless?["tox-button--naked"]:[],extraClasses),dom=__assign(__assign({tag:"button",classes:classes},innerHtml),{attributes:{title:translatedText}});return renderCommonSpec(spec,action,extraBehaviours,dom,components)}function renderButton(spec,action,providersBackstage,extraBehaviours,extraClasses){void 0===extraBehaviours&&(extraBehaviours=[]),void 0===extraClasses&&(extraClasses=[]);var buttonSpec=renderButtonSpec(spec,Option.some(action),providersBackstage,extraBehaviours,extraClasses);return Button.sketch(buttonSpec)}function getAction(name,buttonType){return function(comp){"custom"===buttonType?emitWith(comp,formActionEvent,{name:name,value:{}}):"submit"===buttonType?emit(comp,formSubmitEvent):"cancel"===buttonType?emit(comp,formCancelEvent):domGlobals.console.error("Unknown button type: ",buttonType)}}function renderFooterButton(spec,buttonType,backstage){if(function(spec,buttonType){return"menu"===buttonType}(0,buttonType)){var menuButtonSpec=spec,fixedSpec=__assign(__assign({},spec),{onSetup:function(api){return api.setDisabled(spec.disabled),noop},fetch:getFetch$1(menuButtonSpec.items,function(){return memButton_1},backstage)}),memButton_1=record(renderMenuButton(fixedSpec,"tox-tbtn",backstage,Option.none()));return memButton_1.asSpec()}if(function(spec,buttonType){return"custom"===buttonType||"cancel"===buttonType||"submit"===buttonType}(0,buttonType)){var action=getAction(spec.name,buttonType),buttonSpec=__assign(__assign({},spec),{borderless:!1});return renderButton(buttonSpec,action,backstage.shared.providers,[])}domGlobals.console.error("Unknown footer button type: ",buttonType)}function renderDialogButton(spec,providersBackstage){var action=getAction(spec.name,"custom");return function(pLabel,pField){return renderFormFieldWith(pLabel,pField,[],[])}(Option.none(),FormField.parts().field(__assign({factory:Button},renderButtonSpec(spec,Option.some(action),providersBackstage,[RepresentingConfigs_memory(""),ComposingConfigs_self()]))))}function coupledPart(selfName,otherName){return required({factory:FormField,name:selfName,overrides:function(detail){return{fieldBehaviours:derive$1([config("coupled-input-behaviour",[run(input(),function(me){(function(comp,detail,partName){return getPart(comp,detail,partName).bind(Composing.getCurrent)})(me,detail,otherName).each(function(other){getPart(me,detail,"lock").each(function(lock){Toggling.isOn(lock)&&detail.onLockedChange(me,other,lock)})})})])])}}})}function parseSize(sizeText){var match=/^\s*(\d+(?:\.\d+)?)\s*(|cm|mm|in|px|pt|pc|em|ex|ch|rem|vw|vh|vmin|vmax|%)\s*$/.exec(sizeText);if(null===match)return Result.error(sizeText);var value=parseFloat(match[1]),unit=match[2];return Result.value({value:value,unit:unit})}function convertUnit(size,unit){function supported(u){return Object.prototype.hasOwnProperty.call(inInch,u)}var inInch={"":96,px:96,pt:72,cm:2.54,pc:12,mm:25.4,in:1};return size.unit===unit?Option.some(size.value):supported(size.unit)&&supported(unit)?inInch[size.unit]===inInch[unit]?Option.some(size.value):Option.some(size.value/inInch[size.unit]*inInch[unit]):Option.none()}function noSizeConversion(input){return Option.none()}function makeRatioConverter(currentFieldText,otherFieldText){return function(oa,ob,f){return oa.isSome()&&ob.isSome()?Option.some(f(oa.getOrDie(),ob.getOrDie())):Option.none()}(parseSize(currentFieldText).toOption(),parseSize(otherFieldText).toOption(),function(cSize,oSize){return convertUnit(cSize,oSize.unit).map(function(val){return oSize.value/val}).map(function(r){return function(scale,unit){return function(size){return convertUnit(size,unit).map(function(value){return{value:value*scale,unit:unit}})}}(r,oSize.unit)}).getOr(noSizeConversion)}).getOr(noSizeConversion)}function renderSizeInput(spec,providersBackstage){function formGroup(components){return{dom:{tag:"div",classes:["tox-form__group"]},components:components}}function getFieldPart(isField1){return FormField.parts().field({factory:Input,inputClasses:["tox-textfield"],inputBehaviours:derive$1([Disabling.config({disabled:spec.disabled}),Tabstopping.config({}),config("size-input-events",[run(focusin(),function(component,simulatedEvent){emitWith(component,ratioEvent,{isField1:isField1})}),run(change(),function(component,simulatedEvent){emitWith(component,formChangeEvent,{name:spec.name})})])]),selectOnFocus:!1})}function getLabel(label){return{dom:{tag:"label",classes:["tox-label"],innerHtml:providersBackstage.translate(label)}}}var converter=noSizeConversion,ratioEvent=generate$1("ratio-event"),pLock=FormCoupledInputs.parts().lock({dom:{tag:"button",classes:["tox-lock","tox-button","tox-button--naked","tox-button--icon"],attributes:{title:providersBackstage.translate(spec.label.getOr("Constrain proportions"))}},components:[{dom:{tag:"span",classes:["tox-icon","tox-lock-icon__lock"],innerHtml:get$d("lock",providersBackstage.icons)}},{dom:{tag:"span",classes:["tox-icon","tox-lock-icon__unlock"],innerHtml:get$d("unlock",providersBackstage.icons)}}],buttonBehaviours:derive$1([DisablingConfigs_button(spec.disabled),Tabstopping.config({})])}),widthField=FormCoupledInputs.parts().field1(formGroup([FormField.parts().label(getLabel("Width")),getFieldPart(!0)])),heightField=FormCoupledInputs.parts().field2(formGroup([FormField.parts().label(getLabel("Height")),getFieldPart(!1)]));return FormCoupledInputs.sketch({dom:{tag:"div",classes:["tox-form__group"]},components:[{dom:{tag:"div",classes:["tox-form__controls-h-stack"]},components:[widthField,heightField,formGroup([getLabel("&nbsp;"),pLock])]}],field1Name:"width",field2Name:"height",locked:!0,markers:{lockClass:"tox-locked"},onLockedChange:function(current,other,lock){parseSize(Representing.getValue(current)).each(function(size){converter(size).each(function(newSize){Representing.setValue(other,function(size){var unit,unitDec={"":0,px:0,pt:1,mm:1,pc:2,ex:2,em:2,ch:2,rem:2,cm:3,in:4,"%":4},numText=size.value.toFixed((unit=size.unit)in unitDec?unitDec[unit]:1);return-1!==numText.indexOf(".")&&(numText=numText.replace(/\.?0*$/,"")),numText+size.unit}(newSize))})})},coupledFieldBehaviours:derive$1([Disabling.config({disabled:spec.disabled,onDisabled:function(comp){FormCoupledInputs.getField1(comp).bind(FormField.getField).each(Disabling.disable),FormCoupledInputs.getField2(comp).bind(FormField.getField).each(Disabling.disable),FormCoupledInputs.getLock(comp).each(Disabling.disable)},onEnabled:function(comp){FormCoupledInputs.getField1(comp).bind(FormField.getField).each(Disabling.enable),FormCoupledInputs.getField2(comp).bind(FormField.getField).each(Disabling.enable),FormCoupledInputs.getLock(comp).each(Disabling.enable)}}),config("size-input-events2",[run(ratioEvent,function(component,simulatedEvent){var isField1=simulatedEvent.event().isField1(),optCurrent=isField1?FormCoupledInputs.getField1(component):FormCoupledInputs.getField2(component),optOther=isField1?FormCoupledInputs.getField2(component):FormCoupledInputs.getField1(component),value1=optCurrent.map(Representing.getValue).getOr(""),value2=optOther.map(Representing.getValue).getOr("");converter=makeRatioConverter(value1,value2)})])])})}function renderEditPanel(imagePanel,providersBackstage){function createButton(text,action,disabled,primary){return record(renderButton({name:text,text:text,disabled:disabled,primary:primary,icon:Option.none(),borderless:!1},action,providersBackstage))}function createIconButton(icon,tooltip,action,disabled){return record(renderIconButton({name:icon,icon:Option.some(icon),tooltip:Option.some(tooltip),disabled:disabled,primary:!1,borderless:!1},action,providersBackstage))}function disableAllComponents(comps,eventcomp){comps.map(function(mem){var component=mem.get(eventcomp);component.hasConfigured(Disabling)&&Disabling.disable(component)})}function enableAllComponents(comps,eventcomp){comps.map(function(mem){var component=mem.get(eventcomp);component.hasConfigured(Disabling)&&Disabling.enable(component)})}function emit$1(comp,event,data){emitWith(comp,event,data)}function emitDisable(component){return emit(component,external$2.disable())}function emitEnable(component){return emit(component,external$2.enable())}function emitTransform(comp,transform){emitDisable(comp),emit$1(comp,internal.transform(),{transform:transform}),emitEnable(comp)}function getBackSwap(anyInSystem){return function(){memContainer.getOpt(anyInSystem).each(function(container){Replacing.set(container,[ButtonPanel])})}}function emitTransformApply(comp,transform){emitDisable(comp),emit$1(comp,internal.transformApply(),{transform:transform,swap:getBackSwap(comp)}),emitEnable(comp)}function createBackButton(){return createButton("Back",function(button){return emit$1(button,internal.back(),{swap:getBackSwap(button)})},!1,!1)}function createSpacer(){return record({dom:{tag:"div",classes:["tox-spacer"]},behaviours:derive$1([Disabling.config({})])})}function createApplyButton(){return createButton("Apply",function(button){return emit$1(button,internal.apply(),{swap:getBackSwap(button)})},!0,!0)}function makeCropTransform(){return function(ir){var rect=imagePanel.getRect();return function(ir,x,y,w,h){return crop(ir,x,y,w,h)}(ir,rect.x,rect.y,rect.w,rect.h)}}function makeValueTransform(transform,value){return function(ir){return transform(ir,value)}}function flipRotateOnAction(comp,operation){!function(comp,transform){emitDisable(comp),emit$1(comp,internal.tempTransform(),{transform:transform}),emitEnable(comp)}(comp,operation)}function makeSlider(label,onChoose,min,value,max){var labelPart=Slider.parts().label({dom:{tag:"label",classes:["tox-label"],innerHtml:providersBackstage.translate(label)}}),spectrum=Slider.parts().spectrum({dom:{tag:"div",classes:["tox-slider__rail"],attributes:{role:"presentation"}}}),thumb=Slider.parts().thumb({dom:{tag:"div",classes:["tox-slider__handle"],attributes:{role:"presentation"}}});return record(Slider.sketch({dom:{tag:"div",classes:["tox-slider"],attributes:{role:"presentation"}},model:{mode:"x",minX:min,maxX:max,getInitialValue:constant({x:constant(value)})},components:[labelPart,spectrum,thumb],sliderBehaviours:derive$1([Focusing.config({})]),onChoose:onChoose}))}function variableFilterPanelComponents(label,transform,min,value,max){return[createBackButton(),function(label,transform,min,value,max){return makeSlider(label,function(slider,thumb,value){var valTransform=makeValueTransform(transform,value.x()/100);emitTransform(slider,valTransform)},min,value,max)}(label,transform,min,value,max),createApplyButton()]}function createVariableFilterPanel(label,transform,min,value,max){var filterPanelComponents=variableFilterPanelComponents(label,transform,min,value,max);return Container.sketch({dom:panelDom,components:filterPanelComponents.map(function(mem){return mem.asSpec()}),containerBehaviours:derive$1([config("image-tools-filter-panel-buttons-events",[run(external$2.disable(),function(comp,se){disableAllComponents(filterPanelComponents,comp)}),run(external$2.enable(),function(comp,se){enableAllComponents(filterPanelComponents,comp)})])])})}function makeColorTransform(red,green,blue){return function(ir){return function(ir,adjustR,adjustG,adjustB){return colorize(ir,adjustR,adjustG,adjustB)}(ir,red,green,blue)}}function makeColorSlider(label){return makeSlider(label,function(slider,thumb,value){var redOpt=memRed.getOpt(slider),blueOpt=memBlue.getOpt(slider),greenOpt=memGreen.getOpt(slider);redOpt.each(function(red){blueOpt.each(function(blue){greenOpt.each(function(green){var r=Representing.getValue(red).x()/100,g=Representing.getValue(green).x()/100,b=Representing.getValue(blue).x()/100,transform=makeColorTransform(r,g,b);emitTransform(slider,transform)})})})},0,100,200)}function getTransformPanelEvent(panel,transform,update){return function(button){emit$1(button,internal.swap(),{transform:transform,swap:function(){memContainer.getOpt(button).each(function(container){Replacing.set(container,[panel]),update(container)})}})}}var panelDom={tag:"div",classes:["tox-image-tools__toolbar","tox-image-tools-edit-panel"]},noop$1=noop,cropPanelComponents=[createBackButton(),createSpacer(),createButton("Apply",function(button){var transform=makeCropTransform();emitTransformApply(button,transform),imagePanel.hideCrop()},!1,!0)],CropPanel=Container.sketch({dom:panelDom,components:cropPanelComponents.map(function(mem){return mem.asSpec()}),containerBehaviours:derive$1([config("image-tools-crop-buttons-events",[run(external$2.disable(),function(comp,se){disableAllComponents(cropPanelComponents,comp)}),run(external$2.enable(),function(comp,se){enableAllComponents(cropPanelComponents,comp)})])])}),memSize=record(renderSizeInput({name:"size",label:Option.none(),constrain:!0,disabled:!1},providersBackstage)),resizePanelComponents=[createBackButton(),createSpacer(),memSize,createSpacer(),createButton("Apply",function(button){memSize.getOpt(button).each(function(sizeInput){var value=Representing.getValue(sizeInput),transform=function(width,height){return function(ir){return resize$2(ir,width,height)}}(parseInt(value.width,10),parseInt(value.height,10));emitTransformApply(button,transform)})},!1,!0)],ResizePanel=Container.sketch({dom:panelDom,components:resizePanelComponents.map(function(mem){return mem.asSpec()}),containerBehaviours:derive$1([config("image-tools-resize-buttons-events",[run(external$2.disable(),function(comp,se){disableAllComponents(resizePanelComponents,comp)}),run(external$2.enable(),function(comp,se){enableAllComponents(resizePanelComponents,comp)})])])}),horizontalFlip=makeValueTransform(flip$1,"h"),verticalFlip=makeValueTransform(flip$1,"v"),counterclockwiseRotate=makeValueTransform(rotate$1,-90),clockwiseRotate=makeValueTransform(rotate$1,90),flipRotateComponents=[createBackButton(),createSpacer(),createIconButton("flip-horizontally","Flip horizontally",function(button){flipRotateOnAction(button,horizontalFlip)},!1),createIconButton("flip-vertically","Flip vertically",function(button){flipRotateOnAction(button,verticalFlip)},!1),createIconButton("rotate-left","Rotate counterclockwise",function(button){flipRotateOnAction(button,counterclockwiseRotate)},!1),createIconButton("rotate-right","Rotate clockwise",function(button){flipRotateOnAction(button,clockwiseRotate)},!1),createSpacer(),createApplyButton()],FlipRotatePanel=Container.sketch({dom:panelDom,components:flipRotateComponents.map(function(mem){return mem.asSpec()}),containerBehaviours:derive$1([config("image-tools-fliprotate-buttons-events",[run(external$2.disable(),function(comp,se){disableAllComponents(flipRotateComponents,comp)}),run(external$2.enable(),function(comp,se){enableAllComponents(flipRotateComponents,comp)})])])}),filterPanelComponents=[createBackButton(),createSpacer(),createApplyButton()],FilterPanel=Container.sketch({dom:panelDom,components:filterPanelComponents.map(function(mem){return mem.asSpec()})}),BrightnessPanel=createVariableFilterPanel("Brightness",brightness$1,-100,0,100),ContrastPanel=createVariableFilterPanel("Contrast",contrast$1,-100,0,100),GammaPanel=createVariableFilterPanel("Gamma",gamma$1,-100,0,100),memRed=makeColorSlider("R"),memGreen=makeColorSlider("G"),memBlue=makeColorSlider("B"),colorizePanelComponents=[createBackButton(),memRed,memGreen,memBlue,createApplyButton()],ColorizePanel=Container.sketch({dom:panelDom,components:colorizePanelComponents.map(function(mem){return mem.asSpec()})}),sharpenTransform=Option.some(sharpen$1),invertTransform=Option.some(invert$1),buttonPanelComponents=[createIconButton("crop","Crop",getTransformPanelEvent(CropPanel,Option.none(),function(_anyInSystem){imagePanel.showCrop()}),!1),createIconButton("resize","Resize",getTransformPanelEvent(ResizePanel,Option.none(),function(anyInSystem){memSize.getOpt(anyInSystem).each(function(sizeInput){var measurements=imagePanel.getMeasurements(),width=measurements.width,height=measurements.height;Representing.setValue(sizeInput,{width:width,height:height})})}),!1),createIconButton("orientation","Orientation",getTransformPanelEvent(FlipRotatePanel,Option.none(),noop$1),!1),createIconButton("brightness","Brightness",getTransformPanelEvent(BrightnessPanel,Option.none(),noop$1),!1),createIconButton("sharpen","Sharpen",getTransformPanelEvent(FilterPanel,sharpenTransform,noop$1),!1),createIconButton("contrast","Contrast",getTransformPanelEvent(ContrastPanel,Option.none(),noop$1),!1),createIconButton("color-levels","Color levels",getTransformPanelEvent(ColorizePanel,Option.none(),noop$1),!1),createIconButton("gamma","Gamma",getTransformPanelEvent(GammaPanel,Option.none(),noop$1),!1),createIconButton("invert","Invert",getTransformPanelEvent(FilterPanel,invertTransform,noop$1),!1)],ButtonPanel=Container.sketch({dom:panelDom,components:buttonPanelComponents.map(function(mem){return mem.asSpec()})}),container=Container.sketch({dom:{tag:"div"},components:[ButtonPanel],containerBehaviours:derive$1([Replacing.config({})])}),memContainer=record(container);return{memContainer:memContainer,getApplyButton:function(anyInSystem){return memContainer.getOpt(anyInSystem).map(function(container){var panel=container.components()[0];return panel.components()[panel.components().length-1]})}}}var internalToolbarButtonExecute=generate$1("toolbar.button.execute"),toolbarButtonEventOrder={"alloy.execute":["disabling","alloy.base.behaviour","toggling","toolbar-button-events"]},updateMenuText=generate$1("update-menu-text"),updateMenuIcon=generate$1("update-menu-icon"),separator$1={type:"separator"},expand=function(items,menuItems){var realItems=unwrapReferences(isString(items)?items.split(" "):items,menuItems);return foldr(realItems,function(acc,item){var itemWithValue=function(item){if(isSeparator(item))return item;var itemValue=get(item,"value").getOrThunk(function(){return generate$1("generated-menu-item")});return deepMerge({value:itemValue},item)}(item),newData=getFromItem(itemWithValue,menuItems);return{menus:deepMerge(acc.menus,newData.menus),items:[newData.item].concat(acc.items),expansions:deepMerge(acc.expansions,newData.expansions)}},{menus:{},expansions:{},items:[]})},schema$i=constant([defaulted$1("field1Name","field1"),defaulted$1("field2Name","field2"),onStrictHandler("onLockedChange"),markers(["lockClass"]),defaulted$1("locked",!1),SketchBehaviours_field("coupledFieldBehaviours",[Composing,Representing])]),parts$5=constant([coupledPart("field1","field2"),coupledPart("field2","field1"),required({factory:Button,schema:[strict$1("dom")],name:"lock",overrides:function(detail){return{buttonBehaviours:derive$1([Toggling.config({selected:detail.locked,toggleClass:detail.markers.lockClass,aria:{mode:"pressed"}})])}}})]),FormCoupledInputs=composite$1({name:"FormCoupledInputs",configFields:schema$i(),partFields:parts$5(),factory:function(detail,components,spec,externals){return{uid:detail.uid,dom:detail.dom,components:components,behaviours:SketchBehaviours_augment(detail.coupledFieldBehaviours,[Composing.config({find:Option.some}),Representing.config({store:{mode:"manual",getValue:function(comp){var _a,parts=getPartsOrDie(comp,detail,["field1","field2"]);return(_a={})[detail.field1Name]=Representing.getValue(parts.field1()),_a[detail.field2Name]=Representing.getValue(parts.field2()),_a},setValue:function(comp,value){var parts=getPartsOrDie(comp,detail,["field1","field2"]);hasNonNullableKey(value,detail.field1Name)&&Representing.setValue(parts.field1(),value[detail.field1Name]),hasNonNullableKey(value,detail.field2Name)&&Representing.setValue(parts.field2(),value[detail.field2Name])}}})]),apis:{getField1:function(component){return getPart(component,detail,"field1")},getField2:function(component){return getPart(component,detail,"field2")},getLock:function(component){return getPart(component,detail,"lock")}}}},apis:{getField1:function(apis,component){return apis.getField1(component)},getField2:function(apis,component){return apis.getField2(component)},getLock:function(apis,component){return apis.getLock(component)}}}),internal={undo:constant(generate$1("undo")),redo:constant(generate$1("redo")),zoom:constant(generate$1("zoom")),back:constant(generate$1("back")),apply:constant(generate$1("apply")),swap:constant(generate$1("swap")),transform:constant(generate$1("transform")),tempTransform:constant(generate$1("temp-transform")),transformApply:constant(generate$1("transform-apply"))},saveState=constant("save-state"),disable$1=constant("disable"),enable$1=constant("enable"),external$2={formActionEvent:formActionEvent,saveState:saveState,disable:disable$1,enable:enable$1},global$b=tinymce.util.Tools.resolve("tinymce.dom.DomQuery"),global$c=tinymce.util.Tools.resolve("tinymce.geom.Rect"),global$d=tinymce.util.Tools.resolve("tinymce.util.Observable"),global$e=tinymce.util.Tools.resolve("tinymce.util.Tools"),global$f=tinymce.util.Tools.resolve("tinymce.util.VK");function updateWithTouchData(e){var keys,i;if(e.changedTouches)for(keys="screenX screenY pageX pageY clientX clientY".split(" "),i=0;i<keys.length;i++)e[keys[i]]=e.changedTouches[0][keys[i]]}function DragHelper(id,settings){var $eventOverlay,downButton,start,stop,drag,startX,startY,doc=settings.document||domGlobals.document;settings=settings||{};var handleElement=doc.getElementById(settings.handle||id);start=function(e){var handleElm,cursor,docSize=function(doc){var documentElement,body,scrollWidth,clientWidth,offsetWidth,scrollHeight,clientHeight,max=Math.max;return documentElement=doc.documentElement,body=doc.body,scrollWidth=max(documentElement.scrollWidth,body.scrollWidth),clientWidth=max(documentElement.clientWidth,body.clientWidth),offsetWidth=max(documentElement.offsetWidth,body.offsetWidth),scrollHeight=max(documentElement.scrollHeight,body.scrollHeight),clientHeight=max(documentElement.clientHeight,body.clientHeight),{width:scrollWidth<offsetWidth?clientWidth:scrollWidth,height:scrollHeight<max(documentElement.offsetHeight,body.offsetHeight)?clientHeight:scrollHeight}}(doc);updateWithTouchData(e),e.preventDefault(),downButton=e.button,handleElm=handleElement,startX=e.screenX,startY=e.screenY,cursor=domGlobals.window.getComputedStyle?domGlobals.window.getComputedStyle(handleElm,null).getPropertyValue("cursor"):handleElm.runtimeStyle.cursor,$eventOverlay=global$b("<div></div>").css({position:"absolute",top:0,left:0,width:docSize.width,height:docSize.height,zIndex:2147483647,opacity:1e-4,cursor:cursor}).appendTo(doc.body),global$b(doc).on("mousemove touchmove",drag).on("mouseup touchend",stop),settings.start(e)},drag=function(e){if(updateWithTouchData(e),e.button!==downButton)return stop(e);e.deltaX=e.screenX-startX,e.deltaY=e.screenY-startY,e.preventDefault(),settings.drag(e)},stop=function(e){updateWithTouchData(e),global$b(doc).off("mousemove touchmove",drag).off("mouseup touchend",stop),$eventOverlay.remove(),settings.stop&&settings.stop(e)},this.destroy=function(){global$b(handleElement).off()},global$b(handleElement).on("mousedown touchstart",start)}function renderImagePanel(initialUrl){function repaintImg(anyInSystem,img){memContainer.getOpt(anyInSystem).each(function(panel){var zoom=zoomState.get(),panelW=get$7(panel.element()),panelH=get$6(panel.element()),width=img.dom().naturalWidth*zoom,height=img.dom().naturalHeight*zoom,left=Math.max(0,panelW/2-width/2),top=Math.max(0,panelH/2-height/2),css={left:left.toString()+"px",top:top.toString()+"px",width:width.toString()+"px",height:height.toString()+"px",position:"absolute"};setAll$1(img,css),memBg.getOpt(panel).each(function(bg){setAll$1(bg.element(),css)}),cropRect.get().each(function(cRect){var rect=rectState.get();cRect.setRect({x:rect.x*zoom+left,y:rect.y*zoom+top,w:rect.w*zoom,h:rect.h*zoom}),cRect.setClampRect({x:left,y:top,w:width,h:height}),cRect.setViewPortRect({x:0,y:0,w:panelW,h:panelH})})})}function updateSrc(anyInSystem,url){var img=Element.fromTag("img");return set$1(img,"src",url),function(image){return new global$6(function(resolve){var loaded=function(){image.removeEventListener("load",loaded),resolve(image)};image.complete?resolve(image):image.addEventListener("load",loaded)})}(img.dom()).then(function(){return memContainer.getOpt(anyInSystem).map(function(panel){var aImg=external({element:img});Replacing.replaceAt(panel,1,Option.some(aImg));var lastViewRect=viewRectState.get(),viewRect={x:0,y:0,w:img.dom().naturalWidth,h:img.dom().naturalHeight};viewRectState.set(viewRect);var rect=global$c.inflate(viewRect,-20,-20);return rectState.set(rect),lastViewRect.w===viewRect.w&&lastViewRect.h===viewRect.h||function(anyInSystem,img){memContainer.getOpt(anyInSystem).each(function(panel){var panelW=get$7(panel.element()),panelH=get$6(panel.element()),width=img.dom().naturalWidth,height=img.dom().naturalHeight,zoom=Math.min(panelW/width,panelH/height);1<=zoom?zoomState.set(1):zoomState.set(zoom)})}(panel,img),repaintImg(panel,img),img})})}var memBg=record({dom:{tag:"div",classes:["tox-image-tools__image-bg"],attributes:{role:"presentation"}}}),zoomState=Cell(1),cropRect=Cell(Option.none()),rectState=Cell({x:0,y:0,w:1,h:1}),viewRectState=Cell({x:0,y:0,w:1,h:1}),container=Container.sketch({dom:{tag:"div",classes:["tox-image-tools__image"]},components:[memBg.asSpec(),{dom:{tag:"img",attributes:{src:initialUrl}}},{dom:{tag:"div"},behaviours:derive$1([config("image-panel-crop-events",[runOnAttached(function(comp){memContainer.getOpt(comp).each(function(container){var el=container.element().dom(),cRect=CropRect_create({x:10,y:10,w:100,h:100},{x:0,y:0,w:200,h:200},{x:0,y:0,w:200,h:200},el,function(){});cRect.toggleVisibility(!1),cRect.on("updateRect",function(e){var rect=e.rect,zoom=zoomState.get(),newRect={x:Math.round(rect.x/zoom),y:Math.round(rect.y/zoom),w:Math.round(rect.w/zoom),h:Math.round(rect.h/zoom)};rectState.set(newRect)}),cropRect.set(Option.some(cRect))})})])])}],containerBehaviours:derive$1([Replacing.config({}),config("image-panel-events",[runOnAttached(function(comp){updateSrc(comp,initialUrl)})])])}),memContainer=record(container);return{memContainer:memContainer,updateSrc:updateSrc,zoom:function(anyInSystem,direction){var currentZoom=zoomState.get(),newZoom=0<direction?Math.min(2,currentZoom+.1):Math.max(.1,currentZoom-.1);zoomState.set(newZoom),memContainer.getOpt(anyInSystem).each(function(panel){var img=panel.components()[1].element();repaintImg(panel,img)})},showCrop:function(){cropRect.get().each(function(cRect){cRect.toggleVisibility(!0)})},hideCrop:function(){cropRect.get().each(function(cRect){cRect.toggleVisibility(!1)})},getRect:function(){return rectState.get()},getMeasurements:function(){var viewRect=viewRectState.get();return{width:viewRect.w,height:viewRect.h}}}}function createButton(innerHtml,icon,disabled,action,providersBackstage){return renderIconButton({name:innerHtml,icon:Option.some(icon),disabled:disabled,tooltip:Option.some(innerHtml),primary:!1,borderless:!1},action,providersBackstage)}function setButtonEnabled(button,enabled){enabled?Disabling.enable(button):Disabling.disable(button)}var count=0,CropRect_create=function(currentRect,viewPortRect,clampRect,containerElm,action){var instance,dragHelpers,blockers,id="tox-crid-"+count++,handles=[{name:"move",xMul:0,yMul:0,deltaX:1,deltaY:1,deltaW:0,deltaH:0,label:"Crop Mask"},{name:"nw",xMul:0,yMul:0,deltaX:1,deltaY:1,deltaW:-1,deltaH:-1,label:"Top Left Crop Handle"},{name:"ne",xMul:1,yMul:0,deltaX:0,deltaY:1,deltaW:1,deltaH:-1,label:"Top Right Crop Handle"},{name:"sw",xMul:0,yMul:1,deltaX:1,deltaY:0,deltaW:-1,deltaH:1,label:"Bottom Left Crop Handle"},{name:"se",xMul:1,yMul:1,deltaX:0,deltaY:0,deltaW:1,deltaH:1,label:"Bottom Right Crop Handle"}];blockers=["top","right","bottom","left"];var getAbsoluteRect=function(outerRect,relativeRect){return{x:relativeRect.x+outerRect.x,y:relativeRect.y+outerRect.y,w:relativeRect.w,h:relativeRect.h}},getRelativeRect=function(outerRect,innerRect){return{x:innerRect.x-outerRect.x,y:innerRect.y-outerRect.y,w:innerRect.w,h:innerRect.h}};function moveRect(handle,startRect,deltaX,deltaY){var x,y,w,h,rect;x=startRect.x,y=startRect.y,w=startRect.w,h=startRect.h,x+=deltaX*handle.deltaX,y+=deltaY*handle.deltaY,(w+=deltaX*handle.deltaW)<20&&(w=20),(h+=deltaY*handle.deltaH)<20&&(h=20),rect=currentRect=global$c.clamp({x:x,y:y,w:w,h:h},clampRect,"move"===handle.name),rect=getRelativeRect(clampRect,rect),instance.fire("updateRect",{rect:rect}),setInnerRect(rect)}function repaint(rect){function updateElementRect(name,rect){rect.h<0&&(rect.h=0),rect.w<0&&(rect.w=0),global$b("#"+id+"-"+name,containerElm).css({left:rect.x,top:rect.y,width:rect.w,height:rect.h})}global$e.each(handles,function(handle){global$b("#"+id+"-"+handle.name,containerElm).css({left:rect.w*handle.xMul+rect.x,top:rect.h*handle.yMul+rect.y})}),updateElementRect("top",{x:viewPortRect.x,y:viewPortRect.y,w:viewPortRect.w,h:rect.y-viewPortRect.y}),updateElementRect("right",{x:rect.x+rect.w,y:rect.y,w:viewPortRect.w-rect.x-rect.w+viewPortRect.x,h:rect.h}),updateElementRect("bottom",{x:viewPortRect.x,y:rect.y+rect.h,w:viewPortRect.w,h:viewPortRect.h-rect.y-rect.h+viewPortRect.y}),updateElementRect("left",{x:viewPortRect.x,y:rect.y,w:rect.x-viewPortRect.x,h:rect.h}),updateElementRect("move",rect)}function setRect(rect){repaint(currentRect=rect)}function setInnerRect(rect){setRect(getAbsoluteRect(clampRect,rect))}return global$b('<div id="'+id+'" class="tox-croprect-container" role="grid" aria-dropeffect="execute">').appendTo(containerElm),global$e.each(blockers,function(blocker){global$b("#"+id,containerElm).append('<div id="'+id+"-"+blocker+'"class="tox-croprect-block" style="display: none" data-mce-bogus="all">')}),global$e.each(handles,function(handle){global$b("#"+id,containerElm).append('<div id="'+id+"-"+handle.name+'" class="tox-croprect-handle tox-croprect-handle-'+handle.name+'"style="display: none" data-mce-bogus="all" role="gridcell" tabindex="-1" aria-label="'+handle.label+'" aria-grabbed="false" title="'+handle.label+'">')}),dragHelpers=global$e.map(handles,function(handle){var startRect;return new DragHelper(id,{document:containerElm.ownerDocument,handle:id+"-"+handle.name,start:function(){startRect=currentRect},drag:function(e){moveRect(handle,startRect,e.deltaX,e.deltaY)}})}),repaint(currentRect),global$b(containerElm).on("focusin focusout",function(e){global$b(e.target).attr("aria-grabbed","focus"===e.type?"true":"false")}),global$b(containerElm).on("keydown",function(e){var activeHandle;function moveAndBlock(evt,handle,startRect,deltaX,deltaY){evt.stopPropagation(),evt.preventDefault(),moveRect(activeHandle,startRect,deltaX,deltaY)}switch(global$e.each(handles,function(handle){if(e.target.id===id+"-"+handle.name)return activeHandle=handle,!1}),e.keyCode){case global$f.LEFT:moveAndBlock(e,0,currentRect,-10,0);break;case global$f.RIGHT:moveAndBlock(e,0,currentRect,10,0);break;case global$f.UP:moveAndBlock(e,0,currentRect,0,-10);break;case global$f.DOWN:moveAndBlock(e,0,currentRect,0,10);break;case global$f.ENTER:case global$f.SPACEBAR:e.preventDefault(),action()}}),instance=global$e.extend({toggleVisibility:function(state){var selectors;selectors=global$e.map(handles,function(handle){return"#"+id+"-"+handle.name}).concat(global$e.map(blockers,function(blocker){return"#"+id+"-"+blocker})).join(","),state?global$b(selectors,containerElm).show():global$b(selectors,containerElm).hide()},setClampRect:function(rect){clampRect=rect,repaint(currentRect)},setRect:setRect,getInnerRect:function(){return getRelativeRect(clampRect,currentRect)},setInnerRect:setInnerRect,setViewPortRect:function(rect){viewPortRect=rect,repaint(currentRect)},destroy:function(){global$e.each(dragHelpers,function(helper){helper.destroy()}),dragHelpers=[]}},global$d)};function UndoStack(){var data=[],index=-1;function canUndo(){return 0<index}function canRedo(){return-1!==index&&index<data.length-1}return{data:data,add:function(state){var removed;return removed=data.splice(++index),data.push(state),{state:state,removed:removed}},undo:function(){if(canUndo())return data[--index]},redo:function(){if(canRedo())return data[++index]},canUndo:canUndo,canRedo:canRedo}}function makeState(initialState){var blobState=Cell(initialState),tempState=Cell(Option.none()),undoStack=UndoStack();function setBlobState(state){blobState.set(state)}function destroyState(state){domGlobals.URL.revokeObjectURL(state.url)}function addBlobState(blob){var newState=createState(blob);return setBlobState(newState),function(states){global$e.each(states,destroyState)}(undoStack.add(newState).removed),newState.url}undoStack.add(initialState);var createState=function(blob){return{blob:blob,url:domGlobals.URL.createObjectURL(blob)}},destroyTempState=function(){tempState.get().each(destroyState),tempState.set(Option.none())};return{getBlobState:function(){return blobState.get()},setBlobState:setBlobState,addBlobState:addBlobState,getTempState:function(){return tempState.get().fold(function(){return blobState.get()},function(temp){return temp})},updateTempState:function(blob){var newTempState=createState(blob);return destroyTempState(),tempState.set(Option.some(newTempState)),newTempState.url},addTempState:function(blob){var newState=createState(blob);return tempState.set(Option.some(newState)),newState.url},applyTempState:function(postApply){return tempState.get().fold(function(){},function(temp){addBlobState(temp.blob),postApply()})},destroyTempState:destroyTempState,undo:function(){var currentState=undoStack.undo();return setBlobState(currentState),currentState.url},redo:function(){var currentState=undoStack.redo();return setBlobState(currentState),currentState.url},getHistoryStates:function(){return{undoEnabled:undoStack.canUndo(),redoEnabled:undoStack.canRedo()}}}}function renderImageTools(detail,providersBackstage){function updateButtonUndoStates(anyInSystem){var historyStates=state.getHistoryStates();sideBar.updateButtonUndoStates(anyInSystem,historyStates.undoEnabled,historyStates.redoEnabled),emitWith(anyInSystem,external$2.formActionEvent,{name:external$2.saveState(),value:historyStates.undoEnabled})}function imageResultToBlob(ir){return ir.toBlob()}function block(anyInSystem){emitWith(anyInSystem,external$2.formActionEvent,{name:external$2.disable(),value:{}})}function blobManipulate(anyInSystem,blob,filter,action,swap){return block(anyInSystem),function(blob){return fromBlob(blob)}(blob).then(filter).then(imageResultToBlob).then(action).then(function(url){return updateSrc(anyInSystem,url).then(function(oImg){return updateButtonUndoStates(anyInSystem),swap(),unblock(anyInSystem),oImg})}).catch(function(err){return domGlobals.console.log(err),unblock(anyInSystem),err})}function manipulate(anyInSystem,filter,swap){var blob=state.getBlobState().blob;blobManipulate(anyInSystem,blob,filter,function(blob){return state.updateTempState(blob)},swap)}var state=makeState(detail.currentState),unblock=function(anyInSystem){editPanel.getApplyButton(anyInSystem).each(function(applyButton){Disabling.enable(applyButton)}),emitWith(anyInSystem,external$2.formActionEvent,{name:external$2.enable(),value:{}})},updateSrc=function(anyInSystem,src){return block(anyInSystem),imagePanel.updateSrc(anyInSystem,src)},destroyTempState=function(anyInSystem){var currentUrl=state.getBlobState().url;return state.destroyTempState(),updateButtonUndoStates(anyInSystem),currentUrl},imagePanel=renderImagePanel(detail.currentState.url),sideBar=function(providersBackstage){var memUndo=record(createButton("Undo","undo",!0,function(button){emitWith(button,internal.undo(),{direction:1})},providersBackstage)),memRedo=record(createButton("Redo","redo",!0,function(button){emitWith(button,internal.redo(),{direction:1})},providersBackstage));return{container:Container.sketch({dom:{tag:"div",classes:["tox-image-tools__toolbar","tox-image-tools__sidebar"]},components:[memUndo.asSpec(),memRedo.asSpec(),createButton("Zoom in","zoom-in",!1,function(button){emitWith(button,internal.zoom(),{direction:1})},providersBackstage),createButton("Zoom out","zoom-out",!1,function(button){emitWith(button,internal.zoom(),{direction:-1})},providersBackstage)]}),updateButtonUndoStates:function(anyInSystem,undoEnabled,redoEnabled){memUndo.getOpt(anyInSystem).each(function(undo){setButtonEnabled(undo,undoEnabled)}),memRedo.getOpt(anyInSystem).each(function(redo){setButtonEnabled(redo,redoEnabled)})}}}(providersBackstage),editPanel=renderEditPanel(imagePanel,providersBackstage);return{dom:{tag:"div",attributes:{role:"presentation"}},components:[editPanel.memContainer.asSpec(),imagePanel.memContainer.asSpec(),sideBar.container],behaviours:derive$1([Representing.config({store:{mode:"manual",getValue:function(){return state.getBlobState()}}}),config("image-tools-events",[run(internal.undo(),function(anyInSystem,_simulatedEvent){var url=state.undo();updateSrc(anyInSystem,url).then(function(oImg){unblock(anyInSystem),updateButtonUndoStates(anyInSystem)})}),run(internal.redo(),function(anyInSystem,_simulatedEvent){var url=state.redo();updateSrc(anyInSystem,url).then(function(oImg){unblock(anyInSystem),updateButtonUndoStates(anyInSystem)})}),run(internal.zoom(),function(anyInSystem,simulatedEvent){var direction=simulatedEvent.event().direction();imagePanel.zoom(anyInSystem,direction)}),run(internal.back(),function(anyInSystem,simulatedEvent){!function(anyInSystem){var currentUrl=destroyTempState(anyInSystem);updateSrc(anyInSystem,currentUrl).then(function(oImg){unblock(anyInSystem)})}(anyInSystem),simulatedEvent.event().swap()(),imagePanel.hideCrop()}),run(internal.apply(),function(anyInSystem,simulatedEvent){state.applyTempState(function(){destroyTempState(anyInSystem),simulatedEvent.event().swap()()})}),run(internal.transform(),function(anyInSystem,simulatedEvent){return manipulate(anyInSystem,simulatedEvent.event().transform(),noop)}),run(internal.tempTransform(),function(anyInSystem,simulatedEvent){return function(anyInSystem,filter){var blob=state.getTempState().blob;blobManipulate(anyInSystem,blob,filter,function(blob){return state.addTempState(blob)},noop)}(anyInSystem,simulatedEvent.event().transform())}),run(internal.transformApply(),function(anyInSystem,simulatedEvent){return function(anyInSystem,filter,swap){var blob=state.getBlobState().blob;blobManipulate(anyInSystem,blob,filter,function(blob){var url=state.addBlobState(blob);return destroyTempState(anyInSystem),url},swap)}(anyInSystem,simulatedEvent.event().transform(),simulatedEvent.event().swap())}),run(internal.swap(),function(anyInSystem,simulatedEvent){!function(anyInSystem){sideBar.updateButtonUndoStates(anyInSystem,!1,!1)}(anyInSystem);var transform=simulatedEvent.event().transform(),swap=simulatedEvent.event().swap();transform.fold(function(){swap()},function(transform){manipulate(anyInSystem,transform,swap)})})]),ComposingConfigs_self()])}}function renderTextField(spec,providersBackstage){var pLabel=spec.label.map(function(label){return renderLabel(label,providersBackstage)}),baseInputBehaviours=[Disabling.config({disabled:spec.disabled}),Keying.config({mode:"execution",useEnter:!0!==spec.multiline,useControlEnter:!0===spec.multiline,execute:function(comp){return emit(comp,formSubmitEvent),Option.some(!0)}}),config("textfield-change",[run(input(),function(component,_){emitWith(component,formChangeEvent,{name:spec.name})}),run(postPaste(),function(component,_){emitWith(component,formChangeEvent,{name:spec.name})})]),Tabstopping.config({})],validatingBehaviours=spec.validation.map(function(vl){return Invalidating.config({getRoot:function(input){return parent(input.element())},invalidClass:"tox-invalid",validator:{validate:function(input){var v=Representing.getValue(input),result=vl.validator(v);return Future_pure(!0===result?Result.value(v):Result.error(result))},validateOnLoad:vl.validateOnLoad}})}).toArray(),placeholder=spec.placeholder.fold(constant({}),function(p){return{placeholder:providersBackstage.translate(p)}}),inputMode=spec.inputMode.fold(constant({}),function(mode){return{inputmode:mode}}),inputAttributes=__assign(__assign({},placeholder),inputMode),pField=FormField.parts().field({tag:!0===spec.multiline?"textarea":"input",inputAttributes:inputAttributes,inputClasses:[spec.classname],inputBehaviours:derive$1(flatten([baseInputBehaviours,validatingBehaviours])),selectOnFocus:!1,factory:Input}),extraClasses2=(spec.flex?["tox-form__group--stretched"]:[]).concat(spec.maximized?["tox-form-group--maximize"]:[]),extraBehaviours=[Disabling.config({disabled:spec.disabled,onDisabled:function(comp){FormField.getField(comp).each(Disabling.disable)},onEnabled:function(comp){FormField.getField(comp).each(Disabling.enable)}})];return renderFormFieldWith(pLabel,pField,extraClasses2,extraBehaviours)}function throttle(_config){var state=Cell(null);return nu$5({readState:function(){return{timer:null!==state.get()?"set":"unset"}},setTimer:function(t){state.set(t)},cancel:function(){var t=state.get();null!==t&&t.cancel()}})}function setValueFromItem(model,input,item){var itemData=Representing.getValue(item);Representing.setValue(input,itemData),setCursorAtEnd(input)}function setSelectionOn(input,f){var el=input.element(),value=get$5(el),node=el.dom();"number"!==get$2(el,"type")&&f(node,value)}function attemptSelectOver(model,input,item){if(model.selectsOver){var currentValue=Representing.getValue(input),inputDisplay_1=model.getDisplayText(currentValue),itemValue=Representing.getValue(item);return 0===model.getDisplayText(itemValue).indexOf(inputDisplay_1)?Option.some(function(){setValueFromItem(0,input,item),function(input,startOffset){setSelectionOn(input,function(node,value){return node.setSelectionRange(startOffset,value.length)})}(input,inputDisplay_1.length)}):Option.none()}return Option.none()}function nu$c(worker){return wrap$2(Future_nu(worker))}function toMenuItem(target){return{type:"menuitem",value:target.url,text:target.title,meta:{attach:target.attach},onAction:function(){}}}function staticMenuItem(title,url){return{type:"menuitem",value:url,text:title,meta:{attach:void 0},onAction:function(){}}}function filteredTargets(type,targets){return function(targets){return map(targets,toMenuItem)}(function(type,targets){return filter(targets,function(target){return target.type===type})}(type,targets))}function filterByQuery(term,menuItems){var lowerCaseTerm=term.toLowerCase();return filter(menuItems,function(item){var text=void 0!==item.meta&&void 0!==item.meta.text?item.meta.text:item.text;return contains$1(text.toLowerCase(),lowerCaseTerm)||contains$1(item.value.toLowerCase(),lowerCaseTerm)})}function getItems(fileType,input,urlBackstage){var urlInputValue=Representing.getValue(input),term=void 0!==urlInputValue.meta.text?urlInputValue.meta.text:urlInputValue.value;return urlBackstage.getLinkInformation().fold(function(){return[]},function(linkInfo){var history=filterByQuery(term,function(history){return map(history,function(url){return staticMenuItem(url,url)})}(urlBackstage.getHistory(fileType)));return"file"===fileType?function(items){return foldl(items,function(a,b){return 0===a.length||0===b.length?a.concat(b):a.concat(separator$2,b)},[])}([history,filterByQuery(term,function(linkInfo){return filteredTargets("header",linkInfo.targets)}(linkInfo)),filterByQuery(term,flatten([function(linkInfo){return Option.from(linkInfo.anchorTop).map(function(url){return staticMenuItem("<top>",url)}).toArray()}(linkInfo),function(linkInfo){return filteredTargets("anchor",linkInfo.targets)}(linkInfo),function(linkInfo){return Option.from(linkInfo.anchorBottom).map(function(url){return staticMenuItem("<bottom>",url)}).toArray()}(linkInfo)]))]):history})}function renderUrlInput(spec,backstage,urlBackstage){function updateHistory(component){var urlEntry=Representing.getValue(component);urlBackstage.addToHistory(urlEntry.value,spec.filetype)}var _a,name,errId,icon,label,providersBackstage=backstage.shared.providers,pField=FormField.parts().field({factory:Typeahead,dismissOnBlur:!0,inputClasses:["tox-textfield"],sandboxClasses:["tox-dialog__popups"],inputAttributes:{"aria-errormessage":errorId,type:"url"},minChars:0,responseTime:0,fetch:function(input){var items=getItems(spec.filetype,input,urlBackstage),tdata=build$2(items,ItemResponse$1.BUBBLE_TO_SANDBOX,backstage,!1);return Future_pure(tdata)},getHotspot:function(comp){return memUrlBox.getOpt(comp)},onSetValue:function(comp,newValue){comp.hasConfigured(Invalidating)&&Invalidating.run(comp).get(noop)},typeaheadBehaviours:derive$1(flatten([urlBackstage.getValidationHandler().map(function(handler){return Invalidating.config({getRoot:function(comp){return parent(comp.element())},invalidClass:"tox-control-wrap--status-invalid",notify:{onInvalid:function(comp,err){memInvalidIcon.getOpt(comp).each(function(invalidComp){set$1(invalidComp.element(),"title",providersBackstage.translate(err))})}},validator:{validate:function(input){var urlEntry=Representing.getValue(input);return FutureResult_nu(function(completer){handler({type:spec.filetype,url:urlEntry.value},function(validation){if("invalid"===validation.status){var err=Result.error(validation.message);completer(err)}else{var val=Result.value(validation.message);completer(val)}})})},validateOnLoad:!1}})}).toArray(),[Disabling.config({disabled:spec.disabled}),Tabstopping.config({}),config("urlinput-events",flatten(["file"===spec.filetype?[run(input(),function(comp){emitWith(comp,formChangeEvent,{name:spec.name})})]:[],[run(change(),function(comp){emitWith(comp,formChangeEvent,{name:spec.name}),updateHistory(comp)}),run(postPaste(),function(comp){emitWith(comp,formChangeEvent,{name:spec.name}),updateHistory(comp)})]]))]])),eventOrder:(_a={},_a[input()]=["streaming","urlinput-events","invalidating"],_a),model:{getDisplayText:function(itemData){return itemData.value},selectsOver:!1,populateFromBrowse:!1},markers:{openClass:"tox-textfield--popup-open"},lazySink:backstage.shared.getSink,parts:{menu:part(0,0,"normal")},onExecute:function(_menu,component,_entry){emitWith(component,formSubmitEvent,{})},onItemExecute:function(typeahead,_sandbox,_item,_value){updateHistory(typeahead),emitWith(typeahead,formChangeEvent,{name:spec.name})}}),pLabel=spec.label.map(function(label){return renderLabel(label,providersBackstage)}),memInvalidIcon=record((name="invalid",errId=Option.some(errorId),void 0===(icon="warning")&&(icon=name),void 0===label&&(label=name),{dom:{tag:"div",classes:["tox-icon","tox-control-wrap__status-icon-"+name],innerHtml:get$d(icon,providersBackstage.icons),attributes:__assign({title:providersBackstage.translate(label),"aria-live":"polite"},errId.fold(function(){return{}},function(id){return{id:id}}))}})),memStatus=record({dom:{tag:"div",classes:["tox-control-wrap__status-icon-wrap"]},components:[memInvalidIcon.asSpec()]}),optUrlPicker=urlBackstage.getUrlPicker(spec.filetype),browseUrlEvent=generate$1("browser.url.event"),memUrlBox=record({dom:{tag:"div",classes:["tox-control-wrap"]},components:[pField,memStatus.asSpec()],behaviours:derive$1([Disabling.config({disabled:spec.disabled})])}),memUrlPickerButton=record(renderButton({name:spec.name,icon:Option.some("browse"),text:spec.label.getOr(""),disabled:spec.disabled,primary:!1,borderless:!0},function(component){return emit(component,browseUrlEvent)},providersBackstage,[],["tox-browse-url"]));return FormField.sketch({dom:renderFormFieldDomWith([]),components:pLabel.toArray().concat([{dom:{tag:"div",classes:["tox-form__controls-h-stack"]},components:flatten([[memUrlBox.asSpec()],optUrlPicker.map(function(){return memUrlPickerButton.asSpec()}).toArray()])}]),fieldBehaviours:derive$1([Disabling.config({disabled:spec.disabled,onDisabled:function(comp){FormField.getField(comp).each(Disabling.disable),memUrlPickerButton.getOpt(comp).each(Disabling.disable)},onEnabled:function(comp){FormField.getField(comp).each(Disabling.enable),memUrlPickerButton.getOpt(comp).each(Disabling.enable)}}),config("url-input-events",[run(browseUrlEvent,function(comp){Composing.getCurrent(comp).each(function(field){var componentData=Representing.getValue(field),urlData=__assign({fieldname:spec.name},componentData);optUrlPicker.each(function(picker){picker(urlData).get(function(chosenData){Representing.setValue(field,chosenData),emitWith(comp,formChangeEvent,{name:spec.name})})})})})])])})}function renderCheckbox(spec,providerBackstage){function toggleCheckboxHandler(comp){return comp.element().dom().click(),Option.some(!0)}function makeIcon(className){return{dom:{tag:"span",classes:["tox-icon","tox-checkbox-icon__"+className],innerHtml:get$d("checked"===className?"selected":"unselected",providerBackstage.icons)}}}var repBehaviour=Representing.config({store:{mode:"manual",getValue:function(comp){return comp.element().dom().checked},setValue:function(comp,value){comp.element().dom().checked=value}}}),pField=FormField.parts().field({factory:{sketch:identity},dom:{tag:"input",classes:["tox-checkbox__input"],attributes:{type:"checkbox"}},behaviours:derive$1([ComposingConfigs_self(),Disabling.config({disabled:spec.disabled}),Tabstopping.config({}),Focusing.config({}),repBehaviour,Keying.config({mode:"special",onEnter:toggleCheckboxHandler,onSpace:toggleCheckboxHandler,stopSpaceKeyup:!0}),config("checkbox-events",[run(change(),function(component,_){emitWith(component,formChangeEvent,{name:spec.name})})])])}),pLabel=FormField.parts().label({dom:{tag:"span",classes:["tox-checkbox__label"],innerHtml:providerBackstage.translate(spec.label)},behaviours:derive$1([Unselecting.config({})])}),memIcons=record({dom:{tag:"div",classes:["tox-checkbox__icons"]},components:[makeIcon("checked"),makeIcon("unchecked")]});return FormField.sketch({dom:{tag:"label",classes:["tox-checkbox"]},components:[pField,memIcons.asSpec(),pLabel],fieldBehaviours:derive$1([Disabling.config({disabled:spec.disabled,disableClass:"tox-checkbox--disabled",onDisabled:function(comp){FormField.getField(comp).each(Disabling.disable)},onEnabled:function(comp){FormField.getField(comp).each(Disabling.enable)}})])})}function renderCollection(spec,providersBackstage){function runOnItem(f){return function(comp,se){closest$3(se.event().target(),"[data-collection-item-value]").each(function(target){f(comp,se,target,get$2(target,"data-collection-item-value"))})}}var pLabel=spec.label.map(function(label){return renderLabel(label,providersBackstage)}),onClick=runOnItem(function(comp,se,tgt,itemValue){se.stop(),emitWith(comp,formActionEvent,{name:spec.name,value:itemValue})}),collectionEvents=[run(mouseover(),runOnItem(function(comp,se,tgt){focus$1(tgt)})),run(click(),onClick),run(tap(),onClick),run(focusin(),runOnItem(function(comp,se,tgt){descendant$1(comp.element(),"."+activeClass).each(function(currentActive){remove$4(currentActive,activeClass)}),add$2(tgt,activeClass)})),run(focusout(),runOnItem(function(comp){descendant$1(comp.element(),"."+activeClass).each(function(currentActive){remove$4(currentActive,activeClass)})})),runOnExecute(runOnItem(function(comp,se,tgt,itemValue){emitWith(comp,formActionEvent,{name:spec.name,value:itemValue})}))],pField=FormField.parts().field({dom:{tag:"div",classes:["tox-collection"].concat(1!==spec.columns?["tox-collection--grid"]:["tox-collection--list"])},components:[],factory:{sketch:identity},behaviours:derive$1([Replacing.config({}),Representing.config({store:{mode:"memory",initialValue:[]},onSetValue:function(comp,items){!function(comp,items){var htmlLines=map(items,function(item){var itemText=global$7.translate(item.text),textContent=1===spec.columns?'<div class="tox-collection__item-label">'+itemText+"</div>":"",iconContent='<div class="tox-collection__item-icon">'+item.icon+"</div>",mapItemName={_:" "," - ":" ","-":" "},ariaLabel=itemText.replace(/\_| \- |\-/g,function(match){return mapItemName[match]});return'<div class="tox-collection__item" tabindex="-1" data-collection-item-value="'+function(ch){return'"'===ch?"&quot;":ch}(item.value)+'" title="'+ariaLabel+'" aria-label="'+ariaLabel+'">'+iconContent+textContent+"</div>"}),chunks=1<spec.columns&&"auto"!==spec.columns?chunk(htmlLines,spec.columns):[htmlLines],html=map(chunks,function(ch){return'<div class="tox-collection__group">'+ch.join("")+"</div>"});set(comp.element(),html.join(""))}(comp,items),"auto"===spec.columns&&detectSize(comp,5,"tox-collection__item").each(function(_a){var numRows=_a.numRows,numColumns=_a.numColumns;Keying.setGridSize(comp,numRows,numColumns)}),emit(comp,formResizeEvent)}}),Tabstopping.config({}),Keying.config(function(columns,presets){return 1===columns?{mode:"menu",moveOnTab:!1,selector:".tox-collection__item"}:"auto"===columns?{mode:"flatgrid",selector:".tox-collection__item",initSize:{numColumns:1,numRows:1}}:{mode:"matrix",selectors:{row:"color"===presets?".tox-swatches__row":".tox-collection__group",cell:"color"===presets?".tox-swatch":"."+selectableClass}}}(spec.columns,"normal")),config("collection-events",collectionEvents)])});return renderFormFieldWith(pLabel,pField,["tox-form__group--collection"],[])}function renderTable(spec,providersBackstage){function renderTh(text){return{dom:{tag:"th",innerHtml:providersBackstage.translate(text)}}}function renderTd(text){return{dom:{tag:"td",innerHtml:providersBackstage.translate(text)}}}function renderTr(row){return{dom:{tag:"tr"},components:map(row,renderTd)}}var rows,header;return{dom:{tag:"table",classes:["tox-dialog__table"]},components:[(header=spec.header,{dom:{tag:"thead"},components:[{dom:{tag:"tr"},components:map(header,renderTh)}]}),(rows=spec.cells,{dom:{tag:"tbody"},components:map(rows,renderTr)})],behaviours:derive$1([Tabstopping.config({}),Focusing.config({})])}}function make$6(render){return function(parts,spec,backstage){return get(spec,"name").fold(function(){return render(spec,backstage)},function(fieldName){return parts.field(fieldName,render(spec,backstage))})}}function interpretInForm(parts,spec,oldBackstage){var newBackstage=deepMerge(oldBackstage,{shared:{interpreter:function(childSpec){return interpretParts(parts,childSpec,newBackstage)}}});return interpretParts(parts,spec,newBackstage)}function ColorInputBackstage(editor){return{colorPicker:function(editor){return function(callback,value){ColorSwatch.colorPickerDialog(editor)(callback,value)}}(editor),hasCustomColors:function(editor){return function(){return Settings_hasCustomColors(editor)}}(editor),getColors:function(editor){return function(){return Settings_getColors(editor)}}(editor),getColorCols:function(editor){return function(){return ColorSwatch.getColorCols(editor)}}(editor)}}function registerCustomFormats(editor,userFormats){function registerFormats(customFormats){each(customFormats,function(fmt){editor.formatter.has(fmt.name)||editor.formatter.register(fmt.name,fmt.format)})}var result=mapFormats(userFormats);return editor.formatter?registerFormats(result.customFormats):editor.on("init",function(){registerFormats(result.customFormats)}),result.formats}function getStyleFormats(editor){return function(editor){return Option.from(editor.getParam("style_formats")).filter(isArray)}(editor).map(function(userFormats){var registeredUserFormats=registerCustomFormats(editor,userFormats);return function(editor){return editor.getParam("style_formats_merge",!1,"boolean")}(editor)?defaultStyleFormats.concat(registeredUserFormats):registeredUserFormats}).getOr(defaultStyleFormats)}function processBasic(item,isSelectedFor,getPreviewFor){var formatterSpec={type:"formatter",isSelected:isSelectedFor(item.format),getStylePreview:getPreviewFor(item.format)};return deepMerge(item,formatterSpec)}function register$3(editor,formats,isSelectedFor,getPreviewFor){var doEnrich=function(items){return map(items,function(item){var keys$1=keys(item);if(hasNonNullableKey(item,"items")){var newItems_1=doEnrich(item.items);return deepMerge(function(item){return deepMerge(item,{type:"submenu"})}(item),{getStyleItems:function(){return newItems_1}})}return hasNonNullableKey(item,"format")?function(item){return processBasic(item,isSelectedFor,getPreviewFor)}(item):1===keys$1.length&&contains(keys$1,"title")?deepMerge(item,{type:"separator"}):function(item){var formatName=generate$1(item.title),customSpec={type:"formatter",format:formatName,isSelected:isSelectedFor(formatName),getStylePreview:getPreviewFor(formatName)},newItem=deepMerge(item,customSpec);return editor.formatter.register(formatName,newItem),newItem}(item)})};return doEnrich(formats)}function init$7(editor){function isSelectedFor(format){return function(){return editor.formatter.match(format)}}function getPreviewFor(format){return function(){var fmt=editor.formatter.get(format);return void 0!==fmt?Option.some({tag:0<fmt.length&&(fmt[0].inline||fmt[0].block)||"div",styles:editor.dom.parseStyle(editor.formatter.getCssText(format))}):Option.none()}}var flatten=function(fmt){var subs=fmt.items;return void 0!==subs&&0<subs.length?bind(subs,flatten):[fmt.format]},settingsFormats=Cell([]),settingsFlattenedFormats=Cell([]),eventsFormats=Cell([]),eventsFlattenedFormats=Cell([]),replaceSettings=Cell(!1);return editor.on("PreInit",function(e){var formats=getStyleFormats(editor),enriched=register$3(editor,formats,isSelectedFor,getPreviewFor);settingsFormats.set(enriched),settingsFlattenedFormats.set(bind(enriched,flatten))}),editor.on("addStyleModifications",function(e){var modifications=register$3(editor,e.items,isSelectedFor,getPreviewFor);eventsFormats.set(modifications),replaceSettings.set(e.replace),eventsFlattenedFormats.set(bind(modifications,flatten))}),{getData:function(){var fromSettings=replaceSettings.get()?[]:settingsFormats.get(),fromEvents=eventsFormats.get();return fromSettings.concat(fromEvents)},getFlattenedKeys:function(){var fromSettings=replaceSettings.get()?[]:settingsFlattenedFormats.get(),fromEvents=eventsFlattenedFormats.get();return fromSettings.concat(fromEvents)}}}function hasContentEditableState(value){return function(node){if(node&&1===node.nodeType){if(node.contentEditable===value)return!0;if(node.getAttribute("data-mce-contenteditable")===value)return!0}return!1}}function create$8(type,title,url,level,attach){return{type:type,title:title,url:url,level:level,attach:attach}}function getElementText(elm){return elm.innerText||elm.textContent}function isValidAnchor(elm){return function(elm){return elm&&"A"===elm.nodeName&&void 0!==(elm.id||elm.name)}(elm)&&isEditable(elm)}function isHeader(elm){return elm&&/^(H[1-6])$/.test(elm.nodeName)}function isValidHeader(elm){return isHeader(elm)&&isEditable(elm)}function headerTarget(elm){var headerId=function(elm){return elm.id?elm.id:generate$1("h")}(elm);return create$8("header",getElementText(elm),"#"+headerId,function(elm){return isHeader(elm)?parseInt(elm.nodeName.substr(1),10):0}(elm),function(){elm.id=headerId})}function anchorTarget(elm){var anchorId=elm.id||elm.name,anchorText=getElementText(elm);return create$8("anchor",anchorText||"#"+anchorId,"#"+anchorId,0,noop)}function getTargetElements(elm){return function(selector,root){return map(descendants(Element.fromDom(root),selector),function(element){return element.dom()})}("h1,h2,h3,h4,h5,h6,a:not([href])",elm)}function hasTitle(target){return 0<trim$1(target.title).length}function isHttpUrl(url){return isString(url)&&/^https?/.test(url)}function isRecordOfUrlArray(r){return isObject(r)&&find$1(r,function(value){return!function(a){return isArray(a)&&a.length<=5&&forall(a,isHttpUrl)}(value)}).isNone()}function getAllHistory(){var history,unparsedHistory=domGlobals.localStorage.getItem(STORAGE_KEY);if(null===unparsedHistory)return{};try{history=JSON.parse(unparsedHistory)}catch(e){if(e instanceof SyntaxError)return domGlobals.console.log("Local storage "+STORAGE_KEY+" was not valid JSON",e),{};throw e}return isRecordOfUrlArray(history)?history:(domGlobals.console.log("Local storage "+STORAGE_KEY+" was not valid format",history),{})}function getHistory(fileType){var history=getAllHistory();return Object.prototype.hasOwnProperty.call(history,fileType)?history[fileType]:[]}function addToHistory(url,fileType){if(isHttpUrl(url)){var history=getAllHistory(),items=Object.prototype.hasOwnProperty.call(history,fileType)?history[fileType]:[],itemsWithoutUrl=filter(items,function(item){return item!==url});history[fileType]=[url].concat(itemsWithoutUrl).slice(0,5),function(history){if(!isRecordOfUrlArray(history))throw new Error("Bad format for history:\n"+JSON.stringify(history));domGlobals.localStorage.setItem(STORAGE_KEY,JSON.stringify(history))}(history)}}function isTruthy(value){return!!value}function makeMap(value){return map$1(global$e.makeMap(value,/[, ]/),isTruthy)}function getTextSetting(settings,name,defaultValue){var value=function(obj,key){return hasOwnProperty$2.call(obj,key)?Option.some(obj[key]):Option.none()}(settings,name).getOr(defaultValue);return isString(value)?Option.some(value):Option.none()}function getPicker(settings){return Option.some(settings.file_picker_callback).filter(isFunction)}function getPickerSetting(settings,filetype){var pickerTypes=function(settings){var optFileTypes=Option.some(settings.file_picker_types).filter(isTruthy),optLegacyTypes=Option.some(settings.file_browser_callback_types).filter(isTruthy),optTypes=optFileTypes.or(optLegacyTypes).map(makeMap);return getPicker(settings).fold(function(){return!1},function(_picker){return optTypes.fold(function(){return!0},function(types){return 0<keys(types).length&&types})})}(settings);return isBoolean(pickerTypes)?pickerTypes?getPicker(settings):Option.none():pickerTypes[filetype]?getPicker(settings):Option.none()}function UrlInputBackstage(editor){return{getHistory:getHistory,addToHistory:addToHistory,getLinkInformation:function(){return function(editor){return!1===editor.settings.typeahead_urls?Option.none():Option.some({targets:LinkTargets_find(editor.getBody()),anchorTop:getTextSetting(editor.settings,"anchor_top","#top").getOrUndefined(),anchorBottom:getTextSetting(editor.settings,"anchor_bottom","#bottom").getOrUndefined()})}(editor)},getValidationHandler:function(){return function(editor){return Option.from(editor.settings.file_picker_validator_handler).filter(isFunction).orThunk(function(){return Option.from(editor.settings.filepicker_validator_handler).filter(isFunction)})}(editor)},getUrlPicker:function(filetype){return function(editor,filetype){return getPickerSetting(editor.settings,filetype).map(function(picker){return function(entry){return Future_nu(function(completer){var meta=__assign({filetype:filetype,fieldname:entry.fieldname},Option.from(entry.meta).getOr({}));picker.call(editor,function(value,meta){if(!isString(value))throw new Error("Expected value to be string");if(void 0!==meta&&!isObject(meta))throw new Error("Expected meta to be a object");completer({value:value,meta:meta})},entry.value,meta)})}})}(editor,filetype)}}}function init$8(sink,editor,lazyAnchorbar){var contextMenuState=Cell(!1),backstage={shared:{providers:{icons:function(){return editor.ui.registry.getAll().icons},menuItems:function(){return editor.ui.registry.getAll().menuItems},translate:global$7.translate},interpreter:function(s){return function(spec,backstage){return interpretParts(noFormParts,spec,backstage)}(s,backstage)},anchors:Anchors_getAnchors(editor,lazyAnchorbar),getSink:function(){return Result.value(sink)}},urlinput:UrlInputBackstage(editor),styleselect:init$7(editor),colorinput:ColorInputBackstage(editor),dialog:function(editor){return{isDraggableModal:function(editor){return function(){return function(editor){return editor.getParam("draggable_modal",!1,"boolean")}(editor)}}(editor)}}(editor),isContextMenuOpen:function(){return contextMenuState.get()},setContextMenuState:function(state){return contextMenuState.set(state)}};return backstage}function apportion(units,total,len){var parray=function(xs,f){return foldl(xs,function(b,a){return f(a,b.len).fold(constant(b),function(v){return{len:v.finish(),list:b.list.concat([v])}})},{len:0,list:[]}).list}(units,function(unit,current){var width=len(unit);return Option.some({element:constant(unit),start:constant(current),finish:constant(current+width),width:constant(width)})}),within=filter(parray,function(unit){return unit.finish()<=total}),withinWidth=foldr(within,function(acc,el){return acc+el.width()},0),extra=parray.slice(within.length);return{within:constant(within),extra:constant(extra),withinWidth:constant(withinWidth)}}function toUnit(parray){return map(parray,function(unit){return unit.element()})}function partition$3(total,units,len,overflower){var divide=function(total,units,len){var divide=apportion(units,total,len);return 0===divide.extra().length?Option.some(divide):Option.none()}(total,units,len).getOrThunk(function(){return apportion(units,total-len(overflower),len)}),within=divide.within(),extra=divide.extra(),withinWidth=divide.withinWidth();return 1===extra.length&&extra[0].width()<=len(overflower)?function(within,extra,withinWidth){var fits=toUnit(within.concat(extra));return output$1(fits,[],withinWidth)}(within,extra,withinWidth):1<=extra.length?function(within,extra,overflower,withinWidth){var fits=toUnit(within).concat([overflower]);return output$1(fits,toUnit(extra),withinWidth)}(within,extra,overflower,withinWidth):function(within,extra,withinWidth){return output$1(toUnit(within),[],withinWidth)}(within,0,withinWidth)}function setGroups(toolbar,storedGroups){var bGroups=map(storedGroups,function(g){return premade$1(g)});Toolbar.setGroups(toolbar,bGroups)}function refresh(toolbar,detail,setOverflow){var primary=getPartOrDie(toolbar,detail,"primary"),overflowGroup=Coupling.getCoupled(toolbar,"overflowGroup");set$2(primary.element(),"visibility","hidden");var groups=detail.builtGroups.get().concat([overflowGroup]),focusedComp=function(comps){return findMap(comps,function(comp){return search(comp.element()).bind(function(focusedElm){return comp.getSystem().getByDom(focusedElm).toOption()})})}(groups);setOverflow([]),setGroups(primary,groups);var availableWidth=get$7(primary.element()),overflows=partition$3(availableWidth,detail.builtGroups.get(),function(comp){return get$7(comp.element())},overflowGroup);0===overflows.extra().length?(Replacing.remove(primary,overflowGroup),setOverflow([])):(setGroups(primary,overflows.within()),setOverflow(overflows.extra())),remove$6(primary.element(),"visibility"),reflow(primary.element()),focusedComp.each(Focusing.focus)}function toggle$2(button,externals){var toolbarSandbox=Coupling.getCoupled(button,"toolbarSandbox");Sandboxing.isOpen(toolbarSandbox)?Sandboxing.close(toolbarSandbox):Sandboxing.open(toolbarSandbox,externals.toolbar())}function position$2(button,toolbar,detail,layouts){var bounds=detail.getBounds.map(function(bounder){return bounder()}),sink=detail.lazySink(button).getOrDie();Positioning.positionWithinBounds(sink,{anchor:"hotspot",hotspot:button,layouts:layouts,overrides:{maxWidthFunction:expandable$1()}},toolbar,bounds)}function setGroups$1(button,toolbar,detail,layouts,groups){Toolbar.setGroups(toolbar,groups),position$2(button,toolbar,detail,layouts),Toggling.on(button)}function buildGroups(comps){return map(comps,function(g){return premade$1(g)})}function refresh$1(toolbar,memFloatingToolbarButton,detail){refresh(toolbar,detail,function(overflowGroups){detail.overflowGroups.set(overflowGroups),memFloatingToolbarButton.getOpt(toolbar).each(function(floatingToolbarButton){FloatingToolbarButton.setGroups(floatingToolbarButton,buildGroups(overflowGroups))})})}function getAnimationRoot(component,slideConfig){return slideConfig.getAnimationRoot.fold(function(){return component.element()},function(get){return get(component)})}function getDimensionProperty(slideConfig){return slideConfig.dimension.property}function getDimension(slideConfig,elem){return slideConfig.dimension.getDimension(elem)}function disableTransitions(component,slideConfig){var root=getAnimationRoot(component,slideConfig);remove$5(root,[slideConfig.shrinkingClass,slideConfig.growingClass])}function setShrunk(component,slideConfig){remove$4(component.element(),slideConfig.openClass),add$2(component.element(),slideConfig.closedClass),set$2(component.element(),getDimensionProperty(slideConfig),"0px"),reflow(component.element())}function setGrown(component,slideConfig){remove$4(component.element(),slideConfig.closedClass),add$2(component.element(),slideConfig.openClass),remove$6(component.element(),getDimensionProperty(slideConfig))}function doImmediateShrink(component,slideConfig,slideState,_calculatedSize){slideState.setCollapsed(),set$2(component.element(),getDimensionProperty(slideConfig),getDimension(slideConfig,component.element())),reflow(component.element()),disableTransitions(component,slideConfig),setShrunk(component,slideConfig),slideConfig.onStartShrink(component),slideConfig.onShrunk(component)}function doStartShrink(component,slideConfig,slideState,calculatedSize){var size=calculatedSize.getOrThunk(function(){return getDimension(slideConfig,component.element())});slideState.setCollapsed(),set$2(component.element(),getDimensionProperty(slideConfig),size),reflow(component.element());var root=getAnimationRoot(component,slideConfig);remove$4(root,slideConfig.growingClass),add$2(root,slideConfig.shrinkingClass),setShrunk(component,slideConfig),slideConfig.onStartShrink(component)}function doStartSmartShrink(component,slideConfig,slideState){var size=getDimension(slideConfig,component.element());("0px"===size?doImmediateShrink:doStartShrink)(component,slideConfig,slideState,Option.some(size))}function doStartGrow(component,slideConfig,slideState){var root=getAnimationRoot(component,slideConfig),wasShrinking=has$2(root,slideConfig.shrinkingClass),beforeSize=getDimension(slideConfig,component.element());setGrown(component,slideConfig);var fullSize=getDimension(slideConfig,component.element());(wasShrinking?function(){set$2(component.element(),getDimensionProperty(slideConfig),beforeSize),reflow(component.element())}:function(){setShrunk(component,slideConfig)})(),remove$4(root,slideConfig.shrinkingClass),add$2(root,slideConfig.growingClass),setGrown(component,slideConfig),set$2(component.element(),getDimensionProperty(slideConfig),fullSize),slideState.setExpanded(),slideConfig.onStartGrow(component)}function isGrowing(component,slideConfig,slideState){var root=getAnimationRoot(component,slideConfig);return!0===has$2(root,slideConfig.growingClass)}function isShrinking(component,slideConfig,slideState){var root=getAnimationRoot(component,slideConfig);return!0===has$2(root,slideConfig.shrinkingClass)}function toggleToReadOnly(uiComponents,readonly){var outerContainer=uiComponents.outerContainer;!function(uiComponents,readonly){var target=uiComponents.outerContainer.element();readonly&&(uiComponents.mothership.broadcastOn([dismissPopups()],{target:target}),uiComponents.uiMothership.broadcastOn([dismissPopups()],{target:target})),uiComponents.mothership.broadcastOn(["silver.readonly"],{readonly:readonly}),uiComponents.uiMothership.broadcastOn(["silver.readonly"],{readonly:readonly})}(uiComponents,readonly),all("*",outerContainer.element()).forEach(function(elm){outerContainer.getSystem().getByDom(elm).each(function(comp){comp.hasConfigured(Disabling)&&Disabling.set(comp,readonly)})})}function setupReadonlyModeSwitch(editor,uiComponents){editor.on("init",function(){editor.mode.isReadOnly()&&toggleToReadOnly(uiComponents,!0)}),editor.on("SwitchMode",function(){return toggleToReadOnly(uiComponents,editor.mode.isReadOnly())}),function(editor){return editor.getParam("readonly",!1,"boolean")}(editor)&&editor.setMode("readonly")}function createReadonlyReceivingForOverflow(getOverflow){var _a;return Receiving.config({channels:(_a={},_a["silver.readonly"]={schema:ReadOnlyDataSchema,onReceive:function(comp,data){getOverflow(comp).each(function(toolbar){!function(element,state){all("*",element.element()).forEach(function(elm){element.getSystem().getByDom(elm).each(function(comp){comp.hasConfigured(Disabling)&&Disabling.set(comp,state)})})}(toolbar,data.readonly)})}},_a)})}function renderToolbarGroupCommon(toolbarGroup){var attributes=toolbarGroup.title.fold(function(){return{}},function(title){return{attributes:{title:title}}});return{dom:__assign({tag:"div",classes:["tox-toolbar__group"]},attributes),components:[ToolbarGroup.parts().items({})],items:toolbarGroup.items,markers:{itemSelector:"*:not(.tox-split-button) > .tox-tbtn:not([disabled]), .tox-split-button:not([disabled]), .tox-toolbar-nav-js:not([disabled])"},tgroupBehaviours:derive$1([Tabstopping.config({}),Focusing.config({})])}}function renderToolbarGroup(toolbarGroup){return ToolbarGroup.sketch(renderToolbarGroupCommon(toolbarGroup))}function getToolbarbehaviours(toolbarSpec,modeName,getOverflow){var onAttached=runOnAttached(function(component){var groups=map(toolbarSpec.initGroups,renderToolbarGroup);Toolbar.setGroups(component,groups)});return derive$1([Keying.config({mode:modeName,onEscape:toolbarSpec.onEscape,selector:".tox-toolbar__group"}),config("toolbar-events",[onAttached]),createReadonlyReceivingForOverflow(getOverflow)])}function renderMoreToolbarCommon(toolbarSpec,getOverflow){var modeName=toolbarSpec.cyclicKeying?"cyclic":"acyclic";return{uid:toolbarSpec.uid,dom:{tag:"div",classes:["tox-toolbar-overlord"]},parts:{"overflow-group":renderToolbarGroupCommon({title:Option.none(),items:[]}),"overflow-button":renderIconButtonSpec({name:"more",icon:Option.some("more-drawer"),disabled:!1,tooltip:Option.some("More..."),primary:!1,borderless:!1},Option.none(),toolbarSpec.backstage.shared.providers)},splitToolbarBehaviours:getToolbarbehaviours(toolbarSpec,modeName,getOverflow)}}function renderFloatingMoreToolbar(toolbarSpec){var baseSpec=renderMoreToolbarCommon(toolbarSpec,SplitFloatingToolbar.getOverflow),primary=SplitFloatingToolbar.parts().primary({dom:{tag:"div",classes:["tox-toolbar__primary"]}});return SplitFloatingToolbar.sketch(__assign(__assign({},baseSpec),{lazySink:toolbarSpec.getSink,getOverflowBounds:function(){var headerElem=toolbarSpec.moreDrawerData.lazyHeader().element(),headerBounds=absolute$1(headerElem),docElem=documentElement(headerElem),docBounds=absolute$1(docElem),height=Math.max(docElem.dom().scrollHeight,docBounds.height());return bounds$1(headerBounds.x()+4,docBounds.y(),headerBounds.width()-8,height)},parts:__assign(__assign({},baseSpec.parts),{overflow:{dom:{tag:"div",classes:["tox-toolbar__overflow"],attributes:toolbarSpec.attributes}}}),components:[primary],markers:{overflowToggledClass:"tox-tbtn--enabled"}}))}function renderSlidingMoreToolbar(toolbarSpec){var primary=SplitSlidingToolbar.parts().primary({dom:{tag:"div",classes:["tox-toolbar__primary"]}}),overflow=SplitSlidingToolbar.parts().overflow({dom:{tag:"div",classes:["tox-toolbar__overflow"]}}),baseSpec=renderMoreToolbarCommon(toolbarSpec,Option.none);return SplitSlidingToolbar.sketch(__assign(__assign({},baseSpec),{components:[primary,overflow],markers:{openClass:"tox-toolbar__overflow--open",closedClass:"tox-toolbar__overflow--closed",growingClass:"tox-toolbar__overflow--growing",shrinkingClass:"tox-toolbar__overflow--shrinking",overflowToggledClass:"tox-tbtn--enabled"},onOpened:function(comp){comp.getSystem().broadcastOn([toolbarHeightChange()],{type:"opened"})},onClosed:function(comp){comp.getSystem().broadcastOn([toolbarHeightChange()],{type:"closed"})}}))}function renderToolbar(toolbarSpec){var modeName=toolbarSpec.cyclicKeying?"cyclic":"acyclic";return Toolbar.sketch({uid:toolbarSpec.uid,dom:{tag:"div",classes:["tox-toolbar"].concat(toolbarSpec.type===ToolbarMode.scrolling?["tox-toolbar--scrolling"]:[])},components:[Toolbar.parts().groups({})],toolbarBehaviours:getToolbarbehaviours(toolbarSpec,modeName,constant(Option.none()))})}function createToolbarButton(spec){return asRaw("toolbarbutton",toolbarButtonSchema,spec)}function createMenuButton(spec){return asRaw("menubutton",MenuButtonSchema,spec)}function createToggleButton(spec){return asRaw("ToggleButton",toggleButtonSchema,spec)}function getButtonApi(component){return{isDisabled:function(){return Disabling.isDisabled(component)},setDisabled:function(state){return Disabling.set(component,state)}}}function getToggleApi(component){return{setActive:function(state){Toggling.set(component,state)},isActive:function(){return Toggling.isOn(component)},isDisabled:function(){return Disabling.isDisabled(component)},setDisabled:function(state){return Disabling.set(component,state)}}}function getTooltipAttributes(tooltip,providersBackstage){return tooltip.map(function(tooltip){return{"aria-label":providersBackstage.translate(tooltip),title:providersBackstage.translate(tooltip)}}).getOr({})}function renderCommonStructure(icon,text,tooltip,receiver,behaviours,providersBackstage){function getIconName(iconName){return global$7.isRtl()&&contains(rtlIcon$1,iconName)?iconName+"-rtl":iconName}var _a,needsRtlClass=global$7.isRtl()&&icon.exists(function(name){return contains(rtlTransform$1,name)});return{dom:{tag:"button",classes:["tox-tbtn"].concat(text.isSome()?["tox-tbtn--select"]:[]).concat(needsRtlClass?["tox-tbtn__icon-rtl"]:[]),attributes:getTooltipAttributes(tooltip,providersBackstage)},components:componentRenderPipeline([icon.map(function(iconName){return renderIconFromPack(getIconName(iconName),providersBackstage.icons)}),text.map(function(text){return renderLabel$1(text,"tox-tbtn",providersBackstage)})]),eventOrder:(_a={},_a[mousedown()]=["focusing","alloy.base.behaviour","common-button-display-events"],_a),buttonBehaviours:derive$1([config("common-button-display-events",[run(mousedown(),function(button,se){se.event().prevent(),emit(button,focusButtonEvent)})])].concat(receiver.map(function(r){return Reflecting.config({channel:r,initialData:{icon:icon,text:text},renderComponents:function(data,_state){return componentRenderPipeline([data.icon.map(function(iconName){return renderIconFromPack(getIconName(iconName),providersBackstage.icons)}),data.text.map(function(text){return renderLabel$1(text,"tox-tbtn",providersBackstage)})])}})}).toArray()).concat(behaviours.getOr([])))}}function renderCommonToolbarButton(spec,specialisation,providersBackstage){var editorOffCell=Cell(noop),structure=renderCommonStructure(spec.icon,spec.text,spec.tooltip,Option.none(),Option.none(),providersBackstage);return Button.sketch({dom:structure.dom,components:structure.components,eventOrder:toolbarButtonEventOrder,buttonBehaviours:derive$1([config("toolbar-button-events",[function(info){return runOnExecute(function(comp,simulatedEvent){runWithApi(info,comp)(function(itemApi){emitWith(comp,internalToolbarButtonExecute,{buttonApi:itemApi}),info.onAction(itemApi)})})}({onAction:spec.onAction,getApi:specialisation.getApi}),onControlAttached(specialisation,editorOffCell),onControlDetached(specialisation,editorOffCell)]),DisablingConfigs_toolbarButton(spec.disabled)].concat(specialisation.toolbarButtonBehaviours))})}function renderSplitButton(spec,sharedBackstage){function getApi(comp){return{isDisabled:function(){return Disabling.isDisabled(comp)},setDisabled:function(state){return Disabling.set(comp,state)},setIconFill:function(id,value){descendant$1(comp.element(),'svg path[id="'+id+'"], rect[id="'+id+'"]').each(function(underlinePath){set$1(underlinePath,"fill",value)})},setIconStroke:function(id,value){descendant$1(comp.element(),'svg path[id="'+id+'"], rect[id="'+id+'"]').each(function(underlinePath){set$1(underlinePath,"stroke",value)})},setActive:function(state){set$1(comp.element(),"aria-pressed",state),descendant$1(comp.element(),"span").each(function(button){comp.getSystem().getByDom(button).each(function(buttonComp){return Toggling.set(buttonComp,state)})})},isActive:function(){return descendant$1(comp.element(),"span").exists(function(button){return comp.getSystem().getByDom(button).exists(Toggling.isOn)})}}}var _a,displayChannel=generate$1("channel-update-split-dropdown-display"),editorOffCell=Cell(noop),specialisation={getApi:getApi,onSetup:spec.onSetup};return SplitDropdown.sketch({dom:{tag:"div",classes:["tox-split-button"],attributes:__assign({"aria-pressed":!1},getTooltipAttributes(spec.tooltip,sharedBackstage.providers))},onExecute:function(button){spec.onAction(getApi(button))},onItemExecute:function(a,b,c){},splitDropdownBehaviours:derive$1([DisablingConfigs_splitButton(!1),config("split-dropdown-events",[run(focusButtonEvent,Focusing.focus),onControlAttached(specialisation,editorOffCell),onControlDetached(specialisation,editorOffCell)]),Unselecting.config({})]),eventOrder:(_a={},_a[attachedToDom()]=["alloy.base.behaviour","split-dropdown-events"],_a),toggleClass:"tox-tbtn--enabled",lazySink:sharedBackstage.getSink,fetch:function(getApi,spec,providersBackstage){return function(comp){return Future_nu(function(callback){return spec.fetch(callback)}).map(function(items){return Option.from(createTieredDataFrom(deepMerge(createPartialChoiceMenu(generate$1("menu-value"),items,function(value){spec.onItemAction(getApi(comp),value)},spec.columns,spec.presets,ItemResponse$1.CLOSE_ON_EXECUTE,spec.select.getOr(function(){return!1}),providersBackstage),{movement:deriveMenuMovement(spec.columns,spec.presets),menuBehaviours:SimpleBehaviours_unnamedEvents("auto"!==spec.columns?[]:[runOnAttached(function(comp,se){detectSize(comp,4,classForPreset(spec.presets)).each(function(_a){var numRows=_a.numRows,numColumns=_a.numColumns;Keying.setGridSize(comp,numRows,numColumns)})})])})))})}}(getApi,spec,sharedBackstage.providers),parts:{menu:part(0,spec.columns,spec.presets)},components:[SplitDropdown.parts().button(renderCommonStructure(spec.icon,spec.text,Option.none(),Option.some(displayChannel),Option.some([Toggling.config({toggleClass:"tox-tbtn--enabled",toggleOnExecute:!1})]),sharedBackstage.providers)),SplitDropdown.parts().arrow({dom:{tag:"button",classes:["tox-tbtn","tox-split-button__chevron"],innerHtml:get$d("chevron-down",sharedBackstage.providers.icons)}}),SplitDropdown.parts()["aria-descriptor"]({text:sharedBackstage.providers.translate("To open the popup, press Shift+Enter")})]})}function runOnExecute$1(memInput,original){return run(internalToolbarButtonExecute,function(comp,se){var formApi=function(input){return{hide:function(){return emit(input,sandboxClose())},getValue:function(){return Representing.getValue(input)}}}(memInput.get(comp));original.onAction(formApi,se.event().buttonApi())})}function generateOne$1(memInput,button,providersBackstage){var extras={backstage:{shared:{providers:providersBackstage}}};return"contextformtogglebutton"===button.type?function(memInput,button,extras){var _a=button.original,rest=(_a.primary,__rest(_a,["primary"])),bridged=getOrDie(createToggleButton(__assign(__assign({},rest),{type:"togglebutton",onAction:function(){}})));return renderToolbarToggleButtonWith(bridged,extras.backstage.shared.providers,[runOnExecute$1(memInput,button)])}(memInput,button,extras):function(memInput,button,extras){var _a=button.original,rest=(_a.primary,__rest(_a,["primary"])),bridged=getOrDie(createToolbarButton(__assign(__assign({},rest),{type:"button",onAction:function(){}})));return renderToolbarButtonWith(bridged,extras.backstage.shared.providers,[runOnExecute$1(memInput,button)])}(memInput,button,extras)}function getContextToolbarBounds(editor){var viewportBounds=getBounds(domGlobals.window),contentAreaBox=box(Element.fromDom(editor.getContentAreaContainer())),toolbarOrMenubarEnabled=isMenubarEnabled(editor)||isToolbarEnabled(editor)||isMultipleToolbars(editor),_a=function(contentAreaBox,viewportBounds){var x=Math.max(viewportBounds.x(),contentAreaBox.x()),contentBoxWidth=contentAreaBox.right()-x,maxViewportWidth=viewportBounds.width()-(x-viewportBounds.x());return{x:x,width:Math.min(contentBoxWidth,maxViewportWidth)}}(contentAreaBox,viewportBounds),x=_a.x,width=_a.width;if(editor.inline&&!toolbarOrMenubarEnabled)return bounds$1(x,viewportBounds.y(),width,viewportBounds.height());var _b=function(editor,contentAreaBox,viewportBounds){var container=Element.fromDom(editor.getContainer()),header=descendant$1(container,".tox-editor-header").getOr(container),headerBox=box(header),isToolbarBelowContentArea=headerBox.y()>=contentAreaBox.bottom(),isToolbarAbove=isToolbarLocationTop(editor)&&!isToolbarBelowContentArea;if(editor.inline&&isToolbarAbove)return{y:Math.max(headerBox.bottom(),viewportBounds.y()),bottom:viewportBounds.bottom()};if(editor.inline&&!isToolbarAbove)return{y:viewportBounds.y(),bottom:Math.min(headerBox.y(),viewportBounds.bottom())};var containerBounds=box(container);return isToolbarAbove?{y:Math.max(headerBox.bottom(),viewportBounds.y()),bottom:Math.min(containerBounds.bottom(),viewportBounds.bottom())}:{y:Math.max(containerBounds.y(),viewportBounds.y()),bottom:Math.min(headerBox.y(),viewportBounds.bottom())}}(editor,contentAreaBox,viewportBounds),y=_b.y,bottom=_b.bottom;return bounds$1(x,y,width,bottom-y)}function matchTargetWith(elem,toolbars){return findMap(toolbars,function(toolbarApi){return toolbarApi.predicate(elem.dom())?Option.some({toolbarApi:toolbarApi,elem:elem}):Option.none()})}function generateSelectItems(_editor,backstage,spec){function generateItem(rawItem,response,disabled,value){var translatedText=backstage.shared.providers.translate(rawItem.title);if("separator"===rawItem.type)return Option.some({type:"separator",text:translatedText});if("submenu"!==rawItem.type)return Option.some(__assign({type:"togglemenuitem",text:translatedText,active:rawItem.isSelected(value),disabled:disabled,onAction:spec.onAction(rawItem)},rawItem.getStylePreview().fold(function(){return{}},function(preview){return{meta:{style:preview}}})));var items=bind(rawItem.getStyleItems(),function(si){return validate(si,response,value)});return 0===response&&items.length<=0?Option.none():Option.some({type:"nestedmenuitem",text:translatedText,disabled:items.length<=0,getSubmenuItems:function(){return bind(rawItem.getStyleItems(),function(si){return validate(si,response,value)})}})}function validateItems(preItems){var value=spec.getCurrentValue(),response=spec.shouldHide?0:1;return bind(preItems,function(item){return validate(item,response,value)})}var validate=function(item,response,value){var invalid="formatter"===item.type&&spec.isInvalid(item);return 0===response?invalid?[]:generateItem(item,response,!1,value).toArray():generateItem(item,response,invalid,value).toArray()};return{validateItems:validateItems,getFetch:function(backstage,getStyleItems){return function(callback){var preItems=getStyleItems(),items=validateItems(preItems);callback(build$2(items,ItemResponse$1.CLOSE_ON_EXECUTE,backstage,!1))}}}}function createMenuItems(editor,backstage,spec){var dataset=spec.dataset,getStyleItems="basic"===dataset.type?function(){return map(dataset.data,function(d){return processBasic(d,spec.isSelectedFor,spec.getPreviewFor)})}:dataset.getData;return{items:generateSelectItems(0,backstage,spec),getStyleItems:getStyleItems}}function createSelectButton(editor,backstage,spec){var _a=createMenuItems(0,backstage,spec),items=_a.items,getStyleItems=_a.getStyleItems;return renderCommonDropdown({text:spec.icon.isSome()?Option.none():Option.some(""),icon:spec.icon,tooltip:Option.from(spec.tooltip),role:Option.none(),fetch:items.getFetch(backstage,getStyleItems),onSetup:function(api){return spec.setInitialValue.each(function(f){return f(api.getComponent())}),spec.nodeChangeHandler.map(function(f){var handler=f(api.getComponent());return editor.on("NodeChange",handler),function(){editor.off("NodeChange",handler)}}).getOr(noop)},getApi:function(comp){return{getComponent:function(){return comp}}},columns:1,presets:"normal",classes:spec.icon.isSome()?[]:["bespoke"],dropdownBehaviours:[]},"tox-tbtn",backstage.shared)}var key,props,Delimiter,HtmlSelect=single$2({name:"HtmlSelect",configFields:[strict$1("options"),field$1("selectBehaviours",[Focusing,Representing]),defaulted$1("selectClasses",[]),defaulted$1("selectAttributes",{}),option("data")],factory:function(detail,spec){var options=map(detail.options,function(option){return{dom:{tag:"option",value:option.value,innerHtml:option.text}}}),initialValues=detail.data.map(function(v){return wrap$1("initialValue",v)}).getOr({});return{uid:detail.uid,dom:{tag:"select",classes:detail.selectClasses,attributes:detail.selectAttributes},components:options,behaviours:augment(detail.selectBehaviours,[Focusing.config({}),Representing.config({store:__assign({mode:"manual",getValue:function(select){return get$5(select.element())},setValue:function(select,newValue){find(detail.options,function(opt){return opt.value===newValue}).isSome()&&set$3(select.element(),newValue)}},initialValues)})])}}}),ActiveStreaming=Object.freeze({__proto__:null,events:function(streamConfig,streamState){var processor=streamConfig.stream.streams.setup(streamConfig,streamState);return derive([run(streamConfig.event,processor),runOnDetached(function(){return streamState.cancel()})].concat(streamConfig.cancelEvent.map(function(e){return[run(e,function(){return streamState.cancel()})]}).getOr([])))}}),StreamingState=Object.freeze({__proto__:null,throttle:throttle,init:function(spec){return spec.stream.streams.state(spec)}}),StreamingSchema=[strictOf("stream",choose$1("mode",{throttle:[strict$1("delay"),defaulted$1("stopEvent",!0),output("streams",{setup:function(streamInfo,streamState){var sInfo=streamInfo.stream,throttler=last$2(streamInfo.onStream,sInfo.delay);return streamState.setTimer(throttler),function(component,simulatedEvent){throttler.throttle(component,simulatedEvent),sInfo.stopEvent&&simulatedEvent.stop()}},state:throttle})]})),defaulted$1("event","input"),option("cancelEvent"),onStrictHandler("onStream")],Streaming=create$1({fields:StreamingSchema,name:"streaming",active:ActiveStreaming,state:StreamingState}),setCursorAtEnd=function(input){setSelectionOn(input,function(node,value){return node.setSelectionRange(value.length,value.length)})},itemExecute=constant("alloy.typeahead.itemexecute"),schema$j=constant([option("lazySink"),strict$1("fetch"),defaulted$1("minChars",5),defaulted$1("responseTime",1e3),onHandler("onOpen"),defaulted$1("getHotspot",Option.some),defaulted$1("getAnchorOverrides",constant({})),defaulted$1("layouts",Option.none()),defaulted$1("eventOrder",{}),defaultedObjOf("model",{},[defaulted$1("getDisplayText",function(itemData){return void 0!==itemData.meta&&void 0!==itemData.meta.text?itemData.meta.text:itemData.value}),defaulted$1("selectsOver",!0),defaulted$1("populateFromBrowse",!0)]),onHandler("onSetValue"),onKeyboardHandler("onExecute"),onHandler("onItemExecute"),defaulted$1("inputClasses",[]),defaulted$1("inputAttributes",{}),defaulted$1("inputStyles",{}),defaulted$1("matchWidth",!0),defaulted$1("useMinWidth",!1),defaulted$1("dismissOnBlur",!0),markers(["openClass"]),option("initialData"),field$1("typeaheadBehaviours",[Focusing,Representing,Streaming,Keying,Toggling,Coupling]),state$1("previewing",function(){return Cell(!0)})].concat(schema$f()).concat(sandboxFields())),parts$6=constant([external$1({schema:[tieredMenuMarkers()],name:"menu",overrides:function(detail){return{fakeFocus:!0,onHighlight:function(menu,item){detail.previewing.get()?menu.getSystem().getByUid(detail.uid).each(function(input){attemptSelectOver(detail.model,input,item).fold(function(){return Highlighting.dehighlight(menu,item)},function(fn){return fn()})}):menu.getSystem().getByUid(detail.uid).each(function(input){detail.model.populateFromBrowse&&setValueFromItem(detail.model,input,item)}),detail.previewing.set(!1)},onExecute:function(menu,item){return menu.getSystem().getByUid(detail.uid).toOption().map(function(typeahead){return emitWith(typeahead,itemExecute(),{item:item}),!0})},onHover:function(menu,item){detail.previewing.set(!1),menu.getSystem().getByUid(detail.uid).each(function(input){detail.model.populateFromBrowse&&setValueFromItem(detail.model,input,item)})}}}})]),Typeahead=composite$1({name:"Typeahead",configFields:schema$j(),partFields:parts$6(),factory:function(detail,components,spec,externals){function navigateList(comp,simulatedEvent,highlighter){detail.previewing.set(!1);var sandbox=Coupling.getCoupled(comp,"sandbox");if(Sandboxing.isOpen(sandbox))Composing.getCurrent(sandbox).each(function(menu){Highlighting.getHighlighted(menu).fold(function(){highlighter(menu)},function(){dispatchEvent(sandbox,menu.element(),"keydown",simulatedEvent)})});else{open$1(detail,mapFetch(comp),comp,sandbox,externals,function(sandbox){Composing.getCurrent(sandbox).each(highlighter)},HighlightOnOpen.HighlightFirst).get(noop)}}var focusBehaviours$1=focusBehaviours(detail),mapFetch=function(comp){return function(tdata){return tdata.map(function(data){var menus=values(data.menus),items=bind(menus,function(menu){return filter(menu.items,function(item){return"item"===item.type})});return Representing.getState(comp).update(map(items,function(item){return item.data})),data})}},behaviours=[Focusing.config({}),Representing.config({onSetValue:detail.onSetValue,store:__assign({mode:"dataset",getDataKey:function(comp){return get$5(comp.element())},getFallbackEntry:function(itemString){return{value:itemString,meta:{}}},setValue:function(comp,data){set$3(comp.element(),detail.model.getDisplayText(data))}},detail.initialData.map(function(d){return wrap$1("initialValue",d)}).getOr({}))}),Streaming.config({stream:{mode:"throttle",delay:detail.responseTime,stopEvent:!1},onStream:function(component,simulatedEvent){var sandbox=Coupling.getCoupled(component,"sandbox");if(Focusing.isFocused(component)&&get$5(component.element()).length>=detail.minChars){var previousValue_1=Composing.getCurrent(sandbox).bind(function(menu){return Highlighting.getHighlighted(menu).map(Representing.getValue)});detail.previewing.set(!0);open$1(detail,mapFetch(component),component,sandbox,externals,function(_sandbox){Composing.getCurrent(sandbox).each(function(menu){previousValue_1.fold(function(){detail.model.selectsOver&&Highlighting.highlightFirst(menu)},function(pv){Highlighting.highlightBy(menu,function(item){return Representing.getValue(item).value===pv.value}),Highlighting.getHighlighted(menu).orThunk(function(){return Highlighting.highlightFirst(menu),Option.none()})})})},HighlightOnOpen.HighlightFirst).get(noop)}},cancelEvent:typeaheadCancel()}),Keying.config({mode:"special",onDown:function(comp,simulatedEvent){return navigateList(comp,simulatedEvent,Highlighting.highlightFirst),Option.some(!0)},onEscape:function(comp){var sandbox=Coupling.getCoupled(comp,"sandbox");return Sandboxing.isOpen(sandbox)?(Sandboxing.close(sandbox),Option.some(!0)):Option.none()},onUp:function(comp,simulatedEvent){return navigateList(comp,simulatedEvent,Highlighting.highlightLast),Option.some(!0)},onEnter:function(comp){var sandbox=Coupling.getCoupled(comp,"sandbox"),sandboxIsOpen=Sandboxing.isOpen(sandbox);if(sandboxIsOpen&&!detail.previewing.get())return Composing.getCurrent(sandbox).bind(function(menu){return Highlighting.getHighlighted(menu)}).map(function(item){return emitWith(comp,itemExecute(),{item:item}),!0});var currentValue=Representing.getValue(comp);return emit(comp,typeaheadCancel()),detail.onExecute(sandbox,comp,currentValue),sandboxIsOpen&&Sandboxing.close(sandbox),Option.some(!0)}}),Toggling.config({toggleClass:detail.markers.openClass,aria:{mode:"expanded"}}),Coupling.config({others:{sandbox:function(hotspot){return makeSandbox(detail,hotspot,{onOpen:function(){return Toggling.on(hotspot)},onClose:function(){return Toggling.off(hotspot)}})}}}),config("typeaheadevents",[runOnExecute(function(comp){var onOpenSync=noop;togglePopup(detail,mapFetch(comp),comp,externals,onOpenSync,HighlightOnOpen.HighlightFirst).get(noop)}),run(itemExecute(),function(comp,se){var sandbox=Coupling.getCoupled(comp,"sandbox");setValueFromItem(detail.model,comp,se.event().item()),emit(comp,typeaheadCancel()),detail.onItemExecute(comp,sandbox,se.event().item(),Representing.getValue(comp)),Sandboxing.close(sandbox),setCursorAtEnd(comp)})].concat(detail.dismissOnBlur?[run(postBlur(),function(typeahead){var sandbox=Coupling.getCoupled(typeahead,"sandbox");search(sandbox.element()).isNone()&&Sandboxing.close(sandbox)})]:[]))];return{uid:detail.uid,dom:dom$2(deepMerge(detail,{inputAttributes:{role:"combobox","aria-autocomplete":"list","aria-haspopup":"true"}})),behaviours:__assign(__assign({},focusBehaviours$1),augment(detail.typeaheadBehaviours,behaviours)),eventOrder:detail.eventOrder}}}),wrap$2=function(delegate){return __assign(__assign({},delegate),{toCached:function(){return wrap$2(delegate.toCached())},bindFuture:function(f){return wrap$2(delegate.bind(function(resA){return resA.fold(function(err){return Future_pure(Result.error(err))},function(a){return f(a)})}))},bindResult:function(f){return wrap$2(delegate.map(function(resA){return resA.bind(f)}))},mapResult:function(f){return wrap$2(delegate.map(function(resA){return resA.map(f)}))},mapError:function(f){return wrap$2(delegate.map(function(resA){return resA.mapError(f)}))},foldResult:function(whenError,whenValue){return delegate.map(function(res){return res.fold(whenError,whenValue)})},withTimeout:function(timeout,errorThunk){return wrap$2(Future_nu(function(callback){var timedOut=!1,timer=domGlobals.setTimeout(function(){timedOut=!0,callback(Result.error(errorThunk()))},timeout);delegate.get(function(result){timedOut||(domGlobals.clearTimeout(timer),callback(result))})}))}})},FutureResult_nu=nu$c,separator$2={type:"separator"},errorId=generate$1("aria-invalid"),factories={bar:make$6(function(spec,backstage){return function(spec,backstage){return{dom:{tag:"div",classes:["tox-bar","tox-form__controls-h-stack"]},components:map(spec.items,backstage.interpreter)}}(spec,backstage.shared)}),collection:make$6(function(spec,backstage){return renderCollection(spec,backstage.shared.providers)}),alertbanner:make$6(function(spec,backstage){return function(spec,providersBackstage){return Container.sketch({dom:{tag:"div",attributes:{role:"alert"},classes:["tox-notification","tox-notification--in","tox-notification--"+spec.level]},components:[{dom:{tag:"div",classes:["tox-notification__icon"]},components:[Button.sketch({dom:{tag:"button",classes:["tox-button","tox-button--naked","tox-button--icon"],innerHtml:get$d(spec.icon,providersBackstage.icons),attributes:{title:providersBackstage.translate(spec.iconTooltip)}},action:function(comp){emitWith(comp,formActionEvent,{name:"alert-banner",value:spec.url})}})]},{dom:{tag:"div",classes:["tox-notification__body"],innerHtml:providersBackstage.translate(spec.text)}}]})}(spec,backstage.shared.providers)}),input:make$6(function(spec,backstage){return function(spec,providersBackstage){return renderTextField({name:spec.name,multiline:!1,label:spec.label,inputMode:spec.inputMode,placeholder:spec.placeholder,flex:!1,disabled:spec.disabled,classname:"tox-textfield",validation:Option.none(),maximized:spec.maximized},providersBackstage)}(spec,backstage.shared.providers)}),textarea:make$6(function(spec,backstage){return function(spec,providersBackstage){return renderTextField({name:spec.name,multiline:!0,label:spec.label,inputMode:Option.none(),placeholder:spec.placeholder,flex:!0,disabled:spec.disabled,classname:"tox-textarea",validation:Option.none(),maximized:spec.maximized},providersBackstage)}(spec,backstage.shared.providers)}),label:make$6(function(spec,backstage){return function(spec,backstageShared){var label={dom:{tag:"label",innerHtml:backstageShared.providers.translate(spec.label),classes:["tox-label"]}},comps=map(spec.items,backstageShared.interpreter);return{dom:{tag:"div",classes:["tox-form__group"]},components:[label].concat(comps),behaviours:derive$1([ComposingConfigs_self(),Replacing.config({}),RepresentingConfigs_domHtml(Option.none()),Keying.config({mode:"acyclic"})])}}(spec,backstage.shared)}),iframe:function(render){return function(parts,spec,backstage){var iframeSpec=deepMerge(spec,{source:"dynamic"});return make$6(render)(parts,iframeSpec,backstage)}}(function(spec,backstage){return renderIFrame(spec,backstage.shared.providers)}),button:make$6(function(spec,backstage){return renderDialogButton(spec,backstage.shared.providers)}),checkbox:make$6(function(spec,backstage){return renderCheckbox(spec,backstage.shared.providers)}),colorinput:make$6(function(spec,backstage){return renderColorInput(spec,backstage.shared,backstage.colorinput)}),colorpicker:make$6(function(spec){function getClass(key){return"tox-"+key}var colourPickerFactory=makeFactory(translate$1,getClass),memPicker=record(colourPickerFactory.sketch({dom:{tag:"div",classes:["tox-color-picker-container"],attributes:{role:"presentation"}},onValidHex:function(form){emitWith(form,formActionEvent,{name:"hex-valid",value:!0})},onInvalidHex:function(form){emitWith(form,formActionEvent,{name:"hex-valid",value:!1})}}));return{dom:{tag:"div"},components:[memPicker.asSpec()],behaviours:derive$1([Representing.config({store:{mode:"manual",getValue:function(comp){var picker=memPicker.get(comp);return Composing.getCurrent(picker).bind(function(rgbForm){return Representing.getValue(rgbForm).hex}).map(function(hex){return"#"+hex}).getOr("")},setValue:function(comp,newValue){var m=/^#([a-fA-F0-9]{3}(?:[a-fA-F0-9]{3})?)/.exec(newValue),picker=memPicker.get(comp);Composing.getCurrent(picker).fold(function(){domGlobals.console.log("Can not find form")},function(rgbForm){Representing.setValue(rgbForm,{hex:Option.from(m[1]).getOr("")}),Form.getField(rgbForm,"hex").each(function(hexField){emit(hexField,input())})})}}}),ComposingConfigs_self()])}}),dropzone:make$6(function(spec,backstage){return renderDropZone(spec,backstage.shared.providers)}),grid:make$6(function(spec,backstage){return function(spec,backstage){return{dom:{tag:"div",classes:["tox-form__grid","tox-form__grid--"+spec.columns+"col"]},components:map(spec.items,backstage.interpreter)}}(spec,backstage.shared)}),selectbox:make$6(function(spec,backstage){return function(spec,providersBackstage){var translatedOptions=map(spec.items,function(item){return{text:providersBackstage.translate(item.text),value:item.value}}),pLabel=spec.label.map(function(label){return renderLabel(label,providersBackstage)}),pField=FormField.parts().field({dom:{},selectAttributes:{size:spec.size},options:translatedOptions,factory:HtmlSelect,selectBehaviours:derive$1([Disabling.config({disabled:spec.disabled}),Tabstopping.config({}),config("selectbox-change",[run(change(),function(component,_){emitWith(component,formChangeEvent,{name:spec.name})})])])}),chevron=1<spec.size?Option.none():Option.some({dom:{tag:"div",classes:["tox-selectfield__icon-js"],innerHtml:get$d("chevron-down",providersBackstage.icons)}}),selectWrap={dom:{tag:"div",classes:["tox-selectfield"]},components:flatten([[pField],chevron.toArray()])};return FormField.sketch({dom:{tag:"div",classes:["tox-form__group"]},components:flatten([pLabel.toArray(),[selectWrap]]),fieldBehaviours:derive$1([Disabling.config({disabled:spec.disabled,onDisabled:function(comp){FormField.getField(comp).each(Disabling.disable)},onEnabled:function(comp){FormField.getField(comp).each(Disabling.enable)}})])})}(spec,backstage.shared.providers)}),sizeinput:make$6(function(spec,backstage){return renderSizeInput(spec,backstage.shared.providers)}),urlinput:make$6(function(spec,backstage){return renderUrlInput(spec,backstage,backstage.urlinput)}),customeditor:make$6(function(spec){var editorApi=Cell(Option.none()),memReplaced=record({dom:{tag:spec.tag}}),initialValue=Cell(Option.none());return{dom:{tag:"div",classes:["tox-custom-editor"]},behaviours:derive$1([config("editor-foo-events",[runOnAttached(function(component){memReplaced.getOpt(component).each(function(ta){(!function(spec){return Object.prototype.hasOwnProperty.call(spec,"init")}(spec)?global$a.load(spec.scriptId,spec.scriptUrl).then(function(init){return init(ta.element().dom(),spec.settings)}):spec.init(ta.element().dom())).then(function(ea){initialValue.get().each(function(cvalue){ea.setValue(cvalue)}),initialValue.set(Option.none()),editorApi.set(Option.some(ea))})})})]),Representing.config({store:{mode:"manual",getValue:function(){return editorApi.get().fold(function(){return initialValue.get().getOr("")},function(ed){return ed.getValue()})},setValue:function(component,value){editorApi.get().fold(function(){initialValue.set(Option.some(value))},function(ed){return ed.setValue(value)})}}}),ComposingConfigs_self()]),components:[memReplaced.asSpec()]}}),htmlpanel:make$6(function(spec){return"presentation"===spec.presets?Container.sketch({dom:{tag:"div",classes:["tox-form__group"],innerHtml:spec.html}}):Container.sketch({dom:{tag:"div",classes:["tox-form__group"],innerHtml:spec.html,attributes:{role:"document"}},containerBehaviours:derive$1([Tabstopping.config({}),Focusing.config({})])})}),imagetools:make$6(function(spec,backstage){return renderImageTools(spec,backstage.shared.providers)}),table:make$6(function(spec,backstage){return renderTable(spec,backstage.shared.providers)}),panel:make$6(function(spec,backstage){return function(spec,backstage){return{dom:{tag:"div",classes:spec.classes},components:map(spec.items,backstage.shared.interpreter)}}(spec,backstage)})},noFormParts={field:function(_name,spec){return spec}},interpretParts=function(parts,spec,backstage){return get(factories,spec.type).fold(function(){return domGlobals.console.error('Unknown factory type "'+spec.type+'", defaulting to container: ',spec),spec},function(factory){return factory(parts,spec,backstage)})},bubbleAlignments={valignCentre:[],alignCentre:[],alignLeft:[],alignRight:[],right:[],left:[],bottom:[],top:[]},Anchors_getAnchors=function(editor,lazyAnchorbar){function bodyElement(){return Element.fromDom(editor.getBody())}function contentAreaElement(){return Element.fromDom(editor.getContentAreaContainer())}var useEditableAreaAnchor=useFixedContainer(editor)||!isToolbarLocationTop(editor);return{inlineDialog:function(contentAreaElement,lazyAnchorbar,useEditableAreaAnchor){var bubble=nu$8(-12,12,bubbleAlignments),overrides={maxHeightFunction:expandable()};return useEditableAreaAnchor?function(){return{anchor:"node",root:getBody(owner(contentAreaElement())),node:Option.from(contentAreaElement()),bubble:bubble,layouts:{onRtl:function(){return[northwest$3]},onLtr:function(){return[northeast$3]}},overrides:overrides}}:function(){return{anchor:"hotspot",hotspot:lazyAnchorbar(),bubble:bubble,layouts:{onRtl:function(){return[southeast$1]},onLtr:function(){return[southwest$1]}},overrides:overrides}}}(contentAreaElement,lazyAnchorbar,useEditableAreaAnchor),banner:function(contentAreaElement,lazyAnchorbar,useEditableAreaAnchor){return useEditableAreaAnchor?function(){return{anchor:"node",root:getBody(owner(contentAreaElement())),node:Option.from(contentAreaElement()),layouts:{onRtl:function(){return[north$3]},onLtr:function(){return[north$3]}}}}:function(){return{anchor:"hotspot",hotspot:lazyAnchorbar(),layouts:{onRtl:function(){return[south$1]},onLtr:function(){return[south$1]}}}}}(contentAreaElement,lazyAnchorbar,useEditableAreaAnchor),cursor:function(editor,bodyElement){return function(){return{anchor:"selection",root:bodyElement(),getSelection:function(){var rng=editor.selection.getRng();return Option.some(Selection.range(Element.fromDom(rng.startContainer),rng.startOffset,Element.fromDom(rng.endContainer),rng.endOffset))}}}}(editor,bodyElement),node:function(bodyElement){return function(element){return{anchor:"node",root:bodyElement(),node:element}}}(bodyElement)}},defaultStyleFormats=[{title:"Headings",items:[{title:"Heading 1",format:"h1"},{title:"Heading 2",format:"h2"},{title:"Heading 3",format:"h3"},{title:"Heading 4",format:"h4"},{title:"Heading 5",format:"h5"},{title:"Heading 6",format:"h6"}]},{title:"Inline",items:[{title:"Bold",icon:"bold",format:"bold"},{title:"Italic",icon:"italic",format:"italic"},{title:"Underline",icon:"underline",format:"underline"},{title:"Strikethrough",icon:"strike-through",format:"strikethrough"},{title:"Superscript",icon:"superscript",format:"superscript"},{title:"Subscript",icon:"subscript",format:"subscript"},{title:"Code",icon:"code",format:"code"}]},{title:"Blocks",items:[{title:"Paragraph",format:"p"},{title:"Blockquote",format:"blockquote"},{title:"Div",format:"div"},{title:"Pre",format:"pre"}]},{title:"Align",items:[{title:"Left",icon:"align-left",format:"alignleft"},{title:"Center",icon:"align-center",format:"aligncenter"},{title:"Right",icon:"align-right",format:"alignright"},{title:"Justify",icon:"align-justify",format:"alignjustify"}]}],mapFormats=function(userFormats){return foldl(userFormats,function(acc,fmt){if(function(format){return has(format,"items")}(fmt)){var result=mapFormats(fmt.items);return{customFormats:acc.customFormats.concat(result.customFormats),formats:acc.formats.concat([{title:fmt.title,items:result.formats}])}}if(function(format){return has(format,"inline")}(fmt)||function(format){return has(format,"block")}(fmt)||function(format){return has(format,"selector")}(fmt)){var formatName="custom-"+fmt.title.toLowerCase();return{customFormats:acc.customFormats.concat([{name:formatName,format:fmt}]),formats:acc.formats.concat([{title:fmt.title,format:formatName,icon:fmt.icon}])}}return __assign(__assign({},acc),{formats:acc.formats.concat(fmt)})},{customFormats:[],formats:[]})},trim$1=global$e.trim,isContentEditableTrue=hasContentEditableState("true"),isContentEditableFalse=hasContentEditableState("false"),isEditable=function(elm){return function(node){for(;node=node.parentNode;){var value=node.contentEditable;if(value&&"inherit"!==value)return isContentEditableTrue(node)}return!1}(elm)&&!isContentEditableFalse(elm)},LinkTargets_find=function(elm){var elms=getTargetElements(elm);return filter(function(elms){return map(filter(elms,isValidHeader),headerTarget)}(elms).concat(function(elms){return map(filter(elms,isValidAnchor),anchorTarget)}(elms)),hasTitle)},STORAGE_KEY="tinymce-url-history",hasOwnProperty$2=Object.prototype.hasOwnProperty,expandable$1=constant(function(element,available){!function(element,value){var absMax=api$1.max(element,value,["margin-left","border-left-width","padding-left","padding-right","border-right-width","margin-right"]);set$2(element,"max-width",absMax+"px")}(element,Math.floor(available))}),schema$k=constant([strict$1("items"),markers(["itemSelector"]),field$1("tgroupBehaviours",[Keying])]),parts$7=constant([group({name:"items",unit:"item"})]),ToolbarGroup=composite$1({name:"ToolbarGroup",configFields:schema$k(),partFields:parts$7(),factory:function(detail,components,spec,_externals){return{uid:detail.uid,dom:detail.dom,components:components,behaviours:augment(detail.tgroupBehaviours,[Keying.config({mode:"flow",selector:detail.markers.itemSelector})]),domModification:{attributes:{role:"toolbar"}}}}}),schema$l=constant([strict$1("dom"),defaulted$1("shell",!0),field$1("toolbarBehaviours",[Replacing])]),parts$8=constant([optional({name:"groups",overrides:function(){return{behaviours:derive$1([Replacing.config({})])}}})]),Toolbar=composite$1({name:"Toolbar",configFields:schema$l(),partFields:parts$8(),factory:function(detail,components,spec,_externals){var getGroupContainer=function(component){return detail.shell?Option.some(component):getPart(component,detail,"groups")},extra=detail.shell?{behaviours:[Replacing.config({})],components:[]}:{behaviours:[],components:components};return{uid:detail.uid,dom:detail.dom,components:extra.components,behaviours:augment(detail.toolbarBehaviours,extra.behaviours),apis:{setGroups:function(toolbar,groups){getGroupContainer(toolbar).fold(function(){throw domGlobals.console.error("Toolbar was defined to not be a shell, but no groups container was specified in components"),new Error("Toolbar was defined to not be a shell, but no groups container was specified in components")},function(container){Replacing.set(container,groups)})}},domModification:{attributes:{role:"group"}}}},apis:{setGroups:function(apis,toolbar,groups){apis.setGroups(toolbar,groups)}}}),output$1=Immutable("within","extra","withinWidth"),schema$m=constant([field$1("splitToolbarBehaviours",[Coupling]),state$1("builtGroups",function(){return Cell([])})]),schema$n=constant([markers(["overflowToggledClass"]),optionFunction("getOverflowBounds"),strict$1("lazySink"),state$1("overflowGroups",function(){return Cell([])})].concat(schema$m())),parts$9=constant([required({factory:Toolbar,schema:schema$l(),name:"primary"}),external$1({schema:schema$l(),name:"overflow"}),external$1({name:"overflow-button"}),external$1({name:"overflow-group"})]),schema$o=constant([markers(["toggledClass"]),strict$1("lazySink"),strictFunction("fetch"),optionFunction("getBounds"),optionObjOf("fireDismissalEventInstead",[defaulted$1("event",dismissRequested())]),schema$1()]),parts$a=constant([external$1({name:"button",overrides:function(detail){return{dom:{attributes:{"aria-haspopup":"true"}},buttonBehaviours:derive$1([Toggling.config({toggleClass:detail.markers.toggledClass,aria:{mode:"expanded"},toggleOnExecute:!1})])}}}),external$1({factory:Toolbar,schema:schema$l(),name:"toolbar",overrides:function(detail){return{toolbarBehaviours:derive$1([Keying.config({mode:"cyclic",onEscape:function(comp){return getPart(comp,detail,"button").each(Focusing.focus),Option.none()}})])}}})]),FloatingToolbarButton=composite$1({name:"FloatingToolbarButton",factory:function(detail,components,spec,externals){return __assign(__assign({},Button.sketch(__assign(__assign({},externals.button()),{action:function(button){toggle$2(button,externals)},buttonBehaviours:SketchBehaviours_augment({dump:externals.button().buttonBehaviours},[Coupling.config({others:{toolbarSandbox:function(button){return function(button,spec,detail){var ariaOwner=manager();return{dom:{tag:"div",attributes:{id:ariaOwner.id()}},behaviours:derive$1([Keying.config({mode:"special",onEscape:function(comp){return Sandboxing.close(comp),Option.some(!0)}}),Sandboxing.config({onOpen:function(sandbox,toolbar){detail.fetch().get(function(groups){setGroups$1(button,toolbar,detail,spec.layouts,groups),ariaOwner.link(button.element()),Keying.focusIn(toolbar)})},onClose:function(){Toggling.off(button),Focusing.focus(button),ariaOwner.unlink(button.element())},isPartOf:function(container,data,queryElem){return isPartOf(data,queryElem)||isPartOf(button,queryElem)},getAttachPoint:function(){return detail.lazySink(button).getOrDie()}}),Receiving.config({channels:__assign(__assign({},receivingChannel(__assign({isExtraPart:never},detail.fireDismissalEventInstead.map(function(fe){return{fireEventInstead:{event:fe.event}}}).getOr({})))),receivingChannel$1({doReposition:function(){Sandboxing.getState(Coupling.getCoupled(button,"toolbarSandbox")).each(function(toolbar){position$2(button,toolbar,detail,spec.layouts)})}}))})])}}(button,spec,detail)}}})])}))),{apis:{setGroups:function(button,groups){Sandboxing.getState(Coupling.getCoupled(button,"toolbarSandbox")).each(function(toolbar){setGroups$1(button,toolbar,detail,spec.layouts,groups)})},reposition:function(button){Sandboxing.getState(Coupling.getCoupled(button,"toolbarSandbox")).each(function(toolbar){position$2(button,toolbar,detail,spec.layouts)})},toggle:function(button){toggle$2(button,externals)},getToolbar:function(button){return Sandboxing.getState(Coupling.getCoupled(button,"toolbarSandbox"))}}})},configFields:schema$o(),partFields:parts$a(),apis:{setGroups:function(apis,button,groups){apis.setGroups(button,groups)},reposition:function(apis,button){apis.reposition(button)},toggle:function(apis,button){apis.toggle(button)},getToolbar:function(apis,button){return apis.getToolbar(button)}}}),SplitFloatingToolbar=composite$1({name:"SplitFloatingToolbar",configFields:schema$n(),partFields:parts$9(),factory:function(detail,components,spec,externals){var memFloatingToolbarButton=record(FloatingToolbarButton.sketch({fetch:function(){return Future_nu(function(resolve){resolve(buildGroups(detail.overflowGroups.get()))})},layouts:{onLtr:function(){return[southwest$1,southeast$1]},onRtl:function(){return[southeast$1,southwest$1]},onBottomLtr:function(){return[northwest$1,northeast$1]},onBottomRtl:function(){return[northeast$1,northwest$1]}},getBounds:spec.getOverflowBounds,lazySink:detail.lazySink,fireDismissalEventInstead:{},markers:{toggledClass:detail.markers.overflowToggledClass},parts:{button:externals["overflow-button"](),toolbar:externals.overflow()}}));return{uid:detail.uid,dom:detail.dom,components:components,behaviours:augment(detail.splitToolbarBehaviours,[Coupling.config({others:{overflowGroup:function(){return ToolbarGroup.sketch(__assign(__assign({},externals["overflow-group"]()),{items:[memFloatingToolbarButton.asSpec()]}))}}})]),apis:{setGroups:function(toolbar,groups){detail.builtGroups.set(map(groups,toolbar.getSystem().build)),refresh$1(toolbar,memFloatingToolbarButton,detail)},refresh:function(toolbar){return refresh$1(toolbar,memFloatingToolbarButton,detail)},toggle:function(toolbar){memFloatingToolbarButton.getOpt(toolbar).each(function(floatingToolbarButton){FloatingToolbarButton.toggle(floatingToolbarButton)})},reposition:function(toolbar){memFloatingToolbarButton.getOpt(toolbar).each(function(floatingToolbarButton){FloatingToolbarButton.reposition(floatingToolbarButton)})},getOverflow:function(toolbar){return memFloatingToolbarButton.getOpt(toolbar).bind(function(floatingToolbarButton){return FloatingToolbarButton.getToolbar(floatingToolbarButton)})}},domModification:{attributes:{role:"group"}}}},apis:{setGroups:function(apis,toolbar,groups){apis.setGroups(toolbar,groups)},refresh:function(apis,toolbar){apis.refresh(toolbar)},reposition:function(apis,toolbar){apis.reposition(toolbar)},toggle:function(apis,toolbar){apis.toggle(toolbar)},getOverflow:function(apis,toolbar){return apis.getOverflow(toolbar)}}}),SlidingApis=Object.freeze({__proto__:null,refresh:function(component,slideConfig,slideState){if(slideState.isExpanded()){remove$6(component.element(),getDimensionProperty(slideConfig));var fullSize=getDimension(slideConfig,component.element());set$2(component.element(),getDimensionProperty(slideConfig),fullSize)}},grow:function(component,slideConfig,slideState){slideState.isExpanded()||doStartGrow(component,slideConfig,slideState)},shrink:function(component,slideConfig,slideState){slideState.isExpanded()&&doStartSmartShrink(component,slideConfig,slideState)},immediateShrink:function(component,slideConfig,slideState){slideState.isExpanded()&&doImmediateShrink(component,slideConfig,slideState,Option.none())},hasGrown:function(component,slideConfig,slideState){return slideState.isExpanded()},hasShrunk:function(component,slideConfig,slideState){return slideState.isCollapsed()},isGrowing:isGrowing,isShrinking:isShrinking,isTransitioning:function(component,slideConfig,slideState){return!0===isGrowing(component,slideConfig)||!0===isShrinking(component,slideConfig)},toggleGrow:function(component,slideConfig,slideState){(slideState.isExpanded()?doStartSmartShrink:doStartGrow)(component,slideConfig,slideState)},disableTransitions:disableTransitions}),ActiveSliding=Object.freeze({__proto__:null,exhibit:function(base,slideConfig){var expanded=slideConfig.expanded;return nu$6(expanded?{classes:[slideConfig.openClass],styles:{}}:{classes:[slideConfig.closedClass],styles:wrap$1(slideConfig.dimension.property,"0px")})},events:function(slideConfig,slideState){return derive([runOnSource(transitionend(),function(component,simulatedEvent){simulatedEvent.event().raw().propertyName===slideConfig.dimension.property&&(disableTransitions(component,slideConfig),slideState.isExpanded()&&remove$6(component.element(),slideConfig.dimension.property),(slideState.isExpanded()?slideConfig.onGrown:slideConfig.onShrunk)(component))})])}}),SlidingSchema=[strict$1("closedClass"),strict$1("openClass"),strict$1("shrinkingClass"),strict$1("growingClass"),option("getAnimationRoot"),onHandler("onShrunk"),onHandler("onStartShrink"),onHandler("onGrown"),onHandler("onStartGrow"),defaulted$1("expanded",!1),strictOf("dimension",choose$1("property",{width:[output("property","width"),output("getDimension",function(elem){return get$7(elem)+"px"})],height:[output("property","height"),output("getDimension",function(elem){return get$6(elem)+"px"})]}))],Sliding=create$1({fields:SlidingSchema,name:"sliding",active:ActiveSliding,apis:SlidingApis,state:Object.freeze({__proto__:null,init:function(spec){var state=Cell(spec.expanded);return nu$5({isExpanded:function(){return!0===state.get()},isCollapsed:function(){return!1===state.get()},setCollapsed:curry(state.set,!1),setExpanded:curry(state.set,!0),readState:function(){return"expanded: "+state.get()}})}})}),schema$p=constant([markers(["closedClass","openClass","shrinkingClass","growingClass","overflowToggledClass"]),onHandler("onOpened"),onHandler("onClosed")].concat(schema$m())),parts$b=constant([required({factory:Toolbar,schema:schema$l(),name:"primary"}),required({factory:Toolbar,schema:schema$l(),name:"overflow",overrides:function(detail){return{toolbarBehaviours:derive$1([Sliding.config({dimension:{property:"height"},closedClass:detail.markers.closedClass,openClass:detail.markers.openClass,shrinkingClass:detail.markers.shrinkingClass,growingClass:detail.markers.growingClass,onShrunk:function(comp){getPart(comp,detail,"overflow-button").each(function(button){Toggling.off(button),Focusing.focus(button)}),detail.onClosed(comp)},onGrown:function(comp){Keying.focusIn(comp),detail.onOpened(comp)},onStartGrow:function(comp){getPart(comp,detail,"overflow-button").each(Toggling.on)}}),Keying.config({mode:"acyclic",onEscape:function(comp){return getPart(comp,detail,"overflow-button").each(Focusing.focus),Option.some(!0)}})])}}}),external$1({name:"overflow-button",overrides:function(detail){return{buttonBehaviours:derive$1([Toggling.config({toggleClass:detail.markers.overflowToggledClass,aria:{mode:"pressed"},toggleOnExecute:!1})])}}}),external$1({name:"overflow-group"})]),refresh$3=function(toolbar,detail){getPart(toolbar,detail,"overflow").each(function(overflow){refresh(toolbar,detail,function(groups){var builtGroups=map(groups,function(g){return premade$1(g)});Toolbar.setGroups(overflow,builtGroups)}),getPart(toolbar,detail,"overflow-button").each(function(button){Sliding.hasGrown(overflow)&&Toggling.on(button)}),Sliding.refresh(overflow)})},SplitSlidingToolbar=composite$1({name:"SplitSlidingToolbar",configFields:schema$p(),partFields:parts$b(),factory:function(detail,components,spec,externals){return{uid:detail.uid,dom:detail.dom,components:components,behaviours:augment(detail.splitToolbarBehaviours,[Coupling.config({others:{overflowGroup:function(toolbar){return ToolbarGroup.sketch(__assign(__assign({},externals["overflow-group"]()),{items:[Button.sketch(__assign(__assign({},externals["overflow-button"]()),{action:function(_button){emit(toolbar,"alloy.toolbar.toggle")}}))]}))}}}),config("toolbar-toggle-events",[run("alloy.toolbar.toggle",function(toolbar){getPart(toolbar,detail,"overflow").each(function(overf){refresh$3(toolbar,detail),Sliding.toggleGrow(overf)})})])]),apis:{setGroups:function(toolbar,groups){!function(toolbar,groups){var built=map(groups,toolbar.getSystem().build);detail.builtGroups.set(built)}(toolbar,groups),refresh$3(toolbar,detail)},refresh:function(toolbar){return refresh$3(toolbar,detail)},toggle:function(toolbar){return function(toolbar,detail){getPart(toolbar,detail,"overflow").each(function(overf){refresh$3(toolbar,detail),Sliding.toggleGrow(overf)})}(toolbar,detail)}},domModification:{attributes:{role:"group"}}}},apis:{setGroups:function(apis,toolbar,groups){apis.setGroups(toolbar,groups)},refresh:function(apis,toolbar){apis.refresh(toolbar)},toggle:function(apis,toolbar){apis.toggle(toolbar)}}}),toolbarHeightChange=constant(generate$1("toolbar-height-change")),ReadOnlyDataSchema=objOf([(key="readonly",strictOf(key,boolean))]),baseToolbarButtonFields=[defaultedBoolean("disabled",!1),optionString("tooltip"),optionString("icon"),optionString("text"),defaultedFunction("onSetup",function(){return noop})],toolbarButtonSchema=objOf([strictString("type"),strictFunction("onAction")].concat(baseToolbarButtonFields)),baseMenuButtonFields=[optionString("text"),optionString("tooltip"),optionString("icon"),strictFunction("fetch"),defaultedFunction("onSetup",function(){return noop})],MenuButtonSchema=objOf(__spreadArrays([strictString("type")],baseMenuButtonFields)),splitButtonSchema=objOf([strictString("type"),optionString("tooltip"),optionString("icon"),optionString("text"),optionFunction("select"),strictFunction("fetch"),defaultedFunction("onSetup",function(){return noop}),defaultedStringEnum("presets","normal",["normal","color","listpreview"]),defaulted$1("columns",1),strictFunction("onAction"),strictFunction("onItemAction")]),baseToolbarToggleButtonFields=[defaultedBoolean("active",!1)].concat(baseToolbarButtonFields),toggleButtonSchema=objOf(baseToolbarToggleButtonFields.concat([strictString("type"),strictFunction("onAction")])),groupToolbarButtonSchema=objOf([strictString("type"),strictOf("items",(props=[arrOfObj$1([strictString("name"),strictArrayOf("items",string)]),string],{extract:function(path,strength,val){for(var errors=[],_i=0,props_1=props;_i<props_1.length;_i++){var res=props_1[_i].extract(path,strength,val);if(res.stype===SimpleResultType.Value)return res;errors.push(res)}return ResultCombine_consolidateArr(errors)},toString:function(){return"oneOf("+map(props,function(prop){return prop.toString()}).join(", ")+")"}}))].concat(baseToolbarButtonFields)),contextBarFields=[defaultedFunction("predicate",function(){return!1}),defaultedStringEnum("scope","node",["node","editor"]),defaultedStringEnum("position","selection",["node","selection","line"])],contextButtonFields=baseToolbarButtonFields.concat([defaulted$1("type","contextformbutton"),defaulted$1("primary",!1),strictFunction("onAction"),state$1("original",identity)]),contextToggleButtonFields=baseToolbarToggleButtonFields.concat([defaulted$1("type","contextformbutton"),defaulted$1("primary",!1),strictFunction("onAction"),state$1("original",identity)]),launchButtonFields=baseToolbarButtonFields.concat([defaulted$1("type","contextformbutton")]),launchToggleButtonFields=baseToolbarToggleButtonFields.concat([defaulted$1("type","contextformtogglebutton")]),toggleOrNormal=choose$1("type",{contextformbutton:contextButtonFields,contextformtogglebutton:contextToggleButtonFields}),contextFormSchema=objOf([defaulted$1("type","contextform"),defaultedFunction("initValue",function(){return""}),optionString("label"),strictArrayOf("commands",toggleOrNormal),optionOf("launch",choose$1("type",{contextformbutton:launchButtonFields,contextformtogglebutton:launchToggleButtonFields}))].concat(contextBarFields)),contextToolbarSchema=objOf([defaulted$1("type","contexttoolbar"),strictString("items")].concat(contextBarFields)),ReflectingApis=Object.freeze({__proto__:null,getState:function(component,replaceConfig,reflectState){return reflectState}}),ActiveReflecting=Object.freeze({__proto__:null,events:function(reflectingConfig,reflectingState){function update(component,data){reflectingConfig.updateState.each(function(updateState){var newState=updateState(component,data);reflectingState.set(newState)}),reflectingConfig.renderComponents.each(function(renderComponents){var newComponents=renderComponents(data,reflectingState.get()),newChildren=map(newComponents,component.getSystem().build);replaceChildren(component,newChildren)})}return derive([run(receive(),function(component,message){var receivingData=message,channel=reflectingConfig.channel;contains(receivingData.channels(),channel)&&update(component,receivingData.data())}),runOnAttached(function(comp,se){reflectingConfig.initialData.each(function(rawData){update(comp,rawData)})})])}}),ReflectingState=Object.freeze({__proto__:null,init:function(){var cell=Cell(Option.none());return{readState:function(){return cell.get().fold(function(){return"none"},function(x){return x})},get:function(){return cell.get()},set:function(optS){return cell.set(optS)},clear:function(){return cell.set(Option.none())}}}}),ReflectingSchema=[strict$1("channel"),option("renderComponents"),option("updateState"),option("initialData")],Reflecting=create$1({fields:ReflectingSchema,name:"reflecting",active:ActiveReflecting,apis:ReflectingApis,state:ReflectingState}),schema$q=constant([strict$1("toggleClass"),strict$1("fetch"),onStrictHandler("onExecute"),defaulted$1("getHotspot",Option.some),defaulted$1("getAnchorOverrides",constant({})),schema$1(),onStrictHandler("onItemExecute"),option("lazySink"),strict$1("dom"),onHandler("onOpen"),field$1("splitDropdownBehaviours",[Coupling,Keying,Focusing]),defaulted$1("matchWidth",!1),defaulted$1("useMinWidth",!1),defaulted$1("eventOrder",{}),option("role")].concat(sandboxFields())),arrowPart=required({factory:Button,schema:[strict$1("dom")],name:"arrow",defaults:function(){return{buttonBehaviours:derive$1([Focusing.revoke()])}},overrides:function(detail){return{dom:{tag:"span",attributes:{role:"presentation"}},action:function(arrow){arrow.getSystem().getByUid(detail.uid).each(emitExecute)},buttonBehaviours:derive$1([Toggling.config({toggleOnExecute:!1,toggleClass:detail.toggleClass})])}}}),buttonPart=required({factory:Button,schema:[strict$1("dom")],name:"button",defaults:function(){return{buttonBehaviours:derive$1([Focusing.revoke()])}},overrides:function(detail){return{dom:{tag:"span",attributes:{role:"presentation"}},action:function(btn){btn.getSystem().getByUid(detail.uid).each(function(splitDropdown){detail.onExecute(splitDropdown,btn)})}}}}),parts$c=constant([arrowPart,buttonPart,optional({factory:{sketch:function(spec){return{uid:spec.uid,dom:{tag:"span",styles:{display:"none"},attributes:{"aria-hidden":"true"},innerHtml:spec.text}}}},schema:[strict$1("text")],name:"aria-descriptor"}),external$1({schema:[tieredMenuMarkers()],name:"menu",defaults:function(detail){return{onExecute:function(tmenu,item){tmenu.getSystem().getByUid(detail.uid).each(function(splitDropdown){detail.onItemExecute(splitDropdown,tmenu,item)})}}}}),partType()]),SplitDropdown=composite$1({name:"SplitDropdown",configFields:schema$q(),partFields:parts$c(),factory:function(detail,components,spec,externals){function switchToMenu(sandbox){Composing.getCurrent(sandbox).each(function(current){Highlighting.highlightFirst(current),Keying.focusIn(current)})}function action(component){togglePopup(detail,function(x){return x},component,externals,switchToMenu,HighlightOnOpen.HighlightFirst).get(noop)}function executeOnButton(comp){var button=getPartOrDie(comp,detail,"button");return emitExecute(button),Option.some(!0)}var buttonEvents=__assign(__assign({},derive([runOnAttached(function(component,simulatedEvent){getPart(component,detail,"aria-descriptor").each(function(descriptor){var descriptorId=generate$1("aria");set$1(descriptor.element(),"id",descriptorId),set$1(component.element(),"aria-describedby",descriptorId)})})])),events$7(Option.some(action))),apis={repositionMenus:function(comp){Toggling.isOn(comp)&&repositionMenus(comp)}};return{uid:detail.uid,dom:detail.dom,components:components,apis:apis,eventOrder:__assign(__assign({},detail.eventOrder),{"alloy.execute":["disabling","toggling","alloy.base.behaviour"]}),events:buttonEvents,behaviours:augment(detail.splitDropdownBehaviours,[Coupling.config({others:{sandbox:function(hotspot){var arrow=getPartOrDie(hotspot,detail,"arrow");return makeSandbox(detail,hotspot,{onOpen:function(){Toggling.on(arrow),Toggling.on(hotspot)},onClose:function(){Toggling.off(arrow),Toggling.off(hotspot)}})}}}),Keying.config({mode:"special",onSpace:executeOnButton,onEnter:executeOnButton,onDown:function(comp){return action(comp),Option.some(!0)}}),Focusing.config({}),Toggling.config({toggleOnExecute:!1,aria:{mode:"expanded"}})]),domModification:{attributes:{role:detail.role.getOr("button"),"aria-haspopup":!0}}}},apis:{repositionMenus:function(apis,comp){return apis.repositionMenus(comp)}}}),focusButtonEvent=generate$1("focus-button"),rtlIcon$1=["checklist","ordered-list"],rtlTransform$1=["indent","outdent","table-insert-column-after","table-insert-column-before","unordered-list"],renderToolbarButtonWith=function(spec,providersBackstage,bonusEvents){return renderCommonToolbarButton(spec,{toolbarButtonBehaviours:[].concat(0<bonusEvents.length?[config("toolbarButtonWith",bonusEvents)]:[]),getApi:getButtonApi,onSetup:spec.onSetup},providersBackstage)},renderToolbarToggleButtonWith=function(spec,providersBackstage,bonusEvents){return deepMerge(renderCommonToolbarButton(spec,{toolbarButtonBehaviours:[Replacing.config({}),Toggling.config({toggleClass:"tox-tbtn--enabled",aria:{mode:"pressed"},toggleOnExecute:!1})].concat(0<bonusEvents.length?[config("toolbarToggleButtonWith",bonusEvents)]:[]),getApi:getToggleApi,onSetup:spec.onSetup},providersBackstage))},ContextForm_renderContextForm=function(toolbarType,ctx,backstage){var inputAttributes=ctx.label.fold(function(){return{}},function(label){return{"aria-label":label}}),memInput=record(Input.sketch({inputClasses:["tox-toolbar-textfield","tox-toolbar-nav-js"],data:ctx.initValue(),inputAttributes:inputAttributes,selectOnFocus:!0,inputBehaviours:derive$1([Keying.config({mode:"special",onEnter:function(input){return commands.findPrimary(input).map(function(primary){return emitExecute(primary),!0})},onLeft:function(comp,se){return se.cut(),Option.none()},onRight:function(comp,se){return se.cut(),Option.none()}})])})),commands=function(memInput,buttons,providersBackstage){var mementos=map(buttons,function(button){return record(generateOne$1(memInput,button,providersBackstage))});return{asSpecs:function(){return map(mementos,function(mem){return mem.asSpec()})},findPrimary:function(compInSystem){return findMap(buttons,function(button,i){return button.primary?Option.from(mementos[i]).bind(function(mem){return mem.getOpt(compInSystem)}).filter(not(Disabling.isDisabled)):Option.none()})}}}(memInput,ctx.commands,backstage.shared.providers);return renderToolbar({type:toolbarType,uid:generate$1("context-toolbar"),initGroups:[{title:Option.none(),items:[memInput.asSpec()]},{title:Option.none(),items:commands.asSpecs()}],onEscape:Option.none,cyclicKeying:!0})},ToolbarLookup_lookup=function(scopes,editor){function isRoot(elem){return eq(elem,rootElem)}var rootElem=Element.fromDom(editor.getBody()),startNode=Element.fromDom(editor.selection.getNode());return function(startNode){return!isRoot(startNode)&&!contains$2(rootElem,startNode)}(startNode)?Option.none():matchTargetWith(startNode,scopes.inNodeScope).orThunk(function(){return matchTargetWith(startNode,scopes.inEditorScope).orThunk(function(){return isRoot(startNode)?Option.none():ancestor(startNode,function(elem){return matchTargetWith(elem,scopes.inNodeScope)},isRoot)})})},ToolbarScopes_categorise=function(contextToolbars,navigate){function registerForm(key,toolbarApi){var contextForm=getOrDie(function(spec){return asRaw("ContextForm",contextFormSchema,spec)}(toolbarApi));(forms[key]=contextForm).launch.map(function(launch){formNavigators["form:"+key]=__assign(__assign({},toolbarApi.launch),{type:"contextformtogglebutton"===launch.type?"togglebutton":"button",onAction:function(){navigate(contextForm)}})}),"editor"===contextForm.scope?inEditorScope.push(contextForm):inNodeScope.push(contextForm),lookupTable[key]=contextForm}function registerToolbar(key,toolbarApi){(function(spec){return asRaw("ContextToolbar",contextToolbarSchema,spec)})(toolbarApi).each(function(contextToolbar){"editor"===toolbarApi.scope?inEditorScope.push(contextToolbar):inNodeScope.push(contextToolbar),lookupTable[key]=contextToolbar})}var forms={},inNodeScope=[],inEditorScope=[],formNavigators={},lookupTable={},keys$1=keys(contextToolbars);return each(keys$1,function(key){var toolbarApi=contextToolbars[key];"contextform"===toolbarApi.type?registerForm(key,toolbarApi):"contexttoolbar"===toolbarApi.type&&registerToolbar(key,toolbarApi)}),{forms:forms,inNodeScope:inNodeScope,inEditorScope:inEditorScope,lookupTable:lookupTable,formNavigators:formNavigators}},forwardSlideEvent=generate$1("forward-slide"),backSlideEvent=generate$1("backward-slide"),changeSlideEvent=generate$1("change-slide-event");!function(Delimiter){Delimiter[Delimiter.SemiColon=0]="SemiColon",Delimiter[Delimiter.Space=1]="Space"}(Delimiter=Delimiter||{});function buildBasicSettingsDataset(editor,settingName,defaults,delimiter){return{type:"basic",data:function(rawFormats){return map(rawFormats,function(item){var title=item,format=item,values=item.split("=");return 1<values.length&&(title=values[0],format=values[1]),{title:title,format:format}})}(function(rawFormats,delimiter){return delimiter===Delimiter.SemiColon?rawFormats.replace(/;$/,"").split(";"):rawFormats.split(" ")}(get(editor.settings,settingName).getOr(defaults),delimiter))}}function getSpec(editor){function updateSelectMenuIcon(comp){var alignment=find(alignMenuItems,function(item){return editor.formatter.match(item.format)}).fold(function(){return"left"},function(item){return item.title.toLowerCase()});emitWith(comp,updateMenuIcon,{icon:"align-"+alignment})}var nodeChangeHandler=Option.some(function(comp){return function(){return updateSelectMenuIcon(comp)}}),setInitialValue=Option.some(function(comp){return updateSelectMenuIcon(comp)}),dataset=function(data){return{type:"basic",data:data}}(alignMenuItems);return{tooltip:"Align",icon:Option.some("align-left"),isSelectedFor:function(format){return function(){return editor.formatter.match(format)}},getCurrentValue:constant(Option.none()),getPreviewFor:function(_format){return function(){return Option.none()}},onAction:function(rawItem){return function(){return find(alignMenuItems,function(item){return item.format===rawItem.format}).each(function(item){return editor.execCommand(item.command)})}},setInitialValue:setInitialValue,nodeChangeHandler:nodeChangeHandler,dataset:dataset,shouldHide:!1,isInvalid:function(item){return!editor.formatter.canApply(item.format)}}}function splitFonts(fontFamily){var fonts=fontFamily.split(/\s*,\s*/);return map(fonts,function(font){return font.replace(/^['"]+|['"]+$/g,"")})}function isSystemFontStack(fontFamily){var fonts;return 0===fontFamily.indexOf("-apple-system")&&(fonts=splitFonts(fontFamily.toLowerCase()),forall(systemStackFonts,function(font){return-1<fonts.indexOf(font.toLowerCase())}))}function getSpec$1(editor){function getMatchingValue(){function getFirstFont(fontFamily){return fontFamily?splitFonts(fontFamily)[0]:""}var fontFamily=editor.queryCommandValue("FontName"),items=dataset.data,font=fontFamily?fontFamily.toLowerCase():"";return{matchOpt:find(items,function(item){var format=item.format;return format.toLowerCase()===font||getFirstFont(format).toLowerCase()===getFirstFont(font).toLowerCase()}).orThunk(function(){return isSystemFontStack(font)?Option.from({title:"System Font",format:font}):Option.none()}),font:fontFamily}}function updateSelectMenuText(comp){var _a=getMatchingValue(),matchOpt=_a.matchOpt,font=_a.font,text=matchOpt.fold(function(){return font},function(item){return item.title});emitWith(comp,updateMenuText,{text:text})}var nodeChangeHandler=Option.some(function(comp){return function(){return updateSelectMenuText(comp)}}),setInitialValue=Option.some(function(comp){return updateSelectMenuText(comp)}),dataset=buildBasicSettingsDataset(editor,"font_formats","Andale Mono=andale mono,monospace;Arial=arial,helvetica,sans-serif;Arial Black=arial black,sans-serif;Book Antiqua=book antiqua,palatino,serif;Comic Sans MS=comic sans ms,sans-serif;Courier New=courier new,courier,monospace;Georgia=georgia,palatino,serif;Helvetica=helvetica,arial,sans-serif;Impact=impact,sans-serif;Symbol=symbol;Tahoma=tahoma,arial,helvetica,sans-serif;Terminal=terminal,monaco,monospace;Times New Roman=times new roman,times,serif;Trebuchet MS=trebuchet ms,geneva,sans-serif;Verdana=verdana,geneva,sans-serif;Webdings=webdings;Wingdings=wingdings,zapf dingbats",Delimiter.SemiColon);return{tooltip:"Fonts",icon:Option.none(),isSelectedFor:function(item){return function(valueOpt){return valueOpt.exists(function(value){return value.format===item})}},getCurrentValue:function(){return getMatchingValue().matchOpt},getPreviewFor:function(item){return function(){return Option.some({tag:"div",styles:-1===item.indexOf("dings")?{"font-family":item}:{}})}},onAction:function(rawItem){return function(){editor.undoManager.transact(function(){editor.focus(),editor.execCommand("FontName",!1,rawItem.format)})}},setInitialValue:setInitialValue,nodeChangeHandler:nodeChangeHandler,dataset:dataset,shouldHide:!1,isInvalid:function(){return!1}}}function toPt(fontSize,precision){return/[0-9.]+px$/.test(fontSize)?function(number,precision){var factor=Math.pow(10,precision);return Math.round(number*factor)/factor}(72*parseInt(fontSize,10)/96,precision||0)+"pt":fontSize}function getSpec$2(editor){function getMatchingValue(){var matchOpt=Option.none(),items=dataset.data,fontSize=editor.queryCommandValue("FontSize");if(fontSize)for(var _loop_1=function(precision){var pt=toPt(fontSize,precision),legacy=function(fontSize){return get(legacyFontSizes,fontSize).getOr("")}(pt);matchOpt=find(items,function(item){return item.format===fontSize||item.format===pt||item.format===legacy})},precision=3;matchOpt.isNone()&&0<=precision;precision--)_loop_1(precision);return{matchOpt:matchOpt,size:fontSize}}function updateSelectMenuText(comp){var _a=getMatchingValue(),matchOpt=_a.matchOpt,size=_a.size,text=matchOpt.fold(function(){return size},function(match){return match.title});emitWith(comp,updateMenuText,{text:text})}var getPreviewFor=constant(constant(Option.none())),nodeChangeHandler=Option.some(function(comp){return function(){return updateSelectMenuText(comp)}}),setInitialValue=Option.some(function(comp){return updateSelectMenuText(comp)}),dataset=buildBasicSettingsDataset(editor,"fontsize_formats","8pt 10pt 12pt 14pt 18pt 24pt 36pt",Delimiter.Space);return{tooltip:"Font sizes",icon:Option.none(),isSelectedFor:function(item){return function(valueOpt){return valueOpt.exists(function(value){return value.format===item})}},getPreviewFor:getPreviewFor,getCurrentValue:function(){return getMatchingValue().matchOpt},onAction:function(rawItem){return function(){editor.undoManager.transact(function(){editor.focus(),editor.execCommand("FontSize",!1,rawItem.format)})}},setInitialValue:setInitialValue,nodeChangeHandler:nodeChangeHandler,dataset:dataset,shouldHide:!1,isInvalid:function(){return!1}}}function findNearest(editor,getStyles,parents){var styles=getStyles();return findMap(parents,function(parent){return find(styles,function(fmt){return editor.formatter.matchNode(parent,fmt.format)})}).orThunk(function(){return editor.formatter.match("p")?Option.some({title:"Paragraph",format:"p"}):Option.none()})}function getCurrentSelectionParents(editor){var currentNode=editor.selection.getStart(!0)||editor.getBody();return editor.dom.getParents(currentNode,function(){return!0},editor.getBody())}function onSetupFormatToggle(editor,name){return function(api){function init(){api.setActive(editor.formatter.match(name));var unbind=editor.formatter.formatChanged(name,api.setActive).unbind;unbindCell.set(Option.some(unbind))}var unbindCell=Cell(Option.none());return editor.initialized?init():editor.on("init",init),function(){return unbindCell.get().each(function(unbind){return unbind()})}}}function onActionToggleFormat(editor){return function(rawItem){return function(){editor.undoManager.transact(function(){editor.focus(),editor.execCommand("mceToggleFormat",!1,rawItem.format)})}}}function getSpec$3(editor){function updateSelectMenuText(parents,comp){var text=function(nodeChangeEvent){return findNearest(editor,function(){return dataset.data},nodeChangeEvent)}(parents).fold(function(){return"Paragraph"},function(fmt){return fmt.title});emitWith(comp,updateMenuText,{text:text})}var nodeChangeHandler=Option.some(function(comp){return function(e){return updateSelectMenuText(e.parents,comp)}}),setInitialValue=Option.some(function(comp){var parents=getCurrentSelectionParents(editor);updateSelectMenuText(parents,comp)}),dataset=buildBasicSettingsDataset(editor,"block_formats","Paragraph=p;Heading 1=h1;Heading 2=h2;Heading 3=h3;Heading 4=h4;Heading 5=h5;Heading 6=h6;Preformatted=pre",Delimiter.SemiColon);return{tooltip:"Blocks",icon:Option.none(),isSelectedFor:function(format){return function(){return editor.formatter.match(format)}},getCurrentValue:constant(Option.none()),getPreviewFor:function(format){return function(){var fmt=editor.formatter.get(format);return Option.some({tag:0<fmt.length&&(fmt[0].inline||fmt[0].block)||"div",styles:editor.dom.parseStyle(editor.formatter.getCssText(format))})}},onAction:onActionToggleFormat(editor),setInitialValue:setInitialValue,nodeChangeHandler:nodeChangeHandler,dataset:dataset,shouldHide:!1,isInvalid:function(item){return!editor.formatter.canApply(item.format)}}}function getSpec$4(editor,dataset){function updateSelectMenuText(parents,comp){var getFormatItems=function(fmt){var subs=fmt.items;return void 0!==subs&&0<subs.length?bind(subs,getFormatItems):[{title:fmt.title,format:fmt.format}]},flattenedItems=bind(getStyleFormats(editor),getFormatItems),text=findNearest(editor,function(){return flattenedItems},parents).fold(function(){return"Paragraph"},function(fmt){return fmt.title});emitWith(comp,updateMenuText,{text:text})}var nodeChangeHandler=Option.some(function(comp){return function(e){return updateSelectMenuText(e.parents,comp)}}),setInitialValue=Option.some(function(comp){var parents=getCurrentSelectionParents(editor);updateSelectMenuText(parents,comp)});return{tooltip:"Formats",icon:Option.none(),isSelectedFor:function(format){return function(){return editor.formatter.match(format)}},getCurrentValue:constant(Option.none()),getPreviewFor:function(format){return function(){var fmt=editor.formatter.get(format);return void 0!==fmt?Option.some({tag:0<fmt.length&&(fmt[0].inline||fmt[0].block)||"div",styles:editor.dom.parseStyle(editor.formatter.getCssText(format))}):Option.none()}},onAction:onActionToggleFormat(editor),setInitialValue:setInitialValue,nodeChangeHandler:nodeChangeHandler,shouldHide:editor.getParam("style_formats_autohide",!1,"boolean"),isInvalid:function(item){return!editor.formatter.canApply(item.format)},dataset:dataset}}function renderFromBridge(bridgeBuilder,render){return function(spec,extras,editor){var internal=bridgeBuilder(spec).mapError(function(errInfo){return formatError(errInfo)}).getOrDie();return render(internal,extras,editor)}}function createToolbar(toolbarConfig){var toolbar=toolbarConfig.toolbar,buttons=toolbarConfig.buttons;return!1===toolbar?[]:void 0===toolbar||!0===toolbar?function(buttons){var filteredItemGroups=map(defaultToolbar,function(group){var items=filter(group.items,function(subItem){return has(buttons,subItem)||has(bespokeButtons,subItem)});return{name:group.name,items:items}});return filter(filteredItemGroups,function(group){return 0<group.items.length})}(buttons):isString(toolbar)?function(strToolbar){var groupsStrings=strToolbar.split("|");return map(groupsStrings,function(g){return{items:g.trim().split(" ")}})}(toolbar):function(toolbar){return isArrayOf(toolbar,function(t){return has(t,"name")&&has(t,"items")})}(toolbar)?toolbar:(domGlobals.console.error("Toolbar type should be string, string[], boolean or ToolbarGroup[]"),[])}function lookupButton(editor,buttons,toolbarItem,allowToolbarGroups,extras,prefixes){return get(buttons,toolbarItem.toLowerCase()).orThunk(function(){return prefixes.bind(function(ps){return findMap(ps,function(prefix){return get(buttons,prefix+toolbarItem.toLowerCase())})})}).fold(function(){return get(bespokeButtons,toolbarItem.toLowerCase()).map(function(r){return r(editor,extras)}).orThunk(function(){return Option.none()})},function(spec){return"grouptoolbarbutton"!==spec.type||allowToolbarGroups?function(spec,extras,editor){return get(types,spec.type).fold(function(){return domGlobals.console.error("skipping button defined by",spec),Option.none()},function(render){return Option.some(render(spec,extras,editor))})}(spec,extras,editor):(domGlobals.console.warn("Ignoring the '"+toolbarItem+"' toolbar button. Group toolbar buttons are only supported when using floating toolbar mode and cannot be nested."),Option.none())})}function getOffsetParent(element){return(getRaw(element,"position").is("fixed")?Option.none():offsetParent(element)).orThunk(function(){var marker=Element.fromTag("span");return parent(element).bind(function(parent){append(parent,marker);var offsetParent$1=offsetParent(marker);return remove(marker),offsetParent$1})})}function getOrigin(element){return getOffsetParent(element).map(absolute).getOrThunk(function(){return Position(0,0)})}function appear(component,contextualInfo){var elem=component.element();add$2(elem,contextualInfo.transitionClass),remove$4(elem,contextualInfo.fadeOutClass),add$2(elem,contextualInfo.fadeInClass),contextualInfo.onShow(component)}function disappear(component,contextualInfo){var elem=component.element();add$2(elem,contextualInfo.transitionClass),remove$4(elem,contextualInfo.fadeInClass),add$2(elem,contextualInfo.fadeOutClass),contextualInfo.onHide(component)}function isVisibleForModes(modes,box,viewport){return forall(modes,function(mode){switch(mode){case"bottom":return function(box,viewport){return box.bottom()<=viewport.bottom()}(box,viewport);case"top":return function(box,viewport){return box.y()>=viewport.y()}(box,viewport)}})}function getPrior(elem,state){return state.getInitialPosition().map(function(pos){return bounds$1(pos.bounds.x(),pos.bounds.y(),get$7(elem),get$6(elem))})}function storePrior(elem,box,state){state.setInitialPosition(Option.some({style:function(element){var css={},dom=element.dom();if(isSupported(dom))for(var i=0;i<dom.style.length;i++){var ruleName=dom.style.item(i);css[ruleName]=dom.style[ruleName]}return css}(elem),position:get$4(elem,"position")||"static",bounds:box}))}function revertToOriginal(elem,box$1,state){return state.getInitialPosition().bind(function(position){switch(state.setInitialPosition(Option.none()),position.position){case"static":return Option.some(morphAdt.static());case"absolute":var offsetBox_1=getOffsetParent(elem).map(box).getOrThunk(function(){return box(body())});return Option.some(morphAdt.absolute(NuPositionCss("absolute",get(position.style,"left").map(function(_){return box$1.x()-offsetBox_1.x()}),get(position.style,"top").map(function(_){return box$1.y()-offsetBox_1.y()}),get(position.style,"right").map(function(_){return offsetBox_1.right()-box$1.right()}),get(position.style,"bottom").map(function(_){return offsetBox_1.bottom()-box$1.bottom()}))));default:return Option.none()}})}function getMorph(component,dockInfo,viewport,state){var elem=component.element();return getRaw(elem,"position").is("fixed")?function(elem,dockInfo,viewport,state){return getPrior(elem,state).filter(function(box){return isVisibleForModes(dockInfo.modes,box,viewport)}).bind(function(box){return revertToOriginal(elem,box,state)})}(elem,dockInfo,viewport,state):function(elem,dockInfo,viewport,state){var box$1=box(elem);if(isVisibleForModes(dockInfo.modes,box$1,viewport))return Option.none();storePrior(elem,box$1,state);var winBox=win(),left=box$1.x()-winBox.x(),top=viewport.y()-winBox.y(),bottom=winBox.bottom()-viewport.bottom(),isTop=box$1.y()<=viewport.y();return Option.some(morphAdt.fixed(NuPositionCss("fixed",Option.some(left),isTop?Option.some(top):Option.none(),Option.none(),isTop?Option.none():Option.some(bottom))))}(elem,dockInfo,viewport,state)}function morphToStatic(component,config){each(["left","right","top","bottom","position"],function(prop){return remove$6(component.element(),prop)}),config.onUndocked(component)}function morphToCoord(component,config,position){applyPositionCss(component.element(),position),("fixed"===position.position()?config.onDocked:config.onUndocked)(component)}function updateVisibility(component,config,state,viewport,morphToDocked){void 0===morphToDocked&&(morphToDocked=!1),config.contextual.each(function(contextInfo){contextInfo.lazyContext(component).each(function(box){var isVisible=function(box,viewport){return box.y()<viewport.bottom()&&box.bottom()>viewport.y()}(box,viewport);isVisible!==state.isVisible()&&(state.setVisible(isVisible),morphToDocked&&!isVisible?(add$3(component.element(),[contextInfo.fadeOutClass]),contextInfo.onHide(component)):(isVisible?appear:disappear)(component,contextInfo))})})}function resetInternal(component,config,state){var elem=component.element();state.setDocked(!1),function(component,state){var elem=component.element();return getPrior(elem,state).bind(function(box){return revertToOriginal(elem,box,state)})}(component,state).each(function(morph){morph.fold(function(){return morphToStatic(component,config)},function(position){return morphToCoord(component,config,position)},noop)}),state.setVisible(!0),config.contextual.each(function(contextInfo){remove$5(elem,[contextInfo.fadeInClass,contextInfo.fadeOutClass,contextInfo.transitionClass]),contextInfo.onShow(component)}),refresh$4(component,config,state)}function reset(component,config,state){state.isDocked()&&resetInternal(component,config,state)}function updateIframeContentFlow(header,isToolbarTop){var elm=header.element();parent(elm).each(function(parentElem){var padding="padding-"+(isToolbarTop?"top":"bottom");if(Docking.isDocked(header)){var parentWidth=get$7(parentElem);set$2(elm,"width",parentWidth+"px"),set$2(parentElem,padding,function(elm){return getOuter$1(elm)+(parseInt(get$4(elm,"margin-top"),10)||0)+(parseInt(get$4(elm,"margin-bottom"),10)||0)}(elm)+"px")}else remove$6(elm,"width"),remove$6(parentElem,padding)})}function updateSinkVisibility(sinkElem,visible){visible?(remove$4(sinkElem,visibility.fadeOutClass),add$3(sinkElem,[visibility.transitionClass,visibility.fadeInClass])):(remove$4(sinkElem,visibility.fadeInClass),add$3(sinkElem,[visibility.fadeOutClass,visibility.transitionClass]))}function updateEditorClasses(editor,docked){var editorContainer=Element.fromDom(editor.getContainer());docked?(add$2(editorContainer,"tox-tinymce--toolbar-sticky-on"),remove$4(editorContainer,"tox-tinymce--toolbar-sticky-off")):(add$2(editorContainer,"tox-tinymce--toolbar-sticky-off"),remove$4(editorContainer,"tox-tinymce--toolbar-sticky-on"))}function getBehaviours$2(editor,lazySink){function runOnSinkElement(f){lazySink().each(function(sink){return f(sink.element())})}function onDockingSwitch(comp){editor.inline||updateIframeContentFlow(comp,isToolbarTop),updateEditorClasses(editor,Docking.isDocked(comp)),comp.getSystem().broadcastOn([repositionPopups()],{}),lazySink().each(function(sink){return sink.getSystem().broadcastOn([repositionPopups()],{})})}var focusedElm=Cell(Option.none()),isToolbarTop=isToolbarLocationTop(editor),additionalBehaviours=editor.inline?[]:function(isToolbarTop){var _a;return[Receiving.config({channels:(_a={},_a[toolbarHeightChange()]={onReceive:function(comp){updateIframeContentFlow(comp,isToolbarTop)}},_a)})]}(isToolbarTop);return __spreadArrays([Focusing.config({}),Docking.config({contextual:__assign({lazyContext:function(comp){var headerHeight=getOuter$1(comp.element()),container=editor.inline?editor.getContentAreaContainer():editor.getContainer(),box$1=box(Element.fromDom(container)),boxHeight=box$1.height()-headerHeight,topBound=box$1.y()+(isToolbarTop?0:headerHeight);return Option.some(bounds$1(box$1.x(),topBound,box$1.width(),boxHeight))},onShow:function(){runOnSinkElement(function(elem){return updateSinkVisibility(elem,!0)})},onShown:function(comp){runOnSinkElement(function(elem){return remove$5(elem,[visibility.transitionClass,visibility.fadeInClass])}),focusedElm.get().each(function(elem){!function(headerElem,focusedElem){var ownerDoc=owner(focusedElem);active(ownerDoc).filter(function(activeElm){return!eq(focusedElem,activeElm)}).filter(function(activeElm){return eq(activeElm,Element.fromDom(ownerDoc.dom().body))||contains$2(headerElem,activeElm)}).each(function(){return focus$1(focusedElem)})}(comp.element(),elem),focusedElm.set(Option.none())})},onHide:function(comp){focusedElm.set(function(rootElm,lazySink){return search(rootElm).orThunk(function(){return lazySink().toOption().bind(function(sink){return search(sink.element())})})}(comp.element(),lazySink)),runOnSinkElement(function(elem){return updateSinkVisibility(elem,!1)})},onHidden:function(){runOnSinkElement(function(elem){return remove$5(elem,[visibility.transitionClass])})}},visibility),modes:[isToolbarTop?"top":"bottom"],onDocked:onDockingSwitch,onUndocked:onDockingSwitch})],additionalBehaviours)}function getPartName$1(name){return"<alloy.field."+name+">"}function getApi(comp){return{element:function(){return comp.element().dom()}}}function makePanels(parts,panelConfigs){var specs=map(keys(panelConfigs),function(name){var spec=panelConfigs[name],bridged=getOrDie(function(spec){return asRaw("sidebar",sidebarSchema,spec)}(spec));return{name:name,getApi:getApi,onSetup:bridged.onSetup,onShow:bridged.onShow,onHide:bridged.onHide}});return map(specs,function(spec){var editorOffCell=Cell(noop);return parts.slot(spec.name,{dom:{tag:"div",classes:["tox-sidebar__pane"]},behaviours:SimpleBehaviours_unnamedEvents([onControlAttached(spec,editorOffCell),onControlDetached(spec,editorOffCell),run(slotVisibility(),function(sidepanel,se){var data=se.event();find(specs,function(config){return config.name===data.name()}).each(function(sidePanelSpec){(data.visible()?sidePanelSpec.onShow:sidePanelSpec.onHide)(sidePanelSpec.getApi(sidepanel))})})])})})}function setSidebar(sidebar,panelConfigs){Composing.getCurrent(sidebar).each(function(slider){return Replacing.set(slider,[function(panelConfigs){return SlotContainer.sketch(function(parts){return{dom:{tag:"div",classes:["tox-sidebar__pane-container"]},components:makePanels(parts,panelConfigs),slotBehaviours:SimpleBehaviours_unnamedEvents([runOnAttached(function(slotContainer){return SlotContainer.hideAllSlots(slotContainer)})])}})}(panelConfigs)])})}function whichSidebar(sidebar){return Composing.getCurrent(sidebar).bind(function(slider){return Sliding.isGrowing(slider)||Sliding.hasGrown(slider)?Composing.getCurrent(slider).bind(function(slotContainer){return find(SlotContainer.getSlotNames(slotContainer),function(name){return SlotContainer.isShowing(slotContainer,name)})}):Option.none()})}function fromHtml$2(html){var elem=Element.fromHtml(html),children$1=children(elem),attrs=function(elem){var attributes=void 0!==elem.dom().attributes?elem.dom().attributes:[];return foldl(attributes,function(b,attr){var _a;return"class"===attr.name?b:__assign(__assign({},b),((_a={})[attr.name]=attr.value,_a))},{})}(elem),classes=function(elem){return Array.prototype.slice.call(elem.dom().classList,0)}(elem),contents=0===children$1.length?{}:{innerHtml:get$1(elem)};return __assign({tag:name(elem),classes:classes,attributes:attrs},contents)}function toggleThrobber(comp,state,providerBackstage){var element=comp.element();!0===state?(Replacing.set(comp,[function(providerBackstage){return{dom:{tag:"div",attributes:{"aria-label":providerBackstage.translate("Loading...")},classes:["tox-throbber__busy-spinner"]},components:[{dom:fromHtml$2('<div class="tox-spinner"><div></div><div></div><div></div></div>')}],behaviours:derive$1([Keying.config({mode:"special",onTab:function(){return Option.some(!0)},onShiftTab:function(){return Option.some(!0)}}),Focusing.config({})])}}(providerBackstage)]),remove$6(element,"display"),remove$1(element,"aria-hidden")):(Replacing.set(comp,[]),set$2(element,"display","none"),set$1(element,"aria-hidden","true"))}function setup$7(editor,lazyThrobber,sharedBackstage){function toggle(state){state!==throbberState.get()&&(toggleThrobber(lazyThrobber(),state,sharedBackstage.providers),throbberState.set(state))}var throbberState=Cell(!1),timer=Cell(Option.none());editor.on("ProgressState",function(e){if(timer.get().each(global$2.clearTimeout),isNumber(e.time)){var timerId=global$2.setEditorTimeout(editor,function(){return toggle(e.state)},e.time);timer.set(Option.some(timerId))}else toggle(e.state),timer.set(Option.none())})}function parseItemsString(items){return"string"==typeof items?items.split(" "):items}function identifyMenus(editor,registry){var rawMenuData=__assign(__assign({},defaultMenus),registry.menus),userDefinedMenus=0<keys(registry.menus).length,menubar=void 0===registry.menubar||!0===registry.menubar?parseItemsString("file edit view insert format tools table help"):parseItemsString(!1===registry.menubar?"":registry.menubar),validMenus=filter(menubar,function(menuName){return userDefinedMenus&&registry.menus.hasOwnProperty(menuName)&&registry.menus[menuName].hasOwnProperty("items")||defaultMenus.hasOwnProperty(menuName)}),menus=map(validMenus,function(menuName){var menuData=rawMenuData[menuName];return function(menu,registry,editor){var removedMenuItems=function(editor){return editor.getParam("removed_menuitems","")}(editor).split(/[ ,]/);return{text:menu.title,getItems:function(){return bind(menu.items,function(i){var itemName=i.toLowerCase();return 0===itemName.trim().length?[]:exists(removedMenuItems,function(removedMenuItem){return removedMenuItem===itemName})?[]:"separator"===itemName||"|"===itemName?[{type:"separator"}]:registry.menuItems[itemName]?[registry.menuItems[itemName]]:[]})}}}({title:menuData.title,items:parseItemsString(menuData.items)},registry,editor)});return filter(menus,function(menu){return 0<menu.getItems().length&&exists(menu.getItems(),function(item){return"separator"!==item.type})})}function loadSkin(isInline,editor){var skinUiCss,skinUrl=function(editor){var settings=editor.settings,skin=settings.skin,skinUrl=settings.skin_url;if(!1!==skin){var skinName=skin||"oxide";skinUrl=skinUrl?editor.documentBaseURI.toAbsolute(skinUrl):global$4.baseURL+"/skins/ui/"+skinName}return skinUrl}(editor);skinUrl&&(skinUiCss=skinUrl+"/skin.min.css",editor.contentCSS.push(skinUrl+(isInline?"/content.inline":"/content")+".min.css")),!1===function(editor){return!1===editor.getParam("skin")}(editor)&&skinUiCss?global$3.DOM.styleSheetLoader.load(skinUiCss,SkinLoaded_fireSkinLoaded(editor),SkinLoaded_fireSkinLoadError(editor,"Skin could not be loaded")):SkinLoaded_fireSkinLoaded(editor)()}function setToolbar(editor,uiComponents,rawUiConfig,backstage){var comp=uiComponents.outerContainer,toolbarConfig=rawUiConfig.toolbar,toolbarButtonsConfig=rawUiConfig.buttons;if(isArrayOf(toolbarConfig,isString)){var toolbars=toolbarConfig.map(function(t){var config={toolbar:t,buttons:toolbarButtonsConfig,allowToolbarGroups:rawUiConfig.allowToolbarGroups};return identifyButtons(editor,config,{backstage:backstage},Option.none())});OuterContainer.setToolbars(comp,toolbars)}else OuterContainer.setToolbar(comp,identifyButtons(editor,rawUiConfig,{backstage:backstage},Option.none()))}function setupEvents(editor){function resize(e){var docEle=editor.getDoc().documentElement,outer=lastWindowDimensions.get(),inner=lastDocumentDimensions.get();outer.left()!==contentWindow.innerWidth||outer.top()!==contentWindow.innerHeight?(lastWindowDimensions.set(Position(contentWindow.innerWidth,contentWindow.innerHeight)),Events_fireResizeContent(editor,e)):inner.left()===docEle.offsetWidth&&inner.top()===docEle.offsetHeight||(lastDocumentDimensions.set(Position(docEle.offsetWidth,docEle.offsetHeight)),Events_fireResizeContent(editor,e))}function scroll(e){return Events_fireScrollContent(editor,e)}var contentWindow=editor.getWin(),initialDocEle=editor.getDoc().documentElement,lastWindowDimensions=Cell(Position(contentWindow.innerWidth,contentWindow.innerHeight)),lastDocumentDimensions=Cell(Position(initialDocEle.offsetWidth,initialDocEle.offsetHeight));DOM.bind(contentWindow,"resize",resize),DOM.bind(contentWindow,"scroll",scroll);var elementLoad=capture$1(Element.fromDom(editor.getBody()),"load",resize);editor.on("remove",function(){elementLoad.unbind(),DOM.unbind(contentWindow,"resize",resize),DOM.unbind(contentWindow,"scroll",scroll)})}function getHeightWithFallback(editor){return function(editor){var baseHeight=getHeightSetting(editor),minHeight=getMinHeightSetting(editor),maxHeight=getMaxHeightSetting(editor);return Utils_parseToInt(baseHeight).map(function(height){return Utils_calcCappedSize(height,minHeight,maxHeight)})}(editor).getOr(getHeightSetting(editor))}function getWidth$1(editor){var baseWidth=getWidthSetting(editor),minWidth=getMinWidthSetting(editor),maxWidth=getMaxWidthSetting(editor);return Utils_parseToInt(baseWidth).map(function(width){return Utils_calcCappedSize(width,minWidth,maxWidth)})}function getTargetPosAndHeight(targetElm,isToolbarTop){var pos=box(targetElm);return{pos:isToolbarTop?pos.y():pos.bottom(),height:pos.height()}}function toggleFormat(editor,fmt){return function(){editor.execCommand("mceToggleFormat",!1,fmt)}}function registerButtons(editor){!function(editor){global$e.each([{name:"bold",text:"Bold",icon:"bold"},{name:"italic",text:"Italic",icon:"italic"},{name:"underline",text:"Underline",icon:"underline"},{name:"strikethrough",text:"Strikethrough",icon:"strike-through"},{name:"subscript",text:"Subscript",icon:"subscript"},{name:"superscript",text:"Superscript",icon:"superscript"}],function(btn,idx){editor.ui.registry.addToggleButton(btn.name,{tooltip:btn.text,icon:btn.icon,onSetup:onSetupFormatToggle(editor,btn.name),onAction:toggleFormat(editor,btn.name)})});for(var i=1;i<=6;i++){var name_1="h"+i;editor.ui.registry.addToggleButton(name_1,{text:name_1.toUpperCase(),tooltip:"Heading "+i,onSetup:onSetupFormatToggle(editor,name_1),onAction:toggleFormat(editor,name_1)})}}(editor),function(editor){global$e.each([{name:"cut",text:"Cut",action:"Cut",icon:"cut"},{name:"copy",text:"Copy",action:"Copy",icon:"copy"},{name:"paste",text:"Paste",action:"Paste",icon:"paste"},{name:"help",text:"Help",action:"mceHelp",icon:"help"},{name:"selectall",text:"Select all",action:"SelectAll",icon:"select-all"},{name:"newdocument",text:"New document",action:"mceNewDocument",icon:"new-document"},{name:"removeformat",text:"Clear formatting",action:"RemoveFormat",icon:"remove-formatting"},{name:"remove",text:"Remove",action:"Delete",icon:"remove"}],function(btn){editor.ui.registry.addButton(btn.name,{tooltip:btn.text,icon:btn.icon,onAction:function(){return editor.execCommand(btn.action)}})})}(editor),function(editor){global$e.each([{name:"blockquote",text:"Blockquote",action:"mceBlockQuote",icon:"quote"}],function(btn){editor.ui.registry.addToggleButton(btn.name,{tooltip:btn.text,icon:btn.icon,onAction:function(){return editor.execCommand(btn.action)},onSetup:onSetupFormatToggle(editor,btn.name)})})}(editor)}function toggleUndoRedoState(api,editor,type){function checkState(){return!!editor.undoManager&&editor.undoManager[type]()}function onUndoStateChange(){api.setDisabled(editor.mode.isReadOnly()||!checkState())}return api.setDisabled(!checkState()),editor.on("Undo Redo AddUndo TypingUndo ClearUndos SwitchMode",onUndoStateChange),function(){return editor.off("Undo Redo AddUndo TypingUndo ClearUndos SwitchMode",onUndoStateChange)}}function toggleVisualAidState(api,editor){function onVisualAid(e){api.setActive(e.hasVisual)}return api.setActive(editor.hasVisual),editor.on("VisualAid",onVisualAid),function(){return editor.off("VisualAid",onVisualAid)}}function nu$d(x,y){return{anchor:"makeshift",x:x,y:y}}function isTouchEvent$1(e){return"longpress"===e.type||0===e.type.indexOf("touch")}function transposeContentAreaContainer(element,pos){var containerPos=global$3.DOM.getPos(element);return function(pos,dx,dy){return nu$d(pos.x+dx,pos.y+dy)}(pos,containerPos.x,containerPos.y)}function getPointAnchor(editor,e){return"contextmenu"===e.type||"longpress"===e.type?editor.inline?function(e){if(isTouchEvent$1(e)){var touch=e.touches[0];return nu$d(touch.pageX,touch.pageY)}return nu$d(e.pageX,e.pageY)}(e):transposeContentAreaContainer(editor.getContentAreaContainer(),function(e){if(isTouchEvent$1(e)){var touch=e.touches[0];return nu$d(touch.clientX,touch.clientY)}return nu$d(e.clientX,e.clientY)}(e)):getSelectionAnchor(editor)}function getNodeAnchor$1(editor){return{anchor:"node",node:Option.some(Element.fromDom(editor.selection.getNode())),root:Element.fromDom(editor.getBody())}}function initAndShow(editor,e,buildMenu,backstage,contextmenu,isTriggeredByKeyboardEvent){var items=buildMenu(),anchorSpec=function(editor,e,isTriggeredByKeyboardEvent){return isTriggeredByKeyboardEvent?getNodeAnchor$1(editor):getPointAnchor(editor,e)}(editor,e,isTriggeredByKeyboardEvent);build$2(items,ItemResponse$1.CLOSE_ON_EXECUTE,backstage,!1).map(function(menuData){e.preventDefault(),InlineView.showMenuAt(contextmenu,anchorSpec,{menu:{markers:markers$1("normal")},data:menuData})})}function setupiOSOverrides(editor){function selectionReset(){global$2.setEditorTimeout(editor,function(){editor.selection.setRng(originalSelection)},10),unbindEventListeners()}var originalSelection=editor.selection.getRng();function preventMousedown(e){e.preventDefault(),e.stopImmediatePropagation()}function clearSelectionReset(){return unbindEventListeners()}editor.once("touchend",selectionReset),editor.on("mousedown",preventMousedown,!0),editor.once("longpresscancel",clearSelectionReset);var unbindEventListeners=function(){editor.off("touchend",selectionReset),editor.off("longpresscancel",clearSelectionReset),editor.off("mousedown",preventMousedown)}}function show(editor,e,items,backstage,contextmenu,isTriggeredByKeyboardEvent,highlightImmediately){var anchorSpec=function(editor,isTriggeredByKeyboardEvent,e){var anchorSpec=isTriggeredByKeyboardEvent?getNodeAnchor$1(editor):getPointAnchor(editor,e);return __assign({bubble:nu$8(0,12,bubbleAlignments$2),layouts:layouts,overrides:{maxWidthFunction:expandable$1(),maxHeightFunction:expandable()}},anchorSpec)}(editor,isTriggeredByKeyboardEvent,e);build$2(items,ItemResponse$1.CLOSE_ON_EXECUTE,backstage,!0).map(function(menuData){e.preventDefault(),InlineView.showMenuWithinBounds(contextmenu,anchorSpec,{menu:{markers:markers$1("normal"),highlightImmediately:highlightImmediately},data:menuData,type:"horizontal"},function(){return Option.some(getContextToolbarBounds(editor))}),editor.fire("contexttoolbar-hide")})}function initAndShow$1(editor,e,buildMenu,backstage,contextmenu,isTriggeredByKeyboardEvent){function open(){var items=buildMenu();show(editor,e,items,backstage,contextmenu,isTriggeredByKeyboardEvent,!(isAndroid||isiOS||isOSX&&isTouch))}var detection=detect$3(),isiOS=detection.os.isiOS(),isOSX=detection.os.isOSX(),isAndroid=detection.os.isAndroid(),isTouch=detection.deviceType.isTouch();if(!isOSX&&!isiOS||isTriggeredByKeyboardEvent)isAndroid&&!isTriggeredByKeyboardEvent&&editor.selection.setCursorLocation(e.target,0),open();else{var openiOS_1=function(){setupiOSOverrides(editor),open()};!function(editor,e){var selection=editor.selection;if(selection.isCollapsed()||e.touches.length<1)return!1;var touch_1=e.touches[0],rng=selection.getRng();return getFirstRect$1(editor.getWin(),Selection.domRange(rng)).exists(function(rngRect){return rngRect.left()<=touch_1.clientX&&rngRect.right()>=touch_1.clientX&&rngRect.top()<=touch_1.clientY&&rngRect.bottom()>=touch_1.clientY})}(editor,e)?(editor.once("selectionchange",openiOS_1),editor.once("touchend",function(){return editor.off("selectionchange",openiOS_1)})):openiOS_1()}}function patchPipeConfig(config){return"string"==typeof config?config.split(/[ ,]/):config}function isSeparator$1(item){return isString(item)?"|"===item:"separator"===item.type}function addContextMenuGroup(xs,groupItems){if(0===groupItems.length)return xs;var before=last(xs).filter(function(item){return!isSeparator$1(item)}).fold(function(){return[]},function(_){return[separator$3]});return xs.concat(before).concat(groupItems).concat([separator$3])}function setup$9(editor,lazySink,backstage){function hideContextMenu(_e){return InlineView.hide(contextmenu)}function showContextMenu(e){if(Settings$1_shouldNeverUseNative(editor)&&e.preventDefault(),!function(editor,e){return e.ctrlKey&&!Settings$1_shouldNeverUseNative(editor)}(editor,e)&&!Settings$1_isContextMenuDisabled(editor)){var isTriggeredByKeyboardEvent=function(editor,e){return"longpress"!==e.type&&(2!==e.button||e.target===editor.getBody()&&""===e.pointerType)}(editor,e);(isTouch()?initAndShow$1:initAndShow)(editor,e,function(){var selectedElement=isTriggeredByKeyboardEvent?editor.selection.getStart(!0):e.target,registry=editor.ui.registry.getAll(),menuConfig=Settings$1_getContextMenu(editor);return function(contextMenus,menuConfig,selectedElement){var sections=foldl(menuConfig,function(acc,name){if(has(contextMenus,name)){var items=contextMenus[name].update(selectedElement);if(isString(items))return addContextMenuGroup(acc,items.split(" "));if(0<items.length){var allItems=map(items,makeContextItem);return addContextMenuGroup(acc,allItems)}return acc}return acc.concat([name])},[]);return 0<sections.length&&isSeparator$1(sections[sections.length-1])&&sections.pop(),sections}(registry.contextMenus,menuConfig,selectedElement)},backstage,contextmenu,isTriggeredByKeyboardEvent)}}var isTouch=detect$3().deviceType.isTouch,contextmenu=build$1(InlineView.sketch({dom:{tag:"div"},lazySink:lazySink,onEscape:function(){return editor.focus()},onShow:function(){return backstage.setContextMenuState(!0)},onHide:function(){return backstage.setContextMenuState(!1)},fireDismissalEventInstead:{},inlineBehaviours:derive$1([config("dismissContextMenu",[run(dismissRequested(),function(comp,se){Sandboxing.close(comp),editor.focus()})])])}));editor.on("init",function(){var hideEvents="ResizeEditor ScrollContent ScrollWindow longpresscancel"+(isTouch()?"":" ResizeWindow");editor.on(hideEvents,hideContextMenu),editor.on("longpress contextmenu",showContextMenu)})}function subtract(change){return function(point){return point.translate(-change.left(),-change.top())}}function add$4(change){return function(point){return point.translate(change.left(),change.top())}}function transform$1(changes){return function(x,y){return foldl(changes,function(rest,f){return f(rest)},Position(x,y))}}function asFixed(coord,scroll,origin){return coord.fold(transform$1([add$4(origin),subtract(scroll)]),transform$1([subtract(scroll)]),transform$1([]))}function asAbsolute(coord,scroll,origin){return coord.fold(transform$1([add$4(origin)]),transform$1([]),transform$1([add$4(scroll)]))}function asOffset(coord,scroll,origin){return coord.fold(transform$1([]),transform$1([subtract(origin)]),transform$1([add$4(scroll),subtract(origin)]))}function toStyles(coord,scroll,origin){var stylesOpt=coord.fold(function(x,y){return{position:Option.some("absolute"),left:Option.some(x+"px"),top:Option.some(y+"px")}},function(x,y){return{position:Option.some("absolute"),left:Option.some(x-origin.left()+"px"),top:Option.some(y-origin.top()+"px")}},function(x,y){return{position:Option.some("fixed"),left:Option.some(x+"px"),top:Option.some(y+"px")}});return __assign({right:Option.none(),bottom:Option.none()},stylesOpt)}function absorb(partialCoord,originalCoord,scroll,origin){function absorbOne(stencil,nu){return function(optX,optY){var original=stencil(originalCoord,scroll,origin);return nu(optX.getOr(original.left()),optY.getOr(original.top()))}}return partialCoord.fold(absorbOne(asOffset,offset),absorbOne(asAbsolute,absolute$3),absorbOne(asFixed,fixed$1))}function getCoords(component,snapInfo,coord,delta){return function(component,snapsInfo){var element=component.element(),x=parseInt(get$2(element,snapsInfo.leftAttr),10),y=parseInt(get$2(element,snapsInfo.topAttr),10);return isNaN(x)||isNaN(y)?Option.none():Option.some(Position(x,y))}(component,snapInfo).fold(function(){return coord},function(fixed){return fixed$1(fixed.left()+delta.left(),fixed.top()+delta.top())})}function moveOrSnap(component,snapInfo,coord,delta,scroll,origin){var newCoord=getCoords(component,snapInfo,coord,delta),snap=snapInfo.mustSnap?findClosestSnap(component,snapInfo,newCoord,scroll,origin):findSnap(component,snapInfo,newCoord,scroll,origin),fixedCoord=asFixed(newCoord,scroll,origin);return function(component,snapsInfo,pt){var element=component.element();set$1(element,snapsInfo.leftAttr,pt.left()+"px"),set$1(element,snapsInfo.topAttr,pt.top()+"px")}(component,snapInfo,fixedCoord),snap.fold(function(){return{coord:fixed$1(fixedCoord.left(),fixedCoord.top()),extra:Option.none()}},function(spanned){return{coord:spanned.output(),extra:spanned.extra()}})}function stopDrag(component,snapInfo){!function(component,snapsInfo){var element=component.element();remove$1(element,snapsInfo.leftAttr),remove$1(element,snapsInfo.topAttr)}(component,snapInfo)}function findMatchingSnap(snaps,newCoord,scroll,origin){return findMap(snaps,function(snap){var sensor=snap.sensor();return function(coord1,coord2,xRange,yRange,scroll,origin){var a1=asAbsolute(coord1,scroll,origin),a2=asAbsolute(coord2,scroll,origin);return Math.abs(a1.left()-a2.left())<=xRange&&Math.abs(a1.top()-a2.top())<=yRange}(newCoord,sensor,snap.range().left(),snap.range().top(),scroll,origin)?Option.some({output:constant(absorb(snap.output(),newCoord,scroll,origin)),extra:snap.extra}):Option.none()})}function instigate(anyComponent,blocker){anyComponent.getSystem().addToGui(blocker),function(blocker){parent(blocker.element()).filter(isElement).each(function(root){getRaw(root,"z-index").each(function(zindex){set$1(root,"data-initial-z-index",zindex)}),set$2(root,"z-index",get$4(blocker.element(),"z-index"))})}(blocker)}function discard(blocker){!function(blocker){parent(blocker.element()).filter(isElement).each(function(root){var initZIndex=get$2(root,"data-initial-z-index");has$1(root,"data-initial-z-index")?set$2(root,"z-index",initZIndex):remove$6(root,"z-index"),remove$1(root,"data-initial-z-index")})}(blocker),blocker.getSystem().removeFromGui(blocker)}function createComponent(component,blockerClass,blockerEvents){return component.getSystem().build(Container.sketch({dom:{styles:{left:"0px",top:"0px",width:"100%",height:"100%",position:"fixed","z-index":"1000000000000000"},classes:[blockerClass]},events:blockerEvents}))}function getCurrentCoord(target){return function(oa,ob,oc,f){return oa.isSome()&&ob.isSome()&&oc.isSome()?Option.some(f(oa.getOrDie(),ob.getOrDie(),oc.getOrDie())):Option.none()}(getRaw(target,"left"),getRaw(target,"top"),getRaw(target,"position"),function(left,top,position){return("fixed"===position?fixed$1:offset)(parseInt(left,10),parseInt(top,10))}).getOrThunk(function(){var location=absolute(target);return absolute$3(location.left(),location.top())})}function calcNewCoord(component,optSnaps,currentCoord,scroll,origin,delta,startData){return function(component,coords,scroll,origin,startData){var bounds=startData.bounds,absoluteCoord=asAbsolute(coords,scroll,origin),newX=clamp(absoluteCoord.left(),bounds.x(),bounds.x()+bounds.width()-startData.width),newY=clamp(absoluteCoord.top(),bounds.y(),bounds.y()+bounds.height()-startData.height),newCoords=absolute$3(newX,newY);return coords.fold(function(){var offset$1=asOffset(newCoords,scroll,origin);return offset(offset$1.left(),offset$1.top())},function(){return newCoords},function(){var fixed=asFixed(newCoords,scroll,origin);return fixed$1(fixed.left(),fixed.top())})}(0,optSnaps.fold(function(){var translated=function(coord,deltaX,deltaY){return coord.fold(function(x,y){return offset(x+deltaX,y+deltaY)},function(x,y){return absolute$3(x+deltaX,y+deltaY)},function(x,y){return fixed$1(x+deltaX,y+deltaY)})}(currentCoord,delta.left(),delta.top()),fixedCoord=asFixed(translated,scroll,origin);return fixed$1(fixedCoord.left(),fixedCoord.top())},function(snapInfo){var snapping=moveOrSnap(component,snapInfo,currentCoord,delta,scroll,origin);return snapping.extra.each(function(extra){snapInfo.onSensor(component,extra)}),snapping.coord}),scroll,origin,startData)}function calcStartData(dragConfig,comp){return{bounds:dragConfig.getBounds(),height:getOuter$1(comp.element()),width:getOuter$2(comp.element())}}function move$1(component,dragConfig,dragState,dragMode,event){var delta=dragState.update(dragMode,event),dragStartData=dragState.getStartData().getOrThunk(function(){return calcStartData(dragConfig,component)});delta.each(function(dlt){!function(component,dragConfig,startData,delta){var target=dragConfig.getTarget(component.element());if(dragConfig.repositionTarget){var doc=owner(component.element()),scroll=get$8(doc),origin=getOrigin(target),currentCoord=getCurrentCoord(target),newCoord=calcNewCoord(component,dragConfig.snaps,currentCoord,scroll,origin,delta,startData),styles=toStyles(newCoord,0,origin);setOptions(target,styles)}dragConfig.onDrag(component,target,delta)}(component,dragConfig,dragStartData,dlt)})}function stop(component,blocker,dragConfig,dragState){blocker.each(discard),dragConfig.snaps.each(function(snapInfo){stopDrag(component,snapInfo)});var target=dragConfig.getTarget(component.element());dragState.reset(),dragConfig.onDrop(component,target)}function handlers(events){return function(dragConfig,dragState){function updateStartState(comp){dragState.setStartData(calcStartData(dragConfig,comp))}return derive(__spreadArrays([run(windowScroll(),function(comp){dragState.getStartData().each(function(){return updateStartState(comp)})})],events(dragConfig,dragState,updateStartState)))}}function events$g(dragConfig,dragState,updateStartState){return[run(mousedown(),function(component,simulatedEvent){if(0===simulatedEvent.event().raw().button){simulatedEvent.stop();var stop$1=function(){return stop(component,Option.some(blocker),dragConfig,dragState)},delayDrop=DelayedFunction(stop$1,200),dragApi={drop:stop$1,delayDrop:delayDrop.schedule,forceDrop:stop$1,move:function(event){delayDrop.cancel(),move$1(component,dragConfig,dragState,MouseData,event)}},blocker=createComponent(component,dragConfig.blockerClass,function(dragApi){return derive([run(mousedown(),dragApi.forceDrop),run(mouseup(),dragApi.drop),run(mousemove(),function(comp,simulatedEvent){dragApi.move(simulatedEvent.event())}),run(mouseout(),dragApi.delayDrop)])}(dragApi));updateStartState(component),instigate(component,blocker)}})]}function events$h(dragConfig,dragState,updateStartState){var blockerCell=Cell(Option.none());return[run(touchstart(),function(component,simulatedEvent){simulatedEvent.stop();function stop$1(){stop(component,blockerCell.get(),dragConfig,dragState),blockerCell.set(Option.none())}var dragApi={drop:stop$1,delayDrop:function(){},forceDrop:stop$1,move:function(event){move$1(component,dragConfig,dragState,TouchData,event)}},blocker=createComponent(component,dragConfig.blockerClass,function(dragApi){return derive([run(touchstart(),dragApi.forceDrop),run(touchend(),dragApi.drop),run(touchcancel(),dragApi.drop),run(touchmove(),function(comp,simulatedEvent){dragApi.move(simulatedEvent.event())})])}(dragApi));blockerCell.set(Option.some(blocker));updateStartState(component),instigate(component,blocker)}),run(touchmove(),function(component,simulatedEvent){simulatedEvent.stop(),move$1(component,dragConfig,dragState,TouchData,simulatedEvent.event())}),run(touchend(),function(component,simulatedEvent){simulatedEvent.stop(),stop(component,blockerCell.get(),dragConfig,dragState),blockerCell.set(Option.none())}),run(touchcancel(),function(component){stop(component,blockerCell.get(),dragConfig,dragState),blockerCell.set(Option.none())})]}function calcSnap(selectorOpt,td,x,y,width,height){return selectorOpt.fold(function(){return Dragging.snap({sensor:absolute$3(x-20,y-20),range:Position(width,height),output:absolute$3(Option.some(x),Option.some(y)),extra:{td:td}})},function(selectorHandle){var sensorLeft=x-20,sensorTop=y-20,rect=selectorHandle.element().dom().getBoundingClientRect();return Dragging.snap({sensor:absolute$3(sensorLeft,sensorTop),range:Position(40,40),output:absolute$3(Option.some(x-rect.width/2),Option.some(y-rect.height/2)),extra:{td:td}})})}function getSnapsConfig(getSnapPoints,cell,onChange){return{getSnapPoints:getSnapPoints,leftAttr:"data-drag-left",topAttr:"data-drag-top",onSensor:function(component,extra){var td=extra.td;!function(cellOpt,td){return cellOpt.exists(function(currentTd){return eq(currentTd,td)})}(cell.get(),td)&&(cell.set(Option.some(td)),onChange(td))},mustSnap:!0}}function createSelector(snaps){return record(Button.sketch({dom:{tag:"div",classes:["tox-selector"]},buttonBehaviours:derive$1([Dragging.config({mode:"mouseOrTouch",blockerClass:"blocker",snaps:snaps}),Unselecting.config({})]),eventOrder:{mousedown:["dragging","alloy.base.behaviour"],touchstart:["dragging","alloy.base.behaviour"]}}))}var ResizeTypes,alignMenuItems=[{title:"Left",icon:"align-left",format:"alignleft",command:"JustifyLeft"},{title:"Center",icon:"align-center",format:"aligncenter",command:"JustifyCenter"},{title:"Right",icon:"align-right",format:"alignright",command:"JustifyRight"},{title:"Justify",icon:"align-justify",format:"alignjustify",command:"JustifyFull"}],systemStackFonts=["-apple-system","Segoe UI","Roboto","Helvetica Neue","sans-serif"],legacyFontSizes={"8pt":"1","10pt":"2","12pt":"3","14pt":"4","18pt":"5","24pt":"6","36pt":"7"},defaultToolbar=[{name:"history",items:["undo","redo"]},{name:"styles",items:["styleselect"]},{name:"formatting",items:["bold","italic"]},{name:"alignment",items:["alignleft","aligncenter","alignright","alignjustify"]},{name:"indentation",items:["outdent","indent"]},{name:"permanent pen",items:["permanentpen"]},{name:"comments",items:["addcomment"]}],types={button:renderFromBridge(createToolbarButton,function(s,extras){return function(spec,providersBackstage){return renderToolbarButtonWith(spec,providersBackstage,[])}(s,extras.backstage.shared.providers)}),togglebutton:renderFromBridge(createToggleButton,function(s,extras){return function(spec,providersBackstage){return renderToolbarToggleButtonWith(spec,providersBackstage,[])}(s,extras.backstage.shared.providers)}),menubutton:renderFromBridge(createMenuButton,function(s,extras){return renderMenuButton(s,"tox-tbtn",extras.backstage,Option.none())}),splitbutton:renderFromBridge(function(spec){return asRaw("SplitButton",splitButtonSchema,spec)},function(s,extras){return renderSplitButton(s,extras.backstage.shared)}),grouptoolbarbutton:renderFromBridge(function(spec){return asRaw("GroupToolbarButton",groupToolbarButtonSchema,spec)},function(s,extras,editor){var _a,buttons=editor.ui.registry.getAll().buttons,attributes=((_a={})[Attribute]=isToolbarLocationTop(editor)?AttributeValue.TopToBottom:AttributeValue.BottomToTop,_a);switch(getToolbarMode(editor)){case ToolbarMode.floating:return function(spec,backstage,identifyButtons,attributes){var sharedBackstage=backstage.shared;return FloatingToolbarButton.sketch({lazySink:sharedBackstage.getSink,fetch:function(){return Future_nu(function(resolve){resolve(map(identifyButtons(spec.items),renderToolbarGroup))})},markers:{toggledClass:"tox-tbtn--enabled"},parts:{button:renderCommonStructure(spec.icon,spec.text,spec.tooltip,Option.none(),Option.none(),sharedBackstage.providers),toolbar:{dom:{tag:"div",classes:["tox-toolbar__overflow"],attributes:attributes}}}})}(s,extras.backstage,function(toolbar){return identifyButtons(editor,{buttons:buttons,toolbar:toolbar,allowToolbarGroups:!1},extras,Option.none())},attributes);default:throw new Error("Toolbar groups are only supported when using floating toolbar mode")}}),styleSelectButton:function(editor,extras){return function(editor,backstage){var dataset=__assign({type:"advanced"},backstage.styleselect);return createSelectButton(editor,backstage,getSpec$4(editor,dataset))}(editor,extras.backstage)},fontsizeSelectButton:function(editor,extras){return function(editor,backstage){return createSelectButton(editor,backstage,getSpec$2(editor))}(editor,extras.backstage)},fontSelectButton:function(editor,extras){return function(editor,backstage){return createSelectButton(editor,backstage,getSpec$1(editor))}(editor,extras.backstage)},formatButton:function(editor,extras){return function(editor,backstage){return createSelectButton(editor,backstage,getSpec$3(editor))}(editor,extras.backstage)},alignMenuButton:function(editor,extras){return function(editor,backstage){return createSelectButton(editor,backstage,getSpec(editor))}(editor,extras.backstage)}},bespokeButtons={styleselect:types.styleSelectButton,fontsizeselect:types.fontsizeSelectButton,fontselect:types.fontSelectButton,formatselect:types.formatButton,align:types.alignMenuButton},identifyButtons=function(editor,toolbarConfig,extras,prefixes){var toolbarGroups=createToolbar(toolbarConfig),groups=map(toolbarGroups,function(group){var items=bind(group.items,function(toolbarItem){return 0===toolbarItem.trim().length?[]:lookupButton(editor,toolbarConfig.buttons,toolbarItem,toolbarConfig.allowToolbarGroups,extras,prefixes).toArray()});return{title:Option.from(editor.translate(group.name)),items:items}});return filter(groups,function(group){return 0<group.items.length})},bubbleAlignments$1={valignCentre:[],alignCentre:[],alignLeft:["tox-pop--align-left"],alignRight:["tox-pop--align-right"],right:["tox-pop--right"],left:["tox-pop--left"],bottom:["tox-pop--bottom"],top:["tox-pop--top"]},anchorOverrides={maxHeightFunction:expandable(),maxWidthFunction:expandable$1()},desktopAnchorSpecLayouts={onLtr:function(){return[north$1,south$1,northeast$1,southeast$1,northwest$1,southwest$1,north$3,south$3,northeast$3,southeast$3,northwest$3,southwest$3]},onRtl:function(){return[north$1,south$1,northwest$1,southwest$1,northeast$1,southeast$1,north$3,south$3,northwest$3,southwest$3,northeast$3,southeast$3]}},mobileAnchorSpecLayouts={onLtr:function(){return[south$1,southeast$1,southwest$1,northeast$1,northwest$1,north$1,north$3,south$3,northeast$3,southeast$3,northwest$3,southwest$3]},onRtl:function(){return[south$1,southwest$1,southeast$1,northwest$1,northeast$1,north$1,north$3,south$3,northwest$3,southwest$3,northeast$3,southeast$3]}},ContextToolbar_register=function(editor,registryContextToolbars,sink,extras){function getBounds(){return getContextToolbarBounds(editor)}function shouldContextToolbarHide(){if(isTouch()&&extras.backstage.isContextMenuOpen())return!0;var lastElementBounds=function(){var nodeBounds=lastElement.get().map(function(ele){return ele.getBoundingClientRect()}).getOrThunk(function(){return editor.selection.getRng().getBoundingClientRect()}),diffTop=editor.inline?get$8().top():absolute$1(Element.fromDom(editor.getBody())).y();return{y:nodeBounds.top+diffTop,bottom:nodeBounds.bottom+diffTop}}(),contextToolbarBounds=getBounds();return!function(aTop,aBottom,bTop,bBottom){return Math.max(aTop,bTop)<=Math.min(aBottom,bBottom)}(lastElementBounds.y,lastElementBounds.bottom,contextToolbarBounds.y(),contextToolbarBounds.bottom())}function forceHide(){InlineView.hide(contextbar)}function hideOrRepositionIfNecessary(){lastAnchor.get().each(function(anchor){var contextBarEle=contextbar.element();remove$6(contextBarEle,"display"),shouldContextToolbarHide()?set$2(contextBarEle,"display","none"):Positioning.positionWithinBounds(sink,anchor,contextbar,Option.some(getBounds()))})}function wrapInPopDialog(toolbarSpec){return{dom:{tag:"div",classes:["tox-pop__dialog"]},components:[toolbarSpec],behaviours:derive$1([Keying.config({mode:"acyclic"}),config("pop-dialog-wrap-events",[runOnAttached(function(comp){editor.shortcuts.add("ctrl+F9","focus statusbar",function(){return Keying.focusIn(comp)})}),runOnDetached(function(comp){editor.shortcuts.remove("ctrl+F9")})])])}}var isTouch=detect$3().deviceType.isTouch,contextbar=build$1(function(spec){var stack=Cell([]);return InlineView.sketch({dom:{tag:"div",classes:["tox-pop"]},fireDismissalEventInstead:{event:"doNotDismissYet"},onShow:function(comp){stack.set([]),InlineView.getContent(comp).each(function(c){remove$6(c.element(),"visibility")}),remove$4(comp.element(),"tox-pop--resizing"),remove$6(comp.element(),"width")},inlineBehaviours:derive$1([config("context-toolbar-events",[runOnSource(transitionend(),function(comp,se){InlineView.getContent(comp).each(function(c){}),remove$4(comp.element(),"tox-pop--resizing"),remove$6(comp.element(),"width")}),run(changeSlideEvent,function(comp,se){remove$6(comp.element(),"width");var currentWidth=get$7(comp.element());InlineView.setContent(comp,se.event().contents()),add$2(comp.element(),"tox-pop--resizing");var newWidth=get$7(comp.element());set$2(comp.element(),"width",currentWidth+"px"),InlineView.getContent(comp).each(function(newContents){se.event().focus().bind(function(f){return focus$1(f),search(comp.element())}).orThunk(function(){return Keying.focusIn(newContents),active()})}),global$2.setTimeout(function(){set$2(comp.element(),"width",newWidth+"px")},0)}),run(forwardSlideEvent,function(comp,se){InlineView.getContent(comp).each(function(oldContents){stack.set(stack.get().concat([{bar:oldContents,focus:active()}]))}),emitWith(comp,changeSlideEvent,{contents:se.event().forwardContents(),focus:Option.none()})}),run(backSlideEvent,function(comp,se){last(stack.get()).each(function(last){stack.set(stack.get().slice(0,stack.get().length-1)),emitWith(comp,changeSlideEvent,{contents:premade$1(last.bar),focus:last.focus})})})]),Keying.config({mode:"special",onEscape:function(comp){return last(stack.get()).fold(function(){return spec.onEscape()},function(_){return emit(comp,backSlideEvent),Option.some(!0)})}})]),lazySink:function(){return Result.value(spec.sink)}})}({sink:sink,onEscape:function(){return editor.focus(),Option.some(!0)}})),lastAnchor=Cell(Option.none()),lastElement=Cell(Option.none()),timer=Cell(null),getScopes=cached(function(){return ToolbarScopes_categorise(registryContextToolbars,function(toolbarApi){var alloySpec=buildToolbar(toolbarApi);emitWith(contextbar,forwardSlideEvent,{forwardContents:wrapInPopDialog(alloySpec)})})}),buildToolbar=function(ctx){var allButtons,initGroups,buttons=editor.ui.registry.getAll().buttons,toolbarType=getToolbarMode(editor)===ToolbarMode.scrolling?ToolbarMode.scrolling:ToolbarMode.default,scopes=getScopes();return"contexttoolbar"===ctx.type?(allButtons=__assign(__assign({},buttons),scopes.formNavigators),initGroups=identifyButtons(editor,{buttons:allButtons,toolbar:ctx.items,allowToolbarGroups:!1},extras,Option.some(["form:"])),renderToolbar({type:toolbarType,uid:generate$1("context-toolbar"),initGroups:initGroups,onEscape:Option.none,cyclicKeying:!0})):ContextForm_renderContextForm(toolbarType,ctx,extras.backstage)};editor.on("contexttoolbar-show",function(e){var scopes=getScopes();get(scopes.lookupTable,e.toolbarKey).each(function(ctx){launchContext(ctx,e.target===editor?Option.none():Option.some(e)),InlineView.getContent(contextbar).each(Keying.focusIn)})});function getAnchor(position,element){var anchorage="node"===position?extras.backstage.shared.anchors.node(element):extras.backstage.shared.anchors.cursor();return deepMerge(anchorage,function(position,isTouch){return"line"===position?{bubble:nu$8(12,0,bubbleAlignments$1),layouts:{onLtr:function(){return[east$1]},onRtl:function(){return[west$1]}},overrides:anchorOverrides}:{bubble:nu$8(0,12,bubbleAlignments$1),layouts:isTouch?mobileAnchorSpecLayouts:desktopAnchorSpecLayouts,overrides:anchorOverrides}}(position,isTouch()))}function launchContextToolbar(){if(editor.hasFocus()){var scopes=getScopes();ToolbarLookup_lookup(scopes,editor).fold(function(){lastAnchor.set(Option.none()),InlineView.hide(contextbar)},function(info){launchContext(info.toolbarApi,Option.some(info.elem.dom()))})}}function resetTimer(t){clearTimer(),timer.set(t)}var launchContext=function(toolbarApi,elem){if(clearTimer(),!isTouch()||!extras.backstage.isContextMenuOpen()){var toolbarSpec=buildToolbar(toolbarApi),sElem=elem.map(Element.fromDom),anchor=getAnchor(toolbarApi.position,sElem);lastAnchor.set(Option.some(anchor)),lastElement.set(elem);var contextBarEle=contextbar.element();remove$6(contextBarEle,"display"),InlineView.showWithinBounds(contextbar,anchor,wrapInPopDialog(toolbarSpec),function(){return Option.some(getBounds())}),shouldContextToolbarHide()&&set$2(contextBarEle,"display","none")}},clearTimer=function(){var current=timer.get();null!==current&&(global$2.clearTimeout(current),timer.set(null))};editor.on("init",function(){editor.on("contexttoolbar-hide",forceHide),editor.on("ScrollContent ScrollWindow longpress",hideOrRepositionIfNecessary),editor.on("click keyup focus SetContent ObjectResized ResizeEditor",function(){resetTimer(global$2.setEditorTimeout(editor,launchContextToolbar,0))}),editor.on("focusout",function(e){global$2.setEditorTimeout(editor,function(){search(sink.element()).isNone()&&search(contextbar.element()).isNone()&&(lastAnchor.set(Option.none()),InlineView.hide(contextbar))},0)}),editor.on("SwitchMode",function(){editor.mode.isReadOnly()&&(lastAnchor.set(Option.none()),InlineView.hide(contextbar))}),editor.on("NodeChange",function(e){search(contextbar.element()).fold(function(){resetTimer(global$2.setEditorTimeout(editor,launchContextToolbar,0))},function(_){})})})},Events$1_setup=function(editor,mothership,uiMothership){function broadcastEvent(name,evt){each([mothership,uiMothership],function(ship){ship.broadcastEvent(name,evt)})}function broadcastOn(channel,message){each([mothership,uiMothership],function(ship){ship.broadcastOn([channel],message)})}function fireDismissPopups(evt){return broadcastOn(dismissPopups(),{target:evt.target()})}function onContentClick(raw){return broadcastOn(dismissPopups(),{target:Element.fromDom(raw.target)})}function onContentMouseup(raw){0===raw.button&&broadcastOn(mouseReleased(),{target:Element.fromDom(raw.target)})}function onWindowScroll(evt){return broadcastEvent(windowScroll(),fromRawEvent$1(evt))}function onWindowResize(evt){broadcastOn(repositionPopups(),{}),broadcastEvent(windowResize(),fromRawEvent$1(evt))}function onEditorResize(){return broadcastOn(repositionPopups(),{})}var onTouchstart=bind$3(Element.fromDom(domGlobals.document),"touchstart",fireDismissPopups),onTouchmove=bind$3(Element.fromDom(domGlobals.document),"touchmove",function(evt){return broadcastEvent(documentTouchmove(),evt)}),onTouchend=bind$3(Element.fromDom(domGlobals.document),"touchend",function(evt){return broadcastEvent(documentTouchend(),evt)}),onMousedown=bind$3(Element.fromDom(domGlobals.document),"mousedown",fireDismissPopups),onMouseup=bind$3(Element.fromDom(domGlobals.document),"mouseup",function(evt){0===evt.raw().button&&broadcastOn(mouseReleased(),{target:evt.target()})});editor.on("PostRender",function(){editor.on("click",onContentClick),editor.on("tap",onContentClick),editor.on("mouseup",onContentMouseup),editor.on("ScrollWindow",onWindowScroll),editor.on("ResizeWindow",onWindowResize),editor.on("ResizeEditor",onEditorResize)}),editor.on("remove",function(){editor.off("click",onContentClick),editor.off("tap",onContentClick),editor.off("mouseup",onContentMouseup),editor.off("ScrollWindow",onWindowScroll),editor.off("ResizeWindow",onWindowResize),editor.off("ResizeEditor",onEditorResize),onMousedown.unbind(),onTouchstart.unbind(),onTouchmove.unbind(),onTouchend.unbind(),onMouseup.unbind()}),editor.on("detach",function(){detachSystem(mothership),detachSystem(uiMothership),mothership.destroy(),uiMothership.destroy()})},parts$d=AlloyParts,partType$1=PartType,schema$r=constant([defaulted$1("shell",!1),strict$1("makeItem"),defaulted$1("setupItem",noop),SketchBehaviours_field("listBehaviours",[Replacing])]),itemsPart=optional({name:"items",overrides:function(){return{behaviours:derive$1([Replacing.config({})])}}}),parts$e=constant([itemsPart]),CustomList=composite$1({name:constant("CustomList")(),configFields:schema$r(),partFields:parts$e(),factory:function(detail,components,spec,external){var extra=detail.shell?{behaviours:[Replacing.config({})],components:[]}:{behaviours:[],components:components},getListContainer=function(component){return detail.shell?Option.some(component):getPart(component,detail,"items")};return{uid:detail.uid,dom:detail.dom,components:extra.components,behaviours:augment(detail.listBehaviours,extra.behaviours),apis:{setItems:function(list,items){getListContainer(list).fold(function(){throw domGlobals.console.error("Custom List was defined to not be a shell, but no item container was specified in components"),new Error("Custom List was defined to not be a shell, but no item container was specified in components")},function(container){var itemComps=Replacing.contents(container),numListsRequired=items.length,numListsToAdd=numListsRequired-itemComps.length,itemsToAdd=0<numListsToAdd?function(num,f){for(var r=[],i=0;i<num;i++)r.push(f(i));return r}(numListsToAdd,function(){return detail.makeItem()}):[],itemsToRemove=itemComps.slice(numListsRequired);each(itemsToRemove,function(item){return Replacing.remove(container,item)}),each(itemsToAdd,function(item){return Replacing.append(container,item)});var builtLists=Replacing.contents(container);each(builtLists,function(item,i){detail.setupItem(list,item,items[i],i)})})}}}},apis:{setItems:function(apis,list,items){apis.setItems(list,items)}}}),morphAdt=Adt_generate([{static:[]},{absolute:["positionCss"]},{fixed:["positionCss"]}]),refresh$4=function(component,config,state){component.getSystem().isConnected()&&function(component,config,state){var viewport=config.lazyViewport(component),isDocked=state.isDocked();isDocked&&updateVisibility(component,config,state,viewport),getMorph(component,config,viewport,state).each(function(morph){state.setDocked(!isDocked),morph.fold(function(){return morphToStatic(component,config)},function(position){return morphToCoord(component,config,position)},function(position){updateVisibility(component,config,state,viewport,!0),morphToCoord(component,config,position)})})}(component,config,state)},DockingApis=Object.freeze({__proto__:null,refresh:refresh$4,reset:reset,isDocked:function(component,config,state){return state.isDocked()}}),ActiveDocking=Object.freeze({__proto__:null,events:function(dockInfo,dockState){return derive([runOnSource(transitionend(),function(component,simulatedEvent){dockInfo.contextual.each(function(contextInfo){has$2(component.element(),contextInfo.transitionClass)&&(remove$5(component.element(),[contextInfo.transitionClass,contextInfo.fadeInClass]),(dockState.isVisible()?contextInfo.onShown:contextInfo.onHidden)(component));simulatedEvent.stop()})}),run(windowScroll(),function(component,_){refresh$4(component,dockInfo,dockState)}),run(windowResize(),function(component,_){reset(component,dockInfo,dockState)})])}}),DockingSchema=[optionObjOf("contextual",[strictString("fadeInClass"),strictString("fadeOutClass"),strictString("transitionClass"),strictFunction("lazyContext"),onHandler("onShow"),onHandler("onShown"),onHandler("onHide"),onHandler("onHidden")]),defaultedFunction("lazyViewport",win),function(key,fallback,schema){return defaultedOf(key,fallback,arrOf(schema))}("modes",["top","bottom"],string),onHandler("onDocked"),onHandler("onUndocked")],Docking=create$1({fields:DockingSchema,name:"docking",active:ActiveDocking,apis:DockingApis,state:Object.freeze({__proto__:null,init:function(){var docked=Cell(!1),visible=Cell(!0),initialBounds=Cell(Option.none());return nu$5({isDocked:function(){return docked.get()},setDocked:function(state){return docked.set(state)},getInitialPosition:function(){return initialBounds.get()},setInitialPosition:function(pos){return initialBounds.set(pos)},isVisible:function(){return visible.get()},setVisible:function(state){return visible.set(state)},readState:function(){return"docked:  "+docked.get()+", visible: "+visible.get()}})}})}),visibility={fadeInClass:"tox-editor-dock-fadein",fadeOutClass:"tox-editor-dock-fadeout",transitionClass:"tox-editor-dock-transition"},StickyHeader=Object.freeze({__proto__:null,setup:function(editor,lazyHeader){editor.inline||(isToolbarLocationTop(editor)||editor.on("ResizeEditor",function(){lazyHeader().each(Docking.reset)}),editor.on("ResizeWindow ResizeEditor",function(){lazyHeader().each(function(header){return updateIframeContentFlow(header,isToolbarLocationTop(editor))})}),editor.on("SkinLoaded",function(){lazyHeader().each(function(comp){Docking.isDocked(comp)?Docking.reset(comp):Docking.refresh(comp)})}),editor.on("FullscreenStateChanged",function(){lazyHeader().each(Docking.reset)})),editor.on("AfterScrollIntoView",function(e){lazyHeader().each(function(header){Docking.refresh(header);var headerElem=header.element();isVisible(headerElem)&&function(e,containerHeader){var doc=owner(containerHeader),viewHeight=doc.dom().defaultView.innerHeight,scrollPos=get$8(doc),markerElement=Element.fromDom(e.elm),markerPos=absolute$1(markerElement),markerHeight=get$6(markerElement),markerTop=markerPos.y(),markerBottom=markerTop+markerHeight,editorHeaderPos=absolute(containerHeader),editorHeaderHeight=get$6(containerHeader),editorHeaderTop=editorHeaderPos.top(),editorHeaderBottom=editorHeaderTop+editorHeaderHeight,editorHeaderDockedAtTop=Math.abs(editorHeaderTop-scrollPos.top())<2,editorHeaderDockedAtBottom=Math.abs(editorHeaderBottom-(scrollPos.top()+viewHeight))<2;if(editorHeaderDockedAtTop&&markerTop<editorHeaderBottom)to(scrollPos.left(),markerTop-editorHeaderHeight,doc);else if(editorHeaderDockedAtBottom&&editorHeaderTop<markerBottom){var y=markerTop-viewHeight+markerHeight+editorHeaderHeight;to(scrollPos.left(),y,doc)}}(e,headerElem)})}),editor.on("PostRender",function(){updateEditorClasses(editor,!1)})},isDocked:function(lazyHeader){return lazyHeader().map(Docking.isDocked).getOr(!1)},getBehaviours:getBehaviours$2}),setup$5=noop,isDocked$2=never,getBehaviours$3=constant([]),StaticHeader=Object.freeze({__proto__:null,setup:setup$5,isDocked:isDocked$2,getBehaviours:getBehaviours$3}),SilverMenubar=single$2({factory:function(detail,spec){var apis={focus:Keying.focusIn,setMenus:function(comp,menus){var newMenus=map(menus,function(m){var buttonSpec={type:"menubutton",text:m.text,fetch:function(callback){callback(m.getItems())}},internal=createMenuButton(buttonSpec).mapError(function(errInfo){return formatError(errInfo)}).getOrDie();return renderMenuButton(internal,"tox-mbtn",spec.backstage,Option.some("menuitem"))});Replacing.set(comp,newMenus)}};return{uid:detail.uid,dom:detail.dom,components:[],behaviours:derive$1([Replacing.config({}),config("menubar-events",[runOnAttached(function(component){detail.onSetup(component)}),run(mouseover(),function(comp,se){descendant$1(comp.element(),".tox-mbtn--active").each(function(activeButton){closest$3(se.event().target(),".tox-mbtn").each(function(hoveredButton){eq(activeButton,hoveredButton)||comp.getSystem().getByDom(activeButton).each(function(activeComp){comp.getSystem().getByDom(hoveredButton).each(function(hoveredComp){Dropdown.expand(hoveredComp),Dropdown.close(activeComp),Focusing.focus(hoveredComp)})})})})}),run(focusShifted(),function(comp,se){se.event().prevFocus().bind(function(prev){return comp.getSystem().getByDom(prev).toOption()}).each(function(prev){se.event().newFocus().bind(function(nu){return comp.getSystem().getByDom(nu).toOption()}).each(function(nu){Dropdown.isOpen(prev)&&(Dropdown.expand(nu),Dropdown.close(prev))})})})]),Keying.config({mode:"flow",selector:".tox-mbtn",onEscape:function(comp){return detail.onEscape(comp),Option.some(!0)}}),Tabstopping.config({})]),apis:apis,domModification:{attributes:{role:"menubar"}}}},name:"silver.Menubar",configFields:[strict$1("dom"),strict$1("uid"),strict$1("onEscape"),strict$1("backstage"),defaulted$1("onSetup",noop)],apis:{focus:function(apis,comp){apis.focus(comp)},setMenus:function(apis,comp,menus){apis.setMenus(comp,menus)}}}),schema$s=[field$1("slotBehaviours",[])],make$7=function(detail,components){function getSlotNames(_){return getAllPartNames(detail)}function onSlot(f,def){return function(container,key){return getPart(container,detail,key).map(function(slot){return f(slot,key)}).getOr(def)}}function doShowing(comp,key){return"true"!==get$2(comp.element(),"aria-hidden")}var f,isShowing=onSlot(doShowing,!1),hideSlot=onSlot(function(comp,key){if(doShowing(comp)){var element=comp.element();set$2(element,"display","none"),set$1(element,"aria-hidden","true"),emitWith(comp,slotVisibility(),{name:key,visible:!1})}}),hideSlots=(f=hideSlot,function(container,keys){each(keys,function(key){return f(container,key)})}),showSlot=onSlot(function(comp,key){if(!doShowing(comp)){var element=comp.element();remove$6(element,"display"),remove$1(element,"aria-hidden"),emitWith(comp,slotVisibility(),{name:key,visible:!0})}}),apis={getSlotNames:getSlotNames,getSlot:function(container,key){return getPart(container,detail,key)},isShowing:isShowing,hideSlot:hideSlot,hideAllSlots:function(container){return hideSlots(container,getSlotNames())},showSlot:showSlot};return{uid:detail.uid,dom:detail.dom,components:components,behaviours:get$c(detail.slotBehaviours),apis:apis}},slotApis=map$1({getSlotNames:function(apis,c){return apis.getSlotNames(c)},getSlot:function(apis,c,key){return apis.getSlot(c,key)},isShowing:function(apis,c,key){return apis.isShowing(c,key)},hideSlot:function(apis,c,key){return apis.hideSlot(c,key)},hideAllSlots:function(apis,c){return apis.hideAllSlots(c)},showSlot:function(apis,c,key){return apis.showSlot(c,key)}},function(value){return makeApi(value)}),SlotContainer=__assign(__assign({},slotApis),{sketch:function(sSpec){var record,parts=(record=[],{slot:function(name,config){return record.push(name),generateOne("container",getPartName$1(name),config)},record:function(){return record}}),spec=sSpec(parts),partNames=parts.record(),fieldParts=map(partNames,function(n){return required({name:n,pname:getPartName$1(n)})});return composite("container",schema$s,fieldParts,make$7,spec)}}),sidebarSchema=objOf([optionString("icon"),optionString("tooltip"),defaultedFunction("onShow",noop),defaultedFunction("onHide",noop),defaultedFunction("onSetup",function(){return noop})]),fixSize=generate$1("FixSizeEvent"),autoSize=generate$1("AutoSizeEvent"),partMenubar=partType$1.optional({factory:SilverMenubar,name:"menubar",schema:[strict$1("backstage")]}),partMultipleToolbar=partType$1.optional({factory:{sketch:function(spec){return CustomList.sketch({uid:spec.uid,dom:spec.dom,listBehaviours:derive$1([Keying.config({mode:"acyclic",selector:".tox-toolbar"})]),makeItem:function(){return renderToolbar({type:spec.type,uid:generate$1("multiple-toolbar-item"),cyclicKeying:!1,initGroups:[],onEscape:function(){return Option.none()}})},setupItem:function(mToolbar,tc,data,index){Toolbar.setGroups(tc,data)},shell:!0})}},name:"multiple-toolbar",schema:[strict$1("dom"),strict$1("onEscape")]}),partToolbar=partType$1.optional({factory:{sketch:function(spec){return function(spec){return spec.type===ToolbarMode.sliding?renderSlidingMoreToolbar:spec.type===ToolbarMode.floating?renderFloatingMoreToolbar:renderToolbar}(spec)({type:spec.type,uid:spec.uid,onEscape:function(){return spec.onEscape(),Option.some(!0)},cyclicKeying:!1,initGroups:[],getSink:spec.getSink,backstage:spec.backstage,moreDrawerData:{lazyToolbar:spec.lazyToolbar,lazyMoreButton:spec.lazyMoreButton,lazyHeader:spec.lazyHeader},attributes:spec.attributes})}},name:"toolbar",schema:[strict$1("dom"),strict$1("onEscape"),strict$1("getSink")]}),partHeader=partType$1.optional({factory:{sketch:function(spec){var editor=spec.editor,getBehaviours=spec.sticky?getBehaviours$2:getBehaviours$3;return{uid:spec.uid,dom:spec.dom,components:spec.components,behaviours:derive$1(getBehaviours(editor,spec.getSink))}}},name:"header",schema:[strict$1("dom")]}),partSocket=partType$1.optional({name:"socket",schema:[strict$1("dom")]}),partSidebar=partType$1.optional({factory:{sketch:function(spec){return{uid:spec.uid,dom:{tag:"div",classes:["tox-sidebar"],attributes:{role:"complementary"}},components:[{dom:{tag:"div",classes:["tox-sidebar__slider"]},components:[],behaviours:derive$1([Tabstopping.config({}),Focusing.config({}),Sliding.config({dimension:{property:"width"},closedClass:"tox-sidebar--sliding-closed",openClass:"tox-sidebar--sliding-open",shrinkingClass:"tox-sidebar--sliding-shrinking",growingClass:"tox-sidebar--sliding-growing",onShrunk:function(slider){Composing.getCurrent(slider).each(SlotContainer.hideAllSlots),emit(slider,autoSize)},onGrown:function(slider){emit(slider,autoSize)},onStartGrow:function(slider){emitWith(slider,fixSize,{width:getRaw(slider.element(),"width").getOr("")})},onStartShrink:function(slider){emitWith(slider,fixSize,{width:get$7(slider.element())+"px"})}}),Replacing.config({}),Composing.config({find:function(comp){var children=Replacing.contents(comp);return head(children)}})])}],behaviours:derive$1([ComposingConfigs_childAt(0),config("sidebar-sliding-events",[run(fixSize,function(comp,se){set$2(comp.element(),"width",se.event().width())}),run(autoSize,function(comp,se){remove$6(comp.element(),"width")})])])}}},name:"sidebar",schema:[strict$1("dom")]}),partThrobber=partType$1.optional({factory:{sketch:function(spec){return{uid:spec.uid,dom:{tag:"div",attributes:{"aria-hidden":"true"},classes:["tox-throbber"],styles:{display:"none"}},behaviours:derive$1([Replacing.config({})]),components:[]}}},name:"throbber",schema:[strict$1("dom")]}),OuterContainer=composite$1({name:"OuterContainer",factory:function(detail,components,spec){var apis={getSocket:function(comp){return parts$d.getPart(comp,detail,"socket")},setSidebar:function(comp,panelConfigs){parts$d.getPart(comp,detail,"sidebar").each(function(sidebar){return setSidebar(sidebar,panelConfigs)})},toggleSidebar:function(comp,name){parts$d.getPart(comp,detail,"sidebar").each(function(sidebar){return function(sidebar,name){Composing.getCurrent(sidebar).each(function(slider){Composing.getCurrent(slider).each(function(slotContainer){Sliding.hasGrown(slider)?SlotContainer.isShowing(slotContainer,name)?Sliding.shrink(slider):(SlotContainer.hideAllSlots(slotContainer),SlotContainer.showSlot(slotContainer,name)):(SlotContainer.hideAllSlots(slotContainer),SlotContainer.showSlot(slotContainer,name),Sliding.grow(slider))})})}(sidebar,name)})},whichSidebar:function(comp){return parts$d.getPart(comp,detail,"sidebar").bind(whichSidebar).getOrNull()},getHeader:function(comp){return parts$d.getPart(comp,detail,"header")},getToolbar:function(comp){return parts$d.getPart(comp,detail,"toolbar")},setToolbar:function(comp,groups){parts$d.getPart(comp,detail,"toolbar").each(function(toolbar){toolbar.getApis().setGroups(toolbar,groups)})},setToolbars:function(comp,toolbars){parts$d.getPart(comp,detail,"multiple-toolbar").each(function(mToolbar){CustomList.setItems(mToolbar,toolbars)})},refreshToolbar:function(comp){parts$d.getPart(comp,detail,"toolbar").each(function(toolbar){return toolbar.getApis().refresh(toolbar)})},getThrobber:function(comp){return parts$d.getPart(comp,detail,"throbber")},focusToolbar:function(comp){parts$d.getPart(comp,detail,"toolbar").orThunk(function(){return parts$d.getPart(comp,detail,"multiple-toolbar")}).each(function(toolbar){Keying.focusIn(toolbar)})},setMenubar:function(comp,menus){parts$d.getPart(comp,detail,"menubar").each(function(menubar){SilverMenubar.setMenus(menubar,menus)})},focusMenubar:function(comp){parts$d.getPart(comp,detail,"menubar").each(function(menubar){SilverMenubar.focus(menubar)})}};return{uid:detail.uid,dom:detail.dom,components:components,apis:apis,behaviours:detail.behaviours}},configFields:[strict$1("dom"),strict$1("behaviours")],partFields:[partHeader,partMenubar,partToolbar,partMultipleToolbar,partSocket,partSidebar,partThrobber],apis:{getSocket:function(apis,comp){return apis.getSocket(comp)},setSidebar:function(apis,comp,panelConfigs){apis.setSidebar(comp,panelConfigs)},toggleSidebar:function(apis,comp,name){apis.toggleSidebar(comp,name)},whichSidebar:function(apis,comp){return apis.whichSidebar(comp)},getHeader:function(apis,comp){return apis.getHeader(comp)},getToolbar:function(apis,comp){return apis.getToolbar(comp)},setToolbar:function(apis,comp,grps){var groups=map(grps,function(grp){return renderToolbarGroup(grp)});apis.setToolbar(comp,groups)},setToolbars:function(apis,comp,ts){var renderedToolbars=map(ts,function(g){return map(g,renderToolbarGroup)});apis.setToolbars(comp,renderedToolbars)},refreshToolbar:function(apis,comp){return apis.refreshToolbar(comp)},getThrobber:function(apis,comp){return apis.getThrobber(comp)},setMenubar:function(apis,comp,menus){apis.setMenubar(comp,menus)},focusMenubar:function(apis,comp){apis.focusMenubar(comp)},focusToolbar:function(apis,comp){apis.focusToolbar(comp)}}}),defaultMenus={file:{title:"File",items:"newdocument restoredraft | preview | print | deleteallconversations"},edit:{title:"Edit",items:"undo redo | cut copy paste pastetext | selectall | searchreplace"},view:{title:"View",items:"code | visualaid visualchars visualblocks | spellchecker | preview fullscreen | showcomments"},insert:{title:"Insert",items:"image link media addcomment pageembed template codesample inserttable | charmap emoticons hr | pagebreak nonbreaking anchor toc | insertdatetime"},format:{title:"Format",items:"bold italic underline strikethrough superscript subscript codeformat | formats blockformats fontformats fontsizes align | forecolor backcolor | removeformat"},tools:{title:"Tools",items:"spellchecker spellcheckerlanguage | a11ycheck code wordcount"},table:{title:"Table",items:"inserttable | cell row column | advtablesort | tableprops deletetable"},help:{title:"Help",items:"help"}},SkinLoaded_fireSkinLoaded=function(editor){function done(){editor._skinLoaded=!0,Events_fireSkinLoaded(editor)}return function(){editor.initialized?done():editor.on("init",done)}},SkinLoaded_fireSkinLoadError=function(editor,err){return function(){return Events_fireSkinLoadError(editor,{message:err})}},iframe=curry(loadSkin,!1),inline=curry(loadSkin,!0),DOM=global$3.DOM,detection=detect$3(),isiOS12=detection.os.isiOS()&&detection.os.version.major<=12,Iframe={render:function(editor,uiComponents,rawUiConfig,backstage,args){var lastToolbarWidth=Cell(0);iframe(editor),function(element,guiSystem){attachSystemWith(element,guiSystem,after)}(Element.fromDom(args.targetNode),uiComponents.mothership),attachSystem(body(),uiComponents.uiMothership),editor.on("PostRender",function(){setToolbar(editor,uiComponents,rawUiConfig,backstage),lastToolbarWidth.set(editor.getWin().innerWidth),OuterContainer.setMenubar(uiComponents.outerContainer,identifyMenus(editor,rawUiConfig)),OuterContainer.setSidebar(uiComponents.outerContainer,rawUiConfig.sidebar),setupEvents(editor)});var socket=OuterContainer.getSocket(uiComponents.outerContainer).getOrDie("Could not find expected socket element");if(!0===isiOS12){setAll$1(socket.element(),{overflow:"scroll","-webkit-overflow-scrolling":"touch"});var limit=function(fn,rate){var timer=null;return{cancel:function(){null!==timer&&(domGlobals.clearTimeout(timer),timer=null)},throttle:function(){for(var args=[],_i=0;_i<arguments.length;_i++)args[_i]=arguments[_i];null===timer&&(timer=domGlobals.setTimeout(function(){fn.apply(null,args),timer=null},rate))}}}(function(){editor.fire("ScrollContent")},20);bind$3(socket.element(),"scroll",limit.throttle)}setupReadonlyModeSwitch(editor,uiComponents),editor.addCommand("ToggleSidebar",function(ui,value){OuterContainer.toggleSidebar(uiComponents.outerContainer,value),editor.fire("ToggleSidebar")}),editor.addQueryValueHandler("ToggleSidebar",function(){return OuterContainer.whichSidebar(uiComponents.outerContainer)});var toolbarMode=getToolbarMode(editor);return toolbarMode!==ToolbarMode.sliding&&toolbarMode!==ToolbarMode.floating||editor.on("ResizeWindow ResizeEditor ResizeContent",function(){var width=editor.getWin().innerWidth;width!==lastToolbarWidth.get()&&(OuterContainer.refreshToolbar(uiComponents.outerContainer),lastToolbarWidth.set(width))}),{iframeContainer:socket.element().dom(),editorContainer:uiComponents.outerContainer.element().dom()}}},Utils_calcCappedSize=function(size,minSize,maxSize){var minOverride=minSize.filter(function(min){return size<min}),maxOverride=maxSize.filter(function(max){return max<size});return minOverride.or(maxOverride).getOr(size)},Utils_parseToInt=function(val){return/^[0-9\.]+(|px)$/i.test(""+val)?Option.some(parseInt(""+val,10)):Option.none()},Utils_numToPx=function(val){return isNumber(val)?val+"px":val},Inline={render:function(editor,uiComponents,rawUiConfig,backstage,args){var floatContainer,mothership=uiComponents.mothership,uiMothership=uiComponents.uiMothership,outerContainer=uiComponents.outerContainer,DOM=global$3.DOM,useFixedToolbarContainer=useFixedContainer(editor),isSticky=isStickyToolbar(editor),targetElm=Element.fromDom(args.targetNode),editorMaxWidthOpt=getMaxWidthSetting(editor).or(getWidth$1(editor)),toolbarMode=getToolbarMode(editor),isSplitToolbar=toolbarMode===ToolbarMode.sliding||toolbarMode===ToolbarMode.floating,isToolbarTop=isToolbarLocationTop(editor),prevPosAndHeight=Cell(getTargetPosAndHeight(targetElm,isToolbarTop)),visible=Cell(!1);inline(editor);function repositionFloatingUiComponents(){uiMothership.broadcastOn([repositionPopups()],{})}function updateChromeUi(resetDocking){void 0===resetDocking&&(resetDocking=!1),isSplitToolbar&&OuterContainer.refreshToolbar(outerContainer),useFixedToolbarContainer||function(toolbar){var offset=isSplitToolbar?toolbar.fold(function(){return 0},function(tbar){return 1<tbar.components().length?get$6(tbar.components()[1].element()):0}):0,targetBounds=box(targetElm),top=isToolbarTop?targetBounds.y()-get$6(floatContainer.element())+offset:targetBounds.bottom();setAll$1(outerContainer.element(),{position:"absolute",top:Math.round(top)+"px",left:Math.round(targetBounds.x())+"px"});var maxWidth=editorMaxWidthOpt.getOrThunk(function(){var bodyMargin=Utils_parseToInt(get$4(body(),"margin-left")).getOr(0);return get$7(body())-targetBounds.x()+bodyMargin});set$2(floatContainer.element(),"max-width",maxWidth+"px")}(OuterContainer.getToolbar(outerContainer)),isSticky&&(resetDocking?Docking.reset(floatContainer):Docking.refresh(floatContainer)),repositionFloatingUiComponents()}function show(){visible.set(!0),set$2(outerContainer.element(),"display","flex"),DOM.addClass(editor.getBody(),"mce-edit-focus"),remove$6(uiMothership.element(),"display"),updateChromeUi()}function hide(){visible.set(!1),uiComponents.outerContainer&&(set$2(outerContainer.element(),"display","none"),DOM.removeClass(editor.getBody(),"mce-edit-focus")),set$2(uiMothership.element(),"display","none")}function render(){if(floatContainer)show();else{floatContainer=OuterContainer.getHeader(outerContainer).getOrDie();var uiContainer=function(editor){return fixedContainerElement(editor).getOr(body())}(editor);attachSystem(uiContainer,mothership),attachSystem(uiContainer,uiMothership),setToolbar(editor,uiComponents,rawUiConfig,backstage),OuterContainer.setMenubar(outerContainer,identifyMenus(editor,rawUiConfig)),show(),editor.on("activate",show),editor.on("deactivate",hide),editor.on("SkinLoaded ResizeWindow",function(){visible.get()&&updateChromeUi(!0)}),editor.on("NodeChange keydown",function(){global$2.requestAnimationFrame(function(){var posAndHeight=getTargetPosAndHeight(targetElm,isToolbarTop),prev=prevPosAndHeight.get();visible.get()&&(posAndHeight.pos!==prev.pos?(updateChromeUi(!0),prevPosAndHeight.set(posAndHeight)):posAndHeight.height!==prev.height&&(repositionFloatingUiComponents(),prevPosAndHeight.set(posAndHeight)))})}),editor.nodeChanged()}}return editor.on("focus",render),editor.on("blur hide",hide),editor.on("init",function(){editor.hasFocus()&&render()}),setupReadonlyModeSwitch(editor,uiComponents),{editorContainer:outerContainer.element().dom()}}},AlignmentButtons_register=function(editor){global$e.each([{name:"alignleft",text:"Align left",cmd:"JustifyLeft",icon:"align-left"},{name:"aligncenter",text:"Align center",cmd:"JustifyCenter",icon:"align-center"},{name:"alignright",text:"Align right",cmd:"JustifyRight",icon:"align-right"},{name:"alignjustify",text:"Justify",cmd:"JustifyFull",icon:"align-justify"}],function(item){editor.ui.registry.addToggleButton(item.name,{tooltip:item.text,onAction:function(){return editor.execCommand(item.cmd)},icon:item.icon,onSetup:onSetupFormatToggle(editor,item.name)})});var alignNoneToolbarButton_name="alignnone",alignNoneToolbarButton_text="No alignment",alignNoneToolbarButton_cmd="JustifyNone",alignNoneToolbarButton_icon="align-none";editor.ui.registry.addButton(alignNoneToolbarButton_name,{tooltip:alignNoneToolbarButton_text,onAction:function(){return editor.execCommand(alignNoneToolbarButton_cmd)},icon:alignNoneToolbarButton_icon})},SimpleControls_register=function(editor){registerButtons(editor),function(editor){global$e.each([{name:"bold",text:"Bold",action:"Bold",icon:"bold",shortcut:"Meta+B"},{name:"italic",text:"Italic",action:"Italic",icon:"italic",shortcut:"Meta+I"},{name:"underline",text:"Underline",action:"Underline",icon:"underline",shortcut:"Meta+U"},{name:"strikethrough",text:"Strikethrough",action:"Strikethrough",icon:"strike-through",shortcut:""},{name:"subscript",text:"Subscript",action:"Subscript",icon:"subscript",shortcut:""},{name:"superscript",text:"Superscript",action:"Superscript",icon:"superscript",shortcut:""},{name:"removeformat",text:"Clear formatting",action:"RemoveFormat",icon:"remove-formatting",shortcut:""},{name:"newdocument",text:"New document",action:"mceNewDocument",icon:"new-document",shortcut:""},{name:"cut",text:"Cut",action:"Cut",icon:"cut",shortcut:"Meta+X"},{name:"copy",text:"Copy",action:"Copy",icon:"copy",shortcut:"Meta+C"},{name:"paste",text:"Paste",action:"Paste",icon:"paste",shortcut:"Meta+V"},{name:"selectall",text:"Select all",action:"SelectAll",icon:"select-all",shortcut:"Meta+A"}],function(btn){editor.ui.registry.addMenuItem(btn.name,{text:btn.text,icon:btn.icon,shortcut:btn.shortcut,onAction:function(){return editor.execCommand(btn.action)}})}),editor.ui.registry.addMenuItem("codeformat",{text:"Code",icon:"sourcecode",onAction:toggleFormat(editor,"code")})}(editor)},UndoRedo_register=function(editor){!function(editor){editor.ui.registry.addMenuItem("undo",{text:"Undo",icon:"undo",shortcut:"Meta+Z",onSetup:function(api){return toggleUndoRedoState(api,editor,"hasUndo")},onAction:function(){return editor.execCommand("undo")}}),editor.ui.registry.addMenuItem("redo",{text:"Redo",icon:"redo",shortcut:"Meta+Y",onSetup:function(api){return toggleUndoRedoState(api,editor,"hasRedo")},onAction:function(){return editor.execCommand("redo")}})}(editor),function(editor){editor.ui.registry.addButton("undo",{tooltip:"Undo",icon:"undo",onSetup:function(api){return toggleUndoRedoState(api,editor,"hasUndo")},onAction:function(){return editor.execCommand("undo")}}),editor.ui.registry.addButton("redo",{tooltip:"Redo",icon:"redo",onSetup:function(api){return toggleUndoRedoState(api,editor,"hasRedo")},onAction:function(){return editor.execCommand("redo")}})}(editor)},VisualAid_register=function(editor){!function(editor){editor.ui.registry.addButton("visualaid",{tooltip:"Visual aids",text:"Visual aids",onAction:function(){return editor.execCommand("mceToggleVisualAid")}})}(editor),function(editor){editor.ui.registry.addToggleMenuItem("visualaid",{text:"Visual aids",onSetup:function(api){return toggleVisualAidState(api,editor)},onAction:function(){editor.execCommand("mceToggleVisualAid")}})}(editor)},IndentOutdent_register=function(editor){!function(editor){editor.ui.registry.addButton("outdent",{tooltip:"Decrease indent",icon:"outdent",onSetup:function(api){return function(api,editor){api.setDisabled(!editor.queryCommandState("outdent"));function onNodeChange(){api.setDisabled(!editor.queryCommandState("outdent"))}return editor.on("NodeChange",onNodeChange),function(){return editor.off("NodeChange",onNodeChange)}}(api,editor)},onAction:function(){return editor.execCommand("outdent")}}),editor.ui.registry.addButton("indent",{tooltip:"Increase indent",icon:"indent",onAction:function(){return editor.execCommand("indent")}})}(editor)},ComplexControls_register=function(editor,backstage){!function(editor,backstage){var menuItems=createMenuItems(0,backstage,getSpec(editor));editor.ui.registry.addNestedMenuItem("align",{text:backstage.shared.providers.translate("Align"),getSubmenuItems:function(){return menuItems.items.validateItems(menuItems.getStyleItems())}})}(editor,backstage),function(editor,backstage){var menuItems=createMenuItems(0,backstage,getSpec$1(editor));editor.ui.registry.addNestedMenuItem("fontformats",{text:backstage.shared.providers.translate("Fonts"),getSubmenuItems:function(){return menuItems.items.validateItems(menuItems.getStyleItems())}})}(editor,backstage),function(editor,backstage){var dataset=__assign({type:"advanced"},backstage.styleselect),menuItems=createMenuItems(0,backstage,getSpec$4(editor,dataset));editor.ui.registry.addNestedMenuItem("formats",{text:"Formats",getSubmenuItems:function(){return menuItems.items.validateItems(menuItems.getStyleItems())}})}(editor,backstage),function(editor,backstage){var menuItems=createMenuItems(0,backstage,getSpec$3(editor));editor.ui.registry.addNestedMenuItem("blockformats",{text:"Blocks",getSubmenuItems:function(){return menuItems.items.validateItems(menuItems.getStyleItems())}})}(editor,backstage),function(editor,backstage){var menuItems=createMenuItems(0,backstage,getSpec$2(editor));editor.ui.registry.addNestedMenuItem("fontsizes",{text:"Font sizes",getSubmenuItems:function(){return menuItems.items.validateItems(menuItems.getStyleItems())}})}(editor,backstage)},FormatControls_setup=function(editor,backstage){AlignmentButtons_register(editor),SimpleControls_register(editor),ComplexControls_register(editor,backstage),UndoRedo_register(editor),ColorSwatch.register(editor),VisualAid_register(editor),IndentOutdent_register(editor)},getSelectionAnchor=function(editor){return{anchor:"selection",root:Element.fromDom(editor.selection.getNode())}},layouts={onLtr:function(){return[south$1,southeast$1,southwest$1,northeast$1,northwest$1,north$1,north$3,south$3,northeast$3,southeast$3,northwest$3,southwest$3]},onRtl:function(){return[south$1,southwest$1,southeast$1,northwest$1,northeast$1,north$1,north$3,south$3,northwest$3,southwest$3,northeast$3,southeast$3]}},bubbleAlignments$2={valignCentre:[],alignCentre:[],alignLeft:["tox-pop--align-left"],alignRight:["tox-pop--align-right"],right:["tox-pop--right"],left:["tox-pop--left"],bottom:["tox-pop--bottom"],top:["tox-pop--top"]},Settings$1_shouldNeverUseNative=function(editor){return editor.settings.contextmenu_never_use_native||!1},Settings$1_getContextMenu=function(editor){return function(editor,name,defaultItems){var contextMenus=editor.ui.registry.getAll().contextMenus;return get(editor.settings,name).map(patchPipeConfig).getOrThunk(function(){return filter(patchPipeConfig(defaultItems),function(item){return has(contextMenus,item)})})}(editor,"contextmenu","link linkchecker image imagetools table spellchecker configurepermanentpen")},Settings$1_isContextMenuDisabled=function(editor){return!1===editor.getParam("contextmenu")},separator$3={type:"separator"},makeContextItem=function(item){if(isString(item))return item;switch(item.type){case"separator":return separator$3;case"submenu":return{type:"nestedmenuitem",text:item.text,icon:item.icon,getSubmenuItems:function(){var items=item.getSubmenuItems();return isString(items)?items:map(items,makeContextItem)}};default:return{type:"menuitem",text:item.text,icon:item.icon,onAction:function(f){return function(){return f()}}(item.onAction)}}},adt$c=Adt_generate([{offset:["x","y"]},{absolute:["x","y"]},{fixed:["x","y"]}]),offset=adt$c.offset,absolute$3=adt$c.absolute,fixed$1=adt$c.fixed,findClosestSnap=function(component,snapInfo,newCoord,scroll,origin){var snaps=snapInfo.getSnapPoints(component);return findMatchingSnap(snaps,newCoord,scroll,origin).orThunk(function(){return foldl(snaps,function(acc,snap){var sensor=snap.sensor(),deltas=function(coord1,coord2,xRange,yRange,scroll,origin){var a1=asAbsolute(coord1,scroll,origin),a2=asAbsolute(coord2,scroll,origin),left=Math.abs(a1.left()-a2.left()),top=Math.abs(a1.top()-a2.top());return Position(left,top)}(newCoord,sensor,snap.range().left(),snap.range().top(),scroll,origin);return acc.deltas.fold(function(){return{deltas:Option.some(deltas),snap:Option.some(snap)}},function(bestDeltas){return(deltas.left()+deltas.top())/2<=(bestDeltas.left()+bestDeltas.top())/2?{deltas:Option.some(deltas),snap:Option.some(snap)}:acc})},{deltas:Option.none(),snap:Option.none()}).snap.map(function(snap){return{output:constant(absorb(snap.output(),newCoord,scroll,origin)),extra:snap.extra}})})},findSnap=function(component,snapInfo,newCoord,scroll,origin){var snaps=snapInfo.getSnapPoints(component);return findMatchingSnap(snaps,newCoord,scroll,origin)},DraggingApis=Object.freeze({__proto__:null,snapTo:function(component,dragConfig,_state,snap){var target=dragConfig.getTarget(component.element());if(dragConfig.repositionTarget){var doc=owner(component.element()),scroll=get$8(doc),origin=getOrigin(target),snapPin=function(snap,scroll,origin){return{coord:absorb(snap.output(),snap.output(),scroll,origin),extra:snap.extra()}}(snap,scroll,origin),styles=toStyles(snapPin.coord,0,origin);setOptions(target,styles)}}}),SnapSchema=optionObjOf("snaps",[strict$1("getSnapPoints"),onHandler("onSensor"),strict$1("leftAttr"),strict$1("topAttr"),defaulted$1("lazyViewport",win),defaulted$1("mustSnap",!1)]),schema$t=[defaulted$1("useFixed",never),strict$1("blockerClass"),defaulted$1("getTarget",identity),defaulted$1("onDrag",noop),defaulted$1("repositionTarget",!0),defaulted$1("onDrop",noop),defaultedFunction("getBounds",win),SnapSchema],MouseData=Object.freeze({__proto__:null,getData:function(event){return Option.from(Position(event.x(),event.y()))},getDelta:function(old,nu){return Position(nu.left()-old.left(),nu.top()-old.top())}}),schema$u=__spreadArrays(schema$t,[output("dragger",{handlers:handlers(events$g)})]),TouchData=Object.freeze({__proto__:null,getData:function(event){var touches=event.raw().touches;return 1===touches.length?function(touches){var touch=touches[0];return Option.some(Position(touch.clientX,touch.clientY))}(touches):Option.none()},getDelta:function(old,nu){return Position(nu.left()-old.left(),nu.top()-old.top())}}),mouse=schema$u,touch=__spreadArrays(schema$t,[output("dragger",{handlers:handlers(events$h)})]),mouseOrTouch=__spreadArrays(schema$t,[output("dragger",{handlers:handlers(function(dragConfig,dragState,updateStartState){return __spreadArrays(events$g(dragConfig,dragState,updateStartState),events$h(dragConfig,dragState,updateStartState))})})]),DraggingBranches=Object.freeze({__proto__:null,mouse:mouse,touch:touch,mouseOrTouch:mouseOrTouch}),DragState=Object.freeze({__proto__:null,init:function(){var previous=Option.none(),startData=Option.none(),readState=constant({});return nu$5({readState:readState,reset:function(){previous=Option.none(),startData=Option.none()},update:function(mode,dragEvent){return mode.getData(dragEvent).bind(function(nuData){return function(mode,nu){var result=previous.map(function(old){return mode.getDelta(old,nu)});return previous=Option.some(nu),result}(mode,nuData)})},getStartData:function(){return startData},setStartData:function(data){startData=Option.some(data)}})}}),Dragging=createModes$1({branchKey:"mode",branches:DraggingBranches,name:"dragging",active:{events:function(dragConfig,dragState){return dragConfig.dragger.handlers(dragConfig,dragState)}},extra:{snap:MixedBag(["sensor","range","output"],["extra"])},state:DragState,apis:DraggingApis}),platform$1=detect$3(),TableSelectorHandles_setup=function(editor,sink){function getTopLeftSnap(td){var box=absolute$1(td);return calcSnap(memTopLeft.getOpt(sink),td,box.x(),box.y(),box.width(),box.height())}function getBottomRightSnap(td){var box=absolute$1(td);return calcSnap(memBottomRight.getOpt(sink),td,box.right(),box.bottom(),box.width(),box.height())}function snapTo(selector,cell,getSnapConfig,pos){var snap=getSnapConfig(cell);Dragging.snapTo(selector,snap),function(selector,cell,isAbove,isBelow){var cellRect=cell.dom().getBoundingClientRect();remove$6(selector.element(),"display");var viewportHeight=defaultView(Element.fromDom(editor.getBody())).dom().innerHeight,aboveViewport=isAbove(cellRect),belowViewport=isBelow(cellRect,viewportHeight);(aboveViewport||belowViewport)&&set$2(selector.element(),"display","none")}(selector,cell,function(rect){return rect[pos]<0},function(rect,viewportHeight){return rect[pos]>viewportHeight})}function snapTopLeft(cell){return snapTo(topLeft,cell,getTopLeftSnap,"top")}function snapBottomRight(cell){return snapTo(bottomRight,cell,getBottomRightSnap,"bottom")}var tlTds=Cell([]),brTds=Cell([]),isVisible=Cell(!1),startCell=Cell(Option.none()),finishCell=Cell(Option.none()),topLeftSnaps=getSnapsConfig(function(){return map(tlTds.get(),function(td){return getTopLeftSnap(td)})},startCell,function(start){finishCell.get().each(function(finish){editor.fire("TableSelectorChange",{start:start,finish:finish})})}),bottomRightSnaps=getSnapsConfig(function(){return map(brTds.get(),function(td){return getBottomRightSnap(td)})},finishCell,function(finish){startCell.get().each(function(start){editor.fire("TableSelectorChange",{start:start,finish:finish})})}),memTopLeft=createSelector(topLeftSnaps),memBottomRight=createSelector(bottomRightSnaps),topLeft=build$1(memTopLeft.asSpec()),bottomRight=build$1(memBottomRight.asSpec());platform$1.deviceType.isTouch()&&(editor.on("TableSelectionChange",function(e){isVisible.get()||(attach$1(sink,topLeft),attach$1(sink,bottomRight),isVisible.set(!0)),startCell.set(Option.some(e.start)),finishCell.set(Option.some(e.finish)),e.otherCells.each(function(otherCells){tlTds.set(otherCells.upOrLeftCells),brTds.set(otherCells.downOrRightCells),snapTopLeft(e.start),snapBottomRight(e.finish)})}),editor.on("ResizeEditor ResizeWindow ScrollContent",function(){startCell.get().each(snapTopLeft),finishCell.get().each(snapBottomRight)}),editor.on("TableSelectionClear",function(){isVisible.get()&&(detach(topLeft),detach(bottomRight),isVisible.set(!1)),startCell.set(Option.none()),finishCell.set(Option.none())}))};!function(ResizeTypes){ResizeTypes[ResizeTypes.None=0]="None",ResizeTypes[ResizeTypes.Both=1]="Both",ResizeTypes[ResizeTypes.Vertical=2]="Vertical"}(ResizeTypes=ResizeTypes||{});function resize$3(editor,deltas,resizeType){var container=Element.fromDom(editor.getContainer()),dimensions=function(editor,deltas,resizeType,originalHeight,originalWidth){var dimensions={};return dimensions.height=Utils_calcCappedSize(originalHeight+deltas.top(),getMinHeightSetting(editor),getMaxHeightSetting(editor)),resizeType===ResizeTypes.Both&&(dimensions.width=Utils_calcCappedSize(originalWidth+deltas.left(),getMinWidthSetting(editor),getMaxWidthSetting(editor))),dimensions}(editor,deltas,resizeType,get$6(container),get$7(container));each$1(dimensions,function(val,dim){return set$2(container,dim,Utils_numToPx(val))}),Events_fireResizeEditor(editor)}function isHidden$1(elm){if(1===elm.nodeType){if("BR"===elm.nodeName||elm.getAttribute("data-mce-bogus"))return!0;if("bookmark"===elm.getAttribute("data-mce-type"))return!0}return!1}function renderWordCount(editor,providersBackstage){function replaceCountText(comp,count,mode){return Replacing.set(comp,[text(providersBackstage.translate(["{0} "+mode,count[mode]]))])}return Button.sketch({dom:{tag:"button",classes:["tox-statusbar__wordcount"]},components:[],buttonBehaviours:derive$1([Tabstopping.config({}),Replacing.config({}),Representing.config({store:{mode:"memory",initialValue:{mode:"words",count:{words:0,characters:0}}}}),config("wordcount-events",[runOnExecute(function(comp){var currentVal=Representing.getValue(comp),newMode="words"===currentVal.mode?"characters":"words";Representing.setValue(comp,{mode:newMode,count:currentVal.count}),replaceCountText(comp,currentVal.count,newMode)}),runOnAttached(function(comp){editor.on("wordCountUpdate",function(e){var mode=Representing.getValue(comp).mode;Representing.setValue(comp,{mode:mode,count:e.wordCount}),replaceCountText(comp,e.wordCount,mode)})})])])})}function renderStatusbar(editor,providersBackstage){var components,resizeType;return{dom:{tag:"div",classes:["tox-statusbar"]},components:(components=function(){var components=[];return editor.getParam("elementpath",!0,"boolean")&&components.push(ElementPath_renderElementPath(editor,{})),contains$1(editor.settings.plugins,"wordcount")&&components.push(renderWordCount(editor,providersBackstage)),editor.getParam("branding",!0,"boolean")&&components.push(function(){var label=global$7.translate(["Powered by {0}","Tiny"]);return{dom:{tag:"span",classes:["tox-statusbar__branding"],innerHtml:'<a href="https://www.tiny.cloud/?utm_campaign=editor_referral&amp;utm_medium=poweredby&amp;utm_source=tinymce&amp;utm_content=v5" rel="noopener" target="_blank" tabindex="-1" aria-label="'+label+'">'+label+"</a>"}}}()),0<components.length?[{dom:{tag:"div",classes:["tox-statusbar__text-container"]},components:components}]:[]}(),resizeType=function(editor){var fallback=!contains$1(editor.settings.plugins,"autoresize"),resize=editor.getParam("resize",fallback);return!1===resize?ResizeTypes.None:"both"===resize?ResizeTypes.Both:ResizeTypes.Vertical}(editor),resizeType!==ResizeTypes.None&&components.push(function(resizeType){return{dom:{tag:"div",classes:["tox-statusbar__resize-handle"],attributes:{title:providersBackstage.translate("Resize"),"aria-hidden":"true"},innerHtml:get$d("resize-handle",providersBackstage.icons)},behaviours:derive$1([Dragging.config({mode:"mouse",repositionTarget:!1,onDrag:function(comp,target,delta){resize$3(editor,delta,resizeType)},blockerClass:"tox-blocker"})])}}(resizeType)),components)}}function createGridFields(itemsField){return[strictString("type"),function(key){return strictOf(key,number)}("columns"),itemsField]}function createItemsField(name){return field("items","items",strict(),arrOf(valueOf(function(v){return asRaw("Checking item of "+name,itemSchema$2,v).fold(function(sErr){return Result.error(formatError(sErr))},function(passValue){return Result.value(passValue)})})))}function isNamedItem(obj){return isString(obj.type)&&isString(obj.name)}function createDataValidator(structure){var namedItems=function(structure){return filter(getAllObjects(structure),isNamedItem)}(structure),fields=bind(namedItems,function(item){return function(item){return Option.from(dataProcessors[item.type])}(item).fold(function(){return[]},function(schema){return[strictOf(item.name,schema)]})});return objOf(fields)}function extract$1(structure){return{internalDialog:getOrDie(function(spec){return asRaw("dialog",dialogSchema,spec)}(structure)),dataValidator:createDataValidator(structure),initialData:structure.initialData}}function toValidValues(values){var errors=[],result={};return each$1(values,function(value,name){value.fold(function(){errors.push(name)},function(v){result[name]=v})}),0<errors.length?Result.error(errors):Result.value(result)}function setTabviewHeight(tabview,height){set$2(tabview,"height",height+"px"),detect$3().browser.isIE()?remove$6(tabview,"flex-basis"):set$2(tabview,"flex-basis",height+"px")}function updateTabviewHeight(dialogBody,tabview,maxTabHeight){ancestor$2(dialogBody,'[role="dialog"]').each(function(dialog){descendant$1(dialog,'[role="tablist"]').each(function(tablist){maxTabHeight.get().map(function(height){return set$2(tabview,"height","0"),set$2(tabview,"flex-basis","0"),Math.min(height,function(dialog,tabview,tablist){var maxHeight,documentElement$1=documentElement(dialog).dom(),rootElm=ancestor$2(dialog,".tox-dialog-wrap").getOr(dialog);maxHeight="fixed"===get$4(rootElm,"position")?Math.max(documentElement$1.clientHeight,domGlobals.window.innerHeight):Math.max(documentElement$1.offsetHeight,documentElement$1.scrollHeight);var tabviewHeight=get$6(tabview),currentTabHeight=tabview.dom().offsetLeft>=tablist.dom().offsetLeft+get$7(tablist)?Math.max(get$6(tablist),tabviewHeight):tabviewHeight,dialogTopMargin=parseInt(get$4(dialog,"margin-top"),10)||0,dialogBottomMargin=parseInt(get$4(dialog,"margin-bottom"),10)||0;return maxHeight-(get$6(dialog)+dialogTopMargin+dialogBottomMargin-currentTabHeight)}(dialog,tabview,tablist))}).each(function(height){setTabviewHeight(tabview,height)})})})}function getTabview(dialog){return descendant$1(dialog,'[role="tabpanel"]')}function setMode(allTabs){var maxTabHeight;return{smartTabHeight:(maxTabHeight=Cell(Option.none()),{extraEvents:[runOnAttached(function(comp){var dialog=comp.element();getTabview(dialog).each(function(tabview){set$2(tabview,"visibility","hidden"),comp.getSystem().getByDom(tabview).toOption().each(function(tabviewComp){var maxTabHeightOpt=function(heights){return head(sort(heights,function(a,b){return b<a?-1:a<b?1:0}))}(function(allTabs,tabview,tabviewComp){return map(allTabs,function(tab,i){Replacing.set(tabviewComp,allTabs[i].view());var rect=tabview.dom().getBoundingClientRect();return Replacing.set(tabviewComp,[]),rect.height})}(allTabs,tabview,tabviewComp));maxTabHeight.set(maxTabHeightOpt)}),updateTabviewHeight(dialog,tabview,maxTabHeight),remove$6(tabview,"visibility"),function(allTabs,comp){head(allTabs).each(function(tab){return TabSection.showTab(comp,tab.value)})}(allTabs,comp),global$2.requestAnimationFrame(function(){updateTabviewHeight(dialog,tabview,maxTabHeight)})})}),run(windowResize(),function(comp){var dialog=comp.element();getTabview(dialog).each(function(tabview){updateTabviewHeight(dialog,tabview,maxTabHeight)})}),run(formResizeEvent,function(comp,se){var dialog=comp.element();getTabview(dialog).each(function(tabview){var oldFocus=active();set$2(tabview,"visibility","hidden");var oldHeight=getRaw(tabview,"height").map(function(h){return parseInt(h,10)});remove$6(tabview,"height"),remove$6(tabview,"flex-basis");var newHeight=tabview.dom().getBoundingClientRect().height;oldHeight.forall(function(h){return h<newHeight})?(maxTabHeight.set(Option.from(newHeight)),updateTabviewHeight(dialog,tabview,maxTabHeight)):oldHeight.each(function(h){setTabviewHeight(tabview,h)}),remove$6(tabview,"visibility"),oldFocus.each(focus$1)})})],selectFirst:!1}),naiveTabHeight:{extraEvents:[],selectFirst:!0}}}function renderTabPanel(spec,backstage){function updateDataWithForm(form){var formData=Representing.getValue(form),validData=toValidValues(formData).getOr({}),currentData=storedValue.get(),newData=deepMerge(currentData,validData);storedValue.set(newData)}function setDataOnForm(form){var tabData=storedValue.get();Representing.setValue(form,tabData)}var storedValue=Cell({}),oldTab=Cell(null),allTabs=map(spec.tabs,function(tab){return{value:tab.name,dom:{tag:"div",classes:["tox-dialog__body-nav-item"],innerHtml:backstage.shared.providers.translate(tab.title)},view:function(){return[Form.sketch(function(parts){return{dom:{tag:"div",classes:["tox-form"]},components:map(tab.items,function(item){return interpretInForm(parts,item,backstage)}),formBehaviours:derive$1([Keying.config({mode:"acyclic",useTabstopAt:not(NavigableObject_isPseudoStop)}),config("TabView.form.events",[runOnAttached(setDataOnForm),runOnDetached(updateDataWithForm)]),Receiving.config({channels:wrapAll$1([{key:"send-data-to-section",value:{onReceive:updateDataWithForm}},{key:"send-data-to-view",value:{onReceive:setDataOnForm}}])})])}})]}}}),tabMode=setMode(allTabs).smartTabHeight;return TabSection.sketch({dom:{tag:"div",classes:["tox-dialog__body"]},onChangeTab:function(section,button,_viewItems){var name=Representing.getValue(button);emitWith(section,formTabChangeEvent,{name:name,oldName:oldTab.get()}),oldTab.set(name)},tabs:allTabs,components:[TabSection.parts().tabbar({dom:{tag:"div",classes:["tox-dialog__body-nav"]},components:[Tabbar.parts().tabs({})],markers:{tabClass:"tox-tab",selectedClass:"tox-dialog__body-nav-item--active"},tabbarBehaviours:derive$1([Tabstopping.config({})])}),TabSection.parts().tabview({dom:{tag:"div",classes:["tox-dialog__body-content"]}})],selectFirst:tabMode.selectFirst,tabSectionBehaviours:derive$1([config("tabpanel",tabMode.extraEvents),Keying.config({mode:"acyclic"}),Composing.config({find:function(comp){return head(TabSection.getViewItems(comp))}}),Representing.config({store:{mode:"manual",getValue:function(tsection){return tsection.getSystem().broadcastOn(["send-data-to-section"],{}),storedValue.get()},setValue:function(tsection,value){storedValue.set(value),tsection.getSystem().broadcastOn(["send-data-to-view"],{})}}})])})}function renderBody(spec,id,backstage,ariaAttrs){return{dom:{tag:"div",classes:["tox-dialog__content-js"],attributes:__assign(__assign({},id.map(function(x){return{id:x}}).getOr({})),ariaAttrs?{"aria-live":"polite"}:{})},components:[],behaviours:derive$1([ComposingConfigs_childAt(0),Reflecting.config({channel:bodyChannel,updateState:function(_comp,incoming){return Option.some({isTabPanel:function(){return"tabpanel"===incoming.body.type}})},renderComponents:function(incoming){switch(incoming.body.type){case"tabpanel":return[renderTabPanel(incoming.body,backstage)];default:return[function(spec,backstage){var memForm=record(Form.sketch(function(parts){return{dom:{tag:"div",classes:["tox-form"].concat(spec.classes)},components:map(spec.items,function(item){return interpretInForm(parts,item,backstage)})}}));return{dom:{tag:"div",classes:["tox-dialog__body"]},components:[{dom:{tag:"div",classes:["tox-dialog__body-content"]},components:[memForm.asSpec()]}],behaviours:derive$1([Keying.config({mode:"acyclic",useTabstopAt:not(NavigableObject_isPseudoStop)}),ComposingConfigs_memento(memForm),RepresentingConfigs_memento(memForm,{postprocess:function(formValue){return toValidValues(formValue).fold(function(err){return domGlobals.console.error(err),{}},function(vals){return vals})}})])}}(incoming.body,backstage)]}},initialData:spec})])}}function hiddenHeader(title,close){return{dom:{tag:"div",styles:{display:"none"},classes:["tox-dialog__header"]},components:[title,close]}}function pClose(onClose,providersBackstage){return ModalDialog.parts().close(Button.sketch({dom:{tag:"button",classes:["tox-button","tox-button--icon","tox-button--naked"],attributes:{type:"button","aria-label":providersBackstage.translate("Close")}},action:onClose,buttonBehaviours:derive$1([Tabstopping.config({})])}))}function pUntitled(){return ModalDialog.parts().title({dom:{tag:"div",classes:["tox-dialog__title"],innerHtml:"",styles:{display:"none"}}})}function pBodyMessage(message,providersBackstage){return ModalDialog.parts().body({dom:{tag:"div",classes:["tox-dialog__body"]},components:[{dom:{tag:"div",classes:["tox-dialog__body-content"]},components:[{dom:fromHtml$2("<p>"+providersBackstage.translate(message)+"</p>")}]}]})}function pFooter(buttons){return ModalDialog.parts().footer({dom:{tag:"div",classes:["tox-dialog__footer"]},components:buttons})}function pFooterGroup(startButtons,endButtons){return[Container.sketch({dom:{tag:"div",classes:["tox-dialog__footer-start"]},components:startButtons}),Container.sketch({dom:{tag:"div",classes:["tox-dialog__footer-end"]},components:endButtons})]}function renderDialog(spec){var _a,dialogClass="tox-dialog",blockerClass=dialogClass+"-wrap",blockerBackdropClass=blockerClass+"__backdrop",scrollLockClass=dialogClass+"__disable-scroll";return ModalDialog.sketch({lazySink:spec.lazySink,onEscape:function(comp){return spec.onEscape(comp),Option.some(!0)},useTabstopAt:function(elem){return!NavigableObject_isPseudoStop(elem)},dom:{tag:"div",classes:[dialogClass].concat(spec.extraClasses),styles:__assign({position:"relative"},spec.extraStyles)},components:__spreadArrays([spec.header,spec.body],spec.footer.toArray()),parts:{blocker:{dom:fromHtml$2('<div class="'+blockerClass+'"></div>'),components:[{dom:{tag:"div",classes:isTouch?[blockerBackdropClass,blockerBackdropClass+"--opaque"]:[blockerBackdropClass]}}]}},dragBlockClass:blockerClass,modalBehaviours:derive$1(__spreadArrays([Focusing.config({}),config("dialog-events",spec.dialogEvents.concat([runOnSource(focusin(),function(comp,se){Keying.focusIn(comp)})])),config("scroll-lock",[runOnAttached(function(){add$2(body(),scrollLockClass)}),runOnDetached(function(){remove$4(body(),scrollLockClass)})])],spec.extraBehaviours)),eventOrder:__assign((_a={},_a[execute()]=["dialog-events"],_a[attachedToDom()]=["scroll-lock","dialog-events","alloy.base.behaviour"],_a[detachedFromDom()]=["alloy.base.behaviour","dialog-events","scroll-lock"],_a),spec.eventOrder)})}function renderClose(providersBackstage){return Button.sketch({dom:{tag:"button",classes:["tox-button","tox-button--icon","tox-button--naked"],attributes:{type:"button","aria-label":providersBackstage.translate("Close"),title:providersBackstage.translate("Close")}},components:[{dom:{tag:"div",classes:["tox-icon"],innerHtml:'<svg width="24" height="24" xmlns="http://www.w3.org/2000/svg"><path d="M17.953 7.453L13.422 12l4.531 4.547-1.406 1.406L12 13.422l-4.547 4.531-1.406-1.406L10.578 12 6.047 7.453l1.406-1.406L12 10.578l4.547-4.531z" fill-rule="evenodd"></path></svg>'}}],action:function(comp){emit(comp,formCancelEvent)}})}function renderTitle(spec,id,providersBackstage){function renderComponents(data){return[text(providersBackstage.translate(data.title))]}return{dom:{tag:"div",classes:["tox-dialog__title"],attributes:__assign({},id.map(function(x){return{id:x}}).getOr({}))},components:renderComponents(spec),behaviours:derive$1([Reflecting.config({channel:titleChannel,renderComponents:renderComponents})])}}function renderDragHandle(){return{dom:fromHtml$2('<div class="tox-dialog__draghandle"></div>')}}function getHeader(title,backstage){return function(spec,providersBackstage){var pTitle=ModalDialog.parts().title(renderTitle(spec,Option.none(),providersBackstage)),pHandle=ModalDialog.parts().draghandle(renderDragHandle()),pClose=ModalDialog.parts().close(renderClose(providersBackstage)),components=[pTitle].concat(spec.draggable?[pHandle]:[]).concat([pClose]);return Container.sketch({dom:fromHtml$2('<div class="tox-dialog__header"></div>'),components:components})}({title:backstage.shared.providers.translate(title),draggable:backstage.dialog.isDraggableModal()},backstage.shared.providers)}function getEventExtras(lazyDialog,extra){return{onClose:function(){return extra.closeWindow()},onBlock:function(blockEvent){ModalDialog.setBusy(lazyDialog(),function(d,bs){return{dom:{tag:"div",classes:["tox-dialog__busy-spinner"],attributes:{"aria-label":blockEvent.message()},styles:{left:"0px",right:"0px",bottom:"0px",top:"0px",position:"absolute"}},behaviours:bs,components:[{dom:fromHtml$2('<div class="tox-spinner"><div></div><div></div><div></div></div>')}]}})},onUnblock:function(){ModalDialog.setIdle(lazyDialog())}}}function renderModalDialog(spec,initialData,dialogEvents,backstage){var _a;return build$1(renderDialog(__assign(__assign({},spec),{lazySink:backstage.shared.getSink,extraBehaviours:__spreadArrays([Reflecting.config({channel:dialogChannel,updateState:function(_comp,incoming){return Option.some(incoming)},initialData:initialData}),RepresentingConfigs_memory({})],spec.extraBehaviours),onEscape:function(comp){emit(comp,formCancelEvent)},dialogEvents:dialogEvents,eventOrder:(_a={},_a[receive()]=["reflecting","receiving"],_a[attachedToDom()]=["scroll-lock","reflecting","messages","dialog-events","alloy.base.behaviour"],_a[detachedFromDom()]=["alloy.base.behaviour","dialog-events","messages","reflecting","scroll-lock"],_a)})))}function mapMenuButtons(buttons){return map(buttons,function(button){return"menu"===button.type?function(button){var items=map(button.items,function(item){var cell=Cell(!1);return __assign(__assign({},item),{storage:cell})});return __assign(__assign({},button),{items:items})}(button):button})}function extractCellsToObject(buttons){return foldl(buttons,function(acc,button){return"menu"!==button.type?acc:foldl(button.items,function(innerAcc,item){return innerAcc[item.name]=item.storage,innerAcc},acc)},{})}function initCommonEvents(fireApiEvent,extras){return[runWithTarget(focusin(),NavigableObject_onFocus),fireApiEvent(formCloseEvent,function(api,spec){extras.onClose(),spec.onClose()}),fireApiEvent(formCancelEvent,function(api,spec,_event,self){spec.onCancel(api),emit(self,formCloseEvent)}),run(formUnblockEvent,function(c,se){return extras.onUnblock()}),run(formBlockEvent,function(c,se){return extras.onBlock(se.event())})]}function renderComponents(_data,state){function makeGroup(edge,buttons){return Container.sketch({dom:{tag:"div",classes:["tox-dialog__footer-"+edge]},components:map(buttons,function(button){return button.memento.asSpec()})})}var buttonGroups=function(xs,pred){for(var pass=[],fail=[],i=0,len=xs.length;i<len;i++){var x=xs[i];(pred(x,i)?pass:fail).push(x)}return{pass:pass,fail:fail}}(state.map(function(s){return s.footerButtons}).getOr([]),function(button){return"start"===button.align});return[makeGroup("start",buttonGroups.pass),makeGroup("end",buttonGroups.fail)]}function renderFooter(initSpec,backstage){return{dom:fromHtml$2('<div class="tox-dialog__footer"></div>'),components:[],behaviours:derive$1([Reflecting.config({channel:footerChannel,initialData:initSpec,updateState:function(_comp,data){var footerButtons=map(data.buttons,function(button){var memButton=record(function(button,backstage){return renderFooterButton(button,button.type,backstage)}(button,backstage));return{name:button.name,align:button.align,memento:memButton}});return Option.some({lookupByName:function(compInSystem,buttonName){return function(compInSystem,footerButtons,buttonName){return find(footerButtons,function(button){return button.name===buttonName}).bind(function(memButton){return memButton.memento.getOpt(compInSystem)})}(compInSystem,footerButtons,buttonName)},footerButtons:footerButtons})},renderComponents:renderComponents})])}}function renderModalFooter(initSpec,backstage){return ModalDialog.parts().footer(renderFooter(initSpec,backstage))}function getCompByName(access,name){if(access.getRoot().getSystem().isConnected()){var form_1=Composing.getCurrent(access.getFormWrapper()).getOr(access.getFormWrapper());return Form.getField(form_1,name).fold(function(){var footer=access.getFooter();return Reflecting.getState(footer).get().bind(function(f){return f.lookupByName(form_1,name)})},function(comp){return Option.some(comp)})}return Option.none()}function getDialogApi(access,doRedial,menuItemStates){function withRoot(f){var root=access.getRoot();root.getSystem().isConnected()&&f(root)}var instanceApi={getData:function(){var root=access.getRoot(),valueComp=root.getSystem().isConnected()?access.getFormWrapper():root,representedValues=Representing.getValue(valueComp),menuItemCurrentState=map$1(menuItemStates,function(cell){return cell.get()});return __assign(__assign({},representedValues),menuItemCurrentState)},setData:function(newData){withRoot(function(_){var prevData=instanceApi.getData(),mergedData=__assign(__assign({},prevData),newData),newInternalData=function(access,data){var root=access.getRoot();return Reflecting.getState(root).get().map(function(dialogState){return getOrDie(asRaw("data",dialogState.dataValidator,data))}).getOr(data)}(access,mergedData),form=access.getFormWrapper();Representing.setValue(form,newInternalData),each$1(menuItemStates,function(v,k){has(mergedData,k)&&v.set(mergedData[k])})})},disable:function(name){getCompByName(access,name).each(Disabling.disable)},enable:function(name){getCompByName(access,name).each(Disabling.enable)},focus:function(name){getCompByName(access,name).each(Focusing.focus)},block:function(message){if(!isString(message))throw new Error("The dialogInstanceAPI.block function should be passed a blocking message of type string as an argument");withRoot(function(root){emitWith(root,formBlockEvent,{message:message})})},unblock:function(){withRoot(function(root){emit(root,formUnblockEvent)})},showTab:function(name){withRoot(function(_){var body=access.getBody();Reflecting.getState(body).get().exists(function(b){return b.isTabPanel()})&&Composing.getCurrent(body).each(function(tabSection){TabSection.showTab(tabSection,name)})})},redial:function(d){withRoot(function(root){var dialogInit=doRedial(d);root.getSystem().broadcastOn([dialogChannel],dialogInit),root.getSystem().broadcastOn([titleChannel],dialogInit.internalDialog),root.getSystem().broadcastOn([bodyChannel],dialogInit.internalDialog),root.getSystem().broadcastOn([footerChannel],dialogInit.internalDialog),instanceApi.setData(dialogInit.initialData)})},close:function(){withRoot(function(root){emit(root,formCloseEvent)})}};return instanceApi}function renderDialog$1(dialogInit,extra,backstage){var header=getHeader(dialogInit.internalDialog.title,backstage),body=function(spec,backstage){var bodySpec=renderBody(spec,Option.none(),backstage,!1);return ModalDialog.parts().body(bodySpec)}({body:dialogInit.internalDialog.body},backstage),storagedMenuButtons=mapMenuButtons(dialogInit.internalDialog.buttons),objOfCells=extractCellsToObject(storagedMenuButtons),footer=renderModalFooter({buttons:storagedMenuButtons},backstage),dialogEvents=SilverDialogEvents_initDialog(function(){return instanceApi},getEventExtras(function(){return dialog},extra),backstage.shared.getSink),dialogSize="normal"!==dialogInit.internalDialog.size?"large"===dialogInit.internalDialog.size?["tox-dialog--width-lg"]:["tox-dialog--width-md"]:[],spec={header:header,body:body,footer:Option.some(footer),extraClasses:dialogSize,extraBehaviours:[],extraStyles:{}},dialog=renderModalDialog(spec,dialogInit,dialogEvents,backstage),instanceApi=getDialogApi({getRoot:function(){return dialog},getBody:function(){return ModalDialog.getBody(dialog)},getFooter:function(){return ModalDialog.getFooter(dialog)},getFormWrapper:function(){var outerForm=ModalDialog.getBody(dialog);return Composing.getCurrent(outerForm).getOr(outerForm)}},extra.redial,objOfCells);return{dialog:dialog,instanceApi:instanceApi}}function renderInlineDialog(dialogInit,extra,backstage,ariaAttrs){var _a,_b,dialogLabelId=generate$1("dialog-label"),dialogContentId=generate$1("dialog-content"),memHeader=record(function(spec,titleId,providersBackstage){return Container.sketch({dom:fromHtml$2('<div class="tox-dialog__header"></div>'),components:[renderTitle(spec,Option.some(titleId),providersBackstage),renderDragHandle(),renderClose(providersBackstage)],containerBehaviours:derive$1([Dragging.config({mode:"mouse",blockerClass:"blocker",getTarget:function(handle){return closest$3(handle,'[role="dialog"]').getOrDie()},snaps:{getSnapPoints:function(){return[]},leftAttr:"data-drag-left",topAttr:"data-drag-top"}})])})}({title:dialogInit.internalDialog.title,draggable:!0},dialogLabelId,backstage.shared.providers)),memBody=record(function(spec,contentId,backstage,ariaAttrs){return renderBody(spec,Option.some(contentId),backstage,ariaAttrs)}({body:dialogInit.internalDialog.body},dialogContentId,backstage,ariaAttrs)),storagedMenuButtons=mapMenuButtons(dialogInit.internalDialog.buttons),objOfCells=extractCellsToObject(storagedMenuButtons),memFooter=record(function(initSpec,backstage){return renderFooter(initSpec,backstage)}({buttons:storagedMenuButtons},backstage)),dialogEvents=SilverDialogEvents_initDialog(function(){return instanceApi},{onBlock:function(){},onUnblock:function(){},onClose:function(){return extra.closeWindow()}},backstage.shared.getSink),dialog=build$1({dom:{tag:"div",classes:["tox-dialog","tox-dialog-inline"],attributes:(_a={role:"dialog"},_a["aria-labelledby"]=dialogLabelId,_a["aria-describedby"]=""+dialogContentId,_a)},eventOrder:(_b={},_b[receive()]=[Reflecting.name(),Receiving.name()],_b[execute()]=["execute-on-form"],_b[attachedToDom()]=["reflecting","execute-on-form"],_b),behaviours:derive$1([Keying.config({mode:"cyclic",onEscape:function(c){return emit(c,formCloseEvent),Option.some(!0)},useTabstopAt:function(elem){return!NavigableObject_isPseudoStop(elem)&&("button"!==name(elem)||"disabled"!==get$2(elem,"disabled"))}}),Reflecting.config({channel:dialogChannel,updateState:function(_comp,incoming){return Option.some(incoming)},initialData:dialogInit}),Focusing.config({}),config("execute-on-form",dialogEvents.concat([runOnSource(focusin(),function(comp,se){Keying.focusIn(comp)})])),RepresentingConfigs_memory({})]),components:[memHeader.asSpec(),memBody.asSpec(),memFooter.asSpec()]}),instanceApi=getDialogApi({getRoot:function(){return dialog},getFooter:function(){return memFooter.get(dialog)},getBody:function(){return memBody.get(dialog)},getFormWrapper:function(){var body=memBody.get(dialog);return Composing.getCurrent(body).getOr(body)}},extra.redial,objOfCells);return{dialog:dialog,instanceApi:instanceApi}}function getUrlDialogApi(root){function withRoot(f){root.getSystem().isConnected()&&f(root)}return{block:function(message){if(!isString(message))throw new Error("The urlDialogInstanceAPI.block function should be passed a blocking message of type string as an argument");withRoot(function(root){emitWith(root,formBlockEvent,{message:message})})},unblock:function(){withRoot(function(root){emit(root,formUnblockEvent)})},close:function(){withRoot(function(root){emit(root,formCloseEvent)})},sendMessage:function(data){withRoot(function(root){root.getSystem().broadcastOn([bodySendMessageChannel],data)})}}}function isSupportedMessage(data){return isObject(data)&&-1!==SUPPORTED_MESSAGE_ACTIONS.indexOf(data.mceAction)}function renderUrlDialog(internalDialog,extra,editor,backstage){var _a,header=getHeader(internalDialog.title,backstage),body=function(spec){var bodySpec={dom:{tag:"div",classes:["tox-dialog__content-js"]},components:[{dom:{tag:"div",classes:["tox-dialog__body-iframe"]},components:[NavigableObject_craft({dom:{tag:"iframe",attributes:{src:spec.url}},behaviours:derive$1([Tabstopping.config({}),Focusing.config({})])})]}],behaviours:derive$1([Keying.config({mode:"acyclic",useTabstopAt:not(NavigableObject_isPseudoStop)})])};return ModalDialog.parts().body(bodySpec)}(internalDialog),footer=internalDialog.buttons.bind(function(buttons){return 0===buttons.length?Option.none():Option.some(renderModalFooter({buttons:buttons},backstage))}),dialogEvents=SilverDialogEvents_initUrlDialog(function(){return instanceApi},getEventExtras(function(){return dialog},extra)),styles=__assign(__assign({},internalDialog.height.fold(function(){return{}},function(height){return{height:height+"px","max-height":height+"px"}})),internalDialog.width.fold(function(){return{}},function(width){return{width:width+"px","max-width":width+"px"}})),classes=internalDialog.width.isNone()&&internalDialog.height.isNone()?["tox-dialog--width-lg"]:[],iframeUri=new global$g(internalDialog.url,{base_uri:new global$g(domGlobals.window.location.href)}),iframeDomain=iframeUri.protocol+"://"+iframeUri.host+(iframeUri.port?":"+iframeUri.port:""),messageHandlerUnbinder=Cell(Option.none()),extraBehaviours=[config("messages",[runOnAttached(function(){var unbind=bind$3(Element.fromDom(domGlobals.window),"message",function(e){if(iframeUri.isSameOrigin(new global$g(e.raw().origin))){var data=e.raw().data;isSupportedMessage(data)?function(editor,api,data){switch(data.mceAction){case"insertContent":editor.insertContent(data.content);break;case"setContent":editor.setContent(data.content);break;case"execCommand":var ui=!!isBoolean(data.ui)&&data.ui;editor.execCommand(data.cmd,ui,data.value);break;case"close":api.close();break;case"block":api.block(data.message);break;case"unblock":api.unblock()}}(editor,instanceApi,data):function(data){return!isSupportedMessage(data)&&isObject(data)&&has(data,"mceAction")}(data)&&internalDialog.onMessage(instanceApi,data)}});messageHandlerUnbinder.set(Option.some(unbind))}),runOnDetached(function(){messageHandlerUnbinder.get().each(function(unbinder){return unbinder.unbind()})})]),Receiving.config({channels:(_a={},_a[bodySendMessageChannel]={onReceive:function(comp,data){descendant$1(comp.element(),"iframe").each(function(iframeEle){iframeEle.dom().contentWindow.postMessage(data,iframeDomain)})}},_a)})],dialog=renderModalDialog({header:header,body:body,footer:footer,extraClasses:classes,extraBehaviours:extraBehaviours,extraStyles:styles},internalDialog,dialogEvents,backstage),instanceApi=getUrlDialogApi(dialog);return{dialog:dialog,instanceApi:instanceApi}}function setup$d(extras){var sharedBackstage=extras.backstage.shared;return{open:function(message,callback){function closeDialog(state){ModalDialog.hide(confirmDialog),callback(state)}var memFooterYes=record(renderFooterButton({name:"yes",text:"Yes",primary:!0,align:"end",disabled:!1,icon:Option.none()},"submit",extras.backstage)),footerNo=renderFooterButton({name:"no",text:"No",primary:!1,align:"end",disabled:!1,icon:Option.none()},"cancel",extras.backstage),titleSpec=pUntitled(),closeSpec=pClose(function(){return closeDialog(!1)},sharedBackstage.providers),confirmDialog=build$1(renderDialog({lazySink:function(){return sharedBackstage.getSink()},header:hiddenHeader(titleSpec,closeSpec),body:pBodyMessage(message,sharedBackstage.providers),footer:Option.some(pFooter(pFooterGroup([],[footerNo,memFooterYes.asSpec()]))),onEscape:function(){return closeDialog(!1)},extraClasses:["tox-confirm-dialog"],extraBehaviours:[],extraStyles:{},dialogEvents:[run(formCancelEvent,function(){return closeDialog(!1)}),run(formSubmitEvent,function(){return closeDialog(!0)})],eventOrder:{}}));ModalDialog.show(confirmDialog);var footerYesButton=memFooterYes.get(confirmDialog);Focusing.focus(footerYesButton)}}}var ElementPath_renderElementPath=function(editor,settings){settings.delimiter||(settings.delimiter="");return{dom:{tag:"div",classes:["tox-statusbar__path"],attributes:{role:"navigation"}},behaviours:derive$1([Keying.config({mode:"flow",selector:"div[role=button]"}),Tabstopping.config({}),Replacing.config({}),config("elementPathEvents",[runOnAttached(function(comp,e){editor.shortcuts.add("alt+F11","focus statusbar elementpath",function(){return Keying.focusIn(comp)}),editor.on("NodeChange",function(e){var newPath=function(parents){for(var newPath=[],i=parents.length;0<i--;){var parent_1=parents[i];if(1===parent_1.nodeType&&!isHidden$1(parent_1)){var args=editor.fire("ResolveName",{name:parent_1.nodeName.toLowerCase(),target:parent_1});if(args.isDefaultPrevented()||newPath.push({name:args.name,element:parent_1}),args.isPropagationStopped())break}}return newPath}(e.parents);0<newPath.length?Replacing.set(comp,function(data){var newPathElements=map(data||[],function(part,index){return Button.sketch({dom:{tag:"div",classes:["tox-statusbar__path-item"],attributes:{role:"button","data-index":index,"tab-index":-1,"aria-level":index+1},innerHtml:part.name},action:function(btn){editor.focus(),editor.selection.select(part.element),editor.nodeChanged()}})}),divider={dom:{tag:"div",classes:["tox-statusbar__path-divider"],attributes:{"aria-hidden":!0},innerHtml:" "+settings.delimiter+" "}};return foldl(newPathElements.slice(1),function(acc,element){var newAcc=acc;return newAcc.push(divider),newAcc.push(element),newAcc},[newPathElements[0]])}(newPath)):Replacing.set(comp,[])})})])]),components:[]}},Render_setup=function(editor){function lazyHeader(){return lazyOuterContainer.bind(OuterContainer.getHeader)}function lazySink(){return Result.value(sink)}function lazyThrobber(){return lazyOuterContainer.bind(function(container){return OuterContainer.getThrobber(container)}).getOrDie("Could not find throbber element")}var _a,isInline=editor.inline,mode=isInline?Inline:Iframe,header=isStickyToolbar(editor)?StickyHeader:StaticHeader,lazyOuterContainer=Option.none(),platform=detect$3(),platformClasses=platform.browser.isIE()?["tox-platform-ie"]:[],deviceClasses=platform.deviceType.isTouch()?["tox-platform-touch"]:[],isToolbarTop=isToolbarLocationTop(editor),dirAttributes=global$7.isRtl()?{attributes:{dir:"rtl"}}:{},verticalDirAttributes={attributes:(_a={},_a[Attribute]=isToolbarTop?AttributeValue.TopToBottom:AttributeValue.BottomToTop,_a)},sink=build$1({dom:__assign({tag:"div",classes:["tox","tox-silver-sink","tox-tinymce-aux"].concat(platformClasses).concat(deviceClasses)},dirAttributes),behaviours:derive$1([Positioning.config({useFixed:function(){return header.isDocked(lazyHeader)}})])}),memAnchorBar=record({dom:{tag:"div",classes:["tox-anchorbar"]}}),backstage=init$8(sink,editor,function(){return lazyOuterContainer.bind(function(container){return memAnchorBar.getOpt(container)}).getOrDie("Could not find a anchor bar element")}),partMenubar=OuterContainer.parts().menubar({dom:{tag:"div",classes:["tox-menubar"]},backstage:backstage,onEscape:function(){editor.focus()}}),toolbarMode=getToolbarMode(editor),partToolbar=OuterContainer.parts().toolbar(__assign({dom:{tag:"div",classes:["tox-toolbar"]},getSink:lazySink,backstage:backstage,onEscape:function(){editor.focus()},type:toolbarMode,lazyToolbar:function(){return lazyOuterContainer.bind(function(container){return OuterContainer.getToolbar(container)}).getOrDie("Could not find more toolbar element")},lazyHeader:function(){return lazyHeader().getOrDie("Could not find header element")}},verticalDirAttributes)),partMultipleToolbar=OuterContainer.parts()["multiple-toolbar"]({dom:{tag:"div",classes:["tox-toolbar-overlord"]},onEscape:function(){},type:toolbarMode}),partSocket=OuterContainer.parts().socket({dom:{tag:"div",classes:["tox-edit-area"]}}),partSidebar=OuterContainer.parts().sidebar({dom:{tag:"div",classes:["tox-sidebar"]}}),partThrobber=OuterContainer.parts().throbber({dom:{tag:"div",classes:["tox-throbber"]},backstage:backstage}),statusbar=editor.getParam("statusbar",!0,"boolean")&&!isInline?Option.some(renderStatusbar(editor,backstage.shared.providers)):Option.none(),socketSidebarContainer={dom:{tag:"div",classes:["tox-sidebar-wrap"]},components:[partSocket,partSidebar]},hasMultipleToolbar=isMultipleToolbars(editor),hasToolbar=isToolbarEnabled(editor),hasMenubar=isMenubarEnabled(editor),partHeader=OuterContainer.parts().header({dom:__assign({tag:"div",classes:["tox-editor-header"]},verticalDirAttributes),components:flatten([hasMenubar?[partMenubar]:[],hasMultipleToolbar?[partMultipleToolbar]:hasToolbar?[partToolbar]:[],useFixedContainer(editor)?[]:[memAnchorBar.asSpec()]]),sticky:isStickyToolbar(editor),editor:editor,getSink:lazySink}),editorComponents=flatten([isToolbarTop?[partHeader]:[],isInline?[]:[socketSidebarContainer],isToolbarTop?[]:[partHeader]]),containerComponents=flatten([[{dom:{tag:"div",classes:["tox-editor-container"]},components:editorComponents}],isInline?[]:statusbar.toArray(),[partThrobber]]),isHidden=isDistractionFree(editor),attributes=__assign(__assign({role:"application"},global$7.isRtl()?{dir:"rtl"}:{}),isHidden?{"aria-hidden":"true"}:{}),outerContainer=build$1(OuterContainer.sketch({dom:{tag:"div",classes:["tox","tox-tinymce"].concat(isInline?["tox-tinymce-inline"]:[]).concat(isToolbarTop?[]:["tox-tinymce--toolbar-bottom"]).concat(deviceClasses).concat(platformClasses),styles:__assign({visibility:"hidden"},isHidden?{opacity:"0",border:"0"}:{}),attributes:attributes},components:containerComponents,behaviours:derive$1([Keying.config({mode:"cyclic",selector:".tox-menubar, .tox-toolbar, .tox-toolbar__primary, .tox-toolbar__overflow--open, .tox-sidebar__overflow--open, .tox-statusbar__path, .tox-statusbar__wordcount, .tox-statusbar__branding a"})])}));lazyOuterContainer=Option.some(outerContainer),editor.shortcuts.add("alt+F9","focus menubar",function(){OuterContainer.focusMenubar(outerContainer)}),editor.shortcuts.add("alt+F10","focus toolbar",function(){OuterContainer.focusToolbar(outerContainer)});var mothership=takeover(outerContainer),uiMothership=takeover(sink);Events$1_setup(editor,mothership,uiMothership);function setEditorSize(){var parsedHeight=Utils_numToPx(getHeightWithFallback(editor)),parsedWidth=Utils_numToPx(function(editor){return getWidth$1(editor).getOr(getWidthSetting(editor))}(editor));return editor.inline||(isValidValue("div","width",parsedWidth)&&set$2(outerContainer.element(),"width",parsedWidth),isValidValue("div","height",parsedHeight)?set$2(outerContainer.element(),"height",parsedHeight):set$2(outerContainer.element(),"height","200px")),parsedHeight}return{mothership:mothership,uiMothership:uiMothership,backstage:backstage,renderUI:function(){header.setup(editor,lazyHeader),FormatControls_setup(editor,backstage),setup$9(editor,lazySink,backstage),function(editor){var sidebars=editor.ui.registry.getAll().sidebars;each(keys(sidebars),function(name){function isActive(){return Option.from(editor.queryCommandValue("ToggleSidebar")).is(name)}var spec=sidebars[name];editor.ui.registry.addToggleButton(name,{icon:spec.icon,tooltip:spec.tooltip,onAction:function(buttonApi){editor.execCommand("ToggleSidebar",!1,name),buttonApi.setActive(isActive())},onSetup:function(buttonApi){function handleToggle(){return buttonApi.setActive(isActive())}return editor.on("ToggleSidebar",handleToggle),function(){editor.off("ToggleSidebar",handleToggle)}}})})}(editor),setup$7(editor,lazyThrobber,backstage.shared),map$1(function(editor){return editor.getParam("toolbar_groups",{},"object")}(editor),function(toolbarGroupButtonConfig,name){editor.ui.registry.addGroupToolbarButton(name,toolbarGroupButtonConfig)});var _a=editor.ui.registry.getAll(),buttons=_a.buttons,menuItems=_a.menuItems,contextToolbars=_a.contextToolbars,sidebars=_a.sidebars,toolbarOpt=getMultipleToolbarsSetting(editor),rawUiConfig={menuItems:menuItems,menus:editor.settings.menu?map$1(editor.settings.menu,function(menu){return __assign(__assign({},menu),{items:menu.items})}):{},menubar:editor.settings.menubar,toolbar:toolbarOpt.getOrThunk(function(){return editor.getParam("toolbar",!0)}),allowToolbarGroups:toolbarMode===ToolbarMode.floating,buttons:buttons,sidebar:sidebars};ContextToolbar_register(editor,contextToolbars,sink,{backstage:backstage}),TableSelectorHandles_setup(editor,sink);var elm=editor.getElement(),height=setEditorSize(),uiComponents={mothership:mothership,uiMothership:uiMothership,outerContainer:outerContainer},args={targetNode:elm,height:height};return mode.render(editor,uiComponents,rawUiConfig,backstage,args)},getUi:function(){return{channels:{broadcastAll:uiMothership.broadcast,broadcastOn:uiMothership.broadcastOn,register:function(){}}}}}},AriaLabel_labelledBy=function(labelledElement,labelElement){var labelId=Option.from(get$2(labelledElement,"id")).fold(function(){var id=generate$1("dialog-label");return set$1(labelElement,"id",id),id},identity);set$1(labelledElement,"aria-labelledby",labelId)},schema$x=constant([strict$1("lazySink"),option("dragBlockClass"),defaultedFunction("getBounds",win),defaulted$1("useTabstopAt",constant(!0)),defaulted$1("eventOrder",{}),field$1("modalBehaviours",[Keying]),onKeyboardHandler("onExecute"),onStrictKeyboardHandler("onEscape")]),basic={sketch:identity},parts$f=constant([optional({name:"draghandle",overrides:function(detail,spec){return{behaviours:derive$1([Dragging.config({mode:"mouse",getTarget:function(handle){return ancestor$2(handle,'[role="dialog"]').getOr(handle)},blockerClass:detail.dragBlockClass.getOrDie(new Error("The drag blocker class was not specified for a dialog with a drag handle: \n"+JSON.stringify(spec,null,2)).message),getBounds:detail.getDragBounds})])}}}),required({schema:[strict$1("dom")],name:"title"}),required({factory:basic,schema:[strict$1("dom")],name:"close"}),required({factory:basic,schema:[strict$1("dom")],name:"body"}),optional({factory:basic,schema:[strict$1("dom")],name:"footer"}),external$1({factory:{sketch:function(spec,detail){return __assign(__assign({},spec),{dom:detail.dom,components:detail.components})}},schema:[defaulted$1("dom",{tag:"div",styles:{position:"fixed",left:"0px",top:"0px",right:"0px",bottom:"0px"}}),defaulted$1("components",[])],name:"blocker"})]),ModalDialog=composite$1({name:"ModalDialog",configFields:schema$x(),partFields:parts$f(),factory:function(detail,components,spec,externals){var dialogBusyEvent=generate$1("alloy.dialog.busy"),dialogIdleEvent=generate$1("alloy.dialog.idle"),busyBehaviours=derive$1([Keying.config({mode:"special",onTab:function(){return Option.some(!0)},onShiftTab:function(){return Option.some(!0)}}),Focusing.config({})]),modalEventsId=generate$1("modal-events"),eventOrder=__assign(__assign({},detail.eventOrder),{"alloy.system.attached":[modalEventsId].concat(detail.eventOrder["alloy.system.attached"]||[])});return{uid:detail.uid,dom:detail.dom,components:components,apis:{show:function(dialog){var sink=detail.lazySink(dialog).getOrDie(),busyComp=Cell(Option.none()),externalBlocker=externals.blocker(),blocker=sink.getSystem().build(__assign(__assign({},externalBlocker),{components:externalBlocker.components.concat([premade$1(dialog)]),behaviours:derive$1([Focusing.config({}),config("dialog-blocker-events",[runOnSource(focusin(),function(){Keying.focusIn(dialog)}),run(dialogIdleEvent,function(blocker,se){has$1(dialog.element(),"aria-busy")&&(remove$1(dialog.element(),"aria-busy"),busyComp.get().each(function(bc){return Replacing.remove(dialog,bc)}))}),run(dialogBusyEvent,function(blocker,se){set$1(dialog.element(),"aria-busy","true");var getBusySpec=se.event().getBusySpec();busyComp.get().each(function(bc){Replacing.remove(dialog,bc)});var busySpec=getBusySpec(dialog,busyBehaviours),busy=blocker.getSystem().build(busySpec);busyComp.set(Option.some(busy)),Replacing.append(dialog,premade$1(busy)),busy.hasConfigured(Keying)&&Keying.focusIn(busy)})])])}));attach$1(sink,blocker),Keying.focusIn(dialog)},hide:function(dialog){parent(dialog.element()).each(function(blockerDom){dialog.getSystem().getByDom(blockerDom).each(function(blocker){detach(blocker)})})},getBody:function(dialog){return getPartOrDie(dialog,detail,"body")},getFooter:function(dialog){return getPartOrDie(dialog,detail,"footer")},setIdle:function(dialog){emit(dialog,dialogIdleEvent)},setBusy:function(dialog,getBusySpec){emitWith(dialog,dialogBusyEvent,{getBusySpec:getBusySpec})}},eventOrder:eventOrder,domModification:{attributes:{role:"dialog","aria-modal":"true"}},behaviours:augment(detail.modalBehaviours,[Replacing.config({}),Keying.config({mode:"cyclic",onEnter:detail.onExecute,onEscape:detail.onEscape,useTabstopAt:detail.useTabstopAt}),config(modalEventsId,[runOnAttached(function(c){AriaLabel_labelledBy(c.element(),getPartOrDie(c,detail,"title").element()),function(describedElement,describeElement){var describeId=Option.from(get$2(describedElement,"id")).fold(function(){var id=generate$1("dialog-describe");return set$1(describeElement,"id",id),id},identity);set$1(describedElement,"aria-describedby",describeId)}(c.element(),getPartOrDie(c,detail,"body").element())})])])}},apis:{show:function(apis,dialog){apis.show(dialog)},hide:function(apis,dialog){apis.hide(dialog)},getBody:function(apis,dialog){return apis.getBody(dialog)},getFooter:function(apis,dialog){return apis.getFooter(dialog)},setBusy:function(apis,dialog,getBusySpec){apis.setBusy(dialog,getBusySpec)},setIdle:function(apis,dialog){apis.setIdle(dialog)}}}),alertBannerFields=[strictString("type"),strictString("text"),strictStringEnum("level",["info","warn","error","success"]),strictString("icon"),defaulted$1("url","")],alertBannerSchema=objOf(alertBannerFields),buttonFields=[strictString("type"),strictString("text"),defaultedBoolean("disabled",!1),defaultedBoolean("primary",!1),field("name","name",defaultedThunk(function(){return generate$1("button-name")}),string),optionString("icon"),defaultedBoolean("borderless",!1)],buttonSchema=objOf(buttonFields),checkboxFields=[strictString("type"),strictString("name"),strictString("label"),defaultedBoolean("disabled",!1)],checkboxSchema=objOf(checkboxFields),checkboxDataProcessor=boolean,formComponentFields=[strictString("type"),strictString("name")],formComponentWithLabelFields=formComponentFields.concat([optionString("label")]),colorInputSchema=objOf(formComponentWithLabelFields),colorInputDataProcessor=string,colorPickerSchema=objOf(formComponentWithLabelFields),colorPickerDataProcessor=string,dropZoneSchema=objOf(formComponentWithLabelFields),dropZoneDataProcessor=arrOf(_anyValue),iframeFields=formComponentWithLabelFields.concat([defaultedBoolean("sandboxed",!0)]),iframeSchema=objOf(iframeFields),iframeDataProcessor=string,inputFields=formComponentWithLabelFields.concat([optionString("inputMode"),optionString("placeholder"),defaultedBoolean("maximized",!1),defaultedBoolean("disabled",!1)]),inputSchema=objOf(inputFields),inputDataProcessor=string,selectBoxFields=formComponentWithLabelFields.concat([strictArrayOfObj("items",[strictString("text"),strictString("value")]),defaultedNumber("size",1),defaultedBoolean("disabled",!1)]),selectBoxSchema=objOf(selectBoxFields),selectBoxDataProcessor=string,sizeInputFields=formComponentWithLabelFields.concat([defaultedBoolean("constrain",!0),defaultedBoolean("disabled",!1)]),sizeInputSchema=objOf(sizeInputFields),sizeInputDataProcessor=objOf([strictString("width"),strictString("height")]),textAreaFields=formComponentWithLabelFields.concat([optionString("placeholder"),defaultedBoolean("maximized",!1),defaultedBoolean("disabled",!1)]),textAreaSchema=objOf(textAreaFields),textAreaDataProcessor=string,urlInputFields=formComponentWithLabelFields.concat([defaultedStringEnum("filetype","file",["image","media","file"]),defaulted$1("disabled",!1)]),urlInputSchema=objOf(urlInputFields),urlInputDataProcessor=objOf([strictString("value"),defaulted$1("meta",{})]),customEditorFields=formComponentFields.concat([defaultedString("tag","textarea"),strictString("scriptId"),strictString("scriptUrl"),function(key,fallback){return defaultedOf(key,fallback,postMessageable)}("settings",void 0)]),customEditorFieldsOld=formComponentFields.concat([defaultedString("tag","textarea"),strictFunction("init")]),customEditorSchema=valueOf(function(v){return asRaw("customeditor.old",objOfOnly(customEditorFieldsOld),v).orThunk(function(){return asRaw("customeditor.new",objOfOnly(customEditorFields),v)})}),customEditorDataProcessor=string,htmlPanelFields=[strictString("type"),strictString("html"),defaultedStringEnum("presets","presentation",["presentation","document"])],htmlPanelSchema=objOf(htmlPanelFields),imageToolsFields=formComponentWithLabelFields.concat([strictOf("currentState",objOf([strict$1("blob"),strictString("url")]))]),imageToolsSchema=objOf(imageToolsFields),collectionFields=formComponentWithLabelFields.concat([defaulted$1("columns","auto")]),collectionSchema=objOf(collectionFields),collectionDataProcessor=arrOfObj$1([strictString("value"),strictString("text"),strictString("icon")]),tableFields=[strictString("type"),strictArrayOf("header",string),strictArrayOf("cells",arrOf(string))],tableSchema=objOf(tableFields),itemSchema$2=valueThunkOf(function(){return chooseProcessor("type",{alertbanner:alertBannerSchema,bar:objOf(function(itemsField){return[strictString("type"),itemsField]}(createItemsField("bar"))),button:buttonSchema,checkbox:checkboxSchema,colorinput:colorInputSchema,colorpicker:colorPickerSchema,dropzone:dropZoneSchema,grid:objOf(createGridFields(createItemsField("grid"))),iframe:iframeSchema,input:inputSchema,selectbox:selectBoxSchema,sizeinput:sizeInputSchema,textarea:textAreaSchema,urlinput:urlInputSchema,customeditor:customEditorSchema,htmlpanel:htmlPanelSchema,imagetools:imageToolsSchema,collection:collectionSchema,label:objOf(function(itemsField){return[strictString("type"),strictString("label"),itemsField]}(createItemsField("label"))),table:tableSchema,panel:panelSchema})}),panelFields=[strictString("type"),defaulted$1("classes",[]),strictArrayOf("items",itemSchema$2)],panelSchema=objOf(panelFields),tabFields=[field("name","name",defaultedThunk(function(){return generate$1("tab-name")}),string),strictString("title"),strictArrayOf("items",itemSchema$2)],tabPanelFields=[strictString("type"),strictArrayOfObj("tabs",tabFields)],tabPanelSchema=objOf(tabPanelFields),dialogToggleMenuItemSchema=objOf([strictString("type"),strictString("name")].concat(commonMenuItemFields)),dialogToggleMenuItemDataProcessor=boolean,baseButtonFields=[field("name","name",defaultedThunk(function(){return generate$1("button-name")}),string),optionString("icon"),defaultedStringEnum("align","end",["start","end"]),defaultedBoolean("primary",!1),defaultedBoolean("disabled",!1)],dialogButtonFields=__spreadArrays(baseButtonFields,[strictString("text")]),normalButtonFields=__spreadArrays([strictStringEnum("type",["submit","cancel","custom"])],dialogButtonFields),menuButtonFields=__spreadArrays([strictStringEnum("type",["menu"]),optionString("text"),optionString("tooltip"),optionString("icon"),strictArrayOf("items",dialogToggleMenuItemSchema)],baseButtonFields),dialogButtonFields$1=dialogButtonFields,dialogButtonSchema$1=choose$1("type",{submit:normalButtonFields,cancel:normalButtonFields,custom:normalButtonFields,menu:menuButtonFields}),dialogSchema=objOf([strictString("title"),strictOf("body",chooseProcessor("type",{panel:panelSchema,tabpanel:tabPanelSchema})),defaultedString("size","normal"),strictArrayOf("buttons",dialogButtonSchema$1),defaulted$1("initialData",{}),defaultedFunction("onAction",noop),defaultedFunction("onChange",noop),defaultedFunction("onSubmit",noop),defaultedFunction("onClose",noop),defaultedFunction("onCancel",noop),defaulted$1("onTabChange",noop)]),getAllObjects=function(obj){return isObject(obj)?[obj].concat(bind(values(obj),getAllObjects)):isArray(obj)?bind(obj,getAllObjects):[]},dataProcessors={checkbox:checkboxDataProcessor,colorinput:colorInputDataProcessor,colorpicker:colorPickerDataProcessor,dropzone:dropZoneDataProcessor,input:inputDataProcessor,iframe:iframeDataProcessor,sizeinput:sizeInputDataProcessor,selectbox:selectBoxDataProcessor,size:sizeInputDataProcessor,textarea:textAreaDataProcessor,urlinput:urlInputDataProcessor,customeditor:customEditorDataProcessor,collection:collectionDataProcessor,togglemenuitem:dialogToggleMenuItemDataProcessor},urlDialogButtonSchema=objOf(__spreadArrays([strictStringEnum("type",["cancel","custom"])],dialogButtonFields$1)),urlDialogSchema=objOf([strictString("title"),strictString("url"),optionNumber("height"),optionNumber("width"),function(key,schema){return optionOf(key,arrOf(schema))}("buttons",urlDialogButtonSchema),defaultedFunction("onAction",noop),defaultedFunction("onCancel",noop),defaultedFunction("onClose",noop),defaultedFunction("onMessage",noop)]),DialogManager={open:function(factory,structure){var extraction=extract$1(structure);return factory(extraction.internalDialog,extraction.initialData,extraction.dataValidator)},openUrl:function(factory,structure){return factory(getOrDie(function(spec){return asRaw("dialog",urlDialogSchema,spec)}(structure)))},redial:function(structure){return extract$1(structure)}},TabButton=single$2({name:"TabButton",configFields:[defaulted$1("uid",void 0),strict$1("value"),field("dom","dom",mergeWithThunk(function(){return{attributes:{role:"tab",id:generate$1("aria"),"aria-selected":"false"}}}),anyValue$1()),option("action"),defaulted$1("domModification",{}),field$1("tabButtonBehaviours",[Focusing,Keying,Representing]),strict$1("view")],factory:function(detail,spec){return{uid:detail.uid,dom:detail.dom,components:detail.components,events:events$7(detail.action),behaviours:augment(detail.tabButtonBehaviours,[Focusing.config({}),Keying.config({mode:"execution",useSpace:!0,useEnter:!0}),Representing.config({store:{mode:"memory",initialValue:detail.value}})]),domModification:detail.domModification}}}),schema$y=constant([strict$1("tabs"),strict$1("dom"),defaulted$1("clickToDismiss",!1),field$1("tabbarBehaviours",[Highlighting,Keying]),markers(["tabClass","selectedClass"])]),tabsPart=group({factory:TabButton,name:"tabs",unit:"tab",overrides:function(barDetail){function dismissTab$1(tabbar,button){Highlighting.dehighlight(tabbar,button),emitWith(tabbar,dismissTab(),{tabbar:tabbar,button:button})}function changeTab$1(tabbar,button){Highlighting.highlight(tabbar,button),emitWith(tabbar,changeTab(),{tabbar:tabbar,button:button})}return{action:function(button){var tabbar=button.getSystem().getByUid(barDetail.uid).getOrDie(),activeButton=Highlighting.isHighlighted(tabbar,button);(activeButton&&barDetail.clickToDismiss?dismissTab$1:activeButton?noop:changeTab$1)(tabbar,button)},domModification:{classes:[barDetail.markers.tabClass]}}}}),parts$g=constant([tabsPart]),Tabbar=composite$1({name:"Tabbar",configFields:schema$y(),partFields:parts$g(),factory:function(detail,components,spec,externals){return{uid:detail.uid,dom:detail.dom,components:components,"debug.sketcher":"Tabbar",domModification:{attributes:{role:"tablist"}},behaviours:augment(detail.tabbarBehaviours,[Highlighting.config({highlightClass:detail.markers.selectedClass,itemClass:detail.markers.tabClass,onHighlight:function(tabbar,tab){set$1(tab.element(),"aria-selected","true")},onDehighlight:function(tabbar,tab){set$1(tab.element(),"aria-selected","false")}}),Keying.config({mode:"flow",getInitial:function(tabbar){return Highlighting.getHighlighted(tabbar).map(function(tab){return tab.element()})},selector:"."+detail.markers.tabClass,executeOnMove:!0})])}}}),Tabview=single$2({name:"Tabview",configFields:[field$1("tabviewBehaviours",[Replacing])],factory:function(detail,spec){return{uid:detail.uid,dom:detail.dom,behaviours:augment(detail.tabviewBehaviours,[Replacing.config({})]),domModification:{attributes:{role:"tabpanel"}}}}}),schema$z=constant([defaulted$1("selectFirst",!0),onHandler("onChangeTab"),onHandler("onDismissTab"),defaulted$1("tabs",[]),field$1("tabSectionBehaviours",[])]),barPart=required({factory:Tabbar,schema:[strict$1("dom"),strictObjOf("markers",[strict$1("tabClass"),strict$1("selectedClass")])],name:"tabbar",defaults:function(detail){return{tabs:detail.tabs}}}),viewPart=required({factory:Tabview,name:"tabview"}),parts$h=constant([barPart,viewPart]),TabSection=composite$1({name:"TabSection",configFields:schema$z(),partFields:parts$h(),factory:function(detail,components,spec,externals){function changeTabBy(section,byPred){getPart(section,detail,"tabbar").each(function(tabbar){byPred(tabbar).each(emitExecute)})}return{uid:detail.uid,dom:detail.dom,components:components,behaviours:get$c(detail.tabSectionBehaviours),events:derive(flatten([detail.selectFirst?[runOnAttached(function(section,simulatedEvent){changeTabBy(section,Highlighting.getFirst)})]:[],[run(changeTab(),function(section,simulatedEvent){!function(button){var tabValue=Representing.getValue(button);getPart(button,detail,"tabview").each(function(tabview){find(detail.tabs,function(t){return t.value===tabValue}).each(function(tabData){var panel=tabData.view();getOpt(button.element(),"id").each(function(id){set$1(tabview.element(),"aria-labelledby",id)}),Replacing.set(tabview,panel),detail.onChangeTab(tabview,button,panel)})})}(simulatedEvent.event().button())}),run(dismissTab(),function(section,simulatedEvent){var button=simulatedEvent.event().button();detail.onDismissTab(section,button)})]])),apis:{getViewItems:function(section){return getPart(section,detail,"tabview").map(function(tabview){return Replacing.contents(tabview)}).getOr([])},showTab:function(section,tabKey){changeTabBy(section,function(tabbar){var candidates=Highlighting.getCandidates(tabbar);return find(candidates,function(c){return Representing.getValue(c)===tabKey}).filter(function(tab){return!Highlighting.isHighlighted(tabbar,tab)})})}}}},apis:{getViewItems:function(apis,component){return apis.getViewItems(component)},showTab:function(apis,component,tabKey){apis.showTab(component,tabKey)}}}),dialogChannel=generate$1("update-dialog"),titleChannel=generate$1("update-title"),bodyChannel=generate$1("update-body"),footerChannel=generate$1("update-footer"),bodySendMessageChannel=generate$1("body-send-message"),isTouch=global$8.deviceType.isTouch(),SilverDialogEvents_initUrlDialog=function(getInstanceApi,extras){function fireApiEvent(eventName,f){return run(eventName,function(c,se){withSpec(c,function(spec,_c){f(getInstanceApi(),spec,se.event(),c)})})}var withSpec=function(c,f){Reflecting.getState(c).get().each(function(currentDialog){f(currentDialog,c)})};return __spreadArrays(initCommonEvents(fireApiEvent,extras),[fireApiEvent(formActionEvent,function(api,spec,event){spec.onAction(api,{name:event.name()})})])},SilverDialogEvents_initDialog=function(getInstanceApi,extras,getSink){function fireApiEvent(eventName,f){return run(eventName,function(c,se){withSpec(c,function(spec,_c){f(getInstanceApi(),spec,se.event(),c)})})}var withSpec=function(c,f){Reflecting.getState(c).get().each(function(currentDialogInit){f(currentDialogInit.internalDialog,c)})};return __spreadArrays(initCommonEvents(fireApiEvent,extras),[fireApiEvent(formSubmitEvent,function(api,spec){return spec.onSubmit(api)}),fireApiEvent(formChangeEvent,function(api,spec,event){spec.onChange(api,{name:event.name()})}),fireApiEvent(formActionEvent,function(api,spec,event,component){function focusIn(){return Keying.focusIn(component)}function isDisabled(focused){return has$1(focused,"disabled")||getOpt(focused,"aria-disabled").exists(function(val){return"true"===val})}var current=active();spec.onAction(api,{name:event.name(),value:event.value()}),active().fold(focusIn,function(focused){isDisabled(focused)?focusIn():current.exists(function(cur){return contains$2(focused,cur)&&isDisabled(cur)})?focusIn():getSink().toOption().filter(function(sink){return!contains$2(sink.element(),focused)}).each(focusIn)})}),fireApiEvent(formTabChangeEvent,function(api,spec,event){spec.onTabChange(api,{newTabName:event.name(),oldTabName:event.oldName()})}),runOnDetached(function(component){var api=getInstanceApi();Representing.setValue(component,api.getData())})])},global$g=tinymce.util.Tools.resolve("tinymce.util.URI"),SUPPORTED_MESSAGE_ACTIONS=["insertContent","setContent","execCommand","close","block","unblock"],WindowManager_setup=function(extras){var backstage=extras.backstage,editor=extras.editor,isStickyToolbar$1=isStickyToolbar(editor),isToolbarLocationTop$1=isToolbarLocationTop(editor),alertDialog=function(extras){var sharedBackstage=extras.backstage.shared;return{open:function(message,callback){function closeDialog(){ModalDialog.hide(alertDialog),callback()}var memFooterClose=record(renderFooterButton({name:"close-alert",text:"OK",primary:!0,align:"end",disabled:!1,icon:Option.none()},"cancel",extras.backstage)),titleSpec=pUntitled(),closeSpec=pClose(closeDialog,sharedBackstage.providers),alertDialog=build$1(renderDialog({lazySink:function(){return sharedBackstage.getSink()},header:hiddenHeader(titleSpec,closeSpec),body:pBodyMessage(message,sharedBackstage.providers),footer:Option.some(pFooter(pFooterGroup([],[memFooterClose.asSpec()]))),onEscape:closeDialog,extraClasses:["tox-alert-dialog"],extraBehaviours:[],extraStyles:{},dialogEvents:[run(formCancelEvent,closeDialog)],eventOrder:{}}));ModalDialog.show(alertDialog);var footerCloseButton=memFooterClose.get(alertDialog);Focusing.focus(footerCloseButton)}}}(extras),confirmDialog=setup$d(extras),openModalUrlDialog=function(config,closeWindow){return DialogManager.openUrl(function(contents){var dialog=renderUrlDialog(contents,{closeWindow:function(){ModalDialog.hide(dialog.dialog),closeWindow(dialog.instanceApi)}},editor,backstage);return ModalDialog.show(dialog.dialog),dialog.instanceApi},config)},openModalDialog=function(config,closeWindow){return DialogManager.open(function(contents,internalInitialData,dataValidator){var initialData=internalInitialData,dialog=renderDialog$1({dataValidator:dataValidator,initialData:initialData,internalDialog:contents},{redial:DialogManager.redial,closeWindow:function(){ModalDialog.hide(dialog.dialog),closeWindow(dialog.instanceApi)}},backstage);return ModalDialog.show(dialog.dialog),dialog.instanceApi.setData(initialData),dialog.instanceApi},config)},openInlineDialog=function(config$1,anchor,closeWindow,ariaAttrs){return DialogManager.open(function(contents,internalInitialData,dataValidator){function refreshDocking(){return inlineDialog.on(function(dialog){InlineView.reposition(dialog),Docking.refresh(dialog)})}var initialData=function(data,validator){return getOrDie(asRaw("data",validator,data))}(internalInitialData,dataValidator),inlineDialog=function(){var subject=Cell(Option.none());return{clear:function(){subject.set(Option.none())},set:function(s){subject.set(Option.some(s))},isSet:function(){return subject.get().isSome()},on:function(f){subject.get().each(f)}}}(),dialogUi=renderInlineDialog({dataValidator:dataValidator,initialData:initialData,internalDialog:contents},{redial:DialogManager.redial,closeWindow:function(){inlineDialog.on(InlineView.hide),editor.off("ResizeEditor",refreshDocking),inlineDialog.clear(),closeWindow(dialogUi.instanceApi)}},backstage,ariaAttrs),inlineDialogComp=build$1(InlineView.sketch(__assign(__assign({lazySink:backstage.shared.getSink,dom:{tag:"div",classes:[]},fireDismissalEventInstead:{}},isToolbarLocationTop$1?{}:{fireRepositionEventInstead:{}}),{inlineBehaviours:derive$1(__spreadArrays([config("window-manager-inline-events",[run(dismissRequested(),function(comp,se){emit(dialogUi.dialog,formCancelEvent)})])],function(editor,isStickyToolbar,isToolbarLocationTop){return isStickyToolbar&&isToolbarLocationTop?[]:[Docking.config({contextual:{lazyContext:function(){return Option.some(box(Element.fromDom(editor.getContentAreaContainer())))},fadeInClass:"tox-dialog-dock-fadein",fadeOutClass:"tox-dialog-dock-fadeout",transitionClass:"tox-dialog-dock-transition"},modes:["top"]})]}(editor,isStickyToolbar$1,isToolbarLocationTop$1))),isExtraPart:function(comp,target){return function(target){return closest$4(target,".tox-alert-dialog")||closest$4(target,".tox-confirm-dialog")}(target)}})));return inlineDialog.set(inlineDialogComp),InlineView.showWithin(inlineDialogComp,anchor,premade$1(dialogUi.dialog),Option.some(body())),isStickyToolbar$1&&isToolbarLocationTop$1||(Docking.refresh(inlineDialogComp),editor.on("ResizeEditor",refreshDocking)),dialogUi.instanceApi.setData(initialData),Keying.focusIn(dialogUi.dialog),dialogUi.instanceApi},config$1)};return{open:function(config,params,closeWindow){return void 0!==params&&"toolbar"===params.inline?openInlineDialog(config,backstage.shared.anchors.inlineDialog(),closeWindow,params.ariaAttrs):void 0!==params&&"cursor"===params.inline?openInlineDialog(config,backstage.shared.anchors.cursor(),closeWindow,params.ariaAttrs):openModalDialog(config,closeWindow)},openUrl:function(config,closeWindow){return openModalUrlDialog(config,closeWindow)},alert:function(message,callback){alertDialog.open(message,function(){callback()})},close:function(instanceApi){instanceApi.close()},confirm:function(message,callback){confirmDialog.open(message,function(state){callback(state)})}}};global$1.add("silver",function(editor){var _a=Render_setup(editor),uiMothership=_a.uiMothership,backstage=_a.backstage,renderUI=_a.renderUI,getUi=_a.getUi;Autocompleter_register(editor,backstage.shared);var windowMgr=WindowManager_setup({editor:editor,backstage:backstage});return{renderUI:renderUI,getWindowManagerImpl:constant(windowMgr),getNotificationManagerImpl:function(){return NotificationManagerImpl(editor,{backstage:backstage},uiMothership)},ui:getUi()}})}(window),function(){"use strict";function scopeIndex(container,index){if(index<0&&(index=0),3===container.nodeType){var len=container.data.length;len<index&&(index=len)}return index}function setStart(rng,container,offset){1!==container.nodeType||container.hasChildNodes()?rng.setStart(container,scopeIndex(container,offset)):rng.setStartBefore(container)}function setEnd(rng,container,offset){1!==container.nodeType||container.hasChildNodes()?rng.setEnd(container,scopeIndex(container,offset)):rng.setEndAfter(container)}var global=tinymce.util.Tools.resolve("tinymce.PluginManager"),global$1=tinymce.util.Tools.resolve("tinymce.Env"),Settings_getAutoLinkPattern=function(editor){return editor.getParam("autolink_pattern",/^(https?:\/\/|ssh:\/\/|ftp:\/\/|file:\/|www\.|(?:mailto:)?[A-Z0-9._%+\-]+@)(.+)$/i)},Settings_getDefaultLinkTarget=function(editor){return editor.getParam("default_link_target",!1)},Settings_getDefaultLinkProtocol=function(editor){return editor.getParam("link_default_protocol","http","string")},parseCurrentLine=function(editor,endOffset,delimiter){var rng,end,start,endContainer,bookmark,text,matches,prev,len,rngText,autoLinkPattern=Settings_getAutoLinkPattern(editor),defaultLinkTarget=Settings_getDefaultLinkTarget(editor);if("A"!==editor.selection.getNode().tagName){if((rng=editor.selection.getRng(!0).cloneRange()).startOffset<5){if(!(prev=rng.endContainer.previousSibling)){if(!rng.endContainer.firstChild||!rng.endContainer.firstChild.nextSibling)return;prev=rng.endContainer.firstChild.nextSibling}if(len=prev.length,setStart(rng,prev,len),setEnd(rng,prev,len),rng.endOffset<5)return;end=rng.endOffset,endContainer=prev}else{if(3!==(endContainer=rng.endContainer).nodeType&&endContainer.firstChild){for(;3!==endContainer.nodeType&&endContainer.firstChild;)endContainer=endContainer.firstChild;3===endContainer.nodeType&&(setStart(rng,endContainer,0),setEnd(rng,endContainer,endContainer.nodeValue.length))}end=1===rng.endOffset?2:rng.endOffset-1-endOffset}for(start=end;setStart(rng,endContainer,2<=end?end-2:0),setEnd(rng,endContainer,1<=end?end-1:0),end-=1," "!==(rngText=rng.toString())&&""!==rngText&&160!==rngText.charCodeAt(0)&&0<=end-2&&rngText!==delimiter;);!function(rangeString,delimiter){return rangeString===delimiter||" "===rangeString||160===rangeString.charCodeAt(0)}(rng.toString(),delimiter)?(0===rng.startOffset?setStart(rng,endContainer,0):setStart(rng,endContainer,end),setEnd(rng,endContainer,start)):(setStart(rng,endContainer,end),setEnd(rng,endContainer,start),end+=1),"."===(text=rng.toString()).charAt(text.length-1)&&setEnd(rng,endContainer,start-1),matches=(text=rng.toString().trim()).match(autoLinkPattern);var protocol=Settings_getDefaultLinkProtocol(editor);matches&&("www."===matches[1]?matches[1]=protocol+"://www.":/@$/.test(matches[1])&&!/^mailto:/.test(matches[1])&&(matches[1]="mailto:"+matches[1]),bookmark=editor.selection.getBookmark(),editor.selection.setRng(rng),editor.execCommand("createlink",!1,matches[1]+matches[2]),!1!==defaultLinkTarget&&editor.dom.setAttrib(editor.selection.getNode(),"target",defaultLinkTarget),editor.selection.moveToBookmark(bookmark),editor.nodeChanged())}},Keys_setup=function(editor){var autoUrlDetectState;editor.on("keydown",function(e){if(13===e.keyCode)return function(editor){parseCurrentLine(editor,-1,"")}(editor)}),global$1.browser.isIE()?editor.on("focus",function(){if(!autoUrlDetectState){autoUrlDetectState=!0;try{editor.execCommand("AutoUrlDetect",!1,!0)}catch(ex){}}}):(editor.on("keypress",function(e){if(41===e.keyCode)return function(editor){parseCurrentLine(editor,-1,"(")}(editor)}),editor.on("keyup",function(e){if(32===e.keyCode)return function(editor){parseCurrentLine(editor,0,"")}(editor)}))};global.add("autolink",function(editor){Keys_setup(editor)})}(),function(domGlobals){"use strict";function isType(type){return function(value){return function(x){if(null===x)return"null";var t=typeof x;return"object"==t&&(Array.prototype.isPrototypeOf(x)||x.constructor&&"Array"===x.constructor.name)?"array":"object"==t&&(String.prototype.isPrototypeOf(x)||x.constructor&&"String"===x.constructor.name)?"string":t}(value)===type}}function noop(){}function constant(value){return function(){return value}}function none(){return NONE}var me,global$1=tinymce.util.Tools.resolve("tinymce.PluginManager"),global$2=tinymce.util.Tools.resolve("tinymce.util.VK"),isString=isType("string"),isArray=isType("array"),isBoolean=isType("boolean"),isFunction=isType("function"),Settings_assumeExternalTargets=function(editor){var externalTargets=editor.getParam("link_assume_external_targets",!1);return isBoolean(externalTargets)&&externalTargets?1:!isString(externalTargets)||"http"!==externalTargets&&"https"!==externalTargets?0:externalTargets},Settings_hasContextToolbar=function(editor){return editor.getParam("link_context_toolbar",!1,"boolean")},Settings_getLinkList=function(editor){return editor.getParam("link_list")},Settings_getDefaultLinkTarget=function(editor){return editor.getParam("default_link_target")},Settings_getTargetList=function(editor){return editor.getParam("target_list",!0)},Settings_getRelList=function(editor){return editor.getParam("rel_list",[],"array")},Settings_getLinkClassList=function(editor){return editor.getParam("link_class_list",[],"array")},Settings_shouldShowLinkTitle=function(editor){return editor.getParam("link_title",!0,"boolean")},Settings_allowUnsafeLinkTarget=function(editor){return editor.getParam("allow_unsafe_link_target",!1,"boolean")},Settings_useQuickLink=function(editor){return editor.getParam("link_quicklink",!1,"boolean")},Settings_getDefaultLinkProtocol=function(editor){return editor.getParam("link_default_protocol","http","string")},OpenUrl_open=function(url){var link=domGlobals.document.createElement("a");link.target="_blank",link.href=url,link.rel="noreferrer noopener";var evt=domGlobals.document.createEvent("MouseEvents");evt.initMouseEvent("click",!0,!0,domGlobals.window,0,0,0,0,0,!1,!1,!1,!1,0,null),function(link,evt){domGlobals.document.body.appendChild(link),link.dispatchEvent(evt),domGlobals.document.body.removeChild(link)}(link,evt)},__assign=function(){return(__assign=Object.assign||function(t){for(var s,i=1,n=arguments.length;i<n;i++)for(var p in s=arguments[i])Object.prototype.hasOwnProperty.call(s,p)&&(t[p]=s[p]);return t}).apply(this,arguments)},never=constant(!1),always=constant(!0),NONE=(me={fold:function(n,s){return n()},is:never,isSome:never,isNone:always,getOr:id,getOrThunk:call,getOrDie:function(msg){throw new Error(msg||"error: getOrDie called on none.")},getOrNull:constant(null),getOrUndefined:constant(void 0),or:id,orThunk:call,map:none,each:noop,bind:none,exists:never,forall:always,filter:none,equals:eq,equals_:eq,toArray:function(){return[]},toString:constant("none()")},Object.freeze&&Object.freeze(me),me);function eq(o){return o.isNone()}function call(thunk){return thunk()}function id(n){return n}function contains(xs,x){return-1<function(ts,t){return nativeIndexOf.call(ts,t)}(xs,x)}function each(xs,f){for(var i=0,len=xs.length;i<len;i++){f(xs[i],i)}}function flatten(xs){for(var r=[],i=0,len=xs.length;i<len;++i){if(!isArray(xs[i]))throw new Error("Arr.flatten item "+i+" was not an array, input: "+xs);nativePush.apply(r,xs[i])}return r}function bind(xs,f){return flatten(function(xs,f){for(var len=xs.length,r=new Array(len),i=0;i<len;i++){var x=xs[i];r[i]=f(x,i)}return r}(xs,f))}function findMap(arr,f){for(var i=0;i<arr.length;i++){var r=f(arr[i],i);if(r.isSome())return r}return Option.none()}function hasProtocol(url){return/^\w+:/i.test(url)}function getHref(elm){var href=elm.getAttribute("data-mce-href");return href||elm.getAttribute("href")}function applyRelTargetRules(rel,isUnsafe){var rules=["noopener"],rels=rel?rel.split(/\s+/):[],removeTargetRules=function(rels){return rels.filter(function(val){return-1===global$3.inArray(rules,val)})},newRels=isUnsafe?function(rels){return 0<(rels=removeTargetRules(rels)).length?rels.concat(rules):rules}(rels):removeTargetRules(rels);return 0<newRels.length?function(rels){return global$3.trim(rels.sort().join(" "))}(newRels):""}function getAnchorElement(editor,selectedElm){return selectedElm=selectedElm||editor.selection.getNode(),isImageFigure(selectedElm)?editor.dom.select("a[href]",selectedElm)[0]:editor.dom.getParent(selectedElm,"a[href]")}function isLink(elm){return elm&&"A"===elm.nodeName&&!!getHref(elm)}function getLinkAttrs(data){return function(xs,f,acc){return each(xs,function(x){acc=f(acc,x)}),acc}(["title","rel","class","target"],function(acc,key){return data[key].each(function(value){acc[key]=0<value.length?value:null}),acc},{href:data.href})}function applyLinkOverrides(editor,linkAttrs){var newLinkAttrs=__assign({},linkAttrs);if(!(0<Settings_getRelList(editor).length)&&!1===Settings_allowUnsafeLinkTarget(editor)){var newRel=applyRelTargetRules(newLinkAttrs.rel,"_blank"===newLinkAttrs.target);newLinkAttrs.rel=newRel||null}return Option.from(newLinkAttrs.target).isNone()&&!1===Settings_getTargetList(editor)&&(newLinkAttrs.target=Settings_getDefaultLinkTarget(editor)),newLinkAttrs.href=function(href,assumeExternalTargets){return"http"!==assumeExternalTargets&&"https"!==assumeExternalTargets||hasProtocol(href)?href:assumeExternalTargets+"://"+href}(newLinkAttrs.href,Settings_assumeExternalTargets(editor)),newLinkAttrs}function getValue(item){return isString(item.value)?item.value:""}function sanitizeWith(extracter){return void 0===extracter&&(extracter=getValue),function(list){return Option.from(list).map(function(list){return function(list,extractValue){var out=[];return global$3.each(list,function(item){var text=isString(item.text)?item.text:isString(item.title)?item.title:"";if(void 0===item.menu){var value=extractValue(item);out.push({text:text,value:value})}}),out}(list,extracter)})}}function getDelta(persistentText,fieldName,catalog,data){var value=data[fieldName],hasPersistentText=0<persistentText.length;return void 0!==value?function(value,catalog){return findMap(catalog,function(item){return Option.some(item).filter(function(i){return i.value===value})})}(value,catalog).map(function(i){return{url:{value:i.value,meta:{text:hasPersistentText?persistentText:i.text,attach:noop}},text:hasPersistentText?persistentText:i.text}}):Option.none()}var some=function(a){function self(){return me}function bind(f){return f(a)}var constant_a=constant(a),me={fold:function(n,s){return s(a)},is:function(v){return a===v},isSome:always,isNone:never,getOr:constant_a,getOrThunk:constant_a,getOrDie:constant_a,getOrNull:constant_a,getOrUndefined:constant_a,or:self,orThunk:self,map:function(f){return some(f(a))},each:function(f){f(a)},bind:bind,exists:bind,forall:bind,filter:function(f){return f(a)?me:NONE},toArray:function(){return[a]},toString:function(){return"some("+a+")"},equals:function(o){return o.is(a)},equals_:function(o,elementEq){return o.fold(never,function(b){return elementEq(a,b)})}};return me},Option={some:some,none:none,from:function(value){return null==value?NONE:some(value)}},nativeSlice=Array.prototype.slice,nativeIndexOf=Array.prototype.indexOf,nativePush=Array.prototype.push,global$3=(isFunction(Array.from)&&Array.from,tinymce.util.Tools.resolve("tinymce.util.Tools")),isImageFigure=function(elm){return elm&&"FIGURE"===elm.nodeName&&/\bimage\b/i.test(elm.className)},unlinkImageFigure=function(editor,fig){var img=editor.dom.select("img",fig)[0];if(img){var a=editor.dom.getParents(img,"a[href]",fig)[0];a&&(a.parentNode.insertBefore(img,a),editor.dom.remove(a))}},linkImageFigure=function(editor,fig,attrs){var img=editor.dom.select("img",fig)[0];if(img){var a=editor.dom.create("a",attrs);img.parentNode.insertBefore(a,img),a.appendChild(img)}},Utils_link=function(editor,attachState,data){var selectedElm=editor.selection.getNode(),anchorElm=getAnchorElement(editor,selectedElm),linkAttrs=applyLinkOverrides(editor,getLinkAttrs(data));editor.undoManager.transact(function(){data.href===attachState.href&&attachState.attach(),anchorElm?(editor.focus(),function(editor,anchorElm,text,linkAttrs){text.each(function(text){anchorElm.hasOwnProperty("innerText")?anchorElm.innerText=text:anchorElm.textContent=text}),editor.dom.setAttribs(anchorElm,linkAttrs),editor.selection.select(anchorElm)}(editor,anchorElm,data.text,linkAttrs)):function(editor,selectedElm,text,linkAttrs){isImageFigure(selectedElm)?linkImageFigure(editor,selectedElm,linkAttrs):text.fold(function(){editor.execCommand("mceInsertLink",!1,linkAttrs)},function(text){editor.insertContent(editor.dom.createHTML("a",linkAttrs,editor.dom.encode(text)))})}(editor,selectedElm,data.text,linkAttrs)})},Utils_unlink=function(editor){editor.undoManager.transact(function(){var node=editor.selection.getNode();if(isImageFigure(node))unlinkImageFigure(editor,node);else{var anchorElm=editor.dom.getParent(node,"a[href]",editor.getBody());anchorElm&&editor.dom.remove(anchorElm,!0)}editor.focus()})},Utils_hasLinks=function(elements){return 0<global$3.grep(elements,isLink).length},Utils_getHref=getHref,Utils_isOnlyTextSelected=function(html){return!(/</.test(html)&&(!/^<a [^>]+>[^<]+<\/a>$/.test(html)||-1===html.indexOf("href=")))},Utils_getAnchorElement=getAnchorElement,Utils_getAnchorText=function(selection,anchorElm){return function(text){return text.replace(/\uFEFF/g,"")}(anchorElm?anchorElm.innerText||anchorElm.textContent:selection.getContent({format:"text"}))},Utils_applyRelTargetRules=applyRelTargetRules,Utils_hasProtocol=hasProtocol,ListOptions={sanitize:function(list){return sanitizeWith(getValue)(list)},sanitizeWith:sanitizeWith,createUi:function(name,label){return function(items){return{name:name,type:"selectbox",label:label,items:items}}},getValue:getValue},Cell=function(initial){function get(){return value}var value=initial;return{get:get,set:function(v){value=v},clone:function(){return Cell(get())}}},DialogChanges_init=function(initialData,linkSettings){function onCatalogChange(data,change){var catalog=function(settings,fieldName){return"link"===fieldName?settings.catalogs.link:"anchor"===fieldName?settings.catalogs.anchor:Option.none()}(linkSettings,change.name).getOr([]);return getDelta(persistentText.get(),change.name,catalog,data)}var persistentText=Cell(initialData.text);return{onChange:function(getData,change){return"url"===change.name?function(data){if(persistentText.get().length<=0){var urlText=void 0!==data.url.meta.text?data.url.meta.text:data.url.value,urlTitle=void 0!==data.url.meta.title?data.url.meta.title:"";return Option.some({text:urlText,title:urlTitle})}return Option.none()}(getData()):contains(["anchor","link"],change.name)?onCatalogChange(getData(),change):("text"===change.name&&persistentText.set(getData().text),Option.none())}}},exports$1={},module={exports:exports$1};!function(define,exports,module,require){!function(f){if("object"==typeof exports&&void 0!==module)module.exports=f();else if("function"==typeof define&&define.amd)define([],f);else{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).EphoxContactWrapper=f()}}(function(){return function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c="function"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error("Cannot find module '"+i+"'");throw a.code="MODULE_NOT_FOUND",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){return o(e[i][1][r]||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u="function"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}({1:[function(require,module,exports){var cachedSetTimeout,cachedClearTimeout,process=module.exports={};function defaultSetTimout(){throw new Error("setTimeout has not been defined")}function defaultClearTimeout(){throw new Error("clearTimeout has not been defined")}function runTimeout(fun){if(cachedSetTimeout===setTimeout)return setTimeout(fun,0);if((cachedSetTimeout===defaultSetTimout||!cachedSetTimeout)&&setTimeout)return cachedSetTimeout=setTimeout,setTimeout(fun,0);try{return cachedSetTimeout(fun,0)}catch(e){try{return cachedSetTimeout.call(null,fun,0)}catch(e){return cachedSetTimeout.call(this,fun,0)}}}!function(){try{cachedSetTimeout="function"==typeof setTimeout?setTimeout:defaultSetTimout}catch(e){cachedSetTimeout=defaultSetTimout}try{cachedClearTimeout="function"==typeof clearTimeout?clearTimeout:defaultClearTimeout}catch(e){cachedClearTimeout=defaultClearTimeout}}();var currentQueue,queue=[],draining=!1,queueIndex=-1;function cleanUpNextTick(){draining&&currentQueue&&(draining=!1,currentQueue.length?queue=currentQueue.concat(queue):queueIndex=-1,queue.length&&drainQueue())}function drainQueue(){if(!draining){var timeout=runTimeout(cleanUpNextTick);draining=!0;for(var len=queue.length;len;){for(currentQueue=queue,queue=[];++queueIndex<len;)currentQueue&&currentQueue[queueIndex].run();queueIndex=-1,len=queue.length}currentQueue=null,draining=!1,function(marker){if(cachedClearTimeout===clearTimeout)return clearTimeout(marker);if((cachedClearTimeout===defaultClearTimeout||!cachedClearTimeout)&&clearTimeout)return cachedClearTimeout=clearTimeout,clearTimeout(marker);try{cachedClearTimeout(marker)}catch(e){try{return cachedClearTimeout.call(null,marker)}catch(e){return cachedClearTimeout.call(this,marker)}}}(timeout)}}function Item(fun,array){this.fun=fun,this.array=array}function noop(){}process.nextTick=function(fun){var args=new Array(arguments.length-1);if(1<arguments.length)for(var i=1;i<arguments.length;i++)args[i-1]=arguments[i];queue.push(new Item(fun,args)),1!==queue.length||draining||runTimeout(drainQueue)},Item.prototype.run=function(){this.fun.apply(null,this.array)},process.title="browser",process.browser=!0,process.env={},process.argv=[],process.version="",process.versions={},process.on=noop,process.addListener=noop,process.once=noop,process.off=noop,process.removeListener=noop,process.removeAllListeners=noop,process.emit=noop,process.prependListener=noop,process.prependOnceListener=noop,process.listeners=function(name){return[]},process.binding=function(name){throw new Error("process.binding is not supported")},process.cwd=function(){return"/"},process.chdir=function(dir){throw new Error("process.chdir is not supported")},process.umask=function(){return 0}},{}],2:[function(require,module,exports){(function(setImmediate){function noop(){}function Promise(fn){if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");if("function"!=typeof fn)throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],doResolve(fn,this)}function handle(self,deferred){for(;3===self._state;)self=self._value;0!==self._state?(self._handled=!0,Promise._immediateFn(function(){var cb=1===self._state?deferred.onFulfilled:deferred.onRejected;if(null!==cb){var ret;try{ret=cb(self._value)}catch(e){return void reject(deferred.promise,e)}resolve(deferred.promise,ret)}else(1===self._state?resolve:reject)(deferred.promise,self._value)})):self._deferreds.push(deferred)}function resolve(self,newValue){try{if(newValue===self)throw new TypeError("A promise cannot be resolved with itself.");if(newValue&&("object"==typeof newValue||"function"==typeof newValue)){var then=newValue.then;if(newValue instanceof Promise)return self._state=3,self._value=newValue,void finale(self);if("function"==typeof then)return void doResolve(function(fn,thisArg){return function(){fn.apply(thisArg,arguments)}}(then,newValue),self)}self._state=1,self._value=newValue,finale(self)}catch(e){reject(self,e)}}function reject(self,newValue){self._state=2,self._value=newValue,finale(self)}function finale(self){2===self._state&&0===self._deferreds.length&&Promise._immediateFn(function(){self._handled||Promise._unhandledRejectionFn(self._value)});for(var i=0,len=self._deferreds.length;i<len;i++)handle(self,self._deferreds[i]);self._deferreds=null}function Handler(onFulfilled,onRejected,promise){this.onFulfilled="function"==typeof onFulfilled?onFulfilled:null,this.onRejected="function"==typeof onRejected?onRejected:null,this.promise=promise}function doResolve(fn,self){var done=!1;try{fn(function(value){done||(done=!0,resolve(self,value))},function(reason){done||(done=!0,reject(self,reason))})}catch(ex){if(done)return;done=!0,reject(self,ex)}}var root,setTimeoutFunc;root=this,setTimeoutFunc=setTimeout,Promise.prototype.catch=function(onRejected){return this.then(null,onRejected)},Promise.prototype.then=function(onFulfilled,onRejected){var prom=new this.constructor(noop);return handle(this,new Handler(onFulfilled,onRejected,prom)),prom},Promise.all=function(arr){var args=Array.prototype.slice.call(arr);return new Promise(function(resolve,reject){if(0===args.length)return resolve([]);var remaining=args.length;function res(i,val){try{if(val&&("object"==typeof val||"function"==typeof val)){var then=val.then;if("function"==typeof then)return void then.call(val,function(val){res(i,val)},reject)}args[i]=val,0==--remaining&&resolve(args)}catch(ex){reject(ex)}}for(var i=0;i<args.length;i++)res(i,args[i])})},Promise.resolve=function(value){return value&&"object"==typeof value&&value.constructor===Promise?value:new Promise(function(resolve){resolve(value)})},Promise.reject=function(value){return new Promise(function(resolve,reject){reject(value)})},Promise.race=function(values){return new Promise(function(resolve,reject){for(var i=0,len=values.length;i<len;i++)values[i].then(resolve,reject)})},Promise._immediateFn="function"==typeof setImmediate?function(fn){setImmediate(fn)}:function(fn){setTimeoutFunc(fn,0)},Promise._unhandledRejectionFn=function(err){"undefined"!=typeof console&&console&&console.warn("Possible Unhandled Promise Rejection:",err)},Promise._setImmediateFn=function(fn){Promise._immediateFn=fn},Promise._setUnhandledRejectionFn=function(fn){Promise._unhandledRejectionFn=fn},void 0!==module&&module.exports?module.exports=Promise:root.Promise||(root.Promise=Promise)}).call(this,require("timers").setImmediate)},{timers:3}],3:[function(require,module,exports){(function(setImmediate,clearImmediate){var nextTick=require("process/browser.js").nextTick,apply=Function.prototype.apply,slice=Array.prototype.slice,immediateIds={},nextImmediateId=0;function Timeout(id,clearFn){this._id=id,this._clearFn=clearFn}exports.setTimeout=function(){return new Timeout(apply.call(setTimeout,window,arguments),clearTimeout)},exports.setInterval=function(){return new Timeout(apply.call(setInterval,window,arguments),clearInterval)},exports.clearTimeout=exports.clearInterval=function(timeout){timeout.close()},Timeout.prototype.unref=Timeout.prototype.ref=function(){},Timeout.prototype.close=function(){this._clearFn.call(window,this._id)},exports.enroll=function(item,msecs){clearTimeout(item._idleTimeoutId),item._idleTimeout=msecs},exports.unenroll=function(item){clearTimeout(item._idleTimeoutId),item._idleTimeout=-1},exports._unrefActive=exports.active=function(item){clearTimeout(item._idleTimeoutId);var msecs=item._idleTimeout;0<=msecs&&(item._idleTimeoutId=setTimeout(function(){item._onTimeout&&item._onTimeout()},msecs))},exports.setImmediate="function"==typeof setImmediate?setImmediate:function(fn){var id=nextImmediateId++,args=!(arguments.length<2)&&slice.call(arguments,1);return immediateIds[id]=!0,nextTick(function(){immediateIds[id]&&(args?fn.apply(null,args):fn.call(null),exports.clearImmediate(id))}),id},exports.clearImmediate="function"==typeof clearImmediate?clearImmediate:function(id){delete immediateIds[id]}}).call(this,require("timers").setImmediate,require("timers").clearImmediate)},{"process/browser.js":1,timers:3}],4:[function(require,module,exports){var promisePolyfill=require("promise-polyfill"),Global="undefined"!=typeof window?window:Function("return this;")();module.exports={boltExport:Global.Promise||promisePolyfill}},{"promise-polyfill":2}]},{},[4])(4)})}(void 0,exports$1,module,void 0);function errorReporter(err){domGlobals.setTimeout(function(){throw err},0)}function tryEmailTransform(data){var url=data.href;return 0<url.indexOf("@")&&-1===url.indexOf("//")&&-1===url.indexOf("mailto:")?Option.some({message:"The URL you entered seems to be an email address. Do you want to add the required mailto: prefix?",preprocess:function(oldData){return __assign(__assign({},oldData),{href:"mailto:"+url})}}):Option.none()}function nonEmptyAttr(dom,elem,name){var val=dom.getAttrib(elem,name);return null!==val&&0<val.length?Option.some(val):Option.none()}function handleSubmit(editor,info){return function(api){var data=api.getData();if(!data.url.value)return Utils_unlink(editor),void api.close();function getChangedValue(key){return Option.from(data[key]).filter(function(value){return!info.anchor[key].is(value)})}var changedData={href:data.url.value,text:getChangedValue("text"),target:getChangedValue("target"),rel:getChangedValue("rel"),class:getChangedValue("linkClass"),title:getChangedValue("title")},attachState={href:data.url.value,attach:void 0!==data.url.meta&&data.url.meta.attach?data.url.meta.attach:function(){}};DialogConfirms_preprocess(editor,changedData).get(function(pData){Utils_link(editor,attachState,pData)}),api.close()}}function getLink(editor,elm){return editor.dom.getParent(elm,"a[href]")}function getSelectedLink(editor){return getLink(editor,editor.selection.getStart())}function gotoLink(editor,a){if(a){var href=Utils_getHref(a);if(/^#/.test(href)){var targetEl=editor.$(href);targetEl.length&&editor.selection.scrollIntoView(targetEl[0],!0)}else OpenUrl_open(a.href)}}var Promise=module.exports.boltExport,nu=function(baseFn){var data=Option.none(),callbacks=[],get=function(nCallback){isReady()?call(nCallback):callbacks.push(nCallback)},isReady=function(){return data.isSome()},run=function(cbs){each(cbs,call)},call=function(cb){data.each(function(x){domGlobals.setTimeout(function(){cb(x)},0)})};return baseFn(function(x){data=Option.some(x),run(callbacks),callbacks=[]}),{get:get,map:function(f){return nu(function(nCallback){get(function(data){nCallback(f(data))})})},isReady:isReady}},LazyValue={nu:nu,pure:function(a){return nu(function(callback){callback(a)})}},make=function(run){function get(callback){run().then(callback,errorReporter)}return{map:function(fab){return make(function(){return run().then(fab)})},bind:function(aFutureB){return make(function(){return run().then(function(v){return aFutureB(v).toPromise()})})},anonBind:function(futureB){return make(function(){return run().then(function(){return futureB.toPromise()})})},toLazy:function(){return LazyValue.nu(get)},toCached:function(){var cache=null;return make(function(){return null===cache&&(cache=run()),cache})},toPromise:run,get:get}},Future_nu=function(baseFn){return make(function(){return new Promise(baseFn)})},Future_pure=function(a){return make(function(){return Promise.resolve(a)})},global$4=tinymce.util.Tools.resolve("tinymce.util.Delay"),DialogConfirms_preprocess=function(editor,data){return findMap([tryEmailTransform,function(assumeExternalTargets,defaultLinkProtocol){return function(data){var url=data.href;return 1===assumeExternalTargets&&!Utils_hasProtocol(url)||0===assumeExternalTargets&&/^\s*www[\.|\d\.]/i.test(url)?Option.some({message:"The URL you entered seems to be an external link. Do you want to add the required "+defaultLinkProtocol+":// prefix?",preprocess:function(oldData){return __assign(__assign({},oldData),{href:defaultLinkProtocol+"://"+url})}}):Option.none()}}(Settings_assumeExternalTargets(editor),Settings_getDefaultLinkProtocol(editor))],function(f){return f(data)}).fold(function(){return Future_pure(data)},function(transform){return Future_nu(function(callback){!function(editor,message,callback){var rng=editor.selection.getRng();global$4.setEditorTimeout(editor,function(){editor.windowManager.confirm(message,function(state){editor.selection.setRng(rng),callback(state)})})}(editor,transform.message,function(state){callback(state?transform.preprocess(data):data)})})})},AnchorListOptions_getAnchors=function(editor){var anchorNodes=editor.dom.select("a:not([href])"),anchors=bind(anchorNodes,function(anchor){var id=anchor.name||anchor.id;return id?[{text:id,value:"#"+id}]:[]});return 0<anchors.length?Option.some([{text:"None",value:""}].concat(anchors)):Option.none()},ClassListOptions_getClasses=function(editor){var list=Settings_getLinkClassList(editor);return 0<list.length?ListOptions.sanitize(list):Option.none()},global$5=tinymce.util.Tools.resolve("tinymce.util.XHR"),LinkListOptions_getLinks=function(editor){function extractor(item){return editor.convertURL(item.value||item.url,"href")}var linkList=Settings_getLinkList(editor);return Future_nu(function(callback){isString(linkList)?global$5.send({url:linkList,success:function(text){return callback(function(text){try{return Option.some(JSON.parse(text))}catch(err){return Option.none()}}(text))},error:function(_){return callback(Option.none())}}):isFunction(linkList)?linkList(function(output){return callback(Option.some(output))}):callback(Option.from(linkList))}).map(function(optItems){return optItems.bind(ListOptions.sanitizeWith(extractor)).map(function(items){return 0<items.length?[{text:"None",value:""}].concat(items):items})})},RelOptions_getRels=function(editor,initialTarget){var list=Settings_getRelList(editor);if(0<list.length){var isTargetBlank_1=initialTarget.is("_blank");return(!1===Settings_allowUnsafeLinkTarget(editor)?ListOptions.sanitizeWith(function(item){return Utils_applyRelTargetRules(ListOptions.getValue(item),isTargetBlank_1)}):ListOptions.sanitize)(list)}return Option.none()},fallbacks=[{text:"Current window",value:""},{text:"New window",value:"_blank"}],TargetOptions_getTargets=function(editor){var list=Settings_getTargetList(editor);return isArray(list)?ListOptions.sanitize(list).orThunk(function(){return Option.some(fallbacks)}):!1===list?Option.none():Option.some(fallbacks)},DialogInfo_collect=function(editor,linkNode){return LinkListOptions_getLinks(editor).map(function(links){var anchor=function(editor,anchor){var dom=editor.dom,text=Utils_isOnlyTextSelected(editor.selection.getContent())?Option.some(Utils_getAnchorText(editor.selection,anchor)):Option.none(),url=anchor?Option.some(dom.getAttrib(anchor,"href")):Option.none(),target=anchor?Option.from(dom.getAttrib(anchor,"target")):Option.none(),rel=nonEmptyAttr(dom,anchor,"rel"),linkClass=nonEmptyAttr(dom,anchor,"class");return{url:url,text:text,title:nonEmptyAttr(dom,anchor,"title"),target:target,rel:rel,linkClass:linkClass}}(editor,linkNode);return{anchor:anchor,catalogs:{targets:TargetOptions_getTargets(editor),rels:RelOptions_getRels(editor,anchor.target),classes:ClassListOptions_getClasses(editor),anchor:AnchorListOptions_getAnchors(editor),link:links},optNode:Option.from(linkNode),flags:{titleEnabled:Settings_shouldShowLinkTitle(editor)}}})},Dialog_open=function(editor){(function(editor){var anchorNode=Utils_getAnchorElement(editor);return DialogInfo_collect(editor,anchorNode)})(editor).map(function(info){return function(settings,onSubmit,editor){var displayText=settings.anchor.text.map(function(){return{name:"text",type:"input",label:"Text to display"}}).toArray(),titleText=settings.flags.titleEnabled?[{name:"title",type:"input",label:"Title"}]:[],initialData=function(info,defaultTarget){return{url:{value:info.anchor.url.getOr(""),meta:{attach:function(){},text:info.anchor.url.fold(function(){return""},function(){return info.anchor.text.getOr("")}),original:{value:info.anchor.url.getOr("")}}},text:info.anchor.text.getOr(""),title:info.anchor.title.getOr(""),anchor:info.anchor.url.getOr(""),link:info.anchor.url.getOr(""),rel:info.anchor.rel.getOr(""),target:info.anchor.target.or(defaultTarget).getOr(""),linkClass:info.anchor.linkClass.getOr("")}}(settings,Option.from(Settings_getDefaultLinkTarget(editor))),dialogDelta=DialogChanges_init(initialData,settings),catalogs=settings.catalogs;return{title:"Insert/Edit Link",size:"normal",body:{type:"panel",items:flatten([[{name:"url",type:"urlinput",filetype:"file",label:"URL"}],displayText,titleText,function(arr){for(var r=[],push=function(x){r.push(x)},i=0;i<arr.length;i++)arr[i].each(push);return r}([catalogs.anchor.map(ListOptions.createUi("anchor","Anchors")),catalogs.rels.map(ListOptions.createUi("rel","Rel")),catalogs.targets.map(ListOptions.createUi("target","Open link in...")),catalogs.link.map(ListOptions.createUi("link","Link list")),catalogs.classes.map(ListOptions.createUi("linkClass","Class"))])])},buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"save",text:"Save",primary:!0}],initialData:initialData,onChange:function(api,_a){var name=_a.name;dialogDelta.onChange(api.getData,{name:name}).each(function(newData){api.setData(newData)})},onSubmit:onSubmit}}(info,handleSubmit(editor,info),editor)}).get(function(spec){editor.windowManager.open(spec)})},Actions_openDialog=function(editor){return function(){Dialog_open(editor)}},Actions_gotoSelectedLink=function(editor){return function(){gotoLink(editor,getSelectedLink(editor))}},Actions_setupGotoLinks=function(editor){editor.on("click",function(e){var link=getLink(editor,e.target);link&&global$2.metaKeyPressed(e)&&(e.preventDefault(),gotoLink(editor,link))}),editor.on("keydown",function(e){var link=getSelectedLink(editor);link&&13===e.keyCode&&function(e){return!0===e.altKey&&!1===e.shiftKey&&!1===e.ctrlKey&&!1===e.metaKey}(e)&&(e.preventDefault(),gotoLink(editor,link))})},Actions_toggleActiveState=function(editor){return function(api){function nodeChangeHandler(e){return api.setActive(!editor.mode.isReadOnly()&&!!Utils_getAnchorElement(editor,e.element))}return editor.on("NodeChange",nodeChangeHandler),function(){return editor.off("NodeChange",nodeChangeHandler)}}},Actions_toggleEnabledState=function(editor){return function(api){var parents=editor.dom.getParents(editor.selection.getStart());api.setDisabled(!Utils_hasLinks(parents));function nodeChangeHandler(e){return api.setDisabled(!Utils_hasLinks(e.parents))}return editor.on("NodeChange",nodeChangeHandler),function(){return editor.off("NodeChange",nodeChangeHandler)}}},Commands_register=function(editor){editor.addCommand("mceLink",function(){Settings_useQuickLink(editor)?editor.fire("contexttoolbar-show",{toolbarKey:"quicklink"}):Actions_openDialog(editor)()})},Keyboard_setup=function(editor){editor.addShortcut("Meta+K","",function(){editor.execCommand("mceLink")})},Controls_setupButtons=function(editor){editor.ui.registry.addToggleButton("link",{icon:"link",tooltip:"Insert/edit link",onAction:Actions_openDialog(editor),onSetup:Actions_toggleActiveState(editor)}),editor.ui.registry.addButton("openlink",{icon:"new-tab",tooltip:"Open link",onAction:Actions_gotoSelectedLink(editor),onSetup:Actions_toggleEnabledState(editor)}),editor.ui.registry.addButton("unlink",{icon:"unlink",tooltip:"Remove link",onAction:function(){return Utils_unlink(editor)},onSetup:Actions_toggleEnabledState(editor)})},Controls_setupMenuItems=function(editor){editor.ui.registry.addMenuItem("openlink",{text:"Open link",icon:"new-tab",onAction:Actions_gotoSelectedLink(editor),onSetup:Actions_toggleEnabledState(editor)}),editor.ui.registry.addMenuItem("link",{icon:"link",text:"Link...",shortcut:"Meta+K",onAction:Actions_openDialog(editor)}),editor.ui.registry.addMenuItem("unlink",{icon:"unlink",text:"Remove link",onAction:function(){return Utils_unlink(editor)},onSetup:Actions_toggleEnabledState(editor)})},Controls_setupContextMenu=function(editor){editor.ui.registry.addContextMenu("link",{update:function(element){return Utils_hasLinks(editor.dom.getParents(element,"a"))?"link unlink openlink":"link"}})},Controls_setupContextToolbars=function(editor){function onSetupLink(buttonApi){var node=editor.selection.getNode();return buttonApi.setDisabled(!Utils_getAnchorElement(editor,node)),function(){}}editor.ui.registry.addContextForm("quicklink",{launch:{type:"contextformtogglebutton",icon:"link",tooltip:"Link",onSetup:Actions_toggleActiveState(editor)},label:"Link",predicate:function(node){return!!Utils_getAnchorElement(editor,node)&&Settings_hasContextToolbar(editor)},initValue:function(){var elm=Utils_getAnchorElement(editor);return elm?Utils_getHref(elm):""},commands:[{type:"contextformtogglebutton",icon:"link",tooltip:"Link",primary:!0,onSetup:function(buttonApi){var node=editor.selection.getNode();return buttonApi.setActive(!!Utils_getAnchorElement(editor,node)),Actions_toggleActiveState(editor)(buttonApi)},onAction:function(formApi){var anchor=Utils_getAnchorElement(editor),value=formApi.getValue();if(anchor)editor.dom.setAttrib(anchor,"href",value),function(editor){editor.selection.collapse(!1)}(editor),formApi.hide();else{var attachState={href:value,attach:function(){}},text=Utils_isOnlyTextSelected(editor.selection.getContent())?Option.some(Utils_getAnchorText(editor.selection,anchor)).filter(function(t){return 0<t.length}).or(Option.from(value)):Option.none();Utils_link(editor,attachState,{href:value,text:text,title:Option.none(),rel:Option.none(),target:Option.none(),class:Option.none()}),formApi.hide()}}},{type:"contextformbutton",icon:"unlink",tooltip:"Remove link",onSetup:onSetupLink,onAction:function(formApi){Utils_unlink(editor),formApi.hide()}},{type:"contextformbutton",icon:"new-tab",tooltip:"Open link",onSetup:onSetupLink,onAction:function(formApi){Actions_gotoSelectedLink(editor)(),formApi.hide()}}]})};global$1.add("link",function(editor){Controls_setupButtons(editor),Controls_setupMenuItems(editor),Controls_setupContextMenu(editor),Controls_setupContextToolbars(editor),Actions_setupGotoLinks(editor),Commands_register(editor),Keyboard_setup(editor)})}(window),function(domGlobals){"use strict";tinymce.util.Tools.resolve("tinymce.PluginManager").add("textcolor",function(){domGlobals.console.warn("Text color plugin is now built in to the core editor, please remove it from your editor configuration")})}(window),function(domGlobals){"use strict";function noop(){}function constant(value){return function(){return value}}function identity(x){return x}function none(){return NONE}var me,global$1=tinymce.util.Tools.resolve("tinymce.PluginManager"),never=constant(!1),always=constant(!0),NONE=(me={fold:function(n,s){return n()},is:never,isSome:never,isNone:always,getOr:id,getOrThunk:call,getOrDie:function(msg){throw new Error(msg||"error: getOrDie called on none.")},getOrNull:constant(null),getOrUndefined:constant(void 0),or:id,orThunk:call,map:none,each:noop,bind:none,exists:never,forall:always,filter:none,equals:eq,equals_:eq,toArray:function(){return[]},toString:constant("none()")},Object.freeze&&Object.freeze(me),me);function eq(o){return o.isNone()}function call(thunk){return thunk()}function id(n){return n}function isType(type){return function(value){return function(x){if(null===x)return"null";var t=typeof x;return"object"==t&&(Array.prototype.isPrototypeOf(x)||x.constructor&&"Array"===x.constructor.name)?"array":"object"==t&&(String.prototype.isPrototypeOf(x)||x.constructor&&"String"===x.constructor.name)?"string":t}(value)===type}}function flatten(xs){for(var r=[],i=0,len=xs.length;i<len;++i){if(!isArray(xs[i]))throw new Error("Arr.flatten item "+i+" was not an array, input: "+xs);nativePush.apply(r,xs[i])}return r}var some=function(a){function self(){return me}function bind(f){return f(a)}var constant_a=constant(a),me={fold:function(n,s){return s(a)},is:function(v){return a===v},isSome:always,isNone:never,getOr:constant_a,getOrThunk:constant_a,getOrDie:constant_a,getOrNull:constant_a,getOrUndefined:constant_a,or:self,orThunk:self,map:function(f){return some(f(a))},each:function(f){f(a)},bind:bind,exists:bind,forall:bind,filter:function(f){return f(a)?me:NONE},toArray:function(){return[a]},toString:function(){return"some("+a+")"},equals:function(o){return o.is(a)},equals_:function(o,elementEq){return o.fold(never,function(b){return elementEq(a,b)})}};return me},Option={some:some,none:none,from:function(value){return null==value?NONE:some(value)}},isString=isType("string"),isObject=isType("object"),isArray=isType("array"),isBoolean=isType("boolean"),isFunction=isType("function"),isNumber=isType("number"),nativeSlice=Array.prototype.slice,nativePush=Array.prototype.push,__assign=(isFunction(Array.from)&&Array.from,function(){return(__assign=Object.assign||function(t){for(var s,i=1,n=arguments.length;i<n;i++)for(var p in s=arguments[i])Object.prototype.hasOwnProperty.call(s,p)&&(t[p]=s[p]);return t}).apply(this,arguments)}),exports$1={},module={exports:exports$1};!function(define,exports,module,require){!function(f){if("object"==typeof exports&&void 0!==module)module.exports=f();else if("function"==typeof define&&define.amd)define([],f);else{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).EphoxContactWrapper=f()}}(function(){return function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c="function"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error("Cannot find module '"+i+"'");throw a.code="MODULE_NOT_FOUND",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){return o(e[i][1][r]||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u="function"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}({1:[function(require,module,exports){var cachedSetTimeout,cachedClearTimeout,process=module.exports={};function defaultSetTimout(){throw new Error("setTimeout has not been defined")}function defaultClearTimeout(){throw new Error("clearTimeout has not been defined")}function runTimeout(fun){if(cachedSetTimeout===setTimeout)return setTimeout(fun,0);if((cachedSetTimeout===defaultSetTimout||!cachedSetTimeout)&&setTimeout)return cachedSetTimeout=setTimeout,setTimeout(fun,0);try{return cachedSetTimeout(fun,0)}catch(e){try{return cachedSetTimeout.call(null,fun,0)}catch(e){return cachedSetTimeout.call(this,fun,0)}}}!function(){try{cachedSetTimeout="function"==typeof setTimeout?setTimeout:defaultSetTimout}catch(e){cachedSetTimeout=defaultSetTimout}try{cachedClearTimeout="function"==typeof clearTimeout?clearTimeout:defaultClearTimeout}catch(e){cachedClearTimeout=defaultClearTimeout}}();var currentQueue,queue=[],draining=!1,queueIndex=-1;function cleanUpNextTick(){draining&&currentQueue&&(draining=!1,currentQueue.length?queue=currentQueue.concat(queue):queueIndex=-1,queue.length&&drainQueue())}function drainQueue(){if(!draining){var timeout=runTimeout(cleanUpNextTick);draining=!0;for(var len=queue.length;len;){for(currentQueue=queue,queue=[];++queueIndex<len;)currentQueue&&currentQueue[queueIndex].run();queueIndex=-1,len=queue.length}currentQueue=null,draining=!1,function(marker){if(cachedClearTimeout===clearTimeout)return clearTimeout(marker);if((cachedClearTimeout===defaultClearTimeout||!cachedClearTimeout)&&clearTimeout)return cachedClearTimeout=clearTimeout,clearTimeout(marker);try{cachedClearTimeout(marker)}catch(e){try{return cachedClearTimeout.call(null,marker)}catch(e){return cachedClearTimeout.call(this,marker)}}}(timeout)}}function Item(fun,array){this.fun=fun,this.array=array}function noop(){}process.nextTick=function(fun){var args=new Array(arguments.length-1);if(1<arguments.length)for(var i=1;i<arguments.length;i++)args[i-1]=arguments[i];queue.push(new Item(fun,args)),1!==queue.length||draining||runTimeout(drainQueue)},Item.prototype.run=function(){this.fun.apply(null,this.array)},process.title="browser",process.browser=!0,process.env={},process.argv=[],process.version="",process.versions={},process.on=noop,process.addListener=noop,process.once=noop,process.off=noop,process.removeListener=noop,process.removeAllListeners=noop,process.emit=noop,process.prependListener=noop,process.prependOnceListener=noop,process.listeners=function(name){return[]},process.binding=function(name){throw new Error("process.binding is not supported")},process.cwd=function(){return"/"},process.chdir=function(dir){throw new Error("process.chdir is not supported")},process.umask=function(){return 0}},{}],2:[function(require,module,exports){(function(setImmediate){function noop(){}function Promise(fn){if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");if("function"!=typeof fn)throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],doResolve(fn,this)}function handle(self,deferred){for(;3===self._state;)self=self._value;0!==self._state?(self._handled=!0,Promise._immediateFn(function(){var cb=1===self._state?deferred.onFulfilled:deferred.onRejected;if(null!==cb){var ret;try{ret=cb(self._value)}catch(e){return void reject(deferred.promise,e)}resolve(deferred.promise,ret)}else(1===self._state?resolve:reject)(deferred.promise,self._value)})):self._deferreds.push(deferred)}function resolve(self,newValue){try{if(newValue===self)throw new TypeError("A promise cannot be resolved with itself.");if(newValue&&("object"==typeof newValue||"function"==typeof newValue)){var then=newValue.then;if(newValue instanceof Promise)return self._state=3,self._value=newValue,void finale(self);if("function"==typeof then)return void doResolve(function(fn,thisArg){return function(){fn.apply(thisArg,arguments)}}(then,newValue),self)}self._state=1,self._value=newValue,finale(self)}catch(e){reject(self,e)}}function reject(self,newValue){self._state=2,self._value=newValue,finale(self)}function finale(self){2===self._state&&0===self._deferreds.length&&Promise._immediateFn(function(){self._handled||Promise._unhandledRejectionFn(self._value)});for(var i=0,len=self._deferreds.length;i<len;i++)handle(self,self._deferreds[i]);self._deferreds=null}function Handler(onFulfilled,onRejected,promise){this.onFulfilled="function"==typeof onFulfilled?onFulfilled:null,this.onRejected="function"==typeof onRejected?onRejected:null,this.promise=promise}function doResolve(fn,self){var done=!1;try{fn(function(value){done||(done=!0,resolve(self,value))},function(reason){done||(done=!0,reject(self,reason))})}catch(ex){if(done)return;done=!0,reject(self,ex)}}var root,setTimeoutFunc;root=this,setTimeoutFunc=setTimeout,Promise.prototype.catch=function(onRejected){return this.then(null,onRejected)},Promise.prototype.then=function(onFulfilled,onRejected){var prom=new this.constructor(noop);return handle(this,new Handler(onFulfilled,onRejected,prom)),prom},Promise.all=function(arr){var args=Array.prototype.slice.call(arr);return new Promise(function(resolve,reject){if(0===args.length)return resolve([]);var remaining=args.length;function res(i,val){try{if(val&&("object"==typeof val||"function"==typeof val)){var then=val.then;if("function"==typeof then)return void then.call(val,function(val){res(i,val)},reject)}args[i]=val,0==--remaining&&resolve(args)}catch(ex){reject(ex)}}for(var i=0;i<args.length;i++)res(i,args[i])})},Promise.resolve=function(value){return value&&"object"==typeof value&&value.constructor===Promise?value:new Promise(function(resolve){resolve(value)})},Promise.reject=function(value){return new Promise(function(resolve,reject){reject(value)})},Promise.race=function(values){return new Promise(function(resolve,reject){for(var i=0,len=values.length;i<len;i++)values[i].then(resolve,reject)})},Promise._immediateFn="function"==typeof setImmediate?function(fn){setImmediate(fn)}:function(fn){setTimeoutFunc(fn,0)},Promise._unhandledRejectionFn=function(err){"undefined"!=typeof console&&console&&console.warn("Possible Unhandled Promise Rejection:",err)},Promise._setImmediateFn=function(fn){Promise._immediateFn=fn},Promise._setUnhandledRejectionFn=function(fn){Promise._unhandledRejectionFn=fn},void 0!==module&&module.exports?module.exports=Promise:root.Promise||(root.Promise=Promise)}).call(this,require("timers").setImmediate)},{timers:3}],3:[function(require,module,exports){(function(setImmediate,clearImmediate){var nextTick=require("process/browser.js").nextTick,apply=Function.prototype.apply,slice=Array.prototype.slice,immediateIds={},nextImmediateId=0;function Timeout(id,clearFn){this._id=id,this._clearFn=clearFn}exports.setTimeout=function(){return new Timeout(apply.call(setTimeout,window,arguments),clearTimeout)},exports.setInterval=function(){return new Timeout(apply.call(setInterval,window,arguments),clearInterval)},exports.clearTimeout=exports.clearInterval=function(timeout){timeout.close()},Timeout.prototype.unref=Timeout.prototype.ref=function(){},Timeout.prototype.close=function(){this._clearFn.call(window,this._id)},exports.enroll=function(item,msecs){clearTimeout(item._idleTimeoutId),item._idleTimeout=msecs},exports.unenroll=function(item){clearTimeout(item._idleTimeoutId),item._idleTimeout=-1},exports._unrefActive=exports.active=function(item){clearTimeout(item._idleTimeoutId);var msecs=item._idleTimeout;0<=msecs&&(item._idleTimeoutId=setTimeout(function(){item._onTimeout&&item._onTimeout()},msecs))},exports.setImmediate="function"==typeof setImmediate?setImmediate:function(fn){var id=nextImmediateId++,args=!(arguments.length<2)&&slice.call(arguments,1);return immediateIds[id]=!0,nextTick(function(){immediateIds[id]&&(args?fn.apply(null,args):fn.call(null),exports.clearImmediate(id))}),id},exports.clearImmediate="function"==typeof clearImmediate?clearImmediate:function(id){delete immediateIds[id]}}).call(this,require("timers").setImmediate,require("timers").clearImmediate)},{"process/browser.js":1,timers:3}],4:[function(require,module,exports){var promisePolyfill=require("promise-polyfill"),Global="undefined"!=typeof window?window:Function("return this;")();module.exports={boltExport:Global.Promise||promisePolyfill}},{"promise-polyfill":2}]},{},[4])(4)})}(void 0,exports$1,module,void 0);function errorReporter(err){domGlobals.setTimeout(function(){throw err},0)}function nu$2(worker){return wrap(Future_nu(worker))}function set(element,key,value){!function(dom,key,value){if(!(isString(value)||isBoolean(value)||isNumber(value)))throw domGlobals.console.error("Invalid call to Attr.set. Key ",key,":: Value ",value,":: Element ",dom),new Error("Attribute value was not simple");dom.setAttribute(key,value+"")}(element.dom(),key,value)}function parseIntAndGetMax(val1,val2){return Math.max(parseInt(val1,10),parseInt(val2,10))}function getHspace(image){return image.style.marginLeft&&image.style.marginRight&&image.style.marginLeft===image.style.marginRight?Utils_removePixelSuffix(image.style.marginLeft):""}function getVspace(image){return image.style.marginTop&&image.style.marginBottom&&image.style.marginTop===image.style.marginBottom?Utils_removePixelSuffix(image.style.marginTop):""}function getBorder(image){return image.style.borderWidth?Utils_removePixelSuffix(image.style.borderWidth):""}function getAttrib(image,name){return image.hasAttribute(name)?image.getAttribute(name):""}function getStyle(image,name){return image.style[name]?image.style[name]:""}function hasCaption(image){return null!==image.parentNode&&"FIGURE"===image.parentNode.nodeName}function setAttrib(image,name,value){image.setAttribute(name,value)}function toggleCaption(image){hasCaption(image)?function(image){var figureElm=image.parentNode;DOM.insertAfter(image,figureElm),DOM.remove(figureElm)}(image):function(image){var figureElm=DOM.create("figure",{class:"image"});DOM.insertAfter(figureElm,image),figureElm.appendChild(image),figureElm.appendChild(DOM.create("figcaption",{contentEditable:"true"},"Caption")),figureElm.contentEditable="false"}(image)}function normalizeStyle(image,normalizeCss){var attrValue=image.getAttribute("style"),value=normalizeCss(null!==attrValue?attrValue:"");0<value.length?(image.setAttribute("style",value),image.setAttribute("data-mce-style",value)):image.removeAttribute("style")}function setSize(name,normalizeCss){return function(image,name,value){image.style[name]?(image.style[name]=Utils_addPixelSuffix(value),normalizeStyle(image,normalizeCss)):setAttrib(image,name,value)}}function getSize(image,name){return image.style[name]?Utils_removePixelSuffix(image.style[name]):getAttrib(image,name)}function setHspace(image,value){var pxValue=Utils_addPixelSuffix(value);image.style.marginLeft=pxValue,image.style.marginRight=pxValue}function setVspace(image,value){var pxValue=Utils_addPixelSuffix(value);image.style.marginTop=pxValue,image.style.marginBottom=pxValue}function setBorder(image,value){var pxValue=Utils_addPixelSuffix(value);image.style.borderWidth=pxValue}function setBorderStyle(image,value){image.style.borderStyle=value}function isFigure(elm){return"FIGURE"===elm.nodeName}function getIsDecorative(image){return 0===DOM.getAttrib(image,"alt").length&&"presentation"===DOM.getAttrib(image,"role")}function getStyleValue(normalizeCss,data){var image=domGlobals.document.createElement("img");return setAttrib(image,"style",data.style),!getHspace(image)&&""===data.hspace||setHspace(image,data.hspace),!getVspace(image)&&""===data.vspace||setVspace(image,data.vspace),!getBorder(image)&&""===data.border||setBorder(image,data.border),!function(image){return getStyle(image,"borderStyle")}(image)&&""===data.borderStyle||setBorderStyle(image,data.borderStyle),normalizeCss(image.getAttribute("style"))}function read(normalizeCss,image){return{src:getAttrib(image,"src"),alt:function(image){return getIsDecorative(image)?"":getAttrib(image,"alt")}(image),title:getAttrib(image,"title"),width:getSize(image,"width"),height:getSize(image,"height"),class:getAttrib(image,"class"),style:normalizeCss(getAttrib(image,"style")),caption:hasCaption(image),hspace:getHspace(image),vspace:getVspace(image),border:getBorder(image),borderStyle:getStyle(image,"borderStyle"),isDecorative:getIsDecorative(image)}}function updateProp(image,oldData,newData,name,set){newData[name]!==oldData[name]&&set(image,name,newData[name])}function normalized(set,normalizeCss){return function(image,name,value){set(image,value),normalizeStyle(image,normalizeCss)}}function normalizeCss(editor,cssText){var css=editor.dom.styles.parse(cssText),mergedCss=Utils_mergeMargins(css),compressed=editor.dom.styles.parse(editor.dom.styles.serialize(mergedCss));return editor.dom.styles.serialize(compressed)}function getSelectedImage(editor){var imgElm=editor.selection.getNode(),figureElm=editor.dom.getParent(imgElm,"figure.image");return figureElm?editor.dom.select("img",figureElm)[0]:imgElm&&("IMG"!==imgElm.nodeName||Utils_isPlaceholderImage(imgElm))?null:imgElm}function splitTextBlock(editor,figure){var dom=editor.dom,textBlock=dom.getParent(figure.parentNode,function(node){return!!editor.schema.getTextBlockElements()[node.nodeName]},editor.getBody());return textBlock?dom.split(textBlock,figure):figure}function insertImageAtCaret(editor,data,info){var elm=function(normalizeCss,data,info){var image=domGlobals.document.createElement("img");if(write(normalizeCss,__assign(__assign({},data),{caption:!1}),image,info),setAlt(image,data.alt,data.isDecorative,info),data.caption){var figure=DOM.create("figure",{class:"image"});return figure.appendChild(image),figure.appendChild(DOM.create("figcaption",{contentEditable:"true"},"Caption")),figure.contentEditable="false",figure}return image}(function(css){return normalizeCss(editor,css)},data,info);editor.dom.setAttrib(elm,"data-mce-id","__mcenew"),editor.focus(),editor.selection.setContent(elm.outerHTML);var insertedElm=editor.dom.select('*[data-mce-id="__mcenew"]')[0];if(editor.dom.setAttrib(insertedElm,"data-mce-id",null),isFigure(insertedElm)){var figure=splitTextBlock(editor,insertedElm);editor.selection.select(figure)}else editor.selection.select(insertedElm)}function insertOrUpdateImage(editor,data,info){var image=getSelectedImage(editor);image?data.src?function(editor,data,info){var image=getSelectedImage(editor);if(write(function(css){return normalizeCss(editor,css)},data,image,info),function(editor,image){editor.dom.setAttrib(image,"src",image.getAttribute("src"))}(editor,image),isFigure(image.parentNode)){var figure=image.parentNode;splitTextBlock(editor,figure),editor.selection.select(image.parentNode)}else editor.selection.select(image),Utils_waitLoadImage(editor,data,image)}(editor,data,info):function(editor,image){if(image){var elm=editor.dom.is(image.parentNode,"figure.image")?image.parentNode:image;editor.dom.remove(elm),editor.focus(),editor.nodeChanged(),editor.dom.isEmpty(editor.getBody())&&(editor.setContent(""),editor.selection.setCursorLocation())}}(editor,image):data.src&&insertImageAtCaret(editor,data,info)}function getValue(item){return isString(item.value)?item.value:""}function sanitizer(extracter){return void 0===extracter&&(extracter=getValue),function(list){return list?Option.from(list).map(function(list){return sanitizeList(list,extracter)}):Option.none()}}var merger,Promise=module.exports.boltExport,nu=function(baseFn){var data=Option.none(),callbacks=[],get=function(nCallback){isReady()?call(nCallback):callbacks.push(nCallback)},isReady=function(){return data.isSome()},run=function(cbs){!function(xs,f){for(var i=0,len=xs.length;i<len;i++){f(xs[i],i)}}(cbs,call)},call=function(cb){data.each(function(x){domGlobals.setTimeout(function(){cb(x)},0)})};return baseFn(function(x){data=Option.some(x),run(callbacks),callbacks=[]}),{get:get,map:function(f){return nu(function(nCallback){get(function(data){nCallback(f(data))})})},isReady:isReady}},LazyValue={nu:nu,pure:function(a){return nu(function(callback){callback(a)})}},make=function(run){function get(callback){run().then(callback,errorReporter)}return{map:function(fab){return make(function(){return run().then(fab)})},bind:function(aFutureB){return make(function(){return run().then(function(v){return aFutureB(v).toPromise()})})},anonBind:function(futureB){return make(function(){return run().then(function(){return futureB.toPromise()})})},toLazy:function(){return LazyValue.nu(get)},toCached:function(){var cache=null;return make(function(){return null===cache&&(cache=run()),cache})},toPromise:run,get:get}},Future_nu=function(baseFn){return make(function(){return new Promise(baseFn)})},Future_pure=function(a){return make(function(){return Promise.resolve(a)})},value=function(o){return{is:function(v){return o===v},isValue:always,isError:never,getOr:constant(o),getOrThunk:constant(o),getOrDie:constant(o),or:function(opt){return value(o)},orThunk:function(f){return value(o)},fold:function(_,onValue){return onValue(o)},map:function(f){return value(f(o))},mapError:function(f){return value(o)},each:function(f){f(o)},bind:function(f){return f(o)},exists:function(f){return f(o)},forall:function(f){return f(o)},toOption:function(){return Option.some(o)}}},error=function(message){return{is:never,isValue:never,isError:always,getOr:identity,getOrThunk:function(f){return f()},getOrDie:function(){return function(msg){return function(){throw new Error(msg)}}(String(message))()},or:function(opt){return opt},orThunk:function(f){return f()},fold:function(onError,_){return onError(message)},map:function(f){return error(message)},mapError:function(f){return error(f(message))},each:noop,bind:function(f){return error(message)},exists:never,forall:always,toOption:Option.none}},Result={value:value,error:error,fromOption:function(opt,err){return opt.fold(function(){return error(err)},value)}},wrap=function(delegate){return __assign(__assign({},delegate),{toCached:function(){return wrap(delegate.toCached())},bindFuture:function(f){return wrap(delegate.bind(function(resA){return resA.fold(function(err){return Future_pure(Result.error(err))},function(a){return f(a)})}))},bindResult:function(f){return wrap(delegate.map(function(resA){return resA.bind(f)}))},mapResult:function(f){return wrap(delegate.map(function(resA){return resA.map(f)}))},mapError:function(f){return wrap(delegate.map(function(resA){return resA.mapError(f)}))},foldResult:function(whenError,whenValue){return delegate.map(function(res){return res.fold(whenError,whenValue)})},withTimeout:function(timeout,errorThunk){return wrap(Future_nu(function(callback){var timedOut=!1,timer=domGlobals.setTimeout(function(){timedOut=!0,callback(Result.error(errorThunk()))},timeout);delegate.get(function(result){timedOut||(domGlobals.clearTimeout(timer),callback(result))})}))}})},FutureResult_nu=nu$2,hasOwnProperty=Object.prototype.hasOwnProperty,deepMerge=(merger=function(old,nu){return isObject(old)&&isObject(nu)?deepMerge(old,nu):nu},function(){for(var objects=new Array(arguments.length),i=0;i<objects.length;i++)objects[i]=arguments[i];if(0===objects.length)throw new Error("Can't merge zero objects");for(var ret={},j=0;j<objects.length;j++){var curObject=objects[j];for(var key in curObject)hasOwnProperty.call(curObject,key)&&(ret[key]=merger(ret[key],curObject[key]))}return ret}),fromDom=(domGlobals.Node.ATTRIBUTE_NODE,domGlobals.Node.CDATA_SECTION_NODE,domGlobals.Node.COMMENT_NODE,domGlobals.Node.DOCUMENT_NODE,domGlobals.Node.DOCUMENT_TYPE_NODE,domGlobals.Node.DOCUMENT_FRAGMENT_NODE,domGlobals.Node.ELEMENT_NODE,domGlobals.Node.TEXT_NODE,domGlobals.Node.PROCESSING_INSTRUCTION_NODE,domGlobals.Node.ENTITY_REFERENCE_NODE,domGlobals.Node.ENTITY_NODE,domGlobals.Node.NOTATION_NODE,void 0!==domGlobals.window?domGlobals.window:Function("return this;")(),function(node){if(null==node)throw new Error("Node cannot be null or undefined");return{dom:constant(node)}}),Element={fromHtml:function(html,scope){var div=(scope||domGlobals.document).createElement("div");if(div.innerHTML=html,!div.hasChildNodes()||1<div.childNodes.length)throw domGlobals.console.error("HTML does not have a single root node",html),new Error("HTML must have a single root node");return fromDom(div.childNodes[0])},fromTag:function(tag,scope){var node=(scope||domGlobals.document).createElement(tag);return fromDom(node)},fromText:function(text,scope){var node=(scope||domGlobals.document).createTextNode(text);return fromDom(node)},fromDom:fromDom,fromPoint:function(docElm,x,y){var doc=docElm.dom();return Option.from(doc.elementFromPoint(x,y)).map(fromDom)}},global$2=tinymce.util.Tools.resolve("tinymce.dom.DOMUtils"),global$3=tinymce.util.Tools.resolve("tinymce.util.Promise"),global$4=tinymce.util.Tools.resolve("tinymce.util.XHR"),getUploadUrl=function(editor){return editor.getParam("images_upload_url","","string")},getUploadHandler=function(editor){return editor.getParam("images_upload_handler",void 0,"function")},Settings={hasDimensions:function(editor){return editor.getParam("image_dimensions",!0,"boolean")},hasUploadTab:function(editor){return editor.getParam("image_uploadtab",!0,"boolean")},hasAdvTab:function(editor){return editor.getParam("image_advtab",!1,"boolean")},getPrependUrl:function(editor){return editor.getParam("image_prepend_url","","string")},getClassList:function(editor){return editor.getParam("image_class_list")},hasDescription:function(editor){return editor.getParam("image_description",!0,"boolean")},hasImageTitle:function(editor){return editor.getParam("image_title",!1,"boolean")},hasImageCaption:function(editor){return editor.getParam("image_caption",!1,"boolean")},getImageList:function(editor){return editor.getParam("image_list",!1)},hasUploadUrl:function(editor){return!!getUploadUrl(editor)},hasUploadHandler:function(editor){return!!getUploadHandler(editor)},getUploadUrl:getUploadUrl,getUploadHandler:getUploadHandler,getUploadBasePath:function(editor){return editor.getParam("images_upload_base_path",void 0,"string")},getUploadCredentials:function(editor){return editor.getParam("images_upload_credentials",!1,"boolean")},showAccessibilityOptions:function(editor){return editor.getParam("a11y_advanced_options",!1,"boolean")},isAutomaticUploadsEnabled:function(editor){return editor.getParam("automatic_uploads",!0,"boolean")}},Utils_getImageSize=function(url,callback){function done(dimensions){img.parentNode&&img.parentNode.removeChild(img),callback(dimensions)}var img=domGlobals.document.createElement("img");img.onload=function(){var dimensions={width:parseIntAndGetMax(img.width,img.clientWidth),height:parseIntAndGetMax(img.height,img.clientHeight)};done(Result.value(dimensions))},img.onerror=function(){done(Result.error("Failed to get image dimensions for: "+url))};var style=img.style;style.visibility="hidden",style.position="fixed",style.bottom=style.left="0px",style.width=style.height="auto",domGlobals.document.body.appendChild(img),img.src=url},Utils_removePixelSuffix=function(value){return value=value&&value.replace(/px$/,"")},Utils_addPixelSuffix=function(value){return 0<value.length&&/^[0-9]+$/.test(value)&&(value+="px"),value},Utils_mergeMargins=function(css){if(css.margin){var splitMargin=String(css.margin).split(" ");switch(splitMargin.length){case 1:css["margin-top"]=css["margin-top"]||splitMargin[0],css["margin-right"]=css["margin-right"]||splitMargin[0],css["margin-bottom"]=css["margin-bottom"]||splitMargin[0],css["margin-left"]=css["margin-left"]||splitMargin[0];break;case 2:css["margin-top"]=css["margin-top"]||splitMargin[0],css["margin-right"]=css["margin-right"]||splitMargin[1],css["margin-bottom"]=css["margin-bottom"]||splitMargin[0],css["margin-left"]=css["margin-left"]||splitMargin[1];break;case 3:css["margin-top"]=css["margin-top"]||splitMargin[0],css["margin-right"]=css["margin-right"]||splitMargin[1],css["margin-bottom"]=css["margin-bottom"]||splitMargin[2],css["margin-left"]=css["margin-left"]||splitMargin[1];break;case 4:css["margin-top"]=css["margin-top"]||splitMargin[0],css["margin-right"]=css["margin-right"]||splitMargin[1],css["margin-bottom"]=css["margin-bottom"]||splitMargin[2],css["margin-left"]=css["margin-left"]||splitMargin[3]}delete css.margin}return css},Utils_createImageList=function(editor,callback){var imageList=Settings.getImageList(editor);"string"==typeof imageList?global$4.send({url:imageList,success:function(text){callback(JSON.parse(text))}}):"function"==typeof imageList?imageList(callback):callback(imageList)},Utils_waitLoadImage=function(editor,data,imgElm){function selectImage(){imgElm.onload=imgElm.onerror=null,editor.selection&&(editor.selection.select(imgElm),editor.nodeChanged())}imgElm.onload=function(){data.width||data.height||!Settings.hasDimensions(editor)||editor.dom.setAttribs(imgElm,{width:String(imgElm.clientWidth),height:String(imgElm.clientHeight)}),selectImage()},imgElm.onerror=selectImage},Utils_blobToDataUri=function(blob){return new global$3(function(resolve,reject){var reader=new domGlobals.FileReader;reader.onload=function(){resolve(reader.result)},reader.onerror=function(){reject(reader.error.message)},reader.readAsDataURL(blob)})},Utils_isPlaceholderImage=function(imgElm){return"IMG"===imgElm.nodeName&&(imgElm.hasAttribute("data-mce-object")||imgElm.hasAttribute("data-mce-placeholder"))},DOM=global$2.DOM,setAlt=function(image,alt,isDecorative,info){if(isDecorative){DOM.setAttrib(image,"role","presentation");var sugarImage=Element.fromDom(image);set(sugarImage,"alt","")}else{if(info.hasAccessibilityOptions)DOM.setAttrib(image,"alt",alt);else{sugarImage=Element.fromDom(image);set(sugarImage,"alt",alt)}"presentation"===DOM.getAttrib(image,"role")&&DOM.setAttrib(image,"role","")}},write=function(normalizeCss,newData,image,info){var oldData=read(normalizeCss,image);updateProp(image,oldData,newData,"caption",function(image,_name,_value){return toggleCaption(image)}),updateProp(image,oldData,newData,"src",setAttrib),updateProp(image,oldData,newData,"title",setAttrib),updateProp(image,oldData,newData,"width",setSize(0,normalizeCss)),updateProp(image,oldData,newData,"height",setSize(0,normalizeCss)),updateProp(image,oldData,newData,"class",setAttrib),updateProp(image,oldData,newData,"style",normalized(function(image,value){return setAttrib(image,"style",value)},normalizeCss)),updateProp(image,oldData,newData,"hspace",normalized(setHspace,normalizeCss)),updateProp(image,oldData,newData,"vspace",normalized(setVspace,normalizeCss)),updateProp(image,oldData,newData,"border",normalized(setBorder,normalizeCss)),updateProp(image,oldData,newData,"borderStyle",normalized(setBorderStyle,normalizeCss)),function(image,oldData,newData,info){newData.alt===oldData.alt&&newData.isDecorative===oldData.isDecorative||setAlt(image,newData.alt,newData.isDecorative,info)}(image,oldData,newData,info)},global$5=tinymce.util.Tools.resolve("tinymce.util.Tools"),sanitizeList=function(list,extractValue){var out=[];return global$5.each(list,function(item){var text=isString(item.text)?item.text:isString(item.title)?item.title:"";if(void 0!==item.menu){var items=sanitizeList(item.menu,extractValue);out.push({text:text,items:items})}else{var value=extractValue(item);out.push({text:text,value:value})}}),out},findEntryDelegate=function(list,value){return function(arr,f){for(var i=0;i<arr.length;i++){var r=f(arr[i],i);if(r.isSome())return r}return Option.none()}(list,function(item){return function(item){return Object.prototype.hasOwnProperty.call(item,"items")}(item)?findEntryDelegate(item.items,value):item.value===value?Option.some(item):Option.none()})},ListUtils_sanitizer=sanitizer,ListUtils_sanitize=function(list){return sanitizer(getValue)(list)},ListUtils_findEntry=function(optList,value){return optList.bind(function(list){return findEntryDelegate(list,value)})};function Uploader(settings){function defaultHandler(blobInfo,success,failure,progress){var xhr,formData;(xhr=new domGlobals.XMLHttpRequest).open("POST",settings.url),xhr.withCredentials=settings.credentials,xhr.upload.onprogress=function(e){progress(e.loaded/e.total*100)},xhr.onerror=function(){failure("Image upload failed due to a XHR Transport error. Code: "+xhr.status)},xhr.onload=function(){var json;xhr.status<200||300<=xhr.status?failure("HTTP Error: "+xhr.status):(json=JSON.parse(xhr.responseText))&&"string"==typeof json.location?success(function(path1,path2){return path1?path1.replace(/\/$/,"")+"/"+path2.replace(/^\//,""):path2}(settings.basePath,json.location)):failure("Invalid JSON: "+xhr.responseText)},(formData=new domGlobals.FormData).append("file",blobInfo.blob(),blobInfo.filename()),xhr.send(formData)}return settings=global$5.extend({credentials:!1,handler:defaultHandler},settings),{upload:function(blobInfo){return!settings.url&&function(handler){return handler===defaultHandler}(settings.handler)?global$3.reject("Upload url missing from the settings."):function(blobInfo,handler){return new global$3(function(resolve,reject){try{handler(blobInfo,resolve,reject,noop)}catch(ex){reject(ex.message)}})}(blobInfo,settings.handler)}}}function collect(editor){var urlListSanitizer=ListUtils_sanitizer(function(item){return editor.convertURL(item.value||item.url,"src")}),futureImageList=Future_nu(function(completer){Utils_createImageList(editor,function(imageList){completer(urlListSanitizer(imageList).map(function(items){return flatten([[{text:"None",value:""}],items])}))})}),classList=ListUtils_sanitize(Settings.getClassList(editor)),hasAdvTab=Settings.hasAdvTab(editor),hasUploadTab=Settings.hasUploadTab(editor),hasUploadUrl=Settings.hasUploadUrl(editor),hasUploadHandler=Settings.hasUploadHandler(editor),image=function(editor){var image=getSelectedImage(editor);return image?read(function(css){return normalizeCss(editor,css)},image):{src:"",alt:"",title:"",width:"",height:"",class:"",style:"",caption:!1,hspace:"",vspace:"",border:"",borderStyle:"",isDecorative:!1}}(editor),hasDescription=Settings.hasDescription(editor),hasImageTitle=Settings.hasImageTitle(editor),hasDimensions=Settings.hasDimensions(editor),hasImageCaption=Settings.hasImageCaption(editor),hasAccessibilityOptions=Settings.showAccessibilityOptions(editor),url=Settings.getUploadUrl(editor),basePath=Settings.getUploadBasePath(editor),credentials=Settings.getUploadCredentials(editor),handler=Settings.getUploadHandler(editor),automaticUploads=Settings.isAutomaticUploadsEnabled(editor),prependURL=Option.some(Settings.getPrependUrl(editor)).filter(function(preUrl){return isString(preUrl)&&0<preUrl.length});return futureImageList.map(function(imageList){return{image:image,imageList:imageList,classList:classList,hasAdvTab:hasAdvTab,hasUploadTab:hasUploadTab,hasUploadUrl:hasUploadUrl,hasUploadHandler:hasUploadHandler,hasDescription:hasDescription,hasImageTitle:hasImageTitle,hasDimensions:hasDimensions,hasImageCaption:hasImageCaption,url:url,basePath:basePath,credentials:credentials,handler:handler,prependURL:prependURL,hasAccessibilityOptions:hasAccessibilityOptions,automaticUploads:automaticUploads}})}function makeItems(info){var imageList=info.imageList.map(function(items){return{name:"images",type:"selectbox",label:"Image list",items:items}}),imageDescription={name:"alt",type:"input",label:"Alternative description",disabled:info.hasAccessibilityOptions&&info.image.isDecorative},classList=info.classList.map(function(items){return{name:"classes",type:"selectbox",label:"Class",items:items}});return flatten([[{name:"src",type:"urlinput",filetype:"image",label:"Source"}],imageList.toArray(),info.hasAccessibilityOptions&&info.hasDescription?[{type:"label",label:"Accessibility",items:[{name:"isDecorative",type:"checkbox",label:"Image is decorative"}]}]:[],info.hasDescription?[imageDescription]:[],info.hasImageTitle?[{name:"title",type:"input",label:"Image title"}]:[],info.hasDimensions?[{name:"dimensions",type:"sizeinput"}]:[],[{type:"grid",columns:2,items:flatten([classList.toArray(),info.hasImageCaption?[{type:"label",label:"Caption",items:[{type:"checkbox",name:"caption",label:"Show caption"}]}]:[]])}]])}function fromImageData(image){return{src:{value:image.src,meta:{}},images:image.src,alt:image.alt,title:image.title,dimensions:{width:image.width,height:image.height},classes:image.class,caption:image.caption,style:image.style,vspace:image.vspace,border:image.border,hspace:image.hspace,borderstyle:image.borderStyle,fileinput:[],isDecorative:image.isDecorative}}function toImageData(data){return{src:data.src.value,alt:data.alt,title:data.title,width:data.dimensions.width,height:data.dimensions.height,class:data.classes,style:data.style,caption:data.caption,hspace:data.hspace,vspace:data.vspace,border:data.border,borderStyle:data.borderstyle,isDecorative:data.isDecorative}}function addPrependUrl(info,api){var data=api.getData();(function(info,srcURL){return/^(?:[a-zA-Z]+:)?\/\//.test(srcURL)?Option.none():info.prependURL.bind(function(prependUrl){return srcURL.substring(0,prependUrl.length)!==prependUrl?Option.some(prependUrl+srcURL):Option.none()})})(info,data.src.value).each(function(srcURL){api.setData({src:{value:srcURL,meta:data.src.meta}})})}function formFillFromMeta(info,api){var data=api.getData(),meta=data.src.meta;if(void 0!==meta){var newData=deepMerge({},data);!function(info,data,meta){info.hasDescription&&isString(meta.alt)&&(data.alt=meta.alt),info.hasAccessibilityOptions&&(data.isDecorative=meta.isDecorative||data.isDecorative||!1),info.hasImageTitle&&isString(meta.title)&&(data.title=meta.title),info.hasDimensions&&(isString(meta.width)&&(data.dimensions.width=meta.width),isString(meta.height)&&(data.dimensions.height=meta.height)),isString(meta.class)&&ListUtils_findEntry(info.classList,meta.class).each(function(entry){data.classes=entry.value}),info.hasImageCaption&&isBoolean(meta.caption)&&(data.caption=meta.caption),info.hasAdvTab&&(isString(meta.style)&&(data.style=meta.style),isString(meta.vspace)&&(data.vspace=meta.vspace),isString(meta.border)&&(data.border=meta.border),isString(meta.hspace)&&(data.hspace=meta.hspace),isString(meta.borderstyle)&&(data.borderstyle=meta.borderstyle))}(info,newData,meta),api.setData(newData)}}function changeSrc(helpers,info,state,api){addPrependUrl(info,api),formFillFromMeta(info,api),function(helpers,info,state,api){var data=api.getData(),url=data.src.value,meta=data.src.meta||{};meta.width||meta.height||!info.hasDimensions||helpers.imageSize(url).get(function(result){result.each(function(size){state.open&&api.setData({dimensions:size})})})}(helpers,info,state,api),function(info,state,api){var data=api.getData(),image=ListUtils_findEntry(info.imageList,data.src.value);state.prevImage=image,api.setData({images:image.map(function(entry){return entry.value}).getOr("")})}(info,state,api)}function changeStyle2(parseStyle,serializeStyle,data){var css=Utils_mergeMargins(parseStyle(data.style)),dataCopy=deepMerge({},data);return dataCopy.vspace=function(css){return css["margin-top"]&&css["margin-bottom"]&&css["margin-top"]===css["margin-bottom"]?Utils_removePixelSuffix(String(css["margin-top"])):""}(css),dataCopy.hspace=function(css){return css["margin-right"]&&css["margin-left"]&&css["margin-right"]===css["margin-left"]?Utils_removePixelSuffix(String(css["margin-right"])):""}(css),dataCopy.border=function(css){return css["border-width"]?Utils_removePixelSuffix(String(css["border-width"])):""}(css),dataCopy.borderstyle=function(css){return css["border-style"]?String(css["border-style"]):""}(css),dataCopy.style=function(parseStyle,serializeStyle,css){return serializeStyle(parseStyle(serializeStyle(css)))}(parseStyle,serializeStyle,css),dataCopy}function changeFileInput(helpers,info,state,api){var data=api.getData();api.block("Uploading image"),function(xs){return 0===xs.length?Option.none():Option.some(xs[0])}(data.fileinput).fold(function(){api.unblock()},function(file){function finalize(){api.unblock(),domGlobals.URL.revokeObjectURL(blobUri)}function updateSrcAndSwitchTab(url){api.setData({src:{value:url,meta:{}}}),api.showTab("general"),changeSrc(helpers,info,state,api)}var blobUri=domGlobals.URL.createObjectURL(file),uploader=Uploader({url:info.url,basePath:info.basePath,credentials:info.credentials,handler:info.handler});Utils_blobToDataUri(file).then(function(dataUrl){var blobInfo=helpers.createBlobCache(file,blobUri,dataUrl);info.automaticUploads?uploader.upload(blobInfo).then(function(url){updateSrcAndSwitchTab(url),finalize()}).catch(function(err){finalize(),helpers.alertErr(api,err)}):(helpers.addToBlobCache(blobInfo),updateSrcAndSwitchTab(blobInfo.blobUri()),api.unblock())})})}function changeHandler(helpers,info,state){return function(api,evt){"src"===evt.name?changeSrc(helpers,info,state,api):"images"===evt.name?function(helpers,info,state,api){var data=api.getData(),image=ListUtils_findEntry(info.imageList,data.images);image.each(function(img){""===data.alt||state.prevImage.map(function(image){return image.text===data.alt}).getOr(!1)?""===img.value?api.setData({src:img,alt:state.prevAlt}):api.setData({src:img,alt:img.text}):api.setData({src:img})}),state.prevImage=image,changeSrc(helpers,info,state,api)}(helpers,info,state,api):"alt"===evt.name?state.prevAlt=api.getData().alt:"style"===evt.name?function(helpers,api){var data=api.getData(),newData=changeStyle2(helpers.parseStyle,helpers.serializeStyle,data);api.setData(newData)}(helpers,api):"vspace"===evt.name||"hspace"===evt.name||"border"===evt.name||"borderstyle"===evt.name?function(helpers,info,api){var data=deepMerge(fromImageData(info.image),api.getData()),style=getStyleValue(helpers.normalizeCss,toImageData(data));api.setData({style:style})}(helpers,info,api):"fileinput"===evt.name?changeFileInput(helpers,info,state,api):"isDecorative"===evt.name&&(api.getData().isDecorative?api.disable("alt"):api.enable("alt"))}}function makeDialog(helpers){return function(info){var state=function(info){return{prevImage:ListUtils_findEntry(info.imageList,info.image.src),prevAlt:info.image.alt,open:!0}}(info);return{title:"Insert/Edit Image",size:"normal",body:function(info){return info.hasAdvTab||info.hasUploadUrl||info.hasUploadHandler?{type:"tabpanel",tabs:flatten([[MainTab_makeTab(info)],info.hasAdvTab?[AdvTab_makeTab(info)]:[],info.hasUploadTab&&(info.hasUploadUrl||info.hasUploadHandler)?[UploadTab_makeTab(info)]:[]])}:{type:"panel",items:MainTab_makeItems(info)}}(info),buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"save",text:"Save",primary:!0}],initialData:fromImageData(info.image),onSubmit:helpers.onSubmit(info),onChange:changeHandler(helpers,info,state),onClose:function(state){return function(){state.open=!1}}(state)}}}function Dialog(editor){var helpers={onSubmit:function(editor){return function(info){return function(api){var data=deepMerge(fromImageData(info.image),api.getData());editor.undoManager.transact(function(){insertOrUpdateImage(editor,toImageData(data),info)}),editor.editorUpload.uploadImagesAuto(),api.close()}}}(editor),imageSize:function(editor){return function(url){return FutureResult_nu(function(completer){Utils_getImageSize(editor.documentBaseURI.toAbsolute(url),function(data){var result=data.map(function(dimensions){return{width:String(dimensions.width),height:String(dimensions.height)}});completer(result)})})}}(editor),addToBlobCache:function(editor){return function(blobInfo){editor.editorUpload.blobCache.add(blobInfo)}}(editor),createBlobCache:function(editor){return function(file,blobUri,dataUrl){return editor.editorUpload.blobCache.create({blob:file,blobUri:blobUri,name:file.name?file.name.replace(/\.[^\.]+$/,""):null,base64:dataUrl.split(",")[1]})}}(editor),alertErr:function(editor){return function(api,message){editor.windowManager.alert(message,api.close)}}(editor),normalizeCss:function(editor){return function(cssText){return normalizeCss(editor,cssText)}}(editor),parseStyle:function(editor){return function(cssText){return editor.dom.parseStyle(cssText)}}(editor),serializeStyle:function(editor){return function(stylesArg,name){return editor.dom.serializeStyle(stylesArg,name)}}(editor)};return{open:function(){return collect(editor).map(makeDialog(helpers)).get(function(spec){editor.windowManager.open(spec)})}}}function hasImageClass(node){var className=node.attr("class");return className&&/\bimage\b/.test(className)}function toggleContentEditableState(state){return function(nodes){for(var i=nodes.length,toggleContentEditable=function(node){node.attr("contenteditable",state?"true":null)};i--;){var node=nodes[i];hasImageClass(node)&&(node.attr("contenteditable",state?"false":null),global$5.each(node.getAll("figcaption"),toggleContentEditable))}}}var AdvTab_makeTab=function(info){return{title:"Advanced",name:"advanced",items:[{type:"input",label:"Style",name:"style"},{type:"grid",columns:2,items:[{type:"input",label:"Vertical space",name:"vspace",inputMode:"numeric"},{type:"input",label:"Horizontal space",name:"hspace",inputMode:"numeric"},{type:"input",label:"Border width",name:"border",inputMode:"numeric"},{type:"selectbox",name:"borderstyle",label:"Border style",items:[{text:"Select...",value:""},{text:"Solid",value:"solid"},{text:"Dotted",value:"dotted"},{text:"Dashed",value:"dashed"},{text:"Double",value:"double"},{text:"Groove",value:"groove"},{text:"Ridge",value:"ridge"},{text:"Inset",value:"inset"},{text:"Outset",value:"outset"},{text:"None",value:"none"},{text:"Hidden",value:"hidden"}]}]}]}},MainTab_makeTab=function(info){return{title:"General",name:"general",items:makeItems(info)}},MainTab_makeItems=makeItems,UploadTab_makeTab=function(info){return{title:"Upload",name:"upload",items:[{type:"dropzone",name:"fileinput"}]}},Commands_register=function(editor){editor.addCommand("mceImage",Dialog(editor).open)},FilterContent_setup=function(editor){editor.on("PreInit",function(){editor.parser.addNodeFilter("figure",toggleContentEditableState(!0)),editor.serializer.addNodeFilter("figure",toggleContentEditableState(!1))})},Buttons_register=function(editor){editor.ui.registry.addToggleButton("image",{icon:"image",tooltip:"Insert/edit image",onAction:Dialog(editor).open,onSetup:function(buttonApi){return editor.selection.selectorChangedWithUnbind("img:not([data-mce-object],[data-mce-placeholder]),figure.image",buttonApi.setActive).unbind}}),editor.ui.registry.addMenuItem("image",{icon:"image",text:"Image...",onAction:Dialog(editor).open}),editor.ui.registry.addContextMenu("image",{update:function(element){return isFigure(element)||function(elm){return"IMG"===elm.nodeName}(element)&&!Utils_isPlaceholderImage(element)?["image"]:[]}})};global$1.add("image",function(editor){FilterContent_setup(editor),Buttons_register(editor),Commands_register(editor)})}(window),function(domGlobals){"use strict";function noop(){}function constant(value){return function(){return value}}function not(f){return function(){for(var args=[],_i=0;_i<arguments.length;_i++)args[_i]=arguments[_i];return!f.apply(null,args)}}function none(){return NONE}function isType(type){return function(value){return function(x){if(null===x)return"null";var t=typeof x;return"object"==t&&(Array.prototype.isPrototypeOf(x)||x.constructor&&"Array"===x.constructor.name)?"array":"object"==t&&(String.prototype.isPrototypeOf(x)||x.constructor&&"String"===x.constructor.name)?"string":t}(value)===type}}function map(xs,f){for(var len=xs.length,r=new Array(len),i=0;i<len;i++){var x=xs[i];r[i]=f(x,i)}return r}function each(xs,f){for(var i=0,len=xs.length;i<len;i++){f(xs[i],i)}}function filter(xs,pred){for(var r=[],i=0,len=xs.length;i<len;i++){var x=xs[i];pred(x,i)&&r.push(x)}return r}function foldl(xs,f,acc){return each(xs,function(x){acc=f(acc,x)}),acc}function find(xs,pred){for(var i=0,len=xs.length;i<len;i++){var x=xs[i];if(pred(x,i))return Option.some(x)}return Option.none()}function bind(xs,f){return function(xs){for(var r=[],i=0,len=xs.length;i<len;++i){if(!isArray(xs[i]))throw new Error("Arr.flatten item "+i+" was not an array, input: "+xs);nativePush.apply(r,xs[i])}return r}(map(xs,f))}function head(xs){return 0===xs.length?Option.none():Option.some(xs[0])}function last(xs){return 0===xs.length?Option.none():Option.some(xs[xs.length-1])}function compareDocumentPosition(a,b,match){return 0!=(a.compareDocumentPosition(b)&match)}function find$1(regexes,agent){var r=function(regexes,s){for(var i=0;i<regexes.length;i++){var x=regexes[i];if(x.test(s))return x}}(regexes,agent);if(!r)return{major:0,minor:0};function group(i){return Number(agent.replace(r,"$"+i))}return nu(group(1),group(2))}function isBrowser(name,current){return function(){return current===name}}function isOS(name,current){return function(){return current===name}}function detect$1(candidates,userAgent){var agent=String(userAgent).toLowerCase();return find(candidates,function(candidate){return candidate.search(agent)})}function contains(str,substr){return-1!==str.indexOf(substr)}function checkContains(target){return function(uastring){return contains(uastring,target)}}function eq(e1,e2){return e1.dom()===e2.dom()}function lift2(oa,ob,f){return oa.isSome()&&ob.isSome()?Option.some(f(oa.getOrDie(),ob.getOrDie())):Option.none()}function parent(element){return Option.from(element.dom().parentNode).map(Element.fromDom)}function children(element){return map(element.dom().childNodes,Element.fromDom)}function child(element,index){var cs=element.dom().childNodes;return Option.from(cs[index]).map(Element.fromDom)}function firstChild(element){return child(element,0)}function lastChild(element){return child(element,element.dom().childNodes.length-1)}function before(marker,element){parent(marker).each(function(v){v.dom().insertBefore(element.dom(),marker.dom())})}function append(parent,element){parent.dom().appendChild(element.dom())}function append$1(parent,elements){each(elements,function(x){append(parent,x)})}function remove(element){var dom=element.dom();null!==dom.parentNode&&dom.parentNode.removeChild(dom)}function fireListEvent(editor,action,element){return editor.fire("ListMutation",{action:action,element:element})}function resolve(p,scope){return function(parts,scope){for(var o=null!=scope?scope:Global,i=0;i<parts.length&&null!=o;++i)o=o[parts[i]];return o}(p.split("."),scope)}function isBr(node){return node&&"BR"===node.nodeName}function getParentList(editor){var selectionStart=editor.selection.getStart(!0);return editor.dom.getParent(selectionStart,"OL,UL,DL",getClosestListRootElm(editor,selectionStart))}function getSelectedListItems(editor){var selectedBlocks=editor.selection.getSelectedBlocks();return global$5.grep(function(editor,elms){var listItemsElms=global$5.map(elms,function(elm){var parentLi=editor.dom.getParent(elm,"li,dd,dt",getClosestListRootElm(editor,elm));return parentLi||elm});return global$4.unique(listItemsElms)}(editor,selectedBlocks),function(block){return NodeType_isListItemNode(block)})}function findLastParentListNode(editor,elm){var parentLists=editor.dom.getParents(elm,"ol,ul",getClosestListRootElm(editor,elm));return last(parentLists)}function createTextBlock(editor,contentNode){var node,textBlock,hasContentNode,dom=editor.dom,blockElements=editor.schema.getBlockElements(),fragment=dom.createFragment(),blockName=Settings_getForcedRootBlock(editor);if(blockName&&((textBlock=dom.create(blockName)).tagName===blockName.toUpperCase()&&dom.setAttribs(textBlock,Settings_getForcedRootBlockAttrs(editor)),NodeType_isBlock(contentNode.firstChild,blockElements)||fragment.appendChild(textBlock)),contentNode)for(;node=contentNode.firstChild;){var nodeName=node.nodeName;hasContentNode||"SPAN"===nodeName&&"bookmark"===node.getAttribute("data-mce-type")||(hasContentNode=!0),NodeType_isBlock(node,blockElements)?(fragment.appendChild(node),textBlock=null):blockName?(textBlock||(textBlock=dom.create(blockName),fragment.appendChild(textBlock)),textBlock.appendChild(node)):fragment.appendChild(node)}return blockName?hasContentNode||textBlock.appendChild(dom.create("br",{"data-mce-bogus":"1"})):fragment.appendChild(dom.create("br")),fragment}function name(element){return element.dom().nodeName.toLowerCase()}function setAll(element,attrs){var dom=element.dom();!function(obj,f){for(var props=keys(obj),k=0,len=props.length;k<len;k++){var i=props[k];f(obj[i],i)}}(attrs,function(v,k){!function(dom,key,value){if(!(isString(value)||isBoolean(value)||isNumber(value)))throw domGlobals.console.error("Invalid call to Attr.set. Key ",key,":: Value ",value,":: Element ",dom),new Error("Attribute value was not simple");dom.setAttribute(key,value+"")}(dom,k,v)})}function clone(element){return foldl(element.dom().attributes,function(acc,attr){return acc[attr.name]=attr.value,acc},{})}function internalSet(dom,property,value){if(!isString(value))throw domGlobals.console.error("Invalid call to CSS.set. Property ",property,":: Value ",value,":: Element ",dom),new Error("CSS value must be a string: "+value);!function(dom){return void 0!==dom.style&&isFunction(dom.style.getPropertyValue)}(dom)||dom.style.setProperty(property,value)}function deep(original){return function(original,isDeep){return Element.fromDom(original.dom().cloneNode(isDeep))}(original,!0)}function mutate(original,tag){var nu=function(original,tag){var nu=Element.fromTag(tag),attributes=clone(original);return setAll(nu,attributes),nu}(original,tag);before(original,nu);var children$1=children(original);return append$1(nu,children$1),remove(original),nu}function joinSegment(parent,child){append(parent.item,child.list)}function createSegment(scope,listType){var segment={list:Element.fromTag(listType,scope),item:Element.fromTag("li",scope)};return append(segment.list,segment.item),segment}function writeShallow(scope,cast,entry){var newCast=cast.slice(0,entry.depth);return last(newCast).each(function(segment){!function(segment,item){append(segment.list,item),segment.item=item}(segment,function(scope,attr,content){var item=Element.fromTag("li",scope);return setAll(item,attr),append$1(item,content),item}(scope,entry.itemAttributes,entry.content)),function(segment,entry){name(segment.list)!==entry.listType&&(segment.list=mutate(segment.list,entry.listType)),setAll(segment.list,entry.listAttributes)}(segment,entry)}),newCast}function writeDeep(scope,cast,entry){var segments=function(scope,entry,size){for(var segments=[],i=0;i<size;i++)segments.push(createSegment(scope,entry.listType));return segments}(scope,entry,entry.depth-cast.length);return function(segments){for(var i=1;i<segments.length;i++)joinSegment(segments[i-1],segments[i])}(segments),function(segments,entry){for(var i=0;i<segments.length-1;i++)element=segments[i].item,property="list-style-type",value="none",void 0,dom=element.dom(),internalSet(dom,property,value);var element,property,value,dom;last(segments).each(function(segment){setAll(segment.list,entry.listAttributes),setAll(segment.item,entry.itemAttributes),append$1(segment.item,entry.content)})}(segments,entry),function(head$1,tail){lift2(last(head$1),head(tail),joinSegment)}(cast,segments),cast.concat(segments)}function isList$1(el){return is$1(el,"OL,UL")}function hasFirstChildList(el){return firstChild(el).map(isList$1).getOr(!1)}function isIndented(entry){return 0<entry.depth}function isSelected(entry){return entry.isSelected}function cloneItemContent(li){var children$1=children(li),content=function(el){return lastChild(el).map(isList$1).getOr(!1)}(li)?children$1.slice(0,-1):children$1;return map(content,deep)}function normalizeEntries(entries){each(entries,function(entry,i){(function(entries,start){for(var depth=entries[start].depth,i=start-1;0<=i;i--){if(entries[i].depth===depth)return Option.some(entries[i]);if(entries[i].depth<depth)break}return Option.none()})(entries,i).each(function(matchingEntry){!function(target,source){target.listType=source.listType,target.listAttributes=__assign({},source.listAttributes)}(entry,matchingEntry)})})}function parseItem(depth,itemSelection,selectionState,item){return firstChild(item).filter(isList$1).fold(function(){itemSelection.each(function(selection){eq(selection.start,item)&&selectionState.set(!0)});var currentItemEntry=function(li,depth,isSelected){return parent(li).filter(isElement).map(function(list){return{depth:depth,isSelected:isSelected,content:cloneItemContent(li),itemAttributes:clone(li),listAttributes:clone(list),listType:name(list)}})}(item,depth,selectionState.get());itemSelection.each(function(selection){eq(selection.end,item)&&selectionState.set(!1)});var childListEntries=lastChild(item).filter(isList$1).map(function(list){return parseList(depth,itemSelection,selectionState,list)}).getOr([]);return currentItemEntry.toArray().concat(childListEntries)},function(list){return parseList(depth,itemSelection,selectionState,list)})}function outdentedComposer(editor,entries){return map(entries,function(entry){var content=function(elements,scope){var fragment=(scope||domGlobals.document).createDocumentFragment();return each(elements,function(element){fragment.appendChild(element.dom())}),Element.fromDom(fragment)}(entry.content);return Element.fromDom(createTextBlock(editor,content.dom()))})}function indentedComposer(editor,entries){return normalizeEntries(entries),function(scope,entries){var cast=foldl(entries,function(cast,entry){return entry.depth>cast.length?writeDeep(scope,cast,entry):writeShallow(scope,cast,entry)},[]);return head(cast).map(function(segment){return segment.list})}(editor.contentDocument,entries).toArray()}function getItemSelection(editor){var selectedListItems=map(Selection.getSelectedListItems(editor),Element.fromDom);return lift2(find(selectedListItems,not(hasFirstChildList)),find(function(xs){var r=nativeSlice.call(xs,0);return r.reverse(),r}(selectedListItems),not(hasFirstChildList)),function(start,end){return{start:start,end:end}})}function listIndentation(editor,lists,indentation){var entrySets=function(lists,itemSelection){var selectionState=Cell(!1);return map(lists,function(list){return{sourceList:list,entries:parseList(0,itemSelection,selectionState,list)}})}(lists,getItemSelection(editor));each(entrySets,function(entrySet){!function(entries,indentation){each(filter(entries,isSelected),function(entry){return function(indentation,entry){switch(indentation){case"Indent":entry.depth++;break;case"Outdent":entry.depth--;break;case"Flatten":entry.depth=0}}(indentation,entry)})}(entrySet.entries,indentation);var composedLists=function(editor,entries){return bind(function(xs,f){if(0===xs.length)return[];for(var wasType=f(xs[0]),r=[],group=[],i=0,len=xs.length;i<len;i++){var x=xs[i],type=f(x);type!==wasType&&(r.push(group),group=[]),wasType=type,group.push(x)}return 0!==group.length&&r.push(group),r}(entries,isIndented),function(entries){return head(entries).map(isIndented).getOr(!1)?indentedComposer(editor,entries):outdentedComposer(editor,entries)})}(editor,entrySet.entries);each(composedLists,function(composedList){fireListEvent(editor,"Indent"===indentation?"IndentList":"OutdentList",composedList.dom())}),function(marker,elements){each(elements,function(x){before(marker,x)})}(entrySet.sourceList,composedLists),remove(entrySet.sourceList)})}function indentDlItem(item){is$1(item,"dt")&&mutate(item,"dd")}function dlIndentation(editor,indentation,dlItems){each(dlItems,"Indent"===indentation?indentDlItem:function(item){return function(editor,item){is$1(item,"dd")?mutate(item,"dt"):is$1(item,"dt")&&parent(item).each(function(dl){return SplitList_splitList(editor,dl.dom(),item.dom())})}(editor,item)})}function getNormalizedPoint(container,offset){if(NodeType_isTextNode(container))return{container:container,offset:offset};var node=global$1.getNode(container,offset);return NodeType_isTextNode(node)?{container:node,offset:offset>=container.childNodes.length?node.data.length:0}:node.previousSibling&&NodeType_isTextNode(node.previousSibling)?{container:node.previousSibling,offset:node.previousSibling.data.length}:node.nextSibling&&NodeType_isTextNode(node.nextSibling)?{container:node.nextSibling,offset:0}:{container:container,offset:offset}}function selectionIndentation(editor,indentation){var lists=map(Selection.getSelectedListRoots(editor),Element.fromDom),dlItems=map(Selection.getSelectedDlItems(editor),Element.fromDom),isHandled=!1;if(lists.length||dlItems.length){var bookmark=editor.selection.getBookmark();listIndentation(editor,lists,indentation),dlIndentation(editor,indentation,dlItems),editor.selection.moveToBookmark(bookmark),editor.selection.setRng(Range_normalizeRange(editor.selection.getRng())),editor.nodeChanged(),isHandled=!0}return isHandled}function indentListSelection(editor){return selectionIndentation(editor,"Indent")}function outdentListSelection(editor){return selectionIndentation(editor,"Outdent")}function flattenListSelection(editor){return selectionIndentation(editor,"Flatten")}function isCustomList(list){return/\btox\-/.test(list.className)}function listToggleActionFromListName(listName){switch(listName){case"UL":return"ToggleUlList";case"OL":return"ToggleOlList";case"DL":return"ToggleDLList"}}function setAttribs(elm,attrs){global$5.each(attrs,function(value,key){elm.setAttribute(key,value)})}function updateListWithDetails(dom,el,detail){!function(dom,el,detail){var type=detail["list-style-type"]?detail["list-style-type"]:null;dom.setStyle(el,"list-style-type",type)}(dom,el,detail),function(dom,el,detail){setAttribs(el,detail["list-attributes"]),global$5.each(dom.select("li",el),function(li){setAttribs(li,detail["list-item-attributes"])})}(dom,el,detail)}function getEndPointNode(editor,rng,start,root){var container,offset;for(container=rng[start?"startContainer":"endContainer"],offset=rng[start?"startOffset":"endOffset"],1===container.nodeType&&(container=container.childNodes[Math.min(offset,container.childNodes.length-1)]||container),!start&&NodeType_isBr(container.nextSibling)&&(container=container.nextSibling);container.parentNode!==root;){if(NodeType_isTextBlock(editor,container))return container;if(/^(TD|TH)$/.test(container.parentNode.nodeName))return container;container=container.parentNode}return container}function applyList(editor,listName,detail){void 0===detail&&(detail={});var bookmark,rng=editor.selection.getRng(!0),listItemName="LI",root=Selection.getClosestListRootElm(editor,editor.selection.getStart(!0)),dom=editor.dom;"false"!==dom.getContentEditable(editor.selection.getNode())&&("DL"===(listName=listName.toUpperCase())&&(listItemName="DT"),bookmark=Bookmark_createBookmark(rng),global$5.each(function(editor,rng,root){for(var block,textBlocks=[],dom=editor.dom,startNode=getEndPointNode(editor,rng,!0,root),endNode=getEndPointNode(editor,rng,!1,root),siblings=[],node=startNode;node&&(siblings.push(node),node!==endNode);node=node.nextSibling);return global$5.each(siblings,function(node){if(NodeType_isTextBlock(editor,node))return textBlocks.push(node),void(block=null);if(dom.isBlock(node)||NodeType_isBr(node))return NodeType_isBr(node)&&dom.remove(node),void(block=null);var nextSibling=node.nextSibling;global$7.isBookmarkNode(node)&&(NodeType_isTextBlock(editor,nextSibling)||!nextSibling&&node.parentNode===root)?block=null:(block||(block=dom.create("p"),node.parentNode.insertBefore(block,node),textBlocks.push(block)),block.appendChild(node))}),textBlocks}(editor,rng,root),function(block){var listBlock,sibling;(sibling=block.previousSibling)&&NodeType_isListNode(sibling)&&sibling.nodeName===listName&&function(dom,sib,detail){var sibStyle=dom.getStyle(sib,"list-style-type"),detailStyle=detail?detail["list-style-type"]:"";return sibStyle===(detailStyle=null===detailStyle?"":detailStyle)}(dom,sibling,detail)?(listBlock=sibling,block=dom.rename(block,listItemName),sibling.appendChild(block)):(listBlock=dom.create(listName),block.parentNode.insertBefore(listBlock,block),listBlock.appendChild(block),block=dom.rename(block,listItemName)),function(dom,element,styles){global$5.each(styles,function(style){var _a;return dom.setStyle(element,((_a={})[style]="",_a))})}(dom,block,["margin","margin-right","margin-bottom","margin-left","margin-top","padding","padding-right","padding-bottom","padding-left","padding-top"]),updateListWithDetails(dom,listBlock,detail),mergeWithAdjacentLists(editor.dom,listBlock)}),editor.selection.setRng(Bookmark_resolveBookmark(bookmark)))}function shouldMerge(dom,list1,list2){return function(list1,list2){return list1&&list2&&NodeType_isListNode(list1)&&list1.nodeName===list2.nodeName}(list1,list2)&&function(dom,list1,list2){return dom.getStyle(list1,"list-style-type",!0)===dom.getStyle(list2,"list-style-type",!0)}(dom,list1,list2)&&function(elm1,elm2){return elm1.className===elm2.className}(list1,list2)}function toggleMultipleLists(editor,parentList,lists,listName,detail){if(parentList.nodeName!==listName||hasListStyleDetail(detail)){var bookmark=Bookmark_createBookmark(editor.selection.getRng(!0));global$5.each([parentList].concat(lists),function(elm){!function(editor,list,listName,detail){if(list.nodeName!==listName){var newList=editor.dom.rename(list,listName);updateListWithDetails(editor.dom,newList,detail),fireListEvent(editor,listToggleActionFromListName(listName),newList)}else updateListWithDetails(editor.dom,list,detail),fireListEvent(editor,listToggleActionFromListName(listName),list)}(editor,elm,listName,detail)}),editor.selection.setRng(Bookmark_resolveBookmark(bookmark))}else flattenListSelection(editor)}function normalizeList(dom,ul){var sibling,parentNode=ul.parentNode;"LI"===parentNode.nodeName&&parentNode.firstChild===ul&&((sibling=parentNode.previousSibling)&&"LI"===sibling.nodeName?(sibling.appendChild(ul),NodeType_isEmpty(dom,parentNode)&&DOM$2.remove(parentNode)):DOM$2.setStyle(parentNode,"listStyleType","none")),NodeType_isListNode(parentNode)&&(sibling=parentNode.previousSibling)&&"LI"===sibling.nodeName&&sibling.appendChild(ul)}function findNextCaretContainer(editor,rng,isForward,root){var node=rng.startContainer,offset=rng.startOffset;if(NodeType_isTextNode(node)&&(isForward?offset<node.data.length:0<offset))return node;var nonEmptyBlocks=editor.schema.getNonEmptyElements();1===node.nodeType&&(node=global$1.getNode(node,offset));var walker=new global$2(node,root);for(isForward&&NodeType_isBogusBr(editor.dom,node)&&walker.next();node=walker[isForward?"next":"prev2"]();){if("LI"===node.nodeName&&!node.hasChildNodes())return node;if(nonEmptyBlocks[node.nodeName])return node;if(NodeType_isTextNode(node)&&0<node.data.length)return node}}function hasOnlyOneBlockChild(dom,elm){var childNodes=elm.childNodes;return 1===childNodes.length&&!NodeType_isListNode(childNodes[0])&&dom.isBlock(childNodes[0])}function moveChildren(dom,fromElm,toElm){var node,targetElm;if(targetElm=hasOnlyOneBlockChild(dom,toElm)?toElm.firstChild:toElm,function(dom,elm){hasOnlyOneBlockChild(dom,elm)&&dom.remove(elm.firstChild,!0)}(dom,fromElm),!NodeType_isEmpty(dom,fromElm,!0))for(;node=fromElm.firstChild;)targetElm.appendChild(node)}function mergeLiElements(dom,fromElm,toElm){var node,listNode,ul=fromElm.parentNode;if(NodeType_isChildOfBody(dom,fromElm)&&NodeType_isChildOfBody(dom,toElm)){NodeType_isListNode(toElm.lastChild)&&(listNode=toElm.lastChild),ul===toElm.lastChild&&NodeType_isBr(ul.previousSibling)&&dom.remove(ul.previousSibling),(node=toElm.lastChild)&&NodeType_isBr(node)&&fromElm.hasChildNodes()&&dom.remove(node),NodeType_isEmpty(dom,toElm,!0)&&dom.$(toElm).empty(),moveChildren(dom,fromElm,toElm),listNode&&toElm.appendChild(listNode);var nestedLists=contains$1(Element.fromDom(toElm),Element.fromDom(fromElm))?dom.getParents(fromElm,NodeType_isListNode,toElm):[];dom.remove(fromElm),each(nestedLists,function(list){NodeType_isEmpty(dom,list)&&list!==dom.getRoot()&&dom.remove(list)})}}function mergeForward(editor,rng,fromLi,toLi){var dom=editor.dom;if(dom.isEmpty(toLi))!function(editor,fromLi,toLi){editor.dom.$(toLi).empty(),mergeLiElements(editor.dom,fromLi,toLi),editor.selection.setCursorLocation(toLi)}(editor,fromLi,toLi);else{var bookmark=Bookmark_createBookmark(rng);mergeLiElements(dom,fromLi,toLi),editor.selection.setRng(Bookmark_resolveBookmark(bookmark))}}function backspaceDeleteFromListToListCaret(editor,isForward){var dom=editor.dom,selection=editor.selection,selectionStartElm=selection.getStart(),root=Selection.getClosestListRootElm(editor,selectionStartElm),li=dom.getParent(selection.getStart(),"LI",root);if(li){var ul=li.parentNode;if(ul===editor.getBody()&&NodeType_isEmpty(dom,ul))return!0;var rng_1=Range_normalizeRange(selection.getRng()),otherLi_1=dom.getParent(findNextCaretContainer(editor,rng_1,isForward,root),"LI",root);if(otherLi_1&&otherLi_1!==li)return editor.undoManager.transact(function(){isForward?mergeForward(editor,rng_1,otherLi_1,li):NodeType_isFirstChild(li)?outdentListSelection(editor):function(editor,rng,fromLi,toLi){var bookmark=Bookmark_createBookmark(rng);mergeLiElements(editor.dom,fromLi,toLi);var resolvedBookmark=Bookmark_resolveBookmark(bookmark);editor.selection.setRng(resolvedBookmark)}(editor,rng_1,li,otherLi_1)}),!0;if(!otherLi_1&&!isForward&&0===rng_1.startOffset&&0===rng_1.endOffset)return editor.undoManager.transact(function(){flattenListSelection(editor)}),!0}return!1}function backspaceDeleteCaret(editor,isForward){return backspaceDeleteFromListToListCaret(editor,isForward)||function(editor,isForward){var dom=editor.dom,selectionStartElm=editor.selection.getStart(),root=Selection.getClosestListRootElm(editor,selectionStartElm),block=dom.getParent(selectionStartElm,dom.isBlock,root);if(block&&dom.isEmpty(block)){var rng=Range_normalizeRange(editor.selection.getRng()),otherLi_2=dom.getParent(findNextCaretContainer(editor,rng,isForward,root),"LI",root);if(otherLi_2)return editor.undoManager.transact(function(){!function(dom,block,root){var parentBlock=dom.getParent(block.parentNode,dom.isBlock,root);dom.remove(block),parentBlock&&dom.isEmpty(parentBlock)&&dom.remove(parentBlock)}(dom,block,root),ToggleList.mergeWithAdjacentLists(dom,otherLi_2.parentNode),editor.selection.select(otherLi_2,!0),editor.selection.collapse(isForward)}),!0}return!1}(editor,isForward)}function backspaceDelete(editor,isForward){return editor.selection.isCollapsed()?backspaceDeleteCaret(editor,isForward):function(editor){var selectionStartElm=editor.selection.getStart(),root=Selection.getClosestListRootElm(editor,selectionStartElm);return!!(editor.dom.getParent(selectionStartElm,"LI,DT,DD",root)||0<Selection.getSelectedListItems(editor).length)&&(editor.undoManager.transact(function(){editor.execCommand("Delete"),NormalizeLists_normalizeLists(editor.dom,editor.getBody())}),!0)}(editor)}function queryListCommandState(editor,listName){return function(){var parentList=editor.dom.getParent(editor.selection.getStart(),"UL,OL,DL");return parentList&&parentList.nodeName===listName}}function listState(editor,listName){return function(buttonApi){function nodeChangeHandler(e){var tableCellIndex=function(list,predicate){for(var index=0;index<list.length;index++){if(predicate(list[index]))return index}return-1}(e.parents,NodeType_isTableCellNode),parents=-1!==tableCellIndex?e.parents.slice(0,tableCellIndex):e.parents,lists=global$5.grep(parents,NodeType_isListNode);buttonApi.setActive(0<lists.length&&lists[0].nodeName===listName&&!isCustomList(lists[0]))}return editor.on("NodeChange",nodeChangeHandler),function(){return editor.off("NodeChange",nodeChangeHandler)}}}var t,global=tinymce.util.Tools.resolve("tinymce.PluginManager"),never=constant(!1),always=constant(!0),NONE=function(){function eq(o){return o.isNone()}function call(thunk){return thunk()}function id(n){return n}var me={fold:function(n,s){return n()},is:never,isSome:never,isNone:always,getOr:id,getOrThunk:call,getOrDie:function(msg){throw new Error(msg||"error: getOrDie called on none.")},getOrNull:constant(null),getOrUndefined:constant(void 0),or:id,orThunk:call,map:none,each:noop,bind:none,exists:never,forall:always,filter:none,equals:eq,equals_:eq,toArray:function(){return[]},toString:constant("none()")};return Object.freeze&&Object.freeze(me),me}(),some=function(a){function self(){return me}function bind(f){return f(a)}var constant_a=constant(a),me={fold:function(n,s){return s(a)},is:function(v){return a===v},isSome:always,isNone:never,getOr:constant_a,getOrThunk:constant_a,getOrDie:constant_a,getOrNull:constant_a,getOrUndefined:constant_a,or:self,orThunk:self,map:function(f){return some(f(a))},each:function(f){f(a)},bind:bind,exists:bind,forall:bind,filter:function(f){return f(a)?me:NONE},toArray:function(){return[a]},toString:function(){return"some("+a+")"},equals:function(o){return o.is(a)},equals_:function(o,elementEq){return o.fold(never,function(b){return elementEq(a,b)})}};return me},Option={some:some,none:none,from:function(value){return null==value?NONE:some(value)}},isString=isType("string"),isArray=isType("array"),isBoolean=isType("boolean"),isFunction=isType("function"),isNumber=isType("number"),nativeSlice=Array.prototype.slice,nativePush=Array.prototype.push,Node_documentPositionContainedBy=(isFunction(Array.from)&&Array.from,function(a,b){return compareDocumentPosition(a,b,domGlobals.Node.DOCUMENT_POSITION_CONTAINED_BY)}),__assign=function(){return(__assign=Object.assign||function(t){for(var s,i=1,n=arguments.length;i<n;i++)for(var p in s=arguments[i])Object.prototype.hasOwnProperty.call(s,p)&&(t[p]=s[p]);return t}).apply(this,arguments)},Cell=function(initial){function get(){return value}var value=initial;return{get:get,set:function(v){value=v},clone:function(){return Cell(get())}}},unknown=function(){return nu(0,0)},nu=function(major,minor){return{major:major,minor:minor}},Version={nu:nu,detect:function(versionRegexes,agent){var cleanedAgent=String(agent).toLowerCase();return 0===versionRegexes.length?unknown():find$1(versionRegexes,cleanedAgent)},unknown:unknown},nu$1=function(info){var current=info.current;return{current:current,version:info.version,isEdge:isBrowser("Edge",current),isChrome:isBrowser("Chrome",current),isIE:isBrowser("IE",current),isOpera:isBrowser("Opera",current),isFirefox:isBrowser("Firefox",current),isSafari:isBrowser("Safari",current)}},Browser={unknown:function(){return nu$1({current:void 0,version:Version.unknown()})},nu:nu$1,edge:constant("Edge"),chrome:constant("Chrome"),ie:constant("IE"),opera:constant("Opera"),firefox:constant("Firefox"),safari:constant("Safari")},nu$2=function(info){var current=info.current;return{current:current,version:info.version,isWindows:isOS("Windows",current),isiOS:isOS("iOS",current),isAndroid:isOS("Android",current),isOSX:isOS("OSX",current),isLinux:isOS("Linux",current),isSolaris:isOS("Solaris",current),isFreeBSD:isOS("FreeBSD",current),isChromeOS:isOS("ChromeOS",current)}},OperatingSystem={unknown:function(){return nu$2({current:void 0,version:Version.unknown()})},nu:nu$2,windows:constant("Windows"),ios:constant("iOS"),android:constant("Android"),linux:constant("Linux"),osx:constant("OSX"),solaris:constant("Solaris"),freebsd:constant("FreeBSD"),chromeos:constant("ChromeOS")},UaString_detectBrowser=function(browsers,userAgent){return detect$1(browsers,userAgent).map(function(browser){var version=Version.detect(browser.versionRegexes,userAgent);return{current:browser.name,version:version}})},UaString_detectOs=function(oses,userAgent){return detect$1(oses,userAgent).map(function(os){var version=Version.detect(os.versionRegexes,userAgent);return{current:os.name,version:version}})},normalVersionRegex=/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,browsers=[{name:"Edge",versionRegexes:[/.*?edge\/ ?([0-9]+)\.([0-9]+)$/],search:function(uastring){return contains(uastring,"edge/")&&contains(uastring,"chrome")&&contains(uastring,"safari")&&contains(uastring,"applewebkit")}},{name:"Chrome",versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/,normalVersionRegex],search:function(uastring){return contains(uastring,"chrome")&&!contains(uastring,"chromeframe")}},{name:"IE",versionRegexes:[/.*?msie\ ?([0-9]+)\.([0-9]+).*/,/.*?rv:([0-9]+)\.([0-9]+).*/],search:function(uastring){return contains(uastring,"msie")||contains(uastring,"trident")}},{name:"Opera",versionRegexes:[normalVersionRegex,/.*?opera\/([0-9]+)\.([0-9]+).*/],search:checkContains("opera")},{name:"Firefox",versionRegexes:[/.*?firefox\/\ ?([0-9]+)\.([0-9]+).*/],search:checkContains("firefox")},{name:"Safari",versionRegexes:[normalVersionRegex,/.*?cpu os ([0-9]+)_([0-9]+).*/],search:function(uastring){return(contains(uastring,"safari")||contains(uastring,"mobile/"))&&contains(uastring,"applewebkit")}}],oses=[{name:"Windows",search:checkContains("win"),versionRegexes:[/.*?windows\ nt\ ?([0-9]+)\.([0-9]+).*/]},{name:"iOS",search:function(uastring){return contains(uastring,"iphone")||contains(uastring,"ipad")},versionRegexes:[/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,/.*cpu os ([0-9]+)_([0-9]+).*/,/.*cpu iphone os ([0-9]+)_([0-9]+).*/]},{name:"Android",search:checkContains("android"),versionRegexes:[/.*?android\ ?([0-9]+)\.([0-9]+).*/]},{name:"OSX",search:checkContains("mac os x"),versionRegexes:[/.*?mac\ os\ x\ ?([0-9]+)_([0-9]+).*/]},{name:"Linux",search:checkContains("linux"),versionRegexes:[]},{name:"Solaris",search:checkContains("sunos"),versionRegexes:[]},{name:"FreeBSD",search:checkContains("freebsd"),versionRegexes:[]},{name:"ChromeOS",search:checkContains("cros"),versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/]}],PlatformInfo={browsers:constant(browsers),oses:constant(oses)},PlatformDetection_detect=function(userAgent,mediaMatch){var browsers=PlatformInfo.browsers(),oses=PlatformInfo.oses(),browser=UaString_detectBrowser(browsers,userAgent).fold(Browser.unknown,Browser.nu),os=UaString_detectOs(oses,userAgent).fold(OperatingSystem.unknown,OperatingSystem.nu),deviceType=function(os,browser,userAgent,mediaMatch){var isiPad=os.isiOS()&&!0===/ipad/i.test(userAgent),isiPhone=os.isiOS()&&!isiPad,isMobile=os.isiOS()||os.isAndroid(),isTouch=isMobile||mediaMatch("(pointer:coarse)"),isTablet=isiPad||!isiPhone&&isMobile&&mediaMatch("(min-device-width:768px)"),isPhone=isiPhone||isMobile&&!isTablet,iOSwebview=browser.isSafari()&&os.isiOS()&&!1===/safari/i.test(userAgent),isDesktop=!isPhone&&!isTablet&&!iOSwebview;return{isiPad:constant(isiPad),isiPhone:constant(isiPhone),isTablet:constant(isTablet),isPhone:constant(isPhone),isTouch:constant(isTouch),isAndroid:os.isAndroid,isiOS:os.isiOS,isWebView:constant(iOSwebview),isDesktop:constant(isDesktop)}}(os,browser,userAgent,mediaMatch);return{browser:browser,os:os,deviceType:deviceType}},platform=Cell(PlatformDetection_detect(domGlobals.navigator.userAgent,function(query){return domGlobals.window.matchMedia(query).matches})),fromDom=function(node){if(null==node)throw new Error("Node cannot be null or undefined");return{dom:constant(node)}},Element={fromHtml:function(html,scope){var div=(scope||domGlobals.document).createElement("div");if(div.innerHTML=html,!div.hasChildNodes()||1<div.childNodes.length)throw domGlobals.console.error("HTML does not have a single root node",html),new Error("HTML must have a single root node");return fromDom(div.childNodes[0])},fromTag:function(tag,scope){var node=(scope||domGlobals.document).createElement(tag);return fromDom(node)},fromText:function(text,scope){var node=(scope||domGlobals.document).createTextNode(text);return fromDom(node)},fromDom:fromDom,fromPoint:function(docElm,x,y){var doc=docElm.dom();return Option.from(doc.elementFromPoint(x,y)).map(fromDom)}},ELEMENT=(domGlobals.Node.ATTRIBUTE_NODE,domGlobals.Node.CDATA_SECTION_NODE,domGlobals.Node.COMMENT_NODE,domGlobals.Node.DOCUMENT_NODE,domGlobals.Node.DOCUMENT_TYPE_NODE,domGlobals.Node.DOCUMENT_FRAGMENT_NODE,domGlobals.Node.ELEMENT_NODE),ELEMENT$1=(domGlobals.Node.TEXT_NODE,domGlobals.Node.PROCESSING_INSTRUCTION_NODE,domGlobals.Node.ENTITY_REFERENCE_NODE,domGlobals.Node.ENTITY_NODE,domGlobals.Node.NOTATION_NODE,ELEMENT),contains$1=platform.get().browser.isIE()?function(e1,e2){return Node_documentPositionContainedBy(e1.dom(),e2.dom())}:function(e1,e2){var d1=e1.dom(),d2=e2.dom();return d1!==d2&&d1.contains(d2)},is$1=function(element,selector){var dom=element.dom();if(dom.nodeType!==ELEMENT$1)return!1;var elem=dom;if(void 0!==elem.matches)return elem.matches(selector);if(void 0!==elem.msMatchesSelector)return elem.msMatchesSelector(selector);if(void 0!==elem.webkitMatchesSelector)return elem.webkitMatchesSelector(selector);if(void 0!==elem.mozMatchesSelector)return elem.mozMatchesSelector(selector);throw new Error("Browser lacks native selectors")},global$1=tinymce.util.Tools.resolve("tinymce.dom.RangeUtils"),global$2=tinymce.util.Tools.resolve("tinymce.dom.TreeWalker"),global$3=tinymce.util.Tools.resolve("tinymce.util.VK"),keys=Object.keys,Global=(function(){for(var fields=[],_i=0;_i<arguments.length;_i++)fields[_i]=arguments[_i]}("element","offset"),void 0!==domGlobals.window?domGlobals.window:Function("return this;")()),Global$1_getOrDie=function(name,scope){var actual=function(name,scope){return resolve(name,scope)}(name,scope);if(null==actual)throw new Error(name+" not available on this browser");return actual},HTMLElement_isPrototypeOf=function(x){return function(scope){return Global$1_getOrDie("HTMLElement",scope)}(resolve("ownerDocument.defaultView",x)).prototype.isPrototypeOf(x)},global$4=tinymce.util.Tools.resolve("tinymce.dom.DomQuery"),global$5=tinymce.util.Tools.resolve("tinymce.util.Tools"),NodeType_isTextNode=function(node){return node&&3===node.nodeType},NodeType_isListNode=function(node){return node&&/^(OL|UL|DL)$/.test(node.nodeName)},NodeType_isOlUlNode=function(node){return node&&/^(OL|UL)$/.test(node.nodeName)},NodeType_isDlItemNode=function(node){return node&&/^(DT|DD)$/.test(node.nodeName)},NodeType_isListItemNode=function(node){return node&&/^(LI|DT|DD)$/.test(node.nodeName)},NodeType_isTableCellNode=function(node){return node&&/^(TH|TD)$/.test(node.nodeName)},NodeType_isBr=isBr,NodeType_isFirstChild=function(node){return node.parentNode.firstChild===node},NodeType_isTextBlock=function(editor,node){return node&&!!editor.schema.getTextBlockElements()[node.nodeName]},NodeType_isBlock=function(node,blockElements){return node&&node.nodeName in blockElements},NodeType_isBogusBr=function(dom,node){return!!isBr(node)&&!(!dom.isBlock(node.nextSibling)||isBr(node.previousSibling))},NodeType_isEmpty=function(dom,elm,keepBookmarks){var empty=dom.isEmpty(elm);return!(keepBookmarks&&0<dom.select("span[data-mce-type=bookmark]",elm).length)&&empty},NodeType_isChildOfBody=function(dom,elm){return dom.isChildOf(elm,dom.getRoot())},getClosestListRootElm=function(editor,elm){var parentTableCell=editor.dom.getParents(elm,"TD,TH");return 0<parentTableCell.length?parentTableCell[0]:editor.getBody()},getUniqueListRoots=function(editor,lists){var listRoots=map(lists,function(list){return findLastParentListNode(editor,list).getOr(list)});return global$4.unique(listRoots)},Selection={isList:function(editor){var list=getParentList(editor);return HTMLElement_isPrototypeOf(list)},getParentList:getParentList,getSelectedSubLists:function(editor){var parentList=getParentList(editor),selectedBlocks=editor.selection.getSelectedBlocks();return function(parentList,selectedBlocks){return parentList&&1===selectedBlocks.length&&selectedBlocks[0]===parentList}(parentList,selectedBlocks)?function(parentList){return global$5.grep(parentList.querySelectorAll("ol,ul,dl"),function(elm){return NodeType_isListNode(elm)})}(parentList):global$5.grep(selectedBlocks,function(elm){return NodeType_isListNode(elm)&&parentList!==elm})},getSelectedListItems:getSelectedListItems,getClosestListRootElm:getClosestListRootElm,getSelectedDlItems:function(editor){return filter(getSelectedListItems(editor),NodeType_isDlItemNode)},getSelectedListRoots:function(editor){var selectedLists=function(editor){var firstList=findLastParentListNode(editor,editor.selection.getStart()),subsequentLists=filter(editor.selection.getSelectedBlocks(),NodeType_isOlUlNode);return firstList.toArray().concat(subsequentLists)}(editor);return getUniqueListRoots(editor,selectedLists)}},Settings_shouldIndentOnTab=function(editor){return editor.getParam("lists_indent_on_tab",!0)},Settings_getForcedRootBlock=function(editor){var block=editor.getParam("forced_root_block","p");return!1===block?"":!0===block?"p":block},Settings_getForcedRootBlockAttrs=function(editor){return editor.getParam("forced_root_block_attrs",{})},isElement=(t=ELEMENT,function(element){return function(element){return element.dom().nodeType}(element)===t}),parseList=function(depth,itemSelection,selectionState,list){return bind(children(list),function(element){return(isList$1(element)?parseList:parseItem)(depth+1,itemSelection,selectionState,element)})},global$6=tinymce.util.Tools.resolve("tinymce.dom.DOMUtils"),DOM=global$6.DOM,SplitList_splitList=function(editor,ul,li){var tmpRng,fragment,bookmarks,node,newBlock,targetNode;for(bookmarks=DOM.select('span[data-mce-type="bookmark"]',ul),newBlock=createTextBlock(editor,li),(tmpRng=DOM.createRng()).setStartAfter(li),tmpRng.setEndAfter(ul),node=(fragment=tmpRng.extractContents()).firstChild;node;node=node.firstChild)if("LI"===node.nodeName&&editor.dom.isEmpty(node)){DOM.remove(node);break}editor.dom.isEmpty(fragment)||DOM.insertAfter(fragment,ul),DOM.insertAfter(newBlock,ul),NodeType_isEmpty(editor.dom,li.parentNode)&&(targetNode=li.parentNode,global$5.each(bookmarks,function(node){targetNode.parentNode.insertBefore(node,li.parentNode)}),DOM.remove(targetNode)),DOM.remove(li),NodeType_isEmpty(editor.dom,ul)&&DOM.remove(ul)},Range_normalizeRange=function(rng){var outRng=rng.cloneRange(),rangeStart=getNormalizedPoint(rng.startContainer,rng.startOffset);outRng.setStart(rangeStart.container,rangeStart.offset);var rangeEnd=getNormalizedPoint(rng.endContainer,rng.endOffset);return outRng.setEnd(rangeEnd.container,rangeEnd.offset),outRng},global$7=tinymce.util.Tools.resolve("tinymce.dom.BookmarkManager"),DOM$1=global$6.DOM,Bookmark_createBookmark=function(rng){function setupEndPoint(start){var offsetNode,container,offset;container=rng[start?"startContainer":"endContainer"],offset=rng[start?"startOffset":"endOffset"],1===container.nodeType&&(offsetNode=DOM$1.create("span",{"data-mce-type":"bookmark"}),container.hasChildNodes()?(offset=Math.min(offset,container.childNodes.length-1),start?container.insertBefore(offsetNode,container.childNodes[offset]):DOM$1.insertAfter(offsetNode,container.childNodes[offset])):container.appendChild(offsetNode),container=offsetNode,offset=0),bookmark[start?"startContainer":"endContainer"]=container,bookmark[start?"startOffset":"endOffset"]=offset}var bookmark={};return setupEndPoint(!0),rng.collapsed||setupEndPoint(),bookmark},Bookmark_resolveBookmark=function(bookmark){function restoreEndPoint(start){var container,offset,node;container=node=bookmark[start?"startContainer":"endContainer"],offset=bookmark[start?"startOffset":"endOffset"],container&&(1===container.nodeType&&(offset=function(container){for(var node=container.parentNode.firstChild,idx=0;node;){if(node===container)return idx;1===node.nodeType&&"bookmark"===node.getAttribute("data-mce-type")||idx++,node=node.nextSibling}return-1}(container),container=container.parentNode,DOM$1.remove(node),!container.hasChildNodes()&&DOM$1.isBlock(container)&&container.appendChild(DOM$1.create("br"))),bookmark[start?"startContainer":"endContainer"]=container,bookmark[start?"startOffset":"endOffset"]=offset)}restoreEndPoint(!0),restoreEndPoint();var rng=DOM$1.createRng();return rng.setStart(bookmark.startContainer,bookmark.startOffset),bookmark.endContainer&&rng.setEnd(bookmark.endContainer,bookmark.endOffset),Range_normalizeRange(rng)},mergeWithAdjacentLists=function(dom,listBlock){var sibling,node;if(sibling=listBlock.nextSibling,shouldMerge(dom,listBlock,sibling)){for(;node=sibling.firstChild;)listBlock.appendChild(node);dom.remove(sibling)}if(sibling=listBlock.previousSibling,shouldMerge(dom,listBlock,sibling)){for(;node=sibling.lastChild;)listBlock.insertBefore(node,listBlock.firstChild);dom.remove(sibling)}},hasListStyleDetail=function(detail){return"list-style-type"in detail},ToggleList={toggleList:function(editor,listName,detail){var parentList=Selection.getParentList(editor),selectedSubLists=Selection.getSelectedSubLists(editor);detail=detail||{},parentList&&0<selectedSubLists.length?toggleMultipleLists(editor,parentList,selectedSubLists,listName,detail):function(editor,parentList,listName,detail){if(parentList!==editor.getBody())if(parentList)if(parentList.nodeName!==listName||hasListStyleDetail(detail)||isCustomList(parentList)){var bookmark=Bookmark_createBookmark(editor.selection.getRng(!0));updateListWithDetails(editor.dom,parentList,detail);var newList=editor.dom.rename(parentList,listName);mergeWithAdjacentLists(editor.dom,newList),editor.selection.setRng(Bookmark_resolveBookmark(bookmark)),fireListEvent(editor,listToggleActionFromListName(listName),newList)}else flattenListSelection(editor);else applyList(editor,listName,detail),fireListEvent(editor,listToggleActionFromListName(listName),parentList)}(editor,parentList,listName,detail)},mergeWithAdjacentLists:mergeWithAdjacentLists},DOM$2=global$6.DOM,NormalizeLists_normalizeLists=function(dom,element){global$5.each(global$5.grep(dom.select("ol,ul",element)),function(ul){normalizeList(dom,ul)})},Delete_setup=function(editor){editor.on("keydown",function(e){e.keyCode===global$3.BACKSPACE?backspaceDelete(editor,!1)&&e.preventDefault():e.keyCode===global$3.DELETE&&backspaceDelete(editor,!0)&&e.preventDefault()})},Delete_backspaceDelete=backspaceDelete,Api_get=function(editor){return{backspaceDelete:function(isForward){Delete_backspaceDelete(editor,isForward)}}},Commands_register=function(editor){editor.on("BeforeExecCommand",function(e){var cmd=e.command.toLowerCase();"indent"===cmd?indentListSelection(editor):"outdent"===cmd&&outdentListSelection(editor)}),editor.addCommand("InsertUnorderedList",function(ui,detail){ToggleList.toggleList(editor,"UL",detail)}),editor.addCommand("InsertOrderedList",function(ui,detail){ToggleList.toggleList(editor,"OL",detail)}),editor.addCommand("InsertDefinitionList",function(ui,detail){ToggleList.toggleList(editor,"DL",detail)}),editor.addCommand("RemoveList",function(){flattenListSelection(editor)}),editor.addQueryStateHandler("InsertUnorderedList",queryListCommandState(editor,"UL")),editor.addQueryStateHandler("InsertOrderedList",queryListCommandState(editor,"OL")),editor.addQueryStateHandler("InsertDefinitionList",queryListCommandState(editor,"DL"))},Keyboard_setup=function(editor){Settings_shouldIndentOnTab(editor)&&function(editor){editor.on("keydown",function(e){e.keyCode!==global$3.TAB||global$3.metaKeyPressed(e)||editor.undoManager.transact(function(){(e.shiftKey?outdentListSelection(editor):indentListSelection(editor))&&e.preventDefault()})})}(editor),Delete_setup(editor)},Buttons_register=function(editor){function exec(command){return function(){return editor.execCommand(command)}}!function(editor,plugin){var plugins=editor.settings.plugins?editor.settings.plugins:"";return-1!==global$5.inArray(plugins.split(/[ ,]/),plugin)}(editor,"advlist")&&(editor.ui.registry.addToggleButton("numlist",{icon:"ordered-list",active:!1,tooltip:"Numbered list",onAction:exec("InsertOrderedList"),onSetup:listState(editor,"OL")}),editor.ui.registry.addToggleButton("bullist",{icon:"unordered-list",active:!1,tooltip:"Bullet list",onAction:exec("InsertUnorderedList"),onSetup:listState(editor,"UL")}))};global.add("lists",function(editor){return Keyboard_setup(editor),Buttons_register(editor),Commands_register(editor),Api_get(editor)})}(window),function(){"use strict";function getPageBreakClass(){return"mce-pagebreak"}function getPlaceholderHtml(){return'<img src="'+global$1.transparentSrc+'" class="mce-pagebreak" data-mce-resize="false" data-mce-placeholder />'}var global=tinymce.util.Tools.resolve("tinymce.PluginManager"),global$1=tinymce.util.Tools.resolve("tinymce.Env"),Settings_getSeparatorHtml=function(editor){return editor.getParam("pagebreak_separator","\x3c!-- pagebreak --\x3e")},Settings_shouldSplitBlock=function(editor){return editor.getParam("pagebreak_split_block",!1)},FilterContent_setup=function(editor){var separatorHtml=Settings_getSeparatorHtml(editor),pageBreakSeparatorRegExp=new RegExp(separatorHtml.replace(/[\?\.\*\[\]\(\)\{\}\+\^\$\:]/g,function(a){return"\\"+a}),"gi");editor.on("BeforeSetContent",function(e){e.content=e.content.replace(pageBreakSeparatorRegExp,getPlaceholderHtml())}),editor.on("PreInit",function(){editor.serializer.addNodeFilter("img",function(nodes){for(var node,className,i=nodes.length;i--;)if((className=(node=nodes[i]).attr("class"))&&-1!==className.indexOf("mce-pagebreak")){var parentNode=node.parent;if(editor.schema.getBlockElements()[parentNode.name]&&Settings_shouldSplitBlock(editor)){parentNode.type=3,parentNode.value=separatorHtml,parentNode.raw=!0,node.remove();continue}node.type=3,node.value=separatorHtml,node.raw=!0}})})},FilterContent_getPlaceholderHtml=getPlaceholderHtml,FilterContent_getPageBreakClass=getPageBreakClass,Commands_register=function(editor){editor.addCommand("mcePageBreak",function(){editor.settings.pagebreak_split_block?editor.insertContent("<p>"+FilterContent_getPlaceholderHtml()+"</p>"):editor.insertContent(FilterContent_getPlaceholderHtml())})},ResolveName_setup=function(editor){editor.on("ResolveName",function(e){"IMG"===e.target.nodeName&&editor.dom.hasClass(e.target,FilterContent_getPageBreakClass())&&(e.name="pagebreak")})},Buttons_register=function(editor){editor.ui.registry.addButton("pagebreak",{icon:"page-break",tooltip:"Page break",onAction:function(){return editor.execCommand("mcePageBreak")}}),editor.ui.registry.addMenuItem("pagebreak",{text:"Page break",icon:"page-break",onAction:function(){return editor.execCommand("mcePageBreak")}})};global.add("pagebreak",function(editor){Commands_register(editor),Buttons_register(editor),FilterContent_setup(editor),ResolveName_setup(editor)})}(),function(domGlobals){"use strict";function constant(value){return function(){return value}}function identity(x){return x}var Cell=function(initial){function get(){return value}var value=initial;return{get:get,set:function(v){value=v},clone:function(){return Cell(get())}}},noop=function(){};function curry(fn){for(var initialArgs=[],_i=1;_i<arguments.length;_i++)initialArgs[_i-1]=arguments[_i];return function(){for(var restArgs=[],_i=0;_i<arguments.length;_i++)restArgs[_i]=arguments[_i];var all=initialArgs.concat(restArgs);return fn.apply(null,all)}}function not(f){return function(){for(var args=[],_i=0;_i<arguments.length;_i++)args[_i]=arguments[_i];return!f.apply(null,args)}}function none(){return NONE}function isType(type){return function(value){return function(x){if(null===x)return"null";var t=typeof x;return"object"==t&&(Array.prototype.isPrototypeOf(x)||x.constructor&&"Array"===x.constructor.name)?"array":"object"==t&&(String.prototype.isPrototypeOf(x)||x.constructor&&"String"===x.constructor.name)?"string":t}(value)===type}}function contains(xs,x){return-1<function(ts,t){return nativeIndexOf.call(ts,t)}(xs,x)}function exists(xs,pred){for(var i=0,len=xs.length;i<len;i++){if(pred(xs[i],i))return!0}return!1}function map(xs,f){for(var len=xs.length,r=new Array(len),i=0;i<len;i++){var x=xs[i];r[i]=f(x,i)}return r}function each(xs,f){for(var i=0,len=xs.length;i<len;i++){f(xs[i],i)}}function filter(xs,pred){for(var r=[],i=0,len=xs.length;i<len;i++){var x=xs[i];pred(x,i)&&r.push(x)}return r}function foldr(xs,f,acc){return function(xs,f){for(var i=xs.length-1;0<=i;i--){f(xs[i],i)}}(xs,function(x){acc=f(acc,x)}),acc}function foldl(xs,f,acc){return each(xs,function(x){acc=f(acc,x)}),acc}function find(xs,pred){for(var i=0,len=xs.length;i<len;i++){var x=xs[i];if(pred(x,i))return Option.some(x)}return Option.none()}function findIndex(xs,pred){for(var i=0,len=xs.length;i<len;i++){if(pred(xs[i],i))return Option.some(i)}return Option.none()}function flatten(xs){for(var r=[],i=0,len=xs.length;i<len;++i){if(!isArray(xs[i]))throw new Error("Arr.flatten item "+i+" was not an array, input: "+xs);nativePush.apply(r,xs[i])}return r}function bind(xs,f){return flatten(map(xs,f))}function forall(xs,pred){for(var i=0,len=xs.length;i<len;++i){if(!0!==pred(xs[i],i))return!1}return!0}function reverse(xs){var r=nativeSlice.call(xs,0);return r.reverse(),r}function findMap(arr,f){for(var i=0;i<arr.length;i++){var r=f(arr[i],i);if(r.isSome())return r}return Option.none()}function each$1(obj,f){for(var props=keys(obj),k=0,len=props.length;k<len;k++){var i=props[k];f(obj[i],i)}}function map$1(obj,f){return tupleMap(obj,function(x,i){return{k:i,v:f(x,i)}})}function get(obj,key){return has(obj,key)?Option.from(obj[key]):Option.none()}function Immutable(){for(var fields=[],_i=0;_i<arguments.length;_i++)fields[_i]=arguments[_i];return function(){for(var values=[],_i=0;_i<arguments.length;_i++)values[_i]=arguments[_i];if(fields.length!==values.length)throw new Error('Wrong number of arguments to struct. Expected "['+fields.length+']", got '+values.length+" arguments");var struct={};return each(fields,function(name,i){struct[name]=constant(values[i])}),struct}}function sort(arr){return arr.slice(0).sort()}function reqMessage(required,keys){throw new Error("All required keys ("+sort(required).join(", ")+") were not specified. Specified keys were: "+sort(keys).join(", ")+".")}function unsuppMessage(unsupported){throw new Error("Unsupported keys for object: "+sort(unsupported).join(", "))}function validateStrArr(label,array){if(!isArray(array))throw new Error("The "+label+" fields must be an array. Was: "+array+".");each(array,function(a){if(!isString(a))throw new Error("The value "+a+" in the "+label+" fields was not a string.")})}function checkDupes(everything){var sorted=sort(everything);find(sorted,function(s,i){return i<sorted.length-1&&s===sorted[i+1]}).each(function(d){throw new Error("The field: "+d+" occurs more than once in the combined fields: ["+sorted.join(", ")+"].")})}function type(element){return element.dom().nodeType}function isType$1(t){return function(element){return type(element)===t}}function isComment(element){return type(element)===COMMENT||"#comment"===name(element)}function rawSet(dom,key,value){if(!(isString(value)||isBoolean(value)||isNumber(value)))throw domGlobals.console.error("Invalid call to Attr.set. Key ",key,":: Value ",value,":: Element ",dom),new Error("Attribute value was not simple");dom.setAttribute(key,value+"")}function set(element,key,value){rawSet(element.dom(),key,value)}function setAll(element,attrs){var dom=element.dom();each$1(attrs,function(v,k){rawSet(dom,k,v)})}function get$1(element,key){var v=element.dom().getAttribute(key);return null===v?void 0:v}function has$1(element,key){var dom=element.dom();return!(!dom||!dom.hasAttribute)&&dom.hasAttribute(key)}function remove(element,key){element.dom().removeAttribute(key)}function clone(element){return foldl(element.dom().attributes,function(acc,attr){return acc[attr.name]=attr.value,acc},{})}function checkRange(str,substr,start){return""===substr||!(str.length<substr.length)&&str.substr(start,start+substr.length)===substr}function contains$1(str,substr){return-1!==str.indexOf(substr)}function startsWith(str,prefix){return checkRange(str,prefix,0)}function isSupported(dom){return void 0!==dom.style&&isFunction(dom.style.getPropertyValue)}function cached(f){var r,called=!1;return function(){for(var args=[],_i=0;_i<arguments.length;_i++)args[_i]=arguments[_i];return called||(called=!0,r=f.apply(null,args)),r}}function inBody(element){var dom=isText(element)?element.dom().parentNode:element.dom();return null!=dom&&dom.ownerDocument.body.contains(dom)}function internalSet(dom,property,value){if(!isString(value))throw domGlobals.console.error("Invalid call to CSS.set. Property ",property,":: Value ",value,":: Element ",dom),new Error("CSS value must be a string: "+value);isSupported(dom)&&dom.style.setProperty(property,value)}function set$1(element,property,value){var dom=element.dom();internalSet(dom,property,value)}function setAll$1(element,css){var dom=element.dom();each$1(css,function(v,k){internalSet(dom,k,v)})}function get$2(element,property){var dom=element.dom(),r=domGlobals.window.getComputedStyle(dom).getPropertyValue(property),v=""!==r||inBody(element)?r:getUnsafeProperty(dom,property);return null===v?void 0:v}function getRaw(element,property){var dom=element.dom(),raw=getUnsafeProperty(dom,property);return Option.from(raw).filter(function(r){return 0<r.length})}function remove$1(element,property){!function(dom,property){isSupported(dom)&&dom.style.removeProperty(property)}(element.dom(),property),has$1(element,"style")&&""===function(str){return str.replace(/^\s+|\s+$/g,"")}(get$1(element,"style"))&&remove(element,"style")}function compareDocumentPosition(a,b,match){return 0!=(a.compareDocumentPosition(b)&match)}function find$1(regexes,agent){var r=function(regexes,s){for(var i=0;i<regexes.length;i++){var x=regexes[i];if(x.test(s))return x}}(regexes,agent);if(!r)return{major:0,minor:0};function group(i){return Number(agent.replace(r,"$"+i))}return nu(group(1),group(2))}function isBrowser(name,current){return function(){return current===name}}function isOS(name,current){return function(){return current===name}}function detect$1(candidates,userAgent){var agent=String(userAgent).toLowerCase();return find(candidates,function(candidate){return candidate.search(agent)})}function checkContains(target){return function(uastring){return contains$1(uastring,target)}}function detect$3(){return platform.get()}function is(element,selector){var dom=element.dom();if(dom.nodeType!==ELEMENT$1)return!1;var elem=dom;if(void 0!==elem.matches)return elem.matches(selector);if(void 0!==elem.msMatchesSelector)return elem.msMatchesSelector(selector);if(void 0!==elem.webkitMatchesSelector)return elem.webkitMatchesSelector(selector);if(void 0!==elem.mozMatchesSelector)return elem.mozMatchesSelector(selector);throw new Error("Browser lacks native selectors")}function bypassSelector(dom){return dom.nodeType!==ELEMENT$1&&dom.nodeType!==DOCUMENT$1||0===dom.childElementCount}function owner(element){return Element.fromDom(element.dom().ownerDocument)}function parent(element){return Option.from(element.dom().parentNode).map(Element.fromDom)}function parents(element,isRoot){for(var stop=isFunction(isRoot)?isRoot:never,dom=element.dom(),ret=[];null!==dom.parentNode&&void 0!==dom.parentNode;){var rawParent=dom.parentNode,p=Element.fromDom(rawParent);if(ret.push(p),!0===stop(p))break;dom=rawParent}return ret}function prevSibling(element){return Option.from(element.dom().previousSibling).map(Element.fromDom)}function nextSibling(element){return Option.from(element.dom().nextSibling).map(Element.fromDom)}function children(element){return map(element.dom().childNodes,Element.fromDom)}function child(element,index){var cs=element.dom().childNodes;return Option.from(cs[index]).map(Element.fromDom)}function before(marker,element){parent(marker).each(function(v){v.dom().insertBefore(element.dom(),marker.dom())})}function after(marker,element){nextSibling(marker).fold(function(){parent(marker).each(function(v){append(v,element)})},function(v){before(v,element)})}function prepend(parent,element){(function(element){return child(element,0)})(parent).fold(function(){append(parent,element)},function(v){parent.dom().insertBefore(element.dom(),v.dom())})}function wrap(element,wrapper){before(element,wrapper),append(wrapper,element)}function after$1(marker,elements){each(elements,function(x,i){var e=0===i?marker:elements[i-1];after(e,x)})}function append$1(parent,elements){each(elements,function(x){append(parent,x)})}function empty(element){element.dom().textContent="",each(children(element),function(rogue){remove$2(rogue)})}function unwrap(wrapper){var children$1=children(wrapper);0<children$1.length&&function(marker,elements){each(elements,function(x){before(marker,x)})}(wrapper,children$1),remove$2(wrapper)}function ancestors$1(scope,selector,isRoot){return function(scope,predicate,isRoot){return filter(parents(scope,isRoot),predicate)}(scope,function(e){return is(e,selector)},isRoot)}function children$2(scope,selector){return function(scope,predicate){return filter(children(scope),predicate)}(scope,function(e){return is(e,selector)})}function descendants$1(scope,selector){return function(selector,scope){var base=void 0===scope?domGlobals.document:scope.dom();return bypassSelector(base)?[]:map(base.querySelectorAll(selector),Element.fromDom)}(selector,scope)}var never=constant(!1),always=constant(!0),NONE=function(){function eq(o){return o.isNone()}function call(thunk){return thunk()}function id(n){return n}var me={fold:function(n,s){return n()},is:never,isSome:never,isNone:always,getOr:id,getOrThunk:call,getOrDie:function(msg){throw new Error(msg||"error: getOrDie called on none.")},getOrNull:constant(null),getOrUndefined:constant(void 0),or:id,orThunk:call,map:none,each:noop,bind:none,exists:never,forall:always,filter:none,equals:eq,equals_:eq,toArray:function(){return[]},toString:constant("none()")};return Object.freeze&&Object.freeze(me),me}(),some=function(a){function self(){return me}function bind(f){return f(a)}var constant_a=constant(a),me={fold:function(n,s){return s(a)},is:function(v){return a===v},isSome:always,isNone:never,getOr:constant_a,getOrThunk:constant_a,getOrDie:constant_a,getOrNull:constant_a,getOrUndefined:constant_a,or:self,orThunk:self,map:function(f){return some(f(a))},each:function(f){f(a)},bind:bind,exists:bind,forall:bind,filter:function(f){return f(a)?me:NONE},toArray:function(){return[a]},toString:function(){return"some("+a+")"},equals:function(o){return o.is(a)},equals_:function(o,elementEq){return o.fold(never,function(b){return elementEq(a,b)})}};return me},Option={some:some,none:none,from:function(value){return null==value?NONE:some(value)}},global=tinymce.util.Tools.resolve("tinymce.PluginManager"),isString=isType("string"),isArray=isType("array"),isBoolean=isType("boolean"),isFunction=isType("function"),isNumber=isType("number"),nativeSlice=Array.prototype.slice,nativeIndexOf=Array.prototype.indexOf,nativePush=Array.prototype.push,keys=(isFunction(Array.from)&&Array.from,Object.keys),hasOwnProperty=Object.hasOwnProperty,tupleMap=function(obj,f){var r={};return each$1(obj,function(x,i){var tuple=f(x,i);r[tuple.k]=tuple.v}),r},has=function(obj,key){return hasOwnProperty.call(obj,key)},MixedBag=function(required,optional){var everything=required.concat(optional);if(0===everything.length)throw new Error("You must specify at least one required or optional field.");return validateStrArr("required",required),validateStrArr("optional",optional),checkDupes(everything),function(obj){var keys$1=keys(obj);forall(required,function(req){return contains(keys$1,req)})||reqMessage(required,keys$1);var unsupported=filter(keys$1,function(key){return!contains(everything,key)});0<unsupported.length&&unsuppMessage(unsupported);var r={};return each(required,function(req){r[req]=constant(obj[req])}),each(optional,function(opt){r[opt]=constant(Object.prototype.hasOwnProperty.call(obj,opt)?Option.some(obj[opt]):Option.none())}),r}},COMMENT=(domGlobals.Node.ATTRIBUTE_NODE,domGlobals.Node.CDATA_SECTION_NODE,domGlobals.Node.COMMENT_NODE),DOCUMENT=domGlobals.Node.DOCUMENT_NODE,ELEMENT=(domGlobals.Node.DOCUMENT_TYPE_NODE,domGlobals.Node.DOCUMENT_FRAGMENT_NODE,domGlobals.Node.ELEMENT_NODE),TEXT=domGlobals.Node.TEXT_NODE,name=(domGlobals.Node.PROCESSING_INSTRUCTION_NODE,domGlobals.Node.ENTITY_REFERENCE_NODE,domGlobals.Node.ENTITY_NODE,domGlobals.Node.NOTATION_NODE,void 0!==domGlobals.window?domGlobals.window:Function("return this;")(),function(element){return element.dom().nodeName.toLowerCase()}),isElement=isType$1(ELEMENT),isText=isType$1(TEXT),fromDom=function(node){if(null==node)throw new Error("Node cannot be null or undefined");return{dom:constant(node)}},Element={fromHtml:function(html,scope){var div=(scope||domGlobals.document).createElement("div");if(div.innerHTML=html,!div.hasChildNodes()||1<div.childNodes.length)throw domGlobals.console.error("HTML does not have a single root node",html),new Error("HTML must have a single root node");return fromDom(div.childNodes[0])},fromTag:function(tag,scope){var node=(scope||domGlobals.document).createElement(tag);return fromDom(node)},fromText:function(text,scope){var node=(scope||domGlobals.document).createTextNode(text);return fromDom(node)},fromDom:fromDom,fromPoint:function(docElm,x,y){var doc=docElm.dom();return Option.from(doc.elementFromPoint(x,y)).map(fromDom)}},body=cached(function(){return getBody(Element.fromDom(domGlobals.document))}),getBody=function(doc){var b=doc.dom().body;if(null==b)throw new Error("Body is not available yet");return Element.fromDom(b)},getUnsafeProperty=function(dom,property){return isSupported(dom)?dom.style.getPropertyValue(property):""},Node_documentPositionContainedBy=function(a,b){return compareDocumentPosition(a,b,domGlobals.Node.DOCUMENT_POSITION_CONTAINED_BY)},__assign=function(){return(__assign=Object.assign||function(t){for(var s,i=1,n=arguments.length;i<n;i++)for(var p in s=arguments[i])Object.prototype.hasOwnProperty.call(s,p)&&(t[p]=s[p]);return t}).apply(this,arguments)},unknown=function(){return nu(0,0)},nu=function(major,minor){return{major:major,minor:minor}},Version={nu:nu,detect:function(versionRegexes,agent){var cleanedAgent=String(agent).toLowerCase();return 0===versionRegexes.length?unknown():find$1(versionRegexes,cleanedAgent)},unknown:unknown},nu$1=function(info){var current=info.current;return{current:current,version:info.version,isEdge:isBrowser("Edge",current),isChrome:isBrowser("Chrome",current),isIE:isBrowser("IE",current),isOpera:isBrowser("Opera",current),isFirefox:isBrowser("Firefox",current),isSafari:isBrowser("Safari",current)}},Browser={unknown:function(){return nu$1({current:void 0,version:Version.unknown()})},nu:nu$1,edge:constant("Edge"),chrome:constant("Chrome"),ie:constant("IE"),opera:constant("Opera"),firefox:constant("Firefox"),safari:constant("Safari")},nu$2=function(info){var current=info.current;return{current:current,version:info.version,isWindows:isOS("Windows",current),isiOS:isOS("iOS",current),isAndroid:isOS("Android",current),isOSX:isOS("OSX",current),isLinux:isOS("Linux",current),isSolaris:isOS("Solaris",current),isFreeBSD:isOS("FreeBSD",current),isChromeOS:isOS("ChromeOS",current)}},OperatingSystem={unknown:function(){return nu$2({current:void 0,version:Version.unknown()})},nu:nu$2,windows:constant("Windows"),ios:constant("iOS"),android:constant("Android"),linux:constant("Linux"),osx:constant("OSX"),solaris:constant("Solaris"),freebsd:constant("FreeBSD"),chromeos:constant("ChromeOS")},UaString_detectBrowser=function(browsers,userAgent){return detect$1(browsers,userAgent).map(function(browser){var version=Version.detect(browser.versionRegexes,userAgent);return{current:browser.name,version:version}})},UaString_detectOs=function(oses,userAgent){return detect$1(oses,userAgent).map(function(os){var version=Version.detect(os.versionRegexes,userAgent);return{current:os.name,version:version}})},normalVersionRegex=/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,browsers=[{name:"Edge",versionRegexes:[/.*?edge\/ ?([0-9]+)\.([0-9]+)$/],search:function(uastring){return contains$1(uastring,"edge/")&&contains$1(uastring,"chrome")&&contains$1(uastring,"safari")&&contains$1(uastring,"applewebkit")}},{name:"Chrome",versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/,normalVersionRegex],search:function(uastring){return contains$1(uastring,"chrome")&&!contains$1(uastring,"chromeframe")}},{name:"IE",versionRegexes:[/.*?msie\ ?([0-9]+)\.([0-9]+).*/,/.*?rv:([0-9]+)\.([0-9]+).*/],search:function(uastring){return contains$1(uastring,"msie")||contains$1(uastring,"trident")}},{name:"Opera",versionRegexes:[normalVersionRegex,/.*?opera\/([0-9]+)\.([0-9]+).*/],search:checkContains("opera")},{name:"Firefox",versionRegexes:[/.*?firefox\/\ ?([0-9]+)\.([0-9]+).*/],search:checkContains("firefox")},{name:"Safari",versionRegexes:[normalVersionRegex,/.*?cpu os ([0-9]+)_([0-9]+).*/],search:function(uastring){return(contains$1(uastring,"safari")||contains$1(uastring,"mobile/"))&&contains$1(uastring,"applewebkit")}}],oses=[{name:"Windows",search:checkContains("win"),versionRegexes:[/.*?windows\ nt\ ?([0-9]+)\.([0-9]+).*/]},{name:"iOS",search:function(uastring){return contains$1(uastring,"iphone")||contains$1(uastring,"ipad")},versionRegexes:[/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,/.*cpu os ([0-9]+)_([0-9]+).*/,/.*cpu iphone os ([0-9]+)_([0-9]+).*/]},{name:"Android",search:checkContains("android"),versionRegexes:[/.*?android\ ?([0-9]+)\.([0-9]+).*/]},{name:"OSX",search:checkContains("mac os x"),versionRegexes:[/.*?mac\ os\ x\ ?([0-9]+)_([0-9]+).*/]},{name:"Linux",search:checkContains("linux"),versionRegexes:[]},{name:"Solaris",search:checkContains("sunos"),versionRegexes:[]},{name:"FreeBSD",search:checkContains("freebsd"),versionRegexes:[]},{name:"ChromeOS",search:checkContains("cros"),versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/]}],PlatformInfo={browsers:constant(browsers),oses:constant(oses)},PlatformDetection_detect=function(userAgent,mediaMatch){var browsers=PlatformInfo.browsers(),oses=PlatformInfo.oses(),browser=UaString_detectBrowser(browsers,userAgent).fold(Browser.unknown,Browser.nu),os=UaString_detectOs(oses,userAgent).fold(OperatingSystem.unknown,OperatingSystem.nu),deviceType=function(os,browser,userAgent,mediaMatch){var isiPad=os.isiOS()&&!0===/ipad/i.test(userAgent),isiPhone=os.isiOS()&&!isiPad,isMobile=os.isiOS()||os.isAndroid(),isTouch=isMobile||mediaMatch("(pointer:coarse)"),isTablet=isiPad||!isiPhone&&isMobile&&mediaMatch("(min-device-width:768px)"),isPhone=isiPhone||isMobile&&!isTablet,iOSwebview=browser.isSafari()&&os.isiOS()&&!1===/safari/i.test(userAgent),isDesktop=!isPhone&&!isTablet&&!iOSwebview;return{isiPad:constant(isiPad),isiPhone:constant(isiPhone),isTablet:constant(isTablet),isPhone:constant(isPhone),isTouch:constant(isTouch),isAndroid:os.isAndroid,isiOS:os.isiOS,isWebView:constant(iOSwebview),isDesktop:constant(isDesktop)}}(os,browser,userAgent,mediaMatch);return{browser:browser,os:os,deviceType:deviceType}},platform=Cell(PlatformDetection_detect(domGlobals.navigator.userAgent,function(query){return domGlobals.window.matchMedia(query).matches})),ELEMENT$1=ELEMENT,DOCUMENT$1=DOCUMENT,eq=function(e1,e2){return e1.dom()===e2.dom()},contains$2=detect$3().browser.isIE()?function(e1,e2){return Node_documentPositionContainedBy(e1.dom(),e2.dom())}:function(e1,e2){var d1=e1.dom(),d2=e2.dom();return d1!==d2&&d1.contains(d2)},is$1=is,append=(Immutable("element","offset"),function(parent,element){parent.dom().appendChild(element.dom())}),remove$2=function(element){var dom=element.dom();null!==dom.parentNode&&dom.parentNode.removeChild(dom)},grid=(Immutable("width","height"),Immutable("width","height"),Immutable("rows","columns")),address=Immutable("row","column"),detail=(Immutable("x","y"),Immutable("element","rowspan","colspan")),detailnew=Immutable("element","rowspan","colspan","isNew"),extended=Immutable("element","rowspan","colspan","row","column"),rowdata=Immutable("element","cells","section"),elementnew=Immutable("element","isNew"),rowdatanew=Immutable("element","cells","section","isNew"),rowcells=Immutable("cells","section"),rowdetails=Immutable("details","section"),bounds=Immutable("startRow","startCol","finishRow","finishCol"),descendants=function(scope,predicate){var result=[];return each(children(scope),function(x){predicate(x)&&(result=result.concat([x])),result=result.concat(descendants(x,predicate))}),result};function ClosestOrAncestor(is,ancestor,scope,a,isRoot){return is(scope,a)?Option.some(scope):isFunction(isRoot)&&isRoot(scope)?Option.none():ancestor(scope,a,isRoot)}function ancestor(scope,predicate,isRoot){for(var element=scope.dom(),stop=isFunction(isRoot)?isRoot:constant(!1);element.parentNode;){element=element.parentNode;var el=Element.fromDom(element);if(predicate(el))return Option.some(el);if(stop(el))break}return Option.none()}function ancestor$1(scope,selector,isRoot){return ancestor(scope,function(e){return is(e,selector)},isRoot)}function child$2(scope,selector){return function(scope,predicate){return find(scope.dom().childNodes,function(node){return predicate(Element.fromDom(node))}).map(Element.fromDom)}(scope,function(e){return is(e,selector)})}function descendant$1(scope,selector){return function(selector,scope){var base=void 0===scope?domGlobals.document:scope.dom();return bypassSelector(base)?Option.none():Option.from(base.querySelector(selector)).map(Element.fromDom)}(selector,scope)}function closest$1(scope,selector,isRoot){return ClosestOrAncestor(is,ancestor$1,scope,selector,isRoot)}function lookup(tags,element,isRoot){return void 0===isRoot&&(isRoot=never),isRoot(element)?Option.none():contains(tags,name(element))?Option.some(element):ancestor$1(element,tags.join(","),function(elm){return is(elm,"table")||isRoot(elm)})}function neighbours(selector,element){return parent(element).map(function(parent){return children$2(parent,selector)})}function attr(element,property){return parseInt(get$1(element,property),10)}function key(row,column){return row+","+column}function makeCell(list,seenSelected,rowIndex){var row=list[rowIndex].element(),td=Element.fromTag("td");append(td,Element.fromTag("br")),(seenSelected?append:prepend)(row,td)}var filterFirstLayer=function(scope,selector,predicate){return bind(children(scope),function(x){return is(x,selector)?predicate(x)?[x]:[]:filterFirstLayer(x,selector,predicate)})},LayerSelector={firstLayer:function(scope,selector){return filterFirstLayer(scope,selector,constant(!0))},filterFirstLayer:filterFirstLayer},neighbourCells=curry(neighbours,"th,td"),neighbourRows=curry(neighbours,"tr"),TableLookup={cell:function(element,isRoot){return lookup(["td","th"],element,isRoot)},firstCell:function(ancestor){return descendant$1(ancestor,"th,td")},cells:function(ancestor){return LayerSelector.firstLayer(ancestor,"th,td")},neighbourCells:neighbourCells,table:function(element,isRoot){return closest$1(element,"table",isRoot)},row:function(element,isRoot){return lookup(["tr"],element,isRoot)},rows:function(ancestor){return LayerSelector.firstLayer(ancestor,"tr")},notCell:function(element,isRoot){return lookup(["caption","tr","tbody","tfoot","thead"],element,isRoot)},neighbourRows:neighbourRows,attr:attr,grid:function(element,rowProp,colProp){var rowsCount=attr(element,rowProp),cols=attr(element,colProp);return grid(rowsCount,cols)}},DetailsList_fromTable=function(table){var rows=TableLookup.rows(table);return map(rows,function(row){var element=row,parentSection=parent(element).map(function(p){var parentName=name(p);return"tfoot"===parentName||"thead"===parentName||"tbody"===parentName?parentName:"tbody"}).getOr("tbody"),cells=map(TableLookup.cells(row),function(cell){var rowspan=has$1(cell,"rowspan")?parseInt(get$1(cell,"rowspan"),10):1,colspan=has$1(cell,"colspan")?parseInt(get$1(cell,"colspan"),10):1;return detail(cell,rowspan,colspan)});return rowdata(element,cells,parentSection)})},DetailsList_fromPastedRows=function(rows,example){return map(rows,function(row){var cells=map(TableLookup.cells(row),function(cell){var rowspan=has$1(cell,"rowspan")?parseInt(get$1(cell,"rowspan"),10):1,colspan=has$1(cell,"colspan")?parseInt(get$1(cell,"colspan"),10):1;return detail(cell,rowspan,colspan)});return rowdata(row,cells,example.section())})},filterItems=function(warehouse,predicate){var all=bind(warehouse.all(),function(r){return r.cells()});return filter(all,predicate)},Warehouse={generate:function(list){var access={},cells=[],maxRows=list.length,maxColumns=0;each(list,function(details,r){var currentRow=[];each(details.cells(),function(detail){for(var start=0;void 0!==access[key(r,start)];)start++;for(var current=extended(detail.element(),detail.rowspan(),detail.colspan(),r,start),i=0;i<detail.colspan();i++)for(var j=0;j<detail.rowspan();j++){var cc=start+i,newpos=key(r+j,cc);access[newpos]=current,maxColumns=Math.max(maxColumns,cc+1)}currentRow.push(current)}),cells.push(rowdata(details.element(),currentRow,details.section()))});var grid$1=grid(maxRows,maxColumns);return{grid:constant(grid$1),access:constant(access),all:constant(cells)}},getAt:function(warehouse,row,column){var raw=warehouse.access()[key(row,column)];return void 0!==raw?Option.some(raw):Option.none()},findItem:function(warehouse,item,comparator){var filtered=filterItems(warehouse,function(detail){return comparator(item,detail.element())});return 0<filtered.length?Option.some(filtered[0]):Option.none()},filterItems:filterItems,justCells:function(warehouse){var rows=map(warehouse.all(),function(w){return w.cells()});return flatten(rows)}},statsStruct=Immutable("minRow","minCol","maxRow","maxCol"),CopySelected_extract=function(table,selectedSelector){function isSelected(detail){return is(detail.element(),selectedSelector)}var list=DetailsList_fromTable(table),house=Warehouse.generate(list),stats=function(house,isSelected){var totalColumns=house.grid().columns(),minRow=house.grid().rows(),minCol=totalColumns,maxRow=0,maxCol=0;return each$1(house.access(),function(detail){if(isSelected(detail)){var startRow=detail.row(),endRow=startRow+detail.rowspan()-1,startCol=detail.column(),endCol=startCol+detail.colspan()-1;startRow<minRow?minRow=startRow:maxRow<endRow&&(maxRow=endRow),startCol<minCol?minCol=startCol:maxCol<endCol&&(maxCol=endCol)}}),statsStruct(minRow,minCol,maxRow,maxCol)}(house,isSelected),selector="th:not("+selectedSelector+"),td:not("+selectedSelector+")",unselectedCells=LayerSelector.filterFirstLayer(table,"th,td",function(cell){return is(cell,selector)});return each(unselectedCells,remove$2),function(list,house,stats,isSelected){for(var totalColumns=house.grid().columns(),totalRows=house.grid().rows(),i=0;i<totalRows;i++)for(var seenSelected=!1,j=0;j<totalColumns;j++){if(!(i<stats.minRow()||i>stats.maxRow()||j<stats.minCol()||j>stats.maxCol()))Warehouse.getAt(house,i,j).filter(isSelected).isNone()?makeCell(list,seenSelected,i):seenSelected=!0}}(list,house,stats,isSelected),function(table,stats){var emptyRows=filter(LayerSelector.firstLayer(table,"tr"),function(row){return 0===row.dom().childElementCount});each(emptyRows,remove$2),stats.minCol()!==stats.maxCol()&&stats.minRow()!==stats.maxRow()||each(LayerSelector.firstLayer(table,"th,td"),function(cell){remove(cell,"rowspan"),remove(cell,"colspan")}),remove(table,"width"),remove(table,"height"),remove$1(table,"width"),remove$1(table,"height")}(table,stats),table};function get$3(element){return api.get(element)}function getOption(element){return api.getOption(element)}function set$2(element,value){api.set(element,value)}function getEnd(element){return"img"===name(element)?1:getOption(element).fold(function(){return children(element).length},function(v){return v.length})}function isCursorPosition(elem){return function(el){return getOption(el).filter(function(text){return 0!==text.trim().length||-1<text.indexOf("")}).isSome()}(elem)||contains(elementsWithCursorPosition,name(elem))}function first(element){return function(scope,predicate){var descend=function(node){for(var i=0;i<node.childNodes.length;i++){var child_1=Element.fromDom(node.childNodes[i]);if(predicate(child_1))return Option.some(child_1);var res=descend(node.childNodes[i]);if(res.isSome())return res}return Option.none()};return descend(scope.dom())}(element,isCursorPosition)}function last$1(element){return descendantRtl(element,isCursorPosition)}function clone$1(original,isDeep){return Element.fromDom(original.dom().cloneNode(isDeep))}function shallow(original){return clone$1(original,!1)}function deep(original){return clone$1(original,!0)}function copy$1(original,tag){var nu=function(original,tag){var nu=Element.fromTag(tag),attributes=clone(original);return setAll(nu,attributes),nu}(original,tag),cloneChildren=children(deep(original));return append$1(nu,cloneChildren),nu}function createCell(){var td=Element.fromTag("td");return append(td,Element.fromTag("br")),td}function replace(cell,tag,attrs){var replica=copy$1(cell,tag);return each$1(attrs,function(v,k){null===v?remove(replica,k):set(replica,k,v)}),replica}function pasteReplace(cell){return cell}function newRow(doc){return function(){return Element.fromTag("tr",doc.dom())}}function isWithin(bounds,detail){return detail.column()>=bounds.startCol()&&detail.column()+detail.colspan()-1<=bounds.finishCol()&&detail.row()>=bounds.startRow()&&detail.row()+detail.rowspan()-1<=bounds.finishRow()}function getAnyBox(warehouse,startCell,finishCell){var startCoords=Warehouse.findItem(warehouse,startCell,eq),finishCoords=Warehouse.findItem(warehouse,finishCell,eq);return startCoords.bind(function(sc){return finishCoords.map(function(fc){return function(detailA,detailB){return bounds(Math.min(detailA.row(),detailB.row()),Math.min(detailA.column(),detailB.column()),Math.max(detailA.row()+detailA.rowspan()-1,detailB.row()+detailB.rowspan()-1),Math.max(detailA.column()+detailA.colspan()-1,detailB.column()+detailB.colspan()-1))}(sc,fc)})})}var api=function(is,name){var getOption=function(element){return is(element)?Option.from(element.dom().nodeValue):Option.none()};return{get:function(element){if(!is(element))throw new Error("Can only get "+name+" value of a "+name+" node");return getOption(element).getOr("")},getOption:getOption,set:function(element,value){if(!is(element))throw new Error("Can only set raw "+name+" value of a "+name+" node");element.dom().nodeValue=value}}}(isText,"text"),elementsWithCursorPosition=["img","br"],descendantRtl=function(scope,predicate){var descend=function(element){for(var children$1=children(element),i=children$1.length-1;0<=i;i--){var child=children$1[i];if(predicate(child))return Option.some(child);var res=descend(child);if(res.isSome())return res}return Option.none()};return descend(scope)},TableFill={cellOperations:function(mutate,doc,formatsToClone){return{row:newRow(doc),cell:function(prev){var docu=owner(prev.element()),td=Element.fromTag(name(prev.element()),docu.dom()),formats=formatsToClone.getOr(["strong","em","b","i","span","font","h1","h2","h3","h4","h5","h6","p","div"]),lastNode=0<formats.length?function(oldCell,newCell,formats){return first(oldCell).map(function(firstText){var formatSelector=formats.join(","),parents=ancestors$1(firstText,formatSelector,function(element){return eq(element,oldCell)});return foldr(parents,function(last,parent){var clonedFormat=shallow(parent);return remove(clonedFormat,"contenteditable"),append(last,clonedFormat),clonedFormat},newCell)}).getOr(newCell)}(prev.element(),td,formats):td;return append(lastNode,Element.fromTag("br")),function(source,target){var sourceDom=source.dom(),targetDom=target.dom();isSupported(sourceDom)&&isSupported(targetDom)&&(targetDom.style.cssText=sourceDom.style.cssText)}(prev.element(),td),remove$1(td,"height"),1!==prev.colspan()&&remove$1(prev.element(),"width"),mutate(prev.element(),td),td},replace:replace,gap:createCell}},paste:function(doc){return{row:newRow(doc),cell:createCell,replace:pasteReplace,gap:createCell}}},CellBounds_inSelection=function(bounds,detail){var leftEdge=detail.column(),rightEdge=detail.column()+detail.colspan()-1,topEdge=detail.row(),bottomEdge=detail.row()+detail.rowspan()-1;return leftEdge<=bounds.finishCol()&&rightEdge>=bounds.startCol()&&topEdge<=bounds.finishRow()&&bottomEdge>=bounds.startRow()},CellBounds_isRectangular=function(warehouse,bounds){for(var isRect=!0,detailIsWithin=curry(isWithin,bounds),i=bounds.startRow();i<=bounds.finishRow();i++)for(var j=bounds.startCol();j<=bounds.finishCol();j++)isRect=isRect&&Warehouse.getAt(warehouse,i,j).exists(detailIsWithin);return isRect?Option.some(bounds):Option.none()},CellGroup_getAnyBox=getAnyBox,CellGroup_getBox=function(warehouse,startCell,finishCell){return getAnyBox(warehouse,startCell,finishCell).bind(function(bounds){return CellBounds_isRectangular(warehouse,bounds)})},CellFinder_moveBy=function(warehouse,cell,row,column){return Warehouse.findItem(warehouse,cell,eq).bind(function(detail){var startRow=0<row?detail.row()+detail.rowspan()-1:detail.row(),startCol=0<column?detail.column()+detail.colspan()-1:detail.column();return Warehouse.getAt(warehouse,startRow+row,startCol+column).map(function(d){return d.element()})})},CellFinder_intercepts=function(warehouse,start,finish){return CellGroup_getAnyBox(warehouse,start,finish).map(function(bounds){var inside=Warehouse.filterItems(warehouse,curry(CellBounds_inSelection,bounds));return map(inside,function(detail){return detail.element()})})},CellFinder_parentCell=function(warehouse,innerCell){return Warehouse.findItem(warehouse,innerCell,function(c1,c2){return contains$2(c2,c1)}).map(function(detail){return detail.element()})},getWarehouse=function(table){var list=DetailsList_fromTable(table);return Warehouse.generate(list)},TablePositions_moveBy=function(cell,deltaRow,deltaColumn){return TableLookup.table(cell).bind(function(table){var warehouse=getWarehouse(table);return CellFinder_moveBy(warehouse,cell,deltaRow,deltaColumn)})},TablePositions_intercepts=function(table,first,last){var warehouse=getWarehouse(table);return CellFinder_intercepts(warehouse,first,last)},TablePositions_nestedIntercepts=function(table,first,firstTable,last,lastTable){var warehouse=getWarehouse(table),optStartCell=eq(table,firstTable)?Option.some(first):CellFinder_parentCell(warehouse,first),optLastCell=eq(table,lastTable)?Option.some(last):CellFinder_parentCell(warehouse,last);return optStartCell.bind(function(startCell){return optLastCell.bind(function(lastCell){return CellFinder_intercepts(warehouse,startCell,lastCell)})})},TablePositions_getBox=function(table,first,last){var warehouse=getWarehouse(table);return CellGroup_getBox(warehouse,first,last)},TagBoundaries=["body","p","div","article","aside","figcaption","figure","footer","header","nav","section","ol","ul","li","table","thead","tbody","tfoot","caption","tr","td","th","h1","h2","h3","h4","h5","h6","blockquote","pre","address"];function DomUniverse(){return{up:constant({selector:ancestor$1,closest:closest$1,predicate:ancestor,all:parents}),down:constant({selector:descendants$1,predicate:descendants}),styles:constant({get:get$2,getRaw:getRaw,set:set$1,remove:remove$1}),attrs:constant({get:get$1,set:set,remove:remove,copyTo:function(source,destination){var as=clone(source);setAll(destination,as)}}),insert:constant({before:before,after:after,afterAll:after$1,append:append,appendAll:append$1,prepend:prepend,wrap:wrap}),remove:constant({unwrap:unwrap,remove:remove$2}),create:constant({nu:Element.fromTag,clone:function(element){return Element.fromDom(element.dom().cloneNode(!1))},text:Element.fromText}),query:constant({comparePosition:function(element,other){return element.dom().compareDocumentPosition(other.dom())},prevSibling:prevSibling,nextSibling:nextSibling}),property:constant({children:children,name:name,parent:parent,document:function(element){return element.dom().ownerDocument},isText:isText,isComment:isComment,isElement:isElement,getText:get$3,setText:set$2,isBoundary:function(element){return!!isElement(element)&&("body"===name(element)||contains(TagBoundaries,name(element)))},isEmptyTag:function(element){return!!isElement(element)&&contains(["br","img","hr","input"],name(element))},isNonEditable:function(element){return isElement(element)&&"false"===get$1(element,"contenteditable")}}),eq:eq,is:is$1}}function bisect(universe,parent,child){var children=universe.property().children(parent);return findIndex(children,curry(universe.eq,child)).map(function(ind){return{before:constant(children.slice(0,ind)),after:constant(children.slice(ind+1))}})}function eq$1(universe,item){return curry(universe.eq,item)}function unsafeSubset(universe,common,ps1,ps2){var children=universe.property().children(common);if(universe.eq(common,ps1[0]))return Option.some([ps1[0]]);if(universe.eq(common,ps2[0]))return Option.some([ps2[0]]);function finder(ps){var topDown=reverse(ps),index=findIndex(topDown,eq$1(universe,common)).getOr(-1),item=index<topDown.length-1?topDown[index+1]:topDown[index];return findIndex(children,eq$1(universe,item))}var startIndex=finder(ps1),endIndex=finder(ps2);return startIndex.bind(function(sIndex){return endIndex.map(function(eIndex){var first=Math.min(sIndex,eIndex),last=Math.max(sIndex,eIndex);return children.slice(first,last+1)})})}function ancestors$2(universe,start,end,isRoot){function prune(path){return findIndex(path,isRoot).fold(function(){return path},function(ind){return path.slice(0,ind+1)})}void 0===isRoot&&(isRoot=never);var ps1=[start].concat(universe.up().all(start)),ps2=[end].concat(universe.up().all(end)),pruned1=prune(ps1),pruned2=prune(ps2),shared=find(pruned1,function(x){return exists(pruned2,eq$1(universe,x))});return{firstpath:constant(pruned1),secondpath:constant(pruned2),shared:constant(shared)}}function lookupTable(container){return ancestor$1(container,"table")}function identify(start,finish,isRoot){function getIsRoot(rootTable){return function(element){return void 0!==isRoot&&isRoot(element)||eq(element,rootTable)}}return eq(start,finish)?Option.some(Identified.create({boxes:Option.some([start]),start:start,finish:finish})):lookupTable(start).bind(function(startTable){return lookupTable(finish).bind(function(finishTable){if(eq(startTable,finishTable))return Option.some(Identified.create({boxes:TablePositions_intercepts(startTable,start,finish),start:start,finish:finish}));if(contains$2(startTable,finishTable)){var finishCell=0<(ancestorCells=ancestors$1(finish,"td,th",getIsRoot(startTable))).length?ancestorCells[ancestorCells.length-1]:finish;return Option.some(Identified.create({boxes:TablePositions_nestedIntercepts(startTable,start,startTable,finish,finishTable),start:start,finish:finishCell}))}if(contains$2(finishTable,startTable)){var ancestorCells,startCell=0<(ancestorCells=ancestors$1(start,"td,th",getIsRoot(finishTable))).length?ancestorCells[ancestorCells.length-1]:start;return Option.some(Identified.create({boxes:TablePositions_nestedIntercepts(finishTable,start,startTable,finish,finishTable),start:start,finish:startCell}))}return DomParent.ancestors(start,finish).shared().bind(function(lca){return closest$1(lca,"table",isRoot).bind(function(lcaTable){var finishAncestorCells=ancestors$1(finish,"td,th",getIsRoot(lcaTable)),finishCell=0<finishAncestorCells.length?finishAncestorCells[finishAncestorCells.length-1]:finish,startAncestorCells=ancestors$1(start,"td,th",getIsRoot(lcaTable)),startCell=0<startAncestorCells.length?startAncestorCells[startAncestorCells.length-1]:start;return Option.some(Identified.create({boxes:TablePositions_nestedIntercepts(lcaTable,start,startTable,finish,finishTable),start:startCell,finish:finishCell}))})})})})}function selection(cell,selections){return SelectionTypes.cata(selections.get(),constant([]),identity,constant([cell]))}function noMenu(cell){return{element:constant(cell),mergable:Option.none,unmergable:Option.none,selection:constant([cell])}}var leftRight=Immutable("left","right"),brokenPath=Immutable("first","second","splits"),unsafeOne=function(universe,look,head,tail){var start=look(universe,head);return foldr(tail,function(b,a){var current=look(universe,a);return commonElement(universe,b,current)},start)},commonElement=function(universe,start,end){return start.bind(function(s){return end.filter(curry(universe.eq,s))})},Parent={sharedOne:function(universe,look,elements){return 0<elements.length?function(universe,look,elements,f){return f(universe,look,elements[0],elements.slice(1))}(universe,look,elements,unsafeOne):Option.none()},subset:function(universe,start,end){var ancs=ancestors$2(universe,start,end);return ancs.shared().bind(function(shared){return unsafeSubset(universe,shared,ancs.firstpath(),ancs.secondpath())})},ancestors:ancestors$2,breakToLeft:function(universe,parent,child){return bisect(universe,parent,child).map(function(parts){var prior=universe.create().clone(parent);return universe.insert().appendAll(prior,parts.before().concat([child])),universe.insert().appendAll(parent,parts.after()),universe.insert().before(parent,prior),leftRight(prior,parent)})},breakToRight:function(universe,parent,child){return bisect(universe,parent,child).map(function(parts){var second=universe.create().clone(parent);return universe.insert().appendAll(second,parts.after()),universe.insert().after(parent,second),leftRight(parent,second)})},breakPath:function(universe,item,isTop,breaker){var next=function(child,group,splits){var fallback=brokenPath(child,Option.none(),splits);return isTop(child)?brokenPath(child,group,splits):universe.property().parent(child).bind(function(parent){return breaker(universe,parent,child).map(function(breakage){var extra=[{first:breakage.left,second:breakage.right}],nextChild=isTop(parent)?parent:breakage.left();return next(nextChild,Option.some(breakage.right()),splits.concat(extra))})}).getOr(fallback)};return next(item,Option.none(),[])}},universe=DomUniverse(),DomParent={sharedOne:function(look,elements){return Parent.sharedOne(universe,function(_universe,element){return look(element)},elements)},subset:function(start,finish){return Parent.subset(universe,start,finish)},ancestors:function(start,finish,isRoot){return Parent.ancestors(universe,start,finish,isRoot)},breakToLeft:function(parent,child){return Parent.breakToLeft(universe,parent,child)},breakToRight:function(parent,child){return Parent.breakToRight(universe,parent,child)},breakPath:function(child,isTop,breaker){return Parent.breakPath(universe,child,isTop,function(u,p,c){return breaker(p,c)})}},Identified={create:MixedBag(["boxes","start","finish"],[])},CellSelection_identify=identify,CellSelection_retrieve=function(container,selector){var sels=descendants$1(container,selector);return 0<sels.length?Option.some(sels):Option.none()},CellSelection_shiftSelection=function(boxes,deltaRow,deltaColumn,firstSelectedSelector,lastSelectedSelector){return function(boxes,lastSelectedSelector){return find(boxes,function(box){return is(box,lastSelectedSelector)})}(boxes,lastSelectedSelector).bind(function(last){return TablePositions_moveBy(last,deltaRow,deltaColumn).bind(function(finish){return function(finish,firstSelectedSelector){return ancestor$1(finish,"table").bind(function(table){return descendant$1(table,firstSelectedSelector).bind(function(start){return identify(start,finish).bind(function(identified){return identified.boxes().map(function(boxes){return{boxes:constant(boxes),start:constant(identified.start()),finish:constant(identified.finish())}})})})})}(finish,firstSelectedSelector)})})},CellSelection_getEdges=function(container,firstSelectedSelector,lastSelectedSelector){return descendant$1(container,firstSelectedSelector).bind(function(first){return descendant$1(container,lastSelectedSelector).bind(function(last){return DomParent.sharedOne(lookupTable,[first,last]).map(function(tbl){return{first:constant(first),last:constant(last),table:constant(tbl)}})})})},TableSelection_retrieve=function(container,selector){return CellSelection_retrieve(container,selector)},TableSelection_retrieveBox=function(container,firstSelectedSelector,lastSelectedSelector){return CellSelection_getEdges(container,firstSelectedSelector,lastSelectedSelector).bind(function(edges){function isRoot(ancestor){return eq(container,ancestor)}var firstAncestor=ancestor$1(edges.first(),"thead,tfoot,tbody,table",isRoot),lastAncestor=ancestor$1(edges.last(),"thead,tfoot,tbody,table",isRoot);return firstAncestor.bind(function(fA){return lastAncestor.bind(function(lA){return eq(fA,lA)?TablePositions_getBox(edges.table(),edges.first(),edges.last()):Option.none()})})})},selected="data-mce-selected",Ephemera={selected:constant(selected),selectedSelector:constant("td[data-mce-selected],th[data-mce-selected]"),attributeSelector:constant("[data-mce-selected]"),firstSelected:constant("data-mce-first-selected"),firstSelectedSelector:constant("td[data-mce-first-selected],th[data-mce-first-selected]"),lastSelected:constant("data-mce-last-selected"),lastSelectedSelector:constant("td[data-mce-last-selected],th[data-mce-last-selected]")},Adt_generate=function(cases){if(!isArray(cases))throw new Error("cases must be an array");if(0===cases.length)throw new Error("there must be at least one case");var constructors=[],adt={};return each(cases,function(acase,count){var keys$1=keys(acase);if(1!==keys$1.length)throw new Error("one and only one name per case");var key=keys$1[0],value=acase[key];if(void 0!==adt[key])throw new Error("duplicate key detected:"+key);if("cata"===key)throw new Error("cannot have a case named cata (sorry)");if(!isArray(value))throw new Error("case arguments must be an array");constructors.push(key),adt[key]=function(){var argLength=arguments.length;if(argLength!==value.length)throw new Error("Wrong number of arguments to case "+key+". Expected "+value.length+" ("+value+"), got "+argLength);for(var args=new Array(argLength),i=0;i<args.length;i++)args[i]=arguments[i];return{fold:function(){if(arguments.length!==cases.length)throw new Error("Wrong number of arguments to fold. Expected "+cases.length+", got "+arguments.length);return arguments[count].apply(null,args)},match:function(branches){var branchKeys=keys(branches);if(constructors.length!==branchKeys.length)throw new Error("Wrong number of arguments to match. Expected: "+constructors.join(",")+"\nActual: "+branchKeys.join(","));if(!forall(constructors,function(reqKey){return contains(branchKeys,reqKey)}))throw new Error("Not all branches were specified when using match. Specified: "+branchKeys.join(", ")+"\nRequired: "+constructors.join(", "));return branches[key].apply(null,args)},log:function(label){domGlobals.console.log(label,{constructors:constructors,constructor:key,params:args})}}}}),adt},type$1=Adt_generate([{none:[]},{multiple:["elements"]},{single:["selection"]}]),SelectionTypes={cata:function(subject,onNone,onMultiple,onSingle){return subject.fold(onNone,onMultiple,onSingle)},none:type$1.none,multiple:type$1.multiple,single:type$1.single},CellOperations_mergable=function(table,selections){return SelectionTypes.cata(selections.get(),Option.none,function(cells,_env){return 0===cells.length?Option.none():TableSelection_retrieveBox(table,Ephemera.firstSelectedSelector(),Ephemera.lastSelectedSelector()).bind(function(bounds){return 1<cells.length?Option.some({bounds:constant(bounds),cells:constant(cells)}):Option.none()})},Option.none)},CellOperations_unmergable=function(cell,selections){var candidates=selection(cell,selections);return 0<candidates.length&&forall(candidates,function(elem){return has$1(elem,"rowspan")&&1<parseInt(get$1(elem,"rowspan"),10)||has$1(elem,"colspan")&&1<parseInt(get$1(elem,"colspan"),10)})?Option.some(candidates):Option.none()},CellOperations_selection=selection,paste$1=Immutable("element","clipboard","generators"),TableTargets={noMenu:noMenu,forMenu:function(selections,table,cell){return{element:constant(cell),mergable:constant(CellOperations_mergable(table,selections)),unmergable:constant(CellOperations_unmergable(cell,selections)),selection:constant(CellOperations_selection(cell,selections))}},notCell:function(element){return noMenu(element)},paste:paste$1,pasteRows:function(selections,table,cell,clipboard,generators){return{element:constant(cell),mergable:Option.none,unmergable:Option.none,selection:constant(CellOperations_selection(cell,selections)),clipboard:constant(clipboard),generators:constant(generators)}}},Clipboard={registerEvents:function(editor,selections,actions,cellSelection){editor.on("BeforeGetContent",function(e){!0===e.selection&&SelectionTypes.cata(selections.get(),noop,function(cells){e.preventDefault(),function(cells){return TableLookup.table(cells[0]).map(deep).map(function(replica){return[CopySelected_extract(replica,Ephemera.attributeSelector())]})}(cells).each(function(elements){e.content="text"===e.format?function(elements){return map(elements,function(element){return element.dom().innerText}).join("")}(elements):function(editor,elements){return map(elements,function(elm){return editor.selection.serializer.serialize(elm.dom(),{})}).join("")}(editor,elements)})},noop)}),editor.on("BeforeSetContent",function(e){!0===e.selection&&!0===e.paste&&Option.from(editor.dom.getParent(editor.selection.getStart(),"th,td")).each(function(domCell){var cell=Element.fromDom(domCell);TableLookup.table(cell).each(function(table){var elements=filter(function(html,scope){var div=(scope||domGlobals.document).createElement("div");return div.innerHTML=html,children(Element.fromDom(div))}(e.content),function(content){return"meta"!==name(content)});if(1===elements.length&&"table"===name(elements[0])){e.preventDefault();var doc=Element.fromDom(editor.getDoc()),generators=TableFill.paste(doc),targets=TableTargets.paste(cell,elements[0],generators);actions.pasteCells(table,targets).each(function(rng){editor.selection.setRng(rng),editor.focus(),cellSelection.clear(table)})}})})})}};function Dimension(name,getOffset){function get(element){var r=getOffset(element);if(r<=0||null===r){var css=get$2(element,name);return parseFloat(css)||0}return r}function aggregate(element,properties){return foldl(properties,function(acc,property){var val=get$2(element,property),value=void 0===val?0:parseInt(val,10);return isNaN(value)?acc:acc+value},0)}return{set:function(element,h){if(!isNumber(h)&&!h.match(/^[0-9]+$/))throw new Error(name+".set accepts only positive integer values. Value was "+h);var dom=element.dom();isSupported(dom)&&(dom.style[name]=h+"px")},get:get,getOuter:get,aggregate:aggregate,max:function(element,value,properties){var cumulativeInclusions=aggregate(element,properties);return cumulativeInclusions<value?value-cumulativeInclusions:0}}}function get$4(element){return api$1.get(element)}function getOuter(element){return api$1.getOuter(element)}function get$5(element){return api$2.get(element)}function getOuter$1(element){return api$2.getOuter(element)}function getProp(elm,name,fallback){return function(px,fallback){var num=parseFloat(px);return isNaN(num)?fallback:num}(get$2(elm,name),fallback)}function setHeight(cell,amount){set$1(cell,"height",amount+"px")}function normalizePixelSize(value,cell,getter,setter){var number=parseInt(value,10);return function(str,suffix){return checkRange(str,suffix,str.length-suffix.length)}(value,"%")&&"table"!==name(cell)?function(cell,number,getter,setter){var newSize=TableLookup.table(cell).map(function(table){var total=getter(table);return Math.floor(number/100*total)}).getOr(number);return setter(cell,newSize),newSize}(cell,number,getter,setter):number}function getTotalHeight(cell){var value=function(cell){return getRaw(cell,"height").getOrThunk(function(){return RuntimeSize_getHeight(cell)+"px"})}(cell);return value?normalizePixelSize(value,cell,get$4,setHeight):get$4(cell)}function getRawWidth(element){return getRaw(element,"width").fold(function(){return Option.from(get$1(element,"width"))},function(width){return Option.some(width)})}function normalizePercentageWidth(cellWidth,tableSize){return cellWidth/tableSize.pixelWidth()*100}function firstDefinedOrZero(a,b){return void 0!==a?a:void 0!==b?b:0}function absolute(element){var doc=element.dom().ownerDocument,body=doc.body,win=doc.defaultView,html=doc.documentElement;if(body===element.dom())return Position(body.offsetLeft,body.offsetTop);var scrollTop=firstDefinedOrZero(win.pageYOffset,html.scrollTop),scrollLeft=firstDefinedOrZero(win.pageXOffset,html.scrollLeft),clientTop=firstDefinedOrZero(html.clientTop,body.clientTop),clientLeft=firstDefinedOrZero(html.clientLeft,body.clientLeft);return viewport(element).translate(scrollLeft-clientLeft,scrollTop-clientTop)}function rtlEdge(cell){return absolute(cell).left()+getOuter$1(cell)}function ltrEdge(cell){return absolute(cell).left()}function getLeftEdge(index,cell){return colInfo(index,ltrEdge(cell))}function getRightEdge(index,cell){return colInfo(index,rtlEdge(cell))}function getTop(cell){return absolute(cell).top()}function getTopEdge(index,cell){return rowInfo(index,getTop(cell))}function getBottomEdge(index,cell){return rowInfo(index,getTop(cell)+getOuter(cell))}function findPositions(getInnerEdge,getOuterEdge,array){if(0===array.length)return[];var lines=map(array.slice(1),function(cellOption,index){return cellOption.map(function(cell){return getInnerEdge(index,cell)})}),lastLine=array[array.length-1].map(function(cell){return getOuterEdge(array.length-1,cell)});return lines.concat([lastLine])}var api$1=Dimension("height",function(element){var dom=element.dom();return inBody(element)?dom.getBoundingClientRect().height:dom.offsetHeight}),api$2=Dimension("width",function(element){return element.dom().offsetWidth}),platform$1=detect$3(),RuntimeSize_getHeight=function(cell){return platform$1.browser.isIE()||platform$1.browser.isEdge()?function(cell){var paddingTop=getProp(cell,"padding-top",0),paddingBottom=getProp(cell,"padding-bottom",0),borderTop=getProp(cell,"border-top-width",0),borderBottom=getProp(cell,"border-bottom-width",0),height=cell.dom().getBoundingClientRect().height;return"border-box"===get$2(cell,"box-sizing")?height:height-paddingTop-paddingBottom-(borderTop+borderBottom)}(cell):getProp(cell,"height",get$4(cell))},genericSizeRegex=/(\d+(\.\d+)?)(\w|%)*/,percentageBasedSizeRegex=/(\d+(\.\d+)?)%/,pixelBasedSizeRegex=/(\d+(\.\d+)?)px|em/,getSpan=function(cell,type){return has$1(cell,type)?parseInt(get$1(cell,type),10):1},Sizes={percentageBasedSizeRegex:constant(percentageBasedSizeRegex),pixelBasedSizeRegex:constant(pixelBasedSizeRegex),setPixelWidth:function(cell,amount){set$1(cell,"width",amount+"px")},setPercentageWidth:function(cell,amount){set$1(cell,"width",amount+"%")},setHeight:setHeight,getPixelWidth:function(cell,tableSize){return getRawWidth(cell).fold(function(){return get$5(cell)},function(w){return function(element,width,tableSize){var pixelMatch=pixelBasedSizeRegex.exec(width);if(null!==pixelMatch)return parseInt(pixelMatch[1],10);var percentMatch=percentageBasedSizeRegex.exec(width);return null===percentMatch?get$5(element):function(cellWidth,tableSize){return cellWidth/100*tableSize.pixelWidth()}(parseFloat(percentMatch[1]),tableSize)}(cell,w,tableSize)})},getPercentageWidth:function(cell,tableSize){return getRawWidth(cell).fold(function(){var intWidth=get$5(cell);return normalizePercentageWidth(intWidth,tableSize)},function(w){return function(element,width,tableSize){var percentMatch=percentageBasedSizeRegex.exec(width);if(null!==percentMatch)return parseFloat(percentMatch[1]);var intWidth=get$5(element);return normalizePercentageWidth(intWidth,tableSize)}(cell,w,tableSize)})},getGenericWidth:function(cell){return getRawWidth(cell).bind(function(w){var match=genericSizeRegex.exec(w);return null!==match?Option.some({width:constant(parseFloat(match[1])),unit:constant(match[3])}):Option.none()})},setGenericWidth:function(cell,amount,unit){set$1(cell,"width",amount+unit)},getHeight:function(cell){return function(cell,type,f){return f(cell)/getSpan(cell,type)}(cell,"rowspan",getTotalHeight)},getRawWidth:getRawWidth},CellMutations_halve=function(main,other){Sizes.getGenericWidth(main).each(function(w){var newWidth=w.width()/2;Sizes.setGenericWidth(main,newWidth,w.unit()),Sizes.setGenericWidth(other,newWidth,w.unit())})},r=function(left,top){return{left:constant(left),top:constant(top),translate:function(x,y){return r(left+x,top+y)}}},Position=r,viewport=function(element){var dom=element.dom(),body=dom.ownerDocument.body;return body===dom?Position(body.offsetLeft,body.offsetTop):inBody(element)?function(dom){var box=dom.getBoundingClientRect();return Position(box.left,box.top)}(dom):Position(0,0)},rowInfo=Immutable("row","y"),colInfo=Immutable("col","x"),BarPositions={height:{delta:identity,positions:function(optElements){return findPositions(getTopEdge,getBottomEdge,optElements)},edge:getTop},rtl:{delta:function(step){return-step},edge:rtlEdge,positions:function(optElements){return findPositions(getRightEdge,getLeftEdge,optElements)}},ltr:{delta:identity,edge:ltrEdge,positions:function(optElements){return findPositions(getLeftEdge,getRightEdge,optElements)}}},ResizeDirection={ltr:BarPositions.ltr,rtl:BarPositions.rtl};function TableDirection(directionAt){function auto(table){return directionAt(table).isRtl()?ResizeDirection.rtl:ResizeDirection.ltr}return{delta:function(amount,table){return auto(table).delta(amount,table)},edge:function(cell){return auto(cell).edge(cell)},positions:function(cols,table){return auto(table).positions(cols,table)}}}function cat(arr){for(var r=[],push=function(x){r.push(x)},i=0;i<arr.length;i++)arr[i].each(push);return r}function setIfNot(element,property,value,ignore){value===ignore?remove(element,property):set(element,property,value)}function read(element,attr){var value=get$1(element,attr);return void 0===value||""===value?[]:value.split(" ")}function supports(element){return void 0!==element.dom().classList}function add$1(element,clazz){return function(element,attr,id){var nu=read(element,attr).concat([id]);return set(element,attr,nu.join(" ")),!0}(element,"class",clazz)}function remove$4(element,clazz){return function(element,attr,id){var nu=filter(read(element,attr),function(v){return v!==id});return 0<nu.length?set(element,attr,nu.join(" ")):remove(element,attr),!1}(element,"class",clazz)}function add$2(element,clazz){supports(element)?element.dom().classList.add(clazz):add$1(element,clazz)}function cleanClass(element){0===(supports(element)?element.dom().classList:function(element){return read(element,"class")}(element)).length&&remove(element,"class")}function has$2(element,clazz){return supports(element)&&element.dom().classList.contains(clazz)}function range(start,end){for(var r=[],i=start;i<end;i++)r.push(i);return r}function deduce(xs,index){if(index<0||index>=xs.length-1)return Option.none();var current=xs[index].fold(function(){var rest=reverse(xs.slice(0,index));return findMap(rest,function(a,i){return a.map(function(aa){return{value:aa,delta:i+1}})})},function(c){return Option.some({value:c,delta:0})}),next=xs[index+1].fold(function(){var rest=xs.slice(index+1);return findMap(rest,function(a,i){return a.map(function(aa){return{value:aa,delta:i+1}})})},function(n){return Option.some({value:n,delta:1})});return current.bind(function(c){return next.map(function(n){var extras=n.delta+c.delta;return Math.abs(n.value-c.value)/extras})})}function css(namespace){var dashNamespace=namespace.replace(/\./g,"-");return{resolve:function(str){return dashNamespace+"-"+str}}}function destroy(wire){var previous=descendants$1(wire.parent(),"."+resizeBar);each(previous,remove$2)}function drawBar(wire,positions,create){var origin=wire.origin();each(positions,function(cpOption,i){cpOption.each(function(cp){var bar=create(origin,cp);add$2(bar,resizeBar),append(wire.parent(),bar)})})}function refreshGrid(wire,table,rows,cols,hdirection,vdirection){var position=absolute(table);!function(wire,rowPositions,position,tableWidth){drawBar(wire,rowPositions,function(origin,cp){var rowBar=Bar_row(cp.row(),position.left()-origin.left(),cp.y()-origin.top(),tableWidth,7);return add$2(rowBar,resizeRowBar),rowBar})}(wire,0<rows.length?hdirection.positions(rows,table):[],position,getOuter$1(table)),function(wire,colPositions,position,tableHeight){drawBar(wire,colPositions,function(origin,cp){var colBar=Bar_col(cp.col(),cp.x()-origin.left(),position.top()-origin.top(),7,tableHeight);return add$2(colBar,resizeColBar),colBar})}(wire,0<cols.length?vdirection.positions(cols,table):[],position,getOuter(table))}function each$2(wire,f){var bars=descendants$1(wire.parent(),"."+resizeBar);each(bars,f)}function getCell(gridRow,index){return gridRow.cells()[index]}function findDiff(xs,comp){if(0===xs.length)return 0;var first=xs[0];return findIndex(xs,function(x){return!comp(first.element(),x.element())}).fold(function(){return xs.length},function(ind){return ind})}function deriveRows(rendered,generators){return map(rendered,function(details){var row=function(details){return findMap(details,function(detail){return parent(detail.element()).map(function(row){var isNew=parent(row).isNone();return elementnew(row,isNew)})}).getOrThunk(function(){return elementnew(generators.row(),!0)})}(details.details());return rowdatanew(row.element(),details.details(),details.section(),row.isNew())})}function toDetailList(grid,generators){var rendered=Transitions_toDetails(grid,eq);return deriveRows(rendered,generators)}function findInWarehouse(warehouse,element){var all=flatten(map(warehouse.all(),function(r){return r.cells()}));return find(all,function(e){return eq(element,e.element())})}function run(operation,extract,adjustment,postAction,genWrappers){return function(wire,table,target,generators,direction){var input=DetailsList_fromTable(table),warehouse=Warehouse.generate(input);return extract(warehouse,target).map(function(info){var model=function(warehouse,generators){return Transitions_toGrid(warehouse,generators,!1)}(warehouse,generators),result=operation(model,info,eq,genWrappers(generators)),grid=toDetailList(result.grid(),generators);return{grid:constant(grid),cursor:result.cursor}}).fold(function(){return Option.none()},function(out){var newElements=Redraw_render(table,out.grid());return adjustment(table,out.grid(),direction),postAction(table),Bars_refresh(wire,table,BarPositions.height,direction),Option.some({cursor:out.cursor,newRows:newElements.newRows,newCells:newElements.newCells})})}}function onCell(warehouse,target){return TableLookup.cell(target.element()).bind(function(cell){return findInWarehouse(warehouse,cell)})}function onPasteRows(warehouse,target){var details=map(target.selection(),function(cell){return TableLookup.cell(cell).bind(function(lc){return findInWarehouse(warehouse,lc)})}),cells=cat(details);return 0<cells.length?Option.some({cells:cells,generators:target.generators,clipboard:target.clipboard}):Option.none()}function onCells(warehouse,target){var details=map(target.selection(),function(cell){return TableLookup.cell(cell).bind(function(lc){return findInWarehouse(warehouse,lc)})}),cells=cat(details);return 0<cells.length?Option.some(cells):Option.none()}function fill(cells,generator){return map(cells,function(){return elementnew(generator.cell(),!0)})}function rowFill(grid,amount,generator){return grid.concat(function(repititions,f){for(var r=[],i=0;i<repititions;i++)r.push(f(i));return r}(amount,function(_row){return GridRow.setCells(grid[grid.length-1],fill(grid[grid.length-1].cells(),generator))}))}function colFill(grid,amount,generator){return map(grid,function(row){return GridRow.setCells(row,row.cells().concat(fill(range(0,amount),generator)))})}function isSpanning(grid,row,col,comparator){var matching=curry(comparator,GridRow.getCell(grid[row],col).element()),currentRow=grid[row];return 1<grid.length&&1<GridRow.cellLength(currentRow)&&(0<col&&matching(GridRow.getCellElement(currentRow,col-1))||col<currentRow.cells().length-1&&matching(GridRow.getCellElement(currentRow,col+1))||0<row&&matching(GridRow.getCellElement(grid[row-1],col))||row<grid.length-1&&matching(GridRow.getCellElement(grid[row+1],col)))}function replaceIn(grid,targets,comparator,substitution){return map(grid,function(row){return GridRow.mapCells(row,function(cell){return function(cell){return exists(targets,function(target){return comparator(cell.element(),target.element())})}(cell)?elementnew(substitution(cell.element(),comparator),!0):cell})})}function notStartRow(grid,rowIndex,colIndex,comparator){return void 0!==GridRow.getCellElement(grid[rowIndex],colIndex)&&0<rowIndex&&comparator(GridRow.getCellElement(grid[rowIndex-1],colIndex),GridRow.getCellElement(grid[rowIndex],colIndex))}function notStartColumn(row,index,comparator){return 0<index&&comparator(GridRow.getCellElement(row,index-1),GridRow.getCellElement(row,index))}function getSpan$1(cell,type){return has$1(cell,type)&&1<parseInt(get$1(cell,type),10)}function getRaw$1(cell,property,getter){return getRaw(cell,property).fold(function(){return getter(cell)+"px"},function(raw){return raw})}function getRawW(cell,tableSize){return getRaw$1(cell,"width",function(e){return Sizes.getPixelWidth(e,tableSize)})}function getRawH(cell){return getRaw$1(cell,"height",Sizes.getHeight)}function getWidthFrom(warehouse,direction,getWidth,fallback,tableSize){var columns=Blocks_columns(warehouse),backups=map(columns,function(cellOption){return cellOption.map(direction.edge)});return map(columns,function(cellOption,c){return cellOption.filter(not(CellUtils.hasColspan)).fold(function(){var deduced=deduce(backups,c);return fallback(deduced)},function(cell){return getWidth(cell,tableSize)})})}function getDeduced(deduced){return deduced.map(function(d){return d+"px"}).getOr("")}function getHeightFrom(warehouse,direction,getHeight,fallback){var rows=Blocks_rows(warehouse),backups=map(rows,function(cellOption){return cellOption.map(direction.edge)});return map(rows,function(cellOption,c){return cellOption.filter(not(CellUtils.hasRowspan)).fold(function(){var deduced=deduce(backups,c);return fallback(deduced)},function(cell){return getHeight(cell)})})}function total(start,end,measures){for(var r=0,i=start;i<end;i++)r+=void 0!==measures[i]?measures[i]:0;return r}function pixelSize(width){var getCellDelta=identity;return{width:constant(width),pixelWidth:constant(width),getWidths:ColumnSizes.getPixelWidths,getCellDelta:getCellDelta,singleColumnWidth:function(w,delta){return[Math.max(CellUtils.minWidth(),w+delta)-w]},minCellWidth:CellUtils.minWidth,setElementWidth:Sizes.setPixelWidth,setTableWidth:function(table,newWidths,_delta){var total=foldr(newWidths,function(b,a){return b+a},0);Sizes.setPixelWidth(table,total)}}}function chooseSize(element,width){var percentMatch=Sizes.percentageBasedSizeRegex().exec(width);if(null!==percentMatch)return function(width,element){var floatWidth=parseFloat(width),pixelWidth=get$5(element);return{width:constant(floatWidth),pixelWidth:constant(pixelWidth),getWidths:ColumnSizes.getPercentageWidths,getCellDelta:function(delta){return delta/pixelWidth*100},singleColumnWidth:function(w,_delta){return[100-w]},minCellWidth:function(){return CellUtils.minWidth()/pixelWidth*100},setElementWidth:Sizes.setPercentageWidth,setTableWidth:function(table,_newWidths,delta){var change=delta/100*floatWidth;Sizes.setPercentageWidth(table,floatWidth+change)}}}(percentMatch[1],element);var pixelMatch=Sizes.pixelBasedSizeRegex().exec(width);if(null!==pixelMatch){var intWidth=parseInt(pixelMatch[1],10);return pixelSize(intWidth)}var fallbackWidth=get$5(element);return pixelSize(fallbackWidth)}function getWarehouse$1(list){return Warehouse.generate(list)}function getTableWarehouse(table){var list=DetailsList_fromTable(table);return getWarehouse$1(list)}function handleExact(required,keys){var unsupported=filter(keys,function(key){return!contains(required,key)});0<unsupported.length&&unsuppMessage(unsupported)}function exactly(required){return function(handleUnsupported,required){return baseWith(handleUnsupported,required,{validate:isFunction,label:"function"})}(handleExact,required)}function elementToData(element){var colspan=has$1(element,"colspan")?parseInt(get$1(element,"colspan"),10):1,rowspan=has$1(element,"rowspan")?parseInt(get$1(element,"rowspan"),10):1;return{element:constant(element),colspan:constant(colspan),rowspan:constant(rowspan)}}function isBlock(universe,item){var tagName=universe.property().name(item);return contains(blockList,tagName)}function isEmptyTag(universe,item){return contains(["br","img","hr","input"],universe.property().name(item))}function prune(table){0===TableLookup.cells(table).length&&remove$2(table)}function elementFromGrid(grid,row,column){return findIn(grid,row,column).orThunk(function(){return findIn(grid,0,0)})}function bundle(grid,row,column){return outcome(grid,findIn(grid,row,column))}function uniqueRows(details){return foldl(details,function(rest,detail){return exists(rest,function(currentDetail){return currentDetail.row()===detail.row()})?rest:rest.concat([detail])},[]).sort(function(detailA,detailB){return detailA.row()-detailB.row()})}function uniqueColumns(details){return foldl(details,function(rest,detail){return exists(rest,function(currentDetail){return currentDetail.column()===detail.column()})?rest:rest.concat([detail])},[]).sort(function(detailA,detailB){return detailA.column()-detailB.column()})}function gridifyRows(rows,generators,example){var pasteDetails=DetailsList_fromPastedRows(rows,example),wh=Warehouse.generate(pasteDetails);return Transitions_toGrid(wh,generators,!0)}function getPixelWidth$1(elm){return elm.getBoundingClientRect().width}function getPixelHeight(elm){return elm.getBoundingClientRect().height}function addSizeSuffix(size){return/^[0-9]+$/.test(size)&&(size+="px"),size}function removeDataStyle(table){var dataStyleCells=descendants$1(table,"td[data-mce-style],th[data-mce-style]");remove(table,"data-mce-style"),each(dataStyleCells,function(cell){remove(cell,"data-mce-style")})}function getDefaultAttributes(editor){return editor.getParam("table_default_attributes",defaultAttributes,"object")}function getDefaultStyles(editor){return editor.getParam("table_default_styles",defaultStyles,"object")}function hasAdvancedCellTab(editor){return editor.getParam("table_cell_advtab",!0,"boolean")}function hasAdvancedRowTab(editor){return editor.getParam("table_row_advtab",!0,"boolean")}function hasAdvancedTableTab(editor){return editor.getParam("table_advtab",!0,"boolean")}function shouldStyleWithCss(editor){return editor.getParam("table_style_by_css",!1,"boolean")}function getTableClassList(editor){return editor.getParam("table_class_list",[],"array")}function isPixelsForced(editor){return!1===editor.getParam("table_responsive_width")}function fireNewRow(editor,row){return editor.fire("newrow",{node:row})}function fireNewCell(editor,cell){return editor.fire("newcell",{node:cell})}function fireObjectResizeStart(editor,target,width,height){editor.fire("ObjectResizeStart",{target:target,width:width,height:height})}function fireObjectResized(editor,target,width,height){editor.fire("ObjectResized",{target:target,width:width,height:height})}function toEnd(universe,element){return universe.property().isText(element)?universe.property().getText(element).length:universe.property().children(element).length}function extractAdvancedStyles(dom,elm){function rgbToHex(value){return startsWith(value,"rgb")?dom.toHex(value):value}return{borderwidth:getRaw(Element.fromDom(elm),"border-width").getOr(""),borderstyle:getRaw(Element.fromDom(elm),"border-style").getOr(""),bordercolor:getRaw(Element.fromDom(elm),"border-color").map(rgbToHex).getOr(""),backgroundcolor:getRaw(Element.fromDom(elm),"background-color").map(rgbToHex).getOr("")}}function getAlignment(alignments,formatName,dataName,editor,elm){var alignmentData={};return global$1.each(alignments.split(" "),function(name){editor.formatter.matchNode(elm,formatName+name)&&(alignmentData[dataName]=name)}),alignmentData[dataName]||(alignmentData[dataName]=""),alignmentData}function updateSimpleProps(modifiers,data){modifiers.setAttrib("scope",data.scope),modifiers.setAttrib("class",data.class),modifiers.setStyle("width",addSizeSuffix(data.width)),modifiers.setStyle("height",addSizeSuffix(data.height))}function updateAdvancedProps(modifiers,data){modifiers.setStyle("background-color",data.backgroundcolor),modifiers.setStyle("border-color",data.bordercolor),modifiers.setStyle("border-style",data.borderstyle),modifiers.setStyle("border-width",addSizeSuffix(data.borderwidth))}function applyToSingle(editor,cells,data){var dom=editor.dom,cellElm=data.celltype&&cells[0].nodeName.toLowerCase()!==data.celltype?dom.rename(cells[0],data.celltype):cells[0],modifiers=DomModifier.normal(dom,cellElm);updateSimpleProps(modifiers,data),hasAdvancedCellTab(editor)&&updateAdvancedProps(modifiers,data),Styles$1_unApplyAlign(editor,cellElm),Styles$1_unApplyVAlign(editor,cellElm),data.halign&&Styles$1_applyAlign(editor,cellElm,data.halign),data.valign&&Styles$1_applyVAlign(editor,cellElm,data.valign)}function applyToMultiple(editor,cells,data){var dom=editor.dom;global$1.each(cells,function(cellElm){data.celltype&&cellElm.nodeName.toLowerCase()!==data.celltype&&(cellElm=dom.rename(cellElm,data.celltype));var modifiers=DomModifier.ifTruthy(dom,cellElm);updateSimpleProps(modifiers,data),hasAdvancedCellTab(editor)&&updateAdvancedProps(modifiers,data),data.halign&&Styles$1_applyAlign(editor,cellElm,data.halign),data.valign&&Styles$1_applyVAlign(editor,cellElm,data.valign)})}function onSubmitCellForm(editor,cells,api){var data=api.getData();api.close(),editor.undoManager.transact(function(){(1===cells.length?applyToSingle:applyToMultiple)(editor,cells,data),editor.focus()})}function onSubmitRowForm(editor,rows,oldData,api){var dom=editor.dom,data=api.getData();api.close();var createModifier=1===rows.length?DomModifier.normal:DomModifier.ifTruthy;editor.undoManager.transact(function(){global$1.each(rows,function(rowElm){data.type!==rowElm.parentNode.nodeName.toLowerCase()&&function(dom,rowElm,toType){var tableElm=dom.getParent(rowElm,"table"),oldParentElm=rowElm.parentNode,parentElm=dom.select(toType,tableElm)[0];parentElm||(parentElm=dom.create(toType),tableElm.firstChild?"CAPTION"===tableElm.firstChild.nodeName?dom.insertAfter(parentElm,tableElm.firstChild):tableElm.insertBefore(parentElm,tableElm.firstChild):tableElm.appendChild(parentElm)),"tbody"===toType&&"THEAD"===oldParentElm.nodeName&&parentElm.firstChild?parentElm.insertBefore(rowElm,parentElm.firstChild):parentElm.appendChild(rowElm),oldParentElm.hasChildNodes()||dom.remove(oldParentElm)}(editor.dom,rowElm,data.type);var modifier=createModifier(dom,rowElm);modifier.setAttrib("scope",data.scope),modifier.setAttrib("class",data.class),modifier.setStyle("height",addSizeSuffix(data.height)),hasAdvancedRowTab(editor)&&function(modifier,data){modifier.setStyle("background-color",data.backgroundcolor),modifier.setStyle("border-color",data.bordercolor),modifier.setStyle("border-style",data.borderstyle)}(modifier,data),data.align!==oldData.align&&(Styles$1_unApplyAlign(editor,rowElm),Styles$1_applyAlign(editor,rowElm,data.align))}),editor.focus()})}function render$1(rows,columns,rowHeaders,columnHeaders,renderOpts){void 0===renderOpts&&(renderOpts=DefaultRenderOptions);var table=Element.fromTag("table");setAll$1(table,renderOpts.styles),setAll(table,renderOpts.attributes);var tbody=Element.fromTag("tbody");append(table,tbody);for(var trs=[],i=0;i<rows;i++){for(var tr=Element.fromTag("tr"),j=0;j<columns;j++){var td=i<rowHeaders||j<columnHeaders?Element.fromTag("th"):Element.fromTag("td");j<columnHeaders&&set(td,"scope","row"),i<rowHeaders&&set(td,"scope","col"),append(td,Element.fromTag("br")),renderOpts.percentages&&set$1(td,"width",100/columns+"%"),append(tr,td)}trs.push(tr)}return append$1(tbody,trs),table}function placeCaretInCell(editor,cell){editor.selection.select(cell.dom(),!0),editor.selection.collapse(!0)}function onSubmitTableForm(editor,tableElm,api){var captionElm,dom=editor.dom,data=api.getData();api.close(),""===data.class&&delete data.class,editor.undoManager.transact(function(){if(!tableElm){var cols=parseInt(data.cols,10)||1,rows=parseInt(data.rows,10)||1;tableElm=InsertTable_insert(editor,cols,rows)}!function(editor,tableElm,data){var dom=editor.dom,attrs={},styles={};if(attrs.class=data.class,styles.height=addSizeSuffix(data.height),dom.getAttrib(tableElm,"width")&&!shouldStyleWithCss(editor)?attrs.width=function(size){return size?size.replace(/px$/,""):""}(data.width):styles.width=addSizeSuffix(data.width),shouldStyleWithCss(editor)?(styles["border-width"]=addSizeSuffix(data.border),styles["border-spacing"]=addSizeSuffix(data.cellspacing)):(attrs.border=data.border,attrs.cellpadding=data.cellpadding,attrs.cellspacing=data.cellspacing),shouldStyleWithCss(editor)&&tableElm.children)for(var i=0;i<tableElm.children.length;i++)styleTDTH(dom,tableElm.children[i],{"border-width":addSizeSuffix(data.border),padding:addSizeSuffix(data.cellpadding)}),hasAdvancedTableTab(editor)&&styleTDTH(dom,tableElm.children[i],{"border-color":data.bordercolor});hasAdvancedTableTab(editor)&&(styles["background-color"]=data.backgroundcolor,styles["border-color"]=data.bordercolor,styles["border-style"]=data.borderstyle),attrs.style=dom.serializeStyle(__assign(__assign({},getDefaultStyles(editor)),styles)),dom.setAttribs(tableElm,__assign(__assign({},getDefaultAttributes(editor)),attrs))}(editor,tableElm,data),(captionElm=dom.select("caption",tableElm)[0])&&!data.caption&&dom.remove(captionElm),!captionElm&&data.caption&&((captionElm=dom.create("caption")).innerHTML=global$2.ie?"":'<br data-mce-bogus="1"/>',tableElm.insertBefore(captionElm,tableElm.firstChild)),""===data.align?Styles$1_unApplyAlign(editor,tableElm):Styles$1_applyAlign(editor,tableElm,data.align),editor.focus(),editor.addVisual()})}function getSelectionStartFromSelector(selector){return function(editor){return Option.from(editor.dom.getParent(editor.selection.getStart(),selector)).map(Element.fromDom)}}function fromRawEvent(rawEvent){function stop(){rawEvent.stopPropagation()}function prevent(){rawEvent.preventDefault()}var target=Element.fromDom(rawEvent.target),kill=function(fa,fb){return function(){for(var args=[],_i=0;_i<arguments.length;_i++)args[_i]=arguments[_i];return fa(fb.apply(null,args))}}(prevent,stop);return function(target,x,y,stop,prevent,kill,raw){return{target:constant(target),x:constant(x),y:constant(y),stop:stop,prevent:prevent,kill:kill,raw:constant(raw)}}(target,rawEvent.clientX,rawEvent.clientY,stop,prevent,kill,rawEvent)}function binder(element,event,filter,handler,useCapture){var wrapped=function(filter,handler){return function(rawEvent){filter(rawEvent)&&handler(fromRawEvent(rawEvent))}}(filter,handler);return element.dom().addEventListener(event,wrapped,useCapture),{unbind:curry(unbind,element,event,wrapped,useCapture)}}function bind$2(element,event,handler){return function(element,event,filter,handler){return binder(element,event,filter,handler,!1)}(element,event,filter$1,handler)}var TableGridSize_getGridSize=function(table){var input=DetailsList_fromTable(table);return Warehouse.generate(input).grid()},Redraw_render=function(table,grid){function renderOrRemoveSection(gridSection,sectionName){0<gridSection.length?function(gridSection,sectionName){var section=child$2(table,sectionName).getOrThunk(function(){var tb=Element.fromTag(sectionName,owner(table).dom());return append(table,tb),tb});empty(section);var rows=map(gridSection,function(row){row.isNew()&&newRows.push(row.element());var tr=row.element();return empty(tr),each(row.cells(),function(cell){cell.isNew()&&newCells.push(cell.element()),setIfNot(cell.element(),"colspan",cell.colspan(),1),setIfNot(cell.element(),"rowspan",cell.rowspan(),1),append(tr,cell.element())}),tr});append$1(section,rows)}(gridSection,sectionName):function(sectionName){child$2(table,sectionName).each(remove$2)}(sectionName)}var newRows=[],newCells=[],headSection=[],bodySection=[],footSection=[];return each(grid,function(row){switch(row.section()){case"thead":headSection.push(row);break;case"tbody":bodySection.push(row);break;case"tfoot":footSection.push(row)}}),renderOrRemoveSection(headSection,"thead"),renderOrRemoveSection(bodySection,"tbody"),renderOrRemoveSection(footSection,"tfoot"),{newRows:constant(newRows),newCells:constant(newCells)}},Redraw_copy=function(grid){return map(grid,function(row){var tr=shallow(row.element());return each(row.cells(),function(cell){var clonedCell=deep(cell.element());setIfNot(clonedCell,"colspan",cell.colspan(),1),setIfNot(clonedCell,"rowspan",cell.rowspan(),1),append(tr,clonedCell)}),tr})},decide=function(getBlock,isSingle,getFallback){var inBlock=getBlock();return find(inBlock,isSingle).orThunk(function(){return Option.from(inBlock[0]).orThunk(getFallback)}).map(function(detail){return detail.element()})},Blocks_columns=function(warehouse){var grid=warehouse.grid(),cols=range(0,grid.columns()),rowsArr=range(0,grid.rows());return map(cols,function(col){return decide(function(){return bind(rowsArr,function(r){return Warehouse.getAt(warehouse,r,col).filter(function(detail){return detail.column()===col}).fold(constant([]),function(detail){return[detail]})})},function(detail){return 1===detail.colspan()},function(){return Warehouse.getAt(warehouse,0,col)})})},Blocks_rows=function(warehouse){var grid=warehouse.grid(),rowsArr=range(0,grid.rows()),cols=range(0,grid.columns());return map(rowsArr,function(row){return decide(function(){return bind(cols,function(c){return Warehouse.getAt(warehouse,row,c).filter(function(detail){return detail.row()===row}).fold(constant([]),function(detail){return[detail]})})},function(detail){return 1===detail.rowspan()},function(){return Warehouse.getAt(warehouse,row,0)})})},Styles={resolve:css("ephox-snooker").resolve},Bar_col=function(column,x,y,w,h){var bar=Element.fromTag("div");return setAll$1(bar,{position:"absolute",left:x-w/2+"px",top:y+"px",height:h+"px",width:w+"px"}),setAll(bar,{"data-column":column,role:"presentation"}),bar},Bar_row=function(r,x,y,w,h){var bar=Element.fromTag("div");return setAll$1(bar,{position:"absolute",left:x+"px",top:y-h/2+"px",height:h+"px",width:w+"px"}),setAll(bar,{"data-row":r,role:"presentation"}),bar},resizeBar=Styles.resolve("resizer-bar"),resizeRowBar=Styles.resolve("resizer-rows"),resizeColBar=Styles.resolve("resizer-cols"),Bars_refresh=function(wire,table,hdirection,vdirection){destroy(wire);var list=DetailsList_fromTable(table),warehouse=Warehouse.generate(list),rows=Blocks_rows(warehouse),cols=Blocks_columns(warehouse);refreshGrid(wire,table,rows,cols,hdirection,vdirection)},Bars_hide=function(wire){each$2(wire,function(bar){set$1(bar,"display","none")})},Bars_show=function(wire){each$2(wire,function(bar){set$1(bar,"display","block")})},Bars_destroy=destroy,Bars_isRowBar=function(element){return has$2(element,resizeRowBar)},Bars_isColBar=function(element){return has$2(element,resizeColBar)},setCells=function(gridRow,cells){return rowcells(cells,gridRow.section())},GridRow={addCell:function(gridRow,index,cell){var cells=gridRow.cells(),before=cells.slice(0,index),after=cells.slice(index),newCells=before.concat([cell]).concat(after);return setCells(gridRow,newCells)},setCells:setCells,mutateCell:function(gridRow,index,cell){gridRow.cells()[index]=cell},getCell:getCell,getCellElement:function(gridRow,index){return getCell(gridRow,index).element()},mapCells:function(gridRow,f){var cells=gridRow.cells(),r=map(cells,f);return rowcells(r,gridRow.section())},cellLength:function(gridRow){return gridRow.cells().length}},TableGrid_subgrid=function(grid,row,column,comparator){var restOfRow=function(grid,index){return grid[index]}(grid,row).cells().slice(column),endColIndex=findDiff(restOfRow,comparator),restOfColumn=function(grid,index){return map(grid,function(row){return GridRow.getCell(row,index)})}(grid,column).slice(row),endRowIndex=findDiff(restOfColumn,comparator);return{colspan:constant(endColIndex),rowspan:constant(endRowIndex)}},Transitions_toDetails=function(grid,comparator){var seen=map(grid,function(row,ri){return map(row.cells(),function(col,ci){return!1})});return map(grid,function(row,ri){var details=bind(row.cells(),function(cell,ci){if(!1!==seen[ri][ci])return[];var result=TableGrid_subgrid(grid,ri,ci,comparator);return function(ri,ci,rowspan,colspan){for(var r=ri;r<ri+rowspan;r++)for(var c=ci;c<ci+colspan;c++)seen[r][c]=!0}(ri,ci,result.rowspan(),result.colspan()),[detailnew(cell.element(),result.rowspan(),result.colspan(),cell.isNew())]});return rowdetails(details,row.section())})},Transitions_toGrid=function(warehouse,generators,isNew){for(var grid=[],i=0;i<warehouse.grid().rows();i++){for(var rowCells=[],j=0;j<warehouse.grid().columns();j++){var element=Warehouse.getAt(warehouse,i,j).map(function(item){return elementnew(item.element(),isNew)}).getOrThunk(function(){return elementnew(generators.gap(),!0)});rowCells.push(element)}var row=rowcells(rowCells,warehouse.all()[i].section());grid.push(row)}return grid},value=function(o){return{is:function(v){return o===v},isValue:always,isError:never,getOr:constant(o),getOrThunk:constant(o),getOrDie:constant(o),or:function(opt){return value(o)},orThunk:function(f){return value(o)},fold:function(_,onValue){return onValue(o)},map:function(f){return value(f(o))},mapError:function(f){return value(o)},each:function(f){f(o)},bind:function(f){return f(o)},exists:function(f){return f(o)},forall:function(f){return f(o)},toOption:function(){return Option.some(o)}}},error=function(message){return{is:never,isValue:never,isError:always,getOr:identity,getOrThunk:function(f){return f()},getOrDie:function(){return function(msg){return function(){throw new Error(msg)}}(String(message))()},or:function(opt){return opt},orThunk:function(f){return f()},fold:function(onError,_){return onError(message)},map:function(f){return error(message)},mapError:function(f){return error(f(message))},each:noop,bind:function(f){return error(message)},exists:never,forall:always,toOption:Option.none}},Result={value:value,error:error,fromOption:function(opt,err){return opt.fold(function(){return error(err)},value)}},Fitment_measure=function(startAddress,gridA,gridB){if(startAddress.row()>=gridA.length||startAddress.column()>GridRow.cellLength(gridA[0]))return Result.error("invalid start address out of table bounds, row: "+startAddress.row()+", column: "+startAddress.column());var rowRemainder=gridA.slice(startAddress.row()),colRemainder=rowRemainder[0].cells().slice(startAddress.column()),colRequired=GridRow.cellLength(gridB[0]),rowRequired=gridB.length;return Result.value({rowDelta:constant(rowRemainder.length-rowRequired),colDelta:constant(colRemainder.length-colRequired)})},Fitment_measureWidth=function(gridA,gridB){var colLengthA=GridRow.cellLength(gridA[0]),colLengthB=GridRow.cellLength(gridB[0]);return{rowDelta:constant(0),colDelta:constant(colLengthA-colLengthB)}},Fitment_tailor=function(gridA,delta,generator){var fillCols=delta.colDelta()<0?colFill:identity;return(delta.rowDelta()<0?rowFill:identity)(fillCols(gridA,Math.abs(delta.colDelta()),generator),Math.abs(delta.rowDelta()),generator)},MergingOperations_merge=function(grid,bounds,comparator,substitution){if(0===grid.length)return grid;for(var i=bounds.startRow();i<=bounds.finishRow();i++)for(var j=bounds.startCol();j<=bounds.finishCol();j++)GridRow.mutateCell(grid[i],j,elementnew(substitution(),!1));return grid},MergingOperations_unmerge=function(grid,target,comparator,substitution){for(var first=!0,i=0;i<grid.length;i++)for(var j=0;j<GridRow.cellLength(grid[0]);j++){var isToReplace=comparator(GridRow.getCellElement(grid[i],j),target);!0===isToReplace&&!1===first?GridRow.mutateCell(grid[i],j,elementnew(substitution(),!0)):!0===isToReplace&&(first=!1)}return grid},MergingOperations_splitRows=function(grid,index,comparator,substitution){if(0<index&&index<grid.length){var cells=function(row,comparator){return foldl(row,function(rest,cell){return exists(rest,function(currentCell){return comparator(currentCell.element(),cell.element())})?rest:rest.concat([cell])},[])}(grid[index-1].cells(),comparator);each(cells,function(cell){for(var replacement=Option.none(),_loop_1=function(i){for(var _loop_2=function(j){var current=grid[i].cells()[j];comparator(current.element(),cell.element())&&(replacement.isNone()&&(replacement=Option.some(substitution())),replacement.each(function(sub){GridRow.mutateCell(grid[i],j,elementnew(sub,!0))}))},j=0;j<GridRow.cellLength(grid[0]);j++)_loop_2(j)},i=index;i<grid.length;i++)_loop_1(i)})}return grid},TableMerge_merge=function(startAddress,gridA,gridB,generator,comparator){return Fitment_measure(startAddress,gridA,gridB).map(function(delta){var fittedGrid=Fitment_tailor(gridA,delta,generator);return function(startAddress,gridA,gridB,generator,comparator){for(var startRow=startAddress.row(),startCol=startAddress.column(),endRow=startRow+gridB.length,endCol=startCol+GridRow.cellLength(gridB[0]),r=startRow;r<endRow;r++)for(var c=startCol;c<endCol;c++){isSpanning(gridA,r,c,comparator)&&MergingOperations_unmerge(gridA,GridRow.getCellElement(gridA[r],c),comparator,generator.cell);var newCell=GridRow.getCellElement(gridB[r-startRow],c-startCol),replacement=generator.replace(newCell);GridRow.mutateCell(gridA[r],c,elementnew(replacement,!0))}return gridA}(startAddress,fittedGrid,gridB,generator,comparator)})},TableMerge_insert=function(index,gridA,gridB,generator,comparator){MergingOperations_splitRows(gridA,index,comparator,generator.cell);var delta=Fitment_measureWidth(gridB,gridA),fittedNewGrid=Fitment_tailor(gridB,delta,generator),secondDelta=Fitment_measureWidth(gridA,fittedNewGrid),fittedOldGrid=Fitment_tailor(gridA,secondDelta,generator);return fittedOldGrid.slice(0,index).concat(fittedNewGrid).concat(fittedOldGrid.slice(index,fittedOldGrid.length))},ModificationOperations_insertRowAt=function(grid,index,example,comparator,substitution){var before=grid.slice(0,index),after=grid.slice(index),between=GridRow.mapCells(grid[example],function(ex,c){return 0<index&&index<grid.length&&comparator(GridRow.getCellElement(grid[index-1],c),GridRow.getCellElement(grid[index],c))?GridRow.getCell(grid[index],c):elementnew(substitution(ex.element(),comparator),!0)});return before.concat([between]).concat(after)},ModificationOperations_insertColumnAt=function(grid,index,example,comparator,substitution){return map(grid,function(row){var sub=0<index&&index<GridRow.cellLength(row)&&comparator(GridRow.getCellElement(row,index-1),GridRow.getCellElement(row,index))?GridRow.getCell(row,index):elementnew(substitution(GridRow.getCellElement(row,example),comparator),!0);return GridRow.addCell(row,index,sub)})},ModificationOperations_splitCellIntoColumns=function(grid,exampleRow,exampleCol,comparator,substitution){var index=exampleCol+1;return map(grid,function(row,i){var sub=i===exampleRow?elementnew(substitution(GridRow.getCellElement(row,exampleCol),comparator),!0):GridRow.getCell(row,exampleCol);return GridRow.addCell(row,index,sub)})},ModificationOperations_splitCellIntoRows=function(grid,exampleRow,exampleCol,comparator,substitution){var index=exampleRow+1,before=grid.slice(0,index),after=grid.slice(index),between=GridRow.mapCells(grid[exampleRow],function(ex,i){return i===exampleCol?elementnew(substitution(ex.element(),comparator),!0):ex});return before.concat([between]).concat(after)},ModificationOperations_deleteRowsAt=function(grid,start,finish){return grid.slice(0,start).concat(grid.slice(finish+1))},ModificationOperations_deleteColumnsAt=function(grid,start,finish){var rows=map(grid,function(row){var cells=row.cells().slice(0,start).concat(row.cells().slice(finish+1));return rowcells(cells,row.section())});return filter(rows,function(row){return 0<row.cells().length})},TransformOperations_replaceColumn=function(grid,index,comparator,substitution){var targets=bind(grid,function(row,i){return notStartRow(grid,i,index,comparator)||notStartColumn(row,index,comparator)?[]:[GridRow.getCell(row,index)]});return replaceIn(grid,targets,comparator,substitution)},TransformOperations_replaceRow=function(grid,index,comparator,substitution){var targetRow=grid[index],targets=bind(targetRow.cells(),function(item,i){return notStartRow(grid,index,i,comparator)||notStartColumn(targetRow,i,comparator)?[]:[item]});return replaceIn(grid,targets,comparator,substitution)},adt=Adt_generate([{none:[]},{only:["index"]},{left:["index","next"]},{middle:["prev","index","next"]},{right:["prev","index"]}]),ColumnContext=__assign({},adt),Deltas_determine=function(input,column,step,tableSize){function zero(array){return map(array,constant(0))}function onChange(index,next){if(0<=step){var newNext=Math.max(tableSize.minCellWidth(),result[next]-step);return zero(result.slice(0,index)).concat([step,newNext-result[next]]).concat(zero(result.slice(next+1)))}var newThis=Math.max(tableSize.minCellWidth(),result[index]+step),diffx=result[index]-newThis;return zero(result.slice(0,index)).concat([newThis-result[index],diffx]).concat(zero(result.slice(next+1)))}var result=input.slice(0),context=function(input,index){return 0===input.length?ColumnContext.none():1===input.length?ColumnContext.only(0):0===index?ColumnContext.left(0,1):index===input.length-1?ColumnContext.right(index-1,index):0<index&&index<input.length-1?ColumnContext.middle(index-1,index,index+1):ColumnContext.none()}(input,column),onNone=constant(zero(result)),onLeft=onChange;return context.fold(onNone,function(index){return tableSize.singleColumnWidth(result[index],step)},onLeft,function(_prev,index,next){return onChange(index,next)},function(_prev,index){if(0<=step)return zero(result.slice(0,index)).concat([step]);var size=Math.max(tableSize.minCellWidth(),result[index]+step);return zero(result.slice(0,index)).concat([size-result[index]])})},CellUtils={hasColspan:function(cell){return getSpan$1(cell,"colspan")},hasRowspan:function(cell){return getSpan$1(cell,"rowspan")},minWidth:constant(10),minHeight:constant(10),getInt:function(element,property){return parseInt(get$2(element,property),10)}},ColumnSizes={getRawWidths:function(warehouse,direction,tableSize){return getWidthFrom(warehouse,direction,getRawW,getDeduced,tableSize)},getPixelWidths:function(warehouse,direction,tableSize){return getWidthFrom(warehouse,direction,Sizes.getPixelWidth,function(deduced){return deduced.getOrThunk(tableSize.minCellWidth)},tableSize)},getPercentageWidths:function(warehouse,direction,tableSize){return getWidthFrom(warehouse,direction,Sizes.getPercentageWidth,function(deduced){return deduced.fold(function(){return tableSize.minCellWidth()},function(cellWidth){return cellWidth/tableSize.pixelWidth()*100})},tableSize)},getPixelHeights:function(warehouse,direction){return getHeightFrom(warehouse,direction,Sizes.getHeight,function(deduced){return deduced.getOrThunk(CellUtils.minHeight)})},getRawHeights:function(warehouse,direction){return getHeightFrom(warehouse,direction,getRawH,getDeduced)}},Recalculations_recalculateWidth=function(warehouse,widths){var all=Warehouse.justCells(warehouse);return map(all,function(cell){var width=total(cell.column(),cell.column()+cell.colspan(),widths);return{element:cell.element,width:constant(width),colspan:cell.colspan}})},Recalculations_recalculateHeight=function(warehouse,heights){var all=Warehouse.justCells(warehouse);return map(all,function(cell){var height=total(cell.row(),cell.row()+cell.rowspan(),heights);return{element:cell.element,height:constant(height),rowspan:cell.rowspan}})},Recalculations_matchRowHeight=function(warehouse,heights){return map(warehouse.all(),function(row,i){return{element:row.element,height:constant(heights[i])}})},TableSize_getTableSize=function(element){return Sizes.getRawWidth(element).fold(function(){var fallbackWidth=get$5(element);return pixelSize(fallbackWidth)},function(w){return chooseSize(element,w)})},Adjustments_adjustWidth=function(table,delta,index,direction){var tableSize=TableSize_getTableSize(table),step=tableSize.getCellDelta(delta),warehouse=getTableWarehouse(table),widths=tableSize.getWidths(warehouse,direction,tableSize),deltas=Deltas_determine(widths,index,step,tableSize),newWidths=map(deltas,function(dx,i){return dx+widths[i]}),newSizes=Recalculations_recalculateWidth(warehouse,newWidths);each(newSizes,function(cell){tableSize.setElementWidth(cell.element(),cell.width())}),index===warehouse.grid().columns()-1&&tableSize.setTableWidth(table,newWidths,step)},Adjustments_adjustHeight=function(table,delta,index,direction){var warehouse=getTableWarehouse(table),heights=ColumnSizes.getPixelHeights(warehouse,direction),newHeights=map(heights,function(dy,i){return index===i?Math.max(delta+dy,CellUtils.minHeight()):dy}),newCellSizes=Recalculations_recalculateHeight(warehouse,newHeights),newRowSizes=Recalculations_matchRowHeight(warehouse,newHeights);each(newRowSizes,function(row){Sizes.setHeight(row.element(),row.height())}),each(newCellSizes,function(cell){Sizes.setHeight(cell.element(),cell.height())});var total=function(newSize){return foldr(newSize,function(b,a){return b+a},0)}(newHeights);Sizes.setHeight(table,total)},Adjustments_adjustWidthTo=function(table,list,direction){var tableSize=TableSize_getTableSize(table),warehouse=getWarehouse$1(list),widths=tableSize.getWidths(warehouse,direction,tableSize),newSizes=Recalculations_recalculateWidth(warehouse,widths);each(newSizes,function(cell){tableSize.setElementWidth(cell.element(),cell.width())}),0<newSizes.length&&tableSize.setTableWidth(table,widths,tableSize.getCellDelta(0))},baseWith=function(handleUnsupported,required,pred){if(0===required.length)throw new Error("You must specify at least one required field.");return validateStrArr("required",required),checkDupes(required),function(obj){var keys$1=keys(obj);forall(required,function(req){return contains(keys$1,req)})||reqMessage(required,keys$1),handleUnsupported(required,keys$1);var invalidKeys=filter(required,function(key){return!pred.validate(obj[key],key)});return 0<invalidKeys.length&&function(incorrect,type){throw new Error("All values need to be of type: "+type+". Keys ("+sort(incorrect).join(", ")+") were not.")}(invalidKeys,pred.label),obj}},verifyGenerators=exactly(["cell","row","replace","gap"]),Generators_modification=function(generators,toData){void 0===toData&&(toData=elementToData),verifyGenerators(generators);function nuFrom(element){return function(data){return generators.cell(data)}(toData(element))}function add(element){var replacement=nuFrom(element);return position.get().isNone()&&position.set(Option.some(replacement)),recent=Option.some({item:element,replacement:replacement}),replacement}var position=Cell(Option.none()),recent=Option.none();return{getOrInit:function(element,comparator){return recent.fold(function(){return add(element)},function(p){return comparator(element,p.item)?p.replacement:add(element)})},cursor:position.get}},Generators_transform=function(scope,tag){return function(generators){var position=Cell(Option.none());verifyGenerators(generators);function makeNew(element){var attrs={scope:scope},cell=generators.replace(element,tag,attrs);return list.push({item:element,sub:cell}),position.get().isNone()&&position.set(Option.some(cell)),cell}var list=[];return{replaceOrInit:function(element,comparator){return function(element,comparator){return find(list,function(x){return comparator(x.item,element)})}(element,comparator).fold(function(){return makeNew(element)},function(p){return comparator(element,p.item)?p.sub:makeNew(element)})},cursor:position.get}}},Generators_merging=function(generators){verifyGenerators(generators);var position=Cell(Option.none());return{combine:function(cell){return position.get().isNone()&&position.set(Option.some(cell)),function(){var raw=generators.cell({element:constant(cell),colspan:constant(1),rowspan:constant(1)});return remove$1(raw,"width"),remove$1(cell,"width"),raw}},cursor:position.get}},blockList=["body","p","div","article","aside","figcaption","figure","footer","header","nav","section","ol","ul","table","thead","tfoot","tbody","caption","tr","td","th","h1","h2","h3","h4","h5","h6","blockquote","pre","address"],Structure_isBlock=isBlock,Structure_isList=function(universe,item){var tagName=universe.property().name(item);return contains(["ol","ul"],tagName)},Structure_isEmptyTag=isEmptyTag,universe$1=DomUniverse(),DomStructure_isBlock=function(element){return Structure_isBlock(universe$1,element)},DomStructure_isList=function(element){return Structure_isList(universe$1,element)},DomStructure_isEmptyTag=function(element){return Structure_isEmptyTag(universe$1,element)},TableContent_merge=function(cells){function isBr(el){return"br"===name(el)}function markCell(cell){return last$1(cell).bind(function(rightEdge){var rightSiblingIsBlock=function(el){return nextSibling(el).map(function(rightSibling){return!!DomStructure_isBlock(rightSibling)||!!DomStructure_isEmptyTag(rightSibling)&&"img"!==name(rightSibling)}).getOr(!1)}(rightEdge);return parent(rightEdge).map(function(parent){return!0===rightSiblingIsBlock||function(el){return"li"===name(el)||ancestor(el,DomStructure_isList).isSome()}(parent)||isBr(rightEdge)||DomStructure_isBlock(parent)&&!eq(cell,parent)?[]:[Element.fromTag("br")]})}).getOr([])}var content,contents=0===(content=bind(cells,function(cell){var children$1=children(cell);return function(children){return forall(children,function(c){return isBr(c)||isText(c)&&0===get$3(c).trim().length})}(children$1)?[]:children$1.concat(markCell(cell))})).length?[Element.fromTag("br")]:content;empty(cells[0]),append$1(cells[0],contents)},outcome=Immutable("grid","cursor"),findIn=function(grid,row,column){return Option.from(grid[row]).bind(function(r){return Option.from(r.cells()[column]).bind(function(c){return Option.from(c.element())})})},resize=Adjustments_adjustWidthTo,TableOperations={insertRowBefore:run(function(grid,detail,comparator,genWrappers){var example=detail.row(),targetIndex=detail.row(),newGrid=ModificationOperations_insertRowAt(grid,targetIndex,example,comparator,genWrappers.getOrInit);return bundle(newGrid,targetIndex,detail.column())},onCell,noop,noop,Generators_modification),insertRowsBefore:run(function(grid,details,comparator,genWrappers){var example=details[0].row(),targetIndex=details[0].row(),rows=uniqueRows(details),newGrid=foldl(rows,function(newG,_row){return ModificationOperations_insertRowAt(newG,targetIndex,example,comparator,genWrappers.getOrInit)},grid);return bundle(newGrid,targetIndex,details[0].column())},onCells,noop,noop,Generators_modification),insertRowAfter:run(function(grid,detail,comparator,genWrappers){var example=detail.row(),targetIndex=detail.row()+detail.rowspan(),newGrid=ModificationOperations_insertRowAt(grid,targetIndex,example,comparator,genWrappers.getOrInit);return bundle(newGrid,targetIndex,detail.column())},onCell,noop,noop,Generators_modification),insertRowsAfter:run(function(grid,details,comparator,genWrappers){var rows=uniqueRows(details),example=rows[rows.length-1].row(),targetIndex=rows[rows.length-1].row()+rows[rows.length-1].rowspan(),newGrid=foldl(rows,function(newG,_row){return ModificationOperations_insertRowAt(newG,targetIndex,example,comparator,genWrappers.getOrInit)},grid);return bundle(newGrid,targetIndex,details[0].column())},onCells,noop,noop,Generators_modification),insertColumnBefore:run(function(grid,detail,comparator,genWrappers){var example=detail.column(),targetIndex=detail.column(),newGrid=ModificationOperations_insertColumnAt(grid,targetIndex,example,comparator,genWrappers.getOrInit);return bundle(newGrid,detail.row(),targetIndex)},onCell,resize,noop,Generators_modification),insertColumnsBefore:run(function(grid,details,comparator,genWrappers){var columns=uniqueColumns(details),example=columns[0].column(),targetIndex=columns[0].column(),newGrid=foldl(columns,function(newG,_row){return ModificationOperations_insertColumnAt(newG,targetIndex,example,comparator,genWrappers.getOrInit)},grid);return bundle(newGrid,details[0].row(),targetIndex)},onCells,resize,noop,Generators_modification),insertColumnAfter:run(function(grid,detail,comparator,genWrappers){var example=detail.column(),targetIndex=detail.column()+detail.colspan(),newGrid=ModificationOperations_insertColumnAt(grid,targetIndex,example,comparator,genWrappers.getOrInit);return bundle(newGrid,detail.row(),targetIndex)},onCell,resize,noop,Generators_modification),insertColumnsAfter:run(function(grid,details,comparator,genWrappers){var example=details[details.length-1].column(),targetIndex=details[details.length-1].column()+details[details.length-1].colspan(),columns=uniqueColumns(details),newGrid=foldl(columns,function(newG,_row){return ModificationOperations_insertColumnAt(newG,targetIndex,example,comparator,genWrappers.getOrInit)},grid);return bundle(newGrid,details[0].row(),targetIndex)},onCells,resize,noop,Generators_modification),splitCellIntoColumns:run(function(grid,detail,comparator,genWrappers){var newGrid=ModificationOperations_splitCellIntoColumns(grid,detail.row(),detail.column(),comparator,genWrappers.getOrInit);return bundle(newGrid,detail.row(),detail.column())},onCell,resize,noop,Generators_modification),splitCellIntoRows:run(function(grid,detail,comparator,genWrappers){var newGrid=ModificationOperations_splitCellIntoRows(grid,detail.row(),detail.column(),comparator,genWrappers.getOrInit);return bundle(newGrid,detail.row(),detail.column())},onCell,noop,noop,Generators_modification),eraseColumns:run(function(grid,details,_comparator,_genWrappers){var columns=uniqueColumns(details),newGrid=ModificationOperations_deleteColumnsAt(grid,columns[0].column(),columns[columns.length-1].column()),cursor=elementFromGrid(newGrid,details[0].row(),details[0].column());return outcome(newGrid,cursor)},onCells,resize,prune,Generators_modification),eraseRows:run(function(grid,details,_comparator,_genWrappers){var rows=uniqueRows(details),newGrid=ModificationOperations_deleteRowsAt(grid,rows[0].row(),rows[rows.length-1].row()),cursor=elementFromGrid(newGrid,details[0].row(),details[0].column());return outcome(newGrid,cursor)},onCells,noop,prune,Generators_modification),makeColumnHeader:run(function(grid,detail,comparator,genWrappers){var newGrid=TransformOperations_replaceColumn(grid,detail.column(),comparator,genWrappers.replaceOrInit);return bundle(newGrid,detail.row(),detail.column())},onCell,noop,noop,Generators_transform("row","th")),unmakeColumnHeader:run(function(grid,detail,comparator,genWrappers){var newGrid=TransformOperations_replaceColumn(grid,detail.column(),comparator,genWrappers.replaceOrInit);return bundle(newGrid,detail.row(),detail.column())},onCell,noop,noop,Generators_transform(null,"td")),makeRowHeader:run(function(grid,detail,comparator,genWrappers){var newGrid=TransformOperations_replaceRow(grid,detail.row(),comparator,genWrappers.replaceOrInit);return bundle(newGrid,detail.row(),detail.column())},onCell,noop,noop,Generators_transform("col","th")),unmakeRowHeader:run(function(grid,detail,comparator,genWrappers){var newGrid=TransformOperations_replaceRow(grid,detail.row(),comparator,genWrappers.replaceOrInit);return bundle(newGrid,detail.row(),detail.column())},onCell,noop,noop,Generators_transform(null,"td")),mergeCells:run(function(grid,mergable,comparator,_genWrappers){var cells=mergable.cells();TableContent_merge(cells);var newGrid=MergingOperations_merge(grid,mergable.bounds(),comparator,constant(cells[0]));return outcome(newGrid,Option.from(cells[0]))},function(_warehouse,target){return target.mergable()},noop,noop,Generators_merging),unmergeCells:run(function(grid,unmergable,comparator,genWrappers){var newGrid=foldr(unmergable,function(b,cell){return MergingOperations_unmerge(b,cell,comparator,genWrappers.combine(cell))},grid);return outcome(newGrid,Option.from(unmergable[0]))},function(_warehouse,target){return target.unmergable()},resize,noop,Generators_merging),pasteCells:run(function(grid,pasteDetails,comparator,_genWrappers){var table,generators,list,wh,gridB=(table=pasteDetails.clipboard(),generators=pasteDetails.generators(),list=DetailsList_fromTable(table),wh=Warehouse.generate(list),Transitions_toGrid(wh,generators,!0)),startAddress=address(pasteDetails.row(),pasteDetails.column());return TableMerge_merge(startAddress,grid,gridB,pasteDetails.generators(),comparator).fold(function(){return outcome(grid,Option.some(pasteDetails.element()))},function(nuGrid){var cursor=elementFromGrid(nuGrid,pasteDetails.row(),pasteDetails.column());return outcome(nuGrid,cursor)})},function(warehouse,target){return TableLookup.cell(target.element()).bind(function(cell){return findInWarehouse(warehouse,cell).map(function(details){return __assign(__assign({},details),{generators:target.generators,clipboard:target.clipboard})})})},resize,noop,Generators_modification),pasteRowsBefore:run(function(grid,pasteDetails,comparator,_genWrappers){var example=grid[pasteDetails.cells[0].row()],index=pasteDetails.cells[0].row(),gridB=gridifyRows(pasteDetails.clipboard(),pasteDetails.generators(),example),mergedGrid=TableMerge_insert(index,grid,gridB,pasteDetails.generators(),comparator),cursor=elementFromGrid(mergedGrid,pasteDetails.cells[0].row(),pasteDetails.cells[0].column());return outcome(mergedGrid,cursor)},onPasteRows,noop,noop,Generators_modification),pasteRowsAfter:run(function(grid,pasteDetails,comparator,_genWrappers){var example=grid[pasteDetails.cells[0].row()],index=pasteDetails.cells[pasteDetails.cells.length-1].row()+pasteDetails.cells[pasteDetails.cells.length-1].rowspan(),gridB=gridifyRows(pasteDetails.clipboard(),pasteDetails.generators(),example),mergedGrid=TableMerge_insert(index,grid,gridB,pasteDetails.generators(),comparator),cursor=elementFromGrid(mergedGrid,pasteDetails.cells[0].row(),pasteDetails.cells[0].column());return outcome(mergedGrid,cursor)},onPasteRows,noop,noop,Generators_modification)},getBody$1=function(editor){return Element.fromDom(editor.getBody())},getIsRoot=function(editor){return function(element){return eq(element,getBody$1(editor))}},ltr$1={isRtl:constant(!1)},rtl$1={isRtl:constant(!0)},Direction={directionAt:function(element){return"rtl"===function(element){return"rtl"===get$2(element,"direction")?"rtl":"ltr"}(element)?rtl$1:ltr$1}},defaultStyles={"border-collapse":"collapse",width:"100%"},defaultAttributes={border:"1"},hasTabNavigation=function(editor){return editor.getParam("table_tab_navigation",!0,"boolean")},getCloneElements=function(editor){var cloneElements=editor.getParam("table_clone_elements");return isString(cloneElements)?Option.some(cloneElements.split(/[ ,]/)):Array.isArray(cloneElements)?Option.some(cloneElements):Option.none()},fireTableSelectionChange=function(editor,cells,start,finish,otherCells){editor.fire("TableSelectionChange",{cells:cells,start:start,finish:finish,otherCells:otherCells})},fireTableSelectionClear=function(editor){editor.fire("TableSelectionClear")},point=Immutable("element","offset"),scan=(Immutable("element","deltaOffset"),Immutable("element","start","finish"),Immutable("begin","end"),Immutable("element","text"),function(universe,element,direction){return universe.property().isText(element)&&0===universe.property().getText(element).trim().length||universe.property().isComment(element)?direction(element).bind(function(elem){return scan(universe,elem,direction).orThunk(function(){return Option.some(elem)})}):Option.none()}),freefallRtl=function(universe,element){var candidate=scan(universe,element,universe.query().prevSibling).getOr(element);if(universe.property().isText(candidate))return point(candidate,toEnd(universe,candidate));var children=universe.property().children(candidate);return 0<children.length?freefallRtl(universe,children[children.length-1]):point(candidate,toEnd(universe,candidate))},freefallRtl$1=freefallRtl,universe$2=DomUniverse(),TableActions=function(editor,lazyWire){function isTableBody(editor){return"table"===name(getBody$1(editor))}function execute(operation,guard,mutate,lazyWire){return function(table,target){removeDataStyle(table);var wire=lazyWire(),doc=Element.fromDom(editor.getDoc()),direction=TableDirection(Direction.directionAt),generators=TableFill.cellOperations(mutate,doc,cloneFormats);return guard(table)?operation(wire,table,target,generators,direction).bind(function(result){return each(result.newRows(),function(row){fireNewRow(editor,row.dom())}),each(result.newCells(),function(cell){fireNewCell(editor,cell.dom())}),result.cursor().map(function(cell){var des=function(element){return freefallRtl$1(universe$2,element)}(cell),rng=editor.dom.createRng();return rng.setStart(des.element().dom(),des.offset()),rng.setEnd(des.element().dom(),des.offset()),rng})}):Option.none()}}var cloneFormats=getCloneElements(editor);return{deleteRow:execute(TableOperations.eraseRows,function(table){var size=TableGridSize_getGridSize(table);return!1===isTableBody(editor)||1<size.rows()},noop,lazyWire),deleteColumn:execute(TableOperations.eraseColumns,function(table){var size=TableGridSize_getGridSize(table);return!1===isTableBody(editor)||1<size.columns()},noop,lazyWire),insertRowsBefore:execute(TableOperations.insertRowsBefore,always,noop,lazyWire),insertRowsAfter:execute(TableOperations.insertRowsAfter,always,noop,lazyWire),insertColumnsBefore:execute(TableOperations.insertColumnsBefore,always,CellMutations_halve,lazyWire),insertColumnsAfter:execute(TableOperations.insertColumnsAfter,always,CellMutations_halve,lazyWire),mergeCells:execute(TableOperations.mergeCells,always,noop,lazyWire),unmergeCells:execute(TableOperations.unmergeCells,always,noop,lazyWire),pasteRowsBefore:execute(TableOperations.pasteRowsBefore,always,noop,lazyWire),pasteRowsAfter:execute(TableOperations.pasteRowsAfter,always,noop,lazyWire),pasteCells:execute(TableOperations.pasteCells,always,noop,lazyWire)}},CopyRows_copyRows=function(table,target,generators){var list=DetailsList_fromTable(table),house=Warehouse.generate(list);return onCells(house,target).map(function(selectedCells){var slicedGrid=Transitions_toGrid(house,generators,!1).slice(selectedCells[0].row(),selectedCells[selectedCells.length-1].row()+selectedCells[selectedCells.length-1].rowspan()),slicedDetails=toDetailList(slicedGrid,generators);return Redraw_copy(slicedDetails)})},global$1=tinymce.util.Tools.resolve("tinymce.util.Tools"),Styles$1_applyAlign=function(editor,elm,name){name&&editor.formatter.apply("align"+name,{},elm)},Styles$1_applyVAlign=function(editor,elm,name){name&&editor.formatter.apply("valign"+name,{},elm)},Styles$1_unApplyAlign=function(editor,elm){global$1.each("left center right".split(" "),function(name){editor.formatter.remove("align"+name,{},elm)})},Styles$1_unApplyVAlign=function(editor,elm){global$1.each("top middle bottom".split(" "),function(name){editor.formatter.remove("valign"+name,{},elm)})},Styles$1_getTDTHOverallStyle=function(dom,elm,name){var firstChildStyle;return firstChildStyle=function(firstChildStyle,elms){for(var i=0;i<elms.length;i++){var currentStyle=dom.getStyle(elms[i],name);if(void 0===firstChildStyle&&(firstChildStyle=currentStyle),firstChildStyle!==currentStyle)return""}return firstChildStyle}(firstChildStyle,dom.select("td,th",elm))},getHAlignment=curry(getAlignment,"left center right"),getVAlignment=curry(getAlignment,"top middle bottom"),Helpers_buildListItems=function(inputList,itemCallback,startItems){var appendItems=function(values,output){return output=output||[],global$1.each(values,function(item){var menuItem={text:item.text||item.title};item.menu?menuItem.menu=appendItems(item.menu):(menuItem.value=item.value,itemCallback&&itemCallback(menuItem)),output.push(menuItem)}),output};return appendItems(inputList,startItems||[])},Helpers_getSharedValues=function(data){var baseData=data[0],comparisonData=data.slice(1),keys$1=keys(baseData);return each(comparisonData,function(items){each(keys$1,function(key){each$1(items,function(itemValue,itemKey){var comparisonValue=baseData[key];""!==comparisonValue&&key===itemKey&&comparisonValue!==itemValue&&(baseData[key]="")})})}),baseData},Helpers_getAdvancedTab=function(dialogName){var advTabItems=[{name:"borderstyle",type:"selectbox",label:"Border style",items:[{text:"Select...",value:""},{text:"Solid",value:"solid"},{text:"Dotted",value:"dotted"},{text:"Dashed",value:"dashed"},{text:"Double",value:"double"},{text:"Groove",value:"groove"},{text:"Ridge",value:"ridge"},{text:"Inset",value:"inset"},{text:"Outset",value:"outset"},{text:"None",value:"none"},{text:"Hidden",value:"hidden"}]},{name:"bordercolor",type:"colorinput",label:"Border color"},{name:"backgroundcolor",type:"colorinput",label:"Background color"}];return{title:"Advanced",name:"advanced",items:"cell"===dialogName?[{name:"borderwidth",type:"input",label:"Border width"}].concat(advTabItems):advTabItems}},Helpers_extractDataFromTableElement=function(editor,elm,hasAdvTableTab){var dom=editor.dom;return __assign(__assign({width:dom.getStyle(elm,"width")||dom.getAttrib(elm,"width"),height:dom.getStyle(elm,"height")||dom.getAttrib(elm,"height"),cellspacing:dom.getStyle(elm,"border-spacing")||dom.getAttrib(elm,"cellspacing"),cellpadding:dom.getAttrib(elm,"cellpadding")||Styles$1_getTDTHOverallStyle(editor.dom,elm,"padding"),border:function(dom,elm){var optBorderWidth=getRaw(Element.fromDom(elm),"border-width");return shouldStyleWithCss(editor)&&optBorderWidth.isSome()?optBorderWidth.getOr(""):dom.getAttrib(elm,"border")||Styles$1_getTDTHOverallStyle(editor.dom,elm,"border-width")||Styles$1_getTDTHOverallStyle(editor.dom,elm,"border")}(dom,elm),caption:!!dom.select("caption",elm)[0],class:dom.getAttrib(elm,"class","")},getHAlignment("align","align",editor,elm)),hasAdvTableTab?extractAdvancedStyles(dom,elm):{})},Helpers_extractDataFromRowElement=function(editor,elm,hasAdvancedRowTab){var dom=editor.dom;return __assign(__assign({height:dom.getStyle(elm,"height")||dom.getAttrib(elm,"height"),scope:dom.getAttrib(elm,"scope"),class:dom.getAttrib(elm,"class",""),align:"",type:elm.parentNode.nodeName.toLowerCase()},getHAlignment("align","align",editor,elm)),hasAdvancedRowTab?extractAdvancedStyles(dom,elm):{})},Helpers_extractDataFromCellElement=function(editor,elm,hasAdvancedCellTab){var dom=editor.dom;return __assign(__assign(__assign({width:dom.getStyle(elm,"width")||dom.getAttrib(elm,"width"),height:dom.getStyle(elm,"height")||dom.getAttrib(elm,"height"),scope:dom.getAttrib(elm,"scope"),celltype:elm.nodeName.toLowerCase(),class:dom.getAttrib(elm,"class","")},getHAlignment("align","halign",editor,elm)),getVAlignment("valign","valign",editor,elm)),hasAdvancedCellTab?extractAdvancedStyles(dom,elm):{})},Helpers_extractDataFromSettings=function(editor,hasAdvTableTab){var spacing,padding,borderWidth,style=getDefaultStyles(editor),attrs=getDefaultAttributes(editor),dom=editor.dom,advStyle=hasAdvTableTab?function(dom){function rgbToHex(value){return startsWith(value,"rgb")?dom.toHex(value):value}var borderStyle=get(style,"border-style").getOr(""),borderColor=get(style,"border-color").getOr(""),bgColor=get(style,"background-color").getOr("");return{borderstyle:borderStyle,bordercolor:rgbToHex(borderColor),backgroundcolor:rgbToHex(bgColor)}}(dom):{};return __assign(__assign(__assign(__assign(__assign(__assign({},{height:"",width:"100%",cellspacing:"",cellpadding:"",caption:!1,class:"",align:"",border:""}),style),attrs),advStyle),(borderWidth=style["border-width"],shouldStyleWithCss(editor)&&borderWidth?{border:borderWidth}:get(attrs,"border").fold(function(){return{}},function(border){return{border:border}}))),(spacing=get(style,"border-spacing").or(get(attrs,"cellspacing")).fold(function(){return{}},function(cellspacing){return{cellspacing:cellspacing}}),padding=get(style,"border-padding").or(get(attrs,"cellpadding")).fold(function(){return{}},function(cellpadding){return{cellpadding:cellpadding}}),__assign(__assign({},spacing),padding)))},children$3=[{name:"width",type:"input",label:"Width"},{name:"height",type:"input",label:"Height"},{name:"celltype",type:"selectbox",label:"Cell type",items:[{text:"Cell",value:"td"},{text:"Header cell",value:"th"}]},{name:"scope",type:"selectbox",label:"Scope",items:[{text:"None",value:""},{text:"Row",value:"row"},{text:"Column",value:"col"},{text:"Row group",value:"rowgroup"},{text:"Column group",value:"colgroup"}]},{name:"halign",type:"selectbox",label:"H Align",items:[{text:"None",value:""},{text:"Left",value:"left"},{text:"Center",value:"center"},{text:"Right",value:"right"}]},{name:"valign",type:"selectbox",label:"V Align",items:[{text:"None",value:""},{text:"Top",value:"top"},{text:"Middle",value:"middle"},{text:"Bottom",value:"bottom"}]}],CellDialogGeneralTab_getItems=function(editor){return function(editor){var rowClassList=function(editor){return editor.getParam("table_cell_class_list",[],"array")}(editor),classes=Helpers_buildListItems(rowClassList,function(item){item.value&&(item.textStyle=function(){return editor.formatter.getCssText({block:"tr",classes:[item.value]})})});return 0<rowClassList.length?Option.some({name:"class",type:"selectbox",label:"Class",items:classes}):Option.none()}(editor).fold(function(){return children$3},function(classlist){return children$3.concat(classlist)})},DomModifier={normal:function(dom,node){return{setAttrib:function(attr,value){dom.setAttrib(node,attr,value)},setStyle:function(prop,value){dom.setStyle(node,prop,value)}}},ifTruthy:function(dom,node){return{setAttrib:function(attr,value){value&&dom.setAttrib(node,attr,value)},setStyle:function(prop,value){value&&dom.setStyle(node,prop,value)}}}},CellDialog_open=function(editor){var cellElm,cells=[];if(cells=editor.dom.select("td[data-mce-selected],th[data-mce-selected]"),cellElm=editor.dom.getParent(editor.selection.getStart(),"td,th"),!cells.length&&cellElm&&cells.push(cellElm),cellElm=cellElm||cells[0]){var cellsData=global$1.map(cells,function(cellElm){return Helpers_extractDataFromCellElement(editor,cellElm,hasAdvancedCellTab(editor))}),data=Helpers_getSharedValues(cellsData),dialogTabPanel={type:"tabpanel",tabs:[{title:"General",name:"general",items:CellDialogGeneralTab_getItems(editor)},Helpers_getAdvancedTab("cell")]},dialogPanel={type:"panel",items:[{type:"grid",columns:2,items:CellDialogGeneralTab_getItems(editor)}]};editor.windowManager.open({title:"Cell Properties",size:"normal",body:hasAdvancedCellTab(editor)?dialogTabPanel:dialogPanel,buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"save",text:"Save",primary:!0}],initialData:data,onSubmit:curry(onSubmitCellForm,editor,cells)})}},formChildren=[{type:"selectbox",name:"type",label:"Row type",items:[{text:"Header",value:"thead"},{text:"Body",value:"tbody"},{text:"Footer",value:"tfoot"}]},{type:"selectbox",name:"align",label:"Alignment",items:[{text:"None",value:""},{text:"Left",value:"left"},{text:"Center",value:"center"},{text:"Right",value:"right"}]},{label:"Height",name:"height",type:"input"}],RowDialogGeneralTab_getItems=function(editor){return function(editor){var rowClassList=function(editor){return editor.getParam("table_row_class_list",[],"array")}(editor),classes=Helpers_buildListItems(rowClassList,function(item){item.value&&(item.textStyle=function(){return editor.formatter.getCssText({block:"tr",classes:[item.value]})})});return 0<rowClassList.length?Option.some({name:"class",type:"selectbox",label:"Class",items:classes}):Option.none()}(editor).fold(function(){return formChildren},function(classes){return formChildren.concat(classes)})},RowDialog_open=function(editor){var tableElm,cellElm,dom=editor.dom,rows=[];if((tableElm=dom.getParent(editor.selection.getStart(),"table"))&&(cellElm=dom.getParent(editor.selection.getStart(),"td,th"),global$1.each(tableElm.rows,function(row){global$1.each(row.cells,function(cell){if((dom.getAttrib(cell,"data-mce-selected")||cell===cellElm)&&rows.indexOf(row)<0)return rows.push(row),!1})}),rows[0])){var rowsData=global$1.map(rows,function(rowElm){return Helpers_extractDataFromRowElement(editor,rowElm,hasAdvancedRowTab(editor))}),data=Helpers_getSharedValues(rowsData),dialogTabPanel={type:"tabpanel",tabs:[{title:"General",name:"general",items:RowDialogGeneralTab_getItems(editor)},Helpers_getAdvancedTab("row")]},dialogPanel={type:"panel",items:[{type:"grid",columns:2,items:RowDialogGeneralTab_getItems(editor)}]};editor.windowManager.open({title:"Row Properties",size:"normal",body:hasAdvancedRowTab(editor)?dialogTabPanel:dialogPanel,buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"save",text:"Save",primary:!0}],initialData:data,onSubmit:curry(onSubmitRowForm,editor,rows,data)})}},global$2=tinymce.util.Tools.resolve("tinymce.Env"),DefaultRenderOptions={styles:{"border-collapse":"collapse",width:"100%"},attributes:{border:"1"},percentages:!0},InsertTable_insert=function(editor,columns,rows){var defaultStyles=getDefaultStyles(editor),options={styles:defaultStyles,attributes:getDefaultAttributes(editor),percentages:function(width){return isString(width)&&-1!==width.indexOf("%")}(defaultStyles.width)&&!isPixelsForced(editor)},table=render$1(rows,columns,0,0,options);set(table,"data-mce-id","__mce");var html=function(element){var container=Element.fromTag("div"),clone=Element.fromDom(element.dom().cloneNode(!0));return append(container,clone),function(element){return element.dom().innerHTML}(container)}(table);return editor.insertContent(html),descendant$1(getBody$1(editor),'table[data-mce-id="__mce"]').map(function(table){return isPixelsForced(editor)&&set$1(table,"width",get$2(table,"width")),remove(table,"data-mce-id"),function(editor,table){each(descendants$1(table,"tr"),function(row){fireNewRow(editor,row.dom()),each(descendants$1(row,"th,td"),function(cell){fireNewCell(editor,cell.dom())})})}(editor,table),function(editor,tableElm){descendant$1(tableElm,"td,th").each(curry(placeCaretInCell,editor))}(editor,table),table.dom()}).getOr(null)},TableDialogGeneralTab_getItems=function(editor,hasClasses,insertNewTable){var rowColCountItems=insertNewTable?[{type:"input",name:"cols",label:"Cols",inputMode:"numeric"},{type:"input",name:"rows",label:"Rows",inputMode:"numeric"}]:[],appearanceItems=function(editor){return editor.getParam("table_appearance_options",!0,"boolean")}(editor)?[{type:"input",name:"cellspacing",label:"Cell spacing",inputMode:"numeric"},{type:"input",name:"cellpadding",label:"Cell padding",inputMode:"numeric"},{type:"input",name:"border",label:"Border width"},{type:"label",label:"Caption",items:[{type:"checkbox",name:"caption",label:"Show caption"}]}]:[],classListItem=hasClasses?[{type:"selectbox",name:"class",label:"Class",items:Helpers_buildListItems(getTableClassList(editor),function(item){item.value&&(item.textStyle=function(){return editor.formatter.getCssText({block:"table",classes:[item.value]})})})}]:[];return rowColCountItems.concat([{type:"input",name:"width",label:"Width"},{type:"input",name:"height",label:"Height"}]).concat(appearanceItems).concat([{type:"selectbox",name:"align",label:"Alignment",items:[{text:"None",value:""},{text:"Left",value:"left"},{text:"Center",value:"center"},{text:"Right",value:"right"}]}]).concat(classListItem)},styleTDTH=function(dom,elm,name,value){if("TD"===elm.tagName||"TH"===elm.tagName)isString(name)?dom.setStyle(elm,name,value):dom.setStyle(elm,name);else if(elm.children)for(var i=0;i<elm.children.length;i++)styleTDTH(dom,elm.children[i],name,value)},TableDialog_open=function(editor,insertNewTable){var tableElm,dom=editor.dom,data=Helpers_extractDataFromSettings(editor,hasAdvancedTableTab(editor));!1===insertNewTable?(tableElm=dom.getParent(editor.selection.getStart(),"table"))?data=Helpers_extractDataFromTableElement(editor,tableElm,hasAdvancedTableTab(editor)):hasAdvancedTableTab(editor)&&(data.borderstyle="",data.bordercolor="",data.backgroundcolor=""):(data.cols="1",data.rows="1",hasAdvancedTableTab(editor)&&(data.borderstyle="",data.bordercolor="",data.backgroundcolor=""));var hasClasses=0<getTableClassList(editor).length;hasClasses&&data.class&&(data.class=data.class.replace(/\s*mce\-item\-table\s*/g,""));var generalPanel={type:"grid",columns:2,items:TableDialogGeneralTab_getItems(editor,hasClasses,insertNewTable)},dialogBody=hasAdvancedTableTab(editor)?{type:"tabpanel",tabs:[{title:"General",name:"general",items:[generalPanel]},Helpers_getAdvancedTab("table")]}:{type:"panel",items:[generalPanel]};editor.windowManager.open({title:"Table Properties",size:"normal",body:dialogBody,onSubmit:curry(onSubmitTableForm,editor,tableElm),buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"save",text:"Save",primary:!0}],initialData:data})},getSelectionStartCell=getSelectionStartFromSelector("th,td"),getSelectionStartCellOrCaption=getSelectionStartFromSelector("th,td,caption"),each$3=global$1.each,Commands={registerCommands:function(editor,actions,cellSelection,selections,clipboardRows){function getTableFromCell(cell){return TableLookup.table(cell,isRoot)}function getSize(table){return{width:getPixelWidth$1(table.dom()),height:getPixelWidth$1(table.dom())}}function actOnSelection(execute){getSelectionStartCell(editor).each(function(cell){getTableFromCell(cell).each(function(table){var targets=TableTargets.forMenu(selections,table,cell),beforeSize=getSize(table);execute(table,targets).each(function(rng){!function(editor,oldSize,table){var newSize=getSize(table);oldSize.width===newSize.width&&oldSize.height===newSize.height||(fireObjectResizeStart(editor,table.dom(),oldSize.width,oldSize.height),fireObjectResized(editor,table.dom(),newSize.width,newSize.height))}(editor,beforeSize,table),editor.selection.setRng(rng),editor.focus(),cellSelection.clear(table),removeDataStyle(table)})})})}function copyRowSelection(execute){return getSelectionStartCell(editor).map(function(cell){return getTableFromCell(cell).bind(function(table){var doc=Element.fromDom(editor.getDoc()),targets=TableTargets.forMenu(selections,table,cell),generators=TableFill.cellOperations(noop,doc,Option.none());return CopyRows_copyRows(table,targets,generators)})})}function pasteOnSelection(execute){clipboardRows.get().each(function(rows){var clonedRows=map(rows,function(row){return deep(row)});getSelectionStartCell(editor).each(function(cell){getTableFromCell(cell).each(function(table){var doc=Element.fromDom(editor.getDoc()),generators=TableFill.paste(doc),targets=TableTargets.pasteRows(selections,table,cell,clonedRows,generators);execute(table,targets).each(function(rng){editor.selection.setRng(rng),editor.focus(),cellSelection.clear(table)})})})})}var isRoot=getIsRoot(editor);each$3({mceTableSplitCells:function(){actOnSelection(actions.unmergeCells)},mceTableMergeCells:function(){actOnSelection(actions.mergeCells)},mceTableInsertRowBefore:function(){actOnSelection(actions.insertRowsBefore)},mceTableInsertRowAfter:function(){actOnSelection(actions.insertRowsAfter)},mceTableInsertColBefore:function(){actOnSelection(actions.insertColumnsBefore)},mceTableInsertColAfter:function(){actOnSelection(actions.insertColumnsAfter)},mceTableDeleteCol:function(){actOnSelection(actions.deleteColumn)},mceTableDeleteRow:function(){actOnSelection(actions.deleteRow)},mceTableCutRow:function(grid){copyRowSelection().each(function(selection){clipboardRows.set(selection),actOnSelection(actions.deleteRow)})},mceTableCopyRow:function(grid){copyRowSelection().each(function(selection){clipboardRows.set(selection)})},mceTablePasteRowBefore:function(grid){pasteOnSelection(actions.pasteRowsBefore)},mceTablePasteRowAfter:function(grid){pasteOnSelection(actions.pasteRowsAfter)},mceTableDelete:function(){getSelectionStartCellOrCaption(editor).each(function(cellOrCaption){TableLookup.table(cellOrCaption,isRoot).filter(not(isRoot)).each(function(table){var cursor=Element.fromText("");if(after(table,cursor),remove$2(table),editor.dom.isEmpty(editor.getBody()))editor.setContent(""),editor.selection.setCursorLocation();else{var rng=editor.dom.createRng();rng.setStart(cursor.dom(),0),rng.setEnd(cursor.dom(),0),editor.selection.setRng(rng),editor.nodeChanged()}})})}},function(func,name){editor.addCommand(name,func)}),each$3({mceInsertTable:curry(TableDialog_open,editor,!0),mceTableProps:curry(TableDialog_open,editor,!1),mceTableRowProps:curry(RowDialog_open,editor),mceTableCellProps:curry(CellDialog_open,editor)},function(func,name){editor.addCommand(name,function(){func()})})}},ResizeWire_only=function(element){var parent=Option.from(element.dom().documentElement).map(Element.fromDom).getOr(element);return{parent:constant(parent),view:constant(element),origin:constant(Position(0,0))}},ResizeWire_body=function(editable,chrome){return{parent:constant(chrome),view:constant(editable),origin:constant(Position(0,0))}},Event=function(fields){var struct=Immutable.apply(null,fields),handlers=[];return{bind:function(handler){if(void 0===handler)throw new Error("Event bind error: undefined handler");handlers.push(handler)},unbind:function(handler){handlers=filter(handlers,function(h){return h!==handler})},trigger:function(){for(var args=[],_i=0;_i<arguments.length;_i++)args[_i]=arguments[_i];var event=struct.apply(null,args);each(handlers,function(handler){handler(event)})}}},Events={create:function(typeDefs){return{registry:map$1(typeDefs,function(event){return{bind:event.bind,unbind:event.unbind}}),trigger:map$1(typeDefs,function(event){return event.trigger})}}},unbind=function(element,event,handler,useCapture){element.dom().removeEventListener(event,handler,useCapture)},filter$1=constant(!0),fromRawEvent$1=fromRawEvent,Styles$2={resolve:css("ephox-dragster").resolve},DragMode=exactly(["compare","extract","mutate","sink"]),DragSink=exactly(["element","start","stop","destroy"]),DragApi=exactly(["forceDrop","drop","move","delayDrop"]),MouseDrag=DragMode({compare:function(old,nu){return Position(nu.left()-old.left(),nu.top()-old.top())},extract:function(event){return Option.some(Position(event.x(),event.y()))},sink:function(dragApi,settings){var blocker=function(options){var settings=__assign({layerClass:Styles$2.resolve("blocker")},options),div=Element.fromTag("div");set(div,"role","presentation"),setAll$1(div,{position:"fixed",left:"0px",top:"0px",width:"100%",height:"100%"}),add$2(div,Styles$2.resolve("blocker")),add$2(div,settings.layerClass);return{element:function(){return div},destroy:function(){remove$2(div)}}}(settings),mdown=bind$2(blocker.element(),"mousedown",dragApi.forceDrop),mup=bind$2(blocker.element(),"mouseup",dragApi.drop),mmove=bind$2(blocker.element(),"mousemove",dragApi.move),mout=bind$2(blocker.element(),"mouseout",dragApi.delayDrop);return DragSink({element:blocker.element,start:function(parent){append(parent,blocker.element())},stop:function(){remove$2(blocker.element())},destroy:function(){blocker.destroy(),mup.unbind(),mmove.unbind(),mout.unbind(),mdown.unbind()}})},mutate:function(mutation,info){mutation.mutate(info.left(),info.top())}});function InDrag(){var previous=Option.none(),events=Events.create({move:Event(["info"])});return{onEvent:function(event,mode){mode.extract(event).each(function(data){(function(mode,nu){var result=previous.map(function(old){return mode.compare(old,nu)});return previous=Option.some(nu),result})(mode,data).each(function(d){events.trigger.move(d)})})},reset:function(){previous=Option.none()},events:events.registry}}function Movement(){var noDragState={onEvent:noop,reset:noop},inDragState=InDrag(),dragState=noDragState;return{on:function(){dragState.reset(),dragState=inDragState},off:function(){dragState.reset(),dragState=noDragState},isOn:function(){return dragState===inDragState},onEvent:function(event,mode){dragState.onEvent(event,mode)},events:inDragState.events}}function BarMutation(){var events=Events.create({drag:Event(["xDelta","yDelta","target"])}),target=Option.none(),delegate=function(){var events=Events.create({drag:Event(["xDelta","yDelta"])});return{mutate:function(x,y){events.trigger.drag(x,y)},events:events.registry}}();return delegate.events.drag.bind(function(event){target.each(function(t){events.trigger.drag(event.xDelta(),event.yDelta(),t)})}),{assign:function(t){target=Option.some(t)},get:function(){return target},mutate:delegate.mutate,events:events.registry}}function isContentEditableTrue(elm){return"true"===get$1(elm,"contenteditable")}function BarManager(wire,direction,hdirection){function getResizer(element,type){return Option.from(get$1(element,type))}var mutation=BarMutation(),resizing=Dragger_transform(mutation,{}),hoverTable=Option.none();function getDelta(target,dir){return CellUtils.getInt(target,dir)-parseInt(get$1(target,"data-initial-"+dir),10)}function handler(target,dir){events.trigger.startAdjust(),mutation.assign(target),set(target,"data-initial-"+dir,parseInt(get$2(target,dir),10)),add$2(target,resizeBarDragging),set$1(target,"opacity","0.2"),resizing.go(wire.parent())}function isRoot(e){return eq(e,wire.view())}function findClosestEditableTable(target){return closest$1(target,"table",isRoot).filter(function(table){return function(target,isRoot){return closest$1(target,"[contenteditable]",isRoot)}(table,isRoot).exists(isContentEditableTrue)})}mutation.events.drag.bind(function(event){getResizer(event.target(),"data-row").each(function(_dataRow){var currentRow=CellUtils.getInt(event.target(),"top");set$1(event.target(),"top",currentRow+event.yDelta()+"px")}),getResizer(event.target(),"data-column").each(function(_dataCol){var currentCol=CellUtils.getInt(event.target(),"left");set$1(event.target(),"left",currentCol+event.xDelta()+"px")})}),resizing.events.stop.bind(function(){mutation.get().each(function(target){hoverTable.each(function(table){getResizer(target,"data-row").each(function(row){var delta=getDelta(target,"top");remove(target,"data-initial-top"),events.trigger.adjustHeight(table,delta,parseInt(row,10))}),getResizer(target,"data-column").each(function(column){var delta=getDelta(target,"left");remove(target,"data-initial-left"),events.trigger.adjustWidth(table,delta,parseInt(column,10))}),Bars_refresh(wire,table,hdirection,direction)})})});var mousedown=bind$2(wire.parent(),"mousedown",function(event){Bars_isRowBar(event.target())&&handler(event.target(),"top"),Bars_isColBar(event.target())&&handler(event.target(),"left")}),mouseover=bind$2(wire.view(),"mouseover",function(event){findClosestEditableTable(event.target()).fold(function(){inBody(event.target())&&Bars_destroy(wire)},function(table){hoverTable=Option.some(table),Bars_refresh(wire,table,hdirection,direction)})}),events=Events.create({adjustHeight:Event(["table","delta","row"]),adjustWidth:Event(["table","delta","column"]),startAdjust:Event([])});return{destroy:function(){mousedown.unbind(),mouseover.unbind(),resizing.destroy(),Bars_destroy(wire)},refresh:function(tbl){Bars_refresh(wire,tbl,hdirection,direction)},on:resizing.on,off:resizing.off,hideBars:curry(Bars_hide,wire),showBars:curry(Bars_show,wire),events:events.registry}}function calculatePercentageWidth(element,parent){return getPixelWidth$1(element.dom())/getPixelWidth$1(parent.dom())*100+"%"}function detect$4(current,isRoot){return TableLookup.table(current,isRoot).bind(function(table){var all=TableLookup.cells(table);return findIndex(all,function(x){return eq(current,x)}).map(function(ind){return{index:constant(ind),all:constant(all)}})})}function relativeToNative(win,startSitu,finishSitu){var range=win.document.createRange();return function(rng,situ){situ.fold(function(e){rng.setStartBefore(e.dom())},function(e,o){rng.setStart(e.dom(),o)},function(e){rng.setStartAfter(e.dom())})}(range,startSitu),function(rng,situ){situ.fold(function(e){rng.setEndBefore(e.dom())},function(e,o){rng.setEnd(e.dom(),o)},function(e){rng.setEndAfter(e.dom())})}(range,finishSitu),range}function exactToNative(win,start,soffset,finish,foffset){var rng=win.document.createRange();return rng.setStart(start.dom(),soffset),rng.setEnd(finish.dom(),foffset),rng}function toRect(rect){return{left:constant(rect.left),top:constant(rect.top),right:constant(rect.right),bottom:constant(rect.bottom),width:constant(rect.width),height:constant(rect.height)}}function fromRange(win,type,range){return type(Element.fromDom(range.startContainer),range.startOffset,Element.fromDom(range.endContainer),range.endOffset)}function diagnose(win,selection){return function(win,ranges){var rng=ranges.ltr();return rng.collapsed?ranges.rtl().filter(function(rev){return!1===rev.collapsed}).map(function(rev){return adt$4.rtl(Element.fromDom(rev.endContainer),rev.endOffset,Element.fromDom(rev.startContainer),rev.startOffset)}).getOrThunk(function(){return fromRange(0,adt$4.ltr,rng)}):fromRange(0,adt$4.ltr,rng)}(0,function(win,selection){return selection.match({domRange:function(rng){return{ltr:constant(rng),rtl:Option.none}},relative:function(startSitu,finishSitu){return{ltr:cached(function(){return relativeToNative(win,startSitu,finishSitu)}),rtl:cached(function(){return Option.some(relativeToNative(win,finishSitu,startSitu))})}},exact:function(start,soffset,finish,foffset){return{ltr:cached(function(){return exactToNative(win,start,soffset,finish,foffset)}),rtl:cached(function(){return Option.some(exactToNative(win,finish,foffset,start,soffset))})}}})}(win,selection))}function inRect(rect,x,y){return x>=rect.left&&x<=rect.right&&y>=rect.top&&y<=rect.bottom}function locateOffset(doc,textnode,x,y,rect){function rangeForOffset(o){var r=doc.dom().createRange();return r.setStart(textnode.dom(),o),r.collapse(!0),r}var length=get$3(textnode).length,offset=function(rectForOffset,x,y,maxX,length){if(0===length)return 0;if(x===maxX)return length-1;for(var xDelta=maxX,i=1;i<length;i++){var rect=rectForOffset(i),curDeltaX=Math.abs(x-rect.left);if(y<=rect.bottom){if(y<rect.top||xDelta<curDeltaX)return i-1;xDelta=curDeltaX}}return 0}(function(o){return rangeForOffset(o).getBoundingClientRect()},x,y,rect.right,length);return rangeForOffset(offset)}function getCollapseDirection(rect,x){return x-rect.left<rect.right-x}function createCollapsedNode(doc,target,collapseDirection){var r=doc.dom().createRange();return r.selectNode(target.dom()),r.collapse(collapseDirection),r}function locateInElement(doc,node,x){var cursorRange=doc.dom().createRange();cursorRange.selectNode(node.dom());var rect=cursorRange.getBoundingClientRect(),collapseDirection=getCollapseDirection(rect,x);return(!0===collapseDirection?first:last$1)(node).map(function(target){return createCollapsedNode(doc,target,collapseDirection)})}function locateInEmpty(doc,node,x){var rect=node.dom().getBoundingClientRect(),collapseDirection=getCollapseDirection(rect,x);return Option.some(createCollapsedNode(doc,node,collapseDirection))}function searchTextNodes(doc,node,x,y){var r=doc.dom().createRange();r.selectNode(node.dom());var rect=r.getBoundingClientRect();return function(doc,node,x,y){var r=doc.dom().createRange();r.selectNode(node.dom());var rect=r.getBoundingClientRect(),boundedX=Math.max(rect.left,Math.min(rect.right,x)),boundedY=Math.max(rect.top,Math.min(rect.bottom,y));return locateNode(doc,node,boundedX,boundedY)}(doc,node,Math.max(rect.left,Math.min(rect.right,x)),Math.max(rect.top,Math.min(rect.bottom,y)))}function beforeSpecial(element,offset){var name$1=name(element);return"input"===name$1?Situ.after(element):contains(["br","img"],name$1)?0===offset?Situ.before(element):Situ.after(element):Situ.on(element,offset)}function preprocessRelative(startSitu,finishSitu){var start=startSitu.fold(Situ.before,beforeSpecial,Situ.after),finish=finishSitu.fold(Situ.before,beforeSpecial,Situ.after);return Selection.relative(start,finish)}function preprocessExact(start,soffset,finish,foffset){var startSitu=beforeSpecial(start,soffset),finishSitu=beforeSpecial(finish,foffset);return Selection.relative(startSitu,finishSitu)}function after$3(start,soffset,finish,foffset){var r=function(start,soffset,finish,foffset){var rng=owner(start).dom().createRange();return rng.setStart(start.dom(),soffset),rng.setEnd(finish.dom(),foffset),rng}(start,soffset,finish,foffset),same=eq(start,finish)&&soffset===foffset;return r.collapsed&&!same}function doSetNativeRange(win,rng){Option.from(win.getSelection()).each(function(selection){selection.removeAllRanges(),selection.addRange(rng)})}function doSetRange(win,start,soffset,finish,foffset){var rng=exactToNative(win,start,soffset,finish,foffset);doSetNativeRange(win,rng)}function setRangeFromRelative(win,relative){return diagnose(win,relative).match({ltr:function(start,soffset,finish,foffset){doSetRange(win,start,soffset,finish,foffset)},rtl:function(start,soffset,finish,foffset){var selection=win.getSelection();if(selection.setBaseAndExtent)selection.setBaseAndExtent(start.dom(),soffset,finish.dom(),foffset);else if(selection.extend)try{!function(win,selection,start,soffset,finish,foffset){selection.collapse(start.dom(),soffset),selection.extend(finish.dom(),foffset)}(0,selection,start,soffset,finish,foffset)}catch(e){doSetRange(win,finish,foffset,start,soffset)}else doSetRange(win,finish,foffset,start,soffset)}})}function setExact(win,start,soffset,finish,foffset){var relative=preprocessExact(start,soffset,finish,foffset);setRangeFromRelative(win,relative)}function setRelative(win,startSitu,finishSitu){var relative=preprocessRelative(startSitu,finishSitu);setRangeFromRelative(win,relative)}function toNative(selection){function getDomRange(start,soffset,finish,foffset){return exactToNative(win,start,soffset,finish,foffset)}var win=Selection.getWin(selection).dom(),filtered=function(selection){return selection.match({domRange:function(rng){var start=Element.fromDom(rng.startContainer),finish=Element.fromDom(rng.endContainer);return preprocessExact(start,rng.startOffset,finish,rng.endOffset)},relative:preprocessRelative,exact:preprocessExact})}(selection);return diagnose(win,filtered).match({ltr:getDomRange,rtl:getDomRange})}function doGetExact(selection){var anchor=Element.fromDom(selection.anchorNode),focus=Element.fromDom(selection.focusNode);return after$3(anchor,selection.anchorOffset,focus,selection.focusOffset)?Option.some(SimRange.create(anchor,selection.anchorOffset,focus,selection.focusOffset)):function(selection){if(0<selection.rangeCount){var firstRng=selection.getRangeAt(0),lastRng=selection.getRangeAt(selection.rangeCount-1);return Option.some(SimRange.create(Element.fromDom(firstRng.startContainer),firstRng.startOffset,Element.fromDom(lastRng.endContainer),lastRng.endOffset))}return Option.none()}(selection)}function setToElement(win,element){var rng=function(win,element){var rng=win.document.createRange();return selectNodeContentsUsing(rng,element),rng}(win,element);doSetNativeRange(win,rng)}function get$a(win){return function(win){return Option.from(win.getSelection()).filter(function(sel){return 0<sel.rangeCount}).bind(doGetExact)}(win).map(function(range){return Selection.exact(range.start(),range.soffset(),range.finish(),range.foffset())})}function getFirstRect$1(win,selection){return function(rng){var rects=rng.getClientRects(),rect=0<rects.length?rects[0]:rng.getBoundingClientRect();return 0<rect.width||0<rect.height?Option.some(rect).map(toRect):Option.none()}(asLtrRange(win,selection))}function getAtPoint(win,x,y){return function(win,x,y){var doc=Element.fromDom(win.document);return availableSearch(doc,x,y).map(function(rng){return SimRange.create(Element.fromDom(rng.startContainer),rng.startOffset,Element.fromDom(rng.endContainer),rng.endOffset)})}(win,x,y)}function forward(editor,isRoot,cell,lazyWire){return go(editor,isRoot,CellNavigation_next(cell),lazyWire)}function backward(editor,isRoot,cell,lazyWire){return go(editor,isRoot,CellNavigation_prev(cell),lazyWire)}function getCellFirstCursorPosition(editor,cell){var selection=Selection.exact(cell,0,cell,0);return toNative(selection)}function getNewRowCursorPosition(editor,table){return function(xs){return 0===xs.length?Option.none():Option.some(xs[xs.length-1])}(descendants$1(table,"tr")).bind(function(last){return descendant$1(last,"td,th").map(function(first){return getCellFirstCursorPosition(0,first)})})}function backtrack(universe,item,_direction,transition){return void 0===transition&&(transition=sidestep),universe.property().parent(item).map(function(p){return traverse(p,transition)})}function isLeaf(universe){return function(element){return 0===universe.property().children(element).length}}function before$4(element,isRoot){return function(universe,item,isRoot){return seekLeft(universe,item,isLeaf(universe),isRoot)}(universe$3,element,isRoot)}function after$5(element,isRoot){return function(universe,item,isRoot){return seekRight(universe,item,isLeaf(universe),isRoot)}(universe$3,element,isRoot)}function isRow(elem){return closest$1(elem,"tr")}function isBr(elem){return"br"===name(elem)}function handleParent(isRoot,element,offset,direction){return function(element,offset){return child(element,offset).filter(isBr).orThunk(function(){return child(element,offset-1).filter(isBr)})}(element,offset).bind(function(br){return direction.traverse(br).fold(function(){return gatherer(br,direction.gather,isRoot).map(direction.relative)},function(adjacent){return function(element){return parent(element).bind(function(parent){var children$1=children(parent);return indexOf(children$1,element).map(function(index){return inParent(parent,children$1,element,index)})})}(adjacent).map(function(info){return Situ.on(info.parent(),info.index())})})})}function toCaret(rect){return Carets.nu({left:rect.left,top:rect.top,right:rect.right,bottom:rect.bottom})}function getElemBox(bridge,element){return Option.some(bridge.getRect(element))}function inOutsideBlock(bridge,element,caret){return function(scope,predicate,isRoot){return ClosestOrAncestor(function(s,test){return test(s)},ancestor,scope,predicate,isRoot)}(element,DomStructure_isBlock).fold(constant(!1),function(cell){return Rectangles_getEntireBox(bridge,cell).exists(function(box){return function(caret,box){return caret.left()<box.left()||Math.abs(box.right()-caret.left())<1||caret.left()>box.right()}(caret,box)})})}function retry(movement,bridge,caret){var moved=movement.move(caret,5),adjusted=adjustTil(bridge,movement,caret,moved,100).getOr(moved);return function(movement,adjusted,bridge){return movement.point(adjusted)>bridge.getInnerHeight()?Option.some(movement.point(adjusted)-bridge.getInnerHeight()):movement.point(adjusted)<0?Option.some(-movement.point(adjusted)):Option.none()}(movement,adjusted,bridge).fold(function(){return bridge.situsFromPoint(adjusted.left(),movement.point(adjusted))},function(delta){return bridge.scrollBy(0,delta),bridge.situsFromPoint(adjusted.left(),movement.point(adjusted)-delta)})}function inSameTable(elem,table){return function(scope,predicate,isRoot){return ancestor(scope,predicate,isRoot).isSome()}(elem,function(e){return parent(e).exists(function(p){return eq(p,table)})})}function simulate(bridge,isRoot,direction,initial,anchor){return closest$1(initial,"td,th",isRoot).bind(function(start){return closest$1(start,"table",isRoot).bind(function(table){return inSameTable(anchor,table)?TableKeys_handle(bridge,isRoot,direction).bind(function(range){return closest$1(range.finish(),"td,th",isRoot).map(function(finish){return{start:constant(start),finish:constant(finish),range:constant(range)}})}):Option.none()})})}function findCell(target,isRoot){return closest$1(target,"td,th",isRoot)}var Dragging_setup=function(mutation,mode,settings){function drop(){sink.stop(),movement.isOn()&&(movement.off(),events.trigger.stop())}var active=!1,events=Events.create({start:Event([]),stop:Event([])}),movement=Movement(),throttledDrop=function(fn,rate){var timer=null;return{cancel:function(){null!==timer&&(domGlobals.clearTimeout(timer),timer=null)},throttle:function(){for(var args=[],_i=0;_i<arguments.length;_i++)args[_i]=arguments[_i];null!==timer&&domGlobals.clearTimeout(timer),timer=domGlobals.setTimeout(function(){fn.apply(null,args),timer=null},rate)}}}(drop,200);movement.events.move.bind(function(event){mode.mutate(mutation,event.info())});function runIfActive(f){return function(){for(var args=[],_i=0;_i<arguments.length;_i++)args[_i]=arguments[_i];active&&f.apply(null,args)}}var sink=mode.sink(DragApi({forceDrop:drop,drop:runIfActive(drop),move:runIfActive(function(event){throttledDrop.cancel(),movement.onEvent(event,mode)}),delayDrop:runIfActive(throttledDrop.throttle)}),settings);return{element:sink.element,go:function(parent){sink.start(parent),movement.on(),events.trigger.start()},on:function(){active=!0},off:function(){active=!1},destroy:function(){sink.destroy()},events:events.registry}},Dragger_transform=function(mutation,settings){void 0===settings&&(settings={});var mode=void 0!==settings.mode?settings.mode:MouseDrag;return Dragging_setup(mutation,mode,settings)},resizeBarDragging=Styles.resolve("resizer-bar-dragging"),TableResize_create=function(wire,vdirection){var hdirection=BarPositions.height,manager=BarManager(wire,vdirection,hdirection),events=Events.create({beforeResize:Event(["table"]),afterResize:Event(["table"]),startDrag:Event([])});return manager.events.adjustHeight.bind(function(event){events.trigger.beforeResize(event.table());var delta=hdirection.delta(event.delta(),event.table());Adjustments_adjustHeight(event.table(),delta,event.row(),hdirection),events.trigger.afterResize(event.table())}),manager.events.startAdjust.bind(function(event){events.trigger.startDrag()}),manager.events.adjustWidth.bind(function(event){events.trigger.beforeResize(event.table());var delta=vdirection.delta(event.delta(),event.table());Adjustments_adjustWidth(event.table(),delta,event.column(),vdirection),events.trigger.afterResize(event.table())}),{on:manager.on,off:manager.off,hideBars:manager.hideBars,showBars:manager.showBars,destroy:manager.destroy,events:events.registry}},TableWire_get=function(editor,container){return editor.inline?ResizeWire_body(getBody$1(editor),function(){var container=Element.fromTag("div");return setAll$1(container,{position:"static",height:"0",width:"0",padding:"0",margin:"0",border:"0"}),append(body(),container),container}()):ResizeWire_only(Element.fromDom(editor.getDoc()))},TableWire_remove=function(editor,wire){editor.inline&&remove$2(wire.parent())},getResizeHandler=function(editor){function isTable(elm){return"TABLE"===elm.nodeName}function getRawWidth(elm){var raw=editor.dom.getStyle(elm,"width")||editor.dom.getAttrib(elm,"width");return Option.from(raw).filter(function(s){return 0<s.length})}function lazyResize(){return resize}var startW,startRawW,selectionRng=Option.none(),resize=Option.none(),wire=Option.none(),percentageBasedSizeRegex=/(\d+(\.\d+)?)%/;return editor.on("init",function(){var direction=TableDirection(Direction.directionAt),rawWire=TableWire_get(editor);if(wire=Option.some(rawWire),function(editor){var objectResizing=editor.getParam("object_resizing",!0);return isString(objectResizing)?"table"===objectResizing:objectResizing}(editor)&&function(editor){return editor.getParam("table_resize_bars",!0,"boolean")}(editor)){var sz=TableResize_create(rawWire,direction);sz.on(),sz.events.startDrag.bind(function(event){selectionRng=Option.some(editor.selection.getRng())}),sz.events.beforeResize.bind(function(event){var rawTable=event.table().dom();fireObjectResizeStart(editor,rawTable,getPixelWidth$1(rawTable),getPixelHeight(rawTable))}),sz.events.afterResize.bind(function(event){var table=event.table(),rawTable=table.dom();removeDataStyle(table),selectionRng.each(function(rng){editor.selection.setRng(rng),editor.focus()}),fireObjectResized(editor,rawTable,getPixelWidth$1(rawTable),getPixelHeight(rawTable)),editor.undoManager.add()}),resize=Option.some(sz)}}),editor.on("ObjectResizeStart",function(e){var targetElm=e.target;if(isTable(targetElm)){var tableHasPercentage=getRawWidth(targetElm).map(function(w){return percentageBasedSizeRegex.test(w)}).getOr(!1);tableHasPercentage&&isPixelsForced(editor)?function(table){set$1(Element.fromDom(table),"width",getPixelWidth$1(table).toString()+"px")}(targetElm):!tableHasPercentage&&function(editor){return!0===editor.getParam("table_responsive_width")}(editor)&&function(rawTable){var table=Element.fromDom(rawTable);parent(table).map(function(parent){return calculatePercentageWidth(table,parent)}).each(function(tablePercentage){set$1(table,"width",tablePercentage),each(descendants$1(table,"tr"),function(tr){each(children(tr),function(td){set$1(td,"width",calculatePercentageWidth(td,tr))})})})}(targetElm),startW=e.width,startRawW=getRawWidth(targetElm).getOr("")}}),editor.on("ObjectResized",function(e){var targetElm=e.target;if(isTable(targetElm)){var table=targetElm;if(percentageBasedSizeRegex.test(startRawW)){var percentW=parseFloat(percentageBasedSizeRegex.exec(startRawW)[1]),targetPercentW=e.width*percentW/startW;editor.dom.setStyle(table,"width",targetPercentW+"%")}else{var newCellSizes_1=[];global$1.each(table.rows,function(row){global$1.each(row.cells,function(cell){var width=editor.dom.getStyle(cell,"width",!0);newCellSizes_1.push({cell:cell,width:width})})}),global$1.each(newCellSizes_1,function(newCellSize){editor.dom.setStyle(newCellSize.cell,"width",newCellSize.width),editor.dom.setAttrib(newCellSize.cell,"width",null)})}}}),editor.on("SwitchMode",function(){lazyResize().each(function(resize){editor.mode.isReadOnly()?resize.hideBars():resize.showBars()})}),{lazyResize:lazyResize,lazyWire:function(){return wire.getOr(ResizeWire_only(Element.fromDom(editor.getBody())))},destroy:function(){resize.each(function(sz){sz.destroy()}),wire.each(function(w){TableWire_remove(editor,w)})}}},adt$1=Adt_generate([{none:["current"]},{first:["current"]},{middle:["current","target"]},{last:["current"]}]),CellLocation=__assign(__assign({},adt$1),{none:function(current){return void 0===current&&(current=void 0),adt$1.none(current)}}),CellNavigation_next=function(current,isRoot){return detect$4(current,isRoot).fold(function(){return CellLocation.none(current)},function(info){return info.index()+1<info.all().length?CellLocation.middle(current,info.all()[info.index()+1]):CellLocation.last(current)})},CellNavigation_prev=function(current,isRoot){return detect$4(current,isRoot).fold(function(){return CellLocation.none()},function(info){return 0<=info.index()-1?CellLocation.middle(current,info.all()[info.index()-1]):CellLocation.first(current)})},SimRange={create:Immutable("start","soffset","finish","foffset")},adt$2=Adt_generate([{before:["element"]},{on:["element","offset"]},{after:["element"]}]),Situ={before:adt$2.before,on:adt$2.on,after:adt$2.after,cata:function(subject,onBefore,onOn,onAfter){return subject.fold(onBefore,onOn,onAfter)},getStart:function(situ){return situ.fold(identity,identity,identity)}},adt$3=Adt_generate([{domRange:["rng"]},{relative:["startSitu","finishSitu"]},{exact:["start","soffset","finish","foffset"]}]),Selection={domRange:adt$3.domRange,relative:adt$3.relative,exact:adt$3.exact,exactFromRange:function(simRange){return adt$3.exact(simRange.start(),simRange.soffset(),simRange.finish(),simRange.foffset())},getWin:function(selection){return function(element){return Element.fromDom(element.dom().ownerDocument.defaultView)}(function(selection){return selection.match({domRange:function(rng){return Element.fromDom(rng.startContainer)},relative:function(startSitu,finishSitu){return Situ.getStart(startSitu)},exact:function(start,soffset,finish,foffset){return start}})}(selection))},range:SimRange.create},selectNodeContentsUsing=function(rng,element){rng.selectNodeContents(element.dom())},adt$4=Adt_generate([{ltr:["start","soffset","finish","foffset"]},{rtl:["start","soffset","finish","foffset"]}]),asLtrRange=function(win,selection){return diagnose(win,selection).match({ltr:function(start,soffset,finish,foffset){var rng=win.document.createRange();return rng.setStart(start.dom(),soffset),rng.setEnd(finish.dom(),foffset),rng},rtl:function(start,soffset,finish,foffset){var rng=win.document.createRange();return rng.setStart(finish.dom(),foffset),rng.setEnd(start.dom(),soffset),rng}})},locateNode=(adt$4.ltr,adt$4.rtl,function(doc,node,x,y){return isText(node)?function(doc,node,x,y){var r=doc.dom().createRange();r.selectNode(node.dom());var rects=r.getClientRects();return findMap(rects,function(rect){return inRect(rect,x,y)?Option.some(rect):Option.none()}).map(function(rect){return locateOffset(doc,node,x,y,rect)})}(doc,node,x,y):function(doc,node,x,y){var r=doc.dom().createRange(),nodes=children(node);return findMap(nodes,function(n){return r.selectNode(n.dom()),inRect(r.getBoundingClientRect(),x,y)?locateNode(doc,n,x,y):Option.none()})}(doc,node,x,y)}),availableSearch=document.caretPositionFromPoint?function(doc,x,y){return Option.from(doc.dom().caretPositionFromPoint(x,y)).bind(function(pos){if(null===pos.offsetNode)return Option.none();var r=doc.dom().createRange();return r.setStart(pos.offsetNode,pos.offset),r.collapse(),Option.some(r)})}:document.caretRangeFromPoint?function(doc,x,y){return Option.from(doc.dom().caretRangeFromPoint(x,y))}:function(doc,x,y){return Element.fromPoint(doc,x,y).bind(function(elem){function fallback(){return function(doc,node,x){return(0===children(node).length?locateInEmpty:locateInElement)(doc,node,x)}(doc,elem,x)}return 0===children(elem).length?fallback():searchTextNodes(doc,elem,x,y).orThunk(fallback)})},global$3=tinymce.util.Tools.resolve("tinymce.util.VK"),go=function(editor,isRoot,cell,actions,lazyWire){return cell.fold(Option.none,Option.none,function(current,next){return first(next).map(function(cell){return getCellFirstCursorPosition(0,cell)})},function(current){return TableLookup.table(current,isRoot).bind(function(table){var targets=TableTargets.noMenu(current);return editor.undoManager.transact(function(){actions.insertRowsAfter(table,targets)}),getNewRowCursorPosition(0,table)})})},rootElements=["table","li","dl"],TabContext={handle:function(event,editor,actions,lazyWire){if(event.keyCode===global$3.TAB){var body_1=getBody$1(editor),isRoot_1=function(element){var name$1=name(element);return eq(element,body_1)||contains(rootElements,name$1)},rng=editor.selection.getRng();if(rng.collapsed){var start=Element.fromDom(rng.startContainer);TableLookup.cell(start,isRoot_1).each(function(cell){event.preventDefault(),(event.shiftKey?backward:forward)(editor,isRoot_1,cell,actions,lazyWire).each(function(range){editor.selection.setRng(range)})})}}}},Response={create:Immutable("selection","kill")},Situs_create=function(start,soffset,finish,foffset){return{start:constant(Situ.on(start,soffset)),finish:constant(Situ.on(finish,foffset))}},Util={convertToRange:function(win,selection){var rng=asLtrRange(win,selection);return SimRange.create(Element.fromDom(rng.startContainer),rng.startOffset,Element.fromDom(rng.endContainer),rng.endOffset)},makeSitus:Situs_create},detect$5=function(container,isRoot,start,finish,selectRange){return eq(start,finish)?Option.none():CellSelection_identify(start,finish,isRoot).bind(function(cellSel){var boxes=cellSel.boxes().getOr([]);return 0<boxes.length?(selectRange(container,boxes,cellSel.start(),cellSel.finish()),Option.some(Response.create(Option.some(Util.makeSitus(start,0,start,getEnd(start))),!0))):Option.none()})},KeySelection={sync:function(container,isRoot,start,soffset,finish,foffset,selectRange){return eq(start,finish)&&soffset===foffset?Option.none():closest$1(start,"td,th",isRoot).bind(function(s){return closest$1(finish,"td,th",isRoot).bind(function(f){return detect$5(container,isRoot,s,f,selectRange)})})},detect:detect$5,update:function(rows,columns,container,selected,annotations){return CellSelection_shiftSelection(selected,rows,columns,annotations.firstSelectedSelector(),annotations.lastSelectedSelector()).map(function(newSels){return annotations.clearBeforeUpdate(container),annotations.selectRange(container,newSels.boxes(),newSels.start(),newSels.finish()),newSels.boxes()})}},traverse=Immutable("item","mode"),sidestep=function(universe,item,direction,transition){return void 0===transition&&(transition=advance),direction.sibling(universe,item).map(function(p){return traverse(p,transition)})},advance=function(universe,item,direction,transition){void 0===transition&&(transition=advance);var children=universe.property().children(item);return direction.first(children).map(function(r){return traverse(r,transition)})},successors=[{current:backtrack,next:sidestep,fallback:Option.none()},{current:sidestep,next:advance,fallback:Option.some(backtrack)},{current:advance,next:advance,fallback:Option.some(sidestep)}],go$1=function(universe,item,mode,direction,rules){return void 0===rules&&(rules=successors),find(rules,function(succ){return succ.current===mode}).bind(function(rule){return rule.current(universe,item,direction,rule.next).orThunk(function(){return rule.fallback.bind(function(fb){return go$1(universe,item,fb,direction)})})})},Walkers_left=function(){return{sibling:function(universe,item){return universe.query().prevSibling(item)},first:function(children){return 0<children.length?Option.some(children[children.length-1]):Option.none()}}},Walkers_right=function(){return{sibling:function(universe,item){return universe.query().nextSibling(item)},first:function(children){return 0<children.length?Option.some(children[0]):Option.none()}}},hone=function(universe,item,predicate,mode,direction,isRoot){return go$1(universe,item,mode,direction).bind(function(n){return isRoot(n.item())?Option.none():predicate(n.item())?Option.some(n.item()):hone(universe,n.item(),predicate,n.mode(),direction,isRoot)})},seekLeft=function(universe,item,predicate,isRoot){return hone(universe,item,predicate,sidestep,Walkers_left(),isRoot)},seekRight=function(universe,item,predicate,isRoot){return hone(universe,item,predicate,sidestep,Walkers_right(),isRoot)},universe$3=DomUniverse(),adt$5=Adt_generate([{none:["message"]},{success:[]},{failedUp:["cell"]},{failedDown:["cell"]}]),BeforeAfter=__assign(__assign({},adt$5),{verify:function(bridge,before,beforeOffset,after,afterOffset,failure,isRoot){return closest$1(after,"td,th",isRoot).bind(function(afterCell){return closest$1(before,"td,th",isRoot).map(function(beforeCell){return eq(afterCell,beforeCell)?eq(after,afterCell)&&getEnd(afterCell)===afterOffset?failure(beforeCell):adt$5.none("in same cell"):DomParent.sharedOne(isRow,[afterCell,beforeCell]).fold(function(){return function(bridge,before,after){var beforeBounds=bridge.getRect(before),afterBounds=bridge.getRect(after);return afterBounds.right>beforeBounds.left&&afterBounds.left<beforeBounds.right}(bridge,beforeCell,afterCell)?adt$5.success():failure(beforeCell)},function(_sharedRow){return failure(beforeCell)})})}).getOr(adt$5.none("default"))},cata:function(subject,onNone,onSuccess,onFailedUp,onFailedDown){return subject.fold(onNone,onSuccess,onFailedUp,onFailedDown)}}),inParent=(Immutable("ancestor","descendants","element","index"),Immutable("parent","children","element","index")),indexOf=function(elements,element){return findIndex(elements,curry(eq,element))},gatherer=function(cand,gather,isRoot){return gather(cand,isRoot).bind(function(target){return isText(target)&&0===get$3(target).trim().length?gatherer(target,gather,isRoot):Option.some(target)})},BrTags_tryBr=function(isRoot,element,offset,direction){return(isBr(element)?function(isRoot,element,direction){return direction.traverse(element).orThunk(function(){return gatherer(element,direction.gather,isRoot)}).map(direction.relative)}(isRoot,element,direction):handleParent(isRoot,element,offset,direction)).map(function(tgt){return{start:constant(tgt),finish:constant(tgt)}})},BrTags_process=function(analysis){return BeforeAfter.cata(analysis,function(message){return Option.none()},function(){return Option.none()},function(cell){return Option.some(point(cell,0))},function(cell){return Option.some(point(cell,getEnd(cell)))})},nu$3=MixedBag(["left","top","right","bottom"],[]),Carets={nu:nu$3,moveUp:function(caret,amount){return nu$3({left:caret.left(),top:caret.top()-amount,right:caret.right(),bottom:caret.bottom()-amount})},moveDown:function(caret,amount){return nu$3({left:caret.left(),top:caret.top()+amount,right:caret.right(),bottom:caret.bottom()+amount})},moveBottomTo:function(caret,bottom){var height=caret.bottom()-caret.top();return nu$3({left:caret.left(),top:bottom-height,right:caret.right(),bottom:bottom})},moveTopTo:function(caret,top){var height=caret.bottom()-caret.top();return nu$3({left:caret.left(),top:top,right:caret.right(),bottom:top+height})},getTop:function(caret){return caret.top()},getBottom:function(caret){return caret.bottom()},translate:function(caret,xDelta,yDelta){return nu$3({left:caret.left()+xDelta,top:caret.top()+yDelta,right:caret.right()+xDelta,bottom:caret.bottom()+yDelta})},toString:function(caret){return"("+caret.left()+", "+caret.top()+") -> ("+caret.right()+", "+caret.bottom()+")"}},Rectangles_getBoxAt=function(bridge,element,offset){return isElement(element)?getElemBox(bridge,element).map(toCaret):isText(element)?function(bridge,element,offset){return 0<=offset&&offset<getEnd(element)?bridge.getRangedRect(element,offset,element,offset+1):0<offset?bridge.getRangedRect(element,offset-1,element,offset):Option.none()}(bridge,element,offset).map(toCaret):Option.none()},Rectangles_getEntireBox=function(bridge,element){return isElement(element)?getElemBox(bridge,element).map(toCaret):isText(element)?bridge.getRangedRect(element,0,element,getEnd(element)).map(toCaret):Option.none()},adt$6=Adt_generate([{none:[]},{retry:["caret"]}]),upMovement={point:Carets.getTop,adjuster:function(bridge,element,guessBox,original,caret){var higherCaret=Carets.moveUp(caret,5);return Math.abs(guessBox.top()-original.top())<1?adt$6.retry(higherCaret):guessBox.bottom()<caret.top()?adt$6.retry(higherCaret):guessBox.bottom()===caret.top()?adt$6.retry(Carets.moveUp(caret,1)):inOutsideBlock(bridge,element,caret)?adt$6.retry(Carets.translate(higherCaret,5,0)):adt$6.none()},move:Carets.moveUp,gather:before$4},downMovement={point:Carets.getBottom,adjuster:function(bridge,element,guessBox,original,caret){var lowerCaret=Carets.moveDown(caret,5);return Math.abs(guessBox.bottom()-original.bottom())<1?adt$6.retry(lowerCaret):guessBox.top()>caret.bottom()?adt$6.retry(lowerCaret):guessBox.top()===caret.bottom()?adt$6.retry(Carets.moveDown(caret,1)):inOutsideBlock(bridge,element,caret)?adt$6.retry(Carets.translate(lowerCaret,5,0)):adt$6.none()},move:Carets.moveDown,gather:after$5},adjustTil=function(bridge,movement,original,caret,numRetries){return 0===numRetries?Option.some(caret):function(bridge,x,y){return bridge.elementFromPoint(x,y).filter(function(elm){return"table"===name(elm)}).isSome()}(bridge,caret.left(),movement.point(caret))?function(bridge,movement,original,caret,numRetries){return adjustTil(bridge,movement,original,movement.move(caret,5),numRetries)}(bridge,movement,original,caret,numRetries-1):bridge.situsFromPoint(caret.left(),movement.point(caret)).bind(function(guess){return guess.start().fold(Option.none,function(element){return Rectangles_getEntireBox(bridge,element).bind(function(guessBox){return movement.adjuster(bridge,element,guessBox,original,caret).fold(Option.none,function(newCaret){return adjustTil(bridge,movement,original,newCaret,numRetries-1)})}).orThunk(function(){return Option.some(caret)})},Option.none)})},Retries={tryUp:curry(retry,upMovement),tryDown:curry(retry,downMovement),ieTryUp:function(bridge,caret){return bridge.situsFromPoint(caret.left(),caret.top()-5)},ieTryDown:function(bridge,caret){return bridge.situsFromPoint(caret.left(),caret.bottom()+5)},getJumpSize:constant(5)},platform$2=detect$3(),scan$1=function(bridge,isRoot,element,offset,direction,numRetries){return 0===numRetries?Option.none():tryCursor(bridge,isRoot,element,offset,direction).bind(function(situs){var range=bridge.fromSitus(situs),analysis=BeforeAfter.verify(bridge,element,offset,range.finish(),range.foffset(),direction.failure,isRoot);return BeforeAfter.cata(analysis,function(){return Option.none()},function(){return Option.some(situs)},function(cell){return eq(element,cell)&&0===offset?tryAgain(bridge,element,offset,Carets.moveUp,direction):scan$1(bridge,isRoot,cell,0,direction,numRetries-1)},function(cell){return eq(element,cell)&&offset===getEnd(cell)?tryAgain(bridge,element,offset,Carets.moveDown,direction):scan$1(bridge,isRoot,cell,getEnd(cell),direction,numRetries-1)})})},tryAgain=function(bridge,element,offset,move,direction){return Rectangles_getBoxAt(bridge,element,offset).bind(function(box){return tryAt(bridge,direction,move(box,Retries.getJumpSize()))})},tryAt=function(bridge,direction,box){return platform$2.browser.isChrome()||platform$2.browser.isSafari()||platform$2.browser.isFirefox()||platform$2.browser.isEdge()?direction.otherRetry(bridge,box):platform$2.browser.isIE()?direction.ieRetry(bridge,box):Option.none()},tryCursor=function(bridge,isRoot,element,offset,direction){return Rectangles_getBoxAt(bridge,element,offset).bind(function(box){return tryAt(bridge,direction,box)})},TableKeys_handle=function(bridge,isRoot,direction){return function(bridge,isRoot,direction){return bridge.getSelection().bind(function(sel){return BrTags_tryBr(isRoot,sel.finish(),sel.foffset(),direction).fold(function(){return Option.some(point(sel.finish(),sel.foffset()))},function(brNeighbour){var range=bridge.fromSitus(brNeighbour),analysis=BeforeAfter.verify(bridge,sel.finish(),sel.foffset(),range.finish(),range.foffset(),direction.failure,isRoot);return BrTags_process(analysis)})})}(bridge,isRoot,direction).bind(function(spot){return scan$1(bridge,isRoot,spot.element(),spot.offset(),direction,20).map(bridge.fromSitus)})},detection=detect$3(),VerticalMovement_navigate=function(bridge,isRoot,direction,initial,anchor,precheck){return detection.browser.isIE()?Option.none():precheck(initial,isRoot).orThunk(function(){return simulate(bridge,isRoot,direction,initial,anchor).map(function(info){var range=info.range();return Response.create(Option.some(Util.makeSitus(range.start(),range.soffset(),range.finish(),range.foffset())),!0)})})},VerticalMovement_select=function(bridge,container,isRoot,direction,initial,anchor,selectRange){return simulate(bridge,isRoot,direction,initial,anchor).bind(function(info){return KeySelection.detect(container,isRoot,info.start(),info.finish(),selectRange)})},VerticalMovement_firstUpCheck=function(initial,isRoot){return closest$1(initial,"tr",isRoot).bind(function(startRow){return closest$1(startRow,"table",isRoot).bind(function(table){var rows=descendants$1(table,"tr");return eq(startRow,rows[0])?function(element,predicate,isRoot){return seekLeft(universe$3,element,predicate,isRoot)}(table,function(element){return last$1(element).isSome()},isRoot).map(function(last){var lastOffset=getEnd(last);return Response.create(Option.some(Util.makeSitus(last,lastOffset,last,lastOffset)),!0)}):Option.none()})})},VerticalMovement_lastDownCheck=function(initial,isRoot){return closest$1(initial,"tr",isRoot).bind(function(startRow){return closest$1(startRow,"table",isRoot).bind(function(table){var rows=descendants$1(table,"tr");return eq(startRow,rows[rows.length-1])?function(element,predicate,isRoot){return seekRight(universe$3,element,predicate,isRoot)}(table,function(element){return first(element).isSome()},isRoot).map(function(first){return Response.create(Option.some(Util.makeSitus(first,0,first,0)),!0)}):Option.none()})})};function isKey(key){return function(keycode){return keycode===key}}function WindowBridge(win){return{elementFromPoint:function(x,y){return Element.fromPoint(Element.fromDom(win.document),x,y)},getRect:function(element){return element.dom().getBoundingClientRect()},getRangedRect:function(start,soffset,finish,foffset){var sel=Selection.exact(start,soffset,finish,foffset);return getFirstRect$1(win,sel).map(Rect_toRaw)},getSelection:function(){return get$a(win).map(function(exactAdt){return Util.convertToRange(win,exactAdt)})},fromSitus:function(situs){var relative=Selection.relative(situs.start(),situs.finish());return Util.convertToRange(win,relative)},situsFromPoint:function(x,y){return getAtPoint(win,x,y).map(function(exact){return Situs_create(exact.start(),exact.soffset(),exact.finish(),exact.foffset())})},clearSelection:function(){!function(win){win.getSelection().removeAllRanges()}(win)},collapseSelection:function(toStart){void 0===toStart&&(toStart=!1),get$a(win).each(function(sel){return sel.fold(function(rng){return rng.collapse(toStart)},function(startSitu,finishSitu){var situ=toStart?startSitu:finishSitu;setRelative(win,situ,situ)},function(start,soffset,finish,foffset){var node=toStart?start:finish,offset=toStart?soffset:foffset;setExact(win,node,offset,node,offset)})})},setSelection:function(sel){setExact(win,sel.start(),sel.soffset(),sel.finish(),sel.foffset())},setRelativeSelection:function(start,finish){setRelative(win,start,finish)},selectContents:function(element){setToElement(win,element)},getInnerHeight:function(){return win.innerHeight},getScrollY:function(){return function(_DOC){var doc=void 0!==_DOC?_DOC.dom():domGlobals.document,x=doc.body.scrollLeft||doc.documentElement.scrollLeft,y=doc.body.scrollTop||doc.documentElement.scrollTop;return Position(x,y)}(Element.fromDom(win.document)).top()},scrollBy:function(x,y){!function(x,y,_DOC){(void 0!==_DOC?_DOC.dom():domGlobals.document).defaultView.scrollBy(x,y)}(x,y,Element.fromDom(win.document))}}}function remove$7(element,classes){each(classes,function(x){!function(element,clazz){supports(element)?element.dom().classList.remove(clazz):remove$4(element,clazz);cleanClass(element)}(element,x)})}var KeyDirection={down:{traverse:nextSibling,gather:after$5,relative:Situ.before,otherRetry:Retries.tryDown,ieRetry:Retries.ieTryDown,failure:BeforeAfter.failedDown},up:{traverse:prevSibling,gather:before$4,relative:Situ.before,otherRetry:Retries.tryUp,ieRetry:Retries.ieTryUp,failure:BeforeAfter.failedUp}},isUp=isKey(38),isDown=isKey(40),SelectionKeys={ltr:{isBackward:isKey(37),isForward:isKey(39)},rtl:{isBackward:isKey(39),isForward:isKey(37)},isUp:isUp,isDown:isDown,isNavigation:function(keycode){return 37<=keycode&&keycode<=40}},Rect_toRaw=function(sr){return{left:sr.left(),top:sr.top(),right:sr.right(),bottom:sr.bottom(),width:sr.width(),height:sr.height()}},rc=(detect$3().browser.isSafari(),Immutable("rows","cols")),InputHandlers={mouse:function(win,container,isRoot,annotations){var handlers=function(bridge,container,isRoot,annotations){function clearState(){cursor=Option.none()}var cursor=Option.none();return{mousedown:function(event){annotations.clear(container),cursor=findCell(event.target(),isRoot)},mouseover:function(event){cursor.each(function(start){annotations.clearBeforeUpdate(container),findCell(event.target(),isRoot).each(function(finish){CellSelection_identify(start,finish,isRoot).each(function(cellSel){var boxes=cellSel.boxes().getOr([]);(1<boxes.length||1===boxes.length&&!eq(start,finish))&&(annotations.selectRange(container,boxes,cellSel.start(),cellSel.finish()),bridge.selectContents(finish))})})})},mouseup:function(_event){cursor.each(clearState)}}}(WindowBridge(win),container,isRoot,annotations);return{mousedown:handlers.mousedown,mouseover:handlers.mouseover,mouseup:handlers.mouseup}},keyboard:function(win,container,isRoot,annotations){function clearToNavigate(){return annotations.clear(container),Option.none()}var bridge=WindowBridge(win);return{keydown:function(event,start,soffset,finish,foffset,direction){var realEvent=event.raw(),keycode=realEvent.which,shiftKey=!0===realEvent.shiftKey;return CellSelection_retrieve(container,annotations.selectedSelector()).fold(function(){return SelectionKeys.isDown(keycode)&&shiftKey?curry(VerticalMovement_select,bridge,container,isRoot,KeyDirection.down,finish,start,annotations.selectRange):SelectionKeys.isUp(keycode)&&shiftKey?curry(VerticalMovement_select,bridge,container,isRoot,KeyDirection.up,finish,start,annotations.selectRange):SelectionKeys.isDown(keycode)?curry(VerticalMovement_navigate,bridge,isRoot,KeyDirection.down,finish,start,VerticalMovement_lastDownCheck):SelectionKeys.isUp(keycode)?curry(VerticalMovement_navigate,bridge,isRoot,KeyDirection.up,finish,start,VerticalMovement_firstUpCheck):Option.none},function(selected){function update(attempts){return function(){return findMap(attempts,function(delta){return KeySelection.update(delta.rows(),delta.cols(),container,selected,annotations)}).fold(function(){return CellSelection_getEdges(container,annotations.firstSelectedSelector(),annotations.lastSelectedSelector()).map(function(edges){var relative=SelectionKeys.isDown(keycode)||direction.isForward(keycode)?Situ.after:Situ.before;return bridge.setRelativeSelection(Situ.on(edges.first(),0),relative(edges.table())),annotations.clear(container),Response.create(Option.none(),!0)})},function(_){return Option.some(Response.create(Option.none(),!0))})}}return SelectionKeys.isDown(keycode)&&shiftKey?update([rc(1,0)]):SelectionKeys.isUp(keycode)&&shiftKey?update([rc(-1,0)]):direction.isBackward(keycode)&&shiftKey?update([rc(0,-1),rc(-1,0)]):direction.isForward(keycode)&&shiftKey?update([rc(0,1),rc(1,0)]):SelectionKeys.isNavigation(keycode)&&!1==shiftKey?clearToNavigate:Option.none})()},keyup:function(event,start,soffset,finish,foffset){return CellSelection_retrieve(container,annotations.selectedSelector()).fold(function(){var realEvent=event.raw(),keycode=realEvent.which;return!1==(!0===realEvent.shiftKey)?Option.none():SelectionKeys.isNavigation(keycode)?KeySelection.sync(container,isRoot,start,soffset,finish,foffset,annotations.selectRange):Option.none()},Option.none)}}},external:function(win,container,isRoot,annotations){var bridge=WindowBridge(win);return function(start,finish){annotations.clearBeforeUpdate(container),CellSelection_identify(start,finish,isRoot).each(function(cellSel){var boxes=cellSel.boxes().getOr([]);annotations.selectRange(container,boxes,cellSel.start(),cellSel.finish()),bridge.selectContents(finish),bridge.collapseSelection()})}}},SelectionAnnotation={byClass:function(ephemera){function clear(container){var sels=descendants$1(container,ephemera.selectedSelector());each(sels,removeSelectionClasses)}var addSelectionClass=function(clazz){return function(element){add$2(element,clazz)}}(ephemera.selected()),removeSelectionClasses=function(classes){return function(element){remove$7(element,classes)}}([ephemera.selected(),ephemera.lastSelected(),ephemera.firstSelected()]);return{clearBeforeUpdate:clear,clear:clear,selectRange:function(container,cells,start,finish){clear(container),each(cells,addSelectionClass),add$2(start,ephemera.firstSelected()),add$2(finish,ephemera.lastSelected())},selectedSelector:ephemera.selectedSelector,firstSelectedSelector:ephemera.firstSelectedSelector,lastSelectedSelector:ephemera.lastSelectedSelector}},byAttr:function(ephemera,onSelection,onClear){function removeSelectionAttributes(element){remove(element,ephemera.selected()),remove(element,ephemera.firstSelected()),remove(element,ephemera.lastSelected())}function addSelectionAttribute(element){set(element,ephemera.selected(),"1")}function clear(container){clearBeforeUpdate(container),onClear()}var clearBeforeUpdate=function(container){var sels=descendants$1(container,ephemera.selectedSelector());each(sels,removeSelectionAttributes)};return{clearBeforeUpdate:clearBeforeUpdate,clear:clear,selectRange:function(container,cells,start,finish){clear(container),each(cells,addSelectionAttribute),set(start,ephemera.firstSelected(),"1"),set(finish,ephemera.lastSelected(),"1"),onSelection(cells,start,finish)},selectedSelector:ephemera.selectedSelector,firstSelectedSelector:ephemera.firstSelectedSelector,lastSelectedSelector:ephemera.lastSelectedSelector}}},OtherCells={getOtherCells:function(table,target,generators){var list=DetailsList_fromTable(table),house=Warehouse.generate(list);return onCells(house,target).map(function(selectedCells){var grid=Transitions_toGrid(house,generators,!1);return{upOrLeftCells:function(grid,selectedCells,generators){var upGrid=grid.slice(0,selectedCells[selectedCells.length-1].row()+1),upDetails=toDetailList(upGrid,generators);return bind(upDetails,function(detail){var slicedCells=detail.cells().slice(0,selectedCells[selectedCells.length-1].column()+1);return map(slicedCells,function(cell){return cell.element()})})}(grid,selectedCells,generators),downOrRightCells:function(grid,selectedCells,generators){var downGrid=grid.slice(selectedCells[0].row()+selectedCells[0].rowspan()-1,grid.length),downDetails=toDetailList(downGrid,generators);return bind(downDetails,function(detail){var slicedCells=detail.cells().slice(selectedCells[0].column()+selectedCells[0].colspan()-1,+detail.cells().length);return map(slicedCells,function(cell){return cell.element()})})}(grid,selectedCells,generators)}})}},hasInternalTarget=function(e){return!1===has$2(Element.fromDom(e.target),"ephox-snooker-resizer-bar")};function CellSelection$1(editor,lazyResize,selectionTargets){var handlerStruct=MixedBag(["mousedown","mouseover","mouseup","keyup","keydown"],[]),handlers=Option.none(),cloneFormats=getCloneElements(editor),annotations=SelectionAnnotation.byAttr(Ephemera,function(cells,start,finish){selectionTargets.targets().each(function(targets){TableLookup.table(start).each(function(table){var doc=Element.fromDom(editor.getDoc()),generators=TableFill.cellOperations(noop,doc,cloneFormats),otherCells=OtherCells.getOtherCells(table,targets,generators);fireTableSelectionChange(editor,cells,start,finish,otherCells)})})},function(){fireTableSelectionClear(editor)});editor.on("init",function(e){var win=editor.getWin(),body=getBody$1(editor),isRoot=getIsRoot(editor),mouseHandlers=InputHandlers.mouse(win,body,isRoot,annotations),keyHandlers=InputHandlers.keyboard(win,body,isRoot,annotations),external=InputHandlers.external(win,body,isRoot,annotations);editor.on("TableSelectorChange",function(e){external(e.start,e.finish)});function handleResponse(event,response){!function(event){return!0===event.raw().shiftKey}(event)||(response.kill()&&event.kill(),response.selection().each(function(ns){var relative=Selection.relative(ns.start(),ns.finish()),rng=asLtrRange(win,relative);editor.selection.setRng(rng)}))}function keyup(event){var wrappedEvent=fromRawEvent$1(event);if(wrappedEvent.raw().shiftKey&&SelectionKeys.isNavigation(wrappedEvent.raw().which)){var rng=editor.selection.getRng(),start=Element.fromDom(rng.startContainer),end=Element.fromDom(rng.endContainer);keyHandlers.keyup(wrappedEvent,start,rng.startOffset,end,rng.endOffset).each(function(response){handleResponse(wrappedEvent,response)})}}function keydown(event){var wrappedEvent=fromRawEvent$1(event);lazyResize().each(function(resize){resize.hideBars()});var rng=editor.selection.getRng(),startContainer=Element.fromDom(editor.selection.getStart()),start=Element.fromDom(rng.startContainer),end=Element.fromDom(rng.endContainer),direction=Direction.directionAt(startContainer).isRtl()?SelectionKeys.rtl:SelectionKeys.ltr;keyHandlers.keydown(wrappedEvent,start,rng.startOffset,end,rng.endOffset,direction).each(function(response){handleResponse(wrappedEvent,response)}),lazyResize().each(function(resize){resize.showBars()})}function isLeftMouse(raw){return 0===raw.button}function mouseDown(e){isLeftMouse(e)&&hasInternalTarget(e)&&mouseHandlers.mousedown(fromRawEvent$1(e))}function mouseOver(e){(function(raw){return void 0===raw.buttons||(!(!global$2.browser.isEdge()||0!==raw.buttons)||0!=(1&raw.buttons))})(e)&&hasInternalTarget(e)&&mouseHandlers.mouseover(fromRawEvent$1(e))}function mouseUp(e){isLeftMouse(e)&&hasInternalTarget(e)&&mouseHandlers.mouseup(fromRawEvent$1(e))}var lastTarget,lastTimeStamp,doubleTap=(lastTarget=Cell(Element.fromDom(body)),lastTimeStamp=Cell(0),{touchEnd:function(t){var target=Element.fromDom(t.target);if("td"===name(target)||"th"===name(target)){var lT=lastTarget.get(),lTS=lastTimeStamp.get();eq(lT,target)&&t.timeStamp-lTS<300&&(t.preventDefault(),external(target,target))}lastTarget.set(target),lastTimeStamp.set(t.timeStamp)}});editor.on("mousedown",mouseDown),editor.on("mouseover",mouseOver),editor.on("mouseup",mouseUp),editor.on("touchend",doubleTap.touchEnd),editor.on("keyup",keyup),editor.on("keydown",keydown),editor.on("NodeChange",function(){var sel=editor.selection,start=Element.fromDom(sel.getStart()),end=Element.fromDom(sel.getEnd());DomParent.sharedOne(TableLookup.table,[start,end]).fold(function(){annotations.clear(body)},noop)}),handlers=Option.some(handlerStruct({mousedown:mouseDown,mouseover:mouseOver,mouseup:mouseUp,keyup:keyup,keydown:keydown}))});return{clear:annotations.clear,destroy:function(){handlers.each(function(handlers){})}}}var Selections=function(editor){return{get:function(){var body=getBody$1(editor);return TableSelection_retrieve(body,Ephemera.selectedSelector()).fold(function(){return void 0===editor.selection.getStart()?SelectionTypes.none():SelectionTypes.single(editor.selection)},function(cells){return SelectionTypes.multiple(cells)})}}},getSelectionTargets=function(editor,selections){function findTargets(){return getSelectionStartCellOrCaption(editor).bind(function(cellOrCaption){return TableLookup.table(cellOrCaption).map(function(table){return"caption"===name(cellOrCaption)?TableTargets.notCell(cellOrCaption):TableTargets.forMenu(selections,table,cellOrCaption)})})}function resetTargets(){targets.set(cached(findTargets)()),each(changeHandlers.get(),function(handler){return handler()})}function onSetup(api,isDisabled){function handler(){return targets.get().fold(function(){api.setDisabled(!0)},function(targets){api.setDisabled(isDisabled(targets))})}return handler(),changeHandlers.set(changeHandlers.get().concat([handler])),function(){changeHandlers.set(filter(changeHandlers.get(),function(h){return h!==handler}))}}var targets=Cell(Option.none()),changeHandlers=Cell([]);return editor.on("NodeChange TableSelectorChange",resetTargets),{onSetupTable:function(api){return onSetup(api,function(_){return!1})},onSetupCellOrRow:function(api){return onSetup(api,function(targets){return"caption"===name(targets.element())})},onSetupMergeable:function(api){return onSetup(api,function(targets){return targets.mergable().isNone()})},onSetupUnmergeable:function(api){return onSetup(api,function(targets){return targets.unmergable().isNone()})},resetTargets:resetTargets,targets:function(){return targets.get()}}},Buttons={addButtons:function(editor,selectionTargets){editor.ui.registry.addMenuButton("table",{tooltip:"Table",icon:"table",fetch:function(callback){return callback("inserttable | cell row column | advtablesort | tableprops deletetable")}});function cmd(command){return function(){return editor.execCommand(command)}}editor.ui.registry.addButton("tableprops",{tooltip:"Table properties",onAction:cmd("mceTableProps"),icon:"table",onSetup:selectionTargets.onSetupTable}),editor.ui.registry.addButton("tabledelete",{tooltip:"Delete table",onAction:cmd("mceTableDelete"),icon:"table-delete-table",onSetup:selectionTargets.onSetupTable}),editor.ui.registry.addButton("tablecellprops",{tooltip:"Cell properties",onAction:cmd("mceTableCellProps"),icon:"table-cell-properties",onSetup:selectionTargets.onSetupCellOrRow}),editor.ui.registry.addButton("tablemergecells",{tooltip:"Merge cells",onAction:cmd("mceTableMergeCells"),icon:"table-merge-cells",onSetup:selectionTargets.onSetupMergeable}),editor.ui.registry.addButton("tablesplitcells",{tooltip:"Split cell",onAction:cmd("mceTableSplitCells"),icon:"table-split-cells",onSetup:selectionTargets.onSetupUnmergeable}),editor.ui.registry.addButton("tableinsertrowbefore",{tooltip:"Insert row before",onAction:cmd("mceTableInsertRowBefore"),icon:"table-insert-row-above",onSetup:selectionTargets.onSetupCellOrRow}),editor.ui.registry.addButton("tableinsertrowafter",{tooltip:"Insert row after",onAction:cmd("mceTableInsertRowAfter"),icon:"table-insert-row-after",onSetup:selectionTargets.onSetupCellOrRow}),editor.ui.registry.addButton("tabledeleterow",{tooltip:"Delete row",onAction:cmd("mceTableDeleteRow"),icon:"table-delete-row",onSetup:selectionTargets.onSetupCellOrRow}),editor.ui.registry.addButton("tablerowprops",{tooltip:"Row properties",onAction:cmd("mceTableRowProps"),icon:"table-row-properties",onSetup:selectionTargets.onSetupCellOrRow}),editor.ui.registry.addButton("tableinsertcolbefore",{tooltip:"Insert column before",onAction:cmd("mceTableInsertColBefore"),icon:"table-insert-column-before",onSetup:selectionTargets.onSetupCellOrRow}),editor.ui.registry.addButton("tableinsertcolafter",{tooltip:"Insert column after",onAction:cmd("mceTableInsertColAfter"),icon:"table-insert-column-after",onSetup:selectionTargets.onSetupCellOrRow}),editor.ui.registry.addButton("tabledeletecol",{tooltip:"Delete column",onAction:cmd("mceTableDeleteCol"),icon:"table-delete-column",onSetup:selectionTargets.onSetupCellOrRow}),editor.ui.registry.addButton("tablecutrow",{tooltip:"Cut row",onAction:cmd("mceTableCutRow"),icon:"temporary-placeholder",onSetup:selectionTargets.onSetupCellOrRow}),editor.ui.registry.addButton("tablecopyrow",{tooltip:"Copy row",onAction:cmd("mceTableCopyRow"),icon:"temporary-placeholder",onSetup:selectionTargets.onSetupCellOrRow}),editor.ui.registry.addButton("tablepasterowbefore",{tooltip:"Paste row before",onAction:cmd("mceTablePasteRowBefore"),icon:"temporary-placeholder",onSetup:selectionTargets.onSetupCellOrRow}),editor.ui.registry.addButton("tablepasterowafter",{tooltip:"Paste row after",onAction:cmd("mceTablePasteRowAfter"),icon:"temporary-placeholder",onSetup:selectionTargets.onSetupCellOrRow}),editor.ui.registry.addButton("tableinsertdialog",{tooltip:"Insert table",onAction:cmd("mceInsertTable"),icon:"table"})},addToolbars:function(editor){var toolbar=function(editor){return editor.getParam("table_toolbar","tableprops tabledelete | tableinsertrowbefore tableinsertrowafter tabledeleterow | tableinsertcolbefore tableinsertcolafter tabledeletecol")}(editor);0<toolbar.length&&editor.ui.registry.addContextToolbar("table",{predicate:function(table){return editor.dom.is(table,"table")&&editor.getBody().contains(table)},items:toolbar,scope:"node",position:"node"})}},MenuItems={addMenuItems:function(editor,selectionTargets){function cmd(command){return function(){return editor.execCommand(command)}}function insertTableAction(_a){var numRows=_a.numRows,numColumns=_a.numColumns;editor.undoManager.transact(function(){InsertTable_insert(editor,numColumns,numRows)}),editor.addVisual()}var tableProperties={text:"Table properties",onSetup:selectionTargets.onSetupTable,onAction:cmd("mceTableProps")},deleteTable={text:"Delete table",icon:"table-delete-table",onSetup:selectionTargets.onSetupTable,onAction:cmd("mceTableDelete")},rowItems=[{type:"menuitem",text:"Insert row before",icon:"table-insert-row-above",onAction:cmd("mceTableInsertRowBefore"),onSetup:selectionTargets.onSetupCellOrRow},{type:"menuitem",text:"Insert row after",icon:"table-insert-row-after",onAction:cmd("mceTableInsertRowAfter"),onSetup:selectionTargets.onSetupCellOrRow},{type:"menuitem",text:"Delete row",icon:"table-delete-row",onAction:cmd("mceTableDeleteRow"),onSetup:selectionTargets.onSetupCellOrRow},{type:"menuitem",text:"Row properties",icon:"table-row-properties",onAction:cmd("mceTableRowProps"),onSetup:selectionTargets.onSetupCellOrRow},{type:"separator"},{type:"menuitem",text:"Cut row",onAction:cmd("mceTableCutRow"),onSetup:selectionTargets.onSetupCellOrRow},{type:"menuitem",text:"Copy row",onAction:cmd("mceTableCopyRow"),onSetup:selectionTargets.onSetupCellOrRow},{type:"menuitem",text:"Paste row before",onAction:cmd("mceTablePasteRowBefore"),onSetup:selectionTargets.onSetupCellOrRow},{type:"menuitem",text:"Paste row after",onAction:cmd("mceTablePasteRowAfter"),onSetup:selectionTargets.onSetupCellOrRow}],row={type:"nestedmenuitem",text:"Row",getSubmenuItems:function(){return rowItems}},columnItems=[{type:"menuitem",text:"Insert column before",icon:"table-insert-column-before",onAction:cmd("mceTableInsertColBefore"),onSetup:selectionTargets.onSetupCellOrRow},{type:"menuitem",text:"Insert column after",icon:"table-insert-column-after",onAction:cmd("mceTableInsertColAfter"),onSetup:selectionTargets.onSetupCellOrRow},{type:"menuitem",text:"Delete column",icon:"table-delete-column",onAction:cmd("mceTableDeleteCol"),onSetup:selectionTargets.onSetupCellOrRow}],column={type:"nestedmenuitem",text:"Column",getSubmenuItems:function(){return columnItems}},cellItems=[{type:"menuitem",text:"Cell properties",icon:"table-cell-properties",onAction:cmd("mceTableCellProps"),onSetup:selectionTargets.onSetupCellOrRow},{type:"menuitem",text:"Merge cells",icon:"table-merge-cells",onAction:cmd("mceTableMergeCells"),onSetup:selectionTargets.onSetupMergeable},{type:"menuitem",text:"Split cell",icon:"table-split-cells",onAction:cmd("mceTableSplitCells"),onSetup:selectionTargets.onSetupUnmergeable}],cell={type:"nestedmenuitem",text:"Cell",getSubmenuItems:function(){return cellItems}};!1===function(editor){return editor.getParam("table_grid",!0,"boolean")}(editor)?editor.ui.registry.addMenuItem("inserttable",{text:"Table",icon:"table",onAction:cmd("mceInsertTable")}):editor.ui.registry.addNestedMenuItem("inserttable",{text:"Table",icon:"table",getSubmenuItems:function(){return[{type:"fancymenuitem",fancytype:"inserttable",onAction:insertTableAction}]}}),editor.ui.registry.addMenuItem("inserttabledialog",{text:"Insert table",icon:"table",onAction:cmd("mceInsertTable")}),editor.ui.registry.addMenuItem("tableprops",tableProperties),editor.ui.registry.addMenuItem("deletetable",deleteTable),editor.ui.registry.addNestedMenuItem("row",row),editor.ui.registry.addNestedMenuItem("column",column),editor.ui.registry.addNestedMenuItem("cell",cell),editor.ui.registry.addContextMenu("table",{update:function(){return selectionTargets.resetTargets(),selectionTargets.targets().fold(function(){return""},function(targets){return"caption"===name(targets.element())?"tableprops deletetable":"cell row column | advtablesort | tableprops deletetable"})}})}},getApi=function(editor,clipboardRows,resizeHandler,selectionTargets){return{insertTable:function(columns,rows){return InsertTable_insert(editor,columns,rows)},setClipboardRows:function(rows){return function(rows,clipboardRows){var sugarRows=map(rows,Element.fromDom);clipboardRows.set(Option.from(sugarRows))}(rows,clipboardRows)},getClipboardRows:function(){return function(clipboardRows){return clipboardRows.get().fold(function(){},function(rows){return map(rows,function(row){return row.dom()})})}(clipboardRows)},resizeHandler:resizeHandler,selectionTargets:selectionTargets}};function Plugin(editor){var selections=Selections(editor),selectionTargets=getSelectionTargets(editor,selections),resizeHandler=getResizeHandler(editor),cellSelection=CellSelection$1(editor,resizeHandler.lazyResize,selectionTargets),actions=TableActions(editor,resizeHandler.lazyWire),clipboardRows=Cell(Option.none());return Commands.registerCommands(editor,actions,cellSelection,selections,clipboardRows),Clipboard.registerEvents(editor,selections,actions,cellSelection),MenuItems.addMenuItems(editor,selectionTargets),Buttons.addButtons(editor,selectionTargets),Buttons.addToolbars(editor),editor.on("PreInit",function(){editor.serializer.addTempAttr(Ephemera.firstSelected()),editor.serializer.addTempAttr(Ephemera.lastSelected())}),hasTabNavigation(editor)&&editor.on("keydown",function(e){TabContext.handle(e,editor,actions,resizeHandler.lazyWire)}),editor.on("remove",function(){resizeHandler.destroy(),cellSelection.destroy()}),getApi(editor,clipboardRows,resizeHandler,selectionTargets)}global.add("table",Plugin)}(window),function(){"use strict";function displayErrorMessage(editor,message){editor.notificationManager.open({text:message,type:"error"})}function stateToggle(editor){return function(api){function handler(){api.setDisabled(Settings_enableWhenDirty(editor)&&!editor.isDirty())}return editor.on("NodeChange dirty",handler),function(){return editor.off("NodeChange dirty",handler)}}}var global=tinymce.util.Tools.resolve("tinymce.PluginManager"),global$1=tinymce.util.Tools.resolve("tinymce.dom.DOMUtils"),global$2=tinymce.util.Tools.resolve("tinymce.util.Tools"),Settings_enableWhenDirty=function(editor){return editor.getParam("save_enablewhendirty",!0)},Settings_hasOnSaveCallback=function(editor){return!!editor.getParam("save_onsavecallback")},Settings_hasOnCancelCallback=function(editor){return!!editor.getParam("save_oncancelcallback")},Actions_save=function(editor){var formObj;if(formObj=global$1.DOM.getParent(editor.id,"form"),!Settings_enableWhenDirty(editor)||editor.isDirty()){if(editor.save(),Settings_hasOnSaveCallback(editor))return editor.execCallback("save_onsavecallback",editor),void editor.nodeChanged();formObj?(editor.setDirty(!1),formObj.onsubmit&&!formObj.onsubmit()||("function"==typeof formObj.submit?formObj.submit():displayErrorMessage(editor,"Error: Form submit field collision.")),editor.nodeChanged()):displayErrorMessage(editor,"Error: No form element found.")}},Actions_cancel=function(editor){var h=global$2.trim(editor.startContent);Settings_hasOnCancelCallback(editor)?editor.execCallback("save_oncancelcallback",editor):editor.resetContent(h)},Commands_register=function(editor){editor.addCommand("mceSave",function(){Actions_save(editor)}),editor.addCommand("mceCancel",function(){Actions_cancel(editor)})},Buttons_register=function(editor){editor.ui.registry.addButton("save",{icon:"save",tooltip:"Save",disabled:!0,onAction:function(){return editor.execCommand("mceSave")},onSetup:stateToggle(editor)}),editor.ui.registry.addButton("cancel",{icon:"cancel",tooltip:"Cancel",disabled:!0,onAction:function(){return editor.execCommand("mceCancel")},onSetup:stateToggle(editor)}),editor.addShortcut("Meta+S","","mceSave")};global.add("save",function(editor){Buttons_register(editor),Commands_register(editor)})}(),function(){"use strict";function getTimeFormat(editor){return editor.getParam("insertdatetime_timeformat",editor.translate("%H:%M:%S"))}function getFormats(editor){return editor.getParam("insertdatetime_formats",["%H:%M:%S","%Y-%m-%d","%I:%M:%S %p","%D"])}function addZeros(value,len){if((value=""+value).length<len)for(var i=0;i<len-value.length;i++)value="0"+value;return value}function getDateTime(editor,fmt,date){return date=date||new Date,fmt=(fmt=(fmt=(fmt=(fmt=(fmt=(fmt=(fmt=(fmt=(fmt=(fmt=(fmt=(fmt=(fmt=(fmt=(fmt=fmt.replace("%D","%m/%d/%Y")).replace("%r","%I:%M:%S %p")).replace("%Y",""+date.getFullYear())).replace("%y",""+date.getYear())).replace("%m",addZeros(date.getMonth()+1,2))).replace("%d",addZeros(date.getDate(),2))).replace("%H",""+addZeros(date.getHours(),2))).replace("%M",""+addZeros(date.getMinutes(),2))).replace("%S",""+addZeros(date.getSeconds(),2))).replace("%I",""+((date.getHours()+11)%12+1))).replace("%p",date.getHours()<12?"AM":"PM")).replace("%B",""+editor.translate(monthsLong[date.getMonth()]))).replace("%b",""+editor.translate(monthsShort[date.getMonth()]))).replace("%A",""+editor.translate(daysLong[date.getDay()]))).replace("%a",""+editor.translate(daysShort[date.getDay()]))).replace("%%","%")}var global=tinymce.util.Tools.resolve("tinymce.PluginManager"),Settings_getDateFormat=function(editor){return editor.getParam("insertdatetime_dateformat",editor.translate("%Y-%m-%d"))},Settings_getTimeFormat=getTimeFormat,Settings_getFormats=getFormats,Settings_getDefaultDateTime=function(editor){var formats=getFormats(editor);return 0<formats.length?formats[0]:getTimeFormat(editor)},Settings_shouldInsertTimeElement=function(editor){return editor.getParam("insertdatetime_element",!1)},daysShort="Sun Mon Tue Wed Thu Fri Sat Sun".split(" "),daysLong="Sunday Monday Tuesday Wednesday Thursday Friday Saturday Sunday".split(" "),monthsShort="Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec".split(" "),monthsLong="January February March April May June July August September October November December".split(" "),Actions_insertDateTime=function(editor,format){if(Settings_shouldInsertTimeElement(editor)){var userTime=getDateTime(editor,format),computerTime=void 0;computerTime=/%[HMSIp]/.test(format)?getDateTime(editor,"%Y-%m-%dT%H:%M"):getDateTime(editor,"%Y-%m-%d");var timeElm=editor.dom.getParent(editor.selection.getStart(),"time");timeElm?function(editor,timeElm,computerTime,userTime){var newTimeElm=editor.dom.create("time",{datetime:computerTime},userTime);timeElm.parentNode.insertBefore(newTimeElm,timeElm),editor.dom.remove(timeElm),editor.selection.select(newTimeElm,!0),editor.selection.collapse(!1)}(editor,timeElm,computerTime,userTime):editor.insertContent('<time datetime="'+computerTime+'">'+userTime+"</time>")}else editor.insertContent(getDateTime(editor,format))},Actions_getDateTime=getDateTime,Commands_register=function(editor){editor.addCommand("mceInsertDate",function(){Actions_insertDateTime(editor,Settings_getDateFormat(editor))}),editor.addCommand("mceInsertTime",function(){Actions_insertDateTime(editor,Settings_getTimeFormat(editor))})},global$1=tinymce.util.Tools.resolve("tinymce.util.Tools"),Cell=function(initial){function get(){return value}var value=initial;return{get:get,set:function(v){value=v},clone:function(){return Cell(get())}}},Buttons_register=function(editor){var formats=Settings_getFormats(editor),defaultFormat=Cell(Settings_getDefaultDateTime(editor));editor.ui.registry.addSplitButton("insertdatetime",{icon:"insert-time",tooltip:"Insert date/time",select:function(value){return value===defaultFormat.get()},fetch:function(done){done(global$1.map(formats,function(format){return{type:"choiceitem",text:Actions_getDateTime(editor,format),value:format}}))},onAction:function(){for(var args=[],_i=0;_i<arguments.length;_i++)args[_i]=arguments[_i];Actions_insertDateTime(editor,defaultFormat.get())},onItemAction:function(_,value){defaultFormat.set(value),Actions_insertDateTime(editor,value)}});editor.ui.registry.addNestedMenuItem("insertdatetime",{icon:"insert-time",text:"Date/time",getSubmenuItems:function(){return global$1.map(formats,function(format){return{type:"menuitem",text:Actions_getDateTime(editor,format),onAction:function(format){return function(){defaultFormat.set(format),Actions_insertDateTime(editor,format)}}(format)}})}})};global.add("insertdatetime",function(editor){Commands_register(editor),Buttons_register(editor)})}(),function(){"use strict";var global=tinymce.util.Tools.resolve("tinymce.PluginManager"),global$1=tinymce.util.Tools.resolve("tinymce.util.Tools"),Settings_getContentStyle=function(editor){return editor.getParam("content_style","")},Settings_shouldUseContentCssCors=function(editor){return editor.getParam("content_css_cors",!1,"boolean")},global$2=tinymce.util.Tools.resolve("tinymce.Env"),IframeContent_getPreviewHtml=function(editor){var headHtml="",encode=editor.dom.encode,contentStyle=Settings_getContentStyle(editor);headHtml+='<base href="'+encode(editor.documentBaseURI.getURI())+'">',contentStyle&&(headHtml+='<style type="text/css">'+contentStyle+"</style>");var cors=Settings_shouldUseContentCssCors(editor)?' crossorigin="anonymous"':"";global$1.each(editor.contentCSS,function(url){headHtml+='<link type="text/css" rel="stylesheet" href="'+encode(editor.documentBaseURI.toAbsolute(url))+'"'+cors+">"});var bodyId=editor.settings.body_id||"tinymce";-1!==bodyId.indexOf("=")&&(bodyId=(bodyId=editor.getParam("body_id","","hash"))[editor.id]||bodyId);var bodyClass=editor.settings.body_class||"";-1!==bodyClass.indexOf("=")&&(bodyClass=(bodyClass=editor.getParam("body_class","","hash"))[editor.id]||"");var preventClicksOnLinksScript='<script>document.addEventListener && document.addEventListener("click", function(e) {for (var elm = e.target; elm; elm = elm.parentNode) {if (elm.nodeName === "A" && !('+(global$2.mac?"e.metaKey":"e.ctrlKey && !e.altKey")+")) {e.preventDefault();}}}, false);<\/script> ",directionality=editor.getBody().dir,dirAttr=directionality?' dir="'+encode(directionality)+'"':"";return"<!DOCTYPE html><html><head>"+headHtml+'</head><body id="'+encode(bodyId)+'" class="mce-content-body '+encode(bodyClass)+'"'+dirAttr+">"+editor.getContent()+preventClicksOnLinksScript+"</body></html>"},Commands_register=function(editor){editor.addCommand("mcePreview",function(){!function(editor){var content=IframeContent_getPreviewHtml(editor);editor.windowManager.open({title:"Preview",size:"large",body:{type:"panel",items:[{name:"preview",type:"iframe",sandboxed:!0}]},buttons:[{type:"cancel",name:"close",text:"Close",primary:!0}],initialData:{preview:content}}).focus("close")}(editor)})},Buttons_register=function(editor){editor.ui.registry.addButton("preview",{icon:"preview",tooltip:"Preview",onAction:function(){return editor.execCommand("mcePreview")}}),editor.ui.registry.addMenuItem("preview",{icon:"preview",text:"Preview",onAction:function(){return editor.execCommand("mcePreview")}})};global.add("preview",function(editor){Commands_register(editor),Buttons_register(editor)})}(),function(){"use strict";function noop(){}function constant(value){return function(){return value}}function none(){return NONE}var me,global=tinymce.util.Tools.resolve("tinymce.PluginManager"),__assign=function(){return(__assign=Object.assign||function(t){for(var s,i=1,n=arguments.length;i<n;i++)for(var p in s=arguments[i])Object.prototype.hasOwnProperty.call(s,p)&&(t[p]=s[p]);return t}).apply(this,arguments)},never=constant(!1),always=constant(!0),NONE=(me={fold:function(n,s){return n()},is:never,isSome:never,isNone:always,getOr:id,getOrThunk:call,getOrDie:function(msg){throw new Error(msg||"error: getOrDie called on none.")},getOrNull:constant(null),getOrUndefined:constant(void 0),or:id,orThunk:call,map:none,each:noop,bind:none,exists:never,forall:always,filter:none,equals:eq,equals_:eq,toArray:function(){return[]},toString:constant("none()")},Object.freeze&&Object.freeze(me),me);function eq(o){return o.isNone()}function call(thunk){return thunk()}function id(n){return n}function isType(type){return function(value){return function(x){if(null===x)return"null";var t=typeof x;return"object"==t&&(Array.prototype.isPrototypeOf(x)||x.constructor&&"Array"===x.constructor.name)?"array":"object"==t&&(String.prototype.isPrototypeOf(x)||x.constructor&&"String"===x.constructor.name)?"string":t}(value)===type}}function each(xs,f){for(var i=0,len=xs.length;i<len;i++){f(xs[i],i)}}function get(obj,key){return has(obj,key)?Option.from(obj[key]):Option.none()}function getVideoScriptMatch(prefixes,src){if(prefixes)for(var i=0;i<prefixes.length;i++)if(-1!==src.indexOf(prefixes[i].filter))return prefixes[i]}function trimPx(value){return value.replace(/px$/,"")}function htmlToData(prefixes,html){var isEphoxEmbed=Cell(!1),data={};return global$3({validate:!1,allow_conditional_comments:!0,start:function(name,attrs){if(!isEphoxEmbed.get())if(has(attrs.map,"data-ephox-embed-iri"))isEphoxEmbed.set(!0),data=function(attrs){var style=attrs.map.style,styles=style?DOM.parseStyle(style):{};return{type:"ephox-embed-iri",source:attrs.map["data-ephox-embed-iri"],altsource:"",poster:"",width:get(styles,"max-width").map(trimPx).getOr(""),height:get(styles,"max-height").map(trimPx).getOr("")}}(attrs);else{if(data.source||"param"!==name||(data.source=attrs.map.movie),"iframe"!==name&&"object"!==name&&"embed"!==name&&"video"!==name&&"audio"!==name||(data.type||(data.type=name),data=global$1.extend(attrs.map,data)),"script"===name){var videoScript=getVideoScriptMatch(prefixes,attrs.map.src);if(!videoScript)return;data={type:"script",source:attrs.map.src,width:String(videoScript.width),height:String(videoScript.height)}}"source"===name&&(data.source?data.altsource||(data.altsource=attrs.map.src):data.source=attrs.map.src),"img"!==name||data.poster||(data.poster=attrs.map.src)}}}).parse(html),data.source=data.source||data.src||data.data,data.altsource=data.altsource||"",data.poster=data.poster||"",data}function addPx(value){return/^[0-9.]+$/.test(value)?value+"px":value}function setAttributes(attrs,updatedAttrs){for(var name_1 in updatedAttrs){var value=""+updatedAttrs[name_1];if(attrs.map[name_1])for(var i=attrs.length;i--;){var attr=attrs[i];attr.name===name_1&&(value?(attrs.map[name_1]=value,attr.value=value):(delete attrs.map[name_1],attrs.splice(i,1)))}else value&&(attrs.push({name:name_1,value:value}),attrs.map[name_1]=value)}}function dataToHtml(editor,dataIn){var data=global$1.extend({},dataIn);if(!data.source&&(global$1.extend(data,htmlToData(Settings_getScripts(editor),data.embed)),!data.source))return"";data.altsource||(data.altsource=""),data.poster||(data.poster=""),data.source=editor.convertURL(data.source,"source"),data.altsource=editor.convertURL(data.altsource,"source"),data.sourcemime=Mime_guess(data.source),data.altsourcemime=Mime_guess(data.altsource),data.poster=editor.convertURL(data.poster,"poster");var pattern=function(url){var patterns=urlPatterns.filter(function(pattern){return pattern.regex.test(url)});return 0<patterns.length?global$1.extend({},patterns[0],{url:function(pattern,url){for(var protocol=function(url){var protocolMatches=url.match(/^(https?:\/\/|www\.)(.+)$/i);return protocolMatches&&1<protocolMatches.length?"www."===protocolMatches[1]?"https://":protocolMatches[1]:"https://"}(url),match=pattern.regex.exec(url),newUrl=protocol+pattern.url,_loop_1=function(i){newUrl=newUrl.replace("$"+i,function(){return match[i]?match[i]:""})},i=0;i<match.length;i++)_loop_1(i);return newUrl.replace(/\?$/,"")}(patterns[0],url)}):null}(data.source);if(pattern&&(data.source=pattern.url,data.type=pattern.type,data.allowFullscreen=pattern.allowFullscreen,data.width=data.width||String(pattern.w),data.height=data.height||String(pattern.h)),data.embed)return UpdateHtml_updateHtml(data.embed,data,!0);var videoScript=getVideoScriptMatch(Settings_getScripts(editor),data.source);videoScript&&(data.type="script",data.width=String(videoScript.width),data.height=String(videoScript.height));var audioTemplateCallback=Settings_getAudioTemplateCallback(editor),videoTemplateCallback=Settings_getVideoTemplateCallback(editor);return data.width=data.width||"300",data.height=data.height||"150",global$1.each(data,function(value,key){data[key]=editor.dom.encode(""+value)}),"iframe"===data.type?function(data){var allowFullscreen=data.allowFullscreen?' allowFullscreen="1"':"";return'<iframe src="'+data.source+'" width="'+data.width+'" height="'+data.height+'"'+allowFullscreen+"></iframe>"}(data):"application/x-shockwave-flash"===data.sourcemime?function(data){var html='<object data="'+data.source+'" width="'+data.width+'" height="'+data.height+'" type="application/x-shockwave-flash">';return data.poster&&(html+='<img src="'+data.poster+'" width="'+data.width+'" height="'+data.height+'" />'),html+="</object>"}(data):-1!==data.sourcemime.indexOf("audio")?function(data,audioTemplateCallback){return audioTemplateCallback?audioTemplateCallback(data):'<audio controls="controls" src="'+data.source+'">'+(data.altsource?'\n<source src="'+data.altsource+'"'+(data.altsourcemime?' type="'+data.altsourcemime+'"':"")+" />\n":"")+"</audio>"}(data,audioTemplateCallback):"script"===data.type?function(data){return'<script src="'+data.source+'"><\/script>'}(data):function(data,videoTemplateCallback){return videoTemplateCallback?videoTemplateCallback(data):'<video width="'+data.width+'" height="'+data.height+'"'+(data.poster?' poster="'+data.poster+'"':"")+' controls="controls">\n<source src="'+data.source+'"'+(data.sourcemime?' type="'+data.sourcemime+'"':"")+" />\n"+(data.altsource?'<source src="'+data.altsource+'"'+(data.altsourcemime?' type="'+data.altsourcemime+'"':"")+" />\n":"")+"</video>"}(data,videoTemplateCallback)}function embedPromise(data,dataToHtml,handler){return new global$6(function(res,rej){function wrappedResolve(response){return response.html&&(cache[data.source]=response),res({url:data.source,html:response.html?response.html:dataToHtml(data)})}cache[data.source]?wrappedResolve(cache[data.source]):handler({url:data.source},wrappedResolve,rej)})}function loadedData(editor){return function(data){return dataToHtml(editor,data)}}function extractMeta(sourceInput,data){return get(data,sourceInput).bind(function(mainData){return get(mainData,"meta")})}function getValue(data,metaData,sourceInput){return function(prop){function getFromData(){return get(data,prop)}function getFromMetaData(){return get(metaData,prop)}function getNonEmptyValue(c){return get(c,"value").bind(function(v){return 0<v.length?Option.some(v):Option.none()})}var _a;return(_a={})[prop]=(prop===sourceInput?getFromData().bind(function(child){return isObject(child)?getNonEmptyValue(child).orThunk(getFromMetaData):getFromMetaData().orThunk(function(){return Option.from(child)})}):getFromMetaData().orThunk(function(){return getFromData().bind(function(child){return isObject(child)?getNonEmptyValue(child):Option.from(child)})})).getOr(""),_a}}function getDimensions(data,metaData){var dimensions={};return get(data,"dimensions").each(function(dims){each(["width","height"],function(prop){get(metaData,prop).orThunk(function(){return get(dims,prop)}).each(function(value){return dimensions[prop]=value})})}),dimensions}function unwrap(data,sourceInput){var metaData=sourceInput?extractMeta(sourceInput,data).getOr({}):{},get=getValue(data,metaData,sourceInput);return __assign(__assign(__assign(__assign(__assign({},get("source")),get("altsource")),get("poster")),get("embed")),getDimensions(data,metaData))}function wrap(data){var wrapped=__assign(__assign({},data),{source:{value:get(data,"source").getOr("")},altsource:{value:get(data,"altsource").getOr("")},poster:{value:get(data,"poster").getOr("")}});return each(["width","height"],function(prop){get(data,prop).each(function(value){var dimensions=wrapped.dimensions||{};dimensions[prop]=value,wrapped.dimensions=dimensions})}),wrapped}function handleError(editor){return function(error){var errorMessage=error&&error.msg?"Media embed handler error: "+error.msg:"Media embed handler threw unknown error.";editor.notificationManager.open({type:"error",text:errorMessage})}}function snippetToData(editor,embedSnippet){return htmlToData(Settings_getScripts(editor),embedSnippet)}function addEmbedHtml(api,editor){return function(response){if(isString(response.url)&&0<response.url.trim().length){var html=response.html,snippetData=snippetToData(editor,html),nuData=__assign(__assign({},snippetData),{source:response.url,embed:html});api.setData(wrap(nuData))}}}function handleInsert(editor,html){var beforeObjects=editor.dom.select("img[data-mce-object]");editor.insertContent(html),function(editor,beforeObjects){for(var afterObjects=editor.dom.select("img[data-mce-object]"),i=0;i<beforeObjects.length;i++)for(var y=afterObjects.length-1;0<=y;y--)beforeObjects[i]===afterObjects[y]&&afterObjects.splice(y,1);editor.selection.select(afterObjects[0])}(editor,beforeObjects),editor.nodeChanged()}function createPlaceholderNode(editor,node){var placeHolder,name=node.name;return(placeHolder=new global$7("img",1)).shortEnded=!0,retainAttributesAndInnerHtml(editor,node,placeHolder),placeHolder.attr({width:node.attr("width")||"300",height:node.attr("height")||("audio"===name?"30":"150"),style:node.attr("style"),src:global$8.transparentSrc,"data-mce-object":name,class:"mce-object mce-object-"+name}),placeHolder}function createPreviewIframeNode(editor,node){var previewWrapper,previewNode,shimNode,name=node.name;return(previewWrapper=new global$7("span",1)).attr({contentEditable:"false",style:node.attr("style"),"data-mce-object":name,class:"mce-preview-object mce-object-"+name}),retainAttributesAndInnerHtml(editor,node,previewWrapper),(previewNode=new global$7(name,1)).attr({src:node.attr("src"),allowfullscreen:node.attr("allowfullscreen"),style:node.attr("style"),class:node.attr("class"),width:node.attr("width"),height:node.attr("height"),frameborder:"0"}),(shimNode=new global$7("span",1)).attr("class","mce-shim"),previewWrapper.append(previewNode),previewWrapper.append(shimNode),previewWrapper}function isPageEmbedWrapper(node){var nodeClass=node.attr("class");return nodeClass&&/\btiny-pageembed\b/.test(nodeClass)}function isWithinEmbedWrapper(node){for(;node=node.parent;)if(node.attr("data-ephox-embed-iri")||isPageEmbedWrapper(node))return!0;return!1}var some=function(a){function self(){return me}function bind(f){return f(a)}var constant_a=constant(a),me={fold:function(n,s){return s(a)},is:function(v){return a===v},isSome:always,isNone:never,getOr:constant_a,getOrThunk:constant_a,getOrDie:constant_a,getOrNull:constant_a,getOrUndefined:constant_a,or:self,orThunk:self,map:function(f){return some(f(a))},each:function(f){f(a)},bind:bind,exists:bind,forall:bind,filter:function(f){return f(a)?me:NONE},toArray:function(){return[a]},toString:function(){return"some("+a+")"},equals:function(o){return o.is(a)},equals_:function(o,elementEq){return o.fold(never,function(b){return elementEq(a,b)})}};return me},Option={some:some,none:none,from:function(value){return null==value?NONE:some(value)}},isString=isType("string"),isObject=isType("object"),isArray=isType("array"),isFunction=isType("function"),nativeSlice=Array.prototype.slice,nativePush=Array.prototype.push,Cell=(isFunction(Array.from)&&Array.from,function(initial){function get(){return value}var value=initial;return{get:get,set:function(v){value=v},clone:function(){return Cell(get())}}}),hasOwnProperty=Object.hasOwnProperty,has=function(obj,key){return hasOwnProperty.call(obj,key)},Settings_getScripts=function(editor){return editor.getParam("media_scripts")},Settings_getAudioTemplateCallback=function(editor){return editor.getParam("audio_template_callback")},Settings_getVideoTemplateCallback=function(editor){return editor.getParam("video_template_callback")},Settings_hasLiveEmbeds=function(editor){return editor.getParam("media_live_embeds",!0)},Settings_shouldFilterHtml=function(editor){return editor.getParam("media_filter_html",!0)},Settings_getUrlResolver=function(editor){return editor.getParam("media_url_resolver")},Settings_hasAltSource=function(editor){return editor.getParam("media_alt_source",!0)},Settings_hasPoster=function(editor){return editor.getParam("media_poster",!0)},Settings_hasDimensions=function(editor){return editor.getParam("media_dimensions",!0)},global$1=tinymce.util.Tools.resolve("tinymce.util.Tools"),global$2=tinymce.util.Tools.resolve("tinymce.dom.DOMUtils"),global$3=tinymce.util.Tools.resolve("tinymce.html.SaxParser"),DOM=global$2.DOM,Mime_guess=function(url){var mime={mp3:"audio/mpeg",m4a:"audio/x-m4a",wav:"audio/wav",mp4:"video/mp4",webm:"video/webm",ogg:"video/ogg",swf:"application/x-shockwave-flash"}[url.toLowerCase().split(".").pop()];return mime||""},global$4=tinymce.util.Tools.resolve("tinymce.html.Schema"),global$5=tinymce.util.Tools.resolve("tinymce.html.Writer"),DOM$1=global$2.DOM,sources=["source","altsource"],UpdateHtml_updateHtml=function(html,data,updateAll){var hasImage,writer=global$5(),isEphoxEmbed=Cell(!1),sourceCount=0;return global$3({validate:!1,allow_conditional_comments:!0,comment:function(text){writer.comment(text)},cdata:function(text){writer.cdata(text)},text:function(text,raw){writer.text(text,raw)},start:function(name,attrs,empty){if(!isEphoxEmbed.get())if(has(attrs.map,"data-ephox-embed-iri"))isEphoxEmbed.set(!0),function(data,attrs){var style=attrs.map.style,styleMap=style?DOM$1.parseStyle(style):{};styleMap["max-width"]=addPx(data.width),styleMap["max-height"]=addPx(data.height),setAttributes(attrs,{style:DOM$1.serializeStyle(styleMap)})}(data,attrs);else{switch(name){case"video":case"object":case"embed":case"img":case"iframe":void 0!==data.height&&void 0!==data.width&&setAttributes(attrs,{width:data.width,height:data.height})}if(updateAll)switch(name){case"video":setAttributes(attrs,{poster:data.poster,src:""}),data.altsource&&setAttributes(attrs,{src:""});break;case"iframe":setAttributes(attrs,{src:data.source});break;case"source":if(sourceCount<2&&(setAttributes(attrs,{src:data[sources[sourceCount]],type:data[sources[sourceCount]+"mime"]}),!data[sources[sourceCount]]))return;sourceCount++;break;case"img":if(!data.poster)return;hasImage=!0}}writer.start(name,attrs,empty)},end:function(name){if(!isEphoxEmbed.get()){if("video"===name&&updateAll)for(var index=0;index<2;index++)if(data[sources[index]]){var attrs=[];attrs.map={},sourceCount<index&&(setAttributes(attrs,{src:data[sources[index]],type:data[sources[index]+"mime"]}),writer.start("source",attrs,!0))}if(data.poster&&"object"===name&&updateAll&&!hasImage){var imgAttrs=[];imgAttrs.map={},setAttributes(imgAttrs,{src:data.poster,width:data.width,height:data.height}),writer.start("img",imgAttrs,!0)}}writer.end(name)}},global$4({})).parse(html),writer.getContent()},urlPatterns=[{regex:/youtu\.be\/([\w\-_\?&=.]+)/i,type:"iframe",w:560,h:314,url:"www.youtube.com/embed/$1",allowFullscreen:!0},{regex:/youtube\.com(.+)v=([^&]+)(&([a-z0-9&=\-_]+))?/i,type:"iframe",w:560,h:314,url:"www.youtube.com/embed/$2?$4",allowFullscreen:!0},{regex:/youtube.com\/embed\/([a-z0-9\?&=\-_]+)/i,type:"iframe",w:560,h:314,url:"www.youtube.com/embed/$1",allowFullscreen:!0},{regex:/vimeo\.com\/([0-9]+)/,type:"iframe",w:425,h:350,url:"player.vimeo.com/video/$1?title=0&byline=0&portrait=0&color=8dc7dc",allowFullscreen:!0},{regex:/vimeo\.com\/(.*)\/([0-9]+)/,type:"iframe",w:425,h:350,url:"player.vimeo.com/video/$2?title=0&amp;byline=0",allowFullscreen:!0},{regex:/maps\.google\.([a-z]{2,3})\/maps\/(.+)msid=(.+)/,type:"iframe",w:425,h:350,url:'maps.google.com/maps/ms?msid=$2&output=embed"',allowFullscreen:!1},{regex:/dailymotion\.com\/video\/([^_]+)/,type:"iframe",w:480,h:270,url:"www.dailymotion.com/embed/video/$1",allowFullscreen:!0},{regex:/dai\.ly\/([^_]+)/,type:"iframe",w:480,h:270,url:"www.dailymotion.com/embed/video/$1",allowFullscreen:!0}],global$6=tinymce.util.Tools.resolve("tinymce.util.Promise"),cache={},Service_getEmbedHtml=function(editor,data){var embedHandler=Settings_getUrlResolver(editor);return embedHandler?embedPromise(data,loadedData(editor),embedHandler):function(data,dataToHtml){return new global$6(function(res){res({html:dataToHtml(data),url:data.source})})}(data,loadedData(editor))},Service_isCached=function(url){return cache.hasOwnProperty(url)},Dialog_showDialog=function(editor){var editorData=function(editor){var element=editor.selection.getNode(),snippet=function(element){return element.getAttribute("data-mce-object")||element.getAttribute("data-ephox-embed-iri")}(element)?editor.serializer.serialize(element,{selection:!0}):"";return __assign({embed:snippet},htmlToData(Settings_getScripts(editor),snippet))}(editor),currentData=Cell(editorData),initialData=wrap(editorData),generalTab={title:"General",name:"general",items:function(xs){for(var r=[],i=0,len=xs.length;i<len;++i){if(!isArray(xs[i]))throw new Error("Arr.flatten item "+i+" was not an array, input: "+xs);nativePush.apply(r,xs[i])}return r}([[{name:"source",type:"urlinput",filetype:"media",label:"Source"}],Settings_hasDimensions(editor)?[{type:"sizeinput",name:"dimensions",label:"Constrain proportions",constrain:!0}]:[]])},embedTab={title:"Embed",items:[{type:"textarea",name:"embed",label:"Paste your embed code below:"}]},advancedFormItems=[];Settings_hasAltSource(editor)&&advancedFormItems.push({name:"altsource",type:"urlinput",filetype:"media",label:"Alternative source URL"}),Settings_hasPoster(editor)&&advancedFormItems.push({name:"poster",type:"urlinput",filetype:"image",label:"Media poster (Image URL)"});var advancedTab={title:"Advanced",name:"advanced",items:advancedFormItems},tabs=[generalTab,embedTab];0<advancedFormItems.length&&tabs.push(advancedTab);var body={type:"tabpanel",tabs:tabs},win=editor.windowManager.open({title:"Insert/Edit Media",size:"normal",body:body,buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"save",text:"Save",primary:!0}],onSubmit:function(api){var serviceData=unwrap(api.getData());!function(prevData,newData,editor){newData.embed=UpdateHtml_updateHtml(newData.embed,newData),newData.embed&&(prevData.source===newData.source||Service_isCached(newData.source))?handleInsert(editor,newData.embed):Service_getEmbedHtml(editor,newData).then(function(response){handleInsert(editor,response.html)}).catch(handleError(editor))}(currentData.get(),serviceData,editor),api.close()},onChange:function(api,detail){switch(detail.name){case"source":!function(prevData,api){var serviceData=unwrap(api.getData(),"source");prevData.source!==serviceData.source&&(addEmbedHtml(win,editor)({url:serviceData.source,html:""}),Service_getEmbedHtml(editor,serviceData).then(addEmbedHtml(win,editor)).catch(handleError(editor)))}(currentData.get(),api);break;case"embed":!function(api){var data=unwrap(api.getData()),dataFromEmbed=snippetToData(editor,data.embed);api.setData(wrap(dataFromEmbed))}(api);break;case"dimensions":case"altsource":case"poster":!function(api,sourceInput){var data=unwrap(api.getData(),sourceInput),embed=dataToHtml(editor,data);api.setData(wrap(__assign(__assign({},data),{embed:embed})))}(api,detail.name)}currentData.set(unwrap(api.getData()))},initialData:initialData})},Api_get=function(editor){return{showDialog:function(){Dialog_showDialog(editor)}}},Commands_register=function(editor){editor.addCommand("mceMedia",function(){Dialog_showDialog(editor)})},global$7=tinymce.util.Tools.resolve("tinymce.html.Node"),global$8=tinymce.util.Tools.resolve("tinymce.Env"),Sanitize_sanitize=function(editor,html){if(!1===Settings_shouldFilterHtml(editor))return html;var blocked,writer=global$5();return global$3({validate:!1,allow_conditional_comments:!1,comment:function(text){writer.comment(text)},cdata:function(text){writer.cdata(text)},text:function(text,raw){writer.text(text,raw)},start:function(name,attrs,empty){if(blocked=!0,"script"!==name&&"noscript"!==name&&"svg"!==name){for(var i=attrs.length-1;0<=i;i--){var attrName=attrs[i].name;0===attrName.indexOf("on")&&(delete attrs.map[attrName],attrs.splice(i,1)),"style"===attrName&&(attrs[i].value=editor.dom.serializeStyle(editor.dom.parseStyle(attrs[i].value),name))}writer.start(name,attrs,empty),blocked=!1}},end:function(name){blocked||writer.end(name)}},global$4({})).parse(html),writer.getContent()},retainAttributesAndInnerHtml=function(editor,sourceNode,targetNode){var attrName,attrValue,attribs,ai,innerHtml;for(ai=(attribs=sourceNode.attributes).length;ai--;)attrName=attribs[ai].name,attrValue=attribs[ai].value,"width"!==attrName&&"height"!==attrName&&"style"!==attrName&&("data"!==attrName&&"src"!==attrName||(attrValue=editor.convertURL(attrValue,attrName)),targetNode.attr("data-mce-p-"+attrName,attrValue));(innerHtml=sourceNode.firstChild&&sourceNode.firstChild.value)&&(targetNode.attr("data-mce-html",escape(Sanitize_sanitize(editor,innerHtml))),targetNode.firstChild=null)},Nodes_placeHolderConverter=function(editor){return function(nodes){for(var node,videoScript,i=nodes.length;i--;)(node=nodes[i]).parent&&(node.parent.attr("data-mce-object")||"script"===node.name&&!(videoScript=getVideoScriptMatch(Settings_getScripts(editor),node.attr("src")))||(videoScript&&(videoScript.width&&node.attr("width",videoScript.width.toString()),videoScript.height&&node.attr("height",videoScript.height.toString())),"iframe"===node.name&&Settings_hasLiveEmbeds(editor)&&global$8.ceFalse?isWithinEmbedWrapper(node)||node.replace(createPreviewIframeNode(editor,node)):isWithinEmbedWrapper(node)||node.replace(createPlaceholderNode(editor,node))))}},FilterContent_setup=function(editor){editor.on("preInit",function(){var specialElements=editor.schema.getSpecialElements();global$1.each("video audio iframe object".split(" "),function(name){specialElements[name]=new RegExp("</"+name+"[^>]*>","gi")});var boolAttrs=editor.schema.getBoolAttrs();global$1.each("webkitallowfullscreen mozallowfullscreen allowfullscreen".split(" "),function(name){boolAttrs[name]={}}),editor.parser.addNodeFilter("iframe,video,audio,object,embed,script",Nodes_placeHolderConverter(editor)),editor.serializer.addAttributeFilter("data-mce-object",function(nodes,name){for(var node,realElm,ai,attribs,innerHtml,innerNode,realElmName,className,i=nodes.length;i--;)if((node=nodes[i]).parent){for(realElmName=node.attr(name),realElm=new global$7(realElmName,1),"audio"!==realElmName&&"script"!==realElmName&&((className=node.attr("class"))&&-1!==className.indexOf("mce-preview-object")?realElm.attr({width:node.firstChild.attr("width"),height:node.firstChild.attr("height")}):realElm.attr({width:node.attr("width"),height:node.attr("height")})),realElm.attr({style:node.attr("style")}),ai=(attribs=node.attributes).length;ai--;){var attrName=attribs[ai].name;0===attrName.indexOf("data-mce-p-")&&realElm.attr(attrName.substr(11),attribs[ai].value)}"script"===realElmName&&realElm.attr("type","text/javascript"),(innerHtml=node.attr("data-mce-html"))&&((innerNode=new global$7("#text",3)).raw=!0,innerNode.value=Sanitize_sanitize(editor,unescape(innerHtml)),realElm.append(innerNode)),node.replace(realElm)}})}),editor.on("SetContent",function(){editor.$("span.mce-preview-object").each(function(index,elm){var $elm=editor.$(elm);0===$elm.find("span.mce-shim").length&&$elm.append('<span class="mce-shim"></span>')})})},ResolveName_setup=function(editor){editor.on("ResolveName",function(e){var name;1===e.target.nodeType&&(name=e.target.getAttribute("data-mce-object"))&&(e.name=name)})},Selection_setup=function(editor){editor.on("click keyup touchend",function(){var selectedNode=editor.selection.getNode();selectedNode&&editor.dom.hasClass(selectedNode,"mce-preview-object")&&editor.dom.getAttrib(selectedNode,"data-mce-selected")&&selectedNode.setAttribute("data-mce-selected","2")}),editor.on("ObjectSelected",function(e){var objectType=e.target.getAttribute("data-mce-object");"audio"!==objectType&&"script"!==objectType||e.preventDefault()}),editor.on("ObjectResized",function(e){var html,target=e.target;target.getAttribute("data-mce-object")&&(html=target.getAttribute("data-mce-html"))&&(html=unescape(html),target.setAttribute("data-mce-html",escape(UpdateHtml_updateHtml(html,{width:String(e.width),height:String(e.height)}))))})},Buttons_register=function(editor){editor.ui.registry.addToggleButton("media",{tooltip:"Insert/edit media",icon:"embed",onAction:function(){editor.execCommand("mceMedia")},onSetup:function(editor,selector){return function(buttonApi){return editor.selection.selectorChangedWithUnbind(selector.join(","),buttonApi.setActive).unbind}}(editor,["img[data-mce-object]","span[data-mce-object]","div[data-ephox-embed-iri]"])}),editor.ui.registry.addMenuItem("media",{icon:"embed",text:"Media...",onAction:function(){editor.execCommand("mceMedia")}})};global.add("media",function(editor){return Commands_register(editor),Buttons_register(editor),ResolveName_setup(editor),FilterContent_setup(editor),Selection_setup(editor),Api_get(editor)})}(),function(){"use strict";function noop(){}function constant(value){return function(){return value}}function none(){return NONE}var me,Cell=function(initial){function get(){return value}var value=initial;return{get:get,set:function(v){value=v},clone:function(){return Cell(get())}}},global=tinymce.util.Tools.resolve("tinymce.PluginManager"),__assign=function(){return(__assign=Object.assign||function(t){for(var s,i=1,n=arguments.length;i<n;i++)for(var p in s=arguments[i])Object.prototype.hasOwnProperty.call(s,p)&&(t[p]=s[p]);return t}).apply(this,arguments)},never=constant(!1),always=constant(!0),punctuation=constant("[!-#%-*,-\\/:;?@\\[-\\]_{};----------------------------------------------]"),NONE=(me={fold:function(n,s){return n()},is:never,isSome:never,isNone:always,getOr:id,getOrThunk:call,getOrDie:function(msg){throw new Error(msg||"error: getOrDie called on none.")},getOrNull:constant(null),getOrUndefined:constant(void 0),or:id,orThunk:call,map:none,each:noop,bind:none,exists:never,forall:always,filter:none,equals:eq,equals_:eq,toArray:function(){return[]},toString:constant("none()")},Object.freeze&&Object.freeze(me),me);function eq(o){return o.isNone()}function call(thunk){return thunk()}function id(n){return n}var some=function(a){function self(){return me}function bind(f){return f(a)}var constant_a=constant(a),me={fold:function(n,s){return s(a)},is:function(v){return a===v},isSome:always,isNone:never,getOr:constant_a,getOrThunk:constant_a,getOrDie:constant_a,getOrNull:constant_a,getOrUndefined:constant_a,or:self,orThunk:self,map:function(f){return some(f(a))},each:function(f){f(a)},bind:bind,exists:bind,forall:bind,filter:function(f){return f(a)?me:NONE},toArray:function(){return[a]},toString:function(){return"some("+a+")"},equals:function(o){return o.is(a)},equals_:function(o,elementEq){return o.fold(never,function(b){return elementEq(a,b)})}};return me},Option={some:some,none:none,from:function(value){return null==value?NONE:some(value)}},punctuation$1=punctuation,global$1=tinymce.util.Tools.resolve("tinymce.util.Tools");function isContentEditableFalse(node){return node&&1===node.nodeType&&"false"===node.contentEditable}function getElmIndex(elm){var value=elm.getAttribute("data-mce-index");return"number"==typeof value?""+value:value}function unwrap(node){var parentNode=node.parentNode;node.firstChild&&parentNode.insertBefore(node.firstChild,node),node.parentNode.removeChild(node)}function findSpansByIndex(editor,index){var nodes,spans=[];if((nodes=global$1.toArray(editor.getBody().getElementsByTagName("span"))).length)for(var i=0;i<nodes.length;i++){var nodeIndex=getElmIndex(nodes[i]);null!==nodeIndex&&nodeIndex.length&&nodeIndex===index.toString()&&spans.push(nodes[i])}return spans}function moveSelection(editor,currentSearchState,forward){var searchState=currentSearchState.get(),testIndex=searchState.index,dom=editor.dom;(forward=!1!==forward)?testIndex+1===searchState.count?testIndex=0:testIndex++:testIndex-1==-1?testIndex=searchState.count-1:testIndex--,dom.removeClass(findSpansByIndex(editor,searchState.index),"mce-match-marker-selected");var spans=findSpansByIndex(editor,testIndex);return spans.length?(dom.addClass(findSpansByIndex(editor,testIndex),"mce-match-marker-selected"),editor.selection.scrollIntoView(spans[0]),testIndex):-1}function removeNode(dom,node){var parent=node.parentNode;dom.remove(node),dom.isEmpty(parent)&&dom.remove(parent)}function find(editor,currentSearchState,text,matchCase,wholeWord){var escapedText=function(text,wholeWord){var wordRegex="("+text.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&").replace(/\s/g,"[^\\S\\r\\n]")+")";return wholeWord?"(?:^|\\s|"+punctuation$1()+")"+wordRegex+"(?=$|\\s|"+punctuation$1()+")":wordRegex}(text,wholeWord),count=function(editor,currentSearchState,regex){var node,marker;return(marker=editor.dom.create("span",{"data-mce-bogus":1})).className="mce-match-marker",node=editor.getBody(),done(editor,currentSearchState,!1),FindReplaceText.findAndReplaceDOMText(regex,node,marker,1,editor.schema)}(editor,currentSearchState,new RegExp(escapedText,matchCase?"g":"gi"));if(count){var newIndex=moveSelection(editor,currentSearchState,!0);currentSearchState.set({index:newIndex,count:count,text:text,matchCase:matchCase,wholeWord:wholeWord})}return count}function next(editor,currentSearchState){var index=moveSelection(editor,currentSearchState,!0);currentSearchState.set(__assign(__assign({},currentSearchState.get()),{index:index}))}function prev(editor,currentSearchState){var index=moveSelection(editor,currentSearchState,!1);currentSearchState.set(__assign(__assign({},currentSearchState.get()),{index:index}))}function isMatchSpan(node){var matchIndex=getElmIndex(node);return null!==matchIndex&&0<matchIndex.length}function replace(editor,currentSearchState,text,forward,all){var i,nodes,node,matchIndex,currentMatchIndex,searchState=currentSearchState.get(),currentIndex=searchState.index,nextIndex=currentIndex;for(forward=!1!==forward,node=editor.getBody(),nodes=global$1.grep(global$1.toArray(node.getElementsByTagName("span")),isMatchSpan),i=0;i<nodes.length;i++){var nodeIndex=getElmIndex(nodes[i]);if(matchIndex=currentMatchIndex=parseInt(nodeIndex,10),all||matchIndex===searchState.index){for(text.length?(nodes[i].firstChild.nodeValue=text,unwrap(nodes[i])):removeNode(editor.dom,nodes[i]);nodes[++i];){if((matchIndex=parseInt(getElmIndex(nodes[i]),10))!==currentMatchIndex){i--;break}removeNode(editor.dom,nodes[i])}forward&&nextIndex--}else currentIndex<currentMatchIndex&&nodes[i].setAttribute("data-mce-index",String(currentMatchIndex-1))}return currentSearchState.set(__assign(__assign({},searchState),{count:all?0:searchState.count-1,index:nextIndex})),forward?next(editor,currentSearchState):prev(editor,currentSearchState),!all&&0<currentSearchState.get().count}function showDialog(editor,currentSearchState){return function(){Dialog_open(editor,currentSearchState)}}var type,FindReplaceText={findAndReplaceDOMText:function(regex,node,replacementNode,captureGroup,schema){var m,text,doc,blockElementsMap,hiddenTextElementsMap,shortEndedElementsMap,matches=[],count=0;function getMatchIndexes(m,captureGroup){if(captureGroup=captureGroup||0,!m[0])throw new Error("findAndReplaceDOMText cannot handle zero-length matches");var index=m.index;if(0<captureGroup){var cg=m[captureGroup];if(!cg)throw new Error("Invalid capture group");index+=m[0].indexOf(cg),m[0]=cg}return[index,index+m[0].length,[m[0]]]}if(doc=node.ownerDocument,blockElementsMap=schema.getBlockElements(),hiddenTextElementsMap=schema.getWhiteSpaceElements(),shortEndedElementsMap=schema.getShortEndedElements(),text=function getText(node){var txt;if(3===node.nodeType)return node.data;if(hiddenTextElementsMap[node.nodeName]&&!blockElementsMap[node.nodeName])return"";if(txt="",isContentEditableFalse(node))return"\n";if((blockElementsMap[node.nodeName]||shortEndedElementsMap[node.nodeName])&&(txt+="\n"),node=node.firstChild)for(;txt+=getText(node),node=node.nextSibling;);return txt}(node)){if(regex.global)for(;m=regex.exec(text);)matches.push(getMatchIndexes(m,captureGroup));else m=text.match(regex),matches.push(getMatchIndexes(m,captureGroup));return matches.length&&(count=matches.length,function(node,matches,replaceFn){var startNode,endNode,startNodeIndex,endNodeIndex,innerNodes=[],atIndex=0,curNode=node,matchLocation=matches.shift(),matchIndex=0;out:for(;;){if((blockElementsMap[curNode.nodeName]||shortEndedElementsMap[curNode.nodeName]||isContentEditableFalse(curNode))&&atIndex++,3===curNode.nodeType&&(!endNode&&curNode.length+atIndex>=matchLocation[1]?(endNode=curNode,endNodeIndex=matchLocation[1]-atIndex):startNode&&innerNodes.push(curNode),!startNode&&curNode.length+atIndex>matchLocation[0]&&(startNode=curNode,startNodeIndex=matchLocation[0]-atIndex),atIndex+=curNode.length),startNode&&endNode){if(curNode=replaceFn({startNode:startNode,startNodeIndex:startNodeIndex,endNode:endNode,endNodeIndex:endNodeIndex,innerNodes:innerNodes,match:matchLocation[2],matchIndex:matchIndex}),atIndex-=endNode.length-endNodeIndex,endNode=startNode=null,innerNodes=[],matchIndex++,!(matchLocation=matches.shift()))break}else if(hiddenTextElementsMap[curNode.nodeName]&&!blockElementsMap[curNode.nodeName]||!curNode.firstChild){if(curNode.nextSibling){curNode=curNode.nextSibling;continue}}else if(!isContentEditableFalse(curNode)){curNode=curNode.firstChild;continue}for(;;){if(curNode.nextSibling){curNode=curNode.nextSibling;break}if(curNode.parentNode===node)break out;curNode=curNode.parentNode}}}(node,matches,function(nodeName){var makeReplacementNode;if("function"!=typeof nodeName){var stencilNode_1=nodeName.nodeType?nodeName:doc.createElement(nodeName);makeReplacementNode=function(fill,matchIndex){var clone=stencilNode_1.cloneNode(!1);return clone.setAttribute("data-mce-index",matchIndex),fill&&clone.appendChild(doc.createTextNode(fill)),clone}}else makeReplacementNode=nodeName;return function(range){var before,after,parentNode,startNode=range.startNode,endNode=range.endNode,matchIndex=range.matchIndex;if(startNode===endNode){var node_1=startNode;parentNode=node_1.parentNode,0<range.startNodeIndex&&(before=doc.createTextNode(node_1.data.substring(0,range.startNodeIndex)),parentNode.insertBefore(before,node_1));var el=makeReplacementNode(range.match[0],matchIndex);return parentNode.insertBefore(el,node_1),range.endNodeIndex<node_1.length&&(after=doc.createTextNode(node_1.data.substring(range.endNodeIndex)),parentNode.insertBefore(after,node_1)),node_1.parentNode.removeChild(node_1),el}before=doc.createTextNode(startNode.data.substring(0,range.startNodeIndex)),after=doc.createTextNode(endNode.data.substring(range.endNodeIndex));for(var elA=makeReplacementNode(startNode.data.substring(range.startNodeIndex),matchIndex),i=0,l=range.innerNodes.length;i<l;++i){var innerNode=range.innerNodes[i],innerEl=makeReplacementNode(innerNode.data,matchIndex);innerNode.parentNode.replaceChild(innerEl,innerNode)}var elB=makeReplacementNode(endNode.data.substring(0,range.endNodeIndex),matchIndex);return(parentNode=startNode.parentNode).insertBefore(before,startNode),parentNode.insertBefore(elA,startNode),parentNode.removeChild(startNode),(parentNode=endNode.parentNode).insertBefore(elB,endNode),parentNode.insertBefore(after,endNode),parentNode.removeChild(endNode),elB}}(replacementNode))),count}}},done=function(editor,currentSearchState,keepEditorSelection){var i,nodes,startContainer,endContainer,searchState=currentSearchState.get();for(nodes=global$1.toArray(editor.getBody().getElementsByTagName("span")),i=0;i<nodes.length;i++){var nodeIndex=getElmIndex(nodes[i]);null!==nodeIndex&&nodeIndex.length&&(nodeIndex===searchState.index.toString()&&(startContainer=startContainer||nodes[i].firstChild,endContainer=nodes[i].firstChild),unwrap(nodes[i]))}if(currentSearchState.set(__assign(__assign({},searchState),{index:-1,count:0,text:""})),startContainer&&endContainer){var rng=editor.dom.createRng();return rng.setStart(startContainer,0),rng.setEnd(endContainer,endContainer.data.length),!1!==keepEditorSelection&&editor.selection.setRng(rng),rng}},Api_get=function(editor,currentState){return{done:function(keepEditorSelection){return done(editor,currentState,keepEditorSelection)},find:function(text,matchCase,wholeWord){return find(editor,currentState,text,matchCase,wholeWord)},next:function(){return next(editor,currentState)},prev:function(){return prev(editor,currentState)},replace:function(text,forward,all){return replace(editor,currentState,text,forward,all)}}},isFunction=(type="function",function(value){return function(x){if(null===x)return"null";var t=typeof x;return"object"==t&&(Array.prototype.isPrototypeOf(x)||x.constructor&&"Array"===x.constructor.name)?"array":"object"==t&&(String.prototype.isPrototypeOf(x)||x.constructor&&"String"===x.constructor.name)?"string":t}(value)===type}),nativeSlice=Array.prototype.slice,global$2=(isFunction(Array.from)&&Array.from,tinymce.util.Tools.resolve("tinymce.Env")),Dialog_open=function(editor,currentSearchState){var dialogApi=function(){var subject=Cell(Option.none());return{clear:function(){subject.set(Option.none())},set:function(s){subject.set(Option.some(s))},isSet:function(){return subject.get().isSome()},on:function(f){subject.get().each(f)}}}();editor.undoManager.add();var selectedText=global$1.trim(editor.selection.getContent({format:"text"}));function updateButtonStates(api){(function(editor,currentSearchState){return 1<currentSearchState.get().count}(0,currentSearchState)?api.enable:api.disable)("next"),(function(editor,currentSearchState){return 1<currentSearchState.get().count}(0,currentSearchState)?api.enable:api.disable)("prev")}function disableAll(api,disable){!function(xs,f){for(var i=0,len=xs.length;i<len;i++){f(xs[i],i)}}(["replace","replaceall","prev","next"],disable?api.disable:api.enable)}function focusButtonIfRequired(api,name){global$2.browser.isSafari()&&global$2.deviceType.isTouch()&&("find"===name||"replace"===name||"replaceall"===name)&&api.focus(name)}function reset(api){done(editor,currentSearchState,!1),disableAll(api,!0),updateButtonStates(api)}function doFind(api){var data=api.getData(),last=currentSearchState.get();if(data.findtext.length){if(last.text===data.findtext&&last.matchCase===data.matchcase&&last.wholeWord===data.wholewords)next(editor,currentSearchState);else{var count=find(editor,currentSearchState,data.findtext,data.matchcase,data.wholewords);count<=0&&function(api){editor.windowManager.alert("Could not find the specified string.",function(){api.focus("findtext")})}(api),disableAll(api,0===count)}updateButtonStates(api)}else reset(api)}var initialState=currentSearchState.get(),spec={title:"Find and Replace",size:"normal",body:{type:"panel",items:[{type:"bar",items:[{type:"input",name:"findtext",placeholder:"Find",maximized:!0,inputMode:"search"},{type:"button",name:"prev",text:"Previous",icon:"action-prev",disabled:!0,borderless:!0},{type:"button",name:"next",text:"Next",icon:"action-next",disabled:!0,borderless:!0}]},{type:"input",name:"replacetext",placeholder:"Replace with",inputMode:"search"}]},buttons:[{type:"menu",name:"options",icon:"preferences",tooltip:"Preferences",align:"start",items:[{type:"togglemenuitem",name:"matchcase",text:"Match case"},{type:"togglemenuitem",name:"wholewords",text:"Find whole words only"}]},{type:"custom",name:"find",text:"Find",primary:!0},{type:"custom",name:"replace",text:"Replace",disabled:!0},{type:"custom",name:"replaceall",text:"Replace All",disabled:!0}],initialData:{findtext:selectedText,replacetext:"",wholewords:initialState.wholeWord,matchcase:initialState.matchCase},onChange:function(api,details){"findtext"===details.name&&0<currentSearchState.get().count&&reset(api)},onAction:function(api,details){var data=api.getData();switch(details.name){case"find":doFind(api);break;case"replace":replace(editor,currentSearchState,data.replacetext)?updateButtonStates(api):reset(api);break;case"replaceall":replace(editor,currentSearchState,data.replacetext,!0,!0),reset(api);break;case"prev":prev(editor,currentSearchState),updateButtonStates(api);break;case"next":next(editor,currentSearchState),updateButtonStates(api);break;case"matchcase":case"wholewords":!function(api){var data=api.getData(),current=currentSearchState.get();currentSearchState.set(__assign(__assign({},current),{matchCase:data.matchcase,wholeWord:data.wholewords}))}(api),reset(api)}focusButtonIfRequired(api,details.name)},onSubmit:function(api){doFind(api),focusButtonIfRequired(api,"find")},onClose:function(){editor.focus(),done(editor,currentSearchState),editor.undoManager.add()}};dialogApi.set(editor.windowManager.open(spec,{inline:"toolbar"}))},Commands_register=function(editor,currentSearchState){editor.addCommand("SearchReplace",function(){Dialog_open(editor,currentSearchState)})},Buttons_register=function(editor,currentSearchState){editor.ui.registry.addMenuItem("searchreplace",{text:"Find and replace...",shortcut:"Meta+F",onAction:showDialog(editor,currentSearchState),icon:"search"}),editor.ui.registry.addButton("searchreplace",{tooltip:"Find and replace",onAction:showDialog(editor,currentSearchState),icon:"search"}),editor.shortcuts.add("Meta+F","",showDialog(editor,currentSearchState))};global.add("searchreplace",function(editor){var currentSearchState=Cell({index:-1,count:0,text:"",matchCase:!1,wholeWord:!1});return Commands_register(editor,currentSearchState),Buttons_register(editor,currentSearchState),Api_get(editor,currentSearchState)})}(),function(){"use strict";var global=tinymce.util.Tools.resolve("tinymce.PluginManager"),global$1=tinymce.util.Tools.resolve("tinymce.Env"),Commands_register=function(editor){editor.addCommand("mcePrint",function(){global$1.browser.isIE()?editor.getDoc().execCommand("print",!1,null):editor.getWin().print()})},Buttons_register=function(editor){editor.ui.registry.addButton("print",{icon:"print",tooltip:"Print",onAction:function(){return editor.execCommand("mcePrint")}}),editor.ui.registry.addMenuItem("print",{text:"Print...",icon:"print",onAction:function(){return editor.execCommand("mcePrint")}})};global.add("print",function(editor){Commands_register(editor),Buttons_register(editor),editor.addShortcut("Meta+P","","mcePrint")})}(),function(domGlobals){"use strict";function noop(){}function constant(value){return function(){return value}}function none(){return NONE}var me,Cell=function(initial){function get(){return value}var value=initial;return{get:get,set:function(v){value=v},clone:function(){return Cell(get())}}},global$1=tinymce.util.Tools.resolve("tinymce.PluginManager"),DetectProPlugin_hasProPlugin=function(editor){return!(!/(^|[ ,])powerpaste([, ]|$)/.test(editor.settings.plugins)||!global$1.get("powerpaste"))&&(void 0!==domGlobals.window.console&&domGlobals.window.console.log&&domGlobals.window.console.log("PowerPaste is incompatible with Paste plugin! Remove 'paste' from the 'plugins' option."),!0)},Api_get=function(clipboard,quirks){return{clipboard:clipboard,quirks:quirks}},Events_firePastePreProcess=function(editor,html,internal,isWordHtml){return editor.fire("PastePreProcess",{content:html,internal:internal,wordContent:isWordHtml})},Events_firePastePostProcess=function(editor,node,internal,isWordHtml){return editor.fire("PastePostProcess",{node:node,internal:internal,wordContent:isWordHtml})},Events_firePastePlainTextToggle=function(editor,state){return editor.fire("PastePlainTextToggle",{state:state})},Events_firePaste=function(editor,ieFake){return editor.fire("paste",{ieFake:ieFake})},Actions_togglePlainTextPaste=function(editor,clipboard){"text"===clipboard.pasteFormat.get()?(clipboard.pasteFormat.set("html"),Events_firePastePlainTextToggle(editor,!1)):(clipboard.pasteFormat.set("text"),Events_firePastePlainTextToggle(editor,!0)),editor.focus()},Commands_register=function(editor,clipboard){editor.addCommand("mceTogglePlainTextPaste",function(){Actions_togglePlainTextPaste(editor,clipboard)}),editor.addCommand("mceInsertClipboardContent",function(ui,value){value.content&&clipboard.pasteHtml(value.content,value.internal),value.text&&clipboard.pasteText(value.text)})},never=constant(!1),always=constant(!0),NONE=(me={fold:function(n,s){return n()},is:never,isSome:never,isNone:always,getOr:id,getOrThunk:call,getOrDie:function(msg){throw new Error(msg||"error: getOrDie called on none.")},getOrNull:constant(null),getOrUndefined:constant(void 0),or:id,orThunk:call,map:none,each:noop,bind:none,exists:never,forall:always,filter:none,equals:eq,equals_:eq,toArray:function(){return[]},toString:constant("none()")},Object.freeze&&Object.freeze(me),me);function eq(o){return o.isNone()}function call(thunk){return thunk()}function id(n){return n}function map(xs,f){for(var len=xs.length,r=new Array(len),i=0;i<len;i++){var x=xs[i];r[i]=f(x,i)}return r}function each(xs,f){for(var i=0,len=xs.length;i<len;i++){f(xs[i],i)}}var type,some=function(a){function self(){return me}function bind(f){return f(a)}var constant_a=constant(a),me={fold:function(n,s){return s(a)},is:function(v){return a===v},isSome:always,isNone:never,getOr:constant_a,getOrThunk:constant_a,getOrDie:constant_a,getOrNull:constant_a,getOrUndefined:constant_a,or:self,orThunk:self,map:function(f){return some(f(a))},each:function(f){f(a)},bind:bind,exists:bind,forall:bind,filter:function(f){return f(a)?me:NONE},toArray:function(){return[a]},toString:function(){return"some("+a+")"},equals:function(o){return o.is(a)},equals_:function(o,elementEq){return o.fold(never,function(b){return elementEq(a,b)})}};return me},Option={some:some,none:none,from:function(value){return null==value?NONE:some(value)}},isFunction=(type="function",function(value){return function(x){if(null===x)return"null";var t=typeof x;return"object"==t&&(Array.prototype.isPrototypeOf(x)||x.constructor&&"Array"===x.constructor.name)?"array":"object"==t&&(String.prototype.isPrototypeOf(x)||x.constructor&&"String"===x.constructor.name)?"string":t}(value)===type}),nativeSlice=Array.prototype.slice,from$1=isFunction(Array.from)?Array.from:function(x){return nativeSlice.call(x)},exports$1={},module={exports:exports$1};!function(define,exports,module,require){!function(f){if("object"==typeof exports&&void 0!==module)module.exports=f();else if("function"==typeof define&&define.amd)define([],f);else{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).EphoxContactWrapper=f()}}(function(){return function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c="function"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error("Cannot find module '"+i+"'");throw a.code="MODULE_NOT_FOUND",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){return o(e[i][1][r]||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u="function"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}({1:[function(require,module,exports){var cachedSetTimeout,cachedClearTimeout,process=module.exports={};function defaultSetTimout(){throw new Error("setTimeout has not been defined")}function defaultClearTimeout(){throw new Error("clearTimeout has not been defined")}function runTimeout(fun){if(cachedSetTimeout===setTimeout)return setTimeout(fun,0);if((cachedSetTimeout===defaultSetTimout||!cachedSetTimeout)&&setTimeout)return cachedSetTimeout=setTimeout,setTimeout(fun,0);try{return cachedSetTimeout(fun,0)}catch(e){try{return cachedSetTimeout.call(null,fun,0)}catch(e){return cachedSetTimeout.call(this,fun,0)}}}!function(){try{cachedSetTimeout="function"==typeof setTimeout?setTimeout:defaultSetTimout}catch(e){cachedSetTimeout=defaultSetTimout}try{cachedClearTimeout="function"==typeof clearTimeout?clearTimeout:defaultClearTimeout}catch(e){cachedClearTimeout=defaultClearTimeout}}();var currentQueue,queue=[],draining=!1,queueIndex=-1;function cleanUpNextTick(){draining&&currentQueue&&(draining=!1,currentQueue.length?queue=currentQueue.concat(queue):queueIndex=-1,queue.length&&drainQueue())}function drainQueue(){if(!draining){var timeout=runTimeout(cleanUpNextTick);draining=!0;for(var len=queue.length;len;){for(currentQueue=queue,queue=[];++queueIndex<len;)currentQueue&&currentQueue[queueIndex].run();queueIndex=-1,len=queue.length}currentQueue=null,draining=!1,function(marker){if(cachedClearTimeout===clearTimeout)return clearTimeout(marker);if((cachedClearTimeout===defaultClearTimeout||!cachedClearTimeout)&&clearTimeout)return cachedClearTimeout=clearTimeout,clearTimeout(marker);try{cachedClearTimeout(marker)}catch(e){try{return cachedClearTimeout.call(null,marker)}catch(e){return cachedClearTimeout.call(this,marker)}}}(timeout)}}function Item(fun,array){this.fun=fun,this.array=array}function noop(){}process.nextTick=function(fun){var args=new Array(arguments.length-1);if(1<arguments.length)for(var i=1;i<arguments.length;i++)args[i-1]=arguments[i];queue.push(new Item(fun,args)),1!==queue.length||draining||runTimeout(drainQueue)},Item.prototype.run=function(){this.fun.apply(null,this.array)},process.title="browser",process.browser=!0,process.env={},process.argv=[],process.version="",process.versions={},process.on=noop,process.addListener=noop,process.once=noop,process.off=noop,process.removeListener=noop,process.removeAllListeners=noop,process.emit=noop,process.prependListener=noop,process.prependOnceListener=noop,process.listeners=function(name){return[]},process.binding=function(name){throw new Error("process.binding is not supported")},process.cwd=function(){return"/"},process.chdir=function(dir){throw new Error("process.chdir is not supported")},process.umask=function(){return 0}},{}],2:[function(require,module,exports){(function(setImmediate){function noop(){}function Promise(fn){if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");if("function"!=typeof fn)throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],doResolve(fn,this)}function handle(self,deferred){for(;3===self._state;)self=self._value;0!==self._state?(self._handled=!0,Promise._immediateFn(function(){var cb=1===self._state?deferred.onFulfilled:deferred.onRejected;if(null!==cb){var ret;try{ret=cb(self._value)}catch(e){return void reject(deferred.promise,e)}resolve(deferred.promise,ret)}else(1===self._state?resolve:reject)(deferred.promise,self._value)})):self._deferreds.push(deferred)}function resolve(self,newValue){try{if(newValue===self)throw new TypeError("A promise cannot be resolved with itself.");if(newValue&&("object"==typeof newValue||"function"==typeof newValue)){var then=newValue.then;if(newValue instanceof Promise)return self._state=3,self._value=newValue,void finale(self);if("function"==typeof then)return void doResolve(function(fn,thisArg){return function(){fn.apply(thisArg,arguments)}}(then,newValue),self)}self._state=1,self._value=newValue,finale(self)}catch(e){reject(self,e)}}function reject(self,newValue){self._state=2,self._value=newValue,finale(self)}function finale(self){2===self._state&&0===self._deferreds.length&&Promise._immediateFn(function(){self._handled||Promise._unhandledRejectionFn(self._value)});for(var i=0,len=self._deferreds.length;i<len;i++)handle(self,self._deferreds[i]);self._deferreds=null}function Handler(onFulfilled,onRejected,promise){this.onFulfilled="function"==typeof onFulfilled?onFulfilled:null,this.onRejected="function"==typeof onRejected?onRejected:null,this.promise=promise}function doResolve(fn,self){var done=!1;try{fn(function(value){done||(done=!0,resolve(self,value))},function(reason){done||(done=!0,reject(self,reason))})}catch(ex){if(done)return;done=!0,reject(self,ex)}}var root,setTimeoutFunc;root=this,setTimeoutFunc=setTimeout,Promise.prototype.catch=function(onRejected){return this.then(null,onRejected)},Promise.prototype.then=function(onFulfilled,onRejected){var prom=new this.constructor(noop);return handle(this,new Handler(onFulfilled,onRejected,prom)),prom},Promise.all=function(arr){var args=Array.prototype.slice.call(arr);return new Promise(function(resolve,reject){if(0===args.length)return resolve([]);var remaining=args.length;function res(i,val){try{if(val&&("object"==typeof val||"function"==typeof val)){var then=val.then;if("function"==typeof then)return void then.call(val,function(val){res(i,val)},reject)}args[i]=val,0==--remaining&&resolve(args)}catch(ex){reject(ex)}}for(var i=0;i<args.length;i++)res(i,args[i])})},Promise.resolve=function(value){return value&&"object"==typeof value&&value.constructor===Promise?value:new Promise(function(resolve){resolve(value)})},Promise.reject=function(value){return new Promise(function(resolve,reject){reject(value)})},Promise.race=function(values){return new Promise(function(resolve,reject){for(var i=0,len=values.length;i<len;i++)values[i].then(resolve,reject)})},Promise._immediateFn="function"==typeof setImmediate?function(fn){setImmediate(fn)}:function(fn){setTimeoutFunc(fn,0)},Promise._unhandledRejectionFn=function(err){"undefined"!=typeof console&&console&&console.warn("Possible Unhandled Promise Rejection:",err)},Promise._setImmediateFn=function(fn){Promise._immediateFn=fn},Promise._setUnhandledRejectionFn=function(fn){Promise._unhandledRejectionFn=fn},void 0!==module&&module.exports?module.exports=Promise:root.Promise||(root.Promise=Promise)}).call(this,require("timers").setImmediate)},{timers:3}],3:[function(require,module,exports){(function(setImmediate,clearImmediate){var nextTick=require("process/browser.js").nextTick,apply=Function.prototype.apply,slice=Array.prototype.slice,immediateIds={},nextImmediateId=0;function Timeout(id,clearFn){this._id=id,this._clearFn=clearFn}exports.setTimeout=function(){return new Timeout(apply.call(setTimeout,window,arguments),clearTimeout)},exports.setInterval=function(){return new Timeout(apply.call(setInterval,window,arguments),clearInterval)},exports.clearTimeout=exports.clearInterval=function(timeout){timeout.close()},Timeout.prototype.unref=Timeout.prototype.ref=function(){},Timeout.prototype.close=function(){this._clearFn.call(window,this._id)},exports.enroll=function(item,msecs){clearTimeout(item._idleTimeoutId),item._idleTimeout=msecs},exports.unenroll=function(item){clearTimeout(item._idleTimeoutId),item._idleTimeout=-1},exports._unrefActive=exports.active=function(item){clearTimeout(item._idleTimeoutId);var msecs=item._idleTimeout;0<=msecs&&(item._idleTimeoutId=setTimeout(function(){item._onTimeout&&item._onTimeout()},msecs))},exports.setImmediate="function"==typeof setImmediate?setImmediate:function(fn){var id=nextImmediateId++,args=!(arguments.length<2)&&slice.call(arguments,1);return immediateIds[id]=!0,nextTick(function(){immediateIds[id]&&(args?fn.apply(null,args):fn.call(null),exports.clearImmediate(id))}),id},exports.clearImmediate="function"==typeof clearImmediate?clearImmediate:function(id){delete immediateIds[id]}}).call(this,require("timers").setImmediate,require("timers").clearImmediate)},{"process/browser.js":1,timers:3}],4:[function(require,module,exports){var promisePolyfill=require("promise-polyfill"),Global="undefined"!=typeof window?window:Function("return this;")();module.exports={boltExport:Global.Promise||promisePolyfill}},{"promise-polyfill":2}]},{},[4])(4)})}(void 0,exports$1,module,void 0);function errorReporter(err){domGlobals.setTimeout(function(){throw err},0)}function par(asyncValues,nu){return nu(function(callback){var r=[],count=0;0===asyncValues.length?callback([]):each(asyncValues,function(asyncValue,i){asyncValue.get(function(i){return function(value){r[i]=value,++count>=asyncValues.length&&callback(r)}}(i))})})}function traverse(array,fn){return function(futures){return par(futures,Future_nu)}(map(array,fn))}function toBRs(text){return text.replace(/\r?\n/g,"<br>")}function toBlockElements(text,rootTag,rootAttrs){var blocks=text.split(/\n\n/),tagOpen=function(rootTag,rootAttrs){var key,attrs=[],tag="<"+rootTag;if("object"==typeof rootAttrs){for(key in rootAttrs)rootAttrs.hasOwnProperty(key)&&attrs.push(key+'="'+global$6.encodeAllRaw(rootAttrs[key])+'"');attrs.length&&(tag+=" "+attrs.join(" "))}return tag+">"}(rootTag,rootAttrs),tagClose="</"+rootTag+">",paragraphs=global$4.map(blocks,function(p){return p.split(/\n/).join("<br />")});return 1===paragraphs.length?paragraphs[0]:global$4.map(paragraphs,function(p){return tagOpen+p+tagClose}).join("")}var Promise=module.exports.boltExport,nu=function(baseFn){var data=Option.none(),callbacks=[],get=function(nCallback){isReady()?call(nCallback):callbacks.push(nCallback)},isReady=function(){return data.isSome()},run=function(cbs){each(cbs,call)},call=function(cb){data.each(function(x){domGlobals.setTimeout(function(){cb(x)},0)})};return baseFn(function(x){data=Option.some(x),run(callbacks),callbacks=[]}),{get:get,map:function(f){return nu(function(nCallback){get(function(data){nCallback(f(data))})})},isReady:isReady}},LazyValue={nu:nu,pure:function(a){return nu(function(callback){callback(a)})}},make=function(run){function get(callback){run().then(callback,errorReporter)}return{map:function(fab){return make(function(){return run().then(fab)})},bind:function(aFutureB){return make(function(){return run().then(function(v){return aFutureB(v).toPromise()})})},anonBind:function(futureB){return make(function(){return run().then(function(){return futureB.toPromise()})})},toLazy:function(){return LazyValue.nu(get)},toCached:function(){var cache=null;return make(function(){return null===cache&&(cache=run()),cache})},toPromise:run,get:get}},Future_nu=function(baseFn){return make(function(){return new Promise(baseFn)})},global$2=tinymce.util.Tools.resolve("tinymce.Env"),global$3=tinymce.util.Tools.resolve("tinymce.util.Delay"),global$4=tinymce.util.Tools.resolve("tinymce.util.Tools"),global$5=tinymce.util.Tools.resolve("tinymce.util.VK"),internalMark="\x3c!-- x-tinymce/html --\x3e",InternalHtml_mark=function(html){return internalMark+html},InternalHtml_unmark=function(html){return html.replace(internalMark,"")},InternalHtml_isMarked=function(html){return-1!==html.indexOf(internalMark)},InternalHtml_internalHtmlMime=function(){return"x-tinymce/html"},global$6=tinymce.util.Tools.resolve("tinymce.html.Entities"),Newlines_isPlainText=function(text){return!/<(?:\/?(?!(?:div|p|br|span)>)\w+|(?:(?!(?:span style="white-space:\s?pre;?">)|br\s?\/>))\w+\s[^>]+)>/i.test(text)},Newlines_convert=function(text,rootTag,rootAttrs){return rootTag?toBlockElements(text,!0===rootTag?"p":rootTag,rootAttrs):toBRs(text)},global$7=tinymce.util.Tools.resolve("tinymce.html.DomParser"),global$8=tinymce.util.Tools.resolve("tinymce.html.Serializer"),global$9=tinymce.util.Tools.resolve("tinymce.html.Node"),global$a=tinymce.util.Tools.resolve("tinymce.html.Schema"),Settings={shouldBlockDrop:function(editor){return editor.getParam("paste_block_drop",!1)},shouldPasteDataImages:function(editor){return editor.getParam("paste_data_images",!1)},shouldFilterDrop:function(editor){return editor.getParam("paste_filter_drop",!0)},getPreProcess:function(editor){return editor.getParam("paste_preprocess")},getPostProcess:function(editor){return editor.getParam("paste_postprocess")},getWebkitStyles:function(editor){return editor.getParam("paste_webkit_styles")},shouldRemoveWebKitStyles:function(editor){return editor.getParam("paste_remove_styles_if_webkit",!0)},shouldMergeFormats:function(editor){return editor.getParam("paste_merge_formats",!0)},isSmartPasteEnabled:function(editor){return editor.getParam("smart_paste",!0)},isPasteAsTextEnabled:function(editor){return editor.getParam("paste_as_text",!1)},getRetainStyleProps:function(editor){return editor.getParam("paste_retain_style_properties")},getWordValidElements:function(editor){return editor.getParam("paste_word_valid_elements","-strong/b,-em/i,-u,-span,-p,-ol,-ul,-li,-h1,-h2,-h3,-h4,-h5,-h6,-p/div,-a[href|name],sub,sup,strike,br,del,table[width],tr,td[colspan|rowspan|width],th[colspan|rowspan|width],thead,tfoot,tbody")},shouldConvertWordFakeLists:function(editor){return editor.getParam("paste_convert_word_fake_lists",!0)},shouldUseDefaultFilters:function(editor){return editor.getParam("paste_enable_default_filters",!0)}};function filter$1(content,items){return global$4.each(items,function(v){content=v.constructor===RegExp?content.replace(v,""):content.replace(v[0],v[1])}),content}var Utils={filter:filter$1,innerText:function(html){var schema=global$a(),domParser=global$7({},schema),text="",shortEndedElements=schema.getShortEndedElements(),ignoreElements=global$4.makeMap("script noscript style textarea video audio iframe object"," "),blockElements=schema.getBlockElements();return html=filter$1(html,[/<!\[[^\]]+\]>/g]),function walk(node){var name=node.name,currentNode=node;if("br"!==name){if("wbr"!==name)if(shortEndedElements[name]&&(text+=" "),ignoreElements[name])text+=" ";else{if(3===node.type&&(text+=node.value),!node.shortEnded&&(node=node.firstChild))for(;walk(node),node=node.next;);blockElements[name]&&currentNode.next&&(text+="\n","p"===name&&(text+="\n"))}}else text+="\n"}(domParser.parse(html)),text},trimHtml:function(html){return html=filter$1(html,[/^[\s\S]*<body[^>]*>\s*|\s*<\/body[^>]*>[\s\S]*$/gi,/<!--StartFragment-->|<!--EndFragment-->/g,[/( ?)<span class="Apple-converted-space">\u00a0<\/span>( ?)/g,function(all,s1,s2){return s1||s2?"":" "}],/<br class="Apple-interchange-newline">/g,/<br>$/i])},createIdGenerator:function(prefix){var count=0;return function(){return prefix+count++}},isMsEdge:function(){return-1!==domGlobals.navigator.userAgent.indexOf(" Edge/")}};function isNumericList(text){var found,patterns;return patterns=[/^[IVXLMCD]{1,2}\.[ \u00a0]/,/^[ivxlmcd]{1,2}\.[ \u00a0]/,/^[a-z]{1,2}[\.\)][ \u00a0]/,/^[A-Z]{1,2}[\.\)][ \u00a0]/,/^[0-9]+\.[ \u00a0]/,/^[\u3007\u4e00\u4e8c\u4e09\u56db\u4e94\u516d\u4e03\u516b\u4e5d]+\.[ \u00a0]/,/^[\u58f1\u5f10\u53c2\u56db\u4f0d\u516d\u4e03\u516b\u4e5d\u62fe]+\.[ \u00a0]/],text=text.replace(/^[\u00a0 ]+/,""),global$4.each(patterns,function(pattern){if(pattern.test(text))return!(found=!0)}),found}function convertFakeListsToProperLists(node){var currentListNode,prevListNode,lastLevel=1;function getText(node){var txt="";if(3===node.type)return node.value;if(node=node.firstChild)for(;txt+=getText(node),node=node.next;);return txt}function trimListStart(node,regExp){if(3===node.type&&regExp.test(node.value))return node.value=node.value.replace(regExp,""),!1;if(node=node.firstChild)do{if(!trimListStart(node,regExp))return!1}while(node=node.next);return!0}function convertParagraphToLi(paragraphNode,listName,start){var level=paragraphNode._listLevel||lastLevel;level!==lastLevel&&(currentListNode=level<lastLevel?currentListNode&&currentListNode.parent.parent:(prevListNode=currentListNode,null)),currentListNode&&currentListNode.name===listName?currentListNode.append(paragraphNode):(prevListNode=prevListNode||currentListNode,currentListNode=new global$9(listName,1),1<start&&currentListNode.attr("start",""+start),paragraphNode.wrap(currentListNode)),paragraphNode.name="li",lastLevel<level&&prevListNode&&prevListNode.lastChild.append(currentListNode),lastLevel=level,function removeIgnoredNodes(node){if(node._listIgnore)node.remove();else if(node=node.firstChild)for(;removeIgnoredNodes(node),node=node.next;);}(paragraphNode),trimListStart(paragraphNode,/^\u00a0+/),trimListStart(paragraphNode,/^\s*([\u2022\u00b7\u00a7\u25CF]|\w+\.)/),trimListStart(paragraphNode,/^\u00a0+/)}for(var elements=[],child=node.firstChild;null!=child;)if(elements.push(child),null!==(child=child.walk()))for(;void 0!==child&&child.parent!==node;)child=child.walk();for(var i=0;i<elements.length;i++)if("p"===(node=elements[i]).name&&node.firstChild){var nodeText=getText(node);if(/^[\s\u00a0]*[\u2022\u00b7\u00a7\u25CF]\s*/.test(nodeText)){convertParagraphToLi(node,"ul");continue}if(isNumericList(nodeText)){var matches=/([0-9]+)\./.exec(nodeText),start=1;matches&&(start=parseInt(matches[1],10)),convertParagraphToLi(node,"ol",start);continue}if(node._listLevel){convertParagraphToLi(node,"ul",1);continue}currentListNode=null}else prevListNode=currentListNode,currentListNode=null}function filterStyles(editor,validStyles,node,styleValue){var matches,outputStyles={},styles=editor.dom.parseStyle(styleValue);return global$4.each(styles,function(value,name){switch(name){case"mso-list":(matches=/\w+ \w+([0-9]+)/i.exec(styleValue))&&(node._listLevel=parseInt(matches[1],10)),/Ignore/i.test(value)&&node.firstChild&&(node._listIgnore=!0,node.firstChild._listIgnore=!0);break;case"horiz-align":name="text-align";break;case"vert-align":name="vertical-align";break;case"font-color":case"mso-foreground":name="color";break;case"mso-background":case"mso-highlight":name="background";break;case"font-weight":case"font-style":return void("normal"!==value&&(outputStyles[name]=value));case"mso-element":if(/^(comment|comment-list)$/i.test(value))return void node.remove()}0!==name.indexOf("mso-comment")?0!==name.indexOf("mso-")&&("all"===Settings.getRetainStyleProps(editor)||validStyles&&validStyles[name])&&(outputStyles[name]=value):node.remove()}),/(bold)/i.test(outputStyles["font-weight"])&&(delete outputStyles["font-weight"],node.wrap(new global$9("b",1))),/(italic)/i.test(outputStyles["font-style"])&&(delete outputStyles["font-style"],node.wrap(new global$9("i",1))),(outputStyles=editor.dom.serializeStyle(outputStyles,node.name))||null}function processResult(content,cancelled){return{content:content,cancelled:cancelled}}function filterContent(editor,content,internal,isWordHtml){var preProcessArgs=Events_firePastePreProcess(editor,content,internal,isWordHtml),filteredContent=function(editor,html){var parser=global$7({},editor.schema);parser.addNodeFilter("meta",function(nodes){global$4.each(nodes,function(node){return node.remove()})});var fragment=parser.parse(html,{forced_root_block:!1,isRootContent:!0});return global$8({validate:editor.settings.validate},editor.schema).serialize(fragment)}(editor,preProcessArgs.content);return editor.hasEventListeners("PastePostProcess")&&!preProcessArgs.isDefaultPrevented()?function(editor,html,internal,isWordHtml){var tempBody=editor.dom.create("div",{style:"display:none"},html),postProcessArgs=Events_firePastePostProcess(editor,tempBody,internal,isWordHtml);return processResult(postProcessArgs.node.innerHTML,postProcessArgs.isDefaultPrevented())}(editor,filteredContent,internal,isWordHtml):processResult(filteredContent,preProcessArgs.isDefaultPrevented())}function pasteHtml(editor,html){return editor.insertContent(html,{merge:Settings.shouldMergeFormats(editor),paste:!0}),!0}function isAbsoluteUrl(url){return/^https?:\/\/[\w\?\-\/+=.&%@~#]+$/i.test(url)}function isImageUrl(url){return isAbsoluteUrl(url)&&/.(gif|jpe?g|png)$/.test(url)}function linkSelection(editor,html,pasteHtmlFn){return!(!1!==editor.selection.isCollapsed()||!isAbsoluteUrl(html))&&function(editor,url,pasteHtmlFn){return editor.undoManager.extra(function(){pasteHtmlFn(editor,url)},function(){editor.execCommand("mceInsertLink",!1,url)}),!0}(editor,html,pasteHtmlFn)}function insertImage(editor,html,pasteHtmlFn){return!!isImageUrl(html)&&function(editor,url,pasteHtmlFn){return editor.undoManager.extra(function(){pasteHtmlFn(editor,url)},function(){editor.insertContent('<img src="'+url+'">')}),!0}(editor,html,pasteHtmlFn)}function isNewLineChar(c){return"\n"===c||"\r"===c}function normalizeWhitespace(text){return function(xs,f,acc){return each(xs,function(x){acc=f(acc,x)}),acc}(text,function(acc,c){return function(c){return-1!==" \f\t\v".indexOf(c)}(c)||""===c?acc.pcIsSpace||""===acc.str||acc.str.length===text.length-1||function(text,idx){return idx<text.length&&0<=idx&&isNewLineChar(text[idx])}(text,acc.str.length+1)?{pcIsSpace:!1,str:acc.str+""}:{pcIsSpace:!0,str:acc.str+" "}:{pcIsSpace:isNewLineChar(c),str:acc.str+c}},{pcIsSpace:!1,str:""}).str}function doPaste(editor,content,internal,pasteAsText){var args=ProcessFilters_process(editor,content,internal);!1===args.cancelled&&SmartPaste_insertContent(editor,args.content,pasteAsText)}function pasteHtml$1(editor,html,internalFlag){var internal=internalFlag||InternalHtml_isMarked(html);doPaste(editor,InternalHtml_unmark(html),internal,!1)}function pasteText(editor,text){var encodedText=editor.dom.encode(text).replace(/\r\n/g,"\n"),normalizedText=normalizeWhitespace(encodedText),html=Newlines_convert(normalizedText,editor.settings.forced_root_block,editor.settings.forced_root_block_attrs);doPaste(editor,html,!1,!0)}function getDataTransferItems(dataTransfer){var items={};if(dataTransfer){if(dataTransfer.getData){var legacyText=dataTransfer.getData("Text");legacyText&&0<legacyText.length&&-1===legacyText.indexOf("data:text/mce-internal,")&&(items["text/plain"]=legacyText)}if(dataTransfer.types)for(var i=0;i<dataTransfer.types.length;i++){var contentType=dataTransfer.types[i];try{items[contentType]=dataTransfer.getData(contentType)}catch(ex){items[contentType]=""}}}return items}function hasContentType(clipboardContent,mimeType){return mimeType in clipboardContent&&0<clipboardContent[mimeType].length}function hasHtmlOrText(content){return hasContentType(content,"text/html")||hasContentType(content,"text/plain")}function pasteImageData(editor,e,rng){var dataTransfer=function(event){return"paste"===event.type}(e)?e.clipboardData:e.dataTransfer;if(editor.settings.paste_data_images&&dataTransfer){var images=function(dataTransfer){var items=dataTransfer.items?map(from$1(dataTransfer.items),function(item){return item.getAsFile()}):[],files=dataTransfer.files?from$1(dataTransfer.files):[];return function(xs,pred){for(var r=[],i=0,len=xs.length;i<len;i++){var x=xs[i];pred(x,i)&&r.push(x)}return r}(0<items.length?items:files,function(file){return/^image\/(jpeg|png|gif|bmp)$/.test(file.type)})}(dataTransfer);if(0<images.length)return e.preventDefault(),function(items){return traverse(items,function(item){return Future_nu(function(resolve){var blob=item.getAsFile?item.getAsFile():item,reader=new window.FileReader;reader.onload=function(){resolve({blob:blob,uri:reader.result})},reader.readAsDataURL(blob)})})}(images).get(function(blobResults){rng&&editor.selection.setRng(rng),each(blobResults,function(result){!function(editor,imageItem){var base64=function(uri){var idx;return-1!==(idx=uri.indexOf(","))?uri.substr(idx+1):null}(imageItem.uri),id=uniqueId(),name=editor.settings.images_reuse_filename&&imageItem.blob.name?function(editor,str){var m=str.match(/([\s\S]+?)\.(?:jpeg|jpg|png|gif)$/i);return m?editor.dom.encode(m[1]):null}(editor,imageItem.blob.name):id,img=new domGlobals.Image;if(img.src=imageItem.uri,function(settings,imgElm){return!settings.images_dataimg_filter||settings.images_dataimg_filter(imgElm)}(editor.settings,img)){var existingBlobInfo,blobCache=editor.editorUpload.blobCache,blobInfo=void 0;(existingBlobInfo=blobCache.findFirst(function(cachedBlobInfo){return cachedBlobInfo.base64()===base64}))?blobInfo=existingBlobInfo:(blobInfo=blobCache.create(id,imageItem.blob,base64,name),blobCache.add(blobInfo)),pasteHtml$1(editor,'<img src="'+blobInfo.blobUri()+'">',!1)}else pasteHtml$1(editor,'<img src="'+imageItem.uri+'">',!1)}(editor,result)})}),!0}return!1}function isKeyboardPasteEvent(e){return global$5.metaKeyPressed(e)&&86===e.keyCode||e.shiftKey&&45===e.keyCode}function registerEventHandlers(editor,pasteBin,pasteFormat){var keyboardPastePlainTextState,keyboardPasteEvent=function(){var subject=Cell(Option.none());return{clear:function(){subject.set(Option.none())},set:function(s){subject.set(Option.some(s))},isSet:function(){return subject.get().isSome()},on:function(f){subject.get().each(f)}}}();function insertClipboardContent(clipboardContent,isKeyBoardPaste,plainTextMode,internal){var content,isPlainTextHtml,isImage;hasContentType(clipboardContent,"text/html")?content=clipboardContent["text/html"]:(content=pasteBin.getHtml(),internal=internal||InternalHtml_isMarked(content),pasteBin.isDefaultContent(content)&&(plainTextMode=!0)),content=Utils.trimHtml(content),pasteBin.remove(),isPlainTextHtml=!1===internal&&Newlines_isPlainText(content),isImage=SmartPaste_isImageUrl(content),content.length&&(!isPlainTextHtml||isImage)||(plainTextMode=!0),(plainTextMode||isImage)&&(content=hasContentType(clipboardContent,"text/plain")&&isPlainTextHtml?clipboardContent["text/plain"]:Utils.innerText(content)),pasteBin.isDefaultContent(content)?isKeyBoardPaste||editor.windowManager.alert("Please use Ctrl+V/Cmd+V keyboard shortcuts to paste contents."):plainTextMode?pasteText(editor,content):pasteHtml$1(editor,content,internal)}editor.on("keydown",function(e){function removePasteBinOnKeyUp(e){isKeyboardPasteEvent(e)&&!e.isDefaultPrevented()&&pasteBin.remove()}if(isKeyboardPasteEvent(e)&&!e.isDefaultPrevented()){if((keyboardPastePlainTextState=e.shiftKey&&86===e.keyCode)&&global$2.webkit&&-1!==domGlobals.navigator.userAgent.indexOf("Version/"))return;if(e.stopImmediatePropagation(),keyboardPasteEvent.set(e),window.setTimeout(function(){keyboardPasteEvent.clear()},100),global$2.ie&&keyboardPastePlainTextState)return e.preventDefault(),void Events_firePaste(editor,!0);pasteBin.remove(),pasteBin.create(),editor.once("keyup",removePasteBinOnKeyUp),editor.once("paste",function(){editor.off("keyup",removePasteBinOnKeyUp)})}}),editor.on("paste",function(e){var isKeyBoardPaste=keyboardPasteEvent.isSet(),clipboardContent=function(editor,clipboardEvent){var content=getDataTransferItems(clipboardEvent.clipboardData||editor.getDoc().dataTransfer);return Utils.isMsEdge()?global$4.extend(content,{"text/html":""}):content}(editor,e),plainTextMode="text"===pasteFormat.get()||keyboardPastePlainTextState,internal=hasContentType(clipboardContent,InternalHtml_internalHtmlMime());keyboardPastePlainTextState=!1,e.isDefaultPrevented()||function(e){var clipboardData=e.clipboardData;return-1!==domGlobals.navigator.userAgent.indexOf("Android")&&clipboardData&&clipboardData.items&&0===clipboardData.items.length}(e)?pasteBin.remove():hasHtmlOrText(clipboardContent)||!pasteImageData(editor,e,pasteBin.getLastRng()||editor.selection.getRng())?(isKeyBoardPaste||e.preventDefault(),!global$2.ie||isKeyBoardPaste&&!e.ieFake||hasContentType(clipboardContent,"text/html")||(pasteBin.create(),editor.dom.bind(pasteBin.getEl(),"paste",function(e){e.stopPropagation()}),editor.getDoc().execCommand("Paste",!1,null),clipboardContent["text/html"]=pasteBin.getHtml()),hasContentType(clipboardContent,"text/html")?(e.preventDefault(),internal=internal||InternalHtml_isMarked(clipboardContent["text/html"]),insertClipboardContent(clipboardContent,isKeyBoardPaste,plainTextMode,internal)):global$3.setEditorTimeout(editor,function(){insertClipboardContent(clipboardContent,isKeyBoardPaste,plainTextMode,internal)},0)):pasteBin.remove()})}function registerEventsAndFilters(editor,pasteBin,pasteFormat){var src;registerEventHandlers(editor,pasteBin,pasteFormat),editor.parser.addNodeFilter("img",function(nodes,name,args){function remove(node){node.attr("data-mce-object")||src===global$2.transparentSrc||node.remove()}function isWebKitFakeUrl(src){return 0===src.indexOf("webkit-fake-url")}function isDataUri(src){return 0===src.indexOf("data:")}if(!editor.settings.paste_data_images&&function(args){return args.data&&!0===args.data.paste}(args))for(var i=nodes.length;i--;)(src=nodes[i].attr("src"))&&(isWebKitFakeUrl(src)?remove(nodes[i]):!editor.settings.allow_html_data_urls&&isDataUri(src)&&remove(nodes[i]))})}function getPasteBinParent(editor){return global$2.ie&&editor.inline?domGlobals.document.body:editor.getBody()}function delegatePasteEvents(editor,pasteBinElm,pasteBinDefaultContent){!function(editor){return getPasteBinParent(editor)!==editor.getBody()}(editor)||editor.dom.bind(pasteBinElm,"paste keyup",function(e){isDefault(editor,pasteBinDefaultContent)||editor.fire("paste")})}function getHtml(editor){function copyAndRemove(toElm,fromElm){toElm.appendChild(fromElm),editor.dom.remove(fromElm,!0)}var pasteBinElm,pasteBinClones,i,dirtyWrappers,cleanWrapper;for(pasteBinClones=global$4.grep(getPasteBinParent(editor).childNodes,function(elm){return"mcepastebin"===elm.id}),pasteBinElm=pasteBinClones.shift(),global$4.each(pasteBinClones,function(pasteBinClone){copyAndRemove(pasteBinElm,pasteBinClone)}),i=(dirtyWrappers=editor.dom.select("div[id=mcepastebin]",pasteBinElm)).length-1;0<=i;i--)cleanWrapper=editor.dom.create("div"),pasteBinElm.insertBefore(cleanWrapper,dirtyWrappers[i]),copyAndRemove(cleanWrapper,dirtyWrappers[i]);return pasteBinElm?pasteBinElm.innerHTML:""}function isDefaultContent(pasteBinDefaultContent,content){return content===pasteBinDefaultContent}function PasteBin(editor){var lastRng=Cell(null);return{create:function(){return function(editor,lastRngCell,pasteBinDefaultContent){var pasteBinElm,dom=editor.dom,body=editor.getBody();lastRngCell.set(editor.selection.getRng()),pasteBinElm=editor.dom.add(getPasteBinParent(editor),"div",{id:"mcepastebin",class:"mce-pastebin",contentEditable:!0,"data-mce-bogus":"all",style:"position: fixed; top: 50%; width: 10px; height: 10px; overflow: hidden; opacity: 0"},pasteBinDefaultContent),(global$2.ie||global$2.gecko)&&dom.setStyle(pasteBinElm,"left","rtl"===dom.getStyle(body,"direction",!0)?65535:-65535),dom.bind(pasteBinElm,"beforedeactivate focusin focusout",function(e){e.stopPropagation()}),delegatePasteEvents(editor,pasteBinElm,pasteBinDefaultContent),pasteBinElm.focus(),editor.selection.select(pasteBinElm,!0)}(editor,lastRng,"%MCEPASTEBIN%")},remove:function(){return function(editor,lastRngCell){if(getEl(editor)){for(var pasteBinClone=void 0,lastRng=lastRngCell.get();pasteBinClone=editor.dom.get("mcepastebin");)editor.dom.remove(pasteBinClone),editor.dom.unbind(pasteBinClone);lastRng&&editor.selection.setRng(lastRng)}lastRngCell.set(null)}(editor,lastRng)},getEl:function(){return getEl(editor)},getHtml:function(){return getHtml(editor)},getLastRng:function(){return function(lastRng){return lastRng.get()}(lastRng)},isDefault:function(){return isDefault(editor,"%MCEPASTEBIN%")},isDefaultContent:function(content){return isDefaultContent("%MCEPASTEBIN%",content)}}}function setHtml5Clipboard(clipboardData,html,text){if(!function(clipboardData){return!1===global$2.iOS&&void 0!==clipboardData&&"function"==typeof clipboardData.setData&&!0!==Utils.isMsEdge()}(clipboardData))return!1;try{return clipboardData.clearData(),clipboardData.setData("text/html",html),clipboardData.setData("text/plain",text),clipboardData.setData(InternalHtml_internalHtmlMime(),html),!0}catch(e){return!1}}function setClipboardData(evt,data,fallback,done){setHtml5Clipboard(evt.clipboardData,data.html,data.text)?(evt.preventDefault(),done()):fallback(data.html,done)}function fallback(editor){return function(html,done){var markedHtml=InternalHtml_mark(html),outer=editor.dom.create("div",{contenteditable:"false","data-mce-bogus":"all"}),inner=editor.dom.create("div",{contenteditable:"true"},markedHtml);editor.dom.setStyles(outer,{position:"fixed",top:"0",left:"-3000px",width:"1000px",overflow:"hidden"}),outer.appendChild(inner),editor.dom.add(editor.getBody(),outer);var range=editor.selection.getRng();inner.focus();var offscreenRange=editor.dom.createRng();offscreenRange.selectNodeContents(inner),editor.selection.setRng(offscreenRange),global$3.setTimeout(function(){editor.selection.setRng(range),outer.parentNode.removeChild(outer),done()},0)}}function getData(editor){return{html:editor.selection.getContent({contextual:!0}),text:editor.selection.getContent({format:"text"})}}function hasSelectedContent(editor){return!editor.selection.isCollapsed()||function(editor){return!!editor.dom.getParent(editor.selection.getStart(),"td[data-mce-selected],th[data-mce-selected]",editor.getBody())}(editor)}function getCaretRangeFromEvent(editor,e){return global$b.getCaretRangeFromPoint(e.clientX,e.clientY,editor.getDoc())}function setFocusedRange(editor,rng){editor.focus(),editor.selection.setRng(rng)}var WordFilter={preProcess:function(editor,content){return Settings.shouldUseDefaultFilters(editor)?function(editor,content){var retainStyleProperties,validStyles;(retainStyleProperties=Settings.getRetainStyleProps(editor))&&(validStyles=global$4.makeMap(retainStyleProperties.split(/[, ]/))),content=Utils.filter(content,[/<br class="?Apple-interchange-newline"?>/gi,/<b[^>]+id="?docs-internal-[^>]*>/gi,/<!--[\s\S]+?-->/gi,/<(!|script[^>]*>.*?<\/script(?=[>\s])|\/?(\?xml(:\w+)?|img|meta|link|style|\w:\w+)(?=[\s\/>]))[^>]*>/gi,[/<(\/?)s>/gi,"<$1strike>"],[/&nbsp;/gi,""],[/<span\s+style\s*=\s*"\s*mso-spacerun\s*:\s*yes\s*;?\s*"\s*>([\s\u00a0]*)<\/span>/gi,function(str,spaces){return 0<spaces.length?spaces.replace(/./," ").slice(Math.floor(spaces.length/2)).split("").join(""):""}]]);var validElements=Settings.getWordValidElements(editor),schema=global$a({valid_elements:validElements,valid_children:"-li[p]"});global$4.each(schema.elements,function(rule){rule.attributes.class||(rule.attributes.class={},rule.attributesOrder.push("class")),rule.attributes.style||(rule.attributes.style={},rule.attributesOrder.push("style"))});var domParser=global$7({},schema);domParser.addAttributeFilter("style",function(nodes){for(var node,i=nodes.length;i--;)(node=nodes[i]).attr("style",filterStyles(editor,validStyles,node,node.attr("style"))),"span"===node.name&&node.parent&&!node.attributes.length&&node.unwrap()}),domParser.addAttributeFilter("class",function(nodes){for(var node,className,i=nodes.length;i--;)className=(node=nodes[i]).attr("class"),/^(MsoCommentReference|MsoCommentText|msoDel)$/i.test(className)&&node.remove(),node.attr("class",null)}),domParser.addNodeFilter("del",function(nodes){for(var i=nodes.length;i--;)nodes[i].remove()}),domParser.addNodeFilter("a",function(nodes){for(var node,href,name,i=nodes.length;i--;)if(href=(node=nodes[i]).attr("href"),name=node.attr("name"),href&&-1!==href.indexOf("#_msocom_"))node.remove();else if(href&&0===href.indexOf("file://")&&(href=(href=href.split("#")[1])&&"#"+href),href||name){if(name&&!/^_?(?:toc|edn|ftn)/i.test(name)){node.unwrap();continue}node.attr({href:href,name:name})}else node.unwrap()});var rootNode=domParser.parse(content);return Settings.shouldConvertWordFakeLists(editor)&&convertFakeListsToProperLists(rootNode),content=global$8({validate:editor.settings.validate},schema).serialize(rootNode)}(editor,content):content},isWordContent:function(content){return/<font face="Times New Roman"|class="?Mso|style="[^"]*\bmso-|style='[^'']*\bmso-|w:WordDocument/i.test(content)||/class="OutlineElement/.test(content)||/id="?docs\-internal\-guid\-/.test(content)}},ProcessFilters_process=function(editor,html,internal){var isWordHtml=WordFilter.isWordContent(html),content=isWordHtml?WordFilter.preProcess(editor,html):html;return filterContent(editor,content,internal,isWordHtml)},SmartPaste_isImageUrl=isImageUrl,SmartPaste_insertContent=function(editor,html,pasteAsText){pasteAsText||!1===Settings.isSmartPasteEnabled(editor)?pasteHtml(editor,html):function(editor,html){global$4.each([linkSelection,insertImage,pasteHtml],function(action){return!0!==action(editor,html,pasteHtml)})}(editor,html)},uniqueId=Utils.createIdGenerator("mceclip"),getEl=function(editor){return editor.dom.get("mcepastebin")},isDefault=function(editor,pasteBinDefaultContent){var pasteBinElm=getEl(editor);return function(elm){return elm&&"mcepastebin"===elm.id}(pasteBinElm)&&isDefaultContent(pasteBinDefaultContent,pasteBinElm.innerHTML)},CutCopy_register=function(editor){editor.on("cut",function(editor){return function(evt){hasSelectedContent(editor)&&setClipboardData(evt,getData(editor),fallback(editor),function(){if(global$2.browser.isChrome()){var rng_1=editor.selection.getRng();global$3.setEditorTimeout(editor,function(){editor.selection.setRng(rng_1),editor.execCommand("Delete")},0)}else editor.execCommand("Delete")})}}(editor)),editor.on("copy",function(editor){return function(evt){hasSelectedContent(editor)&&setClipboardData(evt,getData(editor),fallback(editor),function(){})}}(editor))},global$b=tinymce.util.Tools.resolve("tinymce.dom.RangeUtils"),DragDrop_setup=function(editor,clipboard,draggingInternallyState){Settings.shouldBlockDrop(editor)&&editor.on("dragend dragover draggesture dragdrop drop drag",function(e){e.preventDefault(),e.stopPropagation()}),Settings.shouldPasteDataImages(editor)||editor.on("drop",function(e){var dataTransfer=e.dataTransfer;dataTransfer&&dataTransfer.files&&0<dataTransfer.files.length&&e.preventDefault()}),editor.on("drop",function(e){var dropContent,rng;if(rng=getCaretRangeFromEvent(editor,e),!e.isDefaultPrevented()&&!draggingInternallyState.get()){dropContent=clipboard.getDataTransferItems(e.dataTransfer);var internal=clipboard.hasContentType(dropContent,InternalHtml_internalHtmlMime());if((clipboard.hasHtmlOrText(dropContent)&&!function(content){var plainTextContent=content["text/plain"];return!!plainTextContent&&0===plainTextContent.indexOf("file://")}(dropContent)||!clipboard.pasteImageData(e,rng))&&rng&&Settings.shouldFilterDrop(editor)){var content_1=dropContent["mce-internal"]||dropContent["text/html"]||dropContent["text/plain"];content_1&&(e.preventDefault(),global$3.setEditorTimeout(editor,function(){editor.undoManager.transact(function(){dropContent["mce-internal"]&&editor.execCommand("Delete"),setFocusedRange(editor,rng),content_1=Utils.trimHtml(content_1),dropContent["text/html"]?clipboard.pasteHtml(content_1,internal):clipboard.pasteText(content_1)})}))}}}),editor.on("dragstart",function(e){draggingInternallyState.set(!0)}),editor.on("dragover dragend",function(e){Settings.shouldPasteDataImages(editor)&&!1===draggingInternallyState.get()&&(e.preventDefault(),setFocusedRange(editor,getCaretRangeFromEvent(editor,e))),"dragend"===e.type&&draggingInternallyState.set(!1)})},PrePostProcess_setup=function(editor){var plugin=editor.plugins.paste,preProcess=Settings.getPreProcess(editor);preProcess&&editor.on("PastePreProcess",function(e){preProcess.call(plugin,plugin,e)});var postProcess=Settings.getPostProcess(editor);postProcess&&editor.on("PastePostProcess",function(e){postProcess.call(plugin,plugin,e)})};function addPreProcessFilter(editor,filterFunc){editor.on("PastePreProcess",function(e){e.content=filterFunc(editor,e.content,e.internal,e.wordContent)})}function removeExplorerBrElementsAfterBlocks(editor,html){if(!WordFilter.isWordContent(html))return html;var blockElements=[];global$4.each(editor.schema.getBlockElements(),function(block,blockName){blockElements.push(blockName)});var explorerBlocksRegExp=new RegExp("(?:<br>&nbsp;[\\s\\r\\n]+|<br>)*(<\\/?("+blockElements.join("|")+")[^>]*>)(?:<br>&nbsp;[\\s\\r\\n]+|<br>)*","g");return html=Utils.filter(html,[[explorerBlocksRegExp,"$1"]]),html=Utils.filter(html,[[/<br><br>/g,"<BR><BR>"],[/<br>/g," "],[/<BR><BR>/g,"<br>"]])}function removeWebKitStyles(editor,content,internal,isWordHtml){if(isWordHtml||internal)return content;var webKitStyles,webKitStylesSetting=Settings.getWebkitStyles(editor);if(!1===Settings.shouldRemoveWebKitStyles(editor)||"all"===webKitStylesSetting)return content;if(webKitStylesSetting&&(webKitStyles=webKitStylesSetting.split(/[, ]/)),webKitStyles){var dom_1=editor.dom,node_1=editor.selection.getNode();content=content.replace(/(<[^>]+) style="([^"]*)"([^>]*>)/gi,function(all,before,value,after){var inputStyles=dom_1.parseStyle(dom_1.decode(value)),outputStyles={};if("none"===webKitStyles)return before+after;for(var i=0;i<webKitStyles.length;i++){var inputValue=inputStyles[webKitStyles[i]],currentValue=dom_1.getStyle(node_1,webKitStyles[i],!0);/color/.test(webKitStyles[i])&&(inputValue=dom_1.toHex(inputValue),currentValue=dom_1.toHex(currentValue)),currentValue!==inputValue&&(outputStyles[webKitStyles[i]]=inputValue)}return(outputStyles=dom_1.serializeStyle(outputStyles,"span"))?before+' style="'+outputStyles+'"'+after:before+after})}else content=content.replace(/(<[^>]+) style="([^"]*)"([^>]*>)/gi,"$1$3");return content=content.replace(/(<[^>]+) data-mce-style="([^"]+)"([^>]*>)/gi,function(all,before,value,after){return before+' style="'+value+'"'+after})}function removeUnderlineAndFontInAnchor(editor,root){editor.$("a",root).find("font,u").each(function(i,node){editor.dom.remove(node,!0)})}function makeSetupHandler(editor,clipboard){return function(api){api.setActive("text"===clipboard.pasteFormat.get());function pastePlainTextToggleHandler(e){return api.setActive(e.state)}return editor.on("PastePlainTextToggle",pastePlainTextToggleHandler),function(){return editor.off("PastePlainTextToggle",pastePlainTextToggleHandler)}}}var Quirks_setup=function(editor){global$2.webkit&&addPreProcessFilter(editor,removeWebKitStyles),global$2.ie&&(addPreProcessFilter(editor,removeExplorerBrElementsAfterBlocks),function(editor,filterFunc){editor.on("PastePostProcess",function(e){filterFunc(editor,e.node)})}(editor,removeUnderlineAndFontInAnchor))},Buttons_register=function(editor,clipboard){editor.ui.registry.addToggleButton("pastetext",{active:!1,icon:"paste-text",tooltip:"Paste as text",onAction:function(){return editor.execCommand("mceTogglePlainTextPaste")},onSetup:makeSetupHandler(editor,clipboard)}),editor.ui.registry.addToggleMenuItem("pastetext",{text:"Paste as text",onAction:function(){return editor.execCommand("mceTogglePlainTextPaste")},onSetup:makeSetupHandler(editor,clipboard)})};global$1.add("paste",function(editor){if(!1===DetectProPlugin_hasProPlugin(editor)){var draggingInternallyState=Cell(!1),clipboard=function(editor,pasteFormat){var pasteBin=PasteBin(editor);return editor.on("PreInit",function(){return registerEventsAndFilters(editor,pasteBin,pasteFormat)}),{pasteFormat:pasteFormat,pasteHtml:function(html,internalFlag){return pasteHtml$1(editor,html,internalFlag)},pasteText:function(text){return pasteText(editor,text)},pasteImageData:function(e,rng){return pasteImageData(editor,e,rng)},getDataTransferItems:getDataTransferItems,hasHtmlOrText:hasHtmlOrText,hasContentType:hasContentType}}(editor,Cell(Settings.isPasteAsTextEnabled(editor)?"text":"html")),quirks=Quirks_setup(editor);return Buttons_register(editor,clipboard),Commands_register(editor,clipboard),PrePostProcess_setup(editor),CutCopy_register(editor),DragDrop_setup(editor,clipboard,draggingInternallyState),Api_get(clipboard,quirks)}})}(window),function(domGlobals){"use strict";function noop(){}function constant(value){return function(){return value}}function none(){return NONE}var me,global=tinymce.util.Tools.resolve("tinymce.PluginManager"),global$1=tinymce.util.Tools.resolve("tinymce.util.Tools"),Direction_setDir=function(editor,dir){var curDir,dom=editor.dom,blocks=editor.selection.getSelectedBlocks();blocks.length&&(curDir=dom.getAttrib(blocks[0],"dir"),global$1.each(blocks,function(block){dom.getParent(block.parentNode,'*[dir="'+dir+'"]',dom.getRoot())||dom.setAttrib(block,"dir",curDir!==dir?dir:null)}),editor.nodeChanged())},Commands_register=function(editor){editor.addCommand("mceDirectionLTR",function(){Direction_setDir(editor,"ltr")}),editor.addCommand("mceDirectionRTL",function(){Direction_setDir(editor,"rtl")})},never=constant(!1),always=constant(!0),NONE=(me={fold:function(n,s){return n()},is:never,isSome:never,isNone:always,getOr:id,getOrThunk:call,getOrDie:function(msg){throw new Error(msg||"error: getOrDie called on none.")},getOrNull:constant(null),getOrUndefined:constant(void 0),or:id,orThunk:call,map:none,each:noop,bind:none,exists:never,forall:always,filter:none,equals:eq,equals_:eq,toArray:function(){return[]},toString:constant("none()")},Object.freeze&&Object.freeze(me),me);function eq(o){return o.isNone()}function call(thunk){return thunk()}function id(n){return n}function get(element,property){var dom=element.dom(),r=domGlobals.window.getComputedStyle(dom).getPropertyValue(property),v=""!==r||function(element){var dom=isText(element)?element.dom().parentNode:element.dom();return null!=dom&&dom.ownerDocument.body.contains(dom)}(element)?r:getUnsafeProperty(dom,property);return null===v?void 0:v}function getNodeChangeHandler(editor,dir){return function(api){function nodeChangeHandler(e){var element=Element.fromDom(e.element);api.setActive(function(element){return"rtl"===get(element,"direction")?"rtl":"ltr"}(element)===dir)}return editor.on("NodeChange",nodeChangeHandler),function(){return editor.off("NodeChange",nodeChangeHandler)}}}var t,some=function(a){function self(){return me}function bind(f){return f(a)}var constant_a=constant(a),me={fold:function(n,s){return s(a)},is:function(v){return a===v},isSome:always,isNone:never,getOr:constant_a,getOrThunk:constant_a,getOrDie:constant_a,getOrNull:constant_a,getOrUndefined:constant_a,or:self,orThunk:self,map:function(f){return some(f(a))},each:function(f){f(a)},bind:bind,exists:bind,forall:bind,filter:function(f){return f(a)?me:NONE},toArray:function(){return[a]},toString:function(){return"some("+a+")"},equals:function(o){return o.is(a)},equals_:function(o,elementEq){return o.fold(never,function(b){return elementEq(a,b)})}};return me},Option_from=function(value){return null==value?NONE:some(value)},fromDom=function(node){if(null==node)throw new Error("Node cannot be null or undefined");return{dom:constant(node)}},Element={fromHtml:function(html,scope){var div=(scope||domGlobals.document).createElement("div");if(div.innerHTML=html,!div.hasChildNodes()||1<div.childNodes.length)throw domGlobals.console.error("HTML does not have a single root node",html),new Error("HTML must have a single root node");return fromDom(div.childNodes[0])},fromTag:function(tag,scope){var node=(scope||domGlobals.document).createElement(tag);return fromDom(node)},fromText:function(text,scope){var node=(scope||domGlobals.document).createTextNode(text);return fromDom(node)},fromDom:fromDom,fromPoint:function(docElm,x,y){var doc=docElm.dom();return Option_from(doc.elementFromPoint(x,y)).map(fromDom)}},isFunction=function(type){return function(value){return function(x){if(null===x)return"null";var t=typeof x;return"object"==t&&(Array.prototype.isPrototypeOf(x)||x.constructor&&"Array"===x.constructor.name)?"array":"object"==t&&(String.prototype.isPrototypeOf(x)||x.constructor&&"String"===x.constructor.name)?"string":t}(value)===type}}("function"),nativeSlice=Array.prototype.slice,TEXT=(isFunction(Array.from)&&Array.from,domGlobals.Node.ATTRIBUTE_NODE,domGlobals.Node.CDATA_SECTION_NODE,domGlobals.Node.COMMENT_NODE,domGlobals.Node.DOCUMENT_NODE,domGlobals.Node.DOCUMENT_TYPE_NODE,domGlobals.Node.DOCUMENT_FRAGMENT_NODE,domGlobals.Node.ELEMENT_NODE,domGlobals.Node.TEXT_NODE),isText=(domGlobals.Node.PROCESSING_INSTRUCTION_NODE,domGlobals.Node.ENTITY_REFERENCE_NODE,domGlobals.Node.ENTITY_NODE,domGlobals.Node.NOTATION_NODE,void 0!==domGlobals.window?domGlobals.window:Function("return this;")(),t=TEXT,function(element){return function(element){return element.dom().nodeType}(element)===t}),getUnsafeProperty=function(dom,property){return function(dom){return void 0!==dom.style&&isFunction(dom.style.getPropertyValue)}(dom)?dom.style.getPropertyValue(property):""},Buttons_register=function(editor){editor.ui.registry.addToggleButton("ltr",{tooltip:"Left to right",icon:"ltr",onAction:function(){return editor.execCommand("mceDirectionLTR")},onSetup:getNodeChangeHandler(editor,"ltr")}),editor.ui.registry.addToggleButton("rtl",{tooltip:"Right to left",icon:"rtl",onAction:function(){return editor.execCommand("mceDirectionRTL")},onSetup:getNodeChangeHandler(editor,"rtl")})};global.add("directionality",function(editor){Commands_register(editor),Buttons_register(editor)})}(window),function(domGlobals){"use strict";function noop(){}function constant(value){return function(){return value}}function none(){return NONE}function unbindable(){return function(doRevoke){function revoke(){subject.get().each(doRevoke)}var subject=Cell(Option.none());return{clear:function(){revoke(),subject.set(Option.none())},isSet:function(){return subject.get().isSome()},set:function(s){revoke(),subject.set(Option.some(s))}}}(function(s){s.unbind()})}function isType(type){return function(value){return function(x){if(null===x)return"null";var t=typeof x;return"object"==t&&(Array.prototype.isPrototypeOf(x)||x.constructor&&"Array"===x.constructor.name)?"array":"object"==t&&(String.prototype.isPrototypeOf(x)||x.constructor&&"String"===x.constructor.name)?"string":t}(value)===type}}function map(xs,f){for(var len=xs.length,r=new Array(len),i=0;i<len;i++){var x=xs[i];r[i]=f(x,i)}return r}function each(xs,f){for(var i=0,len=xs.length;i<len;i++){f(xs[i],i)}}function filter(xs,pred){for(var r=[],i=0,len=xs.length;i<len;i++){var x=xs[i];pred(x,i)&&r.push(x)}return r}function bind(xs,f){return function(xs){for(var r=[],i=0,len=xs.length;i<len;++i){if(!isArray(xs[i]))throw new Error("Arr.flatten item "+i+" was not an array, input: "+xs);nativePush.apply(r,xs[i])}return r}(map(xs,f))}function contains(str,substr){return-1!==str.indexOf(substr)}function isSupported(dom){return void 0!==dom.style&&isFunction(dom.style.getPropertyValue)}function set(element,key,value){!function(dom,key,value){if(!(isString(value)||isBoolean(value)||isNumber(value)))throw domGlobals.console.error("Invalid call to Attr.set. Key ",key,":: Value ",value,":: Element ",dom),new Error("Attribute value was not simple");dom.setAttribute(key,value+"")}(element.dom(),key,value)}function get$1(element,key){var v=element.dom().getAttribute(key);return null===v?void 0:v}function remove(element,key){element.dom().removeAttribute(key)}function setAll(element,css){var dom=element.dom();!function(obj,f){for(var props=keys(obj),k=0,len=props.length;k<len;k++){var i=props[k];f(obj[i],i)}}(css,function(v,k){!function(dom,property,value){if(!isString(value))throw domGlobals.console.error("Invalid call to CSS.set. Property ",property,":: Value ",value,":: Element ",dom),new Error("CSS value must be a string: "+value);isSupported(dom)&&dom.style.setProperty(property,value)}(dom,k,v)})}function get$2(element,property){var dom=element.dom(),r=domGlobals.window.getComputedStyle(dom).getPropertyValue(property),v=""!==r||function(element){var dom=isText(element)?element.dom().parentNode:element.dom();return null!=dom&&dom.ownerDocument.body.contains(dom)}(element)?r:getUnsafeProperty(dom,property);return null===v?void 0:v}function fromRawEvent(rawEvent){function stop(){rawEvent.stopPropagation()}function prevent(){rawEvent.preventDefault()}var target=Element.fromDom(rawEvent.target),kill=function(fa,fb){return function(){for(var args=[],_i=0;_i<arguments.length;_i++)args[_i]=arguments[_i];return fa(fb.apply(null,args))}}(prevent,stop);return function(target,x,y,stop,prevent,kill,raw){return{target:constant(target),x:constant(x),y:constant(y),stop:stop,prevent:prevent,kill:kill,raw:constant(raw)}}(target,rawEvent.clientX,rawEvent.clientY,stop,prevent,kill,rawEvent)}function find$1(regexes,agent){var r=function(regexes,s){for(var i=0;i<regexes.length;i++){var x=regexes[i];if(x.test(s))return x}}(regexes,agent);if(!r)return{major:0,minor:0};function group(i){return Number(agent.replace(r,"$"+i))}return nu(group(1),group(2))}function isBrowser(name,current){return function(){return current===name}}function isOS(name,current){return function(){return current===name}}function detect$1(candidates,userAgent){var agent=String(userAgent).toLowerCase();return function(xs,pred){for(var i=0,len=xs.length;i<len;i++){var x=xs[i];if(pred(x,i))return Option.some(x)}return Option.none()}(candidates,function(candidate){return candidate.search(agent)})}function checkContains(target){return function(uastring){return contains(uastring,target)}}function detect$3(){return platform.get()}function compareDocumentPosition(a,b,match){return 0!=(a.compareDocumentPosition(b)&match)}function is(element,selector){var dom=element.dom();if(dom.nodeType!==ELEMENT$1)return!1;var elem=dom;if(void 0!==elem.matches)return elem.matches(selector);if(void 0!==elem.msMatchesSelector)return elem.msMatchesSelector(selector);if(void 0!==elem.webkitMatchesSelector)return elem.webkitMatchesSelector(selector);if(void 0!==elem.mozMatchesSelector)return elem.mozMatchesSelector(selector);throw new Error("Browser lacks native selectors")}function all(selector,scope){var base=void 0===scope?domGlobals.document:scope.dom();return function(dom){return dom.nodeType!==ELEMENT$1&&dom.nodeType!==DOCUMENT$1||0===dom.childElementCount}(base)?[]:map(base.querySelectorAll(selector),Element.fromDom)}function siblings(element){return function(element){return Option.from(element.dom().parentNode).map(Element.fromDom)}(element).map(children).map(function(elements){return filter(elements,function(x){return!function(e1,e2){return e1.dom()===e2.dom()}(element,x)})}).getOr([])}function get$4(_win){var win=void 0===_win?domGlobals.window:_win;return Option.from(win.visualViewport)}function bounds(x,y,width,height){return{x:constant(x),y:constant(y),width:constant(width),height:constant(height),right:constant(x+width),bottom:constant(y+height)}}function getBounds(_win){var win=void 0===_win?domGlobals.window:_win,doc=win.document,scroll=function(_DOC){var doc=void 0!==_DOC?_DOC.dom():domGlobals.document,x=doc.body.scrollLeft||doc.documentElement.scrollLeft,y=doc.body.scrollTop||doc.documentElement.scrollTop;return Position(x,y)}(Element.fromDom(doc));return get$4(win).fold(function(){var html=win.document.documentElement,width=html.clientWidth,height=html.clientHeight;return bounds(scroll.left(),scroll.top(),width,height)},function(visualViewport){return bounds(Math.max(visualViewport.pageLeft,scroll.left()),Math.max(visualViewport.pageTop,scroll.top()),visualViewport.width,visualViewport.height)})}function bind$1(name,callback,_win){return get$4(_win).map(function(visualViewport){function handler(e){return fromRawEvent(e)}return visualViewport.addEventListener(name,handler),{unbind:function(){return visualViewport.removeEventListener(name,handler)}}}).getOrThunk(function(){return{unbind:noop}})}function ancestors(scope,predicate,isRoot){return filter(function(element,isRoot){for(var stop=isFunction(isRoot)?isRoot:never,dom=element.dom(),ret=[];null!==dom.parentNode&&void 0!==dom.parentNode;){var rawParent=dom.parentNode,p=Element.fromDom(rawParent);if(ret.push(p),!0===stop(p))break;dom=rawParent}return ret}(scope,isRoot),predicate)}function ancestors$1(scope,selector,isRoot){return ancestors(scope,function(e){return is(e,selector)},isRoot)}function siblings$2(scope,selector){return function(scope,predicate){return filter(siblings(scope),predicate)}(scope,function(e){return is(e,selector)})}function makeSetupHandler(editor,fullscreenState){return function(api){api.setActive(null!==fullscreenState.get());function editorEventCallback(e){return api.setActive(e.state)}return editor.on("FullscreenStateChanged",editorEventCallback),function(){return editor.off("FullscreenStateChanged",editorEventCallback)}}}var t,Cell=function(initial){function get(){return value}var value=initial;return{get:get,set:function(v){value=v},clone:function(){return Cell(get())}}},global=tinymce.util.Tools.resolve("tinymce.PluginManager"),Api_get=function(fullscreenState){return{isFullscreen:function(){return null!==fullscreenState.get()}}},never=constant(!1),always=constant(!0),NONE=function(){function eq(o){return o.isNone()}function call(thunk){return thunk()}function id(n){return n}var me={fold:function(n,s){return n()},is:never,isSome:never,isNone:always,getOr:id,getOrThunk:call,getOrDie:function(msg){throw new Error(msg||"error: getOrDie called on none.")},getOrNull:constant(null),getOrUndefined:constant(void 0),or:id,orThunk:call,map:none,each:noop,bind:none,exists:never,forall:always,filter:none,equals:eq,equals_:eq,toArray:function(){return[]},toString:constant("none()")};return Object.freeze&&Object.freeze(me),me}(),some=function(a){function self(){return me}function bind(f){return f(a)}var constant_a=constant(a),me={fold:function(n,s){return s(a)},is:function(v){return a===v},isSome:always,isNone:never,getOr:constant_a,getOrThunk:constant_a,getOrDie:constant_a,getOrNull:constant_a,getOrUndefined:constant_a,or:self,orThunk:self,map:function(f){return some(f(a))},each:function(f){f(a)},bind:bind,exists:bind,forall:bind,filter:function(f){return f(a)?me:NONE},toArray:function(){return[a]},toString:function(){return"some("+a+")"},equals:function(o){return o.is(a)},equals_:function(o,elementEq){return o.fold(never,function(b){return elementEq(a,b)})}};return me},Option={some:some,none:none,from:function(value){return null==value?NONE:some(value)}},isString=isType("string"),isArray=isType("array"),isBoolean=isType("boolean"),isFunction=isType("function"),isNumber=isType("number"),nativeSlice=Array.prototype.slice,nativePush=Array.prototype.push,keys=(isFunction(Array.from)&&Array.from,Object.keys),fromDom=function(node){if(null==node)throw new Error("Node cannot be null or undefined");return{dom:constant(node)}},Element={fromHtml:function(html,scope){var div=(scope||domGlobals.document).createElement("div");if(div.innerHTML=html,!div.hasChildNodes()||1<div.childNodes.length)throw domGlobals.console.error("HTML does not have a single root node",html),new Error("HTML must have a single root node");return fromDom(div.childNodes[0])},fromTag:function(tag,scope){var node=(scope||domGlobals.document).createElement(tag);return fromDom(node)},fromText:function(text,scope){var node=(scope||domGlobals.document).createTextNode(text);return fromDom(node)},fromDom:fromDom,fromPoint:function(docElm,x,y){var doc=docElm.dom();return Option.from(doc.elementFromPoint(x,y)).map(fromDom)}},DOCUMENT=(domGlobals.Node.ATTRIBUTE_NODE,domGlobals.Node.CDATA_SECTION_NODE,domGlobals.Node.COMMENT_NODE,domGlobals.Node.DOCUMENT_NODE),ELEMENT=(domGlobals.Node.DOCUMENT_TYPE_NODE,domGlobals.Node.DOCUMENT_FRAGMENT_NODE,domGlobals.Node.ELEMENT_NODE),TEXT=domGlobals.Node.TEXT_NODE,isText=(domGlobals.Node.PROCESSING_INSTRUCTION_NODE,domGlobals.Node.ENTITY_REFERENCE_NODE,domGlobals.Node.ENTITY_NODE,domGlobals.Node.NOTATION_NODE,void 0!==domGlobals.window?domGlobals.window:Function("return this;")(),t=TEXT,function(element){return function(element){return element.dom().nodeType}(element)===t}),getUnsafeProperty=function(dom,property){return isSupported(dom)?dom.style.getPropertyValue(property):""},unknown=function(){return nu(0,0)},nu=function(major,minor){return{major:major,minor:minor}},Version={nu:nu,detect:function(versionRegexes,agent){var cleanedAgent=String(agent).toLowerCase();return 0===versionRegexes.length?unknown():find$1(versionRegexes,cleanedAgent)},unknown:unknown},nu$1=function(info){var current=info.current;return{current:current,version:info.version,isEdge:isBrowser("Edge",current),isChrome:isBrowser("Chrome",current),isIE:isBrowser("IE",current),isOpera:isBrowser("Opera",current),isFirefox:isBrowser("Firefox",current),isSafari:isBrowser("Safari",current)}},Browser={unknown:function(){return nu$1({current:void 0,version:Version.unknown()})},nu:nu$1,edge:constant("Edge"),chrome:constant("Chrome"),ie:constant("IE"),opera:constant("Opera"),firefox:constant("Firefox"),safari:constant("Safari")},nu$2=function(info){var current=info.current;return{current:current,version:info.version,isWindows:isOS("Windows",current),isiOS:isOS("iOS",current),isAndroid:isOS("Android",current),isOSX:isOS("OSX",current),isLinux:isOS("Linux",current),isSolaris:isOS("Solaris",current),isFreeBSD:isOS("FreeBSD",current),isChromeOS:isOS("ChromeOS",current)}},OperatingSystem={unknown:function(){return nu$2({current:void 0,version:Version.unknown()})},nu:nu$2,windows:constant("Windows"),ios:constant("iOS"),android:constant("Android"),linux:constant("Linux"),osx:constant("OSX"),solaris:constant("Solaris"),freebsd:constant("FreeBSD"),chromeos:constant("ChromeOS")},UaString_detectBrowser=function(browsers,userAgent){return detect$1(browsers,userAgent).map(function(browser){var version=Version.detect(browser.versionRegexes,userAgent);return{current:browser.name,version:version}})},UaString_detectOs=function(oses,userAgent){return detect$1(oses,userAgent).map(function(os){var version=Version.detect(os.versionRegexes,userAgent);return{current:os.name,version:version}})},normalVersionRegex=/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,browsers=[{name:"Edge",versionRegexes:[/.*?edge\/ ?([0-9]+)\.([0-9]+)$/],search:function(uastring){return contains(uastring,"edge/")&&contains(uastring,"chrome")&&contains(uastring,"safari")&&contains(uastring,"applewebkit")}},{name:"Chrome",versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/,normalVersionRegex],search:function(uastring){return contains(uastring,"chrome")&&!contains(uastring,"chromeframe")}},{name:"IE",versionRegexes:[/.*?msie\ ?([0-9]+)\.([0-9]+).*/,/.*?rv:([0-9]+)\.([0-9]+).*/],search:function(uastring){return contains(uastring,"msie")||contains(uastring,"trident")}},{name:"Opera",versionRegexes:[normalVersionRegex,/.*?opera\/([0-9]+)\.([0-9]+).*/],search:checkContains("opera")},{name:"Firefox",versionRegexes:[/.*?firefox\/\ ?([0-9]+)\.([0-9]+).*/],search:checkContains("firefox")},{name:"Safari",versionRegexes:[normalVersionRegex,/.*?cpu os ([0-9]+)_([0-9]+).*/],search:function(uastring){return(contains(uastring,"safari")||contains(uastring,"mobile/"))&&contains(uastring,"applewebkit")}}],oses=[{name:"Windows",search:checkContains("win"),versionRegexes:[/.*?windows\ nt\ ?([0-9]+)\.([0-9]+).*/]},{name:"iOS",search:function(uastring){return contains(uastring,"iphone")||contains(uastring,"ipad")},versionRegexes:[/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,/.*cpu os ([0-9]+)_([0-9]+).*/,/.*cpu iphone os ([0-9]+)_([0-9]+).*/]},{name:"Android",search:checkContains("android"),versionRegexes:[/.*?android\ ?([0-9]+)\.([0-9]+).*/]},{name:"OSX",search:checkContains("mac os x"),versionRegexes:[/.*?mac\ os\ x\ ?([0-9]+)_([0-9]+).*/]},{name:"Linux",search:checkContains("linux"),versionRegexes:[]},{name:"Solaris",search:checkContains("sunos"),versionRegexes:[]},{name:"FreeBSD",search:checkContains("freebsd"),versionRegexes:[]},{name:"ChromeOS",search:checkContains("cros"),versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/]}],PlatformInfo={browsers:constant(browsers),oses:constant(oses)},PlatformDetection_detect=function(userAgent,mediaMatch){var browsers=PlatformInfo.browsers(),oses=PlatformInfo.oses(),browser=UaString_detectBrowser(browsers,userAgent).fold(Browser.unknown,Browser.nu),os=UaString_detectOs(oses,userAgent).fold(OperatingSystem.unknown,OperatingSystem.nu),deviceType=function(os,browser,userAgent,mediaMatch){var isiPad=os.isiOS()&&!0===/ipad/i.test(userAgent),isiPhone=os.isiOS()&&!isiPad,isMobile=os.isiOS()||os.isAndroid(),isTouch=isMobile||mediaMatch("(pointer:coarse)"),isTablet=isiPad||!isiPhone&&isMobile&&mediaMatch("(min-device-width:768px)"),isPhone=isiPhone||isMobile&&!isTablet,iOSwebview=browser.isSafari()&&os.isiOS()&&!1===/safari/i.test(userAgent),isDesktop=!isPhone&&!isTablet&&!iOSwebview;return{isiPad:constant(isiPad),isiPhone:constant(isiPhone),isTablet:constant(isTablet),isPhone:constant(isPhone),isTouch:constant(isTouch),isAndroid:os.isAndroid,isiOS:os.isiOS,isWebView:constant(iOSwebview),isDesktop:constant(isDesktop)}}(os,browser,userAgent,mediaMatch);return{browser:browser,os:os,deviceType:deviceType}},platform=Cell(PlatformDetection_detect(domGlobals.navigator.userAgent,function(query){return domGlobals.window.matchMedia(query).matches})),Node_documentPositionContainedBy=function(a,b){return compareDocumentPosition(a,b,domGlobals.Node.DOCUMENT_POSITION_CONTAINED_BY)},ELEMENT$1=ELEMENT,DOCUMENT$1=DOCUMENT,children=(detect$3().browser.isIE(),function(element){return map(element.dom().childNodes,Element.fromDom)}),r=(function(){for(var fields=[],_i=0;_i<arguments.length;_i++)fields[_i]=arguments[_i]}("element","offset"),function(left,top){return{left:constant(left),top:constant(top),translate:function(x,y){return r(left+x,top+y)}}}),Position=r,global$1=(detect$3().browser.isSafari(),tinymce.util.Tools.resolve("tinymce.dom.DOMUtils")),global$2=tinymce.util.Tools.resolve("tinymce.Env"),global$3=tinymce.util.Tools.resolve("tinymce.util.Delay"),Events_fireFullscreenStateChanged=function(editor,state){editor.fire("FullscreenStateChanged",{state:state})},attr="data-ephox-mobile-fullscreen-style",ancestorStyles="top:0!important;left:0!important;margin:0!important;padding:0!important;width:100%!important;height:100%!important;overflow:visible!important;",isAndroid=global$2.os.isAndroid(),Thor_clobberStyles=function(dom,container,editorBody){function clobber(clobberStyle){return function(element){var styles=get$1(element,"style"),backup=void 0===styles?"no-styles":styles.trim();backup!==clobberStyle&&(set(element,attr,backup),setAll(element,dom.parseStyle(clobberStyle)))}}var ancestors=ancestors$1(container,"*"),siblings=bind(ancestors,function(element){return siblings$2(element,"*:not(.tox-silver-sink)")}),bgColor=function(editorBody){var color=get$2(editorBody,"background-color");return void 0!==color&&""!==color?"background-color:"+color+"!important":"background-color:rgb(255,255,255)!important;"}(editorBody);each(siblings,clobber("display:none!important;")),each(ancestors,clobber("position:absolute!important;"+ancestorStyles+bgColor)),clobber((!0===isAndroid?"":"position:absolute!important;")+ancestorStyles+bgColor)(container)},Thor_restoreStyles=function(dom){var clobberedEls=function(selector){return all(selector)}("["+attr+"]");each(clobberedEls,function(element){var restore=get$1(element,attr);"no-styles"!==restore?setAll(element,dom.parseStyle(restore)):remove(element,"style"),remove(element,attr)})},DOM=global$1.DOM,viewportUpdate=get$4().fold(function(){return{bind:noop,unbind:noop}},function(visualViewport){var editorContainer=function(){var subject=Cell(Option.none());return{clear:function(){subject.set(Option.none())},set:function(s){subject.set(Option.some(s))},isSet:function(){return subject.get().isSome()},on:function(f){subject.get().each(f)}}}(),resizeBinder=unbindable(),scrollBinder=unbindable(),update=global$3.throttle(function(){domGlobals.document.body.scrollTop=0,domGlobals.document.documentElement.scrollTop=0,domGlobals.window.requestAnimationFrame(function(){editorContainer.on(function(container){return setAll(container,{top:visualViewport.offsetTop+"px",left:visualViewport.offsetLeft+"px",height:visualViewport.height+"px",width:visualViewport.width+"px"})})})},50);return{bind:function(element){editorContainer.set(element),update(),resizeBinder.set(bind$1("resize")),scrollBinder.set(bind$1("scroll"))},unbind:function(){editorContainer.on(function(){resizeBinder.clear(),scrollBinder.clear()}),editorContainer.clear()}}}),Actions_toggleFullscreen=function(editor,fullscreenState){var editorContainerStyle,editorContainer,iframeStyle,body=domGlobals.document.body,documentElement=domGlobals.document.documentElement;editorContainer=editor.getContainer();var editorContainerS=Element.fromDom(editorContainer),fullscreenInfo=fullscreenState.get(),editorBody=Element.fromDom(editor.getBody()),isTouch=global$2.deviceType.isTouch();if(editorContainerStyle=editorContainer.style,iframeStyle=editor.getContentAreaContainer().firstChild.style,fullscreenInfo)iframeStyle.width=fullscreenInfo.iframeWidth,iframeStyle.height=fullscreenInfo.iframeHeight,editorContainerStyle.width=fullscreenInfo.containerWidth,editorContainerStyle.height=fullscreenInfo.containerHeight,editorContainerStyle.top=fullscreenInfo.containerTop,editorContainerStyle.left=fullscreenInfo.containerLeft,isTouch&&Thor_restoreStyles(editor.dom),DOM.removeClass(body,"tox-fullscreen"),DOM.removeClass(documentElement,"tox-fullscreen"),DOM.removeClass(editorContainer,"tox-fullscreen"),function(pos){domGlobals.window.scrollTo(pos.x,pos.y)}(fullscreenInfo.scrollPos),fullscreenState.set(null),Events_fireFullscreenStateChanged(editor,!1),viewportUpdate.unbind(),editor.off("remove",viewportUpdate.unbind);else{var newFullScreenInfo={scrollPos:function(){var vp=getBounds(domGlobals.window);return{x:vp.x(),y:vp.y()}}(),containerWidth:editorContainerStyle.width,containerHeight:editorContainerStyle.height,containerTop:editorContainerStyle.top,containerLeft:editorContainerStyle.left,iframeWidth:iframeStyle.width,iframeHeight:iframeStyle.height};isTouch&&Thor_clobberStyles(editor.dom,editorContainerS,editorBody),iframeStyle.width=iframeStyle.height="100%",editorContainerStyle.width=editorContainerStyle.height="",DOM.addClass(body,"tox-fullscreen"),DOM.addClass(documentElement,"tox-fullscreen"),DOM.addClass(editorContainer,"tox-fullscreen"),viewportUpdate.bind(editorContainerS),editor.on("remove",viewportUpdate.unbind),fullscreenState.set(newFullScreenInfo),Events_fireFullscreenStateChanged(editor,!0)}},Commands_register=function(editor,fullscreenState){editor.addCommand("mceFullScreen",function(){Actions_toggleFullscreen(editor,fullscreenState)})},Buttons_register=function(editor,fullscreenState){editor.ui.registry.addToggleMenuItem("fullscreen",{text:"Fullscreen",shortcut:"Meta+Shift+F",onAction:function(){return editor.execCommand("mceFullScreen")},onSetup:makeSetupHandler(editor,fullscreenState)}),editor.ui.registry.addToggleButton("fullscreen",{tooltip:"Fullscreen",icon:"fullscreen",onAction:function(){return editor.execCommand("mceFullScreen")},onSetup:makeSetupHandler(editor,fullscreenState)})};global.add("fullscreen",function(editor){var fullscreenState=Cell(null);return editor.settings.inline||(Commands_register(editor,fullscreenState),Buttons_register(editor,fullscreenState),editor.addShortcut("Meta+Shift+F","","mceFullScreen")),Api_get(fullscreenState)})}(window),function(){"use strict";function hasClass(checkClassName){return function(node){return-1!==(" "+node.attr("class")+" ").indexOf(checkClassName)}}function replaceMatchWithSpan(editor,content,cls){return function(match){var args=arguments,index=args[args.length-2],prevChar=0<index?content.charAt(index-1):"";if('"'===prevChar)return match;if(">"===prevChar){var findStartTagIndex=content.lastIndexOf("<",index);if(-1!==findStartTagIndex)if(-1!==content.substring(findStartTagIndex,index).indexOf('contenteditable="false"'))return match}return'<span class="'+cls+'" data-mce-content="'+editor.dom.encode(args[0])+'">'+editor.dom.encode("string"==typeof args[1]?args[1]:args[0])+"</span>"}}var global=tinymce.util.Tools.resolve("tinymce.PluginManager"),global$1=tinymce.util.Tools.resolve("tinymce.util.Tools"),Settings_getNonEditableClass=function(editor){return editor.getParam("noneditable_noneditable_class","mceNonEditable")},Settings_getEditableClass=function(editor){return editor.getParam("noneditable_editable_class","mceEditable")},Settings_getNonEditableRegExps=function(editor){var nonEditableRegExps=editor.getParam("noneditable_regexp",[]);return nonEditableRegExps&&nonEditableRegExps.constructor===RegExp?[nonEditableRegExps]:nonEditableRegExps},FilterContent_setup=function(editor){var editClass,nonEditClass;editClass=" "+global$1.trim(Settings_getEditableClass(editor))+" ",nonEditClass=" "+global$1.trim(Settings_getNonEditableClass(editor))+" ";var hasEditClass=hasClass(editClass),hasNonEditClass=hasClass(nonEditClass),nonEditableRegExps=Settings_getNonEditableRegExps(editor);editor.on("PreInit",function(){0<nonEditableRegExps.length&&editor.on("BeforeSetContent",function(e){!function(editor,nonEditableRegExps,e){var i=nonEditableRegExps.length,content=e.content;if("raw"!==e.format){for(;i--;)content=content.replace(nonEditableRegExps[i],replaceMatchWithSpan(editor,content,Settings_getNonEditableClass(editor)));e.content=content}}(editor,nonEditableRegExps,e)}),editor.parser.addAttributeFilter("class",function(nodes){for(var node,i=nodes.length;i--;)node=nodes[i],hasEditClass(node)?node.attr("contenteditable","true"):hasNonEditClass(node)&&node.attr("contenteditable","false")}),editor.serializer.addAttributeFilter("contenteditable",function(nodes){for(var node,i=nodes.length;i--;)node=nodes[i],(hasEditClass(node)||hasNonEditClass(node))&&(0<nonEditableRegExps.length&&node.attr("data-mce-content")?(node.name="#text",node.type=3,node.raw=!0,node.value=node.attr("data-mce-content")):node.attr("contenteditable",null))})})};global.add("noneditable",function(editor){FilterContent_setup(editor)})}(),function(domGlobals){"use strict";function noop(){}function constant(value){return function(){return value}}function none(){return NONE}var me,Cell=function(initial){function get(){return value}var value=initial;return{get:get,set:function(v){value=v},clone:function(){return Cell(get())}}},global=tinymce.util.Tools.resolve("tinymce.PluginManager"),Api_get=function(toggleState){return{isEnabled:function(){return toggleState.get()}}},Events_fireVisualChars=function(editor,state){return editor.fire("VisualChars",{state:state})},never=constant(!1),always=constant(!0),NONE=(me={fold:function(n,s){return n()},is:never,isSome:never,isNone:always,getOr:id,getOrThunk:call,getOrDie:function(msg){throw new Error(msg||"error: getOrDie called on none.")},getOrNull:constant(null),getOrUndefined:constant(void 0),or:id,orThunk:call,map:none,each:noop,bind:none,exists:never,forall:always,filter:none,equals:eq,equals_:eq,toArray:function(){return[]},toString:constant("none()")},Object.freeze&&Object.freeze(me),me);function eq(o){return o.isNone()}function call(thunk){return thunk()}function id(n){return n}function isType(type){return function(value){return function(x){if(null===x)return"null";var t=typeof x;return"object"==t&&(Array.prototype.isPrototypeOf(x)||x.constructor&&"Array"===x.constructor.name)?"array":"object"==t&&(String.prototype.isPrototypeOf(x)||x.constructor&&"String"===x.constructor.name)?"string":t}(value)===type}}function each(xs,f){for(var i=0,len=xs.length;i<len;i++){f(xs[i],i)}}function value(element){return element.dom().nodeValue}function set(element,key,value){!function(dom,key,value){if(!(isString(value)||isBoolean(value)||isNumber(value)))throw domGlobals.console.error("Invalid call to Attr.set. Key ",key,":: Value ",value,":: Element ",dom),new Error("Attribute value was not simple");dom.setAttribute(key,value+"")}(element.dom(),key,value)}function remove(element,key){element.dom().removeAttribute(key)}function read(element,attr){var value=function(element,key){var v=element.dom().getAttribute(key);return null===v?void 0:v}(element,attr);return void 0===value||""===value?[]:value.split(" ")}function supports(element){return void 0!==element.dom().classList}function add$1(element,clazz){return function(element,attr,id){var nu=read(element,attr).concat([id]);return set(element,attr,nu.join(" ")),!0}(element,"class",clazz)}function remove$2(element,clazz){return function(element,attr,id){var nu=function(xs,pred){for(var r=[],i=0,len=xs.length;i<len;i++){var x=xs[i];pred(x,i)&&r.push(x)}return r}(read(element,attr),function(v){return v!==id});return 0<nu.length?set(element,attr,nu.join(" ")):remove(element,attr),!1}(element,"class",clazz)}function cleanClass(element){0===(supports(element)?element.dom().classList:function(element){return read(element,"class")}(element)).length&&remove(element,"class")}function charMapToRegExp(charMap,global){var key,regExp="";for(key in charMap)regExp+=key;return new RegExp("["+regExp+"]",global?"g":"")}function charMapToSelector(charMap){var key,selector="";for(key in charMap)selector&&(selector+=","),selector+="span.mce-"+charMap[key];return selector}function isWrappedNbsp(node){return"span"===node.nodeName.toLowerCase()&&node.classList.contains("mce-nbsp-wrap")}function show(editor,rootElm){var nodeList=Nodes.filterDescendants(Element.fromDom(rootElm),Nodes.isMatch);each(nodeList,function(n){var parent=n.dom().parentNode;if(isWrappedNbsp(parent))!function(element,clazz){supports(element)?element.dom().classList.add(clazz):add$1(element,clazz)}(Element.fromDom(parent),Data.nbspClass);else{for(var withSpans=Nodes.replaceWithSpans(editor.dom.encode(value(n))),div=editor.dom.create("div",null,withSpans),node=void 0;node=div.lastChild;)editor.dom.insertAfter(node,n.dom());editor.dom.remove(n.dom())}})}function hide(editor,rootElm){var nodeList=editor.dom.select(Data.selector,rootElm);each(nodeList,function(node){isWrappedNbsp(node)?function(element,clazz){supports(element)?element.dom().classList.remove(clazz):remove$2(element,clazz);cleanClass(element)}(Element.fromDom(node),Data.nbspClass):editor.dom.remove(node,!0)})}function toggleActiveState(editor,enabledStated){return function(api){api.setActive(enabledStated.get());function editorEventCallback(e){return api.setActive(e.state)}return editor.on("VisualChars",editorEventCallback),function(){return editor.off("VisualChars",editorEventCallback)}}}var t,some=function(a){function self(){return me}function bind(f){return f(a)}var constant_a=constant(a),me={fold:function(n,s){return s(a)},is:function(v){return a===v},isSome:always,isNone:never,getOr:constant_a,getOrThunk:constant_a,getOrDie:constant_a,getOrNull:constant_a,getOrUndefined:constant_a,or:self,orThunk:self,map:function(f){return some(f(a))},each:function(f){f(a)},bind:bind,exists:bind,forall:bind,filter:function(f){return f(a)?me:NONE},toArray:function(){return[a]},toString:function(){return"some("+a+")"},equals:function(o){return o.is(a)},equals_:function(o,elementEq){return o.fold(never,function(b){return elementEq(a,b)})}};return me},Option_from=function(value){return null==value?NONE:some(value)},isString=isType("string"),isBoolean=isType("boolean"),isFunction=isType("function"),isNumber=isType("number"),nativeSlice=Array.prototype.slice,TEXT=(isFunction(Array.from)&&Array.from,domGlobals.Node.ATTRIBUTE_NODE,domGlobals.Node.CDATA_SECTION_NODE,domGlobals.Node.COMMENT_NODE,domGlobals.Node.DOCUMENT_NODE,domGlobals.Node.DOCUMENT_TYPE_NODE,domGlobals.Node.DOCUMENT_FRAGMENT_NODE,domGlobals.Node.ELEMENT_NODE,domGlobals.Node.TEXT_NODE),isText=(domGlobals.Node.PROCESSING_INSTRUCTION_NODE,domGlobals.Node.ENTITY_REFERENCE_NODE,domGlobals.Node.ENTITY_NODE,domGlobals.Node.NOTATION_NODE,void 0!==domGlobals.window?domGlobals.window:Function("return this;")(),t=TEXT,function(element){return function(element){return element.dom().nodeType}(element)===t}),fromDom=function(node){if(null==node)throw new Error("Node cannot be null or undefined");return{dom:constant(node)}},Element={fromHtml:function(html,scope){var div=(scope||domGlobals.document).createElement("div");if(div.innerHTML=html,!div.hasChildNodes()||1<div.childNodes.length)throw domGlobals.console.error("HTML does not have a single root node",html),new Error("HTML must have a single root node");return fromDom(div.childNodes[0])},fromTag:function(tag,scope){var node=(scope||domGlobals.document).createElement(tag);return fromDom(node)},fromText:function(text,scope){var node=(scope||domGlobals.document).createTextNode(text);return fromDom(node)},fromDom:fromDom,fromPoint:function(docElm,x,y){var doc=docElm.dom();return Option_from(doc.elementFromPoint(x,y)).map(fromDom)}},charMap={"":"nbsp","":"shy"},Data={charMap:charMap,regExp:charMapToRegExp(charMap),regExpGlobal:charMapToRegExp(charMap,!0),selector:charMapToSelector(charMap),nbspClass:"mce-nbsp",charMapToRegExp:charMapToRegExp,charMapToSelector:charMapToSelector},Html_wrapCharWithSpan=function(value){return'<span data-mce-bogus="1" class="mce-'+Data.charMap[value]+'">'+value+"</span>"},filterDescendants=function(scope,predicate){var result=[],children=function(xs,f){for(var len=xs.length,r=new Array(len),i=0;i<len;i++){var x=xs[i];r[i]=f(x,i)}return r}(scope.dom().childNodes,Element.fromDom);return each(children,function(x){predicate(x)&&(result=result.concat([x])),result=result.concat(filterDescendants(x,predicate))}),result},Nodes={isMatch:function(n){var value$1=value(n);return isText(n)&&void 0!==value$1&&Data.regExp.test(value$1)},filterDescendants:filterDescendants,findParentElm:function(elm,rootElm){for(;elm.parentNode;){if(elm.parentNode===rootElm)return elm;elm=elm.parentNode}},replaceWithSpans:function(text){return text.replace(Data.regExpGlobal,Html_wrapCharWithSpan)}},VisualChars_show=show,VisualChars_hide=hide,VisualChars_toggle=function(editor){var body=editor.getBody(),bookmark=editor.selection.getBookmark(),parentNode=Nodes.findParentElm(editor.selection.getNode(),body);hide(editor,parentNode=void 0!==parentNode?parentNode:body),show(editor,parentNode),editor.selection.moveToBookmark(bookmark)},Actions_toggleVisualChars=function(editor,toggleState){var bookmark,body=editor.getBody(),selection=editor.selection;toggleState.set(!toggleState.get()),Events_fireVisualChars(editor,toggleState.get()),bookmark=selection.getBookmark(),!0===toggleState.get()?VisualChars_show(editor,body):VisualChars_hide(editor,body),selection.moveToBookmark(bookmark)},Commands_register=function(editor,toggleState){editor.addCommand("mceVisualChars",function(){Actions_toggleVisualChars(editor,toggleState)})},global$1=tinymce.util.Tools.resolve("tinymce.util.Delay"),Keyboard_setup=function(editor,toggleState){var debouncedToggle=global$1.debounce(function(){VisualChars_toggle(editor)},300);!1!==editor.settings.forced_root_block&&editor.on("keydown",function(e){!0===toggleState.get()&&(13===e.keyCode?VisualChars_toggle(editor):debouncedToggle())})},Settings_isEnabledByDefault=function(editor){return editor.getParam("visualchars_default_state",!1)},Bindings_setup=function(editor,toggleState){editor.on("init",function(){var valueForToggling=!Settings_isEnabledByDefault(editor);toggleState.set(valueForToggling),Actions_toggleVisualChars(editor,toggleState)})};global.add("visualchars",function(editor){var toggleState=Cell(!1);return Commands_register(editor,toggleState),function(editor,toggleState){editor.ui.registry.addToggleButton("visualchars",{tooltip:"Show invisible characters",icon:"visualchars",onAction:function(){return editor.execCommand("mceVisualChars")},onSetup:toggleActiveState(editor,toggleState)}),editor.ui.registry.addToggleMenuItem("visualchars",{text:"Show invisible characters",onAction:function(){return editor.execCommand("mceVisualChars")},onSetup:toggleActiveState(editor,toggleState)})}(editor,toggleState),Keyboard_setup(editor,toggleState),Bindings_setup(editor,toggleState),Api_get(toggleState)})}(window),function(){"use strict";function stringRepeat(string,repeats){for(var str="",index=0;index<repeats;index++)str+=string;return str}var global=tinymce.util.Tools.resolve("tinymce.PluginManager"),Settings_getKeyboardSpaces=function(editor){var spaces=editor.getParam("nonbreaking_force_tab",0);return"boolean"==typeof spaces?!0===spaces?3:0:spaces},Settings_wrapNbsps=function(editor){return editor.getParam("nonbreaking_wrap",!0,"boolean")},Actions_insertNbsp=function(editor,times){var html=Settings_wrapNbsps(editor)||editor.plugins.visualchars?'<span class="'+(function(editor){return editor.plugins.visualchars&&editor.plugins.visualchars.isEnabled()}(editor)?"mce-nbsp-wrap mce-nbsp":"mce-nbsp-wrap")+'" contenteditable="false">'+stringRepeat("&nbsp;",times)+"</span>":stringRepeat("&nbsp;",times);editor.undoManager.transact(function(){return editor.insertContent(html)})},Commands_register=function(editor){editor.addCommand("mceNonBreaking",function(){Actions_insertNbsp(editor,1)})},global$1=tinymce.util.Tools.resolve("tinymce.util.VK"),Keyboard_setup=function(editor){var spaces=Settings_getKeyboardSpaces(editor);0<spaces&&editor.on("keydown",function(e){if(e.keyCode===global$1.TAB&&!e.isDefaultPrevented()){if(e.shiftKey)return;e.preventDefault(),e.stopImmediatePropagation(),Actions_insertNbsp(editor,spaces)}})},Buttons_register=function(editor){editor.ui.registry.addButton("nonbreaking",{icon:"non-breaking",tooltip:"Nonbreaking space",onAction:function(){return editor.execCommand("mceNonBreaking")}}),editor.ui.registry.addMenuItem("nonbreaking",{icon:"non-breaking",text:"Nonbreaking space",onAction:function(){return editor.execCommand("mceNonBreaking")}})};global.add("nonbreaking",function(editor){Commands_register(editor),Buttons_register(editor),Keyboard_setup(editor)})}(),function(){"use strict";function noop(){}function constant(value){return function(){return value}}var global=tinymce.util.Tools.resolve("tinymce.PluginManager");function addZeros(value,len){if((value=""+value).length<len)for(var i=0;i<len-value.length;i++)value="0"+value;return value}function replaceTemplateValues(html,templateValues){return global$1.each(templateValues,function(v,k){"function"==typeof v&&(v=v(k)),html=html.replace(new RegExp("\\{\\$"+k+"\\}","g"),v)}),html}function replaceVals(editor,e){var dom=editor.dom,vl=Settings_getTemplateReplaceValues(editor);global$1.each(dom.select("*",e),function(e){global$1.each(vl,function(v,k){dom.hasClass(e,k)&&"function"==typeof vl[k]&&vl[k](e)})})}function hasClass(n,c){return new RegExp("\\b"+c+"\\b","g").test(n.className)}function none(){return NONE}var me,never=constant(!1),always=constant(!0),global$1=tinymce.util.Tools.resolve("tinymce.util.Tools"),global$2=tinymce.util.Tools.resolve("tinymce.util.XHR"),Settings_getCreationDateClasses=function(editor){return editor.getParam("template_cdate_classes","cdate")},Settings_getModificationDateClasses=function(editor){return editor.getParam("template_mdate_classes","mdate")},Settings_getSelectedContentClasses=function(editor){return editor.getParam("template_selected_content_classes","selcontent")},Settings_getPreviewReplaceValues=function(editor){return editor.getParam("template_preview_replace_values")},Settings_getTemplateReplaceValues=function(editor){return editor.getParam("template_replace_values")},Settings_getTemplates=function(editorSettings){return editorSettings.templates},Settings_getCdateFormat=function(editor){return editor.getParam("template_cdate_format",editor.translate("%Y-%m-%d"))},Settings_getMdateFormat=function(editor){return editor.getParam("template_mdate_format",editor.translate("%Y-%m-%d"))},DateTimeHelper_getDateTime=function(editor,fmt,date){var daysShort="Sun Mon Tue Wed Thu Fri Sat Sun".split(" "),daysLong="Sunday Monday Tuesday Wednesday Thursday Friday Saturday Sunday".split(" "),monthsShort="Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec".split(" "),monthsLong="January February March April May June July August September October November December".split(" ");return date=date||new Date,fmt=(fmt=(fmt=(fmt=(fmt=(fmt=(fmt=(fmt=(fmt=(fmt=(fmt=(fmt=(fmt=(fmt=(fmt=(fmt=fmt.replace("%D","%m/%d/%Y")).replace("%r","%I:%M:%S %p")).replace("%Y",""+date.getFullYear())).replace("%y",""+date.getYear())).replace("%m",addZeros(date.getMonth()+1,2))).replace("%d",addZeros(date.getDate(),2))).replace("%H",""+addZeros(date.getHours(),2))).replace("%M",""+addZeros(date.getMinutes(),2))).replace("%S",""+addZeros(date.getSeconds(),2))).replace("%I",""+((date.getHours()+11)%12+1))).replace("%p",date.getHours()<12?"AM":"PM")).replace("%B",""+editor.translate(monthsLong[date.getMonth()]))).replace("%b",""+editor.translate(monthsShort[date.getMonth()]))).replace("%A",""+editor.translate(daysLong[date.getDay()]))).replace("%a",""+editor.translate(daysShort[date.getDay()]))).replace("%%","%")},Templates_createTemplateList=function(editorSettings,callback){return function(){var templateList=Settings_getTemplates(editorSettings);"function"!=typeof templateList?"string"==typeof templateList?global$2.send({url:templateList,success:function(text){callback(JSON.parse(text))}}):callback(templateList):templateList(callback)}},Templates_replaceTemplateValues=replaceTemplateValues,Templates_replaceVals=replaceVals,Templates_insertTemplate=function(editor,ui,html){var el,n,dom=editor.dom,sel=editor.selection.getContent();html=replaceTemplateValues(html,Settings_getTemplateReplaceValues(editor)),el=dom.create("div",null,html),(n=dom.select(".mceTmpl",el))&&0<n.length&&(el=dom.create("div",null)).appendChild(n[0].cloneNode(!0)),global$1.each(dom.select("*",el),function(n){hasClass(n,Settings_getCreationDateClasses(editor).replace(/\s+/g,"|"))&&(n.innerHTML=DateTimeHelper_getDateTime(editor,Settings_getCdateFormat(editor))),hasClass(n,Settings_getModificationDateClasses(editor).replace(/\s+/g,"|"))&&(n.innerHTML=DateTimeHelper_getDateTime(editor,Settings_getMdateFormat(editor))),hasClass(n,Settings_getSelectedContentClasses(editor).replace(/\s+/g,"|"))&&(n.innerHTML=sel)}),replaceVals(editor,el),editor.execCommand("mceInsertContent",!1,el.innerHTML),editor.addVisual()},Commands_register=function(editor){editor.addCommand("mceInsertTemplate",function(fn){for(var initialArgs=[],_i=1;_i<arguments.length;_i++)initialArgs[_i-1]=arguments[_i];return function(){for(var restArgs=[],_i=0;_i<arguments.length;_i++)restArgs[_i]=arguments[_i];var all=initialArgs.concat(restArgs);return fn.apply(null,all)}}(Templates_insertTemplate,editor))},FilterContent_setup=function(editor){editor.on("PreProcess",function(o){var dom=editor.dom,dateFormat=Settings_getMdateFormat(editor);global$1.each(dom.select("div",o.node),function(e){dom.hasClass(e,"mceTmpl")&&(global$1.each(dom.select("*",e),function(e){dom.hasClass(e,editor.getParam("template_mdate_classes","mdate").replace(/\s+/g,"|"))&&(e.innerHTML=DateTimeHelper_getDateTime(editor,dateFormat))}),Templates_replaceVals(editor,e))})})},NONE=(me={fold:function(n,s){return n()},is:never,isSome:never,isNone:always,getOr:id,getOrThunk:call,getOrDie:function(msg){throw new Error(msg||"error: getOrDie called on none.")},getOrNull:constant(null),getOrUndefined:constant(void 0),or:id,orThunk:call,map:none,each:noop,bind:none,exists:never,forall:always,filter:none,equals:eq,equals_:eq,toArray:function(){return[]},toString:constant("none()")},Object.freeze&&Object.freeze(me),me);function eq(o){return o.isNone()}function call(thunk){return thunk()}function id(n){return n}function htmlEscape(html){return html.replace(/["'<>&]/g,function(match){return function(obj,key){return has(obj,key)?Option.from(obj[key]):Option.none()}(entitiesAttr,match).getOr(match)})}function showDialog(editor){return function(templates){Dialog_open(editor,templates)}}var type,some=function(a){function self(){return me}function bind(f){return f(a)}var constant_a=constant(a),me={fold:function(n,s){return s(a)},is:function(v){return a===v},isSome:always,isNone:never,getOr:constant_a,getOrThunk:constant_a,getOrDie:constant_a,getOrNull:constant_a,getOrUndefined:constant_a,or:self,orThunk:self,map:function(f){return some(f(a))},each:function(f){f(a)},bind:bind,exists:bind,forall:bind,filter:function(f){return f(a)?me:NONE},toArray:function(){return[a]},toString:function(){return"some("+a+")"},equals:function(o){return o.is(a)},equals_:function(o,elementEq){return o.fold(never,function(b){return elementEq(a,b)})}};return me},Option={some:some,none:none,from:function(value){return null==value?NONE:some(value)}},isFunction=(type="function",function(value){return function(x){if(null===x)return"null";var t=typeof x;return"object"==t&&(Array.prototype.isPrototypeOf(x)||x.constructor&&"Array"===x.constructor.name)?"array":"object"==t&&(String.prototype.isPrototypeOf(x)||x.constructor&&"String"===x.constructor.name)?"string":t}(value)===type}),nativeSlice=Array.prototype.slice,global$3=(isFunction(Array.from)&&Array.from,tinymce.util.Tools.resolve("tinymce.util.Promise")),hasOwnProperty=Object.hasOwnProperty,has=function(obj,key){return hasOwnProperty.call(obj,key)},entitiesAttr={'"':"&quot;","<":"&lt;",">":"&gt;","&":"&amp;","'":"&#039;"},Dialog_open=function(editor,templateList){function createSelectBoxItems(templates){return function(xs,f){for(var len=xs.length,r=new Array(len),i=0;i<len;i++){var x=xs[i];r[i]=f(x,i)}return r}(templates,function(t){return{text:t.text,value:t.text}})}function findTemplate(templates,templateTitle){return function(xs,pred){for(var i=0,len=xs.length;i<len;i++){var x=xs[i];if(pred(x,i))return Option.some(x)}return Option.none()}(templates,function(t){return t.text===templateTitle})}function loadFailedAlert(api){editor.windowManager.alert("Could not load the specified template.",function(){return api.focus("template")})}function getTemplateContent(t){return new global$3(function(resolve,reject){t.value.url.fold(function(){return resolve(t.value.content.getOr(""))},function(url){return global$2.send({url:url,success:function(html){resolve(html)},error:function(e){reject(e)}})})})}(function(){if(templateList&&0!==templateList.length)return Option.from(global$1.map(templateList,function(template,index){function isUrlTemplate(t){return void 0!==t.url}return{selected:0===index,text:template.title,value:{url:isUrlTemplate(template)?Option.from(template.url):Option.none(),content:isUrlTemplate(template)?Option.none():Option.from(template.content),description:template.description}}}));var message=editor.translate("No templates defined.");return editor.notificationManager.open({text:message,type:"info"}),Option.none()})().each(function(templates){function buildDialogSpec(bodyItems,initialData){return{title:"Insert Template",size:"large",body:{type:"panel",items:bodyItems},initialData:initialData,buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"save",text:"Save",primary:!0}],onSubmit:function(templates){return function(api){var data=api.getData();findTemplate(templates,data.template).each(function(t){getTemplateContent(t).then(function(previewHtml){Templates_insertTemplate(editor,!1,previewHtml),api.close()}).catch(function(){api.disable("save"),loadFailedAlert(api)})})}}(templates),onChange:function(templates,updateDialog){return function(api,change){if("template"===change.name){var newTemplateTitle=api.getData().template;findTemplate(templates,newTemplateTitle).each(function(t){api.block("Loading..."),getTemplateContent(t).then(function(previewHtml){updateDialog(api,t,previewHtml)}).catch(function(){updateDialog(api,t,""),api.disable("save"),loadFailedAlert(api)})})}}}(templates,updateDialog)}}var selectBoxItems=createSelectBoxItems(templates),updateDialog=function(dialogApi,template,previewHtml){var content=function(editor,html){if(-1===html.indexOf("<html>")){var contentCssLinks_1="";global$1.each(editor.contentCSS,function(url){contentCssLinks_1+='<link type="text/css" rel="stylesheet" href="'+editor.documentBaseURI.toAbsolute(url)+'">'});var bodyClass=editor.settings.body_class||"";-1!==bodyClass.indexOf("=")&&(bodyClass=(bodyClass=editor.getParam("body_class","","hash"))[editor.id]||"");var encode=editor.dom.encode,directionality=editor.getBody().dir,dirAttr=directionality?' dir="'+encode(directionality)+'"':"";html="<!DOCTYPE html><html><head>"+contentCssLinks_1+'</head><body class="'+encode(bodyClass)+'"'+dirAttr+">"+html+"</body></html>"}return Templates_replaceTemplateValues(html,Settings_getPreviewReplaceValues(editor))}(editor,previewHtml),bodyItems=[{type:"selectbox",name:"template",label:"Templates",items:selectBoxItems},{type:"htmlpanel",html:'<p aria-live="polite">'+htmlEscape(template.value.description)+"</p>"},{label:"Preview",type:"iframe",name:"preview",sandboxed:!1}],initialData={template:template.text,preview:content};dialogApi.unblock(),dialogApi.redial(buildDialogSpec(bodyItems,initialData)),dialogApi.focus("template")},dialogApi=editor.windowManager.open(buildDialogSpec([],{template:"",preview:""}));dialogApi.block("Loading..."),getTemplateContent(templates[0]).then(function(previewHtml){updateDialog(dialogApi,templates[0],previewHtml)}).catch(function(){updateDialog(dialogApi,templates[0],""),dialogApi.disable("save"),loadFailedAlert(dialogApi)})})},Buttons_register=function(editor){editor.ui.registry.addButton("template",{icon:"template",tooltip:"Insert template",onAction:Templates_createTemplateList(editor.settings,showDialog(editor))}),editor.ui.registry.addMenuItem("template",{icon:"template",text:"Insert template...",onAction:Templates_createTemplateList(editor.settings,showDialog(editor))})};global.add("template",function(editor){Buttons_register(editor),Commands_register(editor),FilterContent_setup(editor)})}(),function(){"use strict";function noop(){}function constant(value){return function(){return value}}function none(){return NONE}var me,global=tinymce.util.Tools.resolve("tinymce.PluginManager"),global$1=tinymce.util.Tools.resolve("tinymce.util.Tools"),Actions_applyListFormat=function(editor,listName,styleValue){var cmd="UL"===listName?"InsertUnorderedList":"InsertOrderedList";editor.execCommand(cmd,!1,!1===styleValue?null:{"list-style-type":styleValue})},Commands_register=function(editor){editor.addCommand("ApplyUnorderedListStyle",function(ui,value){Actions_applyListFormat(editor,"UL",value["list-style-type"])}),editor.addCommand("ApplyOrderedListStyle",function(ui,value){Actions_applyListFormat(editor,"OL",value["list-style-type"])})},Settings_getNumberStyles=function(editor){var styles=editor.getParam("advlist_number_styles","default,lower-alpha,lower-greek,lower-roman,upper-alpha,upper-roman");return styles?styles.split(/[ ,]/):[]},Settings_getBulletStyles=function(editor){var styles=editor.getParam("advlist_bullet_styles","default,circle,square");return styles?styles.split(/[ ,]/):[]},never=constant(!1),always=constant(!0),NONE=(me={fold:function(n,s){return n()},is:never,isSome:never,isNone:always,getOr:id,getOrThunk:call,getOrDie:function(msg){throw new Error(msg||"error: getOrDie called on none.")},getOrNull:constant(null),getOrUndefined:constant(void 0),or:id,orThunk:call,map:none,each:noop,bind:none,exists:never,forall:always,filter:none,equals:eq,equals_:eq,toArray:function(){return[]},toString:constant("none()")},Object.freeze&&Object.freeze(me),me);function eq(o){return o.isNone()}function call(thunk){return thunk()}function id(n){return n}function isWithinList(editor,e,nodeName){var tableCellIndex=function(list,predicate){for(var index=0;index<list.length;index++){if(predicate(list[index]))return index}return-1}(e.parents,ListUtils_isTableCellNode),parents=-1!==tableCellIndex?e.parents.slice(0,tableCellIndex):e.parents,lists=global$1.grep(parents,ListUtils_isListNode(editor));return 0<lists.length&&lists[0].nodeName===nodeName}function addSplitButton(editor,id,tooltip,cmd,nodeName,styles){editor.ui.registry.addSplitButton(id,{tooltip:tooltip,icon:"OL"===nodeName?"ordered-list":"unordered-list",presets:"listpreview",columns:3,fetch:function(callback){callback(global$1.map(styles,function(styleValue){return{type:"choiceitem",value:"default"===styleValue?"":styleValue,icon:"list-"+("OL"===nodeName?"num":"bull")+"-"+("disc"===styleValue||"decimal"===styleValue?"default":styleValue),text:function(styleValue){return styleValue.replace(/\-/g," ").replace(/\b\w/g,function(chr){return chr.toUpperCase()})}(styleValue)}}))},onAction:function(){return editor.execCommand(cmd)},onItemAction:function(splitButtonApi,value){Actions_applyListFormat(editor,nodeName,value)},select:function(value){return ListUtils_getSelectedStyleType(editor).map(function(listStyle){return value===listStyle}).getOr(!1)},onSetup:function(api){function nodeChangeHandler(e){api.setActive(isWithinList(editor,e,nodeName))}return editor.on("NodeChange",nodeChangeHandler),function(){return editor.off("NodeChange",nodeChangeHandler)}}})}function addButton(editor,id,tooltip,cmd,nodeName,styles){editor.ui.registry.addToggleButton(id,{active:!1,tooltip:tooltip,icon:"OL"===nodeName?"ordered-list":"unordered-list",onSetup:function(api){function nodeChangeHandler(e){api.setActive(isWithinList(editor,e,nodeName))}return editor.on("NodeChange",nodeChangeHandler),function(){return editor.off("NodeChange",nodeChangeHandler)}},onAction:function(){return editor.execCommand(cmd)}})}function addControl(editor,id,tooltip,cmd,nodeName,styles){0<styles.length?addSplitButton(editor,id,tooltip,cmd,nodeName,styles):addButton(editor,id,tooltip,cmd,nodeName)}var some=function(a){function self(){return me}function bind(f){return f(a)}var constant_a=constant(a),me={fold:function(n,s){return s(a)},is:function(v){return a===v},isSome:always,isNone:never,getOr:constant_a,getOrThunk:constant_a,getOrDie:constant_a,getOrNull:constant_a,getOrUndefined:constant_a,or:self,orThunk:self,map:function(f){return some(f(a))},each:function(f){f(a)},bind:bind,exists:bind,forall:bind,filter:function(f){return f(a)?me:NONE},toArray:function(){return[a]},toString:function(){return"some("+a+")"},equals:function(o){return o.is(a)},equals_:function(o,elementEq){return o.fold(never,function(b){return elementEq(a,b)})}};return me},Option_from=function(value){return null==value?NONE:some(value)},ListUtils_isTableCellNode=function(node){return node&&/^(TH|TD)$/.test(node.nodeName)},ListUtils_isListNode=function(editor){return function(node){return node&&/^(OL|UL|DL)$/.test(node.nodeName)&&function(editor,elm){return editor.$.contains(editor.getBody(),elm)}(editor,node)}},ListUtils_getSelectedStyleType=function(editor){var listElm=editor.dom.getParent(editor.selection.getNode(),"ol,ul"),style=editor.dom.getStyle(listElm,"listStyleType");return Option_from(style)},Buttons_register=function(editor){addControl(editor,"numlist","Numbered list","InsertOrderedList","OL",Settings_getNumberStyles(editor)),addControl(editor,"bullist","Bullet list","InsertUnorderedList","UL",Settings_getBulletStyles(editor))};global.add("advlist",function(editor){!function(editor,plugin){var plugins=editor.settings.plugins?editor.settings.plugins:"";return-1!==global$1.inArray(plugins.split(/[ ,]/),plugin)}(editor,"lists")||(Buttons_register(editor),Commands_register(editor))})}(),function(window,factory){"function"==typeof define&&define.amd?define("jquery-bridget/jquery-bridget",["jquery"],function(jQuery){return factory(window,jQuery)}):"object"==typeof module&&module.exports?module.exports=factory(window,require("jquery")):window.jQueryBridget=factory(window,window.jQuery)}(window,function(window,jQuery){"use strict";var arraySlice=Array.prototype.slice,console=window.console,logError=void 0===console?function(){}:function(message){console.error(message)};function jQueryBridget(namespace,PluginClass,$){($=$||jQuery||window.jQuery)&&(PluginClass.prototype.option||(PluginClass.prototype.option=function(opts){$.isPlainObject(opts)&&(this.options=$.extend(!0,this.options,opts))}),$.fn[namespace]=function(arg0){return"string"==typeof arg0?function($elems,methodName,args){var returnValue,pluginMethodStr="$()."+namespace+'("'+methodName+'")';return $elems.each(function(i,elem){var instance=$.data(elem,namespace);if(instance){var method=instance[methodName];if(method&&"_"!=methodName.charAt(0)){var value=method.apply(instance,args);returnValue=void 0===returnValue?value:returnValue}else logError(pluginMethodStr+" is not a valid method")}else logError(namespace+" not initialized. Cannot call methods, i.e. "+pluginMethodStr)}),void 0!==returnValue?returnValue:$elems}(this,arg0,arraySlice.call(arguments,1)):(function($elems,options){$elems.each(function(i,elem){var instance=$.data(elem,namespace);instance?(instance.option(options),instance._init()):(instance=new PluginClass(elem,options),$.data(elem,namespace,instance))})}(this,arg0),this)},updateJQuery($))}function updateJQuery($){!$||$&&$.bridget||($.bridget=jQueryBridget)}return updateJQuery(jQuery||window.jQuery),jQueryBridget}),function(global,factory){"function"==typeof define&&define.amd?define("ev-emitter/ev-emitter",factory):"object"==typeof module&&module.exports?module.exports=factory():global.EvEmitter=factory()}("undefined"!=typeof window?window:this,function(){function EvEmitter(){}var proto=EvEmitter.prototype;return proto.on=function(eventName,listener){if(eventName&&listener){var events=this._events=this._events||{},listeners=events[eventName]=events[eventName]||[];return-1==listeners.indexOf(listener)&&listeners.push(listener),this}},proto.once=function(eventName,listener){if(eventName&&listener){this.on(eventName,listener);var onceEvents=this._onceEvents=this._onceEvents||{};return(onceEvents[eventName]=onceEvents[eventName]||{})[listener]=!0,this}},proto.off=function(eventName,listener){var listeners=this._events&&this._events[eventName];if(listeners&&listeners.length){var index=listeners.indexOf(listener);return-1!=index&&listeners.splice(index,1),this}},proto.emitEvent=function(eventName,args){var listeners=this._events&&this._events[eventName];if(listeners&&listeners.length){listeners=listeners.slice(0),args=args||[];for(var onceListeners=this._onceEvents&&this._onceEvents[eventName],i=0;i<listeners.length;i++){var listener=listeners[i];onceListeners&&onceListeners[listener]&&(this.off(eventName,listener),delete onceListeners[listener]),listener.apply(this,args)}return this}},proto.allOff=function(){delete this._events,delete this._onceEvents},EvEmitter}),function(window,factory){"function"==typeof define&&define.amd?define("get-size/get-size",factory):"object"==typeof module&&module.exports?module.exports=factory():window.getSize=factory()}(window,function(){"use strict";function getStyleSize(value){var num=parseFloat(value);return-1==value.indexOf("%")&&!isNaN(num)&&num}var logError="undefined"==typeof console?function(){}:function(message){console.error(message)},measurements=["paddingLeft","paddingRight","paddingTop","paddingBottom","marginLeft","marginRight","marginTop","marginBottom","borderLeftWidth","borderRightWidth","borderTopWidth","borderBottomWidth"],measurementsLength=measurements.length;function getStyle(elem){var style=getComputedStyle(elem);return style||logError("Style returned "+style+". Are you running this code in a hidden iframe on Firefox? See https://bit.ly/getsizebug1"),style}var isBoxSizeOuter,isSetup=!1;function getSize(elem){if(!function(){if(!isSetup){isSetup=!0;var div=document.createElement("div");div.style.width="200px",div.style.padding="1px 2px 3px 4px",div.style.borderStyle="solid",div.style.borderWidth="1px 2px 3px 4px",div.style.boxSizing="border-box";var body=document.body||document.documentElement;body.appendChild(div);var style=getStyle(div);isBoxSizeOuter=200==Math.round(getStyleSize(style.width)),getSize.isBoxSizeOuter=isBoxSizeOuter,body.removeChild(div)}}(),"string"==typeof elem&&(elem=document.querySelector(elem)),elem&&"object"==typeof elem&&elem.nodeType){var style=getStyle(elem);if("none"==style.display)return function(){for(var size={width:0,height:0,innerWidth:0,innerHeight:0,outerWidth:0,outerHeight:0},i=0;i<measurementsLength;i++){size[measurements[i]]=0}return size}();var size={};size.width=elem.offsetWidth,size.height=elem.offsetHeight;for(var isBorderBox=size.isBorderBox="border-box"==style.boxSizing,i=0;i<measurementsLength;i++){var measurement=measurements[i],value=style[measurement],num=parseFloat(value);size[measurement]=isNaN(num)?0:num}var paddingWidth=size.paddingLeft+size.paddingRight,paddingHeight=size.paddingTop+size.paddingBottom,marginWidth=size.marginLeft+size.marginRight,marginHeight=size.marginTop+size.marginBottom,borderWidth=size.borderLeftWidth+size.borderRightWidth,borderHeight=size.borderTopWidth+size.borderBottomWidth,isBorderBoxSizeOuter=isBorderBox&&isBoxSizeOuter,styleWidth=getStyleSize(style.width);!1!==styleWidth&&(size.width=styleWidth+(isBorderBoxSizeOuter?0:paddingWidth+borderWidth));var styleHeight=getStyleSize(style.height);return!1!==styleHeight&&(size.height=styleHeight+(isBorderBoxSizeOuter?0:paddingHeight+borderHeight)),size.innerWidth=size.width-(paddingWidth+borderWidth),size.innerHeight=size.height-(paddingHeight+borderHeight),size.outerWidth=size.width+marginWidth,size.outerHeight=size.height+marginHeight,size}}return getSize}),function(window,factory){"use strict";"function"==typeof define&&define.amd?define("desandro-matches-selector/matches-selector",factory):"object"==typeof module&&module.exports?module.exports=factory():window.matchesSelector=factory()}(window,function(){"use strict";var matchesMethod=function(){var ElemProto=window.Element.prototype;if(ElemProto.matches)return"matches";if(ElemProto.matchesSelector)return"matchesSelector";for(var prefixes=["webkit","moz","ms","o"],i=0;i<prefixes.length;i++){var method=prefixes[i]+"MatchesSelector";if(ElemProto[method])return method}}();return function(elem,selector){return elem[matchesMethod](selector)}}),function(window,factory){"function"==typeof define&&define.amd?define("fizzy-ui-utils/utils",["desandro-matches-selector/matches-selector"],function(matchesSelector){return factory(window,matchesSelector)}):"object"==typeof module&&module.exports?module.exports=factory(window,require("desandro-matches-selector")):window.fizzyUIUtils=factory(window,window.matchesSelector)}(window,function(window,matchesSelector){var utils={extend:function(a,b){for(var prop in b)a[prop]=b[prop];return a},modulo:function(num,div){return(num%div+div)%div}},arraySlice=Array.prototype.slice;utils.makeArray=function(obj){return Array.isArray(obj)?obj:null==obj?[]:"object"==typeof obj&&"number"==typeof obj.length?arraySlice.call(obj):[obj]},utils.removeFrom=function(ary,obj){var index=ary.indexOf(obj);-1!=index&&ary.splice(index,1)},utils.getParent=function(elem,selector){for(;elem.parentNode&&elem!=document.body;)if(elem=elem.parentNode,matchesSelector(elem,selector))return elem},utils.getQueryElement=function(elem){return"string"==typeof elem?document.querySelector(elem):elem},utils.handleEvent=function(event){var method="on"+event.type;this[method]&&this[method](event)},utils.filterFindElements=function(elems,selector){elems=utils.makeArray(elems);var ffElems=[];return elems.forEach(function(elem){if(elem instanceof HTMLElement)if(selector){matchesSelector(elem,selector)&&ffElems.push(elem);for(var childElems=elem.querySelectorAll(selector),i=0;i<childElems.length;i++)ffElems.push(childElems[i])}else ffElems.push(elem)}),ffElems},utils.debounceMethod=function(_class,methodName,threshold){threshold=threshold||100;var method=_class.prototype[methodName],timeoutName=methodName+"Timeout";_class.prototype[methodName]=function(){var timeout=this[timeoutName];clearTimeout(timeout);var args=arguments,_this=this;this[timeoutName]=setTimeout(function(){method.apply(_this,args),delete _this[timeoutName]},threshold)}},utils.docReady=function(callback){var readyState=document.readyState;"complete"==readyState||"interactive"==readyState?setTimeout(callback):document.addEventListener("DOMContentLoaded",callback)},utils.toDashed=function(str){return str.replace(/(.)([A-Z])/g,function(match,$1,$2){return $1+"-"+$2}).toLowerCase()};var console=window.console;return utils.htmlInit=function(WidgetClass,namespace){utils.docReady(function(){var dashedNamespace=utils.toDashed(namespace),dataAttr="data-"+dashedNamespace,dataAttrElems=document.querySelectorAll("["+dataAttr+"]"),jsDashElems=document.querySelectorAll(".js-"+dashedNamespace),elems=utils.makeArray(dataAttrElems).concat(utils.makeArray(jsDashElems)),dataOptionsAttr=dataAttr+"-options",jQuery=window.jQuery;elems.forEach(function(elem){var options,attr=elem.getAttribute(dataAttr)||elem.getAttribute(dataOptionsAttr);try{options=attr&&JSON.parse(attr)}catch(error){return void(console&&console.error("Error parsing "+dataAttr+" on "+elem.className+": "+error))}var instance=new WidgetClass(elem,options);jQuery&&jQuery.data(elem,namespace,instance)})})},utils}),function(window,factory){"function"==typeof define&&define.amd?define("outlayer/item",["ev-emitter/ev-emitter","get-size/get-size"],factory):"object"==typeof module&&module.exports?module.exports=factory(require("ev-emitter"),require("get-size")):(window.Outlayer={},window.Outlayer.Item=factory(window.EvEmitter,window.getSize))}(window,function(EvEmitter,getSize){"use strict";var docElemStyle=document.documentElement.style,transitionProperty="string"==typeof docElemStyle.transition?"transition":"WebkitTransition",transformProperty="string"==typeof docElemStyle.transform?"transform":"WebkitTransform",transitionEndEvent={WebkitTransition:"webkitTransitionEnd",transition:"transitionend"}[transitionProperty],vendorProperties={transform:transformProperty,transition:transitionProperty,transitionDuration:transitionProperty+"Duration",transitionProperty:transitionProperty+"Property",transitionDelay:transitionProperty+"Delay"};function Item(element,layout){element&&(this.element=element,this.layout=layout,this.position={x:0,y:0},this._create())}var proto=Item.prototype=Object.create(EvEmitter.prototype);proto.constructor=Item,proto._create=function(){this._transn={ingProperties:{},clean:{},onEnd:{}},this.css({position:"absolute"})},proto.handleEvent=function(event){var method="on"+event.type;this[method]&&this[method](event)},proto.getSize=function(){this.size=getSize(this.element)},proto.css=function(style){var elemStyle=this.element.style;for(var prop in style){elemStyle[vendorProperties[prop]||prop]=style[prop]}},proto.getPosition=function(){var style=getComputedStyle(this.element),isOriginLeft=this.layout._getOption("originLeft"),isOriginTop=this.layout._getOption("originTop"),xValue=style[isOriginLeft?"left":"right"],yValue=style[isOriginTop?"top":"bottom"],x=parseFloat(xValue),y=parseFloat(yValue),layoutSize=this.layout.size;-1!=xValue.indexOf("%")&&(x=x/100*layoutSize.width),-1!=yValue.indexOf("%")&&(y=y/100*layoutSize.height),x=isNaN(x)?0:x,y=isNaN(y)?0:y,x-=isOriginLeft?layoutSize.paddingLeft:layoutSize.paddingRight,y-=isOriginTop?layoutSize.paddingTop:layoutSize.paddingBottom,this.position.x=x,this.position.y=y},proto.layoutPosition=function(){var layoutSize=this.layout.size,style={},isOriginLeft=this.layout._getOption("originLeft"),isOriginTop=this.layout._getOption("originTop"),xPadding=isOriginLeft?"paddingLeft":"paddingRight",xProperty=isOriginLeft?"left":"right",xResetProperty=isOriginLeft?"right":"left",x=this.position.x+layoutSize[xPadding];style[xProperty]=this.getXValue(x),style[xResetProperty]="";var yPadding=isOriginTop?"paddingTop":"paddingBottom",yProperty=isOriginTop?"top":"bottom",yResetProperty=isOriginTop?"bottom":"top",y=this.position.y+layoutSize[yPadding];style[yProperty]=this.getYValue(y),style[yResetProperty]="",this.css(style),this.emitEvent("layout",[this])},proto.getXValue=function(x){var isHorizontal=this.layout._getOption("horizontal");return this.layout.options.percentPosition&&!isHorizontal?x/this.layout.size.width*100+"%":x+"px"},proto.getYValue=function(y){var isHorizontal=this.layout._getOption("horizontal");return this.layout.options.percentPosition&&isHorizontal?y/this.layout.size.height*100+"%":y+"px"},proto._transitionTo=function(x,y){this.getPosition();var curX=this.position.x,curY=this.position.y,didNotMove=x==this.position.x&&y==this.position.y;if(this.setPosition(x,y),!didNotMove||this.isTransitioning){var transX=x-curX,transY=y-curY,transitionStyle={};transitionStyle.transform=this.getTranslate(transX,transY),this.transition({to:transitionStyle,onTransitionEnd:{transform:this.layoutPosition},isCleaning:!0})}else this.layoutPosition()},proto.getTranslate=function(x,y){return"translate3d("+(x=this.layout._getOption("originLeft")?x:-x)+"px, "+(y=this.layout._getOption("originTop")?y:-y)+"px, 0)"},proto.goTo=function(x,y){this.setPosition(x,y),this.layoutPosition()},proto.moveTo=proto._transitionTo,proto.setPosition=function(x,y){this.position.x=parseFloat(x),this.position.y=parseFloat(y)},proto._nonTransition=function(args){for(var prop in this.css(args.to),args.isCleaning&&this._removeStyles(args.to),args.onTransitionEnd)args.onTransitionEnd[prop].call(this)},proto.transition=function(args){if(parseFloat(this.layout.options.transitionDuration)){var _transition=this._transn;for(var prop in args.onTransitionEnd)_transition.onEnd[prop]=args.onTransitionEnd[prop];for(prop in args.to)_transition.ingProperties[prop]=!0,args.isCleaning&&(_transition.clean[prop]=!0);if(args.from){this.css(args.from);this.element.offsetHeight;null}this.enableTransition(args.to),this.css(args.to),this.isTransitioning=!0}else this._nonTransition(args)};var transitionProps="opacity,"+transformProperty.replace(/([A-Z])/g,function($1){return"-"+$1.toLowerCase()});proto.enableTransition=function(){if(!this.isTransitioning){var duration=this.layout.options.transitionDuration;duration="number"==typeof duration?duration+"ms":duration,this.css({transitionProperty:transitionProps,transitionDuration:duration,transitionDelay:this.staggerDelay||0}),this.element.addEventListener(transitionEndEvent,this,!1)}},proto.onwebkitTransitionEnd=function(event){this.ontransitionend(event)},proto.onotransitionend=function(event){this.ontransitionend(event)};var dashedVendorProperties={"-webkit-transform":"transform"};proto.ontransitionend=function(event){if(event.target===this.element){var _transition=this._transn,propertyName=dashedVendorProperties[event.propertyName]||event.propertyName;if(delete _transition.ingProperties[propertyName],function(obj){for(var prop in obj)return!1;return!null}(_transition.ingProperties)&&this.disableTransition(),propertyName in _transition.clean&&(this.element.style[event.propertyName]="",delete _transition.clean[propertyName]),propertyName in _transition.onEnd)_transition.onEnd[propertyName].call(this),delete _transition.onEnd[propertyName];this.emitEvent("transitionEnd",[this])}},proto.disableTransition=function(){this.removeTransitionStyles(),this.element.removeEventListener(transitionEndEvent,this,!1),this.isTransitioning=!1},proto._removeStyles=function(style){var cleanStyle={};for(var prop in style)cleanStyle[prop]="";this.css(cleanStyle)};var cleanTransitionStyle={transitionProperty:"",transitionDuration:"",transitionDelay:""};return proto.removeTransitionStyles=function(){this.css(cleanTransitionStyle)},proto.stagger=function(delay){delay=isNaN(delay)?0:delay,this.staggerDelay=delay+"ms"},proto.removeElem=function(){this.element.parentNode.removeChild(this.element),this.css({display:""}),this.emitEvent("remove",[this])},proto.remove=function(){transitionProperty&&parseFloat(this.layout.options.transitionDuration)?(this.once("transitionEnd",function(){this.removeElem()}),this.hide()):this.removeElem()},proto.reveal=function(){delete this.isHidden,this.css({display:""});var options=this.layout.options,onTransitionEnd={};onTransitionEnd[this.getHideRevealTransitionEndProperty("visibleStyle")]=this.onRevealTransitionEnd,this.transition({from:options.hiddenStyle,to:options.visibleStyle,isCleaning:!0,onTransitionEnd:onTransitionEnd})},proto.onRevealTransitionEnd=function(){this.isHidden||this.emitEvent("reveal")},proto.getHideRevealTransitionEndProperty=function(styleProperty){var optionStyle=this.layout.options[styleProperty];if(optionStyle.opacity)return"opacity";for(var prop in optionStyle)return prop},proto.hide=function(){this.isHidden=!0,this.css({display:""});var options=this.layout.options,onTransitionEnd={};onTransitionEnd[this.getHideRevealTransitionEndProperty("hiddenStyle")]=this.onHideTransitionEnd,this.transition({from:options.visibleStyle,to:options.hiddenStyle,isCleaning:!0,onTransitionEnd:onTransitionEnd})},proto.onHideTransitionEnd=function(){this.isHidden&&(this.css({display:"none"}),this.emitEvent("hide"))},proto.destroy=function(){this.css({position:"",left:"",right:"",top:"",bottom:"",transition:"",transform:""})},Item}),function(window,factory){"use strict";"function"==typeof define&&define.amd?define("outlayer/outlayer",["ev-emitter/ev-emitter","get-size/get-size","fizzy-ui-utils/utils","./item"],function(EvEmitter,getSize,utils,Item){return factory(window,EvEmitter,getSize,utils,Item)}):"object"==typeof module&&module.exports?module.exports=factory(window,require("ev-emitter"),require("get-size"),require("fizzy-ui-utils"),require("./item")):window.Outlayer=factory(window,window.EvEmitter,window.getSize,window.fizzyUIUtils,window.Outlayer.Item)}(window,function(window,EvEmitter,getSize,utils,Item){"use strict";function noop(){}var console=window.console,jQuery=window.jQuery,GUID=0,instances={};function Outlayer(element,options){var queryElement=utils.getQueryElement(element);if(queryElement){this.element=queryElement,jQuery&&(this.$element=jQuery(this.element)),this.options=utils.extend({},this.constructor.defaults),this.option(options);var id=++GUID;this.element.outlayerGUID=id,(instances[id]=this)._create(),this._getOption("initLayout")&&this.layout()}else console&&console.error("Bad element for "+this.constructor.namespace+": "+(queryElement||element))}Outlayer.namespace="outlayer",Outlayer.Item=Item,Outlayer.defaults={containerStyle:{position:"relative"},initLayout:!0,originLeft:!0,originTop:!0,resize:!0,resizeContainer:!0,transitionDuration:"0.4s",hiddenStyle:{opacity:0,transform:"scale(0.001)"},visibleStyle:{opacity:1,transform:"scale(1)"}};var proto=Outlayer.prototype;function subclass(Parent){function SubClass(){Parent.apply(this,arguments)}return(SubClass.prototype=Object.create(Parent.prototype)).constructor=SubClass}utils.extend(proto,EvEmitter.prototype),proto.option=function(opts){utils.extend(this.options,opts)},proto._getOption=function(option){var oldOption=this.constructor.compatOptions[option];return oldOption&&void 0!==this.options[oldOption]?this.options[oldOption]:this.options[option]},Outlayer.compatOptions={initLayout:"isInitLayout",horizontal:"isHorizontal",layoutInstant:"isLayoutInstant",originLeft:"isOriginLeft",originTop:"isOriginTop",resize:"isResizeBound",resizeContainer:"isResizingContainer"},proto._create=function(){this.reloadItems(),this.stamps=[],this.stamp(this.options.stamp),utils.extend(this.element.style,this.options.containerStyle),this._getOption("resize")&&this.bindResize()},proto.reloadItems=function(){this.items=this._itemize(this.element.children)},proto._itemize=function(elems){for(var itemElems=this._filterFindItemElements(elems),Item=this.constructor.Item,items=[],i=0;i<itemElems.length;i++){var item=new Item(itemElems[i],this);items.push(item)}return items},proto._filterFindItemElements=function(elems){return utils.filterFindElements(elems,this.options.itemSelector)},proto.getItemElements=function(){return this.items.map(function(item){return item.element})},proto.layout=function(){this._resetLayout(),this._manageStamps();var layoutInstant=this._getOption("layoutInstant"),isInstant=void 0!==layoutInstant?layoutInstant:!this._isLayoutInited;this.layoutItems(this.items,isInstant),this._isLayoutInited=!0},proto._init=proto.layout,proto._resetLayout=function(){this.getSize()},proto.getSize=function(){this.size=getSize(this.element)},proto._getMeasurement=function(measurement,size){var elem,option=this.options[measurement];option?("string"==typeof option?elem=this.element.querySelector(option):option instanceof HTMLElement&&(elem=option),this[measurement]=elem?getSize(elem)[size]:option):this[measurement]=0},proto.layoutItems=function(items,isInstant){items=this._getItemsForLayout(items),this._layoutItems(items,isInstant),this._postLayout()},proto._getItemsForLayout=function(items){return items.filter(function(item){return!item.isIgnored})},proto._layoutItems=function(items,isInstant){if(this._emitCompleteOnItems("layout",items),items&&items.length){var queue=[];items.forEach(function(item){var position=this._getItemLayoutPosition(item);position.item=item,position.isInstant=isInstant||item.isLayoutInstant,queue.push(position)},this),this._processLayoutQueue(queue)}},proto._getItemLayoutPosition=function(){return{x:0,y:0}},proto._processLayoutQueue=function(queue){this.updateStagger(),queue.forEach(function(obj,i){this._positionItem(obj.item,obj.x,obj.y,obj.isInstant,i)},this)},proto.updateStagger=function(){var stagger=this.options.stagger;if(null!=stagger)return this.stagger=function(time){if("number"==typeof time)return time;var matches=time.match(/(^\d*\.?\d*)(\w*)/),num=matches&&matches[1],unit=matches&&matches[2];if(!num.length)return 0;num=parseFloat(num);var mult=msUnits[unit]||1;return num*mult}(stagger),this.stagger;this.stagger=0},proto._positionItem=function(item,x,y,isInstant,i){isInstant?item.goTo(x,y):(item.stagger(i*this.stagger),item.moveTo(x,y))},proto._postLayout=function(){this.resizeContainer()},proto.resizeContainer=function(){if(this._getOption("resizeContainer")){var size=this._getContainerSize();size&&(this._setContainerMeasure(size.width,!0),this._setContainerMeasure(size.height,!1))}},proto._getContainerSize=noop,proto._setContainerMeasure=function(measure,isWidth){if(void 0!==measure){var elemSize=this.size;elemSize.isBorderBox&&(measure+=isWidth?elemSize.paddingLeft+elemSize.paddingRight+elemSize.borderLeftWidth+elemSize.borderRightWidth:elemSize.paddingBottom+elemSize.paddingTop+elemSize.borderTopWidth+elemSize.borderBottomWidth),measure=Math.max(measure,0),this.element.style[isWidth?"width":"height"]=measure+"px"}},proto._emitCompleteOnItems=function(eventName,items){var _this=this;function onComplete(){_this.dispatchEvent(eventName+"Complete",null,[items])}var count=items.length;if(items&&count){var doneCount=0;items.forEach(function(item){item.once(eventName,tick)})}else onComplete();function tick(){++doneCount==count&&onComplete()}},proto.dispatchEvent=function(type,event,args){var emitArgs=event?[event].concat(args):args;if(this.emitEvent(type,emitArgs),jQuery)if(this.$element=this.$element||jQuery(this.element),event){var $event=jQuery.Event(event);$event.type=type,this.$element.trigger($event,args)}else this.$element.trigger(type,args)},proto.ignore=function(elem){var item=this.getItem(elem);item&&(item.isIgnored=!0)},proto.unignore=function(elem){var item=this.getItem(elem);item&&delete item.isIgnored},proto.stamp=function(elems){(elems=this._find(elems))&&(this.stamps=this.stamps.concat(elems),elems.forEach(this.ignore,this))},proto.unstamp=function(elems){(elems=this._find(elems))&&elems.forEach(function(elem){utils.removeFrom(this.stamps,elem),this.unignore(elem)},this)},proto._find=function(elems){if(elems)return"string"==typeof elems&&(elems=this.element.querySelectorAll(elems)),elems=utils.makeArray(elems)},proto._manageStamps=function(){this.stamps&&this.stamps.length&&(this._getBoundingRect(),this.stamps.forEach(this._manageStamp,this))},proto._getBoundingRect=function(){var boundingRect=this.element.getBoundingClientRect(),size=this.size;this._boundingRect={left:boundingRect.left+size.paddingLeft+size.borderLeftWidth,top:boundingRect.top+size.paddingTop+size.borderTopWidth,right:boundingRect.right-(size.paddingRight+size.borderRightWidth),bottom:boundingRect.bottom-(size.paddingBottom+size.borderBottomWidth)}},proto._manageStamp=noop,proto._getElementOffset=function(elem){var boundingRect=elem.getBoundingClientRect(),thisRect=this._boundingRect,size=getSize(elem);return{left:boundingRect.left-thisRect.left-size.marginLeft,top:boundingRect.top-thisRect.top-size.marginTop,right:thisRect.right-boundingRect.right-size.marginRight,bottom:thisRect.bottom-boundingRect.bottom-size.marginBottom}},proto.handleEvent=utils.handleEvent,proto.bindResize=function(){window.addEventListener("resize",this),this.isResizeBound=!0},proto.unbindResize=function(){window.removeEventListener("resize",this),this.isResizeBound=!1},proto.onresize=function(){this.resize()},utils.debounceMethod(Outlayer,"onresize",100),proto.resize=function(){this.isResizeBound&&this.needsResizeLayout()&&this.layout()},proto.needsResizeLayout=function(){var size=getSize(this.element);return this.size&&size&&size.innerWidth!==this.size.innerWidth},proto.addItems=function(elems){var items=this._itemize(elems);return items.length&&(this.items=this.items.concat(items)),items},proto.appended=function(elems){var items=this.addItems(elems);items.length&&(this.layoutItems(items,!0),this.reveal(items))},proto.prepended=function(elems){var items=this._itemize(elems);if(items.length){var previousItems=this.items.slice(0);this.items=items.concat(previousItems),this._resetLayout(),this._manageStamps(),this.layoutItems(items,!0),this.reveal(items),this.layoutItems(previousItems)}},proto.reveal=function(items){if(this._emitCompleteOnItems("reveal",items),items&&items.length){var stagger=this.updateStagger();items.forEach(function(item,i){item.stagger(i*stagger),item.reveal()})}},proto.hide=function(items){if(this._emitCompleteOnItems("hide",items),items&&items.length){var stagger=this.updateStagger();items.forEach(function(item,i){item.stagger(i*stagger),item.hide()})}},proto.revealItemElements=function(elems){var items=this.getItems(elems);this.reveal(items)},proto.hideItemElements=function(elems){var items=this.getItems(elems);this.hide(items)},proto.getItem=function(elem){for(var i=0;i<this.items.length;i++){var item=this.items[i];if(item.element==elem)return item}},proto.getItems=function(elems){elems=utils.makeArray(elems);var items=[];return elems.forEach(function(elem){var item=this.getItem(elem);item&&items.push(item)},this),items},proto.remove=function(elems){var removeItems=this.getItems(elems);this._emitCompleteOnItems("remove",removeItems),removeItems&&removeItems.length&&removeItems.forEach(function(item){item.remove(),utils.removeFrom(this.items,item)},this)},proto.destroy=function(){var style=this.element.style;style.height="",style.position="",style.width="",this.items.forEach(function(item){item.destroy()}),this.unbindResize();var id=this.element.outlayerGUID;delete instances[id],delete this.element.outlayerGUID,jQuery&&jQuery.removeData(this.element,this.constructor.namespace)},Outlayer.data=function(elem){var id=(elem=utils.getQueryElement(elem))&&elem.outlayerGUID;return id&&instances[id]},Outlayer.create=function(namespace,options){var Layout=subclass(Outlayer);return Layout.defaults=utils.extend({},Outlayer.defaults),utils.extend(Layout.defaults,options),Layout.compatOptions=utils.extend({},Outlayer.compatOptions),Layout.namespace=namespace,Layout.data=Outlayer.data,Layout.Item=subclass(Item),utils.htmlInit(Layout,namespace),jQuery&&jQuery.bridget&&jQuery.bridget(namespace,Layout),Layout};var msUnits={ms:1,s:1e3};return Outlayer.Item=Item,Outlayer}),function(window,factory){"function"==typeof define&&define.amd?define("isotope-layout/js/item",["outlayer/outlayer"],factory):"object"==typeof module&&module.exports?module.exports=factory(require("outlayer")):(window.Isotope=window.Isotope||{},window.Isotope.Item=factory(window.Outlayer))}(window,function(Outlayer){"use strict";function Item(){Outlayer.Item.apply(this,arguments)}var proto=Item.prototype=Object.create(Outlayer.Item.prototype),_create=proto._create;proto._create=function(){this.id=this.layout.itemGUID++,_create.call(this),this.sortData={}},proto.updateSortData=function(){if(!this.isIgnored){this.sortData.id=this.id,this.sortData["original-order"]=this.id,this.sortData.random=Math.random();var getSortData=this.layout.options.getSortData,sorters=this.layout._sorters;for(var key in getSortData){var sorter=sorters[key];this.sortData[key]=sorter(this.element,this)}}};var _destroy=proto.destroy;return proto.destroy=function(){_destroy.apply(this,arguments),this.css({display:""})},Item}),function(window,factory){"function"==typeof define&&define.amd?define("isotope-layout/js/layout-mode",["get-size/get-size","outlayer/outlayer"],factory):"object"==typeof module&&module.exports?module.exports=factory(require("get-size"),require("outlayer")):(window.Isotope=window.Isotope||{},window.Isotope.LayoutMode=factory(window.getSize,window.Outlayer))}(window,function(getSize,Outlayer){"use strict";function LayoutMode(isotope){(this.isotope=isotope)&&(this.options=isotope.options[this.namespace],this.element=isotope.element,this.items=isotope.filteredItems,this.size=isotope.size)}var proto=LayoutMode.prototype;return["_resetLayout","_getItemLayoutPosition","_manageStamp","_getContainerSize","_getElementOffset","needsResizeLayout","_getOption"].forEach(function(methodName){proto[methodName]=function(){return Outlayer.prototype[methodName].apply(this.isotope,arguments)}}),proto.needsVerticalResizeLayout=function(){var size=getSize(this.isotope.element);return this.isotope.size&&size&&size.innerHeight!=this.isotope.size.innerHeight},proto._getMeasurement=function(){this.isotope._getMeasurement.apply(this,arguments)},proto.getColumnWidth=function(){this.getSegmentSize("column","Width")},proto.getRowHeight=function(){this.getSegmentSize("row","Height")},proto.getSegmentSize=function(segment,size){var segmentName=segment+size,outerSize="outer"+size;if(this._getMeasurement(segmentName,outerSize),!this[segmentName]){var firstItemSize=this.getFirstItemSize();this[segmentName]=firstItemSize&&firstItemSize[outerSize]||this.isotope.size["inner"+size]}},proto.getFirstItemSize=function(){var firstItem=this.isotope.filteredItems[0];return firstItem&&firstItem.element&&getSize(firstItem.element)},proto.layout=function(){this.isotope.layout.apply(this.isotope,arguments)},proto.getSize=function(){this.isotope.getSize(),this.size=this.isotope.size},LayoutMode.modes={},LayoutMode.create=function(namespace,options){function Mode(){LayoutMode.apply(this,arguments)}return(Mode.prototype=Object.create(proto)).constructor=Mode,options&&(Mode.options=options),LayoutMode.modes[Mode.prototype.namespace=namespace]=Mode},LayoutMode}),function(window,factory){"function"==typeof define&&define.amd?define("masonry-layout/masonry",["outlayer/outlayer","get-size/get-size"],factory):"object"==typeof module&&module.exports?module.exports=factory(require("outlayer"),require("get-size")):window.Masonry=factory(window.Outlayer,window.getSize)}(window,function(Outlayer,getSize){var Masonry=Outlayer.create("masonry");Masonry.compatOptions.fitWidth="isFitWidth";var proto=Masonry.prototype;return proto._resetLayout=function(){this.getSize(),this._getMeasurement("columnWidth","outerWidth"),this._getMeasurement("gutter","outerWidth"),this.measureColumns(),this.colYs=[];for(var i=0;i<this.cols;i++)this.colYs.push(0);this.maxY=0,this.horizontalColIndex=0},proto.measureColumns=function(){if(this.getContainerWidth(),!this.columnWidth){var firstItem=this.items[0],firstItemElem=firstItem&&firstItem.element;this.columnWidth=firstItemElem&&getSize(firstItemElem).outerWidth||this.containerWidth}var columnWidth=this.columnWidth+=this.gutter,containerWidth=this.containerWidth+this.gutter,cols=containerWidth/columnWidth,excess=columnWidth-containerWidth%columnWidth;cols=Math[excess&&excess<1?"round":"floor"](cols),this.cols=Math.max(cols,1)},proto.getContainerWidth=function(){var container=this._getOption("fitWidth")?this.element.parentNode:this.element,size=getSize(container);this.containerWidth=size&&size.innerWidth},proto._getItemLayoutPosition=function(item){item.getSize();var remainder=item.size.outerWidth%this.columnWidth,colSpan=Math[remainder&&remainder<1?"round":"ceil"](item.size.outerWidth/this.columnWidth);colSpan=Math.min(colSpan,this.cols);for(var colPosition=this[this.options.horizontalOrder?"_getHorizontalColPosition":"_getTopColPosition"](colSpan,item),position={x:this.columnWidth*colPosition.col,y:colPosition.y},setHeight=colPosition.y+item.size.outerHeight,setMax=colSpan+colPosition.col,i=colPosition.col;i<setMax;i++)this.colYs[i]=setHeight;return position},proto._getTopColPosition=function(colSpan){var colGroup=this._getTopColGroup(colSpan),minimumY=Math.min.apply(Math,colGroup);return{col:colGroup.indexOf(minimumY),y:minimumY}},proto._getTopColGroup=function(colSpan){if(colSpan<2)return this.colYs;for(var colGroup=[],groupCount=this.cols+1-colSpan,i=0;i<groupCount;i++)colGroup[i]=this._getColGroupY(i,colSpan);return colGroup},proto._getColGroupY=function(col,colSpan){if(colSpan<2)return this.colYs[col];var groupColYs=this.colYs.slice(col,col+colSpan);return Math.max.apply(Math,groupColYs)},proto._getHorizontalColPosition=function(colSpan,item){var col=this.horizontalColIndex%this.cols;col=1<colSpan&&col+colSpan>this.cols?0:col;var hasSize=item.size.outerWidth&&item.size.outerHeight;return this.horizontalColIndex=hasSize?col+colSpan:this.horizontalColIndex,{col:col,y:this._getColGroupY(col,colSpan)}},proto._manageStamp=function(stamp){var stampSize=getSize(stamp),offset=this._getElementOffset(stamp),firstX=this._getOption("originLeft")?offset.left:offset.right,lastX=firstX+stampSize.outerWidth,firstCol=Math.floor(firstX/this.columnWidth);firstCol=Math.max(0,firstCol);var lastCol=Math.floor(lastX/this.columnWidth);lastCol-=lastX%this.columnWidth?0:1,lastCol=Math.min(this.cols-1,lastCol);for(var stampMaxY=(this._getOption("originTop")?offset.top:offset.bottom)+stampSize.outerHeight,i=firstCol;i<=lastCol;i++)this.colYs[i]=Math.max(stampMaxY,this.colYs[i])},proto._getContainerSize=function(){this.maxY=Math.max.apply(Math,this.colYs);var size={height:this.maxY};return this._getOption("fitWidth")&&(size.width=this._getContainerFitWidth()),size},proto._getContainerFitWidth=function(){for(var unusedCols=0,i=this.cols;--i&&0===this.colYs[i];)unusedCols++;return(this.cols-unusedCols)*this.columnWidth-this.gutter},proto.needsResizeLayout=function(){var previousWidth=this.containerWidth;return this.getContainerWidth(),previousWidth!=this.containerWidth},Masonry}),function(window,factory){"function"==typeof define&&define.amd?define("isotope-layout/js/layout-modes/masonry",["../layout-mode","masonry-layout/masonry"],factory):"object"==typeof module&&module.exports?module.exports=factory(require("../layout-mode"),require("masonry-layout")):factory(window.Isotope.LayoutMode,window.Masonry)}(window,function(LayoutMode,Masonry){"use strict";var MasonryMode=LayoutMode.create("masonry"),proto=MasonryMode.prototype,keepModeMethods={_getElementOffset:!0,layout:!0,_getMeasurement:!0};for(var method in Masonry.prototype)keepModeMethods[method]||(proto[method]=Masonry.prototype[method]);var measureColumns=proto.measureColumns;proto.measureColumns=function(){this.items=this.isotope.filteredItems,measureColumns.call(this)};var _getOption=proto._getOption;return proto._getOption=function(option){return"fitWidth"==option?void 0!==this.options.isFitWidth?this.options.isFitWidth:this.options.fitWidth:_getOption.apply(this.isotope,arguments)},MasonryMode}),function(window,factory){"function"==typeof define&&define.amd?define("isotope-layout/js/layout-modes/fit-rows",["../layout-mode"],factory):"object"==typeof exports?module.exports=factory(require("../layout-mode")):factory(window.Isotope.LayoutMode)}(window,function(LayoutMode){"use strict";var FitRows=LayoutMode.create("fitRows"),proto=FitRows.prototype;return proto._resetLayout=function(){this.x=0,this.y=0,this.maxY=0,this._getMeasurement("gutter","outerWidth")},proto._getItemLayoutPosition=function(item){item.getSize();var itemWidth=item.size.outerWidth+this.gutter,containerWidth=this.isotope.size.innerWidth+this.gutter;0!==this.x&&itemWidth+this.x>containerWidth&&(this.x=0,this.y=this.maxY);var position={x:this.x,y:this.y};return this.maxY=Math.max(this.maxY,this.y+item.size.outerHeight),this.x+=itemWidth,position},proto._getContainerSize=function(){return{height:this.maxY}},FitRows}),function(window,factory){"function"==typeof define&&define.amd?define("isotope-layout/js/layout-modes/vertical",["../layout-mode"],factory):"object"==typeof module&&module.exports?module.exports=factory(require("../layout-mode")):factory(window.Isotope.LayoutMode)}(window,function(LayoutMode){"use strict";var Vertical=LayoutMode.create("vertical",{horizontalAlignment:0}),proto=Vertical.prototype;return proto._resetLayout=function(){this.y=0},proto._getItemLayoutPosition=function(item){item.getSize();var x=(this.isotope.size.innerWidth-item.size.outerWidth)*this.options.horizontalAlignment,y=this.y;return this.y+=item.size.outerHeight,{x:x,y:y}},proto._getContainerSize=function(){return{height:this.y}},Vertical}),function(window,factory){"function"==typeof define&&define.amd?define(["outlayer/outlayer","get-size/get-size","desandro-matches-selector/matches-selector","fizzy-ui-utils/utils","isotope-layout/js/item","isotope-layout/js/layout-mode","isotope-layout/js/layout-modes/masonry","isotope-layout/js/layout-modes/fit-rows","isotope-layout/js/layout-modes/vertical"],function(Outlayer,getSize,matchesSelector,utils,Item,LayoutMode){return factory(window,Outlayer,getSize,matchesSelector,utils,Item,LayoutMode)}):"object"==typeof module&&module.exports?module.exports=factory(window,require("outlayer"),require("get-size"),require("desandro-matches-selector"),require("fizzy-ui-utils"),require("isotope-layout/js/item"),require("isotope-layout/js/layout-mode"),require("isotope-layout/js/layout-modes/masonry"),require("isotope-layout/js/layout-modes/fit-rows"),require("isotope-layout/js/layout-modes/vertical")):window.Isotope=factory(window,window.Outlayer,window.getSize,window.matchesSelector,window.fizzyUIUtils,window.Isotope.Item,window.Isotope.LayoutMode)}(window,function(window,Outlayer,getSize,matchesSelector,utils,Item,LayoutMode){var jQuery=window.jQuery,trim=String.prototype.trim?function(str){return str.trim()}:function(str){return str.replace(/^\s+|\s+$/g,"")},Isotope=Outlayer.create("isotope",{layoutMode:"masonry",isJQueryFiltering:!0,sortAscending:!0});Isotope.Item=Item,Isotope.LayoutMode=LayoutMode;var proto=Isotope.prototype;proto._create=function(){for(var name in this.itemGUID=0,this._sorters={},this._getSorters(),Outlayer.prototype._create.call(this),this.modes={},this.filteredItems=this.items,this.sortHistory=["original-order"],LayoutMode.modes)this._initLayoutMode(name)},proto.reloadItems=function(){this.itemGUID=0,Outlayer.prototype.reloadItems.call(this)},proto._itemize=function(){for(var items=Outlayer.prototype._itemize.apply(this,arguments),i=0;i<items.length;i++){items[i].id=this.itemGUID++}return this._updateItemsSortData(items),items},proto._initLayoutMode=function(name){var Mode=LayoutMode.modes[name],initialOpts=this.options[name]||{};this.options[name]=Mode.options?utils.extend(Mode.options,initialOpts):initialOpts,this.modes[name]=new Mode(this)},proto.layout=function(){this._isLayoutInited||!this._getOption("initLayout")?this._layout():this.arrange()},proto._layout=function(){var isInstant=this._getIsInstant();this._resetLayout(),this._manageStamps(),this.layoutItems(this.filteredItems,isInstant),this._isLayoutInited=!0},proto.arrange=function(opts){this.option(opts),this._getIsInstant();var filtered=this._filter(this.items);this.filteredItems=filtered.matches,this._bindArrangeComplete(),this._isInstant?this._noTransition(this._hideReveal,[filtered]):this._hideReveal(filtered),this._sort(),this._layout()},proto._init=proto.arrange,proto._hideReveal=function(filtered){this.reveal(filtered.needReveal),this.hide(filtered.needHide)},proto._getIsInstant=function(){var isLayoutInstant=this._getOption("layoutInstant"),isInstant=void 0!==isLayoutInstant?isLayoutInstant:!this._isLayoutInited;return this._isInstant=isInstant},proto._bindArrangeComplete=function(){var isLayoutComplete,isHideComplete,isRevealComplete,_this=this;function arrangeParallelCallback(){isLayoutComplete&&isHideComplete&&isRevealComplete&&_this.dispatchEvent("arrangeComplete",null,[_this.filteredItems])}this.once("layoutComplete",function(){isLayoutComplete=!0,arrangeParallelCallback()}),this.once("hideComplete",function(){isHideComplete=!0,arrangeParallelCallback()}),this.once("revealComplete",function(){isRevealComplete=!0,arrangeParallelCallback()})},proto._filter=function(items){var filter=this.options.filter;filter=filter||"*";for(var matches=[],hiddenMatched=[],visibleUnmatched=[],test=this._getFilterTest(filter),i=0;i<items.length;i++){var item=items[i];if(!item.isIgnored){var isMatched=test(item);isMatched&&matches.push(item),isMatched&&item.isHidden?hiddenMatched.push(item):isMatched||item.isHidden||visibleUnmatched.push(item)}}return{matches:matches,needReveal:hiddenMatched,needHide:visibleUnmatched}},proto._getFilterTest=function(filter){return jQuery&&this.options.isJQueryFiltering?function(item){return jQuery(item.element).is(filter)}:"function"==typeof filter?function(item){return filter(item.element)}:function(item){return matchesSelector(item.element,filter)}},proto.updateSortData=function(elems){var items;items=elems?(elems=utils.makeArray(elems),this.getItems(elems)):this.items,this._getSorters(),this._updateItemsSortData(items)},proto._getSorters=function(){var getSortData=this.options.getSortData;for(var key in getSortData){var sorter=getSortData[key];this._sorters[key]=mungeSorter(sorter)}},proto._updateItemsSortData=function(items){for(var len=items&&items.length,i=0;len&&i<len;i++){items[i].updateSortData()}};var mungeSorter=function(sorter){if("string"!=typeof sorter)return sorter;var args=trim(sorter).split(" "),query=args[0],attrMatch=query.match(/^\[(.+)\]$/),getValue=function(attr,query){return attr?function(elem){return elem.getAttribute(attr)}:function(elem){var child=elem.querySelector(query);return child&&child.textContent}}(attrMatch&&attrMatch[1],query),parser=Isotope.sortDataParsers[args[1]];return sorter=parser?function(elem){return elem&&parser(getValue(elem))}:function(elem){return elem&&getValue(elem)}};Isotope.sortDataParsers={parseInt:function(val){return parseInt(val,10)},parseFloat:function(val){return parseFloat(val)}},proto._sort=function(){if(this.options.sortBy){var sortBys=utils.makeArray(this.options.sortBy);this._getIsSameSortBy(sortBys)||(this.sortHistory=sortBys.concat(this.sortHistory));var itemSorter=function(sortBys,sortAsc){return function(itemA,itemB){for(var i=0;i<sortBys.length;i++){var sortBy=sortBys[i],a=itemA.sortData[sortBy],b=itemB.sortData[sortBy];if(b<a||a<b)return(b<a?1:-1)*((void 0!==sortAsc[sortBy]?sortAsc[sortBy]:sortAsc)?1:-1)}return 0}}(this.sortHistory,this.options.sortAscending);this.filteredItems.sort(itemSorter)}},proto._getIsSameSortBy=function(sortBys){for(var i=0;i<sortBys.length;i++)if(sortBys[i]!=this.sortHistory[i])return!1;return!0},proto._mode=function(){var layoutMode=this.options.layoutMode,mode=this.modes[layoutMode];if(!mode)throw new Error("No layout mode: "+layoutMode);return mode.options=this.options[layoutMode],mode},proto._resetLayout=function(){Outlayer.prototype._resetLayout.call(this),this._mode()._resetLayout()},proto._getItemLayoutPosition=function(item){return this._mode()._getItemLayoutPosition(item)},proto._manageStamp=function(stamp){this._mode()._manageStamp(stamp)},proto._getContainerSize=function(){return this._mode()._getContainerSize()},proto.needsResizeLayout=function(){return this._mode().needsResizeLayout()},proto.appended=function(elems){var items=this.addItems(elems);if(items.length){var filteredItems=this._filterRevealAdded(items);this.filteredItems=this.filteredItems.concat(filteredItems)}},proto.prepended=function(elems){var items=this._itemize(elems);if(items.length){this._resetLayout(),this._manageStamps();var filteredItems=this._filterRevealAdded(items);this.layoutItems(this.filteredItems),this.filteredItems=filteredItems.concat(this.filteredItems),this.items=items.concat(this.items)}},proto._filterRevealAdded=function(items){var filtered=this._filter(items);return this.hide(filtered.needHide),this.reveal(filtered.matches),this.layoutItems(filtered.matches,!0),filtered.matches},proto.insert=function(elems){var items=this.addItems(elems);if(items.length){var i,item,len=items.length;for(i=0;i<len;i++)item=items[i],this.element.appendChild(item.element);var filteredInsertItems=this._filter(items).matches;for(i=0;i<len;i++)items[i].isLayoutInstant=!0;for(this.arrange(),i=0;i<len;i++)delete items[i].isLayoutInstant;this.reveal(filteredInsertItems)}};var _remove=proto.remove;return proto.remove=function(elems){elems=utils.makeArray(elems);var removeItems=this.getItems(elems);_remove.call(this,elems);for(var len=removeItems&&removeItems.length,i=0;len&&i<len;i++){var item=removeItems[i];utils.removeFrom(this.filteredItems,item)}},proto.shuffle=function(){for(var i=0;i<this.items.length;i++){this.items[i].sortData.random=Math.random()}this.options.sortBy="random",this._sort(),this._layout()},proto._noTransition=function(fn,args){var transitionDuration=this.options.transitionDuration;this.options.transitionDuration=0;var returnValue=fn.apply(this,args);return this.options.transitionDuration=transitionDuration,returnValue},proto.getFilteredItemElements=function(){return this.filteredItems.map(function(item){return item.element})},Isotope}),function(t,e){function n(e){t.extend(!0,ye,e)}function r(n,r,l){function f(){r.theme?"ui":"fc",n.addClass("fc"),r.isRTL?n.addClass("fc-rtl"):n.addClass("fc-ltr"),r.theme&&n.addClass("ui-widget"),G=t("<div class='fc-content' style='position:relative'/>").prependTo(n),$=new a(Z,r),(Q=$.render())&&n.prepend(Q),y(r.defaultView),t(window).resize(x),m()||v()}function v(){setTimeout(function(){!te.start&&m()&&b()},0)}function g(){return 0!==se.offsetWidth}function m(){return 0!==t("body")[0].offsetWidth}function y(e){if(!te||e!=te.name){ue++,W();var n,r=te;r?((r.beforeHide||I)(),q(G,G.height()),r.element.hide()):q(G,1),G.css("overflow","hidden"),(te=ce[e])?te.element.show():te=ce[e]=new De[e](n=re=t("<div class='fc-view fc-view-"+e+"' style='position:absolute'/>").appendTo(G),Z),r&&$.deactivateButton(r.name),$.activateButton(e),b(),G.css("overflow",""),r&&q(G,1),n||(te.afterShow||I)(),ue--}}function b(t){if(g()){ue++,W(),ne===e&&S();var r=!1;!te.start||t||te.start>fe||fe>=te.end?(te.render(fe,t||0),E(!0),r=!0):te.sizeDirty?(te.clearEvents(),E(),r=!0):te.eventsDirty&&(te.clearEvents(),r=!0),te.sizeDirty=!1,te.eventsDirty=!1,T(r),ee=n.outerWidth(),$.updateTitle(te.title);var a=new Date;a>=te.start&&te.end>a?$.disableButton("today"):$.enableButton("today"),ue--,te.trigger("viewDisplay",se)}}function M(){C(),g()&&(S(),E(),W(),te.clearEvents(),te.renderEvents(de),te.sizeDirty=!1)}function C(){t.each(ce,function(t,e){e.sizeDirty=!0})}function S(){ne=r.contentHeight?r.contentHeight:r.height?r.height-(Q?Q.height():0)-L(G):Math.round(G.width()/Math.max(r.aspectRatio,.5))}function E(t){ue++,te.setHeight(ne,t),re&&(re.css("position","relative"),re=null),te.setWidth(G.width(),t),ue--}function x(){if(!ue)if(te.start){var t=++le;setTimeout(function(){t==le&&!ue&&g()&&ee!=(ee=n.outerWidth())&&(ue++,M(),te.trigger("windowResize",se),ue--)},200)}else v()}function T(t){!r.lazyFetching||oe(te.visStart,te.visEnd)?k():t&&F()}function k(){ie(te.visStart,te.visEnd)}function F(t){R(),g()&&(te.clearEvents(),te.renderEvents(de,t),te.eventsDirty=!1)}function R(){t.each(ce,function(t,e){e.eventsDirty=!0})}function W(){te&&te.unselect()}var Z=this;Z.options=r,Z.render=function(t){G?(S(),C(),R(),b(t)):f()},Z.destroy=function(){t(window).unbind("resize",x),$.destroy(),G.remove(),n.removeClass("fc fc-rtl ui-widget")},Z.refetchEvents=k,Z.reportEvents=function(t){de=t,F()},Z.reportEventChange=function(t){F(t)},Z.rerenderEvents=F,Z.changeView=y,Z.select=function(t,n,r){te.select(t,n,r===e||r)},Z.unselect=W,Z.prev=function(){b(-1)},Z.next=function(){b(1)},Z.prevYear=function(){i(fe,-1),b()},Z.nextYear=function(){i(fe,1),b()},Z.today=function(){fe=new Date,b()},Z.gotoDate=function(t,e,n){t instanceof Date?fe=d(t):p(fe,t,e,n),b()},Z.incrementDate=function(t,n,r){t!==e&&i(fe,t),n!==e&&s(fe,n),r!==e&&c(fe,r),b()},Z.formatDate=function(t,e){return w(t,e,r)},Z.formatDates=function(t,e,n){return D(t,e,n,r)},Z.getDate=function(){return d(fe)},Z.getView=function(){return te},Z.option=function(t,n){return n===e?r[t]:("height"!=t&&"contentHeight"!=t&&"aspectRatio"!=t||(r[t]=n,M()),e)},Z.trigger=function(t,n){return r[t]?r[t].apply(n||se,Array.prototype.slice.call(arguments,2)):e},o.call(Z,r,l);var $,Q,G,te,ee,ne,re,ae,oe=Z.isFetchNeeded,ie=Z.fetchEvents,se=n[0],ce={},le=0,ue=0,fe=new Date,de=[];p(fe,r.year,r.month,r.date),r.droppable&&t(document).bind("dragstart",function(e,n){var a=e.target,o=t(a);if(!o.parents(".fc").length){var i=r.dropAccept;(t.isFunction(i)?i.call(a,o):o.is(i))&&(ae=a,te.dragStart(ae,e,n))}}).bind("dragstop",function(t,e){ae&&(te.dragStop(ae,t,e),ae=null)})}function a(n,r){function i(e){var a=t("<td class='fc-header-"+e+"'/>"),o=r.header[e];return o&&t.each(o.split(" "),function(e){var o;0<e&&a.append("<span class='fc-header-space'/>"),t.each(this.split(","),function(e,i){var s;if("title"==i)a.append("<span class='fc-header-title'><h2>&nbsp;</h2></span>"),o&&o.addClass(v+"-corner-right"),o=null;else if(n[i]?s=n[i]:De[i]&&(s=function(){u.removeClass(v+"-state-hover"),n.changeView(i)}),s){var c=r.theme?J(r.buttonIcons,i):null,l=J(r.buttonText,i),u=t("<span class='fc-button fc-button-"+i+" "+v+"-state-default'>"+(c?"<span class='fc-icon-wrap'><span class='ui-icon ui-icon-"+c+"'/></span>":l)+"</span>").click(function(){u.hasClass(v+"-state-disabled")||s()}).mousedown(function(){u.not("."+v+"-state-active").not("."+v+"-state-disabled").addClass(v+"-state-down")}).mouseup(function(){u.removeClass(v+"-state-down")}).hover(function(){u.not("."+v+"-state-active").not("."+v+"-state-disabled").addClass(v+"-state-hover")},function(){u.removeClass(v+"-state-hover").removeClass(v+"-state-down")}).appendTo(a);U(u),o||u.addClass(v+"-corner-left"),o=u}}),o&&o.addClass(v+"-corner-right")}),a}var d=this;d.render=function(){return v=r.theme?"ui":"fc",r.header?h=t("<table class='fc-header' style='width:100%'/>").append(t("<tr/>").append(i("left")).append(i("center")).append(i("right"))):e},d.destroy=function(){h.remove()},d.updateTitle=function(t){h.find("h2").html(t)},d.activateButton=function(t){h.find("span.fc-button-"+t).addClass(v+"-state-active")},d.deactivateButton=function(t){h.find("span.fc-button-"+t).removeClass(v+"-state-active")},d.disableButton=function(t){h.find("span.fc-button-"+t).addClass(v+"-state-disabled")},d.enableButton=function(t){h.find("span.fc-button-"+t).removeClass(v+"-state-disabled")};var v,h=t([])}function o(n,r){function i(e,r){s(e,function(a){if(r==F){if(a){n.eventDataTransform&&(a=t.map(a,n.eventDataTransform)),e.eventDataTransform&&(a=t.map(a,e.eventDataTransform));for(var o=0;a.length>o;o++)a[o].source=e,b(a[o]);W=W.concat(a)}--R||k(W)}})}function s(r,a){var o,i,c=we.sourceFetchers;for(o=0;c.length>o;o++){if(!0===(i=c[o](r,S,E,a)))return;if("object"==typeof i)return s(i,a),e}var l=r.events;if(l)t.isFunction(l)?(p(),l(d(S),d(E),function(t){a(t),y()})):t.isArray(l)?a(l):a();else if(r.url){var f=r.success,v=r.error,h=r.complete,g=t.extend({},r.data||{}),m=K(r.startParam,n.startParam),b=K(r.endParam,n.endParam);m&&(g[m]=Math.round(S/1e3)),b&&(g[b]=Math.round(E/1e3)),p(),t.ajax(t.extend({},Me,r,{data:g,success:function(e){e=e||[];var n=G(f,this,arguments);t.isArray(n)&&(e=n),a(e)},error:function(){G(v,this,arguments),a()},complete:function(){G(h,this,arguments),y()}}))}else a()}function l(n){return t.isFunction(n)||t.isArray(n)?n={events:n}:"string"==typeof n&&(n={url:n}),"object"==typeof n?(function(t){t.className?"string"==typeof t.className&&(t.className=t.className.split(/\s+/)):t.className=[];for(var e=we.sourceNormalizers,n=0;e.length>n;n++)e[n](t)}(n),z.push(n),n):e}function p(){N++||x("loading",null,!0)}function y(){--N||x("loading",null,!1)}function b(t){var r=t.source||{},a=K(r.ignoreTimezone,n.ignoreTimezone);t._id=t._id||(t.id===e?"_fc"+Ce++:t.id+""),t.date&&(t.start||(t.start=t.date),delete t.date),t._start=d(t.start=m(t.start,a)),t.end=m(t.end,a),t.end&&t.end<=t.start&&(t.end=null),t._end=t.end?d(t.end):null,t.allDay===e&&(t.allDay=K(r.allDayDefault,n.allDayDefault)),t.className?"string"==typeof t.className&&(t.className=t.className.split(/\s+/)):t.className=[]}function D(t,e){return t&&e&&M(t)==M(e)}function M(t){return("object"==typeof t?t.events||t.url:"")||t}var C=this;C.isFetchNeeded=function(t,e){return!S||t<S||E<e},C.fetchEvents=function(t,e){S=t,E=e,W=[];var n=++F,r=z.length;R=r;for(var a=0;a<r;a++)i(z[a],n)},C.addEventSource=function(t){(t=l(t))&&(R++,i(t,F))},C.removeEventSource=function(e){z=t.grep(z,function(t){return!D(t,e)}),W=t.grep(W,function(t){return!D(t.source,e)}),k(W)},C.updateEvent=function(t){var e,n,r=W.length,a=T().defaultEventEnd,o=t.start-t._start,i=t.end?t.end-(t._end||a(t)):0;for(e=0;e<r;e++)(n=W[e])._id==t._id&&n!=t&&(n.start=new Date(+n.start+o),n.end=t.end?n.end?new Date(+n.end+i):new Date(+a(n)+i):null,n.title=t.title,n.url=t.url,n.allDay=t.allDay,n.className=t.className,n.editable=t.editable,n.color=t.color,n.backgroudColor=t.backgroudColor,n.borderColor=t.borderColor,n.textColor=t.textColor,b(n));b(t),k(W)},C.renderEvent=function(t,e){b(t),t.source||(e&&(H.events.push(t),t.source=H),W.push(t)),k(W)},C.removeEvents=function(e){if(e){if(!t.isFunction(e)){var n=e+"";e=function(t){return t._id==n}}W=t.grep(W,e,!0);for(var r=0;z.length>r;r++)t.isArray(z[r].events)&&(z[r].events=t.grep(z[r].events,e,!0))}else{W=[];for(r=0;z.length>r;r++)t.isArray(z[r].events)&&(z[r].events=[])}k(W)},C.clientEvents=function(e){return t.isFunction(e)?t.grep(W,e):e?(e+="",t.grep(W,function(t){return t._id==e})):W},C.normalizeEvent=b;for(var S,E,x=C.trigger,T=C.getView,k=C.reportEvents,H={events:[]},z=[H],F=0,R=0,N=0,W=[],A=0;r.length>A;A++)l(r[A])}function i(t,e,n){return t.setFullYear(t.getFullYear()+e),n||f(t),t}function s(t,e,n){if(+t){var r=t.getMonth()+e,a=d(t);for(a.setDate(1),a.setMonth(r),t.setMonth(r),n||f(t);t.getMonth()!=a.getMonth();)t.setDate(t.getDate()+(t<a?1:-1))}return t}function c(t,e,n){if(+t){var r=t.getDate()+e,a=d(t);a.setHours(9),a.setDate(r),t.setDate(r),n||f(t),l(t,a)}return t}function l(t,e){if(+t)for(;t.getDate()!=e.getDate();)t.setTime(+t+(t<e?1:-1)*xe)}function u(t,e){return t.setMinutes(t.getMinutes()+e),t}function f(t){return t.setHours(0),t.setMinutes(0),t.setSeconds(0),t.setMilliseconds(0),t}function d(t,e){return e?f(new Date(+t)):new Date(+t)}function v(){for(var t,e=0;(t=new Date(1970,e++,1)).getHours(););return t}function h(t,e,n){for(e=e||1;!t.getDay()||n&&1==t.getDay()||!n&&6==t.getDay();)c(t,e);return t}function g(t,e){return Math.round((d(t,!0)-d(e,!0))/Ee)}function p(t,n,r,a){n!==e&&n!=t.getFullYear()&&(t.setDate(1),t.setMonth(0),t.setFullYear(n)),r!==e&&r!=t.getMonth()&&(t.setDate(1),t.setMonth(r)),a!==e&&t.setDate(a)}function m(t,n){return"object"==typeof t?t:"number"==typeof t?new Date(1e3*t):"string"==typeof t?t.match(/^\d+(\.\d+)?$/)?new Date(1e3*parseFloat(t)):(n===e&&(n=!0),y(t,n)||(t?new Date(t):null)):null}function y(t,e){var n=t.match(/^([0-9]{4})(-([0-9]{2})(-([0-9]{2})([T ]([0-9]{2}):([0-9]{2})(:([0-9]{2})(\.([0-9]+))?)?(Z|(([-+])([0-9]{2})(:?([0-9]{2}))?))?)?)?)?$/);if(!n)return null;var r=new Date(n[1],0,1);if(e||!n[13]){var a=new Date(n[1],0,1,9,0);n[3]&&(r.setMonth(n[3]-1),a.setMonth(n[3]-1)),n[5]&&(r.setDate(n[5]),a.setDate(n[5])),l(r,a),n[7]&&r.setHours(n[7]),n[8]&&r.setMinutes(n[8]),n[10]&&r.setSeconds(n[10]),n[12]&&r.setMilliseconds(1e3*Number("0."+n[12])),l(r,a)}else if(r.setUTCFullYear(n[1],n[3]?n[3]-1:0,n[5]||1),r.setUTCHours(n[7]||0,n[8]||0,n[10]||0,n[12]?1e3*Number("0."+n[12]):0),n[14]){var o=60*Number(n[16])+(n[18]?Number(n[18]):0);o*="-"==n[15]?1:-1,r=new Date(+r+6e4*o)}return r}function b(t){if("number"==typeof t)return 60*t;if("object"==typeof t)return 60*t.getHours()+t.getMinutes();var e=t.match(/(\d+)(?::(\d+))?\s*(\w+)?/);if(e){var n=parseInt(e[1],10);return e[3]&&(n%=12,"p"==e[3].toLowerCase().charAt(0)&&(n+=12)),60*n+(e[2]?parseInt(e[2],10):0)}}function w(t,e,n){return D(t,null,e,n)}function D(t,e,n,r){r=r||ye;var a,o,i,s,c=t,l=e,u=n.length,f="";for(a=0;a<u;a++)if("'"==(o=n.charAt(a))){for(i=a+1;i<u;i++)if("'"==n.charAt(i)){c&&(f+=i==a+1?"'":n.substring(a+1,i),a=i);break}}else if("("==o){for(i=a+1;i<u;i++)if(")"==n.charAt(i)){var d=w(c,n.substring(a+1,i),r);parseInt(d.replace(/\D/,""),10)&&(f+=d),a=i;break}}else if("["==o){for(i=a+1;i<u;i++)if("]"==n.charAt(i)){var v=n.substring(a+1,i);(d=w(c,v,r))!=w(l,v,r)&&(f+=d),a=i;break}}else if("{"==o)c=e,l=t;else if("}"==o)c=t,l=e;else{for(i=u;a<i;i--)if(s=ke[n.substring(a,i)]){c&&(f+=s(c,r)),a=i-1;break}i==a&&c&&(f+=o)}return f}function C(t){return t.end?function(t,e){return t=d(t),e||t.getHours()||t.getMinutes()?c(t,1):f(t)}(t.end,t.allDay):c(d(t.start),1)}function E(t,e){return 100*(e.msLength-t.msLength)+(t.event.start-e.event.start)}function x(t,e){return t.end>e.start&&t.start<e.end}function T(t,e,n,r){var a,o,i,s,c,l,u,f,v=[],h=t.length;for(a=0;a<h;a++)i=(o=t[a]).start,n<(s=e[a])&&i<r&&(u=i<n?(c=d(n),!1):(c=i,!0),f=r<s?(l=d(r),!1):(l=s,!0),v.push({event:o,start:c,end:l,isStart:u,isEnd:f,msLength:l-c}));return v.sort(E)}function k(t){var e,n,r,a,o,i=[],s=t.length;for(e=0;e<s;e++){for(n=t[e],r=0;;){if(a=!1,i[r])for(o=0;i[r].length>o;o++)if(x(i[r][o],n)){a=!0;break}if(!a)break;r++}i[r]?i[r].push(n):i[r]=[n]}return i}function H(n,r,a){n.unbind("mouseover").mouseover(function(n){for(var o,i,s,c=n.target;c!=this;)c=(o=c).parentNode;(i=o._fci)!==e&&(o._fci=e,s=r[i],a(s.event,s.element,s),t(n.target).trigger(n)),n.stopPropagation()})}function z(e,n,r){for(var a,o=0;e.length>o;o++)(a=t(e[o])).width(Math.max(0,n-R(a,r)))}function F(e,n,r){for(var a,o=0;e.length>o;o++)(a=t(e[o])).height(Math.max(0,n-L(a,r)))}function R(t,e){return N(t)+A(t)+(e?W(t):0)}function N(e){return(parseFloat(t.css(e[0],"paddingLeft",!0))||0)+(parseFloat(t.css(e[0],"paddingRight",!0))||0)}function W(e){return(parseFloat(t.css(e[0],"marginLeft",!0))||0)+(parseFloat(t.css(e[0],"marginRight",!0))||0)}function A(e){return(parseFloat(t.css(e[0],"borderLeftWidth",!0))||0)+(parseFloat(t.css(e[0],"borderRightWidth",!0))||0)}function L(t,e){return _(t)+B(t)+(e?O(t):0)}function _(e){return(parseFloat(t.css(e[0],"paddingTop",!0))||0)+(parseFloat(t.css(e[0],"paddingBottom",!0))||0)}function O(e){return(parseFloat(t.css(e[0],"marginTop",!0))||0)+(parseFloat(t.css(e[0],"marginBottom",!0))||0)}function B(e){return(parseFloat(t.css(e[0],"borderTopWidth",!0))||0)+(parseFloat(t.css(e[0],"borderBottomWidth",!0))||0)}function q(t,e){e="number"==typeof e?e+"px":e,t.each(function(t,n){n.style.cssText+=";min-height:"+e+";_height:"+e})}function I(){}function Y(t,e){return t-e}function j(t){return Math.max.apply(Math,t)}function P(t){return(t<10?"0":"")+t}function J(t,n){if(t[n]!==e)return t[n];for(var r,a=n.split(/(?=[A-Z])/),o=a.length-1;0<=o;o--)if((r=t[a[o].toLowerCase()])!==e)return r;return t[""]}function V(t){return t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/'/g,"&#039;").replace(/"/g,"&quot;").replace(/\n/g,"<br />")}function X(t){return t.id+"/"+t.className+"/"+t.style.cssText.replace(/(^|;)\s*(top|left|width|height)\s*:[^;]*/gi,"")}function U(t){t.attr("unselectable","on").css("MozUserSelect","none").bind("selectstart.ui",function(){return!1})}function Z(t){t.children().removeClass("fc-first fc-last").filter(":first-child").addClass("fc-first").end().filter(":last-child").addClass("fc-last")}function $(t,e){t.each(function(t,n){n.className=n.className.replace(/^fc-\w*/,"fc-"+Se[e.getDay()])})}function Q(t,e){var n=t.source||{},r=t.color,a=n.color,o=e("eventColor"),i=t.backgroundColor||r||n.backgroundColor||a||e("eventBackgroundColor")||o,s=t.borderColor||r||n.borderColor||a||e("eventBorderColor")||o,c=t.textColor||n.textColor||e("eventTextColor"),l=[];return i&&l.push("background-color:"+i),s&&l.push("border-color:"+s),c&&l.push("color:"+c),l.join(";")}function G(e,n,r){if(t.isFunction(e)&&(e=[e]),e){var a,o;for(a=0;e.length>a;a++)o=e[a].apply(n,r)||o;return o}}function K(){for(var t=0;t<arguments.length;t++)if(arguments[t]!==e)return arguments[t]}function re(e,n,r){function i(){Q=t("<div style='position:absolute;z-index:8;top:0;left:0'/>").appendTo(e)}function s(n){var r,a,o,i,s="",c=be+"-widget-header",l=be+"-widget-content",u=B.start.getMonth(),d=f(new Date);for(s+="<table class='fc-border-separate' style='width:100%' cellspacing='0'><thead><tr>",De&&(s+="<th class='fc-week-number "+c+"'/>"),r=0;r<re;r++)s+="<th class='fc-day-header fc-"+Se[r]+" "+c+"'/>";for(s+="</tr></thead><tbody>",r=0;r<ne;r++){for(s+="<tr class='fc-week'>",De&&(s+="<td class='fc-week-number "+l+"'><div/></td>"),a=0;a<re;a++)o=F(r,a),i=["fc-day","fc-"+Se[o.getDay()],l],o.getMonth()!=u&&i.push("fc-other-month"),+o==+d&&(i.push("fc-today"),i.push(be+"-state-highlight")),s+="<td class='"+i.join(" ")+"' data-date='"+Fe(o,"yyyy-MM-dd")+"'><div>",n&&(s+="<div class='fc-day-number'>"+o.getDate()+"</div>"),s+="<div class='fc-day-content'><div style='position:relative'>&nbsp;</div></div></div></td>";s+="</tr>"}s+="</tbody></table>",q(e,e.height()),I&&I.remove(),I=t(s).appendTo(e),Y=I.find("thead"),j=Y.find(".fc-day-header"),P=I.find("tbody"),J=P.find("tr"),V=P.find(".fc-day"),X=J.find("td:first-child"),$=J.eq(0).find(".fc-day-content > div"),Z(Y.add(Y.find("tr"))),Z(J),J.eq(0).addClass("fc-first"),J.filter(":last").addClass("fc-last"),De&&Y.find(".fc-week-number").text(Me),j.each(function(e,n){var r=R(e);t(n).text(Fe(r,we))}),De&&P.find(".fc-week-number > div").each(function(e,n){var r=F(e,0);t(n).text(Fe(r,Ce))}),V.each(function(e,n){var r=R(e);xe("dayRender",B,r,t(n))}),v(V)}function v(t){t.click(h).mousedown(ze)}function h(e){if(!Ee("selectable")){var n=y(t(this).data("date"));xe("dayClick",this,n,!0,e)}}function p(t,e,n){n&&oe.build();for(var r=d(B.visStart),a=c(d(r),re),o=0;o<ne;o++){var l,u,i=new Date(Math.max(r,t)),s=new Date(Math.min(a,e));if(i<s)u=ce?(l=g(s,r)*le+fe+1,g(i,r)*le+fe+1):(l=g(i,r),g(s,r)),v(m(o,l,o,u-1));c(r,7),c(a,7)}}function m(t,n,r,a){var o=oe.rect(t,n,r,a,e);return ke(o,e)}function k(t){return{row:Math.floor(g(t,B.visStart)/7),col:N(t.getDay())}}function H(t){return F(t.row,t.col)}function F(t,e){return c(d(B.visStart),7*t+e*le+fe)}function R(t){return F(Math.floor(t/re),t%re)}function N(t){return(t-Math.max(pe,ye)+re)%re*le+fe}function O(){q(e,1)}var B=this;B.renderBasic=function(t,e,n){ne=t,re=e,fe=(ce=Ee("isRTL"))?(le=-1,re-1):(le=1,0),pe=Ee("firstDay"),ye=Ee("weekends")?0:1,be=Ee("theme")?"ui":"fc",we=Ee("columnFormat"),De=Ee("weekNumbers"),Me=Ee("weekNumberTitle"),Ce="iso"!=Ee("weekNumberCalculation")?"w":"W",!P?i():Te(),s(n)},B.setHeight=function(e){var n,r,a,o=e-Y.height();"variable"==Ee("weekMode")?n=r=Math.floor(o/(1==ne?2:6)):(n=Math.floor(o/ne),r=o-n*(ne-1)),X.each(function(e,o){e<ne&&q((a=t(o)).find("> div"),(e==ne-1?r:n)-L(a))}),O()},B.setWidth=function(t){G=t,se.clear(),ee=0,De&&(ee=Y.find("th.fc-week-number").outerWidth()),te=Math.floor((G-ee)/re),z(j.slice(0,-1),te)},B.renderDayOverlay=p,B.defaultSelectionEnd=function(t){return d(t)},B.renderSelection=function(t,e){p(t,c(d(e),1),!0)},B.clearSelection=function(){He()},B.reportDayClick=function(t,e,n){var r=k(t),a=V[r.row*re+r.col];xe("dayClick",a,t,e,n)},B.dragStart=function(t,e){ie.start(function(t){He(),t&&m(t.row,t.col,t.row,t.col)},e)},B.dragStop=function(t,e,n){var r=ie.stop();if(He(),r){var a=H(r);xe("drop",t,a,!0,e,n)}},B.defaultEventEnd=function(t){return d(t.start)},B.getHoverListener=function(){return ie},B.colContentLeft=function(t){return se.left(t)},B.colContentRight=function(t){return se.right(t)},B.dayOfWeekCol=N,B.dateCell=k,B.cellDate=H,B.cellIsAllDay=function(){return!0},B.allDayRow=function(t){return J.eq(t)},B.allDayBounds=function(){var t=0;return De&&(t+=ee),{left:t,right:G}},B.getRowCnt=function(){return ne},B.getColCnt=function(){return re},B.getColWidth=function(){return te},B.getDaySegmentContainer=function(){return Q},ue.call(B,e,n,r),ve.call(B),de.call(B),ae.call(B);var I,Y,j,P,J,V,X,$,Q,G,te,ee,ne,re,oe,ie,se,ce,le,fe,pe,ye,be,we,De,Me,Ce,Ee=B.opt,xe=B.trigger,Te=B.clearEvents,ke=B.renderOverlay,He=B.clearOverlays,ze=B.daySelectionMousedown,Fe=n.formatDate;U(e.addClass("fc-grid")),oe=new he(function(e,n){var r,a,o;j.each(function(e,i){r=t(i),a=r.offset().left,e&&(o[1]=a),o=[a],n[e]=o}),o[1]=a+r.outerWidth(),J.each(function(n,i){n<ne&&(r=t(i),a=r.offset().top,n&&(o[1]=a),o=[a],e[n]=o)}),o[1]=a+r.outerHeight()}),ie=new ge(oe),se=new me(function(t){return $.eq(t)})}function ae(){function r(e){var n,r,a,o,s,l,u=S(),f=E(),v=d(i.visStart),h=c(d(v),f),g=t.map(e,C),p=[];for(n=0;n<u;n++){for(r=k(T(e,g,v,h)),a=0;r.length>a;a++)for(o=r[a],s=0;o.length>s;s++)(l=o[s]).row=n,l.level=a,p.push(l);c(v,7),c(h,7)}return p}var i=this;i.renderEvents=function(t,e){v(t),x(r(t),e),l("eventAfterAllRender")},i.compileDaySegs=r,i.clearEvents=function(){h(),b().empty()},i.bindDaySeg=function(t,e,n){u(t)&&function(t,e){var n,r=w();e.draggable({zIndex:9,delay:50,opacity:s("dragOpacity"),revertDuration:s("dragRevertDuration"),start:function(a,o){l("eventDragStart",e,t,a,o),m(t,e),r.start(function(r,a,o,i){e.draggable("option","revert",!r||!o&&!i),M(),r?(n=7*o+i*(s("isRTL")?-1:1),D(c(d(t.start),n),c(C(t),n))):n=0},a,"drag")},stop:function(a,o){r.stop(),M(),l("eventDragStop",e,t,a,o),n?y(this,t,n,0,t.allDay,a,o):(e.css("filter",""),p(t,e))}})}(t,e),n.isEnd&&f(t)&&H(t,e,n),g(t,e)},fe.call(i);var s=i.opt,l=i.trigger,u=i.isEventDraggable,f=i.isEventResizable,v=i.reportEvents,h=i.reportEventClear,g=i.eventElementHandlers,p=i.showEvents,m=i.hideEvents,y=i.eventDrop,b=i.getDaySegmentContainer,w=i.getHoverListener,D=i.renderDayOverlay,M=i.clearOverlays,S=i.getRowCnt,E=i.getColCnt,x=i.renderDaySegs,H=i.resizableDayEvent}function se(n,r,a){function s(){var e,r,a,o,i,s=Ye+"-widget-header",c=Ye+"-widget-content",l=0==tn("slotMinutes")%15;for(e="<table style='width:100%' class='fc-agenda-days fc-border-separate' cellspacing='0'><thead><tr>",e+=Qe?"<th class='fc-agenda-axis fc-week-number "+s+"'/>":"<th class='fc-agenda-axis "+s+"'>&nbsp;</th>",r=0;r<Le;r++)e+="<th class='fc- fc-col"+r+" "+s+"'/>";for(e+="<th class='fc-agenda-gutter "+s+"'>&nbsp;</th></tr></thead><tbody><tr><th class='fc-agenda-axis "+s+"'>&nbsp;</th>",r=0;r<Le;r++)e+="<td class='fc- fc-col"+r+" "+c+"'><div><div class='fc-day-content'><div style='position:relative'>&nbsp;</div></div></div></td>";for(te=t(e+="<td class='fc-agenda-gutter "+c+"'>&nbsp;</td></tr></tbody></table>").appendTo(n),ee=te.find("thead"),ne=ee.find("th").slice(1,-1),re=te.find("tbody"),ae=re.find("td").slice(0,-1),oe=ae.find("div.fc-day-content div"),ie=ae.eq(0),se=ie.find("> div"),Z(ee.add(ee.find("tr"))),Z(re.add(re.find("tr"))),Se=ee.find("th:first"),Ee=te.find(".fc-agenda-gutter"),le=t("<div style='position:absolute;z-index:2;left:0;width:100%'/>").appendTo(n),tn("allDaySlot")?(fe=t("<div style='position:absolute;z-index:8;top:0;left:0'/>").appendTo(le),e="<table style='width:100%' class='fc-agenda-allday' cellspacing='0'><tr><th class='"+s+" fc-agenda-axis'>"+tn("allDayText")+"</th><td><div class='fc-day-content'><div style='position:relative'/></div></td><th class='"+s+" fc-agenda-gutter'>&nbsp;</th></tr></table>",pe=t(e).appendTo(le),D((ye=pe.find("tr")).find("td")),Se=Se.add(pe.find("th:first")),Ee=Ee.add(pe.find("th.fc-agenda-gutter")),le.append("<div class='fc-agenda-divider "+s+"'><div class='fc-agenda-divider-inner'/></div>")):fe=t([]),be=t("<div style='position:absolute;width:100%;overflow-x:hidden;overflow-y:auto'/>").appendTo(le),we=t("<div style='position:relative;width:100%;overflow:hidden'/>").appendTo(be),De=t("<div style='position:absolute;z-index:8;top:0;left:0'/>").appendTo(we),e="<table class='fc-agenda-slots' style='width:100%' cellspacing='0'><tbody>",o=u(d(a=v()),Ze),u(a,Ue),r=_e=0;a<o;r++)e+="<tr class='fc-slot"+r+" "+((i=a.getMinutes())?"fc-minor":"")+"'><th class='fc-agenda-axis "+s+"'>"+(l&&i?"&nbsp;":un(a,tn("axisFormat")))+"</th><td class='"+c+"'><div style='position:relative'>&nbsp;</div></td></tr>",u(a,tn("slotMinutes")),_e++;Me=t(e+="</tbody></table>").appendTo(we),Ce=Me.find("div:first"),M(Me.find("td")),Se=Se.add(Me.find("th:first"))}function D(t){t.click(C).mousedown(cn)}function M(t){t.click(C).mousedown(V)}function C(t){if(!tn("selectable")){var e=Math.min(Le-1,Math.floor((t.pageX-te.offset().left-He)/ze)),n=N(e),r=this.parentNode.className.match(/fc-slot(\d+)/);if(r){var a=parseInt(r[1])*tn("slotMinutes"),o=Math.floor(a/60);n.setHours(o),n.setMinutes(a%60+Ue),en("dayClick",ae[e],n,!1,t)}else en("dayClick",ae[e],n,!0,t)}}function S(t,e,n){n&&Oe.build();var r,a,o=d(K.visStart);a=Je?(r=g(e,o)*Ve+Xe+1,g(t,o)*Ve+Xe+1):(r=g(t,o),g(e,o)),(r=Math.max(0,r))<(a=Math.min(Le,a))&&D(E(0,r,0,a-1))}function E(t,e,n,r){var a=Oe.rect(t,e,n,r,le);return rn(a,le)}function x(t,e){for(var n=d(K.visStart),r=c(d(n),1),a=0;a<Le;a++){var o=new Date(Math.max(n,t)),i=new Date(Math.min(r,e));if(o<i){var s=a*Ve+Xe,l=Oe.rect(0,s,0,s,we),u=_(n,o),f=_(n,i);l.top=u,l.height=f-u,M(rn(l,we))}c(n,1),c(r,1)}}function R(t){var e=N(t.col),n=t.row;return tn("allDaySlot")&&n--,0<=n&&u(e,Ue+n*Ne),e}function N(t){return c(d(K.visStart),t*Ve+Xe)}function W(t){return tn("allDaySlot")&&!t.row}function A(t){return(t-Math.max(je,Pe)+Le)%Le*Ve+Xe}function _(t,n){if(t=d(t,!0),u(d(t),Ue)>n)return 0;if(n>=u(d(t),Ze))return Me.height();var r=tn("slotMinutes"),a=60*n.getHours()+n.getMinutes()-Ue,o=Math.floor(a/r),i=fn[o];return i===e&&(i=fn[o]=Me.find("tr:eq("+o+") td div")[0].offsetTop),Math.max(0,Math.round(i-1+Re*(a%r/r)))}function P(e,n){var r=tn("selectHelper");if(Oe.build(),r){var a=g(e,K.visStart)*Ve+Xe;if(0<=a&&a<Le){var o=Oe.rect(0,a,0,a,we),i=_(e,e),s=_(e,n);if(i<s){if(o.top=i,o.height=s-i,o.left+=2,o.width-=5,t.isFunction(r)){var c=r(e,n);c&&(o.position="absolute",o.zIndex=8,xe=t(c).css(o).appendTo(we))}else o.isStart=!0,o.isEnd=!0,(xe=t(ln({title:"",start:e,end:n,className:["fc-select-helper"],editable:!1},o))).css("opacity",tn("dragOpacity"));xe&&(M(xe),we.append(xe),z(xe,o.width,!0),F(xe,o.height,!0))}}}else x(e,n)}function J(){an(),xe&&(xe.remove(),xe=null)}function V(e){var n;1==e.which&&tn("selectable")&&(sn(e),Be.start(function(t,e){if(J(),t&&t.col==e.col&&!W(t)){var r=R(e),a=R(t);P((n=[r,u(d(r),Ne),a,u(d(a),Ne)].sort(Y))[0],n[3])}else n=null},e),t(document).one("mouseup",function(t){Be.stop(),n&&(+n[0]==+n[1]&&X(n[0],!1,t),on(n[0],n[3],!1,t))}))}function X(t,e,n){en("dayClick",ae[A(t.getDay())],t,e,n)}var K=this;K.renderAgenda=function(t){Le=t,Ye=tn("theme")?"ui":"fc",Pe=tn("weekends")?0:1,je=tn("firstDay"),Xe=(Je=tn("isRTL"))?(Ve=-1,Le-1):(Ve=1,0),Ue=b(tn("minTime")),Ze=b(tn("maxTime")),$e=tn("columnFormat"),Qe=tn("weekNumbers"),Ge=tn("weekNumberTitle"),Ke="iso"!=tn("weekNumberCalculation")?"w":"W",Ne=tn("snapMinutes")||tn("slotMinutes"),te?nn():s(),function(){var t,e,n,r,a=f(new Date);if(Qe){var o=un(N(0),Ke);Je?o+=Ge:o=Ge+o,ee.find(".fc-week-number").text(o)}for(t=0;t<Le;t++)r=N(t),(e=ne.eq(t)).html(un(r,$e)),n=ae.eq(t),+r==+a?n.addClass(Ye+"-state-highlight fc-today"):n.removeClass(Ye+"-state-highlight fc-today"),$(e.add(n),r)}()},K.setWidth=function(e){Te=e,qe.clear(),He=0,z(Se.width("").each(function(e,n){He=Math.max(He,t(n).outerWidth())}),He);var n=be[0].clientWidth;(Fe=be.width()-n)?(z(Ee,Fe),Ee.show().prev().removeClass("fc-last")):Ee.hide().prev().addClass("fc-last"),ze=Math.floor((n-He)/Le),z(ne.slice(0,-1),ze)},K.setHeight=function(t,n){t===e&&(t=ke),ke=t,fn={};var r=re.position().top,a=be.position().top,o=Math.min(t-r,Me.height()+a+1);se.height(o-L(ie)),le.css("top",r),be.height(o-a-1),Re=Ce.height()+1,We=tn("slotMinutes")/Ne,Ae=Re/We,n&&function(){function t(){be.scrollTop(r)}var e=v(),n=d(e);n.setHours(tn("firstHour"));var r=_(e,n)+1;t(),setTimeout(t,0)}()},K.beforeHide=function(){Ie=be.scrollTop()},K.afterShow=function(){be.scrollTop(Ie)},K.defaultEventEnd=function(t){var e=d(t.start);return t.allDay?e:u(e,tn("defaultEventMinutes"))},K.timePosition=_,K.dayOfWeekCol=A,K.dateCell=function(t){return{row:Math.floor(g(t,K.visStart)/7),col:A(t.getDay())}},K.cellDate=R,K.cellIsAllDay=W,K.allDayRow=function(){return ye},K.allDayBounds=function(){return{left:He,right:Te-Fe}},K.getHoverListener=function(){return Be},K.colContentLeft=function(t){return qe.left(t)},K.colContentRight=function(t){return qe.right(t)},K.getDaySegmentContainer=function(){return fe},K.getSlotSegmentContainer=function(){return De},K.getMinMinute=function(){return Ue},K.getMaxMinute=function(){return Ze},K.getBodyContent=function(){return we},K.getRowCnt=function(){return 1},K.getColCnt=function(){return Le},K.getColWidth=function(){return ze},K.getSnapHeight=function(){return Ae},K.getSnapMinutes=function(){return Ne},K.defaultSelectionEnd=function(t,e){return e?d(t):u(d(t),tn("slotMinutes"))},K.renderDayOverlay=S,K.renderSelection=function(t,e,n){n?tn("allDaySlot")&&S(t,c(d(e),1),!0):P(t,e)},K.clearSelection=J,K.reportDayClick=X,K.dragStart=function(t,e){Be.start(function(t){if(an(),t)if(W(t))E(t.row,t.col,t.row,t.col);else{var e=R(t);x(e,u(d(e),tn("defaultEventMinutes")))}},e)},K.dragStop=function(t,e,n){var r=Be.stop();an(),r&&en("drop",t,R(r),W(r),e,n)},ue.call(K,n,r,a),ve.call(K),de.call(K),ce.call(K);var te,ee,ne,re,ae,oe,ie,se,le,fe,pe,ye,be,we,De,Me,Ce,Se,Ee,xe,Te,ke,He,ze,Fe,Re,Ne,We,Ae,Le,_e,Oe,Be,qe,Ie,Ye,je,Pe,Je,Ve,Xe,Ue,Ze,$e,Qe,Ge,Ke,tn=K.opt,en=K.trigger,nn=K.clearEvents,rn=K.renderOverlay,an=K.clearOverlays,on=K.reportSelection,sn=K.unselect,cn=K.daySelectionMousedown,ln=K.slotSegHtml,un=r.formatDate,fn={};U(n.addClass("fc-agenda")),Oe=new he(function(e,n){function r(t){return Math.max(c,Math.min(l,t))}var a,o,i;ne.each(function(e,r){a=t(r),o=a.offset().left,e&&(i[1]=o),i=[o],n[e]=i}),i[1]=o+a.outerWidth(),tn("allDaySlot")&&(o=(a=ye).offset().top,e[0]=[o,o+a.outerHeight()]);for(var s=we.offset().top,c=be.offset().top,l=c+be.outerHeight(),u=0;u<_e*We;u++)e.push([r(s+Ae*u),r(s+Ae*(u+1))])}),Be=new ge(Oe),qe=new me(function(t){return oe.eq(t)})}function ce(){function a(e){var n,r,a,o,i=k(T(e,t.map(e,C),m.visStart,m.visEnd)),s=i.length,c=[];for(n=0;n<s;n++)for(r=i[n],a=0;r.length>a;a++)(o=r[a]).row=0,o.level=n,c.push(o);return c}function o(e){var n,r,a,o,s,l,f=P(),v=O(),h=_(),g=u(d(m.visStart),v),p=t.map(e,i),y=[];for(n=0;n<f;n++){for(le(r=k(T(e,p,g,u(d(g),h-v)))),a=0;r.length>a;a++)for(o=r[a],s=0;o.length>s;s++)(l=o[s]).col=n,l.level=a,y.push(l);c(g,1,!0)}return y}function i(t){return t.end?d(t.end):u(d(t.start),y("defaultEventMinutes"))}function s(n,r){var a,o,i,s,c,u,f,d,h,g,p,m,w,D,M,C,S,E,x,T,k,z,F=n.length,N="",A={},_={},O=W(),Y=P();for(z=(T=y("isRTL"))?(k=-1,Y-1):(k=1,0),a=0;a<F;a++)i=(o=n[a]).event,s=B(o.start,o.start),c=B(o.start,o.end),u=o.col,f=o.level,d=o.forward||0,h=q(u*k+z),g=I(u*k+z)-h,g=Math.min(g-6,.95*g),p=f?g/(f+d+1):d?2*(g/(d+1)-6):g,m=h+g/(f+d+1)*f*k+(T?g-p:0),o.top=s,o.left=m,o.outerWidth=p,o.outerHeight=c-s,N+=l(i,o);for(O[0].innerHTML=N,w=O.children(),a=0;a<F;a++)i=(o=n[a]).event,D=t(w[a]),!1===(M=b("eventRender",i,i,D))?D.remove():(M&&!0!==M&&(D.remove(),D=t(M).css({position:"absolute",top:o.top,left:o.left}).appendTo(O)),o.element=D,i._id===r?v(i,D,o):D[0]._fci=a,G(i,D));for(H(O,n,v),a=0;a<F;a++)(D=(o=n[a]).element)&&(S=A[C=o.key=X(D[0])],o.vsides=S===e?A[C]=L(D,!0):S,S=_[C],o.hsides=S===e?_[C]=R(D,!0):S,(E=D.find(".fc-event-title")).length&&(o.contentTop=E[0].offsetTop));for(a=0;a<F;a++)(D=(o=n[a]).element)&&(D[0].style.width=Math.max(0,o.outerWidth-o.hsides)+"px",x=Math.max(0,o.outerHeight-o.vsides),D[0].style.height=x+"px",i=o.event,o.contentTop!==e&&x-o.contentTop<10&&(D.find("div.fc-event-time").text(ie(i.start,y("timeFormat"))+" - "+i.title),D.find("div.fc-event-title").remove()),b("eventAfterRender",i,i,D))}function l(t,e){var n="<",r=t.url,a=Q(t,y),o=["fc-event","fc-event-vert"];return w(t)&&o.push("fc-event-draggable"),e.isStart&&o.push("fc-event-start"),e.isEnd&&o.push("fc-event-end"),o=o.concat(t.className),t.source&&(o=o.concat(t.source.className||[])),n+=r?"a href='"+V(t.url)+"'":"div",n+=" class='"+o.join(" ")+"' style='position:absolute;z-index:8;top:"+e.top+"px;left:"+e.left+"px;"+a+"'><div class='fc-event-inner'><div class='fc-event-time'>"+V(se(t.start,t.end,y("timeFormat")))+"</div><div class='fc-event-title'>"+V(t.title)+"</div></div><div class='fc-event-bg'></div>",e.isEnd&&D(t)&&(n+="<div class='ui-resizable-handle ui-resizable-s'>=</div>"),n+"</"+(r?"a":"div")+">"}function v(t,e,n){var r=e.find("div.fc-event-time");w(t)&&function(t,e,n){function r(e){var r,a=u(d(t.start),e);t.end&&(r=u(d(t.end),e)),n.text(se(a,r,y("timeFormat")))}function a(){f&&(n.css("display",""),e.draggable("option","grid",[p,m]),f=!1)}var o,i,s,l,f=!1,v=y("isRTL")?-1:1,h=A(),g=P(),p=J(),m=U(),w=Z();e.draggable({zIndex:9,scroll:!1,grid:[p,m],axis:1==g&&"y",opacity:y("dragOpacity"),revertDuration:y("dragRevertDuration"),start:function(r,u){b("eventDragStart",e,t,r,u),te(t,e),o=e.position(),s=l=0,h.start(function(r,o,s,l){e.draggable("option","revert",!r),ae(),r&&(i=l*v,y("allDaySlot")&&!r.row?(f||(f=!0,n.hide(),e.draggable("option","grid",null)),re(c(d(t.start),i),c(C(t),i))):a())},r,"drag")},drag:function(t,e){(s=Math.round((e.position.top-o.top)/m)*w)!=l&&(f||r(s),l=s)},stop:function(n,c){var l=h.stop();ae(),b("eventDragStop",e,t,n,c),l&&(i||s||f)?ee(this,t,i,f?0:s,f,n,c):(a(),e.css("filter",""),e.css(o),r(0),K(t,e))}})}(t,e,r),n.isEnd&&D(t)&&function(t,e,n){var r,a,o=U(),i=Z();e.resizable({handles:{s:".ui-resizable-handle"},grid:o,start:function(n,o){r=a=0,te(t,e),e.css("z-index",9),b("eventResizeStart",this,t,n,o)},resize:function(s,c){(r=Math.round((Math.max(o,e.height())-c.originalSize.height)/o))!=a&&(n.text(se(t.start,r||t.end?u(M(t),i*r):null,y("timeFormat"))),a=r)},stop:function(n,a){b("eventResizeStop",this,t,n,a),r?ne(this,t,0,i*r,n,a):(e.css("z-index",8),K(t,e))}})}(t,e,r),x(t,e)}var m=this;m.renderEvents=function(t,e){S(t);var n,r=t.length,i=[],c=[];for(n=0;n<r;n++)t[n].allDay?i.push(t[n]):c.push(t[n]);y("allDaySlot")&&(Y(a(i),e),z()),s(o(c),e),b("eventAfterAllRender")},m.compileDaySegs=a,m.clearEvents=function(){E(),N().empty(),W().empty()},m.slotSegHtml=l,m.bindDaySeg=function(t,e,n){w(t)&&function(t,e,n){function r(){s||(e.width(a).height("").draggable("option","grid",null),s=!0)}var a,o,i,s=!0,l=y("isRTL")?-1:1,u=A(),f=J(),v=U(),h=Z(),g=O();e.draggable({zIndex:9,opacity:y("dragOpacity","month"),revertDuration:y("dragRevertDuration"),start:function(g,p){b("eventDragStart",e,t,g,p),te(t,e),a=e.width(),u.start(function(a,u,g,p){ae(),o=a?(o=!1,i=p*l,a.row?n?s&&(e.width(f-10),F(e,v*Math.round((t.end?(t.end-t.start)/Te:y("defaultEventMinutes"))/h)),e.draggable("option","grid",[f,1]),s=!1):o=!0:(re(c(d(t.start),i),c(C(t),i)),r()),o||s&&!i):(r(),!0),e.draggable("option","revert",o)},g,"drag")},stop:function(n,a){if(u.stop(),ae(),b("eventDragStop",e,t,n,a),o)r(),e.css("filter",""),K(t,e);else{var c=0;s||(c=Math.round((e.offset().top-$().offset().top)/v)*h+g-(60*t.start.getHours()+t.start.getMinutes())),ee(this,t,i,c,s,n,a)}}})}(t,e,n.isStart),n.isEnd&&D(t)&&j(t,e,n),x(t,e)},fe.call(m);var y=m.opt,b=m.trigger,w=m.isEventDraggable,D=m.isEventResizable,M=m.eventEnd,S=m.reportEvents,E=m.reportEventClear,x=m.eventElementHandlers,z=m.setHeight,N=m.getDaySegmentContainer,W=m.getSlotSegmentContainer,A=m.getHoverListener,_=m.getMaxMinute,O=m.getMinMinute,B=m.timePosition,q=m.colContentLeft,I=m.colContentRight,Y=m.renderDaySegs,j=m.resizableDayEvent,P=m.getColCnt,J=m.getColWidth,U=m.getSnapHeight,Z=m.getSnapMinutes,$=m.getBodyContent,G=m.reportEventElement,K=m.showEvents,te=m.hideEvents,ee=m.eventDrop,ne=m.eventResize,re=m.renderDayOverlay,ae=m.clearOverlays,oe=m.calendar,ie=oe.formatDate,se=oe.formatDates}function le(t){var e,n,r,a,o,i;for(e=t.length-1;0<e;e--)for(a=t[e],n=0;a.length>n;n++)for(o=a[n],r=0;t[e-1].length>r;r++)x(o,i=t[e-1][r])&&(i.forward=Math.max(i.forward||0,(o.forward||0)+1))}function ue(t,n,r){function a(t,e){var n=F[t];return"object"==typeof n?J(n,e||r):n}function o(t,e){return n.trigger.apply(n,[t,e||S].concat(Array.prototype.slice.call(arguments,2),[S]))}function l(t){return K(t.editable,(t.source||{}).editable,a("editable"))}function v(t){return t.end?d(t.end):E(t)}function b(t,e,n){var r,a=z[t._id],o=a.length;for(r=0;r<o;r++)e&&a[r][0]==e[0]||a[r][n]()}function M(t,n,r,a){r=r||0;for(var o,i=t.length,s=0;s<i;s++)o=t[s],a!==e&&(o.allDay=a),u(c(o.start,n,!0),r),o.end&&(o.end=u(c(o.end,n,!0),r)),x(o,F)}function C(t,e,n){n=n||0;for(var r,a=t.length,o=0;o<a;o++)(r=t[o]).end=u(c(v(r),e,!0),n),x(r,F)}var S=this;S.element=t,S.calendar=n,S.name=r,S.opt=a,S.trigger=o,S.isEventDraggable=function(t){return l(t)&&!a("disableDragging")},S.isEventResizable=function(t){return l(t)&&!a("disableResizing")},S.reportEvents=function(t){k={};var e,n,r=t.length;for(e=0;e<r;e++)n=t[e],k[n._id]?k[n._id].push(n):k[n._id]=[n]},S.eventEnd=v,S.reportEventElement=function(t,e){H.push(e),z[t._id]?z[t._id].push(e):z[t._id]=[e]},S.reportEventClear=function(){H=[],z={}},S.eventElementHandlers=function(t,n){n.click(function(r){return n.hasClass("ui-draggable-dragging")||n.hasClass("ui-resizable-resizing")?e:o("eventClick",this,t,r)}).hover(function(e){o("eventMouseover",this,t,e)},function(e){o("eventMouseout",this,t,e)})},S.showEvents=function(t,e){b(t,e,"show")},S.hideEvents=function(t,e){b(t,e,"hide")},S.eventDrop=function(t,e,n,r,a,i,s){var c=e.allDay,l=e._id;M(k[l],n,r,a),o("eventDrop",t,e,n,r,a,function(){M(k[l],-n,-r,c),T(l)},i,s),T(l)},S.eventResize=function(t,e,n,r,a,i){var s=e._id;C(k[s],n,r),o("eventResize",t,e,n,r,function(){C(k[s],-n,-r),T(s)},a,i),T(s)};var E=S.defaultEventEnd,x=n.normalizeEvent,T=n.reportEventChange,k={},H=[],z={},F=n.options}function fe(){function r(e,n,r){var i,s,c,d=t("<div/>"),p=B(),m=e.length;for(d[0].innerHTML=a(e),i=d.children(),p.append(i),o(e,i),l(e),u(e),f(e),g(e,h(v())),i=[],s=0;s<m;s++)(c=e[s].element)&&(e[s].row===n&&c.css("top",r),i.push(c[0]));return t(i)}function a(t){var e,n,r,a,o,i,s,c,l,u,f=y("isRTL"),d=t.length,v=F(),h=v.left,g=v.right,p="";for(e=0;e<d;e++)r=(n=t[e]).event,o=["fc-event","fc-event-hori"],w(r)&&o.push("fc-event-draggable"),n.isStart&&o.push("fc-event-start"),n.isEnd&&o.push("fc-event-end"),l=f?(i=A(n.end.getDay()-1),s=A(n.start.getDay()),c=n.isEnd?N(i):h,n.isStart?W(s):g):(i=A(n.start.getDay()),s=A(n.end.getDay()-1),c=n.isStart?N(i):h,n.isEnd?W(s):g),o=o.concat(r.className),r.source&&(o=o.concat(r.source.className||[])),a=r.url,u=Q(r,y),p+=a?"<a href='"+V(a)+"'":"<div",p+=" class='"+o.join(" ")+"' style='position:absolute;z-index:8;left:"+c+"px;"+u+"'><div class='fc-event-inner'>",!r.allDay&&n.isStart&&(p+="<span class='fc-event-time'>"+V(I(r.start,r.end,y("timeFormat")))+"</span>"),p+="<span class='fc-event-title'>"+V(r.title)+"</span></div>",n.isEnd&&D(r)&&(p+="<div class='ui-resizable-handle ui-resizable-"+(f?"w":"e")+"'>&nbsp;&nbsp;&nbsp;</div>"),p+="</"+(a?"a":"div")+">",n.left=c,n.outerWidth=l-c,n.startCol=i,n.endCol=s+1;return p}function o(e,n){var r,a,o,i,s,c=e.length;for(r=0;r<c;r++)o=(a=e[r]).event,i=t(n[r]),!1===(s=b("eventRender",o,o,i))?i.remove():(s&&!0!==s&&(s=t(s).css({position:"absolute",left:a.left}),i.replaceWith(s),i=s),a.element=i)}function i(t){var e,n,r,a=t.length;for(e=0;e<a;e++)(r=(n=t[e]).element)&&C(n.event,r)}function l(t){var n,r,a,o,i,s=t.length,c={};for(n=0;n<s;n++)(a=(r=t[n]).element)&&((i=c[o=r.key=X(a[0])])===e&&(i=c[o]=R(a,!0)),r.hsides=i)}function u(t){var e,n,r,a=t.length;for(e=0;e<a;e++)(r=(n=t[e]).element)&&(r[0].style.width=Math.max(0,n.outerWidth-n.hsides)+"px")}function f(t){var n,r,a,o,i,s=t.length,c={};for(n=0;n<s;n++)(a=(r=t[n]).element)&&((i=c[o=r.key])===e&&(i=c[o]=O(a)),r.outerHeight=a[0].offsetHeight+i)}function v(){var t,e=T(),n=[];for(t=0;t<e;t++)n[t]=z(t).find("div.fc-day-content > div");return n}function h(t){var e,n=t.length,r=[];for(e=0;e<n;e++)r[e]=t[e][0].offsetTop;return r}function g(t,e){var n,r,a,o,i=t.length;for(n=0;n<i;n++)(a=(r=t[n]).element)&&(a[0].style.top=e[r.row]+(r.top||0)+"px",o=r.event,b("eventAfterRender",o,o,a))}var m=this;m.renderDaySegs=function(t,e){var n,r,d,p,m,y,b,w=B(),D=T(),M=k(),C=0,S=t.length;for(w[0].innerHTML=a(t),o(t,w.children()),i(t),function(t,e,n){var r,a,o,i,s=t.length;for(r=0;r<s;r++)a=t[r],(o=a.element)&&((i=a.event)._id===n?q(i,o,a):o[0]._fci=r);H(e,t,q)}(t,w,e),l(t),u(t),f(t),n=v(),r=0;r<D;r++){for(d=[],p=0;p<M;p++)d[p]=0;for(;C<S&&(m=t[C]).row==r;){for(y=j(d.slice(m.startCol,m.endCol)),m.top=y,y+=m.outerHeight,b=m.startCol;m.endCol>b;b++)d[b]=y;C++}n[r].height(j(d))}g(t,h(n))},m.resizableDayEvent=function(e,n,a){var o=y("isRTL"),i=o?"w":"e",s=n.find(".ui-resizable-"+i),l=!1;U(n),n.mousedown(function(t){t.preventDefault()}).click(function(t){l&&(t.preventDefault(),t.stopImmediatePropagation())}),s.mousedown(function(s){if(1==s.which){l=!0;var f,v,h=m.getHoverListener(),g=T(),p=k(),y=o?-1:1,w=o?p-1:0,D=n.css("top"),C=t.extend({},e),H=L(e.start);J(),t("body").css("cursor",i+"-resize").one("mouseup",function(n){b("eventResizeStop",this,e,n),t("body").css("cursor",""),h.stop(),P(),f&&x(this,e,f,0,n),setTimeout(function(){l=!1},0)}),b("eventResizeStart",this,e,s),h.start(function(t,n){if(t){var s=Math.max(H.row,t.row),l=t.col;1==g&&(s=0),s==H.row&&(l=o?Math.min(H.col,l):Math.max(H.col,l)),f=7*s+l*y+w-(7*n.row+n.col*y+w);var u=c(M(e),f,!0);if(f){C.end=u;var h=v;(v=r(_([C]),a.row,D)).find("*").css("cursor",i+"-resize"),h&&h.remove(),E(e)}else v&&(S(e),v.remove(),v=null);P(),Y(e.start,c(d(u),1))}},s)}})};var y=m.opt,b=m.trigger,w=m.isEventDraggable,D=m.isEventResizable,M=m.eventEnd,C=m.reportEventElement,S=m.showEvents,E=m.hideEvents,x=m.eventResize,T=m.getRowCnt,k=m.getColCnt;m.getColWidth;var z=m.allDayRow,F=m.allDayBounds,N=m.colContentLeft,W=m.colContentRight,A=m.dayOfWeekCol,L=m.dateCell,_=m.compileDaySegs,B=m.getDaySegmentContainer,q=m.bindDaySeg,I=m.calendar.formatDates,Y=m.renderDayOverlay,P=m.clearOverlays,J=m.clearSelection}function de(){function n(t){f&&(f=!1,u(),s("unselect",null,t))}function r(t,e,n,r){f=!0,s("select",null,t,e,n,r)}var o=this;o.select=function(t,e,a){n(),e=e||c(t,a),l(t,e,a),r(t,e,a)},o.unselect=n,o.reportSelection=r,o.daySelectionMousedown=function(e){var d,a=o.cellDate,s=o.cellIsAllDay,c=o.getHoverListener(),f=o.reportDayClick;1==e.which&&i("selectable")&&(n(e),c.start(function(t,e){u(),t&&s(t)?(d=[a(e),a(t)].sort(Y),l(d[0],d[1],!0)):d=null},e),t(document).one("mouseup",function(t){c.stop(),d&&(+d[0]==+d[1]&&f(d[0],!0,t),r(d[0],d[1],!0,t))}))};var i=o.opt,s=o.trigger,c=o.defaultSelectionEnd,l=o.renderSelection,u=o.clearSelection,f=!1;i("selectable")&&i("unselectAuto")&&t(document).mousedown(function(e){var r=i("unselectCancel");r&&t(e.target).parents(r).length||n(e)})}function ve(){this.renderOverlay=function(e,n){var r=o.shift();return(r=r||t("<div class='fc-cell-overlay' style='position:absolute;z-index:3'/>"))[0].parentNode!=n[0]&&r.appendTo(n),a.push(r.css(e).show()),r},this.clearOverlays=function(){for(var t;t=a.shift();)o.push(t.hide().unbind())};var a=[],o=[]}function he(t){var e,n,r=this;r.build=function(){t(e=[],n=[])},r.cell=function(t,r){var a,o=e.length,i=n.length,s=-1,c=-1;for(a=0;a<o;a++)if(r>=e[a][0]&&e[a][1]>r){s=a;break}for(a=0;a<i;a++)if(t>=n[a][0]&&n[a][1]>t){c=a;break}return 0<=s&&0<=c?{row:s,col:c}:null},r.rect=function(t,r,a,o,i){var s=i.offset();return{top:e[t][0]-s.top,left:n[r][0]-s.left,width:n[o][1]-n[r][0],height:e[a][1]-e[t][0]}}}function ge(e){function n(t){pe(t);var n=e.cell(t.pageX,t.pageY);!n==!i&&(!n||n.row==i.row&&n.col==i.col)||(n?a(n,o=o||n,n.row-o.row,n.col-o.col):a(n,o),i=n)}var r,a,o,i;this.start=function(s,c,l){a=s,o=i=null,e.build(),n(c),r=l||"mousemove",t(document).bind(r,n)},this.stop=function(){return t(document).unbind(r,n),i}}function pe(t){t.pageX===e&&(t.pageX=t.originalEvent.pageX,t.pageY=t.originalEvent.pageY)}function me(t){function n(e){return a[e]=a[e]||t(e)}var r=this,a={},o={},i={};r.left=function(t){return o[t]=o[t]===e?n(t).position().left:o[t]},r.right=function(t){return i[t]=i[t]===e?r.left(t)+n(t).width():i[t]},r.clear=function(){a={},o={},i={}}}var ye={defaultView:"month",aspectRatio:1.35,header:{left:"title",center:"",right:"today prev,next"},weekends:!0,weekNumbers:!1,weekNumberCalculation:"iso",weekNumberTitle:"W",allDayDefault:!0,ignoreTimezone:!0,lazyFetching:!0,startParam:"start",endParam:"end",titleFormat:{month:"MMMM yyyy",week:"MMM d[ yyyy]{ '&#8212;'[ MMM] d yyyy}",day:"dddd, MMM d, yyyy"},columnFormat:{month:"ddd",week:"ddd M/d",day:"dddd M/d"},timeFormat:{"":"h(:mm)t"},isRTL:!1,firstDay:0,monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],buttonText:{prev:"<span class='fc-text-arrow'>&lsaquo;</span>",next:"<span class='fc-text-arrow'>&rsaquo;</span>",prevYear:"<span class='fc-text-arrow'>&laquo;</span>",nextYear:"<span class='fc-text-arrow'>&raquo;</span>",today:"today",month:"month",week:"week",day:"day"},theme:!1,buttonIcons:{prev:"circle-triangle-w",next:"circle-triangle-e"},unselectAuto:!0,dropAccept:"*"},be={header:{left:"next,prev today",center:"",right:"title"},buttonText:{prev:"<span class='fc-text-arrow'>&rsaquo;</span>",next:"<span class='fc-text-arrow'>&lsaquo;</span>",prevYear:"<span class='fc-text-arrow'>&raquo;</span>",nextYear:"<span class='fc-text-arrow'>&laquo;</span>"},buttonIcons:{prev:"circle-triangle-e",next:"circle-triangle-w"}},we=t.fullCalendar={version:"1.6.0"},De=we.views={};t.fn.fullCalendar=function(n){if("string"==typeof n){var a,o=Array.prototype.slice.call(arguments,1);return this.each(function(){var r=t.data(this,"fullCalendar");if(r&&t.isFunction(r[n])){var i=r[n].apply(r,o);a===e&&(a=i),"destroy"==n&&t.removeData(this,"fullCalendar")}}),a!==e?a:this}var i=n.eventSources||[];return delete n.eventSources,n.events&&(i.push(n.events),delete n.events),n=t.extend(!0,{},ye,n.isRTL||n.isRTL===e&&ye.isRTL?be:{},n),this.each(function(e,a){var o=t(a),s=new r(o,n,i);o.data("fullCalendar",s),s.render()}),this},we.sourceNormalizers=[];var Me={dataType:"json",cache:!(we.sourceFetchers=[])},Ce=1;we.addDays=c,we.cloneDate=d,we.parseDate=m,we.parseISO8601=y,we.parseTime=b,we.formatDate=w,we.formatDates=D;var Se=["sun","mon","tue","wed","thu","fri","sat"],Ee=864e5,xe=36e5,Te=6e4,ke={s:function(t){return t.getSeconds()},ss:function(t){return P(t.getSeconds())},m:function(t){return t.getMinutes()},mm:function(t){return P(t.getMinutes())},h:function(t){return t.getHours()%12||12},hh:function(t){return P(t.getHours()%12||12)},H:function(t){return t.getHours()},HH:function(t){return P(t.getHours())},d:function(t){return t.getDate()},dd:function(t){return P(t.getDate())},ddd:function(t,e){return e.dayNamesShort[t.getDay()]},dddd:function(t,e){return e.dayNames[t.getDay()]},M:function(t){return t.getMonth()+1},MM:function(t){return P(t.getMonth()+1)},MMM:function(t,e){return e.monthNamesShort[t.getMonth()]},MMMM:function(t,e){return e.monthNames[t.getMonth()]},yy:function(t){return(t.getFullYear()+"").substring(2)},yyyy:function(t){return t.getFullYear()},t:function(t){return t.getHours()<12?"a":"p"},tt:function(t){return t.getHours()<12?"am":"pm"},T:function(t){return t.getHours()<12?"A":"P"},TT:function(t){return t.getHours()<12?"AM":"PM"},u:function(t){return w(t,"yyyy-MM-dd'T'HH:mm:ss'Z'")},S:function(t){var e=t.getDate();return 10<e&&e<20?"th":["st","nd","rd"][e%10-1]||"th"},w:function(t,e){return e.weekNumberCalculation(t)},W:function(t){return function(t){var e,n=new Date(t.getTime());return n.setDate(n.getDate()+4-(n.getDay()||7)),e=n.getTime(),n.setMonth(0),n.setDate(1),Math.floor(Math.round((e-n)/864e5)/7)+1}(t)}};we.dateFormatters=ke,we.applyAll=G,De.month=function(t,e){var r=this;r.render=function(t,e){e&&(s(t,e),t.setDate(1));var n=d(t,!0);n.setDate(1);var l=s(d(n),1),u=d(n),f=d(l),v=a("firstDay"),g=a("weekends")?0:1;g&&(h(u),h(f,-1,!0)),c(u,-(u.getDay()-Math.max(v,g)+7)%7),c(f,(7-f.getDay()+Math.max(v,g))%7);var p=Math.round((f-u)/(7*Ee));"fixed"==a("weekMode")&&(c(f,7*(6-p)),p=6),r.title=i(n,a("titleFormat")),r.start=n,r.end=l,r.visStart=u,r.visEnd=f,o(p,g?5:7,!0)},re.call(r,t,e,"month");var a=r.opt,o=r.renderBasic,i=e.formatDate},De.basicWeek=function(t,e){var r=this;r.render=function(t,e){e&&c(t,7*e);var n=c(d(t),-(t.getDay()-a("firstDay")+7)%7),s=c(d(n),7),l=d(n),u=d(s),f=a("weekends");f||(h(l),h(u,-1,!0)),r.title=i(l,c(d(u),-1),a("titleFormat")),r.start=n,r.end=s,r.visStart=l,r.visEnd=u,o(1,f?7:5,!1)},re.call(r,t,e,"basicWeek");var a=r.opt,o=r.renderBasic,i=e.formatDates},De.basicDay=function(t,e){var r=this;r.render=function(t,e){e&&(c(t,e),a("weekends")||h(t,e<0?-1:1)),r.title=i(t,a("titleFormat")),r.start=r.visStart=d(t,!0),r.end=r.visEnd=c(d(r.start),1),o(1,1,!1)},re.call(r,t,e,"basicDay");var a=r.opt,o=r.renderBasic,i=e.formatDate},n({weekMode:"fixed"}),De.agendaWeek=function(t,e){var r=this;r.render=function(t,e){e&&c(t,7*e);var n=c(d(t),-(t.getDay()-a("firstDay")+7)%7),s=c(d(n),7),l=d(n),u=d(s),f=a("weekends");f||(h(l),h(u,-1,!0)),r.title=i(l,c(d(u),-1),a("titleFormat")),r.start=n,r.end=s,r.visStart=l,r.visEnd=u,o(f?7:5)},se.call(r,t,e,"agendaWeek");var a=r.opt,o=r.renderAgenda,i=e.formatDates},De.agendaDay=function(t,e){var r=this;r.render=function(t,e){e&&(c(t,e),a("weekends")||h(t,e<0?-1:1));var n=d(t,!0),s=c(d(n),1);r.title=i(t,a("titleFormat")),r.start=r.visStart=n,r.end=r.visEnd=s,o(1)},se.call(r,t,e,"agendaDay");var a=r.opt,o=r.renderAgenda,i=e.formatDate},n({allDaySlot:!0,allDayText:"all-day",firstHour:6,slotMinutes:30,defaultEventMinutes:120,axisFormat:"h(:mm)tt",timeFormat:{agenda:"h:mm{ - h:mm}"},dragOpacity:{agenda:.5},minTime:0,maxTime:24})}(jQuery),jQuery(function($,undefined){$.fn.simpleColorPicker=function(options){var defaults={colorsPerLine:8,colors:["#000000","#444444","#666666","#999999","#cccccc","#eeeeee","#f3f3f3","#ffffff","#ff0000","#ff9900","#ffff00","#00ff00","#00ffff","#0000ff","#9900ff","#ff00ff","#f4cccc","#fce5cd","#fff2cc","#d9ead3","#d0e0e3","#cfe2f3","#d9d2e9","#ead1dc","#ea9999","#f9cb9c","#ffe599","#b6d7a8","#a2c4c9","#9fc5e8","#b4a7d6","#d5a6bd","#e06666","#f6b26b","#ffd966","#93c47d","#76a5af","#6fa8dc","#8e7cc3","#c27ba0","#cc0000","#e69138","#f1c232","#6aa84f","#45818e","#3d85c6","#674ea7","#a64d79","#990000","#b45f06","#bf9000","#38761d","#134f5c","#0b5394","#351c75","#741b47","#660000","#783f04","#7f6000","#274e13","#0c343d","#073763","#20124d","#4C1130"],showEffect:"",hideEffect:"",onChangeColor:!1,includeMargins:!1},opts=$.extend(defaults,options);return this.each(function(){for(var txt=$(this),colorsMarkup="",prefix=txt.attr("class").replace(/-/g,"")+"_",i=0;i<opts.colors.length;i++){var item=opts.colors[i],breakLine="";i%opts.colorsPerLine==0&&(breakLine="clear: both; "),0<i&&breakLine&&$.browser&&$.browser.msie&&$.browser.version<=7&&(breakLine="",colorsMarkup+='<li style="float: none; clear: both; overflow: hidden; background-color: #fff; display: block; height: 1px; line-height: 1px; font-size: 1px; margin-bottom: -2px;"></li>'),colorsMarkup+='<li id="'+prefix+"color-"+i+'" class="color-box" style="'+breakLine+"background-color: "+item+'" title="'+item+'"></li>'}var box=$('<div id="'+prefix+'color-picker" class="color-picker" style="position: absolute; left: 0px; top: 0px;"><ul>'+colorsMarkup+'</ul><div style="clear: both;"></div></div>');$("body").append(box),box.hide(),box.find("li.color-box").click(function(){txt.is("input")&&(txt.val(opts.colors[this.id.substr(this.id.indexOf("-")+1)]),txt.blur()),$.isFunction(defaults.onChangeColor)&&defaults.onChangeColor.call(txt,opts.colors[this.id.substr(this.id.indexOf("-")+1)]),hideBox(box)}),$("body").on("click",function(){hideBox(box)}),box.click(function(event){event.stopPropagation()});function positionAndShowBox(box){var pos=txt.offset(),left=pos.left+txt.outerWidth(opts.includeMargins)-box.outerWidth(opts.includeMargins);left<pos.left&&(left=pos.left),box.css({left:left,top:pos.top+txt.outerHeight(opts.includeMargins)}),function(box){"fade"==opts.showEffect?box.fadeIn():"slide"==opts.showEffect?box.slideDown():box.show()}(box)}function hideBox(box){"fade"==opts.hideEffect?box.fadeOut():"slide"==opts.hideEffect?box.slideUp():box.hide()}txt.click(function(event){event.stopPropagation(),txt.is("input")||positionAndShowBox(box)}),txt.focus(function(){positionAndShowBox(box)})})}}),function($){var charMin,defaults,change,moveIncrement,upIncrement,moveHue,upHue,moveSelector,upSelector,hide,isChildOf,getViewport,fixHSB,fixRGB,fixHex,HexToHSB,RGBToHSB,HSBToRGB,HSBToHex,ColorPicker=(defaults={eventName:"click",onShow:function(){},onBeforeShow:function(){},onHide:function(){},onChange:function(){},onSubmit:function(){},color:"1b75bb",livePreview:!0,flat:!(charMin=65)},change=function(ev){var col,cal=$(this).parent().parent();0<this.parentNode.className.indexOf("_hex")?cal.data("colorpicker").color=col=HexToHSB(fixHex(this.value)):0<this.parentNode.className.indexOf("_hsb")?cal.data("colorpicker").color=col=fixHSB({h:parseInt(cal.data("colorpicker").fields.eq(4).val(),10),s:parseInt(cal.data("colorpicker").fields.eq(5).val(),10),b:parseInt(cal.data("colorpicker").fields.eq(6).val(),10)}):cal.data("colorpicker").color=col=RGBToHSB(fixRGB({r:parseInt(cal.data("colorpicker").fields.eq(1).val(),10),g:parseInt(cal.data("colorpicker").fields.eq(2).val(),10),b:parseInt(cal.data("colorpicker").fields.eq(3).val(),10)})),ev&&(fillRGBFields(col,cal.get(0)),fillHexFields(col,cal.get(0)),fillHSBFields(col,cal.get(0))),setSelector(col,cal.get(0)),setHue(col,cal.get(0)),setNewColor(col,cal.get(0)),cal.data("colorpicker").onChange.apply(cal,[col,HSBToHex(col),HSBToRGB(col)])},moveIncrement=function(ev){return ev.data.field.val(Math.max(0,Math.min(ev.data.max,parseInt(ev.data.val+ev.pageY-ev.data.y,10)))),ev.data.preview&&change.apply(ev.data.field.get(0),[!0]),!1},upIncrement=function(ev){return change.apply(ev.data.field.get(0),[!0]),ev.data.el.removeClass("colorpicker_slider").find("input").focus(),$(document).unbind("mouseup",upIncrement),$(document).unbind("mousemove",moveIncrement),!1},moveHue=function(ev){return change.apply(ev.data.cal.data("colorpicker").fields.eq(4).val(parseInt(360*(150-Math.max(0,Math.min(150,ev.pageY-ev.data.y)))/150,10)).get(0),[ev.data.preview]),!1},upHue=function(ev){return fillRGBFields(ev.data.cal.data("colorpicker").color,ev.data.cal.get(0)),fillHexFields(ev.data.cal.data("colorpicker").color,ev.data.cal.get(0)),$(document).unbind("mouseup",upHue),$(document).unbind("mousemove",moveHue),!1},moveSelector=function(ev){return change.apply(ev.data.cal.data("colorpicker").fields.eq(6).val(parseInt(100*(150-Math.max(0,Math.min(150,ev.pageY-ev.data.pos.top)))/150,10)).end().eq(5).val(parseInt(100*Math.max(0,Math.min(150,ev.pageX-ev.data.pos.left))/150,10)).get(0),[ev.data.preview]),!1},upSelector=function(ev){return fillRGBFields(ev.data.cal.data("colorpicker").color,ev.data.cal.get(0)),fillHexFields(ev.data.cal.data("colorpicker").color,ev.data.cal.get(0)),$(document).unbind("mouseup",upSelector),$(document).unbind("mousemove",moveSelector),!1},hide=function(ev){isChildOf(ev.data.cal.get(0),ev.target,ev.data.cal.get(0))||(0!=ev.data.cal.data("colorpicker").onHide.apply(this,[ev.data.cal.get(0)])&&ev.data.cal.hide(),$(document).unbind("mousedown",hide))},isChildOf=function(parentEl,el,container){if(parentEl==el)return!0;if(parentEl.contains)return parentEl.contains(el);if(parentEl.compareDocumentPosition)return!!(16&parentEl.compareDocumentPosition(el));for(var prEl=el.parentNode;prEl&&prEl!=container;){if(prEl==parentEl)return!0;prEl=prEl.parentNode}return!1},getViewport=function(){var m="CSS1Compat"==document.compatMode;return{l:window.pageXOffset||(m?document.documentElement.scrollLeft:document.body.scrollLeft),t:window.pageYOffset||(m?document.documentElement.scrollTop:document.body.scrollTop),w:window.innerWidth||(m?document.documentElement.clientWidth:document.body.clientWidth),h:window.innerHeight||(m?document.documentElement.clientHeight:document.body.clientHeight)}},fixHSB=function(hsb){return{h:Math.min(360,Math.max(0,hsb.h)),s:Math.min(100,Math.max(0,hsb.s)),b:Math.min(100,Math.max(0,hsb.b))}},fixRGB=function(rgb){return{r:Math.min(255,Math.max(0,rgb.r)),g:Math.min(255,Math.max(0,rgb.g)),b:Math.min(255,Math.max(0,rgb.b))}},fixHex=function(hex){var len=6-hex.length;if(0<len){for(var o=[],i=0;i<len;i++)o.push("0");o.push(hex),hex=o.join("")}return hex},HexToHSB=function(hex){return RGBToHSB(function(hex){return{r:(hex=parseInt(-1<hex.indexOf("#")?hex.substring(1):hex,16))>>16,g:(65280&hex)>>8,b:255&hex}}(hex))},RGBToHSB=function(rgb){var hsb={h:0,s:0,b:0},min=Math.min(rgb.r,rgb.g,rgb.b),max=Math.max(rgb.r,rgb.g,rgb.b),delta=max-min;return hsb.b=max,hsb.s=0!=max?255*delta/max:0,0!=hsb.s?rgb.r==max?hsb.h=(rgb.g-rgb.b)/delta:rgb.g==max?hsb.h=2+(rgb.b-rgb.r)/delta:hsb.h=4+(rgb.r-rgb.g)/delta:hsb.h=-1,hsb.h*=60,hsb.h<0&&(hsb.h+=360),hsb.s*=100/255,hsb.b*=100/255,hsb},HSBToRGB=function(hsb){var rgb={},h=Math.round(hsb.h),s=Math.round(255*hsb.s/100),v=Math.round(255*hsb.b/100);if(0==s)rgb.r=rgb.g=rgb.b=v;else{var t1=v,t2=(255-s)*v/255,t3=h%60*(t1-t2)/60;360==h&&(h=0),h<60?(rgb.r=t1,rgb.b=t2,rgb.g=t2+t3):h<120?(rgb.g=t1,rgb.b=t2,rgb.r=t1-t3):h<180?(rgb.g=t1,rgb.r=t2,rgb.b=t2+t3):h<240?(rgb.b=t1,rgb.r=t2,rgb.g=t1-t3):h<300?(rgb.b=t1,rgb.g=t2,rgb.r=t2+t3):h<360?(rgb.r=t1,rgb.g=t2,rgb.b=t1-t3):(rgb.r=0,rgb.g=0,rgb.b=0)}return{r:Math.round(rgb.r),g:Math.round(rgb.g),b:Math.round(rgb.b)}},HSBToHex=function(hsb){return function(rgb){var hex=[rgb.r.toString(16),rgb.g.toString(16),rgb.b.toString(16)];return $.each(hex,function(nr,val){1==val.length&&(hex[nr]="0"+val)}),hex.join("")}(HSBToRGB(hsb))},{init:function(opt){if("string"==typeof(opt=$.extend({},defaults,opt||{})).color)opt.color=HexToHSB(opt.color);else if(null!=opt.color.r&&null!=opt.color.g&&null!=opt.color.b)opt.color=RGBToHSB(opt.color);else{if(null==opt.color.h||null==opt.color.s||null==opt.color.b)return this;opt.color=fixHSB(opt.color)}return this.each(function(){if(!$(this).data("colorpickerId")){var options=$.extend({},opt);options.origColor=opt.color;var id="collorpicker_"+parseInt(1e3*Math.random());$(this).data("colorpickerId",id);var cal=$('<div class="colorpicker"><div class="colorpicker_color"><div><div></div></div></div><div class="colorpicker_hue"><div></div></div><div class="colorpicker_new_color"></div><div class="colorpicker_current_color"></div><div class="colorpicker_hex"><input type="text" maxlength="6" size="6" /></div><div class="colorpicker_rgb_r colorpicker_field"><input type="text" maxlength="3" size="3" /><span></span></div><div class="colorpicker_rgb_g colorpicker_field"><input type="text" maxlength="3" size="3" /><span></span></div><div class="colorpicker_rgb_b colorpicker_field"><input type="text" maxlength="3" size="3" /><span></span></div><div class="colorpicker_hsb_h colorpicker_field"><input type="text" maxlength="3" size="3" /><span></span></div><div class="colorpicker_hsb_s colorpicker_field"><input type="text" maxlength="3" size="3" /><span></span></div><div class="colorpicker_hsb_b colorpicker_field"><input type="text" maxlength="3" size="3" /><span></span></div><div class="colorpicker_submit"></div></div>').attr("id",id);options.flat?cal.appendTo(this).show():cal.appendTo(document.body),options.fields=cal.find("input").bind("keyup",keyDown).bind("change",change).bind("blur",blur).bind("focus",focus),cal.find("span").bind("mousedown",downIncrement).end().find(">div.colorpicker_current_color").bind("click",restoreOriginal),options.selector=cal.find("div.colorpicker_color").bind("mousedown",downSelector),options.selectorIndic=options.selector.find("div div"),options.el=this,options.hue=cal.find("div.colorpicker_hue div"),cal.find("div.colorpicker_hue").bind("mousedown",downHue),options.newColor=cal.find("div.colorpicker_new_color"),options.currentColor=cal.find("div.colorpicker_current_color"),cal.data("colorpicker",options),cal.find("div.colorpicker_submit").bind("mouseenter",enterSubmit).bind("mouseleave",leaveSubmit).bind("click",clickSubmit),fillRGBFields(options.color,cal.get(0)),fillHSBFields(options.color,cal.get(0)),fillHexFields(options.color,cal.get(0)),setHue(options.color,cal.get(0)),setSelector(options.color,cal.get(0)),setCurrentColor(options.color,cal.get(0)),setNewColor(options.color,cal.get(0)),options.flat?cal.css({position:"relative",display:"block"}):$(this).bind(options.eventName,show)}})},showPicker:function(){return this.each(function(){$(this).data("colorpickerId")&&show.apply(this)})},hidePicker:function(){return this.each(function(){$(this).data("colorpickerId")&&$("#"+$(this).data("colorpickerId")).hide()})},setColor:function(col){if("string"==typeof col)col=HexToHSB(col);else if(null!=col.r&&null!=col.g&&null!=col.b)col=RGBToHSB(col);else{if(null==col.h||null==col.s||null==col.b)return this;col=fixHSB(col)}return this.each(function(){if($(this).data("colorpickerId")){var cal=$("#"+$(this).data("colorpickerId"));cal.data("colorpicker").color=col,cal.data("colorpicker").origColor=col,fillRGBFields(col,cal.get(0)),fillHSBFields(col,cal.get(0)),fillHexFields(col,cal.get(0)),setHue(col,cal.get(0)),setSelector(col,cal.get(0)),setCurrentColor(col,cal.get(0)),setNewColor(col,cal.get(0))}})}});function fillRGBFields(hsb,cal){var rgb=HSBToRGB(hsb);$(cal).data("colorpicker").fields.eq(1).val(rgb.r).end().eq(2).val(rgb.g).end().eq(3).val(rgb.b).end()}function fillHSBFields(hsb,cal){$(cal).data("colorpicker").fields.eq(4).val(hsb.h).end().eq(5).val(hsb.s).end().eq(6).val(hsb.b).end()}function fillHexFields(hsb,cal){$(cal).data("colorpicker").fields.eq(0).val(HSBToHex(hsb)).end()}function setSelector(hsb,cal){$(cal).data("colorpicker").selector.css("backgroundColor","#"+HSBToHex({h:hsb.h,s:100,b:100})),$(cal).data("colorpicker").selectorIndic.css({left:parseInt(150*hsb.s/100,10),top:parseInt(150*(100-hsb.b)/100,10)})}function setHue(hsb,cal){$(cal).data("colorpicker").hue.css("top",parseInt(150-150*hsb.h/360,10))}function setCurrentColor(hsb,cal){$(cal).data("colorpicker").currentColor.css("backgroundColor","#"+HSBToHex(hsb))}function setNewColor(hsb,cal){$(cal).data("colorpicker").newColor.css("backgroundColor","#"+HSBToHex(hsb))}function keyDown(ev){var pressedKey=ev.charCode||ev.keyCode||-1;if(charMin<pressedKey&&pressedKey<=90||32==pressedKey)return!1;!0===$(this).parent().parent().data("colorpicker").livePreview&&change.apply(this)}function blur(ev){$(this).parent().parent().data("colorpicker").fields.parent().removeClass("colorpicker_focus")}function focus(){charMin=0<this.parentNode.className.indexOf("_hex")?70:65,$(this).parent().parent().data("colorpicker").fields.parent().removeClass("colorpicker_focus"),$(this).parent().addClass("colorpicker_focus")}function downIncrement(ev){var field=$(this).parent().find("input").focus(),current={el:$(this).parent().addClass("colorpicker_slider"),max:0<this.parentNode.className.indexOf("_hsb_h")?360:0<this.parentNode.className.indexOf("_hsb")?100:255,y:ev.pageY,field:field,val:parseInt(field.val(),10),preview:$(this).parent().parent().data("colorpicker").livePreview};$(document).bind("mouseup",current,upIncrement),$(document).bind("mousemove",current,moveIncrement)}function downHue(ev){var current={cal:$(this).parent(),y:$(this).offset().top};current.preview=current.cal.data("colorpicker").livePreview,$(document).bind("mouseup",current,upHue),$(document).bind("mousemove",current,moveHue)}function downSelector(ev){var current={cal:$(this).parent(),pos:$(this).offset()};current.preview=current.cal.data("colorpicker").livePreview,$(document).bind("mouseup",current,upSelector),$(document).bind("mousemove",current,moveSelector)}function enterSubmit(ev){$(this).addClass("colorpicker_focus")}function leaveSubmit(ev){$(this).removeClass("colorpicker_focus")}function clickSubmit(ev){var cal=$(this).parent(),col=cal.data("colorpicker").color;cal.data("colorpicker").origColor=col,setCurrentColor(col,cal.get(0)),cal.data("colorpicker").onSubmit(col,HSBToHex(col),HSBToRGB(col),cal.data("colorpicker").el)}function show(ev){var cal=$("#"+$(this).data("colorpickerId"));cal.data("colorpicker").onBeforeShow.apply(this,[cal.get(0)]);var pos=$(this).offset(),viewPort=getViewport(),top=pos.top+this.offsetHeight,left=pos.left;return top+176>viewPort.t+viewPort.h&&(top-=this.offsetHeight+176),left+356>viewPort.l+viewPort.w&&(left-=356),cal.css({left:left+"px",top:top+"px"}),0!=cal.data("colorpicker").onShow.apply(this,[cal.get(0)])&&cal.show(),$(document).bind("mousedown",{cal:cal},hide),!1}function restoreOriginal(){var cal=$(this).parent(),col=cal.data("colorpicker").origColor;cal.data("colorpicker").color=col,fillRGBFields(col,cal.get(0)),fillHexFields(col,cal.get(0)),fillHSBFields(col,cal.get(0)),setSelector(col,cal.get(0)),setHue(col,cal.get(0)),setNewColor(col,cal.get(0))}$.fn.extend({ColorPicker:ColorPicker.init,ColorPickerHide:ColorPicker.hidePicker,ColorPickerShow:ColorPicker.showPicker,ColorPickerSetColor:ColorPicker.setColor})}(jQuery),function(e,a){"object"==typeof exports&&"undefined"!=typeof module?module.exports=a():"function"==typeof define&&define.amd?define(a):e.moment=a()}(this,function(){"use strict";var e,n;function l(){return e.apply(null,arguments)}function _(e){return e instanceof Array||"[object Array]"===Object.prototype.toString.call(e)}function i(e){return null!=e&&"[object Object]"===Object.prototype.toString.call(e)}function o(e){return void 0===e}function m(e){return"number"==typeof e||"[object Number]"===Object.prototype.toString.call(e)}function u(e){return e instanceof Date||"[object Date]"===Object.prototype.toString.call(e)}function M(e,a){var t,s=[];for(t=0;t<e.length;++t)s.push(a(e[t],t));return s}function h(e,a){return Object.prototype.hasOwnProperty.call(e,a)}function L(e,a){for(var t in a)h(a,t)&&(e[t]=a[t]);return h(a,"toString")&&(e.toString=a.toString),h(a,"valueOf")&&(e.valueOf=a.valueOf),e}function c(e,a,t,s){return Sa(e,a,t,s,!0).utc()}function Y(e){return null==e._pf&&(e._pf={empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1,parsedDateParts:[],meridiem:null,rfc2822:!1,weekdayMismatch:!1}),e._pf}function y(e){if(null==e._isValid){var a=Y(e),t=n.call(a.parsedDateParts,function(e){return null!=e}),s=!isNaN(e._d.getTime())&&a.overflow<0&&!a.empty&&!a.invalidMonth&&!a.invalidWeekday&&!a.weekdayMismatch&&!a.nullInput&&!a.invalidFormat&&!a.userInvalidated&&(!a.meridiem||a.meridiem&&t);if(e._strict&&(s=s&&0===a.charsLeftOver&&0===a.unusedTokens.length&&void 0===a.bigHour),null!=Object.isFrozen&&Object.isFrozen(e))return s;e._isValid=s}return e._isValid}function f(e){var a=c(NaN);return null!=e?L(Y(a),e):Y(a).userInvalidated=!0,a}n=Array.prototype.some?Array.prototype.some:function(e){for(var a=Object(this),t=a.length>>>0,s=0;s<t;s++)if(s in a&&e.call(this,a[s],s,a))return!0;return!1};var d=l.momentProperties=[];function k(e,a){var t,s,n;if(o(a._isAMomentObject)||(e._isAMomentObject=a._isAMomentObject),o(a._i)||(e._i=a._i),o(a._f)||(e._f=a._f),o(a._l)||(e._l=a._l),o(a._strict)||(e._strict=a._strict),o(a._tzm)||(e._tzm=a._tzm),o(a._isUTC)||(e._isUTC=a._isUTC),o(a._offset)||(e._offset=a._offset),o(a._pf)||(e._pf=Y(a)),o(a._locale)||(e._locale=a._locale),0<d.length)for(t=0;t<d.length;t++)o(n=a[s=d[t]])||(e[s]=n);return e}var a=!1;function p(e){k(this,e),this._d=new Date(null!=e._d?e._d.getTime():NaN),this.isValid()||(this._d=new Date(NaN)),!1===a&&(a=!0,l.updateOffset(this),a=!1)}function D(e){return e instanceof p||null!=e&&null!=e._isAMomentObject}function T(e){return e<0?Math.ceil(e)||0:Math.floor(e)}function g(e){var a=+e,t=0;return 0!=a&&isFinite(a)&&(t=T(a)),t}function r(e,a,t){var s,n=Math.min(e.length,a.length),d=Math.abs(e.length-a.length),r=0;for(s=0;s<n;s++)(t&&e[s]!==a[s]||!t&&g(e[s])!==g(a[s]))&&r++;return r+d}function w(e){!1===l.suppressDeprecationWarnings&&"undefined"!=typeof console&&console.warn&&console.warn("Deprecation warning: "+e)}function t(n,d){var r=!0;return L(function(){if(null!=l.deprecationHandler&&l.deprecationHandler(null,n),r){for(var e,a=[],t=0;t<arguments.length;t++){if(e="","object"==typeof arguments[t]){for(var s in e+="\n["+t+"] ",arguments[0])e+=s+": "+arguments[0][s]+", ";e=e.slice(0,-2)}else e=arguments[t];a.push(e)}w(n+"\nArguments: "+Array.prototype.slice.call(a).join("")+"\n"+(new Error).stack),r=!1}return d.apply(this,arguments)},d)}var s,v={};function S(e,a){null!=l.deprecationHandler&&l.deprecationHandler(e,a),v[e]||(w(a),v[e]=!0)}function H(e){return e instanceof Function||"[object Function]"===Object.prototype.toString.call(e)}function b(e,a){var t,s=L({},e);for(t in a)h(a,t)&&(i(e[t])&&i(a[t])?(s[t]={},L(s[t],e[t]),L(s[t],a[t])):null!=a[t]?s[t]=a[t]:delete s[t]);for(t in e)h(e,t)&&!h(a,t)&&i(e[t])&&(s[t]=L({},s[t]));return s}function j(e){null!=e&&this.set(e)}l.suppressDeprecationWarnings=!1,l.deprecationHandler=null,s=Object.keys?Object.keys:function(e){var a,t=[];for(a in e)h(e,a)&&t.push(a);return t};var x={};function O(e,a){var t=e.toLowerCase();x[t]=x[t+"s"]=x[a]=e}function P(e){return"string"==typeof e?x[e]||x[e.toLowerCase()]:void 0}function W(e){var a,t,s={};for(t in e)h(e,t)&&(a=P(t))&&(s[a]=e[t]);return s}var A={};function E(e,a){A[e]=a}function F(e,a,t){var s=""+Math.abs(e),n=a-s.length;return(0<=e?t?"+":"":"-")+Math.pow(10,Math.max(0,n)).toString().substr(1)+s}var z=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|YYYYYY|YYYYY|YYYY|YY|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,J=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,N={},R={};function C(e,a,t,s){var n=s;"string"==typeof s&&(n=function(){return this[s]()}),e&&(R[e]=n),a&&(R[a[0]]=function(){return F(n.apply(this,arguments),a[1],a[2])}),t&&(R[t]=function(){return this.localeData().ordinal(n.apply(this,arguments),e)})}function I(e,a){return e.isValid()?(a=U(a,e.localeData()),N[a]=N[a]||function(s){var e,n,a,d=s.match(z);for(e=0,n=d.length;e<n;e++)R[d[e]]?d[e]=R[d[e]]:d[e]=(a=d[e]).match(/\[[\s\S]/)?a.replace(/^\[|\]$/g,""):a.replace(/\\/g,"");return function(e){var a,t="";for(a=0;a<n;a++)t+=H(d[a])?d[a].call(e,s):d[a];return t}}(a),N[a](e)):e.localeData().invalidDate()}function U(e,a){var t=5;function s(e){return a.longDateFormat(e)||e}for(J.lastIndex=0;0<=t&&J.test(e);)e=e.replace(J,s),J.lastIndex=0,t-=1;return e}var G=/\d/,V=/\d\d/,K=/\d{3}/,Z=/\d{4}/,$=/[+-]?\d{6}/,B=/\d\d?/,q=/\d\d\d\d?/,Q=/\d\d\d\d\d\d?/,X=/\d{1,3}/,ee=/\d{1,4}/,ae=/[+-]?\d{1,6}/,te=/\d+/,se=/[+-]?\d+/,ne=/Z|[+-]\d\d:?\d\d/gi,de=/Z|[+-]\d\d(?::?\d\d)?/gi,re=/[0-9]{0,256}['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFF07\uFF10-\uFFEF]{1,256}|[\u0600-\u06FF\/]{1,256}(\s*?[\u0600-\u06FF]{1,256}){1,2}/i,_e={};function ie(e,t,s){_e[e]=H(t)?t:function(e,a){return e&&s?s:t}}function oe(e,a){return h(_e,e)?_e[e](a._strict,a._locale):new RegExp(me(e.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(e,a,t,s,n){return a||t||s||n})))}function me(e){return e.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}var ue={};function le(e,t){var a,s=t;for("string"==typeof e&&(e=[e]),m(t)&&(s=function(e,a){a[t]=g(e)}),a=0;a<e.length;a++)ue[e[a]]=s}function Me(e,n){le(e,function(e,a,t,s){t._w=t._w||{},n(e,t._w,t,s)})}var he=0,Le=1,ce=2,Ye=3,ye=4,fe=5,ke=6,pe=7,De=8;function Te(e){return ge(e)?366:365}function ge(e){return e%4==0&&e%100!=0||e%400==0}C("Y",0,0,function(){var e=this.year();return e<=9999?""+e:"+"+e}),C(0,["YY",2],0,function(){return this.year()%100}),C(0,["YYYY",4],0,"year"),C(0,["YYYYY",5],0,"year"),C(0,["YYYYYY",6,!0],0,"year"),O("year","y"),E("year",1),ie("Y",se),ie("YY",B,V),ie("YYYY",ee,Z),ie("YYYYY",ae,$),ie("YYYYYY",ae,$),le(["YYYYY","YYYYYY"],he),le("YYYY",function(e,a){a[he]=2===e.length?l.parseTwoDigitYear(e):g(e)}),le("YY",function(e,a){a[he]=l.parseTwoDigitYear(e)}),le("Y",function(e,a){a[he]=parseInt(e,10)}),l.parseTwoDigitYear=function(e){return g(e)+(68<g(e)?1900:2e3)};var we,ve=Se("FullYear",!0);function Se(a,t){return function(e){return null!=e?(be(this,a,e),l.updateOffset(this,t),this):He(this,a)}}function He(e,a){return e.isValid()?e._d["get"+(e._isUTC?"UTC":"")+a]():NaN}function be(e,a,t){e.isValid()&&!isNaN(t)&&("FullYear"===a&&ge(e.year())&&1===e.month()&&29===e.date()?e._d["set"+(e._isUTC?"UTC":"")+a](t,e.month(),je(t,e.month())):e._d["set"+(e._isUTC?"UTC":"")+a](t))}function je(e,a){if(isNaN(e)||isNaN(a))return NaN;var s=(a%12+12)%12;return e+=(a-s)/12,1==s?ge(e)?29:28:31-s%7%2}we=Array.prototype.indexOf?Array.prototype.indexOf:function(e){var a;for(a=0;a<this.length;++a)if(this[a]===e)return a;return-1},C("M",["MM",2],"Mo",function(){return this.month()+1}),C("MMM",0,0,function(e){return this.localeData().monthsShort(this,e)}),C("MMMM",0,0,function(e){return this.localeData().months(this,e)}),O("month","M"),E("month",8),ie("M",B),ie("MM",B,V),ie("MMM",function(e,a){return a.monthsShortRegex(e)}),ie("MMMM",function(e,a){return a.monthsRegex(e)}),le(["M","MM"],function(e,a){a[Le]=g(e)-1}),le(["MMM","MMMM"],function(e,a,t,s){var n=t._locale.monthsParse(e,s,t._strict);null!=n?a[Le]=n:Y(t).invalidMonth=e});var xe=/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/,Oe="January_February_March_April_May_June_July_August_September_October_November_December".split("_"),Pe="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_");function We(e,a){var t;if(!e.isValid())return e;if("string"==typeof a)if(/^\d+$/.test(a))a=g(a);else if(!m(a=e.localeData().monthsParse(a)))return e;return t=Math.min(e.date(),je(e.year(),a)),e._d["set"+(e._isUTC?"UTC":"")+"Month"](a,t),e}function Ae(e){return null!=e?(We(this,e),l.updateOffset(this,!0),this):He(this,"Month")}var Ee=re,Fe=re;function ze(){function e(e,a){return a.length-e.length}var a,t,s=[],n=[],d=[];for(a=0;a<12;a++)t=c([2e3,a]),s.push(this.monthsShort(t,"")),n.push(this.months(t,"")),d.push(this.months(t,"")),d.push(this.monthsShort(t,""));for(s.sort(e),n.sort(e),d.sort(e),a=0;a<12;a++)s[a]=me(s[a]),n[a]=me(n[a]);for(a=0;a<24;a++)d[a]=me(d[a]);this._monthsRegex=new RegExp("^("+d.join("|")+")","i"),this._monthsShortRegex=this._monthsRegex,this._monthsStrictRegex=new RegExp("^("+n.join("|")+")","i"),this._monthsShortStrictRegex=new RegExp("^("+s.join("|")+")","i")}function Je(e){var a;if(e<100&&0<=e){var t=Array.prototype.slice.call(arguments);t[0]=e+400,a=new Date(Date.UTC.apply(null,t)),isFinite(a.getUTCFullYear())&&a.setUTCFullYear(e)}else a=new Date(Date.UTC.apply(null,arguments));return a}function Ne(e,a,t){var s=7+a-t;return-(7+Je(e,0,s).getUTCDay()-a)%7+s-1}function Re(e,a,t,s,n){var d,r,_=1+7*(a-1)+(7+t-s)%7+Ne(e,s,n);return r=_<=0?Te(d=e-1)+_:_>Te(e)?(d=e+1,_-Te(e)):(d=e,_),{year:d,dayOfYear:r}}function Ce(e,a,t){var s,n,d=Ne(e.year(),a,t),r=Math.floor((e.dayOfYear()-d-1)/7)+1;return r<1?s=r+Ie(n=e.year()-1,a,t):r>Ie(e.year(),a,t)?(s=r-Ie(e.year(),a,t),n=e.year()+1):(n=e.year(),s=r),{week:s,year:n}}function Ie(e,a,t){var s=Ne(e,a,t),n=Ne(e+1,a,t);return(Te(e)-s+n)/7}function Ue(e,a){return e.slice(a,7).concat(e.slice(0,a))}C("w",["ww",2],"wo","week"),C("W",["WW",2],"Wo","isoWeek"),O("week","w"),O("isoWeek","W"),E("week",5),E("isoWeek",5),ie("w",B),ie("ww",B,V),ie("W",B),ie("WW",B,V),Me(["w","ww","W","WW"],function(e,a,t,s){a[s.substr(0,1)]=g(e)}),C("d",0,"do","day"),C("dd",0,0,function(e){return this.localeData().weekdaysMin(this,e)}),C("ddd",0,0,function(e){return this.localeData().weekdaysShort(this,e)}),C("dddd",0,0,function(e){return this.localeData().weekdays(this,e)}),C("e",0,0,"weekday"),C("E",0,0,"isoWeekday"),O("day","d"),O("weekday","e"),O("isoWeekday","E"),E("day",11),E("weekday",11),E("isoWeekday",11),ie("d",B),ie("e",B),ie("E",B),ie("dd",function(e,a){return a.weekdaysMinRegex(e)}),ie("ddd",function(e,a){return a.weekdaysShortRegex(e)}),ie("dddd",function(e,a){return a.weekdaysRegex(e)}),Me(["dd","ddd","dddd"],function(e,a,t,s){var n=t._locale.weekdaysParse(e,s,t._strict);null!=n?a.d=n:Y(t).invalidWeekday=e}),Me(["d","e","E"],function(e,a,t,s){a[s]=g(e)});var Ge="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),Ve="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),Ke="Su_Mo_Tu_We_Th_Fr_Sa".split("_"),Ze=re,$e=re,Be=re;function qe(){function e(e,a){return a.length-e.length}var a,t,s,n,d,r=[],_=[],i=[],o=[];for(a=0;a<7;a++)t=c([2e3,1]).day(a),s=this.weekdaysMin(t,""),n=this.weekdaysShort(t,""),d=this.weekdays(t,""),r.push(s),_.push(n),i.push(d),o.push(s),o.push(n),o.push(d);for(r.sort(e),_.sort(e),i.sort(e),o.sort(e),a=0;a<7;a++)_[a]=me(_[a]),i[a]=me(i[a]),o[a]=me(o[a]);this._weekdaysRegex=new RegExp("^("+o.join("|")+")","i"),this._weekdaysShortRegex=this._weekdaysRegex,this._weekdaysMinRegex=this._weekdaysRegex,this._weekdaysStrictRegex=new RegExp("^("+i.join("|")+")","i"),this._weekdaysShortStrictRegex=new RegExp("^("+_.join("|")+")","i"),this._weekdaysMinStrictRegex=new RegExp("^("+r.join("|")+")","i")}function Qe(){return this.hours()%12||12}function Xe(e,a){C(e,0,0,function(){return this.localeData().meridiem(this.hours(),this.minutes(),a)})}function ea(e,a){return a._meridiemParse}C("H",["HH",2],0,"hour"),C("h",["hh",2],0,Qe),C("k",["kk",2],0,function(){return this.hours()||24}),C("hmm",0,0,function(){return""+Qe.apply(this)+F(this.minutes(),2)}),C("hmmss",0,0,function(){return""+Qe.apply(this)+F(this.minutes(),2)+F(this.seconds(),2)}),C("Hmm",0,0,function(){return""+this.hours()+F(this.minutes(),2)}),C("Hmmss",0,0,function(){return""+this.hours()+F(this.minutes(),2)+F(this.seconds(),2)}),Xe("a",!0),Xe("A",!1),O("hour","h"),E("hour",13),ie("a",ea),ie("A",ea),ie("H",B),ie("h",B),ie("k",B),ie("HH",B,V),ie("hh",B,V),ie("kk",B,V),ie("hmm",q),ie("hmmss",Q),ie("Hmm",q),ie("Hmmss",Q),le(["H","HH"],Ye),le(["k","kk"],function(e,a,t){var s=g(e);a[Ye]=24===s?0:s}),le(["a","A"],function(e,a,t){t._isPm=t._locale.isPM(e),t._meridiem=e}),le(["h","hh"],function(e,a,t){a[Ye]=g(e),Y(t).bigHour=!0}),le("hmm",function(e,a,t){var s=e.length-2;a[Ye]=g(e.substr(0,s)),a[ye]=g(e.substr(s)),Y(t).bigHour=!0}),le("hmmss",function(e,a,t){var s=e.length-4,n=e.length-2;a[Ye]=g(e.substr(0,s)),a[ye]=g(e.substr(s,2)),a[fe]=g(e.substr(n)),Y(t).bigHour=!0}),le("Hmm",function(e,a,t){var s=e.length-2;a[Ye]=g(e.substr(0,s)),a[ye]=g(e.substr(s))}),le("Hmmss",function(e,a,t){var s=e.length-4,n=e.length-2;a[Ye]=g(e.substr(0,s)),a[ye]=g(e.substr(s,2)),a[fe]=g(e.substr(n))});var aa,ta=Se("Hours",!0),sa={calendar:{sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"},longDateFormat:{LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"},invalidDate:"Invalid date",ordinal:"%d",dayOfMonthOrdinalParse:/\d{1,2}/,relativeTime:{future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},months:Oe,monthsShort:Pe,week:{dow:0,doy:6},weekdays:Ge,weekdaysMin:Ke,weekdaysShort:Ve,meridiemParse:/[ap]\.?m?\.?/i},na={},da={};function ra(e){return e?e.toLowerCase().replace("_","-"):e}function _a(e){var a=null;if(!na[e]&&"undefined"!=typeof module&&module&&module.exports)try{a=aa._abbr,require("./locale/"+e),ia(a)}catch(e){}return na[e]}function ia(e,a){var t;return e&&((t=o(a)?ma(e):oa(e,a))?aa=t:"undefined"!=typeof console&&console.warn&&console.warn("Locale "+e+" not found. Did you forget to load it?")),aa._abbr}function oa(e,a){if(null===a)return delete na[e],null;var t,s=sa;if(a.abbr=e,null!=na[e])S("defineLocaleOverride","use moment.updateLocale(localeName, config) to change an existing locale. moment.defineLocale(localeName, config) should only be used for creating a new locale See http://momentjs.com/guides/#/warnings/define-locale/ for more info."),s=na[e]._config;else if(null!=a.parentLocale)if(null!=na[a.parentLocale])s=na[a.parentLocale]._config;else{if(null==(t=_a(a.parentLocale)))return da[a.parentLocale]||(da[a.parentLocale]=[]),da[a.parentLocale].push({name:e,config:a}),null;s=t._config}return na[e]=new j(b(s,a)),da[e]&&da[e].forEach(function(e){oa(e.name,e.config)}),ia(e),na[e]}function ma(e){var a;if(e&&e._locale&&e._locale._abbr&&(e=e._locale._abbr),!e)return aa;if(!_(e)){if(a=_a(e))return a;e=[e]}return function(e){for(var a,t,s,n,d=0;d<e.length;){for(a=(n=ra(e[d]).split("-")).length,t=(t=ra(e[d+1]))?t.split("-"):null;0<a;){if(s=_a(n.slice(0,a).join("-")))return s;if(t&&t.length>=a&&r(n,t,!0)>=a-1)break;a--}d++}return aa}(e)}function ua(e){var a,t=e._a;return t&&-2===Y(e).overflow&&(a=t[Le]<0||11<t[Le]?Le:t[ce]<1||t[ce]>je(t[he],t[Le])?ce:t[Ye]<0||24<t[Ye]||24===t[Ye]&&(0!==t[ye]||0!==t[fe]||0!==t[ke])?Ye:t[ye]<0||59<t[ye]?ye:t[fe]<0||59<t[fe]?fe:t[ke]<0||999<t[ke]?ke:-1,Y(e)._overflowDayOfYear&&(a<he||ce<a)&&(a=ce),Y(e)._overflowWeeks&&-1===a&&(a=pe),Y(e)._overflowWeekday&&-1===a&&(a=De),Y(e).overflow=a),e}function la(e,a,t){return null!=e?e:null!=a?a:t}function Ma(e){var a,t,s,n,d,r=[];if(!e._d){var _,i;for(_=e,i=new Date(l.now()),s=_._useUTC?[i.getUTCFullYear(),i.getUTCMonth(),i.getUTCDate()]:[i.getFullYear(),i.getMonth(),i.getDate()],e._w&&null==e._a[ce]&&null==e._a[Le]&&function(e){var a,t,s,n,d,r,_,i;if(null!=(a=e._w).GG||null!=a.W||null!=a.E)d=1,r=4,t=la(a.GG,e._a[he],Ce(Ha(),1,4).year),s=la(a.W,1),((n=la(a.E,1))<1||7<n)&&(i=!0);else{d=e._locale._week.dow,r=e._locale._week.doy;var o=Ce(Ha(),d,r);t=la(a.gg,e._a[he],o.year),s=la(a.w,o.week),null!=a.d?((n=a.d)<0||6<n)&&(i=!0):null!=a.e?(n=a.e+d,(a.e<0||6<a.e)&&(i=!0)):n=d}s<1||s>Ie(t,d,r)?Y(e)._overflowWeeks=!0:null!=i?Y(e)._overflowWeekday=!0:(_=Re(t,s,n,d,r),e._a[he]=_.year,e._dayOfYear=_.dayOfYear)}(e),null!=e._dayOfYear&&(d=la(e._a[he],s[he]),(e._dayOfYear>Te(d)||0===e._dayOfYear)&&(Y(e)._overflowDayOfYear=!0),t=Je(d,0,e._dayOfYear),e._a[Le]=t.getUTCMonth(),e._a[ce]=t.getUTCDate()),a=0;a<3&&null==e._a[a];++a)e._a[a]=r[a]=s[a];for(;a<7;a++)e._a[a]=r[a]=null==e._a[a]?2===a?1:0:e._a[a];24===e._a[Ye]&&0===e._a[ye]&&0===e._a[fe]&&0===e._a[ke]&&(e._nextDay=!0,e._a[Ye]=0),e._d=(e._useUTC?Je:function(e,a,t,s,n,d,r){var _;return e<100&&0<=e?(_=new Date(e+400,a,t,s,n,d,r),isFinite(_.getFullYear())&&_.setFullYear(e)):_=new Date(e,a,t,s,n,d,r),_}).apply(null,r),n=e._useUTC?e._d.getUTCDay():e._d.getDay(),null!=e._tzm&&e._d.setUTCMinutes(e._d.getUTCMinutes()-e._tzm),e._nextDay&&(e._a[Ye]=24),e._w&&void 0!==e._w.d&&e._w.d!==n&&(Y(e).weekdayMismatch=!0)}}var ha=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?$/,La=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?$/,ca=/Z|[+-]\d\d(?::?\d\d)?/,Ya=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,!1],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,!1],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,!1],["YYYYDDD",/\d{7}/]],ya=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]],fa=/^\/?Date\((\-?\d+)/i;function ka(e){var a,t,s,n,d,r,_=e._i,i=ha.exec(_)||La.exec(_);if(i){for(Y(e).iso=!0,a=0,t=Ya.length;a<t;a++)if(Ya[a][1].exec(i[1])){n=Ya[a][0],s=!1!==Ya[a][2];break}if(null==n)return void(e._isValid=!1);if(i[3]){for(a=0,t=ya.length;a<t;a++)if(ya[a][1].exec(i[3])){d=(i[2]||" ")+ya[a][0];break}if(null==d)return void(e._isValid=!1)}if(!s&&null!=d)return void(e._isValid=!1);if(i[4]){if(!ca.exec(i[4]))return void(e._isValid=!1);r="Z"}e._f=n+(d||"")+(r||""),wa(e)}else e._isValid=!1}var pa=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),?\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|([+-]\d{4}))$/;var Ta={UT:0,GMT:0,EDT:-240,EST:-300,CDT:-300,CST:-360,MDT:-360,MST:-420,PDT:-420,PST:-480};function ga(e){var a,t,s,n=pa.exec(e._i.replace(/\([^)]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").replace(/^\s\s*/,"").replace(/\s\s*$/,""));if(n){var d=function(e,a,t,s,n,d){var r=[function(e){var a=parseInt(e,10);return a<=49?2e3+a:a<=999?1900+a:a}(e),Pe.indexOf(a),parseInt(t,10),parseInt(s,10),parseInt(n,10)];return d&&r.push(parseInt(d,10)),r}(n[4],n[3],n[2],n[5],n[6],n[7]);if(t=d,s=e,(a=n[1])&&Ve.indexOf(a)!==new Date(t[0],t[1],t[2]).getDay()&&(Y(s).weekdayMismatch=!0,!(s._isValid=!1)))return;e._a=d,e._tzm=function(e,a,t){if(e)return Ta[e];if(a)return 0;var s=parseInt(t,10),n=s%100;return(s-n)/100*60+n}(n[8],n[9],n[10]),e._d=Je.apply(null,e._a),e._d.setUTCMinutes(e._d.getUTCMinutes()-e._tzm),Y(e).rfc2822=!0}else e._isValid=!1}function wa(e){if(e._f!==l.ISO_8601)if(e._f!==l.RFC_2822){e._a=[],Y(e).empty=!0;var a,t,s,n,d,r,_,i,o=""+e._i,m=o.length,u=0;for(s=U(e._f,e._locale).match(z)||[],a=0;a<s.length;a++)n=s[a],(t=(o.match(oe(n,e))||[])[0])&&(0<(d=o.substr(0,o.indexOf(t))).length&&Y(e).unusedInput.push(d),o=o.slice(o.indexOf(t)+t.length),u+=t.length),R[n]?(t?Y(e).empty=!1:Y(e).unusedTokens.push(n),r=n,i=e,null!=(_=t)&&h(ue,r)&&ue[r](_,i._a,i,r)):e._strict&&!t&&Y(e).unusedTokens.push(n);Y(e).charsLeftOver=m-u,0<o.length&&Y(e).unusedInput.push(o),e._a[Ye]<=12&&!0===Y(e).bigHour&&0<e._a[Ye]&&(Y(e).bigHour=void 0),Y(e).parsedDateParts=e._a.slice(0),Y(e).meridiem=e._meridiem,e._a[Ye]=function(e,a,t){var s;return null==t?a:null!=e.meridiemHour?e.meridiemHour(a,t):(null!=e.isPM&&((s=e.isPM(t))&&a<12&&(a+=12),s||12!==a||(a=0)),a)}(e._locale,e._a[Ye],e._meridiem),Ma(e),ua(e)}else ga(e);else ka(e)}function va(e){var a,t,s,n,d=e._i,r=e._f;return e._locale=e._locale||ma(e._l),null===d||void 0===r&&""===d?f({nullInput:!0}):("string"==typeof d&&(e._i=d=e._locale.preparse(d)),D(d)?new p(ua(d)):(u(d)?e._d=d:_(r)?function(e){var a,t,s,n,d;if(0===e._f.length)return Y(e).invalidFormat=!0,e._d=new Date(NaN);for(n=0;n<e._f.length;n++)d=0,a=k({},e),null!=e._useUTC&&(a._useUTC=e._useUTC),a._f=e._f[n],wa(a),y(a)&&(d+=Y(a).charsLeftOver,d+=10*Y(a).unusedTokens.length,Y(a).score=d,(null==s||d<s)&&(s=d,t=a));L(e,t||a)}(e):r?wa(e):o(t=(a=e)._i)?a._d=new Date(l.now()):u(t)?a._d=new Date(t.valueOf()):"string"==typeof t?(s=a,null===(n=fa.exec(s._i))?(ka(s),!1===s._isValid&&(delete s._isValid,ga(s),!1===s._isValid&&(delete s._isValid,l.createFromInputFallback(s)))):s._d=new Date(+n[1])):_(t)?(a._a=M(t.slice(0),function(e){return parseInt(e,10)}),Ma(a)):i(t)?function(e){if(!e._d){var a=W(e._i);e._a=M([a.year,a.month,a.day||a.date,a.hour,a.minute,a.second,a.millisecond],function(e){return e&&parseInt(e,10)}),Ma(e)}}(a):m(t)?a._d=new Date(t):l.createFromInputFallback(a),y(e)||(e._d=null),e))}function Sa(e,a,t,s,n){var d,r={};return!0!==t&&!1!==t||(s=t,t=void 0),(i(e)&&function(e){if(Object.getOwnPropertyNames)return 0===Object.getOwnPropertyNames(e).length;var a;for(a in e)if(e.hasOwnProperty(a))return!1;return!0}(e)||_(e)&&0===e.length)&&(e=void 0),r._isAMomentObject=!0,r._useUTC=r._isUTC=n,r._l=t,r._i=e,r._f=a,r._strict=s,(d=new p(ua(va(r))))._nextDay&&(d.add(1,"d"),d._nextDay=void 0),d}function Ha(e,a,t,s){return Sa(e,a,t,s,!1)}l.createFromInputFallback=t("value provided is not in a recognized RFC2822 or ISO format. moment construction falls back to js Date(), which is not reliable across all browsers and versions. Non RFC2822/ISO date formats are discouraged and will be removed in an upcoming major release. Please refer to http://momentjs.com/guides/#/warnings/js-date/ for more info.",function(e){e._d=new Date(e._i+(e._useUTC?" UTC":""))}),l.ISO_8601=function(){},l.RFC_2822=function(){};var ba=t("moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var e=Ha.apply(null,arguments);return this.isValid()&&e.isValid()?e<this?this:e:f()}),ja=t("moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var e=Ha.apply(null,arguments);return this.isValid()&&e.isValid()?this<e?this:e:f()});function xa(e,a){var t,s;if(1===a.length&&_(a[0])&&(a=a[0]),!a.length)return Ha();for(t=a[0],s=1;s<a.length;++s)a[s].isValid()&&!a[s][e](t)||(t=a[s]);return t}var Oa=["year","quarter","month","week","day","hour","minute","second","millisecond"];function Pa(e){var a=W(e),t=a.year||0,s=a.quarter||0,n=a.month||0,d=a.week||a.isoWeek||0,r=a.day||0,_=a.hour||0,i=a.minute||0,o=a.second||0,m=a.millisecond||0;this._isValid=function(e){for(var a in e)if(-1===we.call(Oa,a)||null!=e[a]&&isNaN(e[a]))return!1;for(var t=!1,s=0;s<Oa.length;++s)if(e[Oa[s]]){if(t)return!1;parseFloat(e[Oa[s]])!==g(e[Oa[s]])&&(t=!0)}return!0}(a),this._milliseconds=+m+1e3*o+6e4*i+1e3*_*60*60,this._days=+r+7*d,this._months=+n+3*s+12*t,this._data={},this._locale=ma(),this._bubble()}function Wa(e){return e instanceof Pa}function Aa(e){return e<0?-1*Math.round(-1*e):Math.round(e)}function Ea(e,t){C(e,0,0,function(){var e=this.utcOffset(),a="+";return e<0&&(e=-e,a="-"),a+F(~~(e/60),2)+t+F(~~e%60,2)})}Ea("Z",":"),Ea("ZZ",""),ie("Z",de),ie("ZZ",de),le(["Z","ZZ"],function(e,a,t){t._useUTC=!0,t._tzm=za(de,e)});var Fa=/([\+\-]|\d\d)/gi;function za(e,a){var t=(a||"").match(e);if(null===t)return null;var s=((t[t.length-1]||[])+"").match(Fa)||["-",0,0],n=60*s[1]+g(s[2]);return 0===n?0:"+"===s[0]?n:-n}function Ja(e,a){var t,s;return a._isUTC?(t=a.clone(),s=(D(e)||u(e)?e.valueOf():Ha(e).valueOf())-t.valueOf(),t._d.setTime(t._d.valueOf()+s),l.updateOffset(t,!1),t):Ha(e).local()}function Na(e){return 15*-Math.round(e._d.getTimezoneOffset()/15)}function Ra(){return!!this.isValid()&&this._isUTC&&0===this._offset}l.updateOffset=function(){};var Ca=/^(\-|\+)?(?:(\d*)[. ])?(\d+)\:(\d+)(?:\:(\d+)(\.\d*)?)?$/,Ia=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;function Ua(e,a){var t,s,n,d=e,r=null;return Wa(e)?d={ms:e._milliseconds,d:e._days,M:e._months}:m(e)?(d={},a?d[a]=e:d.milliseconds=e):(r=Ca.exec(e))?(t="-"===r[1]?-1:1,d={y:0,d:g(r[ce])*t,h:g(r[Ye])*t,m:g(r[ye])*t,s:g(r[fe])*t,ms:g(Aa(1e3*r[ke]))*t}):(r=Ia.exec(e))?(t="-"===r[1]?-1:1,d={y:Ga(r[2],t),M:Ga(r[3],t),w:Ga(r[4],t),d:Ga(r[5],t),h:Ga(r[6],t),m:Ga(r[7],t),s:Ga(r[8],t)}):null==d?d={}:"object"==typeof d&&("from"in d||"to"in d)&&(n=function(e,a){var t;return e.isValid()&&a.isValid()?(a=Ja(a,e),e.isBefore(a)?t=Va(e,a):((t=Va(a,e)).milliseconds=-t.milliseconds,t.months=-t.months),t):{milliseconds:0,months:0}}(Ha(d.from),Ha(d.to)),(d={}).ms=n.milliseconds,d.M=n.months),s=new Pa(d),Wa(e)&&h(e,"_locale")&&(s._locale=e._locale),s}function Ga(e,a){var t=e&&parseFloat(e.replace(",","."));return(isNaN(t)?0:t)*a}function Va(e,a){var t={};return t.months=a.month()-e.month()+12*(a.year()-e.year()),e.clone().add(t.months,"M").isAfter(a)&&--t.months,t.milliseconds=a-e.clone().add(t.months,"M"),t}function Ka(s,n){return function(e,a){var t;return null===a||isNaN(+a)||(S(n,"moment()."+n+"(period, number) is deprecated. Please use moment()."+n+"(number, period). See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info."),t=e,e=a,a=t),Za(this,Ua(e="string"==typeof e?+e:e,a),s),this}}function Za(e,a,t,s){var n=a._milliseconds,d=Aa(a._days),r=Aa(a._months);e.isValid()&&(s=null==s||s,r&&We(e,He(e,"Month")+r*t),d&&be(e,"Date",He(e,"Date")+d*t),n&&e._d.setTime(e._d.valueOf()+n*t),s&&l.updateOffset(e,d||r))}Ua.fn=Pa.prototype,Ua.invalid=function(){return Ua(NaN)};var $a=Ka(1,"add"),Ba=Ka(-1,"subtract");function qa(e,a){var t=12*(a.year()-e.year())+(a.month()-e.month()),s=e.clone().add(t,"months");return-(t+(a-s<0?(a-s)/(s-e.clone().add(t-1,"months")):(a-s)/(e.clone().add(1+t,"months")-s)))||0}function Qa(e){var a;return void 0===e?this._locale._abbr:(null!=(a=ma(e))&&(this._locale=a),this)}l.defaultFormat="YYYY-MM-DDTHH:mm:ssZ",l.defaultFormatUtc="YYYY-MM-DDTHH:mm:ss[Z]";var Xa=t("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(e){return void 0===e?this.localeData():this.locale(e)});function et(){return this._locale}var at=126227808e5;function tt(e,a){return(e%a+a)%a}function st(e,a,t){return e<100&&0<=e?new Date(e+400,a,t)-at:new Date(e,a,t).valueOf()}function nt(e,a,t){return e<100&&0<=e?Date.UTC(e+400,a,t)-at:Date.UTC(e,a,t)}function dt(e,a){C(0,[e,e.length],0,a)}function rt(e,a,t,s,n){var d;return null==e?Ce(this,s,n).year:((d=Ie(e,s,n))<a&&(a=d),function(e,a,t,s,n){var d=Re(e,a,t,s,n),r=Je(d.year,0,d.dayOfYear);return this.year(r.getUTCFullYear()),this.month(r.getUTCMonth()),this.date(r.getUTCDate()),this}.call(this,e,a,t,s,n))}C(0,["gg",2],0,function(){return this.weekYear()%100}),C(0,["GG",2],0,function(){return this.isoWeekYear()%100}),dt("gggg","weekYear"),dt("ggggg","weekYear"),dt("GGGG","isoWeekYear"),dt("GGGGG","isoWeekYear"),O("weekYear","gg"),O("isoWeekYear","GG"),E("weekYear",1),E("isoWeekYear",1),ie("G",se),ie("g",se),ie("GG",B,V),ie("gg",B,V),ie("GGGG",ee,Z),ie("gggg",ee,Z),ie("GGGGG",ae,$),ie("ggggg",ae,$),Me(["gggg","ggggg","GGGG","GGGGG"],function(e,a,t,s){a[s.substr(0,2)]=g(e)}),Me(["gg","GG"],function(e,a,t,s){a[s]=l.parseTwoDigitYear(e)}),C("Q",0,"Qo","quarter"),O("quarter","Q"),E("quarter",7),ie("Q",G),le("Q",function(e,a){a[Le]=3*(g(e)-1)}),C("D",["DD",2],"Do","date"),O("date","D"),E("date",9),ie("D",B),ie("DD",B,V),ie("Do",function(e,a){return e?a._dayOfMonthOrdinalParse||a._ordinalParse:a._dayOfMonthOrdinalParseLenient}),le(["D","DD"],ce),le("Do",function(e,a){a[ce]=g(e.match(B)[0])});var _t=Se("Date",!0);C("DDD",["DDDD",3],"DDDo","dayOfYear"),O("dayOfYear","DDD"),E("dayOfYear",4),ie("DDD",X),ie("DDDD",K),le(["DDD","DDDD"],function(e,a,t){t._dayOfYear=g(e)}),C("m",["mm",2],0,"minute"),O("minute","m"),E("minute",14),ie("m",B),ie("mm",B,V),le(["m","mm"],ye);var it=Se("Minutes",!1);C("s",["ss",2],0,"second"),O("second","s"),E("second",15),ie("s",B),ie("ss",B,V),le(["s","ss"],fe);var ot,mt=Se("Seconds",!1);for(C("S",0,0,function(){return~~(this.millisecond()/100)}),C(0,["SS",2],0,function(){return~~(this.millisecond()/10)}),C(0,["SSS",3],0,"millisecond"),C(0,["SSSS",4],0,function(){return 10*this.millisecond()}),C(0,["SSSSS",5],0,function(){return 100*this.millisecond()}),C(0,["SSSSSS",6],0,function(){return 1e3*this.millisecond()}),C(0,["SSSSSSS",7],0,function(){return 1e4*this.millisecond()}),C(0,["SSSSSSSS",8],0,function(){return 1e5*this.millisecond()}),C(0,["SSSSSSSSS",9],0,function(){return 1e6*this.millisecond()}),O("millisecond","ms"),E("millisecond",16),ie("S",X,G),ie("SS",X,V),ie("SSS",X,K),ot="SSSS";ot.length<=9;ot+="S")ie(ot,te);function ut(e,a){a[ke]=g(1e3*("0."+e))}for(ot="S";ot.length<=9;ot+="S")le(ot,ut);var lt=Se("Milliseconds",!1);C("z",0,0,"zoneAbbr"),C("zz",0,0,"zoneName");var Mt=p.prototype;function ht(e){return e}Mt.add=$a,Mt.calendar=function(e,a){var t=e||Ha(),s=Ja(t,this).startOf("day"),n=l.calendarFormat(this,s)||"sameElse",d=a&&(H(a[n])?a[n].call(this,t):a[n]);return this.format(d||this.localeData().calendar(n,this,Ha(t)))},Mt.clone=function(){return new p(this)},Mt.diff=function(e,a,t){var s,n,d;if(!this.isValid())return NaN;if(!(s=Ja(e,this)).isValid())return NaN;switch(n=6e4*(s.utcOffset()-this.utcOffset()),a=P(a)){case"year":d=qa(this,s)/12;break;case"month":d=qa(this,s);break;case"quarter":d=qa(this,s)/3;break;case"second":d=(this-s)/1e3;break;case"minute":d=(this-s)/6e4;break;case"hour":d=(this-s)/36e5;break;case"day":d=(this-s-n)/864e5;break;case"week":d=(this-s-n)/6048e5;break;default:d=this-s}return t?d:T(d)},Mt.endOf=function(e){var a;if(void 0===(e=P(e))||"millisecond"===e||!this.isValid())return this;var t=this._isUTC?nt:st;switch(e){case"year":a=t(this.year()+1,0,1)-1;break;case"quarter":a=t(this.year(),this.month()-this.month()%3+3,1)-1;break;case"month":a=t(this.year(),this.month()+1,1)-1;break;case"week":a=t(this.year(),this.month(),this.date()-this.weekday()+7)-1;break;case"isoWeek":a=t(this.year(),this.month(),this.date()-(this.isoWeekday()-1)+7)-1;break;case"day":case"date":a=t(this.year(),this.month(),this.date()+1)-1;break;case"hour":a=this._d.valueOf(),a+=36e5-tt(a+(this._isUTC?0:6e4*this.utcOffset()),36e5)-1;break;case"minute":a=this._d.valueOf(),a+=6e4-tt(a,6e4)-1;break;case"second":a=this._d.valueOf(),a+=1e3-tt(a,1e3)-1}return this._d.setTime(a),l.updateOffset(this,!0),this},Mt.format=function(e){e=e||(this.isUtc()?l.defaultFormatUtc:l.defaultFormat);var a=I(this,e);return this.localeData().postformat(a)},Mt.from=function(e,a){return this.isValid()&&(D(e)&&e.isValid()||Ha(e).isValid())?Ua({to:this,from:e}).locale(this.locale()).humanize(!a):this.localeData().invalidDate()},Mt.fromNow=function(e){return this.from(Ha(),e)},Mt.to=function(e,a){return this.isValid()&&(D(e)&&e.isValid()||Ha(e).isValid())?Ua({from:this,to:e}).locale(this.locale()).humanize(!a):this.localeData().invalidDate()},Mt.toNow=function(e){return this.to(Ha(),e)},Mt.get=function(e){return H(this[e=P(e)])?this[e]():this},Mt.invalidAt=function(){return Y(this).overflow},Mt.isAfter=function(e,a){var t=D(e)?e:Ha(e);return!(!this.isValid()||!t.isValid())&&("millisecond"===(a=P(a)||"millisecond")?this.valueOf()>t.valueOf():t.valueOf()<this.clone().startOf(a).valueOf())},Mt.isBefore=function(e,a){var t=D(e)?e:Ha(e);return!(!this.isValid()||!t.isValid())&&("millisecond"===(a=P(a)||"millisecond")?this.valueOf()<t.valueOf():this.clone().endOf(a).valueOf()<t.valueOf())},Mt.isBetween=function(e,a,t,s){var n=D(e)?e:Ha(e),d=D(a)?a:Ha(a);return!!(this.isValid()&&n.isValid()&&d.isValid())&&("("===(s=s||"()")[0]?this.isAfter(n,t):!this.isBefore(n,t))&&(")"===s[1]?this.isBefore(d,t):!this.isAfter(d,t))},Mt.isSame=function(e,a){var t,s=D(e)?e:Ha(e);return!(!this.isValid()||!s.isValid())&&("millisecond"===(a=P(a)||"millisecond")?this.valueOf()===s.valueOf():(t=s.valueOf(),this.clone().startOf(a).valueOf()<=t&&t<=this.clone().endOf(a).valueOf()))},Mt.isSameOrAfter=function(e,a){return this.isSame(e,a)||this.isAfter(e,a)},Mt.isSameOrBefore=function(e,a){return this.isSame(e,a)||this.isBefore(e,a)},Mt.isValid=function(){return y(this)},Mt.lang=Xa,Mt.locale=Qa,Mt.localeData=et,Mt.max=ja,Mt.min=ba,Mt.parsingFlags=function(){return L({},Y(this))},Mt.set=function(e,a){if("object"==typeof e)for(var t=function(e){var a=[];for(var t in e)a.push({unit:t,priority:A[t]});return a.sort(function(e,a){return e.priority-a.priority}),a}(e=W(e)),s=0;s<t.length;s++)this[t[s].unit](e[t[s].unit]);else if(H(this[e=P(e)]))return this[e](a);return this},Mt.startOf=function(e){var a;if(void 0===(e=P(e))||"millisecond"===e||!this.isValid())return this;var t=this._isUTC?nt:st;switch(e){case"year":a=t(this.year(),0,1);break;case"quarter":a=t(this.year(),this.month()-this.month()%3,1);break;case"month":a=t(this.year(),this.month(),1);break;case"week":a=t(this.year(),this.month(),this.date()-this.weekday());break;case"isoWeek":a=t(this.year(),this.month(),this.date()-(this.isoWeekday()-1));break;case"day":case"date":a=t(this.year(),this.month(),this.date());break;case"hour":a=this._d.valueOf(),a-=tt(a+(this._isUTC?0:6e4*this.utcOffset()),36e5);break;case"minute":a=this._d.valueOf(),a-=tt(a,6e4);break;case"second":a=this._d.valueOf(),a-=tt(a,1e3)}return this._d.setTime(a),l.updateOffset(this,!0),this},Mt.subtract=Ba,Mt.toArray=function(){var e=this;return[e.year(),e.month(),e.date(),e.hour(),e.minute(),e.second(),e.millisecond()]},Mt.toObject=function(){var e=this;return{years:e.year(),months:e.month(),date:e.date(),hours:e.hours(),minutes:e.minutes(),seconds:e.seconds(),milliseconds:e.milliseconds()}},Mt.toDate=function(){return new Date(this.valueOf())},Mt.toISOString=function(e){if(!this.isValid())return null;var a=!0!==e,t=a?this.clone().utc():this;return t.year()<0||9999<t.year()?I(t,a?"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYYYY-MM-DD[T]HH:mm:ss.SSSZ"):H(Date.prototype.toISOString)?a?this.toDate().toISOString():new Date(this.valueOf()+60*this.utcOffset()*1e3).toISOString().replace("Z",I(t,"Z")):I(t,a?"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYY-MM-DD[T]HH:mm:ss.SSSZ")},Mt.inspect=function(){if(!this.isValid())return"moment.invalid(/* "+this._i+" */)";var e="moment",a="";this.isLocal()||(e=0===this.utcOffset()?"moment.utc":"moment.parseZone",a="Z");var t="["+e+'("]',s=0<=this.year()&&this.year()<=9999?"YYYY":"YYYYYY",n=a+'[")]';return this.format(t+s+"-MM-DD[T]HH:mm:ss.SSS"+n)},Mt.toJSON=function(){return this.isValid()?this.toISOString():null},Mt.toString=function(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")},Mt.unix=function(){return Math.floor(this.valueOf()/1e3)},Mt.valueOf=function(){return this._d.valueOf()-6e4*(this._offset||0)},Mt.creationData=function(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}},Mt.year=ve,Mt.isLeapYear=function(){return ge(this.year())},Mt.weekYear=function(e){return rt.call(this,e,this.week(),this.weekday(),this.localeData()._week.dow,this.localeData()._week.doy)},Mt.isoWeekYear=function(e){return rt.call(this,e,this.isoWeek(),this.isoWeekday(),1,4)},Mt.quarter=Mt.quarters=function(e){return null==e?Math.ceil((this.month()+1)/3):this.month(3*(e-1)+this.month()%3)},Mt.month=Ae,Mt.daysInMonth=function(){return je(this.year(),this.month())},Mt.week=Mt.weeks=function(e){var a=this.localeData().week(this);return null==e?a:this.add(7*(e-a),"d")},Mt.isoWeek=Mt.isoWeeks=function(e){var a=Ce(this,1,4).week;return null==e?a:this.add(7*(e-a),"d")},Mt.weeksInYear=function(){var e=this.localeData()._week;return Ie(this.year(),e.dow,e.doy)},Mt.isoWeeksInYear=function(){return Ie(this.year(),1,4)},Mt.date=_t,Mt.day=Mt.days=function(e){if(!this.isValid())return null!=e?this:NaN;var a,t,s=this._isUTC?this._d.getUTCDay():this._d.getDay();return null!=e?(a=e,t=this.localeData(),e="string"!=typeof a?a:isNaN(a)?"number"==typeof(a=t.weekdaysParse(a))?a:null:parseInt(a,10),this.add(e-s,"d")):s},Mt.weekday=function(e){if(!this.isValid())return null!=e?this:NaN;var a=(this.day()+7-this.localeData()._week.dow)%7;return null==e?a:this.add(e-a,"d")},Mt.isoWeekday=function(e){if(!this.isValid())return null!=e?this:NaN;if(null==e)return this.day()||7;var a,t,s=(a=e,t=this.localeData(),"string"==typeof a?t.weekdaysParse(a)%7||7:isNaN(a)?null:a);return this.day(this.day()%7?s:s-7)},Mt.dayOfYear=function(e){var a=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return null==e?a:this.add(e-a,"d")},Mt.hour=Mt.hours=ta,Mt.minute=Mt.minutes=it,Mt.second=Mt.seconds=mt,Mt.millisecond=Mt.milliseconds=lt,Mt.utcOffset=function(e,a,t){var s,n=this._offset||0;if(!this.isValid())return null!=e?this:NaN;if(null==e)return this._isUTC?n:Na(this);if("string"==typeof e){if(null===(e=za(de,e)))return this}else Math.abs(e)<16&&!t&&(e*=60);return!this._isUTC&&a&&(s=Na(this)),this._offset=e,this._isUTC=!0,null!=s&&this.add(s,"m"),n!==e&&(!a||this._changeInProgress?Za(this,Ua(e-n,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,l.updateOffset(this,!0),this._changeInProgress=null)),this},Mt.utc=function(e){return this.utcOffset(0,e)},Mt.local=function(e){return this._isUTC&&(this.utcOffset(0,e),this._isUTC=!1,e&&this.subtract(Na(this),"m")),this},Mt.parseZone=function(){if(null!=this._tzm)this.utcOffset(this._tzm,!1,!0);else if("string"==typeof this._i){var e=za(ne,this._i);null!=e?this.utcOffset(e):this.utcOffset(0,!0)}return this},Mt.hasAlignedHourOffset=function(e){return!!this.isValid()&&(e=e?Ha(e).utcOffset():0,(this.utcOffset()-e)%60==0)},Mt.isDST=function(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()},Mt.isLocal=function(){return!!this.isValid()&&!this._isUTC},Mt.isUtcOffset=function(){return!!this.isValid()&&this._isUTC},Mt.isUtc=Ra,Mt.isUTC=Ra,Mt.zoneAbbr=function(){return this._isUTC?"UTC":""},Mt.zoneName=function(){return this._isUTC?"Coordinated Universal Time":""},Mt.dates=t("dates accessor is deprecated. Use date instead.",_t),Mt.months=t("months accessor is deprecated. Use month instead",Ae),Mt.years=t("years accessor is deprecated. Use year instead",ve),Mt.zone=t("moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/",function(e,a){return null!=e?("string"!=typeof e&&(e=-e),this.utcOffset(e,a),this):-this.utcOffset()}),Mt.isDSTShifted=t("isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information",function(){if(!o(this._isDSTShifted))return this._isDSTShifted;var e={};if(k(e,this),(e=va(e))._a){var a=e._isUTC?c(e._a):Ha(e._a);this._isDSTShifted=this.isValid()&&0<r(e._a,a.toArray())}else this._isDSTShifted=!1;return this._isDSTShifted});var Lt=j.prototype;function ct(e,a,t,s){var n=ma(),d=c().set(s,a);return n[t](d,e)}function Yt(e,a,t){if(m(e)&&(a=e,e=void 0),e=e||"",null!=a)return ct(e,a,t,"month");var s,n=[];for(s=0;s<12;s++)n[s]=ct(e,s,t,"month");return n}function yt(e,a,t,s){"boolean"==typeof e?m(a)&&(t=a,a=void 0):(a=e,e=!1,m(t=a)&&(t=a,a=void 0)),a=a||"";var n,d=ma(),r=e?d._week.dow:0;if(null!=t)return ct(a,(t+r)%7,s,"day");var _=[];for(n=0;n<7;n++)_[n]=ct(a,(n+r)%7,s,"day");return _}Lt.calendar=function(e,a,t){var s=this._calendar[e]||this._calendar.sameElse;return H(s)?s.call(a,t):s},Lt.longDateFormat=function(e){var a=this._longDateFormat[e],t=this._longDateFormat[e.toUpperCase()];return a||!t?a:(this._longDateFormat[e]=t.replace(/MMMM|MM|DD|dddd/g,function(e){return e.slice(1)}),this._longDateFormat[e])},Lt.invalidDate=function(){return this._invalidDate},Lt.ordinal=function(e){return this._ordinal.replace("%d",e)},Lt.preparse=ht,Lt.postformat=ht,Lt.relativeTime=function(e,a,t,s){var n=this._relativeTime[t];return H(n)?n(e,a,t,s):n.replace(/%d/i,e)},Lt.pastFuture=function(e,a){var t=this._relativeTime[0<e?"future":"past"];return H(t)?t(a):t.replace(/%s/i,a)},Lt.set=function(e){var a,t;for(t in e)H(a=e[t])?this[t]=a:this["_"+t]=a;this._config=e,this._dayOfMonthOrdinalParseLenient=new RegExp((this._dayOfMonthOrdinalParse.source||this._ordinalParse.source)+"|"+/\d{1,2}/.source)},Lt.months=function(e,a){return e?_(this._months)?this._months[e.month()]:this._months[(this._months.isFormat||xe).test(a)?"format":"standalone"][e.month()]:_(this._months)?this._months:this._months.standalone},Lt.monthsShort=function(e,a){return e?_(this._monthsShort)?this._monthsShort[e.month()]:this._monthsShort[xe.test(a)?"format":"standalone"][e.month()]:_(this._monthsShort)?this._monthsShort:this._monthsShort.standalone},Lt.monthsParse=function(e,a,t){var s,n,d;if(this._monthsParseExact)return function(e,a,t){var s,n,d,r=e.toLocaleLowerCase();if(!this._monthsParse)for(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[],s=0;s<12;++s)d=c([2e3,s]),this._shortMonthsParse[s]=this.monthsShort(d,"").toLocaleLowerCase(),this._longMonthsParse[s]=this.months(d,"").toLocaleLowerCase();return t?"MMM"===a?-1!==(n=we.call(this._shortMonthsParse,r))?n:null:-1!==(n=we.call(this._longMonthsParse,r))?n:null:"MMM"===a?-1!==(n=we.call(this._shortMonthsParse,r))?n:-1!==(n=we.call(this._longMonthsParse,r))?n:null:-1!==(n=we.call(this._longMonthsParse,r))?n:-1!==(n=we.call(this._shortMonthsParse,r))?n:null}.call(this,e,a,t);for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),s=0;s<12;s++){if(n=c([2e3,s]),t&&!this._longMonthsParse[s]&&(this._longMonthsParse[s]=new RegExp("^"+this.months(n,"").replace(".","")+"$","i"),this._shortMonthsParse[s]=new RegExp("^"+this.monthsShort(n,"").replace(".","")+"$","i")),t||this._monthsParse[s]||(d="^"+this.months(n,"")+"|^"+this.monthsShort(n,""),this._monthsParse[s]=new RegExp(d.replace(".",""),"i")),t&&"MMMM"===a&&this._longMonthsParse[s].test(e))return s;if(t&&"MMM"===a&&this._shortMonthsParse[s].test(e))return s;if(!t&&this._monthsParse[s].test(e))return s}},Lt.monthsRegex=function(e){return this._monthsParseExact?(h(this,"_monthsRegex")||ze.call(this),e?this._monthsStrictRegex:this._monthsRegex):(h(this,"_monthsRegex")||(this._monthsRegex=Fe),this._monthsStrictRegex&&e?this._monthsStrictRegex:this._monthsRegex)},Lt.monthsShortRegex=function(e){return this._monthsParseExact?(h(this,"_monthsRegex")||ze.call(this),e?this._monthsShortStrictRegex:this._monthsShortRegex):(h(this,"_monthsShortRegex")||(this._monthsShortRegex=Ee),this._monthsShortStrictRegex&&e?this._monthsShortStrictRegex:this._monthsShortRegex)},Lt.week=function(e){return Ce(e,this._week.dow,this._week.doy).week},Lt.firstDayOfYear=function(){return this._week.doy},Lt.firstDayOfWeek=function(){return this._week.dow},Lt.weekdays=function(e,a){var t=_(this._weekdays)?this._weekdays:this._weekdays[e&&!0!==e&&this._weekdays.isFormat.test(a)?"format":"standalone"];return!0===e?Ue(t,this._week.dow):e?t[e.day()]:t},Lt.weekdaysMin=function(e){return!0===e?Ue(this._weekdaysMin,this._week.dow):e?this._weekdaysMin[e.day()]:this._weekdaysMin},Lt.weekdaysShort=function(e){return!0===e?Ue(this._weekdaysShort,this._week.dow):e?this._weekdaysShort[e.day()]:this._weekdaysShort},Lt.weekdaysParse=function(e,a,t){var s,n,d;if(this._weekdaysParseExact)return function(e,a,t){var s,n,d,r=e.toLocaleLowerCase();if(!this._weekdaysParse)for(this._weekdaysParse=[],this._shortWeekdaysParse=[],this._minWeekdaysParse=[],s=0;s<7;++s)d=c([2e3,1]).day(s),this._minWeekdaysParse[s]=this.weekdaysMin(d,"").toLocaleLowerCase(),this._shortWeekdaysParse[s]=this.weekdaysShort(d,"").toLocaleLowerCase(),this._weekdaysParse[s]=this.weekdays(d,"").toLocaleLowerCase();return t?"dddd"===a?-1!==(n=we.call(this._weekdaysParse,r))?n:null:"ddd"===a?-1!==(n=we.call(this._shortWeekdaysParse,r))?n:null:-1!==(n=we.call(this._minWeekdaysParse,r))?n:null:"dddd"===a?-1!==(n=we.call(this._weekdaysParse,r))?n:-1!==(n=we.call(this._shortWeekdaysParse,r))?n:-1!==(n=we.call(this._minWeekdaysParse,r))?n:null:"ddd"===a?-1!==(n=we.call(this._shortWeekdaysParse,r))?n:-1!==(n=we.call(this._weekdaysParse,r))?n:-1!==(n=we.call(this._minWeekdaysParse,r))?n:null:-1!==(n=we.call(this._minWeekdaysParse,r))?n:-1!==(n=we.call(this._weekdaysParse,r))?n:-1!==(n=we.call(this._shortWeekdaysParse,r))?n:null}.call(this,e,a,t);for(this._weekdaysParse||(this._weekdaysParse=[],this._minWeekdaysParse=[],this._shortWeekdaysParse=[],this._fullWeekdaysParse=[]),s=0;s<7;s++){if(n=c([2e3,1]).day(s),t&&!this._fullWeekdaysParse[s]&&(this._fullWeekdaysParse[s]=new RegExp("^"+this.weekdays(n,"").replace(".","\\.?")+"$","i"),this._shortWeekdaysParse[s]=new RegExp("^"+this.weekdaysShort(n,"").replace(".","\\.?")+"$","i"),this._minWeekdaysParse[s]=new RegExp("^"+this.weekdaysMin(n,"").replace(".","\\.?")+"$","i")),this._weekdaysParse[s]||(d="^"+this.weekdays(n,"")+"|^"+this.weekdaysShort(n,"")+"|^"+this.weekdaysMin(n,""),this._weekdaysParse[s]=new RegExp(d.replace(".",""),"i")),t&&"dddd"===a&&this._fullWeekdaysParse[s].test(e))return s;if(t&&"ddd"===a&&this._shortWeekdaysParse[s].test(e))return s;if(t&&"dd"===a&&this._minWeekdaysParse[s].test(e))return s;if(!t&&this._weekdaysParse[s].test(e))return s}},Lt.weekdaysRegex=function(e){return this._weekdaysParseExact?(h(this,"_weekdaysRegex")||qe.call(this),e?this._weekdaysStrictRegex:this._weekdaysRegex):(h(this,"_weekdaysRegex")||(this._weekdaysRegex=Ze),this._weekdaysStrictRegex&&e?this._weekdaysStrictRegex:this._weekdaysRegex)},Lt.weekdaysShortRegex=function(e){return this._weekdaysParseExact?(h(this,"_weekdaysRegex")||qe.call(this),e?this._weekdaysShortStrictRegex:this._weekdaysShortRegex):(h(this,"_weekdaysShortRegex")||(this._weekdaysShortRegex=$e),this._weekdaysShortStrictRegex&&e?this._weekdaysShortStrictRegex:this._weekdaysShortRegex)},Lt.weekdaysMinRegex=function(e){return this._weekdaysParseExact?(h(this,"_weekdaysRegex")||qe.call(this),e?this._weekdaysMinStrictRegex:this._weekdaysMinRegex):(h(this,"_weekdaysMinRegex")||(this._weekdaysMinRegex=Be),this._weekdaysMinStrictRegex&&e?this._weekdaysMinStrictRegex:this._weekdaysMinRegex)},Lt.isPM=function(e){return"p"===(e+"").toLowerCase().charAt(0)},Lt.meridiem=function(e,a,t){return 11<e?t?"pm":"PM":t?"am":"AM"},ia("en",{dayOfMonthOrdinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(e){var a=e%10;return e+(1===g(e%100/10)?"th":1==a?"st":2==a?"nd":3==a?"rd":"th")}}),l.lang=t("moment.lang is deprecated. Use moment.locale instead.",ia),l.langData=t("moment.langData is deprecated. Use moment.localeData instead.",ma);var ft=Math.abs;function kt(e,a,t,s){var n=Ua(a,t);return e._milliseconds+=s*n._milliseconds,e._days+=s*n._days,e._months+=s*n._months,e._bubble()}function pt(e){return e<0?Math.floor(e):Math.ceil(e)}function Dt(e){return 4800*e/146097}function Tt(e){return 146097*e/4800}function gt(e){return function(){return this.as(e)}}var wt=gt("ms"),vt=gt("s"),St=gt("m"),Ht=gt("h"),bt=gt("d"),jt=gt("w"),xt=gt("M"),Ot=gt("Q"),Pt=gt("y");function Wt(e){return function(){return this.isValid()?this._data[e]:NaN}}var At=Wt("milliseconds"),Et=Wt("seconds"),Ft=Wt("minutes"),zt=Wt("hours"),Jt=Wt("days"),Nt=Wt("months"),Rt=Wt("years"),Ct=Math.round,It={ss:44,s:45,m:45,h:22,d:26,M:11},Ut=Math.abs;function Gt(e){return(0<e)-(e<0)||+e}function Vt(){if(!this.isValid())return this.localeData().invalidDate();var e,a,t=Ut(this._milliseconds)/1e3,s=Ut(this._days),n=Ut(this._months);a=T((e=T(t/60))/60),t%=60,e%=60;var d=T(n/12),r=n%=12,_=s,i=a,o=e,m=t?t.toFixed(3).replace(/\.?0+$/,""):"",u=this.asSeconds();if(!u)return"P0D";var l=u<0?"-":"",M=Gt(this._months)!==Gt(u)?"-":"",h=Gt(this._days)!==Gt(u)?"-":"",L=Gt(this._milliseconds)!==Gt(u)?"-":"";return l+"P"+(d?M+d+"Y":"")+(r?M+r+"M":"")+(_?h+_+"D":"")+(i||o||m?"T":"")+(i?L+i+"H":"")+(o?L+o+"M":"")+(m?L+m+"S":"")}var Kt=Pa.prototype;Kt.isValid=function(){return this._isValid},Kt.abs=function(){var e=this._data;return this._milliseconds=ft(this._milliseconds),this._days=ft(this._days),this._months=ft(this._months),e.milliseconds=ft(e.milliseconds),e.seconds=ft(e.seconds),e.minutes=ft(e.minutes),e.hours=ft(e.hours),e.months=ft(e.months),e.years=ft(e.years),this},Kt.add=function(e,a){return kt(this,e,a,1)},Kt.subtract=function(e,a){return kt(this,e,a,-1)},Kt.as=function(e){if(!this.isValid())return NaN;var a,t,s=this._milliseconds;if("month"===(e=P(e))||"quarter"===e||"year"===e)switch(a=this._days+s/864e5,t=this._months+Dt(a),e){case"month":return t;case"quarter":return t/3;case"year":return t/12}else switch(a=this._days+Math.round(Tt(this._months)),e){case"week":return a/7+s/6048e5;case"day":return a+s/864e5;case"hour":return 24*a+s/36e5;case"minute":return 1440*a+s/6e4;case"second":return 86400*a+s/1e3;case"millisecond":return Math.floor(864e5*a)+s;default:throw new Error("Unknown unit "+e)}},Kt.asMilliseconds=wt,Kt.asSeconds=vt,Kt.asMinutes=St,Kt.asHours=Ht,Kt.asDays=bt,Kt.asWeeks=jt,Kt.asMonths=xt,Kt.asQuarters=Ot,Kt.asYears=Pt,Kt.valueOf=function(){return this.isValid()?this._milliseconds+864e5*this._days+this._months%12*2592e6+31536e6*g(this._months/12):NaN},Kt._bubble=function(){var e,a,t,s,n,d=this._milliseconds,r=this._days,_=this._months,i=this._data;return 0<=d&&0<=r&&0<=_||d<=0&&r<=0&&_<=0||(d+=864e5*pt(Tt(_)+r),_=r=0),i.milliseconds=d%1e3,e=T(d/1e3),i.seconds=e%60,a=T(e/60),i.minutes=a%60,t=T(a/60),i.hours=t%24,_+=n=T(Dt(r+=T(t/24))),r-=pt(Tt(n)),s=T(_/12),_%=12,i.days=r,i.months=_,i.years=s,this},Kt.clone=function(){return Ua(this)},Kt.get=function(e){return e=P(e),this.isValid()?this[e+"s"]():NaN},Kt.milliseconds=At,Kt.seconds=Et,Kt.minutes=Ft,Kt.hours=zt,Kt.days=Jt,Kt.weeks=function(){return T(this.days()/7)},Kt.months=Nt,Kt.years=Rt,Kt.humanize=function(e){if(!this.isValid())return this.localeData().invalidDate();var t,s,n,d,r,_,i,o,m,u,l=this.localeData(),M=(t=!e,s=l,n=Ua(this).abs(),d=Ct(n.as("s")),r=Ct(n.as("m")),_=Ct(n.as("h")),i=Ct(n.as("d")),o=Ct(n.as("M")),m=Ct(n.as("y")),(u=d<=It.ss&&["s",d]||d<It.s&&["ss",d]||r<=1&&["m"]||r<It.m&&["mm",r]||_<=1&&["h"]||_<It.h&&["hh",_]||i<=1&&["d"]||i<It.d&&["dd",i]||o<=1&&["M"]||o<It.M&&["MM",o]||m<=1&&["y"]||["yy",m])[2]=t,u[3]=0<+this,u[4]=s,function(e,a,t,s,n){return n.relativeTime(a||1,!!t,e,s)}.apply(null,u));return e&&(M=l.pastFuture(+this,M)),l.postformat(M)},Kt.toISOString=Vt,Kt.toString=Vt,Kt.toJSON=Vt,Kt.locale=Qa,Kt.localeData=et,Kt.toIsoString=t("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",Vt),Kt.lang=Xa,C("X",0,0,"unix"),C("x",0,0,"valueOf"),ie("x",se),ie("X",/[+-]?\d+(\.\d{1,3})?/),le("X",function(e,a,t){t._d=new Date(1e3*parseFloat(e,10))}),le("x",function(e,a,t){t._d=new Date(g(e))}),l.version="2.24.0",e=Ha,l.fn=Mt,l.min=function(){return xa("isBefore",[].slice.call(arguments,0))},l.max=function(){return xa("isAfter",[].slice.call(arguments,0))},l.now=function(){return Date.now?Date.now():+new Date},l.utc=c,l.unix=function(e){return Ha(1e3*e)},l.months=function(e,a){return Yt(e,a,"months")},l.isDate=u,l.locale=ia,l.invalid=f,l.duration=Ua,l.isMoment=D,l.weekdays=function(e,a,t){return yt(e,a,t,"weekdays")},l.parseZone=function(){return Ha.apply(null,arguments).parseZone()},l.localeData=ma,l.isDuration=Wa,l.monthsShort=function(e,a){return Yt(e,a,"monthsShort")},l.weekdaysMin=function(e,a,t){return yt(e,a,t,"weekdaysMin")},l.defineLocale=oa,l.updateLocale=function(e,a){if(null!=a){var t,s,n=sa;null!=(s=_a(e))&&(n=s._config),(t=new j(a=b(n,a))).parentLocale=na[e],na[e]=t,ia(e)}else null!=na[e]&&(null!=na[e].parentLocale?na[e]=na[e].parentLocale:null!=na[e]&&delete na[e]);return na[e]},l.locales=function(){return s(na)},l.weekdaysShort=function(e,a,t){return yt(e,a,t,"weekdaysShort")},l.normalizeUnits=P,l.relativeTimeRounding=function(e){return void 0===e?Ct:"function"==typeof e&&(Ct=e,!0)},l.relativeTimeThreshold=function(e,a){return void 0!==It[e]&&(void 0===a?It[e]:(It[e]=a,"s"===e&&(It.ss=a-1),!0))},l.calendarFormat=function(e,a){var t=e.diff(a,"days",!0);return t<-6?"sameElse":t<-1?"lastWeek":t<0?"lastDay":t<1?"sameDay":t<2?"nextDay":t<7?"nextWeek":"sameElse"},l.prototype=Mt,l.HTML5_FMT={DATETIME_LOCAL:"YYYY-MM-DDTHH:mm",DATETIME_LOCAL_SECONDS:"YYYY-MM-DDTHH:mm:ss",DATETIME_LOCAL_MS:"YYYY-MM-DDTHH:mm:ss.SSS",DATE:"YYYY-MM-DD",TIME:"HH:mm",TIME_SECONDS:"HH:mm:ss",TIME_MS:"HH:mm:ss.SSS",WEEK:"GGGG-[W]WW",MONTH:"YYYY-MM"},l.defineLocale("af",{months:"Januarie_Februarie_Maart_April_Mei_Junie_Julie_Augustus_September_Oktober_November_Desember".split("_"),monthsShort:"Jan_Feb_Mrt_Apr_Mei_Jun_Jul_Aug_Sep_Okt_Nov_Des".split("_"),weekdays:"Sondag_Maandag_Dinsdag_Woensdag_Donderdag_Vrydag_Saterdag".split("_"),weekdaysShort:"Son_Maa_Din_Woe_Don_Vry_Sat".split("_"),weekdaysMin:"So_Ma_Di_Wo_Do_Vr_Sa".split("_"),meridiemParse:/vm|nm/i,isPM:function(e){return/^nm$/i.test(e)},meridiem:function(e,a,t){return e<12?t?"vm":"VM":t?"nm":"NM"},longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd, D MMMM YYYY HH:mm"},calendar:{sameDay:"[Vandag om] LT",nextDay:"[Mre om] LT",nextWeek:"dddd [om] LT",lastDay:"[Gister om] LT",lastWeek:"[Laas] dddd [om] LT",sameElse:"L"},relativeTime:{future:"oor %s",past:"%s gelede",s:"'n paar sekondes",ss:"%d sekondes",m:"'n minuut",mm:"%d minute",h:"'n uur",hh:"%d ure",d:"'n dag",dd:"%d dae",M:"'n maand",MM:"%d maande",y:"'n jaar",yy:"%d jaar"},dayOfMonthOrdinalParse:/\d{1,2}(ste|de)/,ordinal:function(e){return e+(1===e||8===e||20<=e?"ste":"de")},week:{dow:1,doy:4}}),l.defineLocale("ar-dz",{months:"___________".split("_"),monthsShort:"___________".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd D MMMM YYYY HH:mm"},calendar:{sameDay:"[  ] LT",nextDay:"[  ] LT",nextWeek:"dddd [ ] LT",lastDay:"[  ] LT",lastWeek:"dddd [ ] LT",sameElse:"L"},relativeTime:{future:" %s",past:" %s",s:"",ss:"%d ",m:"",mm:"%d ",h:"",hh:"%d ",d:"",dd:"%d ",M:"",MM:"%d ",y:"",yy:"%d "},week:{dow:0,doy:4}}),l.defineLocale("ar-kw",{months:"___________".split("_"),monthsShort:"___________".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd D MMMM YYYY HH:mm"},calendar:{sameDay:"[  ] LT",nextDay:"[  ] LT",nextWeek:"dddd [ ] LT",lastDay:"[  ] LT",lastWeek:"dddd [ ] LT",sameElse:"L"},relativeTime:{future:" %s",past:" %s",s:"",ss:"%d ",m:"",mm:"%d ",h:"",hh:"%d ",d:"",dd:"%d ",M:"",MM:"%d ",y:"",yy:"%d "},week:{dow:0,doy:12}});function $t(e){return 0===e?0:1===e?1:2===e?2:3<=e%100&&e%100<=10?3:11<=e%100?4:5}function qt(r){return function(e,a,t,s){var n=$t(e),d=Bt[r][$t(e)];return 2===n&&(d=d[a?0:1]),d.replace(/%d/i,e)}}var Zt={1:"1",2:"2",3:"3",4:"4",5:"5",6:"6",7:"7",8:"8",9:"9",0:"0"},Bt={s:["  "," ",["",""],"%d ","%d ","%d "],m:["  "," ",["",""],"%d ","%d ","%d "],h:["  "," ",["",""],"%d ","%d ","%d "],d:["  "," ",["",""],"%d ","%d ","%d "],M:["  "," ",["",""],"%d ","%d ","%d "],y:["  "," ",["",""],"%d ","%d ","%d "]},Qt=["","","","","","","","","","","",""];l.defineLocale("ar-ly",{months:Qt,monthsShort:Qt,weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"D/M/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd D MMMM YYYY HH:mm"},meridiemParse:/\u0635|\u0645/,isPM:function(e){return""===e},meridiem:function(e,a,t){return e<12?"":""},calendar:{sameDay:"[  ] LT",nextDay:"[  ] LT",nextWeek:"dddd [ ] LT",lastDay:"[  ] LT",lastWeek:"dddd [ ] LT",sameElse:"L"},relativeTime:{future:" %s",past:" %s",s:qt("s"),ss:qt("s"),m:qt("m"),mm:qt("m"),h:qt("h"),hh:qt("h"),d:qt("d"),dd:qt("d"),M:qt("M"),MM:qt("M"),y:qt("y"),yy:qt("y")},preparse:function(e){return e.replace(/\u060c/g,",")},postformat:function(e){return e.replace(/\d/g,function(e){return Zt[e]}).replace(/,/g,"")},week:{dow:6,doy:12}}),l.defineLocale("ar-ma",{months:"___________".split("_"),monthsShort:"___________".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd D MMMM YYYY HH:mm"},calendar:{sameDay:"[  ] LT",nextDay:"[  ] LT",nextWeek:"dddd [ ] LT",lastDay:"[  ] LT",lastWeek:"dddd [ ] LT",sameElse:"L"},relativeTime:{future:" %s",past:" %s",s:"",ss:"%d ",m:"",mm:"%d ",h:"",hh:"%d ",d:"",dd:"%d ",M:"",MM:"%d ",y:"",yy:"%d "},week:{dow:6,doy:12}});var Xt={1:"",2:"",3:"",4:"",5:"",6:"",7:"",8:"",9:"",0:""},es={"":"1","":"2","":"3","":"4","":"5","":"6","":"7","":"8","":"9","":"0"};l.defineLocale("ar-sa",{months:"___________".split("_"),monthsShort:"___________".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd D MMMM YYYY HH:mm"},meridiemParse:/\u0635|\u0645/,isPM:function(e){return""===e},meridiem:function(e,a,t){return e<12?"":""},calendar:{sameDay:"[  ] LT",nextDay:"[  ] LT",nextWeek:"dddd [ ] LT",lastDay:"[  ] LT",lastWeek:"dddd [ ] LT",sameElse:"L"},relativeTime:{future:" %s",past:" %s",s:"",ss:"%d ",m:"",mm:"%d ",h:"",hh:"%d ",d:"",dd:"%d ",M:"",MM:"%d ",y:"",yy:"%d "},preparse:function(e){return e.replace(/[\u0661\u0662\u0663\u0664\u0665\u0666\u0667\u0668\u0669\u0660]/g,function(e){return es[e]}).replace(/\u060c/g,",")},postformat:function(e){return e.replace(/\d/g,function(e){return Xt[e]}).replace(/,/g,"")},week:{dow:0,doy:6}}),l.defineLocale("ar-tn",{months:"___________".split("_"),monthsShort:"___________".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd D MMMM YYYY HH:mm"},calendar:{sameDay:"[  ] LT",nextDay:"[  ] LT",nextWeek:"dddd [ ] LT",lastDay:"[  ] LT",lastWeek:"dddd [ ] LT",sameElse:"L"},relativeTime:{future:" %s",past:" %s",s:"",ss:"%d ",m:"",mm:"%d ",h:"",hh:"%d ",d:"",dd:"%d ",M:"",MM:"%d ",y:"",yy:"%d "},week:{dow:1,doy:4}});function ss(e){return 0===e?0:1===e?1:2===e?2:3<=e%100&&e%100<=10?3:11<=e%100?4:5}function ds(r){return function(e,a,t,s){var n=ss(e),d=ns[r][ss(e)];return 2===n&&(d=d[a?0:1]),d.replace(/%d/i,e)}}var as={1:"",2:"",3:"",4:"",5:"",6:"",7:"",8:"",9:"",0:""},ts={"":"1","":"2","":"3","":"4","":"5","":"6","":"7","":"8","":"9","":"0"},ns={s:["  "," ",["",""],"%d ","%d ","%d "],m:["  "," ",["",""],"%d ","%d ","%d "],h:["  "," ",["",""],"%d ","%d ","%d "],d:["  "," ",["",""],"%d ","%d ","%d "],M:["  "," ",["",""],"%d ","%d ","%d "],y:["  "," ",["",""],"%d ","%d ","%d "]},rs=["","","","","","","","","","","",""];l.defineLocale("ar",{months:rs,monthsShort:rs,weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"D/M/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd D MMMM YYYY HH:mm"},meridiemParse:/\u0635|\u0645/,isPM:function(e){return""===e},meridiem:function(e,a,t){return e<12?"":""},calendar:{sameDay:"[  ] LT",nextDay:"[  ] LT",nextWeek:"dddd [ ] LT",lastDay:"[  ] LT",lastWeek:"dddd [ ] LT",sameElse:"L"},relativeTime:{future:" %s",past:" %s",s:ds("s"),ss:ds("s"),m:ds("m"),mm:ds("m"),h:ds("h"),hh:ds("h"),d:ds("d"),dd:ds("d"),M:ds("M"),MM:ds("M"),y:ds("y"),yy:ds("y")},preparse:function(e){return e.replace(/[\u0661\u0662\u0663\u0664\u0665\u0666\u0667\u0668\u0669\u0660]/g,function(e){return ts[e]}).replace(/\u060c/g,",")},postformat:function(e){return e.replace(/\d/g,function(e){return as[e]}).replace(/,/g,"")},week:{dow:6,doy:12}});var _s={1:"-inci",5:"-inci",8:"-inci",70:"-inci",80:"-inci",2:"-nci",7:"-nci",20:"-nci",50:"-nci",3:"-nc",4:"-nc",100:"-nc",6:"-nc",9:"-uncu",10:"-uncu",30:"-uncu",60:"-nc",90:"-nc"};function is(e,a,t){var s,n;return"m"===t?a?"":"":"h"===t?a?"":"":e+" "+(s=+e,n={ss:a?"__":"__",mm:a?"__":"__",hh:a?"__":"__",dd:"__",MM:"__",yy:"__"}[t].split("_"),s%10==1&&s%100!=11?n[0]:2<=s%10&&s%10<=4&&(s%100<10||20<=s%100)?n[1]:n[2])}l.defineLocale("az",{months:"yanvar_fevral_mart_aprel_may_iyun_iyul_avqust_sentyabr_oktyabr_noyabr_dekabr".split("_"),monthsShort:"yan_fev_mar_apr_may_iyn_iyl_avq_sen_okt_noy_dek".split("_"),weekdays:"Bazar_Bazar ertsi_rnb axam_rnb_Cm axam_Cm_nb".split("_"),weekdaysShort:"Baz_BzE_Ax_r_CAx_Cm_n".split("_"),weekdaysMin:"Bz_BE_A__CA_C_".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD.MM.YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd, D MMMM YYYY HH:mm"},calendar:{sameDay:"[bugn saat] LT",nextDay:"[sabah saat] LT",nextWeek:"[gln hft] dddd [saat] LT",lastDay:"[dnn] LT",lastWeek:"[ken hft] dddd [saat] LT",sameElse:"L"},relativeTime:{future:"%s sonra",past:"%s vvl",s:"birne saniy",ss:"%d saniy",m:"bir dqiq",mm:"%d dqiq",h:"bir saat",hh:"%d saat",d:"bir gn",dd:"%d gn",M:"bir ay",MM:"%d ay",y:"bir il",yy:"%d il"},meridiemParse:/gec\u0259|s\u0259h\u0259r|g\xfcnd\xfcz|ax\u015fam/,isPM:function(e){return/^(g\xfcnd\xfcz|ax\u015fam)$/.test(e)},meridiem:function(e,a,t){return e<4?"gec":e<12?"shr":e<17?"gndz":"axam"},dayOfMonthOrdinalParse:/\d{1,2}-(\u0131nc\u0131|inci|nci|\xfcnc\xfc|nc\u0131|uncu)/,ordinal:function(e){if(0===e)return e+"-nc";var a=e%10;return e+(_s[a]||_s[e%100-a]||_s[100<=e?100:null])},week:{dow:1,doy:7}}),l.defineLocale("be",{months:{format:"___________".split("_"),standalone:"___________".split("_")},monthsShort:"___________".split("_"),weekdays:{format:"______".split("_"),standalone:"______".split("_"),isFormat:/\[ ?[\u0423\u0443\u045e] ?(?:\u043c\u0456\u043d\u0443\u043b\u0443\u044e|\u043d\u0430\u0441\u0442\u0443\u043f\u043d\u0443\u044e)? ?\] ?dddd/},weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD.MM.YYYY",LL:"D MMMM YYYY .",LLL:"D MMMM YYYY ., HH:mm",LLLL:"dddd, D MMMM YYYY ., HH:mm"},calendar:{sameDay:"[ ] LT",nextDay:"[ ] LT",lastDay:"[ ] LT",nextWeek:function(){return"[] dddd [] LT"},lastWeek:function(){switch(this.day()){case 0:case 3:case 5:case 6:return"[ ] dddd [] LT";case 1:case 2:case 4:return"[ ] dddd [] LT"}},sameElse:"L"},relativeTime:{future:" %s",past:"%s ",s:" ",m:is,mm:is,h:is,hh:is,d:"",dd:is,M:"",MM:is,y:"",yy:is},meridiemParse:/\u043d\u043e\u0447\u044b|\u0440\u0430\u043d\u0456\u0446\u044b|\u0434\u043d\u044f|\u0432\u0435\u0447\u0430\u0440\u0430/,isPM:function(e){return/^(\u0434\u043d\u044f|\u0432\u0435\u0447\u0430\u0440\u0430)$/.test(e)},meridiem:function(e,a,t){return e<4?"":e<12?"":e<17?"":""},dayOfMonthOrdinalParse:/\d{1,2}-(\u0456|\u044b|\u0433\u0430)/,ordinal:function(e,a){switch(a){case"M":case"d":case"DDD":case"w":case"W":return e%10!=2&&e%10!=3||e%100==12||e%100==13?e+"-":e+"-";case"D":return e+"-";default:return e}},week:{dow:1,doy:7}}),l.defineLocale("bg",{months:"___________".split("_"),monthsShort:"___________".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"H:mm",LTS:"H:mm:ss",L:"D.MM.YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY H:mm",LLLL:"dddd, D MMMM YYYY H:mm"},calendar:{sameDay:"[ ] LT",nextDay:"[ ] LT",nextWeek:"dddd [] LT",lastDay:"[ ] LT",lastWeek:function(){switch(this.day()){case 0:case 3:case 6:return"[ ] dddd [] LT";case 1:case 2:case 4:case 5:return"[ ] dddd [] LT"}},sameElse:"L"},relativeTime:{future:" %s",past:" %s",s:" ",ss:"%d ",m:"",mm:"%d ",h:"",hh:"%d ",d:"",dd:"%d ",M:"",MM:"%d ",y:"",yy:"%d "},dayOfMonthOrdinalParse:/\d{1,2}-(\u0435\u0432|\u0435\u043d|\u0442\u0438|\u0432\u0438|\u0440\u0438|\u043c\u0438)/,ordinal:function(e){var a=e%10,t=e%100;return 0===e?e+"-":0==t?e+"-":10<t&&t<20?e+"-":1==a?e+"-":2==a?e+"-":7==a||8==a?e+"-":e+"-"},week:{dow:1,doy:7}}),l.defineLocale("bm",{months:"Zanwuyekalo_Fewuruyekalo_Marisikalo_Awirilikalo_Mkalo_Zuwnkalo_Zuluyekalo_Utikalo_Stanburukalo_kutburukalo_Nowanburukalo_Desanburukalo".split("_"),monthsShort:"Zan_Few_Mar_Awi_M_Zuw_Zul_Uti_St_ku_Now_Des".split("_"),weekdays:"Kari_Ntnn_Tarata_Araba_Alamisa_Juma_Sibiri".split("_"),weekdaysShort:"Kar_Nt_Tar_Ara_Ala_Jum_Sib".split("_"),weekdaysMin:"Ka_Nt_Ta_Ar_Al_Ju_Si".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"MMMM [tile] D [san] YYYY",LLL:"MMMM [tile] D [san] YYYY [lr] HH:mm",LLLL:"dddd MMMM [tile] D [san] YYYY [lr] HH:mm"},calendar:{sameDay:"[Bi lr] LT",nextDay:"[Sini lr] LT",nextWeek:"dddd [don lr] LT",lastDay:"[Kunu lr] LT",lastWeek:"dddd [tmnen lr] LT",sameElse:"L"},relativeTime:{future:"%s kn",past:"a b %s b",s:"sanga dama dama",ss:"sekondi %d",m:"miniti kelen",mm:"miniti %d",h:"lr kelen",hh:"lr %d",d:"tile kelen",dd:"tile %d",M:"kalo kelen",MM:"kalo %d",y:"san kelen",yy:"san %d"},week:{dow:1,doy:4}});var os={1:"",2:"",3:"",4:"",5:"",6:"",7:"",8:"",9:"",0:""},ms={"":"1","":"2","":"3","":"4","":"5","":"6","":"7","":"8","":"9","":"0"};l.defineLocale("bn",{months:"___________".split("_"),monthsShort:"___________".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"A h:mm ",LTS:"A h:mm:ss ",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY, A h:mm ",LLLL:"dddd, D MMMM YYYY, A h:mm "},calendar:{sameDay:"[] LT",nextDay:"[] LT",nextWeek:"dddd, LT",lastDay:"[] LT",lastWeek:"[] dddd, LT",sameElse:"L"},relativeTime:{future:"%s ",past:"%s ",s:" ",ss:"%d ",m:" ",mm:"%d ",h:" ",hh:"%d ",d:" ",dd:"%d ",M:" ",MM:"%d ",y:" ",yy:"%d "},preparse:function(e){return e.replace(/[\u09e7\u09e8\u09e9\u09ea\u09eb\u09ec\u09ed\u09ee\u09ef\u09e6]/g,function(e){return ms[e]})},postformat:function(e){return e.replace(/\d/g,function(e){return os[e]})},meridiemParse:/\u09b0\u09be\u09a4|\u09b8\u0995\u09be\u09b2|\u09a6\u09c1\u09aa\u09c1\u09b0|\u09ac\u09bf\u0995\u09be\u09b2|\u09b0\u09be\u09a4/,meridiemHour:function(e,a){return 12===e&&(e=0),""===a&&4<=e||""===a&&e<5||""===a?e+12:e},meridiem:function(e,a,t){return e<4?"":e<10?"":e<17?"":e<20?"":""},week:{dow:0,doy:6}});var us={1:"",2:"",3:"",4:"",5:"",6:"",7:"",8:"",9:"",0:""},ls={"":"1","":"2","":"3","":"4","":"5","":"6","":"7","":"8","":"9","":"0"};function Ms(e,a,t){var s,n,d;return e+" "+(s={mm:"munutenn",MM:"miz",dd:"devezh"}[t],2!==e?s:void 0!==(d={m:"v",b:"v",d:"z"})[(n=s).charAt(0)]?d[n.charAt(0)]+n.substring(1):n)}function hs(e,a,t){var s=e+" ";switch(t){case"ss":return s+(1===e?"sekunda":2===e||3===e||4===e?"sekunde":"sekundi");case"m":return a?"jedna minuta":"jedne minute";case"mm":return s+(1===e?"minuta":2===e||3===e||4===e?"minute":"minuta");case"h":return a?"jedan sat":"jednog sata";case"hh":return s+(1===e?"sat":2===e||3===e||4===e?"sata":"sati");case"dd":return s+(1===e?"dan":"dana");case"MM":return s+(1===e?"mjesec":2===e||3===e||4===e?"mjeseca":"mjeseci");case"yy":return s+(1===e?"godina":2===e||3===e||4===e?"godine":"godina")}}l.defineLocale("bo",{months:"___________".split("_"),monthsShort:"___________".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"A h:mm",LTS:"A h:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY, A h:mm",LLLL:"dddd, D MMMM YYYY, A h:mm"},calendar:{sameDay:"[] LT",nextDay:"[] LT",nextWeek:"[], LT",lastDay:"[] LT",lastWeek:"[] dddd, LT",sameElse:"L"},relativeTime:{future:"%s ",past:"%s ",s:"",ss:"%d ",m:"",mm:"%d ",h:"",hh:"%d ",d:"",dd:"%d ",M:"",MM:"%d ",y:"",yy:"%d "},preparse:function(e){return e.replace(/[\u0f21\u0f22\u0f23\u0f24\u0f25\u0f26\u0f27\u0f28\u0f29\u0f20]/g,function(e){return ls[e]})},postformat:function(e){return e.replace(/\d/g,function(e){return us[e]})},meridiemParse:/\u0f58\u0f5a\u0f53\u0f0b\u0f58\u0f7c|\u0f5e\u0f7c\u0f42\u0f66\u0f0b\u0f40\u0f66|\u0f49\u0f72\u0f53\u0f0b\u0f42\u0f74\u0f44|\u0f51\u0f42\u0f7c\u0f44\u0f0b\u0f51\u0f42|\u0f58\u0f5a\u0f53\u0f0b\u0f58\u0f7c/,meridiemHour:function(e,a){return 12===e&&(e=0),""===a&&4<=e||""===a&&e<5||""===a?e+12:e},meridiem:function(e,a,t){return e<4?"":e<10?"":e<17?"":e<20?"":""},week:{dow:0,doy:6}}),l.defineLocale("br",{months:"Genver_C'hwevrer_Meurzh_Ebrel_Mae_Mezheven_Gouere_Eost_Gwengolo_Here_Du_Kerzu".split("_"),monthsShort:"Gen_C'hwe_Meu_Ebr_Mae_Eve_Gou_Eos_Gwe_Her_Du_Ker".split("_"),weekdays:"Sul_Lun_Meurzh_Merc'her_Yaou_Gwener_Sadorn".split("_"),weekdaysShort:"Sul_Lun_Meu_Mer_Yao_Gwe_Sad".split("_"),weekdaysMin:"Su_Lu_Me_Mer_Ya_Gw_Sa".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"h[e]mm A",LTS:"h[e]mm:ss A",L:"DD/MM/YYYY",LL:"D [a viz] MMMM YYYY",LLL:"D [a viz] MMMM YYYY h[e]mm A",LLLL:"dddd, D [a viz] MMMM YYYY h[e]mm A"},calendar:{sameDay:"[Hiziv da] LT",nextDay:"[Warc'hoazh da] LT",nextWeek:"dddd [da] LT",lastDay:"[Dec'h da] LT",lastWeek:"dddd [paset da] LT",sameElse:"L"},relativeTime:{future:"a-benn %s",past:"%s 'zo",s:"un nebeud segondenno",ss:"%d eilenn",m:"ur vunutenn",mm:Ms,h:"un eur",hh:"%d eur",d:"un devezh",dd:Ms,M:"ur miz",MM:Ms,y:"ur bloaz",yy:function(e){switch(function e(a){return 9<a?e(a%10):a}(e)){case 1:case 3:case 4:case 5:case 9:return e+" bloaz";default:return e+" vloaz"}}},dayOfMonthOrdinalParse:/\d{1,2}(a\xf1|vet)/,ordinal:function(e){return e+(1===e?"a":"vet")},week:{dow:1,doy:4}}),l.defineLocale("bs",{months:"januar_februar_mart_april_maj_juni_juli_august_septembar_oktobar_novembar_decembar".split("_"),monthsShort:"jan._feb._mar._apr._maj._jun._jul._aug._sep._okt._nov._dec.".split("_"),monthsParseExact:!0,weekdays:"nedjelja_ponedjeljak_utorak_srijeda_etvrtak_petak_subota".split("_"),weekdaysShort:"ned._pon._uto._sri._et._pet._sub.".split("_"),weekdaysMin:"ne_po_ut_sr_e_pe_su".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"H:mm",LTS:"H:mm:ss",L:"DD.MM.YYYY",LL:"D. MMMM YYYY",LLL:"D. MMMM YYYY H:mm",LLLL:"dddd, D. MMMM YYYY H:mm"},calendar:{sameDay:"[danas u] LT",nextDay:"[sutra u] LT",nextWeek:function(){switch(this.day()){case 0:return"[u] [nedjelju] [u] LT";case 3:return"[u] [srijedu] [u] LT";case 6:return"[u] [subotu] [u] LT";case 1:case 2:case 4:case 5:return"[u] dddd [u] LT"}},lastDay:"[juer u] LT",lastWeek:function(){switch(this.day()){case 0:case 3:return"[prolu] dddd [u] LT";case 6:return"[prole] [subote] [u] LT";case 1:case 2:case 4:case 5:return"[proli] dddd [u] LT"}},sameElse:"L"},relativeTime:{future:"za %s",past:"prije %s",s:"par sekundi",ss:hs,m:hs,mm:hs,h:hs,hh:hs,d:"dan",dd:hs,M:"mjesec",MM:hs,y:"godinu",yy:hs},dayOfMonthOrdinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:7}}),l.defineLocale("ca",{months:{standalone:"gener_febrer_mar_abril_maig_juny_juliol_agost_setembre_octubre_novembre_desembre".split("_"),format:"de gener_de febrer_de mar_d'abril_de maig_de juny_de juliol_d'agost_de setembre_d'octubre_de novembre_de desembre".split("_"),isFormat:/D[oD]?(\s)+MMMM/},monthsShort:"gen._febr._mar_abr._maig_juny_jul._ag._set._oct._nov._des.".split("_"),monthsParseExact:!0,weekdays:"diumenge_dilluns_dimarts_dimecres_dijous_divendres_dissabte".split("_"),weekdaysShort:"dg._dl._dt._dc._dj._dv._ds.".split("_"),weekdaysMin:"dg_dl_dt_dc_dj_dv_ds".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"H:mm",LTS:"H:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM [de] YYYY",ll:"D MMM YYYY",LLL:"D MMMM [de] YYYY [a les] H:mm",lll:"D MMM YYYY, H:mm",LLLL:"dddd D MMMM [de] YYYY [a les] H:mm",llll:"ddd D MMM YYYY, H:mm"},calendar:{sameDay:function(){return"[avui a "+(1!==this.hours()?"les":"la")+"] LT"},nextDay:function(){return"[dem a "+(1!==this.hours()?"les":"la")+"] LT"},nextWeek:function(){return"dddd [a "+(1!==this.hours()?"les":"la")+"] LT"},lastDay:function(){return"[ahir a "+(1!==this.hours()?"les":"la")+"] LT"},lastWeek:function(){return"[el] dddd [passat a "+(1!==this.hours()?"les":"la")+"] LT"},sameElse:"L"},relativeTime:{future:"d'aqu %s",past:"fa %s",s:"uns segons",ss:"%d segons",m:"un minut",mm:"%d minuts",h:"una hora",hh:"%d hores",d:"un dia",dd:"%d dies",M:"un mes",MM:"%d mesos",y:"un any",yy:"%d anys"},dayOfMonthOrdinalParse:/\d{1,2}(r|n|t|\xe8|a)/,ordinal:function(e,a){var t=1===e?"r":2===e?"n":3===e?"r":4===e?"t":"";return"w"!==a&&"W"!==a||(t="a"),e+t},week:{dow:1,doy:4}});var Ls="leden_nor_bezen_duben_kvten_erven_ervenec_srpen_z_jen_listopad_prosinec".split("_"),cs="led_no_be_dub_kv_vn_vc_srp_z_j_lis_pro".split("_"),Ys=[/^led/i,/^\xfano/i,/^b\u0159e/i,/^dub/i,/^kv\u011b/i,/^(\u010dvn|\u010derven$|\u010dervna)/i,/^(\u010dvc|\u010dervenec|\u010dervence)/i,/^srp/i,/^z\xe1\u0159/i,/^\u0159\xedj/i,/^lis/i,/^pro/i],ys=/^(leden|\xfanor|b\u0159ezen|duben|kv\u011bten|\u010dervenec|\u010dervence|\u010derven|\u010dervna|srpen|z\xe1\u0159\xed|\u0159\xedjen|listopad|prosinec|led|\xfano|b\u0159e|dub|kv\u011b|\u010dvn|\u010dvc|srp|z\xe1\u0159|\u0159\xedj|lis|pro)/i;function fs(e){return 1<e&&e<5&&1!=~~(e/10)}function ks(e,a,t,s){var n=e+" ";switch(t){case"s":return a||s?"pr sekund":"pr sekundami";case"ss":return a||s?n+(fs(e)?"sekundy":"sekund"):n+"sekundami";case"m":return a?"minuta":s?"minutu":"minutou";case"mm":return a||s?n+(fs(e)?"minuty":"minut"):n+"minutami";case"h":return a?"hodina":s?"hodinu":"hodinou";case"hh":return a||s?n+(fs(e)?"hodiny":"hodin"):n+"hodinami";case"d":return a||s?"den":"dnem";case"dd":return a||s?n+(fs(e)?"dny":"dn"):n+"dny";case"M":return a||s?"msc":"mscem";case"MM":return a||s?n+(fs(e)?"msce":"msc"):n+"msci";case"y":return a||s?"rok":"rokem";case"yy":return a||s?n+(fs(e)?"roky":"let"):n+"lety"}}function ps(e,a,t,s){var n={m:["eine Minute","einer Minute"],h:["eine Stunde","einer Stunde"],d:["ein Tag","einem Tag"],dd:[e+" Tage",e+" Tagen"],M:["ein Monat","einem Monat"],MM:[e+" Monate",e+" Monaten"],y:["ein Jahr","einem Jahr"],yy:[e+" Jahre",e+" Jahren"]};return a?n[t][0]:n[t][1]}function Ds(e,a,t,s){var n={m:["eine Minute","einer Minute"],h:["eine Stunde","einer Stunde"],d:["ein Tag","einem Tag"],dd:[e+" Tage",e+" Tagen"],M:["ein Monat","einem Monat"],MM:[e+" Monate",e+" Monaten"],y:["ein Jahr","einem Jahr"],yy:[e+" Jahre",e+" Jahren"]};return a?n[t][0]:n[t][1]}function Ts(e,a,t,s){var n={m:["eine Minute","einer Minute"],h:["eine Stunde","einer Stunde"],d:["ein Tag","einem Tag"],dd:[e+" Tage",e+" Tagen"],M:["ein Monat","einem Monat"],MM:[e+" Monate",e+" Monaten"],y:["ein Jahr","einem Jahr"],yy:[e+" Jahre",e+" Jahren"]};return a?n[t][0]:n[t][1]}l.defineLocale("cs",{months:Ls,monthsShort:cs,monthsRegex:ys,monthsShortRegex:ys,monthsStrictRegex:/^(leden|ledna|\xfanora|\xfanor|b\u0159ezen|b\u0159ezna|duben|dubna|kv\u011bten|kv\u011btna|\u010dervenec|\u010dervence|\u010derven|\u010dervna|srpen|srpna|z\xe1\u0159\xed|\u0159\xedjen|\u0159\xedjna|listopadu|listopad|prosinec|prosince)/i,monthsShortStrictRegex:/^(led|\xfano|b\u0159e|dub|kv\u011b|\u010dvn|\u010dvc|srp|z\xe1\u0159|\u0159\xedj|lis|pro)/i,monthsParse:Ys,longMonthsParse:Ys,shortMonthsParse:Ys,weekdays:"nedle_pondl_ter_steda_tvrtek_ptek_sobota".split("_"),weekdaysShort:"ne_po_t_st_t_p_so".split("_"),weekdaysMin:"ne_po_t_st_t_p_so".split("_"),longDateFormat:{LT:"H:mm",LTS:"H:mm:ss",L:"DD.MM.YYYY",LL:"D. MMMM YYYY",LLL:"D. MMMM YYYY H:mm",LLLL:"dddd D. MMMM YYYY H:mm",l:"D. M. YYYY"},calendar:{sameDay:"[dnes v] LT",nextDay:"[ztra v] LT",nextWeek:function(){switch(this.day()){case 0:return"[v nedli v] LT";case 1:case 2:return"[v] dddd [v] LT";case 3:return"[ve stedu v] LT";case 4:return"[ve tvrtek v] LT";case 5:return"[v ptek v] LT";case 6:return"[v sobotu v] LT"}},lastDay:"[vera v] LT",lastWeek:function(){switch(this.day()){case 0:return"[minulou nedli v] LT";case 1:case 2:return"[minul] dddd [v] LT";case 3:return"[minulou stedu v] LT";case 4:case 5:return"[minul] dddd [v] LT";case 6:return"[minulou sobotu v] LT"}},sameElse:"L"},relativeTime:{future:"za %s",past:"ped %s",s:ks,ss:ks,m:ks,mm:ks,h:ks,hh:ks,d:ks,dd:ks,M:ks,MM:ks,y:ks,yy:ks},dayOfMonthOrdinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:4}}),l.defineLocale("cv",{months:"___________".split("_"),monthsShort:"___________".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD-MM-YYYY",LL:"YYYY [] MMMM [] D[-]",LLL:"YYYY [] MMMM [] D[-], HH:mm",LLLL:"dddd, YYYY [] MMMM [] D[-], HH:mm"},calendar:{sameDay:"[] LT []",nextDay:"[] LT []",lastDay:"[] LT []",nextWeek:"[] dddd LT []",lastWeek:"[] dddd LT []",sameElse:"L"},relativeTime:{future:function(e){return e+(/\u0441\u0435\u0445\u0435\u0442$/i.exec(e)?"":/\u04ab\u0443\u043b$/i.exec(e)?"":"")},past:"%s ",s:"- ",ss:"%d ",m:" ",mm:"%d ",h:" ",hh:"%d ",d:" ",dd:"%d ",M:" ",MM:"%d ",y:" ",yy:"%d "},dayOfMonthOrdinalParse:/\d{1,2}-\u043c\u04d7\u0448/,ordinal:"%d-",week:{dow:1,doy:7}}),l.defineLocale("cy",{months:"Ionawr_Chwefror_Mawrth_Ebrill_Mai_Mehefin_Gorffennaf_Awst_Medi_Hydref_Tachwedd_Rhagfyr".split("_"),monthsShort:"Ion_Chwe_Maw_Ebr_Mai_Meh_Gor_Aws_Med_Hyd_Tach_Rhag".split("_"),weekdays:"Dydd Sul_Dydd Llun_Dydd Mawrth_Dydd Mercher_Dydd Iau_Dydd Gwener_Dydd Sadwrn".split("_"),weekdaysShort:"Sul_Llun_Maw_Mer_Iau_Gwe_Sad".split("_"),weekdaysMin:"Su_Ll_Ma_Me_Ia_Gw_Sa".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd, D MMMM YYYY HH:mm"},calendar:{sameDay:"[Heddiw am] LT",nextDay:"[Yfory am] LT",nextWeek:"dddd [am] LT",lastDay:"[Ddoe am] LT",lastWeek:"dddd [diwethaf am] LT",sameElse:"L"},relativeTime:{future:"mewn %s",past:"%s yn l",s:"ychydig eiliadau",ss:"%d eiliad",m:"munud",mm:"%d munud",h:"awr",hh:"%d awr",d:"diwrnod",dd:"%d diwrnod",M:"mis",MM:"%d mis",y:"blwyddyn",yy:"%d flynedd"},dayOfMonthOrdinalParse:/\d{1,2}(fed|ain|af|il|ydd|ed|eg)/,ordinal:function(e){var a="";return 20<e?a=40===e||50===e||60===e||80===e||100===e?"fed":"ain":0<e&&(a=["","af","il","ydd","ydd","ed","ed","ed","fed","fed","fed","eg","fed","eg","eg","fed","eg","eg","fed","eg","fed"][e]),e+a},week:{dow:1,doy:4}}),l.defineLocale("da",{months:"januar_februar_marts_april_maj_juni_juli_august_september_oktober_november_december".split("_"),monthsShort:"jan_feb_mar_apr_maj_jun_jul_aug_sep_okt_nov_dec".split("_"),weekdays:"sndag_mandag_tirsdag_onsdag_torsdag_fredag_lrdag".split("_"),weekdaysShort:"sn_man_tir_ons_tor_fre_lr".split("_"),weekdaysMin:"s_ma_ti_on_to_fr_l".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD.MM.YYYY",LL:"D. MMMM YYYY",LLL:"D. MMMM YYYY HH:mm",LLLL:"dddd [d.] D. MMMM YYYY [kl.] HH:mm"},calendar:{sameDay:"[i dag kl.] LT",nextDay:"[i morgen kl.] LT",nextWeek:"p dddd [kl.] LT",lastDay:"[i gr kl.] LT",lastWeek:"[i] dddd[s kl.] LT",sameElse:"L"},relativeTime:{future:"om %s",past:"%s siden",s:"f sekunder",ss:"%d sekunder",m:"et minut",mm:"%d minutter",h:"en time",hh:"%d timer",d:"en dag",dd:"%d dage",M:"en mned",MM:"%d mneder",y:"et r",yy:"%d r"},dayOfMonthOrdinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:4}}),l.defineLocale("de-at",{months:"Jnner_Februar_Mrz_April_Mai_Juni_Juli_August_September_Oktober_November_Dezember".split("_"),monthsShort:"Jn._Feb._Mrz_Apr._Mai_Juni_Juli_Aug._Sep._Okt._Nov._Dez.".split("_"),monthsParseExact:!0,weekdays:"Sonntag_Montag_Dienstag_Mittwoch_Donnerstag_Freitag_Samstag".split("_"),weekdaysShort:"So._Mo._Di._Mi._Do._Fr._Sa.".split("_"),weekdaysMin:"So_Mo_Di_Mi_Do_Fr_Sa".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD.MM.YYYY",LL:"D. MMMM YYYY",LLL:"D. MMMM YYYY HH:mm",LLLL:"dddd, D. MMMM YYYY HH:mm"},calendar:{sameDay:"[heute um] LT [Uhr]",sameElse:"L",nextDay:"[morgen um] LT [Uhr]",nextWeek:"dddd [um] LT [Uhr]",lastDay:"[gestern um] LT [Uhr]",lastWeek:"[letzten] dddd [um] LT [Uhr]"},relativeTime:{future:"in %s",past:"vor %s",s:"ein paar Sekunden",ss:"%d Sekunden",m:ps,mm:"%d Minuten",h:ps,hh:"%d Stunden",d:ps,dd:ps,M:ps,MM:ps,y:ps,yy:ps},dayOfMonthOrdinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:4}}),l.defineLocale("de-ch",{months:"Januar_Februar_Mrz_April_Mai_Juni_Juli_August_September_Oktober_November_Dezember".split("_"),monthsShort:"Jan._Feb._Mrz_Apr._Mai_Juni_Juli_Aug._Sep._Okt._Nov._Dez.".split("_"),monthsParseExact:!0,weekdays:"Sonntag_Montag_Dienstag_Mittwoch_Donnerstag_Freitag_Samstag".split("_"),weekdaysShort:"So_Mo_Di_Mi_Do_Fr_Sa".split("_"),weekdaysMin:"So_Mo_Di_Mi_Do_Fr_Sa".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD.MM.YYYY",LL:"D. MMMM YYYY",LLL:"D. MMMM YYYY HH:mm",LLLL:"dddd, D. MMMM YYYY HH:mm"},calendar:{sameDay:"[heute um] LT [Uhr]",sameElse:"L",nextDay:"[morgen um] LT [Uhr]",nextWeek:"dddd [um] LT [Uhr]",lastDay:"[gestern um] LT [Uhr]",lastWeek:"[letzten] dddd [um] LT [Uhr]"},relativeTime:{future:"in %s",past:"vor %s",s:"ein paar Sekunden",ss:"%d Sekunden",m:Ds,mm:"%d Minuten",h:Ds,hh:"%d Stunden",d:Ds,dd:Ds,M:Ds,MM:Ds,y:Ds,yy:Ds},dayOfMonthOrdinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:4}}),l.defineLocale("de",{months:"Januar_Februar_Mrz_April_Mai_Juni_Juli_August_September_Oktober_November_Dezember".split("_"),monthsShort:"Jan._Feb._Mrz_Apr._Mai_Juni_Juli_Aug._Sep._Okt._Nov._Dez.".split("_"),monthsParseExact:!0,weekdays:"Sonntag_Montag_Dienstag_Mittwoch_Donnerstag_Freitag_Samstag".split("_"),weekdaysShort:"So._Mo._Di._Mi._Do._Fr._Sa.".split("_"),weekdaysMin:"So_Mo_Di_Mi_Do_Fr_Sa".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD.MM.YYYY",LL:"D. MMMM YYYY",LLL:"D. MMMM YYYY HH:mm",LLLL:"dddd, D. MMMM YYYY HH:mm"},calendar:{sameDay:"[heute um] LT [Uhr]",sameElse:"L",nextDay:"[morgen um] LT [Uhr]",nextWeek:"dddd [um] LT [Uhr]",lastDay:"[gestern um] LT [Uhr]",lastWeek:"[letzten] dddd [um] LT [Uhr]"},relativeTime:{future:"in %s",past:"vor %s",s:"ein paar Sekunden",ss:"%d Sekunden",m:Ts,mm:"%d Minuten",h:Ts,hh:"%d Stunden",d:Ts,dd:Ts,M:Ts,MM:Ts,y:Ts,yy:Ts},dayOfMonthOrdinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:4}});var gs=["","","","","","","","","","","",""],ws=["","","","","","",""];l.defineLocale("dv",{months:gs,monthsShort:gs,weekdays:ws,weekdaysShort:ws,weekdaysMin:"______".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"D/M/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd D MMMM YYYY HH:mm"},meridiemParse:/\u0789\u0786|\u0789\u078a/,isPM:function(e){return""===e},meridiem:function(e,a,t){return e<12?"":""},calendar:{sameDay:"[] LT",nextDay:"[] LT",nextWeek:"dddd LT",lastDay:"[] LT",lastWeek:"[] dddd LT",sameElse:"L"},relativeTime:{future:" %s",past:" %s",s:"",ss:"d% ",m:"",mm:" %d",h:"",hh:" %d",d:"",dd:" %d",M:"",MM:" %d",y:"",yy:" %d"},preparse:function(e){return e.replace(/\u060c/g,",")},postformat:function(e){return e.replace(/,/g,"")},week:{dow:7,doy:12}}),l.defineLocale("el",{monthsNominativeEl:"___________".split("_"),monthsGenitiveEl:"___________".split("_"),months:function(e,a){return e?"string"==typeof a&&/D/.test(a.substring(0,a.indexOf("MMMM")))?this._monthsGenitiveEl[e.month()]:this._monthsNominativeEl[e.month()]:this._monthsNominativeEl},monthsShort:"___________".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),meridiem:function(e,a,t){return 11<e?t?"":"":t?"":""},isPM:function(e){return""===(e+"").toLowerCase()[0]},meridiemParse:/[\u03a0\u039c]\.?\u039c?\.?/i,longDateFormat:{LT:"h:mm A",LTS:"h:mm:ss A",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY h:mm A",LLLL:"dddd, D MMMM YYYY h:mm A"},calendarEl:{sameDay:"[ {}] LT",nextDay:"[ {}] LT",nextWeek:"dddd [{}] LT",lastDay:"[ {}] LT",lastWeek:function(){switch(this.day()){case 6:return"[ ] dddd [{}] LT";default:return"[ ] dddd [{}] LT"}},sameElse:"L"},calendar:function(e,a){var t=this._calendarEl[e],s=a&&a.hours();return H(t)&&(t=t.apply(a)),t.replace("{}",s%12==1?"":"")},relativeTime:{future:" %s",past:"%s ",s:" ",ss:"%d ",m:" ",mm:"%d ",h:" ",hh:"%d ",d:" ",dd:"%d ",M:" ",MM:"%d ",y:" ",yy:"%d "},dayOfMonthOrdinalParse:/\d{1,2}\u03b7/,ordinal:"%d",week:{dow:1,doy:4}}),l.defineLocale("en-SG",{months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),monthsShort:"Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),weekdaysShort:"Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),weekdaysMin:"Su_Mo_Tu_We_Th_Fr_Sa".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd, D MMMM YYYY HH:mm"},calendar:{sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"},relativeTime:{future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},dayOfMonthOrdinalParse:/\d{1,2}(st|nd|rd|th)/,ordinal:function(e){var a=e%10;return e+(1==~~(e%100/10)?"th":1==a?"st":2==a?"nd":3==a?"rd":"th")},week:{dow:1,doy:4}}),l.defineLocale("en-au",{months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),monthsShort:"Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),weekdaysShort:"Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),weekdaysMin:"Su_Mo_Tu_We_Th_Fr_Sa".split("_"),longDateFormat:{LT:"h:mm A",LTS:"h:mm:ss A",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY h:mm A",LLLL:"dddd, D MMMM YYYY h:mm A"},calendar:{sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"},relativeTime:{future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},dayOfMonthOrdinalParse:/\d{1,2}(st|nd|rd|th)/,ordinal:function(e){var a=e%10;return e+(1==~~(e%100/10)?"th":1==a?"st":2==a?"nd":3==a?"rd":"th")},week:{dow:1,doy:4}}),l.defineLocale("en-ca",{months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),monthsShort:"Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),weekdaysShort:"Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),weekdaysMin:"Su_Mo_Tu_We_Th_Fr_Sa".split("_"),longDateFormat:{LT:"h:mm A",LTS:"h:mm:ss A",L:"YYYY-MM-DD",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"},calendar:{sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"},relativeTime:{future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},dayOfMonthOrdinalParse:/\d{1,2}(st|nd|rd|th)/,ordinal:function(e){var a=e%10;return e+(1==~~(e%100/10)?"th":1==a?"st":2==a?"nd":3==a?"rd":"th")}}),l.defineLocale("en-gb",{months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),monthsShort:"Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),weekdaysShort:"Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),weekdaysMin:"Su_Mo_Tu_We_Th_Fr_Sa".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd, D MMMM YYYY HH:mm"},calendar:{sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"},relativeTime:{future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},dayOfMonthOrdinalParse:/\d{1,2}(st|nd|rd|th)/,ordinal:function(e){var a=e%10;return e+(1==~~(e%100/10)?"th":1==a?"st":2==a?"nd":3==a?"rd":"th")},week:{dow:1,doy:4}}),l.defineLocale("en-ie",{months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),monthsShort:"Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),weekdaysShort:"Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),weekdaysMin:"Su_Mo_Tu_We_Th_Fr_Sa".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd D MMMM YYYY HH:mm"},calendar:{sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"},relativeTime:{future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},dayOfMonthOrdinalParse:/\d{1,2}(st|nd|rd|th)/,ordinal:function(e){var a=e%10;return e+(1==~~(e%100/10)?"th":1==a?"st":2==a?"nd":3==a?"rd":"th")},week:{dow:1,doy:4}}),l.defineLocale("en-il",{months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),monthsShort:"Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),weekdaysShort:"Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),weekdaysMin:"Su_Mo_Tu_We_Th_Fr_Sa".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd, D MMMM YYYY HH:mm"},calendar:{sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"},relativeTime:{future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},dayOfMonthOrdinalParse:/\d{1,2}(st|nd|rd|th)/,ordinal:function(e){var a=e%10;return e+(1==~~(e%100/10)?"th":1==a?"st":2==a?"nd":3==a?"rd":"th")}}),l.defineLocale("en-nz",{months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),monthsShort:"Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),weekdaysShort:"Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),weekdaysMin:"Su_Mo_Tu_We_Th_Fr_Sa".split("_"),longDateFormat:{LT:"h:mm A",LTS:"h:mm:ss A",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY h:mm A",LLLL:"dddd, D MMMM YYYY h:mm A"},calendar:{sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"},relativeTime:{future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},dayOfMonthOrdinalParse:/\d{1,2}(st|nd|rd|th)/,ordinal:function(e){var a=e%10;return e+(1==~~(e%100/10)?"th":1==a?"st":2==a?"nd":3==a?"rd":"th")},week:{dow:1,doy:4}}),l.defineLocale("eo",{months:"januaro_februaro_marto_aprilo_majo_junio_julio_agusto_septembro_oktobro_novembro_decembro".split("_"),monthsShort:"jan_feb_mar_apr_maj_jun_jul_ag_sep_okt_nov_dec".split("_"),weekdays:"dimano_lundo_mardo_merkredo_ado_vendredo_sabato".split("_"),weekdaysShort:"dim_lun_mard_merk_a_ven_sab".split("_"),weekdaysMin:"di_lu_ma_me_a_ve_sa".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"YYYY-MM-DD",LL:"D[-a de] MMMM, YYYY",LLL:"D[-a de] MMMM, YYYY HH:mm",LLLL:"dddd, [la] D[-a de] MMMM, YYYY HH:mm"},meridiemParse:/[ap]\.t\.m/i,isPM:function(e){return"p"===e.charAt(0).toLowerCase()},meridiem:function(e,a,t){return 11<e?t?"p.t.m.":"P.T.M.":t?"a.t.m.":"A.T.M."},calendar:{sameDay:"[Hodia je] LT",nextDay:"[Morga je] LT",nextWeek:"dddd [je] LT",lastDay:"[Hiera je] LT",lastWeek:"[pasinta] dddd [je] LT",sameElse:"L"},relativeTime:{future:"post %s",past:"anta %s",s:"sekundoj",ss:"%d sekundoj",m:"minuto",mm:"%d minutoj",h:"horo",hh:"%d horoj",d:"tago",dd:"%d tagoj",M:"monato",MM:"%d monatoj",y:"jaro",yy:"%d jaroj"},dayOfMonthOrdinalParse:/\d{1,2}a/,ordinal:"%da",week:{dow:1,doy:7}});var vs="ene._feb._mar._abr._may._jun._jul._ago._sep._oct._nov._dic.".split("_"),Ss="ene_feb_mar_abr_may_jun_jul_ago_sep_oct_nov_dic".split("_"),Hs=[/^ene/i,/^feb/i,/^mar/i,/^abr/i,/^may/i,/^jun/i,/^jul/i,/^ago/i,/^sep/i,/^oct/i,/^nov/i,/^dic/i],bs=/^(enero|febrero|marzo|abril|mayo|junio|julio|agosto|septiembre|octubre|noviembre|diciembre|ene\.?|feb\.?|mar\.?|abr\.?|may\.?|jun\.?|jul\.?|ago\.?|sep\.?|oct\.?|nov\.?|dic\.?)/i;l.defineLocale("es-do",{months:"enero_febrero_marzo_abril_mayo_junio_julio_agosto_septiembre_octubre_noviembre_diciembre".split("_"),monthsShort:function(e,a){return e?/-MMM-/.test(a)?Ss[e.month()]:vs[e.month()]:vs},monthsRegex:bs,monthsShortRegex:bs,monthsStrictRegex:/^(enero|febrero|marzo|abril|mayo|junio|julio|agosto|septiembre|octubre|noviembre|diciembre)/i,monthsShortStrictRegex:/^(ene\.?|feb\.?|mar\.?|abr\.?|may\.?|jun\.?|jul\.?|ago\.?|sep\.?|oct\.?|nov\.?|dic\.?)/i,monthsParse:Hs,longMonthsParse:Hs,shortMonthsParse:Hs,weekdays:"domingo_lunes_martes_mircoles_jueves_viernes_sbado".split("_"),weekdaysShort:"dom._lun._mar._mi._jue._vie._sb.".split("_"),weekdaysMin:"do_lu_ma_mi_ju_vi_s".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"h:mm A",LTS:"h:mm:ss A",L:"DD/MM/YYYY",LL:"D [de] MMMM [de] YYYY",LLL:"D [de] MMMM [de] YYYY h:mm A",LLLL:"dddd, D [de] MMMM [de] YYYY h:mm A"},calendar:{sameDay:function(){return"[hoy a la"+(1!==this.hours()?"s":"")+"] LT"},nextDay:function(){return"[maana a la"+(1!==this.hours()?"s":"")+"] LT"},nextWeek:function(){return"dddd [a la"+(1!==this.hours()?"s":"")+"] LT"},lastDay:function(){return"[ayer a la"+(1!==this.hours()?"s":"")+"] LT"},lastWeek:function(){return"[el] dddd [pasado a la"+(1!==this.hours()?"s":"")+"] LT"},sameElse:"L"},relativeTime:{future:"en %s",past:"hace %s",s:"unos segundos",ss:"%d segundos",m:"un minuto",mm:"%d minutos",h:"una hora",hh:"%d horas",d:"un da",dd:"%d das",M:"un mes",MM:"%d meses",y:"un ao",yy:"%d aos"},dayOfMonthOrdinalParse:/\d{1,2}\xba/,ordinal:"%d",week:{dow:1,doy:4}});var js="ene._feb._mar._abr._may._jun._jul._ago._sep._oct._nov._dic.".split("_"),xs="ene_feb_mar_abr_may_jun_jul_ago_sep_oct_nov_dic".split("_"),Os=[/^ene/i,/^feb/i,/^mar/i,/^abr/i,/^may/i,/^jun/i,/^jul/i,/^ago/i,/^sep/i,/^oct/i,/^nov/i,/^dic/i],Ps=/^(enero|febrero|marzo|abril|mayo|junio|julio|agosto|septiembre|octubre|noviembre|diciembre|ene\.?|feb\.?|mar\.?|abr\.?|may\.?|jun\.?|jul\.?|ago\.?|sep\.?|oct\.?|nov\.?|dic\.?)/i;l.defineLocale("es-us",{months:"enero_febrero_marzo_abril_mayo_junio_julio_agosto_septiembre_octubre_noviembre_diciembre".split("_"),monthsShort:function(e,a){return e?/-MMM-/.test(a)?xs[e.month()]:js[e.month()]:js},monthsRegex:Ps,monthsShortRegex:Ps,monthsStrictRegex:/^(enero|febrero|marzo|abril|mayo|junio|julio|agosto|septiembre|octubre|noviembre|diciembre)/i,monthsShortStrictRegex:/^(ene\.?|feb\.?|mar\.?|abr\.?|may\.?|jun\.?|jul\.?|ago\.?|sep\.?|oct\.?|nov\.?|dic\.?)/i,monthsParse:Os,longMonthsParse:Os,shortMonthsParse:Os,weekdays:"domingo_lunes_martes_mircoles_jueves_viernes_sbado".split("_"),weekdaysShort:"dom._lun._mar._mi._jue._vie._sb.".split("_"),weekdaysMin:"do_lu_ma_mi_ju_vi_s".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"h:mm A",LTS:"h:mm:ss A",L:"MM/DD/YYYY",LL:"D [de] MMMM [de] YYYY",LLL:"D [de] MMMM [de] YYYY h:mm A",LLLL:"dddd, D [de] MMMM [de] YYYY h:mm A"},calendar:{sameDay:function(){return"[hoy a la"+(1!==this.hours()?"s":"")+"] LT"},nextDay:function(){return"[maana a la"+(1!==this.hours()?"s":"")+"] LT"},nextWeek:function(){return"dddd [a la"+(1!==this.hours()?"s":"")+"] LT"},lastDay:function(){return"[ayer a la"+(1!==this.hours()?"s":"")+"] LT"},lastWeek:function(){return"[el] dddd [pasado a la"+(1!==this.hours()?"s":"")+"] LT"},sameElse:"L"},relativeTime:{future:"en %s",past:"hace %s",s:"unos segundos",ss:"%d segundos",m:"un minuto",mm:"%d minutos",h:"una hora",hh:"%d horas",d:"un da",dd:"%d das",M:"un mes",MM:"%d meses",y:"un ao",yy:"%d aos"},dayOfMonthOrdinalParse:/\d{1,2}\xba/,ordinal:"%d",week:{dow:0,doy:6}});var Ws="ene._feb._mar._abr._may._jun._jul._ago._sep._oct._nov._dic.".split("_"),As="ene_feb_mar_abr_may_jun_jul_ago_sep_oct_nov_dic".split("_"),Es=[/^ene/i,/^feb/i,/^mar/i,/^abr/i,/^may/i,/^jun/i,/^jul/i,/^ago/i,/^sep/i,/^oct/i,/^nov/i,/^dic/i],Fs=/^(enero|febrero|marzo|abril|mayo|junio|julio|agosto|septiembre|octubre|noviembre|diciembre|ene\.?|feb\.?|mar\.?|abr\.?|may\.?|jun\.?|jul\.?|ago\.?|sep\.?|oct\.?|nov\.?|dic\.?)/i;function zs(e,a,t,s){var n={s:["mne sekundi","mni sekund","paar sekundit"],ss:[e+"sekundi",e+"sekundit"],m:["he minuti","ks minut"],mm:[e+" minuti",e+" minutit"],h:["he tunni","tund aega","ks tund"],hh:[e+" tunni",e+" tundi"],d:["he peva","ks pev"],M:["kuu aja","kuu aega","ks kuu"],MM:[e+" kuu",e+" kuud"],y:["he aasta","aasta","ks aasta"],yy:[e+" aasta",e+" aastat"]};return a?n[t][2]?n[t][2]:n[t][1]:s?n[t][0]:n[t][1]}l.defineLocale("es",{months:"enero_febrero_marzo_abril_mayo_junio_julio_agosto_septiembre_octubre_noviembre_diciembre".split("_"),monthsShort:function(e,a){return e?/-MMM-/.test(a)?As[e.month()]:Ws[e.month()]:Ws},monthsRegex:Fs,monthsShortRegex:Fs,monthsStrictRegex:/^(enero|febrero|marzo|abril|mayo|junio|julio|agosto|septiembre|octubre|noviembre|diciembre)/i,monthsShortStrictRegex:/^(ene\.?|feb\.?|mar\.?|abr\.?|may\.?|jun\.?|jul\.?|ago\.?|sep\.?|oct\.?|nov\.?|dic\.?)/i,monthsParse:Es,longMonthsParse:Es,shortMonthsParse:Es,weekdays:"domingo_lunes_martes_mircoles_jueves_viernes_sbado".split("_"),weekdaysShort:"dom._lun._mar._mi._jue._vie._sb.".split("_"),weekdaysMin:"do_lu_ma_mi_ju_vi_s".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"H:mm",LTS:"H:mm:ss",L:"DD/MM/YYYY",LL:"D [de] MMMM [de] YYYY",LLL:"D [de] MMMM [de] YYYY H:mm",LLLL:"dddd, D [de] MMMM [de] YYYY H:mm"},calendar:{sameDay:function(){return"[hoy a la"+(1!==this.hours()?"s":"")+"] LT"},nextDay:function(){return"[maana a la"+(1!==this.hours()?"s":"")+"] LT"},nextWeek:function(){return"dddd [a la"+(1!==this.hours()?"s":"")+"] LT"},lastDay:function(){return"[ayer a la"+(1!==this.hours()?"s":"")+"] LT"},lastWeek:function(){return"[el] dddd [pasado a la"+(1!==this.hours()?"s":"")+"] LT"},sameElse:"L"},relativeTime:{future:"en %s",past:"hace %s",s:"unos segundos",ss:"%d segundos",m:"un minuto",mm:"%d minutos",h:"una hora",hh:"%d horas",d:"un da",dd:"%d das",M:"un mes",MM:"%d meses",y:"un ao",yy:"%d aos"},dayOfMonthOrdinalParse:/\d{1,2}\xba/,ordinal:"%d",week:{dow:1,doy:4}}),l.defineLocale("et",{months:"jaanuar_veebruar_mrts_aprill_mai_juuni_juuli_august_september_oktoober_november_detsember".split("_"),monthsShort:"jaan_veebr_mrts_apr_mai_juuni_juuli_aug_sept_okt_nov_dets".split("_"),weekdays:"phapev_esmaspev_teisipev_kolmapev_neljapev_reede_laupev".split("_"),weekdaysShort:"P_E_T_K_N_R_L".split("_"),weekdaysMin:"P_E_T_K_N_R_L".split("_"),longDateFormat:{LT:"H:mm",LTS:"H:mm:ss",L:"DD.MM.YYYY",LL:"D. MMMM YYYY",LLL:"D. MMMM YYYY H:mm",LLLL:"dddd, D. MMMM YYYY H:mm"},calendar:{sameDay:"[Tna,] LT",nextDay:"[Homme,] LT",nextWeek:"[Jrgmine] dddd LT",lastDay:"[Eile,] LT",lastWeek:"[Eelmine] dddd LT",sameElse:"L"},relativeTime:{future:"%s prast",past:"%s tagasi",s:zs,ss:zs,m:zs,mm:zs,h:zs,hh:zs,d:zs,dd:"%d peva",M:zs,MM:zs,y:zs,yy:zs},dayOfMonthOrdinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:4}}),l.defineLocale("eu",{months:"urtarrila_otsaila_martxoa_apirila_maiatza_ekaina_uztaila_abuztua_iraila_urria_azaroa_abendua".split("_"),monthsShort:"urt._ots._mar._api._mai._eka._uzt._abu._ira._urr._aza._abe.".split("_"),monthsParseExact:!0,weekdays:"igandea_astelehena_asteartea_asteazkena_osteguna_ostirala_larunbata".split("_"),weekdaysShort:"ig._al._ar._az._og._ol._lr.".split("_"),weekdaysMin:"ig_al_ar_az_og_ol_lr".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"YYYY-MM-DD",LL:"YYYY[ko] MMMM[ren] D[a]",LLL:"YYYY[ko] MMMM[ren] D[a] HH:mm",LLLL:"dddd, YYYY[ko] MMMM[ren] D[a] HH:mm",l:"YYYY-M-D",ll:"YYYY[ko] MMM D[a]",lll:"YYYY[ko] MMM D[a] HH:mm",llll:"ddd, YYYY[ko] MMM D[a] HH:mm"},calendar:{sameDay:"[gaur] LT[etan]",nextDay:"[bihar] LT[etan]",nextWeek:"dddd LT[etan]",lastDay:"[atzo] LT[etan]",lastWeek:"[aurreko] dddd LT[etan]",sameElse:"L"},relativeTime:{future:"%s barru",past:"duela %s",s:"segundo batzuk",ss:"%d segundo",m:"minutu bat",mm:"%d minutu",h:"ordu bat",hh:"%d ordu",d:"egun bat",dd:"%d egun",M:"hilabete bat",MM:"%d hilabete",y:"urte bat",yy:"%d urte"},dayOfMonthOrdinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:7}});var Js={1:"",2:"",3:"",4:"",5:"",6:"",7:"",8:"",9:"",0:""},Ns={"":"1","":"2","":"3","":"4","":"5","":"6","":"7","":"8","":"9","":"0"};l.defineLocale("fa",{months:"___________".split("_"),monthsShort:"___________".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd, D MMMM YYYY HH:mm"},meridiemParse:/\u0642\u0628\u0644 \u0627\u0632 \u0638\u0647\u0631|\u0628\u0639\u062f \u0627\u0632 \u0638\u0647\u0631/,isPM:function(e){return/\u0628\u0639\u062f \u0627\u0632 \u0638\u0647\u0631/.test(e)},meridiem:function(e,a,t){return e<12?"  ":"  "},calendar:{sameDay:"[ ] LT",nextDay:"[ ] LT",nextWeek:"dddd [] LT",lastDay:"[ ] LT",lastWeek:"dddd [] [] LT",sameElse:"L"},relativeTime:{future:" %s",past:"%s ",s:" ",ss:" d%",m:" ",mm:"%d ",h:" ",hh:"%d ",d:" ",dd:"%d ",M:" ",MM:"%d ",y:" ",yy:"%d "},preparse:function(e){return e.replace(/[\u06f0-\u06f9]/g,function(e){return Ns[e]}).replace(/\u060c/g,",")},postformat:function(e){return e.replace(/\d/g,function(e){return Js[e]}).replace(/,/g,"")},dayOfMonthOrdinalParse:/\d{1,2}\u0645/,ordinal:"%d",week:{dow:6,doy:12}});var Rs="nolla yksi kaksi kolme nelj viisi kuusi seitsemn kahdeksan yhdeksn".split(" "),Cs=["nolla","yhden","kahden","kolmen","neljn","viiden","kuuden",Rs[7],Rs[8],Rs[9]];function Is(e,a,t,s){var n,r="";switch(t){case"s":return s?"muutaman sekunnin":"muutama sekunti";case"ss":return s?"sekunnin":"sekuntia";case"m":return s?"minuutin":"minuutti";case"mm":r=s?"minuutin":"minuuttia";break;case"h":return s?"tunnin":"tunti";case"hh":r=s?"tunnin":"tuntia";break;case"d":return s?"pivn":"piv";case"dd":r=s?"pivn":"piv";break;case"M":return s?"kuukauden":"kuukausi";case"MM":r=s?"kuukauden":"kuukautta";break;case"y":return s?"vuoden":"vuosi";case"yy":r=s?"vuoden":"vuotta"}return((n=e)<10?s?Cs[n]:Rs[n]:n)+" "+r}l.defineLocale("fi",{months:"tammikuu_helmikuu_maaliskuu_huhtikuu_toukokuu_keskuu_heinkuu_elokuu_syyskuu_lokakuu_marraskuu_joulukuu".split("_"),monthsShort:"tammi_helmi_maalis_huhti_touko_kes_hein_elo_syys_loka_marras_joulu".split("_"),weekdays:"sunnuntai_maanantai_tiistai_keskiviikko_torstai_perjantai_lauantai".split("_"),weekdaysShort:"su_ma_ti_ke_to_pe_la".split("_"),weekdaysMin:"su_ma_ti_ke_to_pe_la".split("_"),longDateFormat:{LT:"HH.mm",LTS:"HH.mm.ss",L:"DD.MM.YYYY",LL:"Do MMMM[ta] YYYY",LLL:"Do MMMM[ta] YYYY, [klo] HH.mm",LLLL:"dddd, Do MMMM[ta] YYYY, [klo] HH.mm",l:"D.M.YYYY",ll:"Do MMM YYYY",lll:"Do MMM YYYY, [klo] HH.mm",llll:"ddd, Do MMM YYYY, [klo] HH.mm"},calendar:{sameDay:"[tnn] [klo] LT",nextDay:"[huomenna] [klo] LT",nextWeek:"dddd [klo] LT",lastDay:"[eilen] [klo] LT",lastWeek:"[viime] dddd[na] [klo] LT",sameElse:"L"},relativeTime:{future:"%s pst",past:"%s sitten",s:Is,ss:Is,m:Is,mm:Is,h:Is,hh:Is,d:Is,dd:Is,M:Is,MM:Is,y:Is,yy:Is},dayOfMonthOrdinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:4}}),l.defineLocale("fo",{months:"januar_februar_mars_aprl_mai_juni_juli_august_september_oktober_november_desember".split("_"),monthsShort:"jan_feb_mar_apr_mai_jun_jul_aug_sep_okt_nov_des".split("_"),weekdays:"sunnudagur_mnadagur_tsdagur_mikudagur_hsdagur_frggjadagur_leygardagur".split("_"),weekdaysShort:"sun_mn_ts_mik_hs_fr_ley".split("_"),weekdaysMin:"su_m_t_mi_h_fr_le".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd D. MMMM, YYYY HH:mm"},calendar:{sameDay:"[ dag kl.] LT",nextDay:"[ morgin kl.] LT",nextWeek:"dddd [kl.] LT",lastDay:"[ gjr kl.] LT",lastWeek:"[sstu] dddd [kl] LT",sameElse:"L"},relativeTime:{future:"um %s",past:"%s sani",s:"f sekund",ss:"%d sekundir",m:"ein minuttur",mm:"%d minuttir",h:"ein tmi",hh:"%d tmar",d:"ein dagur",dd:"%d dagar",M:"ein mnaur",MM:"%d mnair",y:"eitt r",yy:"%d r"},dayOfMonthOrdinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:4}}),l.defineLocale("fr-ca",{months:"janvier_fvrier_mars_avril_mai_juin_juillet_aot_septembre_octobre_novembre_dcembre".split("_"),monthsShort:"janv._fvr._mars_avr._mai_juin_juil._aot_sept._oct._nov._dc.".split("_"),monthsParseExact:!0,weekdays:"dimanche_lundi_mardi_mercredi_jeudi_vendredi_samedi".split("_"),weekdaysShort:"dim._lun._mar._mer._jeu._ven._sam.".split("_"),weekdaysMin:"di_lu_ma_me_je_ve_sa".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"YYYY-MM-DD",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd D MMMM YYYY HH:mm"},calendar:{sameDay:"[Aujourdhui ] LT",nextDay:"[Demain ] LT",nextWeek:"dddd [] LT",lastDay:"[Hier ] LT",lastWeek:"dddd [dernier ] LT",sameElse:"L"},relativeTime:{future:"dans %s",past:"il y a %s",s:"quelques secondes",ss:"%d secondes",m:"une minute",mm:"%d minutes",h:"une heure",hh:"%d heures",d:"un jour",dd:"%d jours",M:"un mois",MM:"%d mois",y:"un an",yy:"%d ans"},dayOfMonthOrdinalParse:/\d{1,2}(er|e)/,ordinal:function(e,a){switch(a){default:case"M":case"Q":case"D":case"DDD":case"d":return e+(1===e?"er":"e");case"w":case"W":return e+(1===e?"re":"e")}}}),l.defineLocale("fr-ch",{months:"janvier_fvrier_mars_avril_mai_juin_juillet_aot_septembre_octobre_novembre_dcembre".split("_"),monthsShort:"janv._fvr._mars_avr._mai_juin_juil._aot_sept._oct._nov._dc.".split("_"),monthsParseExact:!0,weekdays:"dimanche_lundi_mardi_mercredi_jeudi_vendredi_samedi".split("_"),weekdaysShort:"dim._lun._mar._mer._jeu._ven._sam.".split("_"),weekdaysMin:"di_lu_ma_me_je_ve_sa".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD.MM.YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd D MMMM YYYY HH:mm"},calendar:{sameDay:"[Aujourdhui ] LT",nextDay:"[Demain ] LT",nextWeek:"dddd [] LT",lastDay:"[Hier ] LT",lastWeek:"dddd [dernier ] LT",sameElse:"L"},relativeTime:{future:"dans %s",past:"il y a %s",s:"quelques secondes",ss:"%d secondes",m:"une minute",mm:"%d minutes",h:"une heure",hh:"%d heures",d:"un jour",dd:"%d jours",M:"un mois",MM:"%d mois",y:"un an",yy:"%d ans"},dayOfMonthOrdinalParse:/\d{1,2}(er|e)/,ordinal:function(e,a){switch(a){default:case"M":case"Q":case"D":case"DDD":case"d":return e+(1===e?"er":"e");case"w":case"W":return e+(1===e?"re":"e")}},week:{dow:1,doy:4}}),l.defineLocale("fr",{months:"janvier_fvrier_mars_avril_mai_juin_juillet_aot_septembre_octobre_novembre_dcembre".split("_"),monthsShort:"janv._fvr._mars_avr._mai_juin_juil._aot_sept._oct._nov._dc.".split("_"),monthsParseExact:!0,weekdays:"dimanche_lundi_mardi_mercredi_jeudi_vendredi_samedi".split("_"),weekdaysShort:"dim._lun._mar._mer._jeu._ven._sam.".split("_"),weekdaysMin:"di_lu_ma_me_je_ve_sa".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd D MMMM YYYY HH:mm"},calendar:{sameDay:"[Aujourdhui ] LT",nextDay:"[Demain ] LT",nextWeek:"dddd [] LT",lastDay:"[Hier ] LT",lastWeek:"dddd [dernier ] LT",sameElse:"L"},relativeTime:{future:"dans %s",past:"il y a %s",s:"quelques secondes",ss:"%d secondes",m:"une minute",mm:"%d minutes",h:"une heure",hh:"%d heures",d:"un jour",dd:"%d jours",M:"un mois",MM:"%d mois",y:"un an",yy:"%d ans"},dayOfMonthOrdinalParse:/\d{1,2}(er|)/,ordinal:function(e,a){switch(a){case"D":return e+(1===e?"er":"");default:case"M":case"Q":case"DDD":case"d":return e+(1===e?"er":"e");case"w":case"W":return e+(1===e?"re":"e")}},week:{dow:1,doy:4}});var Us="jan._feb._mrt._apr._mai_jun._jul._aug._sep._okt._nov._des.".split("_"),Gs="jan_feb_mrt_apr_mai_jun_jul_aug_sep_okt_nov_des".split("_");function Vs(e,a,t,s){var n={s:["thodde secondanim","thodde second"],ss:[e+" secondanim",e+" second"],m:["eka mintan","ek minute"],mm:[e+" mintanim",e+" mintam"],h:["eka voran","ek vor"],hh:[e+" voranim",e+" voram"],d:["eka disan","ek dis"],dd:[e+" disanim",e+" dis"],M:["eka mhoinean","ek mhoino"],MM:[e+" mhoineanim",e+" mhoine"],y:["eka vorsan","ek voros"],yy:[e+" vorsanim",e+" vorsam"]};return a?n[t][0]:n[t][1]}l.defineLocale("fy",{months:"jannewaris_febrewaris_maart_april_maaie_juny_july_augustus_septimber_oktober_novimber_desimber".split("_"),monthsShort:function(e,a){return e?/-MMM-/.test(a)?Gs[e.month()]:Us[e.month()]:Us},monthsParseExact:!0,weekdays:"snein_moandei_tiisdei_woansdei_tongersdei_freed_sneon".split("_"),weekdaysShort:"si._mo._ti._wo._to._fr._so.".split("_"),weekdaysMin:"Si_Mo_Ti_Wo_To_Fr_So".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD-MM-YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd D MMMM YYYY HH:mm"},calendar:{sameDay:"[hjoed om] LT",nextDay:"[moarn om] LT",nextWeek:"dddd [om] LT",lastDay:"[juster om] LT",lastWeek:"[frne] dddd [om] LT",sameElse:"L"},relativeTime:{future:"oer %s",past:"%s lyn",s:"in pear sekonden",ss:"%d sekonden",m:"ien mint",mm:"%d minuten",h:"ien oere",hh:"%d oeren",d:"ien dei",dd:"%d dagen",M:"ien moanne",MM:"%d moannen",y:"ien jier",yy:"%d jierren"},dayOfMonthOrdinalParse:/\d{1,2}(ste|de)/,ordinal:function(e){return e+(1===e||8===e||20<=e?"ste":"de")},week:{dow:1,doy:4}}),l.defineLocale("ga",{months:["Eanir","Feabhra","Mrta","Aibren","Bealtaine","Mitheamh","Iil","Lnasa","Men Fmhair","Deaireadh Fmhair","Samhain","Nollaig"],monthsShort:["Ean","Feab","Mrt","Aibr","Beal","Mit","Iil","Lna","Men","Deai","Samh","Noll"],monthsParseExact:!0,weekdays:["D Domhnaigh","D Luain","D Mirt","D Cadaoin","Dardaoin","D hAoine","D Satharn"],weekdaysShort:["Dom","Lua","Mi","Ca","Da","hAo","Sat"],weekdaysMin:["Do","Lu","M","Ce","D","hA","Sa"],longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd, D MMMM YYYY HH:mm"},calendar:{sameDay:"[Inniu ag] LT",nextDay:"[Amrach ag] LT",nextWeek:"dddd [ag] LT",lastDay:"[Inn aig] LT",lastWeek:"dddd [seo caite] [ag] LT",sameElse:"L"},relativeTime:{future:"i %s",past:"%s  shin",s:"cpla soicind",ss:"%d soicind",m:"nimad",mm:"%d nimad",h:"uair an chloig",hh:"%d uair an chloig",d:"l",dd:"%d l",M:"m",MM:"%d m",y:"bliain",yy:"%d bliain"},dayOfMonthOrdinalParse:/\d{1,2}(d|na|mh)/,ordinal:function(e){return e+(1===e?"d":e%10==2?"na":"mh")},week:{dow:1,doy:4}}),l.defineLocale("gd",{months:["Am Faoilleach","An Gearran","Am Mrt","An Giblean","An Citean","An t-gmhios","An t-Iuchar","An Lnastal","An t-Sultain","An Dmhair","An t-Samhain","An Dbhlachd"],monthsShort:["Faoi","Gear","Mrt","Gibl","Cit","gmh","Iuch","Ln","Sult","Dmh","Samh","Dbh"],monthsParseExact:!0,weekdays:["Didmhnaich","Diluain","Dimirt","Diciadain","Diardaoin","Dihaoine","Disathairne"],weekdaysShort:["Did","Dil","Dim","Dic","Dia","Dih","Dis"],weekdaysMin:["D","Lu","M","Ci","Ar","Ha","Sa"],longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd, D MMMM YYYY HH:mm"},calendar:{sameDay:"[An-diugh aig] LT",nextDay:"[A-mireach aig] LT",nextWeek:"dddd [aig] LT",lastDay:"[An-d aig] LT",lastWeek:"dddd [seo chaidh] [aig] LT",sameElse:"L"},relativeTime:{future:"ann an %s",past:"bho chionn %s",s:"beagan diogan",ss:"%d diogan",m:"mionaid",mm:"%d mionaidean",h:"uair",hh:"%d uairean",d:"latha",dd:"%d latha",M:"mos",MM:"%d mosan",y:"bliadhna",yy:"%d bliadhna"},dayOfMonthOrdinalParse:/\d{1,2}(d|na|mh)/,ordinal:function(e){return e+(1===e?"d":e%10==2?"na":"mh")},week:{dow:1,doy:4}}),l.defineLocale("gl",{months:"xaneiro_febreiro_marzo_abril_maio_xuo_xullo_agosto_setembro_outubro_novembro_decembro".split("_"),monthsShort:"xan._feb._mar._abr._mai._xu._xul._ago._set._out._nov._dec.".split("_"),monthsParseExact:!0,weekdays:"domingo_luns_martes_mrcores_xoves_venres_sbado".split("_"),weekdaysShort:"dom._lun._mar._mr._xov._ven._sb.".split("_"),weekdaysMin:"do_lu_ma_m_xo_ve_s".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"H:mm",LTS:"H:mm:ss",L:"DD/MM/YYYY",LL:"D [de] MMMM [de] YYYY",LLL:"D [de] MMMM [de] YYYY H:mm",LLLL:"dddd, D [de] MMMM [de] YYYY H:mm"},calendar:{sameDay:function(){return"[hoxe "+(1!==this.hours()?"s":"")+"] LT"},nextDay:function(){return"[ma "+(1!==this.hours()?"s":"")+"] LT"},nextWeek:function(){return"dddd ["+(1!==this.hours()?"s":"a")+"] LT"},lastDay:function(){return"[onte "+(1!==this.hours()?"":"a")+"] LT"},lastWeek:function(){return"[o] dddd [pasado "+(1!==this.hours()?"s":"a")+"] LT"},sameElse:"L"},relativeTime:{future:function(e){return 0===e.indexOf("un")?"n"+e:"en "+e},past:"hai %s",s:"uns segundos",ss:"%d segundos",m:"un minuto",mm:"%d minutos",h:"unha hora",hh:"%d horas",d:"un da",dd:"%d das",M:"un mes",MM:"%d meses",y:"un ano",yy:"%d anos"},dayOfMonthOrdinalParse:/\d{1,2}\xba/,ordinal:"%d",week:{dow:1,doy:4}}),l.defineLocale("gom-latn",{months:"Janer_Febrer_Mars_Abril_Mai_Jun_Julai_Agost_Setembr_Otubr_Novembr_Dezembr".split("_"),monthsShort:"Jan._Feb._Mars_Abr._Mai_Jun_Jul._Ago._Set._Otu._Nov._Dez.".split("_"),monthsParseExact:!0,weekdays:"Aitar_Somar_Mongllar_Budvar_Brestar_Sukrar_Son'var".split("_"),weekdaysShort:"Ait._Som._Mon._Bud._Bre._Suk._Son.".split("_"),weekdaysMin:"Ai_Sm_Mo_Bu_Br_Su_Sn".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"A h:mm [vazta]",LTS:"A h:mm:ss [vazta]",L:"DD-MM-YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY A h:mm [vazta]",LLLL:"dddd, MMMM[achea] Do, YYYY, A h:mm [vazta]",llll:"ddd, D MMM YYYY, A h:mm [vazta]"},calendar:{sameDay:"[Aiz] LT",nextDay:"[Faleam] LT",nextWeek:"[Ieta to] dddd[,] LT",lastDay:"[Kal] LT",lastWeek:"[Fatlo] dddd[,] LT",sameElse:"L"},relativeTime:{future:"%s",past:"%s adim",s:Vs,ss:Vs,m:Vs,mm:Vs,h:Vs,hh:Vs,d:Vs,dd:Vs,M:Vs,MM:Vs,y:Vs,yy:Vs},dayOfMonthOrdinalParse:/\d{1,2}(er)/,ordinal:function(e,a){switch(a){case"D":return e+"er";default:case"M":case"Q":case"DDD":case"d":case"w":case"W":return e}},week:{dow:1,doy:4},meridiemParse:/rati|sokalli|donparam|sanje/,meridiemHour:function(e,a){return 12===e&&(e=0),"rati"===a?e<4?e:e+12:"sokalli"===a?e:"donparam"===a?12<e?e:e+12:"sanje"===a?e+12:void 0},meridiem:function(e,a,t){return e<4?"rati":e<12?"sokalli":e<16?"donparam":e<20?"sanje":"rati"}});var Ks={1:"",2:"",3:"",4:"",5:"",6:"",7:"",8:"",9:"",0:""},Zs={"":"1","":"2","":"3","":"4","":"5","":"6","":"7","":"8","":"9","":"0"};l.defineLocale("gu",{months:"___________".split("_"),monthsShort:"._.__.___._._._._._.".split("_"),monthsParseExact:!0,weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"A h:mm ",LTS:"A h:mm:ss ",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY, A h:mm ",LLLL:"dddd, D MMMM YYYY, A h:mm "},calendar:{sameDay:"[] LT",nextDay:"[] LT",nextWeek:"dddd, LT",lastDay:"[] LT",lastWeek:"[] dddd, LT",sameElse:"L"},relativeTime:{future:"%s ",past:"%s ",s:" ",ss:"%d ",m:" ",mm:"%d ",h:" ",hh:"%d ",d:" ",dd:"%d ",M:" ",MM:"%d ",y:" ",yy:"%d "},preparse:function(e){return e.replace(/[\u0ae7\u0ae8\u0ae9\u0aea\u0aeb\u0aec\u0aed\u0aee\u0aef\u0ae6]/g,function(e){return Zs[e]})},postformat:function(e){return e.replace(/\d/g,function(e){return Ks[e]})},meridiemParse:/\u0ab0\u0abe\u0aa4|\u0aac\u0aaa\u0acb\u0ab0|\u0ab8\u0ab5\u0abe\u0ab0|\u0ab8\u0abe\u0a82\u0a9c/,meridiemHour:function(e,a){return 12===e&&(e=0),""===a?e<4?e:e+12:""===a?e:""===a?10<=e?e:e+12:""===a?e+12:void 0},meridiem:function(e,a,t){return e<4?"":e<10?"":e<17?"":e<20?"":""},week:{dow:0,doy:6}}),l.defineLocale("he",{months:"___________".split("_"),monthsShort:"___________".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D []MMMM YYYY",LLL:"D []MMMM YYYY HH:mm",LLLL:"dddd, D []MMMM YYYY HH:mm",l:"D/M/YYYY",ll:"D MMM YYYY",lll:"D MMM YYYY HH:mm",llll:"ddd, D MMM YYYY HH:mm"},calendar:{sameDay:"[ ]LT",nextDay:"[ ]LT",nextWeek:"dddd [] LT",lastDay:"[ ]LT",lastWeek:"[] dddd [ ] LT",sameElse:"L"},relativeTime:{future:" %s",past:" %s",s:" ",ss:"%d ",m:"",mm:"%d ",h:"",hh:function(e){return 2===e?"":e+" "},d:"",dd:function(e){return 2===e?"":e+" "},M:"",MM:function(e){return 2===e?"":e+" "},y:"",yy:function(e){return 2===e?"":e%10==0&&10!==e?e+" ":e+" "}},meridiemParse:/\u05d0\u05d7\u05d4"\u05e6|\u05dc\u05e4\u05e0\u05d4"\u05e6|\u05d0\u05d7\u05e8\u05d9 \u05d4\u05e6\u05d4\u05e8\u05d9\u05d9\u05dd|\u05dc\u05e4\u05e0\u05d9 \u05d4\u05e6\u05d4\u05e8\u05d9\u05d9\u05dd|\u05dc\u05e4\u05e0\u05d5\u05ea \u05d1\u05d5\u05e7\u05e8|\u05d1\u05d1\u05d5\u05e7\u05e8|\u05d1\u05e2\u05e8\u05d1/i,isPM:function(e){return/^(\u05d0\u05d7\u05d4"\u05e6|\u05d0\u05d7\u05e8\u05d9 \u05d4\u05e6\u05d4\u05e8\u05d9\u05d9\u05dd|\u05d1\u05e2\u05e8\u05d1)$/.test(e)},meridiem:function(e,a,t){return e<5?" ":e<10?"":e<12?t?'"':" ":e<18?t?'"':" ":""}});var $s={1:"",2:"",3:"",4:"",5:"",6:"",7:"",8:"",9:"",0:""},Bs={"":"1","":"2","":"3","":"4","":"5","":"6","":"7","":"8","":"9","":"0"};function qs(e,a,t){var s=e+" ";switch(t){case"ss":return s+(1===e?"sekunda":2===e||3===e||4===e?"sekunde":"sekundi");case"m":return a?"jedna minuta":"jedne minute";case"mm":return s+(1===e?"minuta":2===e||3===e||4===e?"minute":"minuta");case"h":return a?"jedan sat":"jednog sata";case"hh":return s+(1===e?"sat":2===e||3===e||4===e?"sata":"sati");case"dd":return s+(1===e?"dan":"dana");case"MM":return s+(1===e?"mjesec":2===e||3===e||4===e?"mjeseca":"mjeseci");case"yy":return s+(1===e?"godina":2===e||3===e||4===e?"godine":"godina")}}l.defineLocale("hi",{months:"___________".split("_"),monthsShort:"._.__.___._._._._._.".split("_"),monthsParseExact:!0,weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"A h:mm ",LTS:"A h:mm:ss ",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY, A h:mm ",LLLL:"dddd, D MMMM YYYY, A h:mm "},calendar:{sameDay:"[] LT",nextDay:"[] LT",nextWeek:"dddd, LT",lastDay:"[] LT",lastWeek:"[] dddd, LT",sameElse:"L"},relativeTime:{future:"%s ",past:"%s ",s:"  ",ss:"%d ",m:" ",mm:"%d ",h:" ",hh:"%d ",d:" ",dd:"%d ",M:" ",MM:"%d ",y:" ",yy:"%d "},preparse:function(e){return e.replace(/[\u0967\u0968\u0969\u096a\u096b\u096c\u096d\u096e\u096f\u0966]/g,function(e){return Bs[e]})},postformat:function(e){return e.replace(/\d/g,function(e){return $s[e]})},meridiemParse:/\u0930\u093e\u0924|\u0938\u0941\u092c\u0939|\u0926\u094b\u092a\u0939\u0930|\u0936\u093e\u092e/,meridiemHour:function(e,a){return 12===e&&(e=0),""===a?e<4?e:e+12:""===a?e:""===a?10<=e?e:e+12:""===a?e+12:void 0},meridiem:function(e,a,t){return e<4?"":e<10?"":e<17?"":e<20?"":""},week:{dow:0,doy:6}}),l.defineLocale("hr",{months:{format:"sijenja_veljae_oujka_travnja_svibnja_lipnja_srpnja_kolovoza_rujna_listopada_studenoga_prosinca".split("_"),standalone:"sijeanj_veljaa_oujak_travanj_svibanj_lipanj_srpanj_kolovoz_rujan_listopad_studeni_prosinac".split("_")},monthsShort:"sij._velj._ou._tra._svi._lip._srp._kol._ruj._lis._stu._pro.".split("_"),monthsParseExact:!0,weekdays:"nedjelja_ponedjeljak_utorak_srijeda_etvrtak_petak_subota".split("_"),weekdaysShort:"ned._pon._uto._sri._et._pet._sub.".split("_"),weekdaysMin:"ne_po_ut_sr_e_pe_su".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"H:mm",LTS:"H:mm:ss",L:"DD.MM.YYYY",LL:"D. MMMM YYYY",LLL:"D. MMMM YYYY H:mm",LLLL:"dddd, D. MMMM YYYY H:mm"},calendar:{sameDay:"[danas u] LT",nextDay:"[sutra u] LT",nextWeek:function(){switch(this.day()){case 0:return"[u] [nedjelju] [u] LT";case 3:return"[u] [srijedu] [u] LT";case 6:return"[u] [subotu] [u] LT";case 1:case 2:case 4:case 5:return"[u] dddd [u] LT"}},lastDay:"[juer u] LT",lastWeek:function(){switch(this.day()){case 0:case 3:return"[prolu] dddd [u] LT";case 6:return"[prole] [subote] [u] LT";case 1:case 2:case 4:case 5:return"[proli] dddd [u] LT"}},sameElse:"L"},relativeTime:{future:"za %s",past:"prije %s",s:"par sekundi",ss:qs,m:qs,mm:qs,h:qs,hh:qs,d:"dan",dd:qs,M:"mjesec",MM:qs,y:"godinu",yy:qs},dayOfMonthOrdinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:7}});var Qs="vasrnap htfn kedden szerdn cstrtkn pnteken szombaton".split(" ");function Xs(e,a,t,s){var n=e;switch(t){case"s":return s||a?"nhny msodperc":"nhny msodperce";case"ss":return n+(s||a)?" msodperc":" msodperce";case"m":return"egy"+(s||a?" perc":" perce");case"mm":return n+(s||a?" perc":" perce");case"h":return"egy"+(s||a?" ra":" rja");case"hh":return n+(s||a?" ra":" rja");case"d":return"egy"+(s||a?" nap":" napja");case"dd":return n+(s||a?" nap":" napja");case"M":return"egy"+(s||a?" hnap":" hnapja");case"MM":return n+(s||a?" hnap":" hnapja");case"y":return"egy"+(s||a?" v":" ve");case"yy":return n+(s||a?" v":" ve")}return""}function en(e){return(e?"":"[mlt] ")+"["+Qs[this.day()]+"] LT[-kor]"}function an(e){return e%100==11||e%10!=1}function tn(e,a,t,s){var n=e+" ";switch(t){case"s":return a||s?"nokkrar sekndur":"nokkrum sekndum";case"ss":return an(e)?n+(a||s?"sekndur":"sekndum"):n+"seknda";case"m":return a?"mnta":"mntu";case"mm":return an(e)?n+(a||s?"mntur":"mntum"):a?n+"mnta":n+"mntu";case"hh":return an(e)?n+(a||s?"klukkustundir":"klukkustundum"):n+"klukkustund";case"d":return a?"dagur":s?"dag":"degi";case"dd":return an(e)?a?n+"dagar":n+(s?"daga":"dgum"):a?n+"dagur":n+(s?"dag":"degi");case"M":return a?"mnuur":s?"mnu":"mnui";case"MM":return an(e)?a?n+"mnuir":n+(s?"mnui":"mnuum"):a?n+"mnuur":n+(s?"mnu":"mnui");case"y":return a||s?"r":"ri";case"yy":return an(e)?n+(a||s?"r":"rum"):n+(a||s?"r":"ri")}}l.defineLocale("hu",{months:"janur_februr_mrcius_prilis_mjus_jnius_jlius_augusztus_szeptember_oktber_november_december".split("_"),monthsShort:"jan_feb_mrc_pr_mj_jn_jl_aug_szept_okt_nov_dec".split("_"),weekdays:"vasrnap_htf_kedd_szerda_cstrtk_pntek_szombat".split("_"),weekdaysShort:"vas_ht_kedd_sze_cst_pn_szo".split("_"),weekdaysMin:"v_h_k_sze_cs_p_szo".split("_"),longDateFormat:{LT:"H:mm",LTS:"H:mm:ss",L:"YYYY.MM.DD.",LL:"YYYY. MMMM D.",LLL:"YYYY. MMMM D. H:mm",LLLL:"YYYY. MMMM D., dddd H:mm"},meridiemParse:/de|du/i,isPM:function(e){return"u"===e.charAt(1).toLowerCase()},meridiem:function(e,a,t){return e<12?!0===t?"de":"DE":!0===t?"du":"DU"},calendar:{sameDay:"[ma] LT[-kor]",nextDay:"[holnap] LT[-kor]",nextWeek:function(){return en.call(this,!0)},lastDay:"[tegnap] LT[-kor]",lastWeek:function(){return en.call(this,!1)},sameElse:"L"},relativeTime:{future:"%s mlva",past:"%s",s:Xs,ss:Xs,m:Xs,mm:Xs,h:Xs,hh:Xs,d:Xs,dd:Xs,M:Xs,MM:Xs,y:Xs,yy:Xs},dayOfMonthOrdinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:4}}),l.defineLocale("hy-am",{months:{format:"___________".split("_"),standalone:"___________".split("_")},monthsShort:"___________".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD.MM.YYYY",LL:"D MMMM YYYY .",LLL:"D MMMM YYYY ., HH:mm",LLLL:"dddd, D MMMM YYYY ., HH:mm"},calendar:{sameDay:"[] LT",nextDay:"[] LT",lastDay:"[] LT",nextWeek:function(){return"dddd [ ] LT"},lastWeek:function(){return"[] dddd [ ] LT"},sameElse:"L"},relativeTime:{future:"%s ",past:"%s ",s:"  ",ss:"%d ",m:"",mm:"%d ",h:"",hh:"%d ",d:"",dd:"%d ",M:"",MM:"%d ",y:"",yy:"%d "},meridiemParse:/\u0563\u056b\u0577\u0565\u0580\u057e\u0561|\u0561\u057c\u0561\u057e\u0578\u057f\u057e\u0561|\u0581\u0565\u0580\u0565\u056f\u057e\u0561|\u0565\u0580\u0565\u056f\u0578\u0575\u0561\u0576/,isPM:function(e){return/^(\u0581\u0565\u0580\u0565\u056f\u057e\u0561|\u0565\u0580\u0565\u056f\u0578\u0575\u0561\u0576)$/.test(e)},meridiem:function(e){return e<4?"":e<12?"":e<17?"":""},dayOfMonthOrdinalParse:/\d{1,2}|\d{1,2}-(\u056b\u0576|\u0580\u0564)/,ordinal:function(e,a){switch(a){case"DDD":case"w":case"W":case"DDDo":return 1===e?e+"-":e+"-";default:return e}},week:{dow:1,doy:7}}),l.defineLocale("id",{months:"Januari_Februari_Maret_April_Mei_Juni_Juli_Agustus_September_Oktober_November_Desember".split("_"),monthsShort:"Jan_Feb_Mar_Apr_Mei_Jun_Jul_Agt_Sep_Okt_Nov_Des".split("_"),weekdays:"Minggu_Senin_Selasa_Rabu_Kamis_Jumat_Sabtu".split("_"),weekdaysShort:"Min_Sen_Sel_Rab_Kam_Jum_Sab".split("_"),weekdaysMin:"Mg_Sn_Sl_Rb_Km_Jm_Sb".split("_"),longDateFormat:{LT:"HH.mm",LTS:"HH.mm.ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY [pukul] HH.mm",LLLL:"dddd, D MMMM YYYY [pukul] HH.mm"},meridiemParse:/pagi|siang|sore|malam/,meridiemHour:function(e,a){return 12===e&&(e=0),"pagi"===a?e:"siang"===a?11<=e?e:e+12:"sore"===a||"malam"===a?e+12:void 0},meridiem:function(e,a,t){return e<11?"pagi":e<15?"siang":e<19?"sore":"malam"},calendar:{sameDay:"[Hari ini pukul] LT",nextDay:"[Besok pukul] LT",nextWeek:"dddd [pukul] LT",lastDay:"[Kemarin pukul] LT",lastWeek:"dddd [lalu pukul] LT",sameElse:"L"},relativeTime:{future:"dalam %s",past:"%s yang lalu",s:"beberapa detik",ss:"%d detik",m:"semenit",mm:"%d menit",h:"sejam",hh:"%d jam",d:"sehari",dd:"%d hari",M:"sebulan",MM:"%d bulan",y:"setahun",yy:"%d tahun"},week:{dow:1,doy:7}}),l.defineLocale("is",{months:"janar_febrar_mars_aprl_ma_jn_jl_gst_september_oktber_nvember_desember".split("_"),monthsShort:"jan_feb_mar_apr_ma_jn_jl_g_sep_okt_nv_des".split("_"),weekdays:"sunnudagur_mnudagur_rijudagur_mivikudagur_fimmtudagur_fstudagur_laugardagur".split("_"),weekdaysShort:"sun_mn_ri_mi_fim_fs_lau".split("_"),weekdaysMin:"Su_M_r_Mi_Fi_F_La".split("_"),longDateFormat:{LT:"H:mm",LTS:"H:mm:ss",L:"DD.MM.YYYY",LL:"D. MMMM YYYY",LLL:"D. MMMM YYYY [kl.] H:mm",LLLL:"dddd, D. MMMM YYYY [kl.] H:mm"},calendar:{sameDay:"[ dag kl.] LT",nextDay:"[ morgun kl.] LT",nextWeek:"dddd [kl.] LT",lastDay:"[ gr kl.] LT",lastWeek:"[sasta] dddd [kl.] LT",sameElse:"L"},relativeTime:{future:"eftir %s",past:"fyrir %s san",s:tn,ss:tn,m:tn,mm:tn,h:"klukkustund",hh:tn,d:tn,dd:tn,M:tn,MM:tn,y:tn,yy:tn},dayOfMonthOrdinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:4}}),l.defineLocale("it-ch",{months:"gennaio_febbraio_marzo_aprile_maggio_giugno_luglio_agosto_settembre_ottobre_novembre_dicembre".split("_"),monthsShort:"gen_feb_mar_apr_mag_giu_lug_ago_set_ott_nov_dic".split("_"),weekdays:"domenica_luned_marted_mercoled_gioved_venerd_sabato".split("_"),weekdaysShort:"dom_lun_mar_mer_gio_ven_sab".split("_"),weekdaysMin:"do_lu_ma_me_gi_ve_sa".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD.MM.YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd D MMMM YYYY HH:mm"},calendar:{sameDay:"[Oggi alle] LT",nextDay:"[Domani alle] LT",nextWeek:"dddd [alle] LT",lastDay:"[Ieri alle] LT",lastWeek:function(){switch(this.day()){case 0:return"[la scorsa] dddd [alle] LT";default:return"[lo scorso] dddd [alle] LT"}},sameElse:"L"},relativeTime:{future:function(e){return(/^[0-9].+$/.test(e)?"tra":"in")+" "+e},past:"%s fa",s:"alcuni secondi",ss:"%d secondi",m:"un minuto",mm:"%d minuti",h:"un'ora",hh:"%d ore",d:"un giorno",dd:"%d giorni",M:"un mese",MM:"%d mesi",y:"un anno",yy:"%d anni"},dayOfMonthOrdinalParse:/\d{1,2}\xba/,ordinal:"%d",week:{dow:1,doy:4}}),l.defineLocale("it",{months:"gennaio_febbraio_marzo_aprile_maggio_giugno_luglio_agosto_settembre_ottobre_novembre_dicembre".split("_"),monthsShort:"gen_feb_mar_apr_mag_giu_lug_ago_set_ott_nov_dic".split("_"),weekdays:"domenica_luned_marted_mercoled_gioved_venerd_sabato".split("_"),weekdaysShort:"dom_lun_mar_mer_gio_ven_sab".split("_"),weekdaysMin:"do_lu_ma_me_gi_ve_sa".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd D MMMM YYYY HH:mm"},calendar:{sameDay:"[Oggi alle] LT",nextDay:"[Domani alle] LT",nextWeek:"dddd [alle] LT",lastDay:"[Ieri alle] LT",lastWeek:function(){switch(this.day()){case 0:return"[la scorsa] dddd [alle] LT";default:return"[lo scorso] dddd [alle] LT"}},sameElse:"L"},relativeTime:{future:function(e){return(/^[0-9].+$/.test(e)?"tra":"in")+" "+e},past:"%s fa",s:"alcuni secondi",ss:"%d secondi",m:"un minuto",mm:"%d minuti",h:"un'ora",hh:"%d ore",d:"un giorno",dd:"%d giorni",M:"un mese",MM:"%d mesi",y:"un anno",yy:"%d anni"},dayOfMonthOrdinalParse:/\d{1,2}\xba/,ordinal:"%d",week:{dow:1,doy:4}}),l.defineLocale("ja",{months:"___________".split("_"),monthsShort:"1_2_3_4_5_6_7_8_9_10_11_12".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"YYYY/MM/DD",LL:"YYYYMD",LLL:"YYYYMD HH:mm",LLLL:"YYYYMD dddd HH:mm",l:"YYYY/MM/DD",ll:"YYYYMD",lll:"YYYYMD HH:mm",llll:"YYYYMD(ddd) HH:mm"},meridiemParse:/\u5348\u524d|\u5348\u5f8c/i,isPM:function(e){return""===e},meridiem:function(e,a,t){return e<12?"":""},calendar:{sameDay:"[] LT",nextDay:"[] LT",nextWeek:function(e){return e.week()<this.week()?"[]dddd LT":"dddd LT"},lastDay:"[] LT",lastWeek:function(e){return this.week()<e.week()?"[]dddd LT":"dddd LT"},sameElse:"L"},dayOfMonthOrdinalParse:/\d{1,2}\u65e5/,ordinal:function(e,a){switch(a){case"d":case"D":case"DDD":return e+"";default:return e}},relativeTime:{future:"%s",past:"%s",s:"",ss:"%d",m:"1",mm:"%d",h:"1",hh:"%d",d:"1",dd:"%d",M:"1",MM:"%d",y:"1",yy:"%d"}}),l.defineLocale("jv",{months:"Januari_Februari_Maret_April_Mei_Juni_Juli_Agustus_September_Oktober_Nopember_Desember".split("_"),monthsShort:"Jan_Feb_Mar_Apr_Mei_Jun_Jul_Ags_Sep_Okt_Nop_Des".split("_"),weekdays:"Minggu_Senen_Seloso_Rebu_Kemis_Jemuwah_Septu".split("_"),weekdaysShort:"Min_Sen_Sel_Reb_Kem_Jem_Sep".split("_"),weekdaysMin:"Mg_Sn_Sl_Rb_Km_Jm_Sp".split("_"),longDateFormat:{LT:"HH.mm",LTS:"HH.mm.ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY [pukul] HH.mm",LLLL:"dddd, D MMMM YYYY [pukul] HH.mm"},meridiemParse:/enjing|siyang|sonten|ndalu/,meridiemHour:function(e,a){return 12===e&&(e=0),"enjing"===a?e:"siyang"===a?11<=e?e:e+12:"sonten"===a||"ndalu"===a?e+12:void 0},meridiem:function(e,a,t){return e<11?"enjing":e<15?"siyang":e<19?"sonten":"ndalu"},calendar:{sameDay:"[Dinten puniko pukul] LT",nextDay:"[Mbenjang pukul] LT",nextWeek:"dddd [pukul] LT",lastDay:"[Kala wingi pukul] LT",lastWeek:"dddd [kepengker pukul] LT",sameElse:"L"},relativeTime:{future:"wonten ing %s",past:"%s ingkang kepengker",s:"sawetawis detik",ss:"%d detik",m:"setunggal menit",mm:"%d menit",h:"setunggal jam",hh:"%d jam",d:"sedinten",dd:"%d dinten",M:"sewulan",MM:"%d wulan",y:"setaun",yy:"%d taun"},week:{dow:1,doy:7}}),l.defineLocale("ka",{months:{standalone:"___________".split("_"),format:"___________".split("_")},monthsShort:"___________".split("_"),weekdays:{standalone:"______".split("_"),format:"______".split("_"),isFormat:/(\u10ec\u10d8\u10dc\u10d0|\u10e8\u10d4\u10db\u10d3\u10d4\u10d2)/},weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"h:mm A",LTS:"h:mm:ss A",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY h:mm A",LLLL:"dddd, D MMMM YYYY h:mm A"},calendar:{sameDay:"[] LT[-]",nextDay:"[] LT[-]",lastDay:"[] LT[-]",nextWeek:"[] dddd LT[-]",lastWeek:"[] dddd LT-",sameElse:"L"},relativeTime:{future:function(e){return/(\u10ec\u10d0\u10db\u10d8|\u10ec\u10e3\u10d7\u10d8|\u10e1\u10d0\u10d0\u10d7\u10d8|\u10ec\u10d4\u10da\u10d8)/.test(e)?e.replace(/\u10d8$/,""):e+""},past:function(e){return/(\u10ec\u10d0\u10db\u10d8|\u10ec\u10e3\u10d7\u10d8|\u10e1\u10d0\u10d0\u10d7\u10d8|\u10d3\u10e6\u10d4|\u10d7\u10d5\u10d4)/.test(e)?e.replace(/(\u10d8|\u10d4)$/," "):/\u10ec\u10d4\u10da\u10d8/.test(e)?e.replace(/\u10ec\u10d4\u10da\u10d8$/," "):void 0},s:" ",ss:"%d ",m:"",mm:"%d ",h:"",hh:"%d ",d:"",dd:"%d ",M:"",MM:"%d ",y:"",yy:"%d "},dayOfMonthOrdinalParse:/0|1-\u10da\u10d8|\u10db\u10d4-\d{1,2}|\d{1,2}-\u10d4/,ordinal:function(e){return 0===e?e:1===e?e+"-":e<20||e<=100&&e%20==0||e%100==0?"-"+e:e+"-"},week:{dow:1,doy:7}});var sn={0:"-",1:"-",2:"-",3:"-",4:"-",5:"-",6:"-",7:"-",8:"-",9:"-",10:"-",20:"-",30:"-",40:"-",50:"-",60:"-",70:"-",80:"-",90:"-",100:"-"};l.defineLocale("kk",{months:"___________".split("_"),monthsShort:"___________".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD.MM.YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd, D MMMM YYYY HH:mm"},calendar:{sameDay:"[ ] LT",nextDay:"[ ] LT",nextWeek:"dddd [] LT",lastDay:"[ ] LT",lastWeek:"[ ] dddd [] LT",sameElse:"L"},relativeTime:{future:"%s ",past:"%s ",s:" ",ss:"%d ",m:" ",mm:"%d ",h:" ",hh:"%d ",d:" ",dd:"%d ",M:" ",MM:"%d ",y:" ",yy:"%d "},dayOfMonthOrdinalParse:/\d{1,2}-(\u0448\u0456|\u0448\u044b)/,ordinal:function(e){return e+(sn[e]||sn[e%10]||sn[100<=e?100:null])},week:{dow:1,doy:7}});var nn={1:"",2:"",3:"",4:"",5:"",6:"",7:"",8:"",9:"",0:""},dn={"":"1","":"2","":"3","":"4","":"5","":"6","":"7","":"8","":"9","":"0"};l.defineLocale("km",{months:"___________".split("_"),monthsShort:"___________".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd, D MMMM YYYY HH:mm"},meridiemParse:/\u1796\u17d2\u179a\u17b9\u1780|\u179b\u17d2\u1784\u17b6\u1785/,isPM:function(e){return""===e},meridiem:function(e,a,t){return e<12?"":""},calendar:{sameDay:"[ ] LT",nextDay:"[ ] LT",nextWeek:"dddd [] LT",lastDay:"[ ] LT",lastWeek:"dddd [] [] LT",sameElse:"L"},relativeTime:{future:"%s",past:"%s",s:"",ss:"%d ",m:"",mm:"%d ",h:"",hh:"%d ",d:"",dd:"%d ",M:"",MM:"%d ",y:"",yy:"%d "},dayOfMonthOrdinalParse:/\u1791\u17b8\d{1,2}/,ordinal:"%d",preparse:function(e){return e.replace(/[\u17e1\u17e2\u17e3\u17e4\u17e5\u17e6\u17e7\u17e8\u17e9\u17e0]/g,function(e){return dn[e]})},postformat:function(e){return e.replace(/\d/g,function(e){return nn[e]})},week:{dow:1,doy:4}});var rn={1:"",2:"",3:"",4:"",5:"",6:"",7:"",8:"",9:"",0:""},_n={"":"1","":"2","":"3","":"4","":"5","":"6","":"7","":"8","":"9","":"0"};l.defineLocale("kn",{months:"___________".split("_"),monthsShort:"___________".split("_"),monthsParseExact:!0,weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"A h:mm",LTS:"A h:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY, A h:mm",LLLL:"dddd, D MMMM YYYY, A h:mm"},calendar:{sameDay:"[] LT",nextDay:"[] LT",nextWeek:"dddd, LT",lastDay:"[] LT",lastWeek:"[] dddd, LT",sameElse:"L"},relativeTime:{future:"%s ",past:"%s ",s:" ",ss:"%d ",m:" ",mm:"%d ",h:" ",hh:"%d ",d:" ",dd:"%d ",M:" ",MM:"%d ",y:" ",yy:"%d "},preparse:function(e){return e.replace(/[\u0ce7\u0ce8\u0ce9\u0cea\u0ceb\u0cec\u0ced\u0cee\u0cef\u0ce6]/g,function(e){return _n[e]})},postformat:function(e){return e.replace(/\d/g,function(e){return rn[e]})},meridiemParse:/\u0cb0\u0cbe\u0ca4\u0ccd\u0cb0\u0cbf|\u0cac\u0cc6\u0cb3\u0cbf\u0c97\u0ccd\u0c97\u0cc6|\u0cae\u0ca7\u0ccd\u0caf\u0cbe\u0cb9\u0ccd\u0ca8|\u0cb8\u0c82\u0c9c\u0cc6/,meridiemHour:function(e,a){return 12===e&&(e=0),""===a?e<4?e:e+12:""===a?e:""===a?10<=e?e:e+12:""===a?e+12:void 0},meridiem:function(e,a,t){return e<4?"":e<10?"":e<17?"":e<20?"":""},dayOfMonthOrdinalParse:/\d{1,2}(\u0ca8\u0cc6\u0cd5)/,ordinal:function(e){return e+""},week:{dow:0,doy:6}}),l.defineLocale("ko",{months:"1_2_3_4_5_6_7_8_9_10_11_12".split("_"),monthsShort:"1_2_3_4_5_6_7_8_9_10_11_12".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"A h:mm",LTS:"A h:mm:ss",L:"YYYY.MM.DD.",LL:"YYYY MMMM D",LLL:"YYYY MMMM D A h:mm",LLLL:"YYYY MMMM D dddd A h:mm",l:"YYYY.MM.DD.",ll:"YYYY MMMM D",lll:"YYYY MMMM D A h:mm",llll:"YYYY MMMM D dddd A h:mm"},calendar:{sameDay:" LT",nextDay:" LT",nextWeek:"dddd LT",lastDay:" LT",lastWeek:" dddd LT",sameElse:"L"},relativeTime:{future:"%s ",past:"%s ",s:" ",ss:"%d",m:"1",mm:"%d",h:" ",hh:"%d",d:"",dd:"%d",M:" ",MM:"%d",y:" ",yy:"%d"},dayOfMonthOrdinalParse:/\d{1,2}(\uc77c|\uc6d4|\uc8fc)/,ordinal:function(e,a){switch(a){case"d":case"D":case"DDD":return e+"";case"M":return e+"";case"w":case"W":return e+"";default:return e}},meridiemParse:/\uc624\uc804|\uc624\ud6c4/,isPM:function(e){return""===e},meridiem:function(e,a,t){return e<12?"":""}});var on={1:"",2:"",3:"",4:"",5:"",6:"",7:"",8:"",9:"",0:""},mn={"":"1","":"2","":"3","":"4","":"5","":"6","":"7","":"8","":"9","":"0"},un=[" ","","","","","","","",""," "," "," "];l.defineLocale("ku",{months:un,monthsShort:un,weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd, D MMMM YYYY HH:mm"},meridiemParse:/\u0626\u06ce\u0648\u0627\u0631\u0647\u200c|\u0628\u0647\u200c\u06cc\u0627\u0646\u06cc/,isPM:function(e){return/\u0626\u06ce\u0648\u0627\u0631\u0647\u200c/.test(e)},meridiem:function(e,a,t){return e<12?"":""},calendar:{sameDay:"[ ] LT",nextDay:"[ ] LT",nextWeek:"dddd [] LT",lastDay:"[ ] LT",lastWeek:"dddd [] LT",sameElse:"L"},relativeTime:{future:" %s",past:"%s",s:" ",ss:" %d",m:" ",mm:"%d ",h:" ",hh:"%d ",d:" ",dd:"%d ",M:" ",MM:"%d ",y:" ",yy:"%d "},preparse:function(e){return e.replace(/[\u0661\u0662\u0663\u0664\u0665\u0666\u0667\u0668\u0669\u0660]/g,function(e){return mn[e]}).replace(/\u060c/g,",")},postformat:function(e){return e.replace(/\d/g,function(e){return on[e]}).replace(/,/g,"")},week:{dow:6,doy:12}});var ln={0:"-",1:"-",2:"-",3:"-",4:"-",5:"-",6:"-",7:"-",8:"-",9:"-",10:"-",20:"-",30:"-",40:"-",50:"-",60:"-",70:"-",80:"-",90:"-",100:"-"};function Mn(e,a,t,s){var n={m:["eng Minutt","enger Minutt"],h:["eng Stonn","enger Stonn"],d:["een Dag","engem Dag"],M:["ee Mount","engem Mount"],y:["ee Joer","engem Joer"]};return a?n[t][0]:n[t][1]}function hn(e){if(e=parseInt(e,10),isNaN(e))return!1;if(e<0)return!0;if(e<10)return 4<=e&&e<=7;if(e<100){var a=e%10;return hn(0==a?e/10:a)}if(e<1e4){for(;10<=e;)e/=10;return hn(e)}return hn(e/=1e3)}l.defineLocale("ky",{months:"___________".split("_"),monthsShort:"___________".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD.MM.YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd, D MMMM YYYY HH:mm"},calendar:{sameDay:"[ ] LT",nextDay:"[ ] LT",nextWeek:"dddd [] LT",lastDay:"[ ] LT",lastWeek:"[ ] dddd [] [] LT",sameElse:"L"},relativeTime:{future:"%s ",past:"%s ",s:" ",ss:"%d ",m:" ",mm:"%d ",h:" ",hh:"%d ",d:" ",dd:"%d ",M:" ",MM:"%d ",y:" ",yy:"%d "},dayOfMonthOrdinalParse:/\d{1,2}-(\u0447\u0438|\u0447\u044b|\u0447\u04af|\u0447\u0443)/,ordinal:function(e){return e+(ln[e]||ln[e%10]||ln[100<=e?100:null])},week:{dow:1,doy:7}}),l.defineLocale("lb",{months:"Januar_Februar_Merz_Abrll_Mee_Juni_Juli_August_September_Oktober_November_Dezember".split("_"),monthsShort:"Jan._Febr._Mrz._Abr._Mee_Jun._Jul._Aug._Sept._Okt._Nov._Dez.".split("_"),monthsParseExact:!0,weekdays:"Sonndeg_Mindeg_Dnschdeg_Mttwoch_Donneschdeg_Freideg_Samschdeg".split("_"),weekdaysShort:"So._M._D._M._Do._Fr._Sa.".split("_"),weekdaysMin:"So_M_D_M_Do_Fr_Sa".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"H:mm [Auer]",LTS:"H:mm:ss [Auer]",L:"DD.MM.YYYY",LL:"D. MMMM YYYY",LLL:"D. MMMM YYYY H:mm [Auer]",LLLL:"dddd, D. MMMM YYYY H:mm [Auer]"},calendar:{sameDay:"[Haut um] LT",sameElse:"L",nextDay:"[Muer um] LT",nextWeek:"dddd [um] LT",lastDay:"[Gschter um] LT",lastWeek:function(){switch(this.day()){case 2:case 4:return"[Leschten] dddd [um] LT";default:return"[Leschte] dddd [um] LT"}}},relativeTime:{future:function(e){return hn(e.substr(0,e.indexOf(" ")))?"a "+e:"an "+e},past:function(e){return hn(e.substr(0,e.indexOf(" ")))?"viru "+e:"virun "+e},s:"e puer Sekonnen",ss:"%d Sekonnen",m:Mn,mm:"%d Minutten",h:Mn,hh:"%d Stonnen",d:Mn,dd:"%d Deeg",M:Mn,MM:"%d Mint",y:Mn,yy:"%d Joer"},dayOfMonthOrdinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:4}}),l.defineLocale("lo",{months:"___________".split("_"),monthsShort:"___________".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd D MMMM YYYY HH:mm"},meridiemParse:/\u0e95\u0ead\u0e99\u0ec0\u0e8a\u0ebb\u0ec9\u0eb2|\u0e95\u0ead\u0e99\u0ec1\u0ea5\u0e87/,isPM:function(e){return""===e},meridiem:function(e,a,t){return e<12?"":""},calendar:{sameDay:"[] LT",nextDay:"[] LT",nextWeek:"[]dddd[] LT",lastDay:"[] LT",lastWeek:"[]dddd[] LT",sameElse:"L"},relativeTime:{future:" %s",past:"%s",s:"",ss:"%d ",m:"1 ",mm:"%d ",h:"1 ",hh:"%d ",d:"1 ",dd:"%d ",M:"1 ",MM:"%d ",y:"1 ",yy:"%d "},dayOfMonthOrdinalParse:/(\u0e97\u0eb5\u0ec8)\d{1,2}/,ordinal:function(e){return""+e}});var Ln={ss:"sekund_sekundi_sekundes",m:"minut_minuts_minut",mm:"minuts_minui_minutes",h:"valanda_valandos_valand",hh:"valandos_valand_valandas",d:"diena_dienos_dien",dd:"dienos_dien_dienas",M:"mnuo_mnesio_mnes",MM:"mnesiai_mnesi_mnesius",y:"metai_met_metus",yy:"metai_met_metus"};function cn(e,a,t,s){return a?yn(t)[0]:s?yn(t)[1]:yn(t)[2]}function Yn(e){return e%10==0||10<e&&e<20}function yn(e){return Ln[e].split("_")}function fn(e,a,t,s){var n=e+" ";return 1===e?n+cn(0,a,t[0],s):a?n+(Yn(e)?yn(t)[1]:yn(t)[0]):s?n+yn(t)[1]:n+(Yn(e)?yn(t)[1]:yn(t)[2])}l.defineLocale("lt",{months:{format:"sausio_vasario_kovo_balandio_gegus_birelio_liepos_rugpjio_rugsjo_spalio_lapkriio_gruodio".split("_"),standalone:"sausis_vasaris_kovas_balandis_gegu_birelis_liepa_rugpjtis_rugsjis_spalis_lapkritis_gruodis".split("_"),isFormat:/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?|MMMM?(\[[^\[\]]*\]|\s)+D[oD]?/},monthsShort:"sau_vas_kov_bal_geg_bir_lie_rgp_rgs_spa_lap_grd".split("_"),weekdays:{format:"sekmadien_pirmadien_antradien_treiadien_ketvirtadien_penktadien_etadien".split("_"),standalone:"sekmadienis_pirmadienis_antradienis_treiadienis_ketvirtadienis_penktadienis_etadienis".split("_"),isFormat:/dddd HH:mm/},weekdaysShort:"Sek_Pir_Ant_Tre_Ket_Pen_e".split("_"),weekdaysMin:"S_P_A_T_K_Pn_".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"YYYY-MM-DD",LL:"YYYY [m.] MMMM D [d.]",LLL:"YYYY [m.] MMMM D [d.], HH:mm [val.]",LLLL:"YYYY [m.] MMMM D [d.], dddd, HH:mm [val.]",l:"YYYY-MM-DD",ll:"YYYY [m.] MMMM D [d.]",lll:"YYYY [m.] MMMM D [d.], HH:mm [val.]",llll:"YYYY [m.] MMMM D [d.], ddd, HH:mm [val.]"},calendar:{sameDay:"[iandien] LT",nextDay:"[Rytoj] LT",nextWeek:"dddd LT",lastDay:"[Vakar] LT",lastWeek:"[Prajus] dddd LT",sameElse:"L"},relativeTime:{future:"po %s",past:"prie %s",s:function(e,a,t,s){return a?"kelios sekunds":s?"keli sekundi":"kelias sekundes"},ss:fn,m:cn,mm:fn,h:cn,hh:fn,d:cn,dd:fn,M:cn,MM:fn,y:cn,yy:fn},dayOfMonthOrdinalParse:/\d{1,2}-oji/,ordinal:function(e){return e+"-oji"},week:{dow:1,doy:4}});var kn={ss:"sekundes_sekundm_sekunde_sekundes".split("_"),m:"mintes_mintm_minte_mintes".split("_"),mm:"mintes_mintm_minte_mintes".split("_"),h:"stundas_stundm_stunda_stundas".split("_"),hh:"stundas_stundm_stunda_stundas".split("_"),d:"dienas_dienm_diena_dienas".split("_"),dd:"dienas_dienm_diena_dienas".split("_"),M:"mnea_mneiem_mnesis_mnei".split("_"),MM:"mnea_mneiem_mnesis_mnei".split("_"),y:"gada_gadiem_gads_gadi".split("_"),yy:"gada_gadiem_gads_gadi".split("_")};function pn(e,a,t){return t?a%10==1&&a%100!=11?e[2]:e[3]:a%10==1&&a%100!=11?e[0]:e[1]}function Dn(e,a,t){return e+" "+pn(kn[t],e,a)}function Tn(e,a,t){return pn(kn[t],e,a)}l.defineLocale("lv",{months:"janvris_februris_marts_aprlis_maijs_jnijs_jlijs_augusts_septembris_oktobris_novembris_decembris".split("_"),monthsShort:"jan_feb_mar_apr_mai_jn_jl_aug_sep_okt_nov_dec".split("_"),weekdays:"svtdiena_pirmdiena_otrdiena_trediena_ceturtdiena_piektdiena_sestdiena".split("_"),weekdaysShort:"Sv_P_O_T_C_Pk_S".split("_"),weekdaysMin:"Sv_P_O_T_C_Pk_S".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD.MM.YYYY.",LL:"YYYY. [gada] D. MMMM",LLL:"YYYY. [gada] D. MMMM, HH:mm",LLLL:"YYYY. [gada] D. MMMM, dddd, HH:mm"},calendar:{sameDay:"[odien pulksten] LT",nextDay:"[Rt pulksten] LT",nextWeek:"dddd [pulksten] LT",lastDay:"[Vakar pulksten] LT",lastWeek:"[Pagju] dddd [pulksten] LT",sameElse:"L"},relativeTime:{future:"pc %s",past:"pirms %s",s:function(e,a){return a?"daas sekundes":"dam sekundm"},ss:Dn,m:Tn,mm:Dn,h:Tn,hh:Dn,d:Tn,dd:Dn,M:Tn,MM:Dn,y:Tn,yy:Dn},dayOfMonthOrdinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:4}});var gn={words:{ss:["sekund","sekunda","sekundi"],m:["jedan minut","jednog minuta"],mm:["minut","minuta","minuta"],h:["jedan sat","jednog sata"],hh:["sat","sata","sati"],dd:["dan","dana","dana"],MM:["mjesec","mjeseca","mjeseci"],yy:["godina","godine","godina"]},correctGrammaticalCase:function(e,a){return 1===e?a[0]:2<=e&&e<=4?a[1]:a[2]},translate:function(e,a,t){var s=gn.words[t];return 1===t.length?a?s[0]:s[1]:e+" "+gn.correctGrammaticalCase(e,s)}};function wn(e,a,t,s){switch(t){case"s":return a?" ":" ";case"ss":return e+(a?" ":" ");case"m":case"mm":return e+(a?" ":" ");case"h":case"hh":return e+(a?" ":" ");case"d":case"dd":return e+(a?" ":" ");case"M":case"MM":return e+(a?" ":" ");case"y":case"yy":return e+(a?" ":" ");default:return e}}l.defineLocale("me",{months:"januar_februar_mart_april_maj_jun_jul_avgust_septembar_oktobar_novembar_decembar".split("_"),monthsShort:"jan._feb._mar._apr._maj_jun_jul_avg._sep._okt._nov._dec.".split("_"),monthsParseExact:!0,weekdays:"nedjelja_ponedjeljak_utorak_srijeda_etvrtak_petak_subota".split("_"),weekdaysShort:"ned._pon._uto._sri._et._pet._sub.".split("_"),weekdaysMin:"ne_po_ut_sr_e_pe_su".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"H:mm",LTS:"H:mm:ss",L:"DD.MM.YYYY",LL:"D. MMMM YYYY",LLL:"D. MMMM YYYY H:mm",LLLL:"dddd, D. MMMM YYYY H:mm"},calendar:{sameDay:"[danas u] LT",nextDay:"[sjutra u] LT",nextWeek:function(){switch(this.day()){case 0:return"[u] [nedjelju] [u] LT";case 3:return"[u] [srijedu] [u] LT";case 6:return"[u] [subotu] [u] LT";case 1:case 2:case 4:case 5:return"[u] dddd [u] LT"}},lastDay:"[jue u] LT",lastWeek:function(){return["[prole] [nedjelje] [u] LT","[prolog] [ponedjeljka] [u] LT","[prolog] [utorka] [u] LT","[prole] [srijede] [u] LT","[prolog] [etvrtka] [u] LT","[prolog] [petka] [u] LT","[prole] [subote] [u] LT"][this.day()]},sameElse:"L"},relativeTime:{future:"za %s",past:"prije %s",s:"nekoliko sekundi",ss:gn.translate,m:gn.translate,mm:gn.translate,h:gn.translate,hh:gn.translate,d:"dan",dd:gn.translate,M:"mjesec",MM:gn.translate,y:"godinu",yy:gn.translate},dayOfMonthOrdinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:7}}),l.defineLocale("mi",{months:"Kohi-tte_Hui-tanguru_Pout-te-rangi_Paenga-whwh_Haratua_Pipiri_Hngoingoi_Here-turi-kk_Mahuru_Whiringa--nuku_Whiringa--rangi_Hakihea".split("_"),monthsShort:"Kohi_Hui_Pou_Pae_Hara_Pipi_Hngoi_Here_Mahu_Whi-nu_Whi-ra_Haki".split("_"),monthsRegex:/(?:['a-z\u0101\u014D\u016B]+\-?){1,3}/i,monthsStrictRegex:/(?:['a-z\u0101\u014D\u016B]+\-?){1,3}/i,monthsShortRegex:/(?:['a-z\u0101\u014D\u016B]+\-?){1,3}/i,monthsShortStrictRegex:/(?:['a-z\u0101\u014D\u016B]+\-?){1,2}/i,weekdays:"Rtapu_Mane_Trei_Wenerei_Tite_Paraire_Htarei".split("_"),weekdaysShort:"Ta_Ma_T_We_Ti_Pa_H".split("_"),weekdaysMin:"Ta_Ma_T_We_Ti_Pa_H".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY [i] HH:mm",LLLL:"dddd, D MMMM YYYY [i] HH:mm"},calendar:{sameDay:"[i teie mahana, i] LT",nextDay:"[apopo i] LT",nextWeek:"dddd [i] LT",lastDay:"[inanahi i] LT",lastWeek:"dddd [whakamutunga i] LT",sameElse:"L"},relativeTime:{future:"i roto i %s",past:"%s i mua",s:"te hkona ruarua",ss:"%d hkona",m:"he meneti",mm:"%d meneti",h:"te haora",hh:"%d haora",d:"he ra",dd:"%d ra",M:"he marama",MM:"%d marama",y:"he tau",yy:"%d tau"},dayOfMonthOrdinalParse:/\d{1,2}\xba/,ordinal:"%d",week:{dow:1,doy:4}}),l.defineLocale("mk",{months:"___________".split("_"),monthsShort:"___________".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"e_o_____a".split("_"),longDateFormat:{LT:"H:mm",LTS:"H:mm:ss",L:"D.MM.YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY H:mm",LLLL:"dddd, D MMMM YYYY H:mm"},calendar:{sameDay:"[ ] LT",nextDay:"[ ] LT",nextWeek:"[] dddd [] LT",lastDay:"[ ] LT",lastWeek:function(){switch(this.day()){case 0:case 3:case 6:return"[] dddd [] LT";case 1:case 2:case 4:case 5:return"[] dddd [] LT"}},sameElse:"L"},relativeTime:{future:" %s",past:" %s",s:" ",ss:"%d ",m:"",mm:"%d ",h:"",hh:"%d ",d:"",dd:"%d ",M:"",MM:"%d ",y:"",yy:"%d "},dayOfMonthOrdinalParse:/\d{1,2}-(\u0435\u0432|\u0435\u043d|\u0442\u0438|\u0432\u0438|\u0440\u0438|\u043c\u0438)/,ordinal:function(e){var a=e%10,t=e%100;return 0===e?e+"-":0==t?e+"-":10<t&&t<20?e+"-":1==a?e+"-":2==a?e+"-":7==a||8==a?e+"-":e+"-"},week:{dow:1,doy:7}}),l.defineLocale("ml",{months:"___________".split("_"),monthsShort:"._._._.___._._._._._.".split("_"),monthsParseExact:!0,weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"A h:mm -",LTS:"A h:mm:ss -",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY, A h:mm -",LLLL:"dddd, D MMMM YYYY, A h:mm -"},calendar:{sameDay:"[] LT",nextDay:"[] LT",nextWeek:"dddd, LT",lastDay:"[] LT",lastWeek:"[] dddd, LT",sameElse:"L"},relativeTime:{future:"%s ",past:"%s ",s:" ",ss:"%d ",m:" ",mm:"%d ",h:" ",hh:"%d ",d:" ",dd:"%d ",M:" ",MM:"%d ",y:" ",yy:"%d "},meridiemParse:/\u0d30\u0d3e\u0d24\u0d4d\u0d30\u0d3f|\u0d30\u0d3e\u0d35\u0d3f\u0d32\u0d46|\u0d09\u0d1a\u0d4d\u0d1a \u0d15\u0d34\u0d3f\u0d1e\u0d4d\u0d1e\u0d4d|\u0d35\u0d48\u0d15\u0d41\u0d28\u0d4d\u0d28\u0d47\u0d30\u0d02|\u0d30\u0d3e\u0d24\u0d4d\u0d30\u0d3f/i,meridiemHour:function(e,a){return 12===e&&(e=0),""===a&&4<=e||" "===a||""===a?e+12:e},meridiem:function(e,a,t){return e<4?"":e<12?"":e<17?" ":e<20?"":""}}),l.defineLocale("mn",{months:" _ _ _ _ _ _ _ _ _ _  _  ".split("_"),monthsShort:"1 _2 _3 _4 _5 _6 _7 _8 _9 _10 _11 _12 ".split("_"),monthsParseExact:!0,weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"YYYY-MM-DD",LL:"YYYY  MMMM D",LLL:"YYYY  MMMM D HH:mm",LLLL:"dddd, YYYY  MMMM D HH:mm"},meridiemParse:/\u04ae\u04e8|\u04ae\u0425/i,isPM:function(e){return""===e},meridiem:function(e,a,t){return e<12?"":""},calendar:{sameDay:"[] LT",nextDay:"[] LT",nextWeek:"[] dddd LT",lastDay:"[] LT",lastWeek:"[] dddd LT",sameElse:"L"},relativeTime:{future:"%s ",past:"%s ",s:wn,ss:wn,m:wn,mm:wn,h:wn,hh:wn,d:wn,dd:wn,M:wn,MM:wn,y:wn,yy:wn},dayOfMonthOrdinalParse:/\d{1,2} \u04e9\u0434\u04e9\u0440/,ordinal:function(e,a){switch(a){case"d":case"D":case"DDD":return e+" ";default:return e}}});var vn={1:"",2:"",3:"",4:"",5:"",6:"",7:"",8:"",9:"",0:""},Sn={"":"1","":"2","":"3","":"4","":"5","":"6","":"7","":"8","":"9","":"0"};function Hn(e,a,t,s){var n="";if(a)switch(t){case"s":n=" ";break;case"ss":n="%d ";break;case"m":n=" ";break;case"mm":n="%d ";break;case"h":n=" ";break;case"hh":n="%d ";break;case"d":n=" ";break;case"dd":n="%d ";break;case"M":n=" ";break;case"MM":n="%d ";break;case"y":n=" ";break;case"yy":n="%d "}else switch(t){case"s":n=" ";break;case"ss":n="%d ";break;case"m":n=" ";break;case"mm":n="%d ";break;case"h":n=" ";break;case"hh":n="%d ";break;case"d":n=" ";break;case"dd":n="%d ";break;case"M":n=" ";break;case"MM":n="%d ";break;case"y":n=" ";break;case"yy":n="%d "}return n.replace(/%d/i,e)}l.defineLocale("mr",{months:"___________".split("_"),monthsShort:"._._._._._._._._._._._.".split("_"),monthsParseExact:!0,weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"A h:mm ",LTS:"A h:mm:ss ",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY, A h:mm ",LLLL:"dddd, D MMMM YYYY, A h:mm "},calendar:{sameDay:"[] LT",nextDay:"[] LT",nextWeek:"dddd, LT",lastDay:"[] LT",lastWeek:"[] dddd, LT",sameElse:"L"},relativeTime:{future:"%s",past:"%s",s:Hn,ss:Hn,m:Hn,mm:Hn,h:Hn,hh:Hn,d:Hn,dd:Hn,M:Hn,MM:Hn,y:Hn,yy:Hn},preparse:function(e){return e.replace(/[\u0967\u0968\u0969\u096a\u096b\u096c\u096d\u096e\u096f\u0966]/g,function(e){return Sn[e]})},postformat:function(e){return e.replace(/\d/g,function(e){return vn[e]})},meridiemParse:/\u0930\u093e\u0924\u094d\u0930\u0940|\u0938\u0915\u093e\u0933\u0940|\u0926\u0941\u092a\u093e\u0930\u0940|\u0938\u093e\u092f\u0902\u0915\u093e\u0933\u0940/,meridiemHour:function(e,a){return 12===e&&(e=0),""===a?e<4?e:e+12:""===a?e:""===a?10<=e?e:e+12:""===a?e+12:void 0},meridiem:function(e,a,t){return e<4?"":e<10?"":e<17?"":e<20?"":""},week:{dow:0,doy:6}}),l.defineLocale("ms-my",{months:"Januari_Februari_Mac_April_Mei_Jun_Julai_Ogos_September_Oktober_November_Disember".split("_"),monthsShort:"Jan_Feb_Mac_Apr_Mei_Jun_Jul_Ogs_Sep_Okt_Nov_Dis".split("_"),weekdays:"Ahad_Isnin_Selasa_Rabu_Khamis_Jumaat_Sabtu".split("_"),weekdaysShort:"Ahd_Isn_Sel_Rab_Kha_Jum_Sab".split("_"),weekdaysMin:"Ah_Is_Sl_Rb_Km_Jm_Sb".split("_"),longDateFormat:{LT:"HH.mm",LTS:"HH.mm.ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY [pukul] HH.mm",LLLL:"dddd, D MMMM YYYY [pukul] HH.mm"},meridiemParse:/pagi|tengahari|petang|malam/,meridiemHour:function(e,a){return 12===e&&(e=0),"pagi"===a?e:"tengahari"===a?11<=e?e:e+12:"petang"===a||"malam"===a?e+12:void 0},meridiem:function(e,a,t){return e<11?"pagi":e<15?"tengahari":e<19?"petang":"malam"},calendar:{sameDay:"[Hari ini pukul] LT",nextDay:"[Esok pukul] LT",nextWeek:"dddd [pukul] LT",lastDay:"[Kelmarin pukul] LT",lastWeek:"dddd [lepas pukul] LT",sameElse:"L"},relativeTime:{future:"dalam %s",past:"%s yang lepas",s:"beberapa saat",ss:"%d saat",m:"seminit",mm:"%d minit",h:"sejam",hh:"%d jam",d:"sehari",dd:"%d hari",M:"sebulan",MM:"%d bulan",y:"setahun",yy:"%d tahun"},week:{dow:1,doy:7}}),l.defineLocale("ms",{months:"Januari_Februari_Mac_April_Mei_Jun_Julai_Ogos_September_Oktober_November_Disember".split("_"),monthsShort:"Jan_Feb_Mac_Apr_Mei_Jun_Jul_Ogs_Sep_Okt_Nov_Dis".split("_"),weekdays:"Ahad_Isnin_Selasa_Rabu_Khamis_Jumaat_Sabtu".split("_"),weekdaysShort:"Ahd_Isn_Sel_Rab_Kha_Jum_Sab".split("_"),weekdaysMin:"Ah_Is_Sl_Rb_Km_Jm_Sb".split("_"),longDateFormat:{LT:"HH.mm",LTS:"HH.mm.ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY [pukul] HH.mm",LLLL:"dddd, D MMMM YYYY [pukul] HH.mm"},meridiemParse:/pagi|tengahari|petang|malam/,meridiemHour:function(e,a){return 12===e&&(e=0),"pagi"===a?e:"tengahari"===a?11<=e?e:e+12:"petang"===a||"malam"===a?e+12:void 0},meridiem:function(e,a,t){return e<11?"pagi":e<15?"tengahari":e<19?"petang":"malam"},calendar:{sameDay:"[Hari ini pukul] LT",nextDay:"[Esok pukul] LT",nextWeek:"dddd [pukul] LT",lastDay:"[Kelmarin pukul] LT",lastWeek:"dddd [lepas pukul] LT",sameElse:"L"},relativeTime:{future:"dalam %s",past:"%s yang lepas",s:"beberapa saat",ss:"%d saat",m:"seminit",mm:"%d minit",h:"sejam",hh:"%d jam",d:"sehari",dd:"%d hari",M:"sebulan",MM:"%d bulan",y:"setahun",yy:"%d tahun"},week:{dow:1,doy:7}}),l.defineLocale("mt",{months:"Jannar_Frar_Marzu_April_Mejju_unju_Lulju_Awwissu_Settembru_Ottubru_Novembru_Diembru".split("_"),monthsShort:"Jan_Fra_Mar_Apr_Mej_un_Lul_Aww_Set_Ott_Nov_Di".split("_"),weekdays:"Il-add_It-Tnejn_It-Tlieta_L-Erbga_Il-amis_Il-imga_Is-Sibt".split("_"),weekdaysShort:"ad_Tne_Tli_Erb_am_im_Sib".split("_"),weekdaysMin:"a_Tn_Tl_Er_a_i_Si".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd, D MMMM YYYY HH:mm"},calendar:{sameDay:"[Illum fil-]LT",nextDay:"[Gada fil-]LT",nextWeek:"dddd [fil-]LT",lastDay:"[Il-biera fil-]LT",lastWeek:"dddd [li gadda] [fil-]LT",sameElse:"L"},relativeTime:{future:"f %s",past:"%s ilu",s:"ftit sekondi",ss:"%d sekondi",m:"minuta",mm:"%d minuti",h:"siega",hh:"%d siegat",d:"urnata",dd:"%d ranet",M:"xahar",MM:"%d xhur",y:"sena",yy:"%d sni"},dayOfMonthOrdinalParse:/\d{1,2}\xba/,ordinal:"%d",week:{dow:1,doy:4}});var bn={1:"",2:"",3:"",4:"",5:"",6:"",7:"",8:"",9:"",0:""},jn={"":"1","":"2","":"3","":"4","":"5","":"6","":"7","":"8","":"9","":"0"};l.defineLocale("my",{months:"___________".split("_"),monthsShort:"___________".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd D MMMM YYYY HH:mm"},calendar:{sameDay:"[.] LT []",nextDay:"[] LT []",nextWeek:"dddd LT []",lastDay:"[.] LT []",lastWeek:"[] dddd LT []",sameElse:"L"},relativeTime:{future:" %s ",past:" %s ",s:".",ss:"%d ",m:"",mm:"%d ",h:"",hh:"%d ",d:"",dd:"%d ",M:"",MM:"%d ",y:"",yy:"%d "},preparse:function(e){return e.replace(/[\u1041\u1042\u1043\u1044\u1045\u1046\u1047\u1048\u1049\u1040]/g,function(e){return jn[e]})},postformat:function(e){return e.replace(/\d/g,function(e){return bn[e]})},week:{dow:1,doy:4}}),l.defineLocale("nb",{months:"januar_februar_mars_april_mai_juni_juli_august_september_oktober_november_desember".split("_"),monthsShort:"jan._feb._mars_april_mai_juni_juli_aug._sep._okt._nov._des.".split("_"),monthsParseExact:!0,weekdays:"sndag_mandag_tirsdag_onsdag_torsdag_fredag_lrdag".split("_"),weekdaysShort:"s._ma._ti._on._to._fr._l.".split("_"),weekdaysMin:"s_ma_ti_on_to_fr_l".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD.MM.YYYY",LL:"D. MMMM YYYY",LLL:"D. MMMM YYYY [kl.] HH:mm",LLLL:"dddd D. MMMM YYYY [kl.] HH:mm"},calendar:{sameDay:"[i dag kl.] LT",nextDay:"[i morgen kl.] LT",nextWeek:"dddd [kl.] LT",lastDay:"[i gr kl.] LT",lastWeek:"[forrige] dddd [kl.] LT",sameElse:"L"},relativeTime:{future:"om %s",past:"%s siden",s:"noen sekunder",ss:"%d sekunder",m:"ett minutt",mm:"%d minutter",h:"en time",hh:"%d timer",d:"en dag",dd:"%d dager",M:"en mned",MM:"%d mneder",y:"ett r",yy:"%d r"},dayOfMonthOrdinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:4}});var xn={1:"",2:"",3:"",4:"",5:"",6:"",7:"",8:"",9:"",0:""},On={"":"1","":"2","":"3","":"4","":"5","":"6","":"7","":"8","":"9","":"0"};l.defineLocale("ne",{months:"___________".split("_"),monthsShort:"._.__.___._._._._._.".split("_"),monthsParseExact:!0,weekdays:"______".split("_"),weekdaysShort:"._._._._._._.".split("_"),weekdaysMin:"._._._._._._.".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"A h:mm ",LTS:"A h:mm:ss ",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY, A h:mm ",LLLL:"dddd, D MMMM YYYY, A h:mm "},preparse:function(e){return e.replace(/[\u0967\u0968\u0969\u096a\u096b\u096c\u096d\u096e\u096f\u0966]/g,function(e){return On[e]})},postformat:function(e){return e.replace(/\d/g,function(e){return xn[e]})},meridiemParse:/\u0930\u093e\u0924\u093f|\u092c\u093f\u0939\u093e\u0928|\u0926\u093f\u0909\u0901\u0938\u094b|\u0938\u093e\u0901\u091d/,meridiemHour:function(e,a){return 12===e&&(e=0),""===a?e<4?e:e+12:""===a?e:""===a?10<=e?e:e+12:""===a?e+12:void 0},meridiem:function(e,a,t){return e<3?"":e<12?"":e<16?"":e<20?"":""},calendar:{sameDay:"[] LT",nextDay:"[] LT",nextWeek:"[] dddd[,] LT",lastDay:"[] LT",lastWeek:"[] dddd[,] LT",sameElse:"L"},relativeTime:{future:"%s",past:"%s ",s:" ",ss:"%d ",m:" ",mm:"%d ",h:" ",hh:"%d ",d:" ",dd:"%d ",M:" ",MM:"%d ",y:" ",yy:"%d "},week:{dow:0,doy:6}});var Pn="jan._feb._mrt._apr._mei_jun._jul._aug._sep._okt._nov._dec.".split("_"),Wn="jan_feb_mrt_apr_mei_jun_jul_aug_sep_okt_nov_dec".split("_"),An=[/^jan/i,/^feb/i,/^maart|mrt.?$/i,/^apr/i,/^mei$/i,/^jun[i.]?$/i,/^jul[i.]?$/i,/^aug/i,/^sep/i,/^okt/i,/^nov/i,/^dec/i],En=/^(januari|februari|maart|april|mei|ju[nl]i|augustus|september|oktober|november|december|jan\.?|feb\.?|mrt\.?|apr\.?|ju[nl]\.?|aug\.?|sep\.?|okt\.?|nov\.?|dec\.?)/i;l.defineLocale("nl-be",{months:"januari_februari_maart_april_mei_juni_juli_augustus_september_oktober_november_december".split("_"),monthsShort:function(e,a){return e?/-MMM-/.test(a)?Wn[e.month()]:Pn[e.month()]:Pn},monthsRegex:En,monthsShortRegex:En,monthsStrictRegex:/^(januari|februari|maart|april|mei|ju[nl]i|augustus|september|oktober|november|december)/i,monthsShortStrictRegex:/^(jan\.?|feb\.?|mrt\.?|apr\.?|mei|ju[nl]\.?|aug\.?|sep\.?|okt\.?|nov\.?|dec\.?)/i,monthsParse:An,longMonthsParse:An,shortMonthsParse:An,weekdays:"zondag_maandag_dinsdag_woensdag_donderdag_vrijdag_zaterdag".split("_"),weekdaysShort:"zo._ma._di._wo._do._vr._za.".split("_"),weekdaysMin:"zo_ma_di_wo_do_vr_za".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd D MMMM YYYY HH:mm"},calendar:{sameDay:"[vandaag om] LT",nextDay:"[morgen om] LT",nextWeek:"dddd [om] LT",lastDay:"[gisteren om] LT",lastWeek:"[afgelopen] dddd [om] LT",sameElse:"L"},relativeTime:{future:"over %s",past:"%s geleden",s:"een paar seconden",ss:"%d seconden",m:"n minuut",mm:"%d minuten",h:"n uur",hh:"%d uur",d:"n dag",dd:"%d dagen",M:"n maand",MM:"%d maanden",y:"n jaar",yy:"%d jaar"},dayOfMonthOrdinalParse:/\d{1,2}(ste|de)/,ordinal:function(e){return e+(1===e||8===e||20<=e?"ste":"de")},week:{dow:1,doy:4}});var Fn="jan._feb._mrt._apr._mei_jun._jul._aug._sep._okt._nov._dec.".split("_"),zn="jan_feb_mrt_apr_mei_jun_jul_aug_sep_okt_nov_dec".split("_"),Jn=[/^jan/i,/^feb/i,/^maart|mrt.?$/i,/^apr/i,/^mei$/i,/^jun[i.]?$/i,/^jul[i.]?$/i,/^aug/i,/^sep/i,/^okt/i,/^nov/i,/^dec/i],Nn=/^(januari|februari|maart|april|mei|ju[nl]i|augustus|september|oktober|november|december|jan\.?|feb\.?|mrt\.?|apr\.?|ju[nl]\.?|aug\.?|sep\.?|okt\.?|nov\.?|dec\.?)/i;l.defineLocale("nl",{months:"januari_februari_maart_april_mei_juni_juli_augustus_september_oktober_november_december".split("_"),monthsShort:function(e,a){return e?/-MMM-/.test(a)?zn[e.month()]:Fn[e.month()]:Fn},monthsRegex:Nn,monthsShortRegex:Nn,monthsStrictRegex:/^(januari|februari|maart|april|mei|ju[nl]i|augustus|september|oktober|november|december)/i,monthsShortStrictRegex:/^(jan\.?|feb\.?|mrt\.?|apr\.?|mei|ju[nl]\.?|aug\.?|sep\.?|okt\.?|nov\.?|dec\.?)/i,monthsParse:Jn,longMonthsParse:Jn,shortMonthsParse:Jn,weekdays:"zondag_maandag_dinsdag_woensdag_donderdag_vrijdag_zaterdag".split("_"),weekdaysShort:"zo._ma._di._wo._do._vr._za.".split("_"),weekdaysMin:"zo_ma_di_wo_do_vr_za".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD-MM-YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd D MMMM YYYY HH:mm"},calendar:{sameDay:"[vandaag om] LT",nextDay:"[morgen om] LT",nextWeek:"dddd [om] LT",lastDay:"[gisteren om] LT",lastWeek:"[afgelopen] dddd [om] LT",sameElse:"L"},relativeTime:{future:"over %s",past:"%s geleden",s:"een paar seconden",ss:"%d seconden",m:"n minuut",mm:"%d minuten",h:"n uur",hh:"%d uur",d:"n dag",dd:"%d dagen",M:"n maand",MM:"%d maanden",y:"n jaar",yy:"%d jaar"},dayOfMonthOrdinalParse:/\d{1,2}(ste|de)/,ordinal:function(e){return e+(1===e||8===e||20<=e?"ste":"de")},week:{dow:1,doy:4}}),l.defineLocale("nn",{months:"januar_februar_mars_april_mai_juni_juli_august_september_oktober_november_desember".split("_"),monthsShort:"jan_feb_mar_apr_mai_jun_jul_aug_sep_okt_nov_des".split("_"),weekdays:"sundag_mndag_tysdag_onsdag_torsdag_fredag_laurdag".split("_"),weekdaysShort:"sun_mn_tys_ons_tor_fre_lau".split("_"),weekdaysMin:"su_m_ty_on_to_fr_l".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD.MM.YYYY",LL:"D. MMMM YYYY",LLL:"D. MMMM YYYY [kl.] H:mm",LLLL:"dddd D. MMMM YYYY [kl.] HH:mm"},calendar:{sameDay:"[I dag klokka] LT",nextDay:"[I morgon klokka] LT",nextWeek:"dddd [klokka] LT",lastDay:"[I gr klokka] LT",lastWeek:"[Fregande] dddd [klokka] LT",sameElse:"L"},relativeTime:{future:"om %s",past:"%s sidan",s:"nokre sekund",ss:"%d sekund",m:"eit minutt",mm:"%d minutt",h:"ein time",hh:"%d timar",d:"ein dag",dd:"%d dagar",M:"ein mnad",MM:"%d mnader",y:"eit r",yy:"%d r"},dayOfMonthOrdinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:4}});var Rn={1:"",2:"",3:"",4:"",5:"",6:"",7:"",8:"",9:"",0:""},Cn={"":"1","":"2","":"3","":"4","":"5","":"6","":"7","":"8","":"9","":"0"};l.defineLocale("pa-in",{months:"___________".split("_"),monthsShort:"___________".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"A h:mm ",LTS:"A h:mm:ss ",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY, A h:mm ",LLLL:"dddd, D MMMM YYYY, A h:mm "},calendar:{sameDay:"[] LT",nextDay:"[] LT",nextWeek:"[] dddd, LT",lastDay:"[] LT",lastWeek:"[] dddd, LT",sameElse:"L"},relativeTime:{future:"%s ",past:"%s ",s:" ",ss:"%d ",m:" ",mm:"%d ",h:" ",hh:"%d ",d:" ",dd:"%d ",M:" ",MM:"%d ",y:" ",yy:"%d "},preparse:function(e){return e.replace(/[\u0a67\u0a68\u0a69\u0a6a\u0a6b\u0a6c\u0a6d\u0a6e\u0a6f\u0a66]/g,function(e){return Cn[e]})},postformat:function(e){return e.replace(/\d/g,function(e){return Rn[e]})},meridiemParse:/\u0a30\u0a3e\u0a24|\u0a38\u0a35\u0a47\u0a30|\u0a26\u0a41\u0a2a\u0a39\u0a3f\u0a30|\u0a38\u0a3c\u0a3e\u0a2e/,meridiemHour:function(e,a){return 12===e&&(e=0),""===a?e<4?e:e+12:""===a?e:""===a?10<=e?e:e+12:""===a?e+12:void 0},meridiem:function(e,a,t){return e<4?"":e<10?"":e<17?"":e<20?"":""},week:{dow:0,doy:6}});var In="stycze_luty_marzec_kwiecie_maj_czerwiec_lipiec_sierpie_wrzesie_padziernik_listopad_grudzie".split("_"),Un="stycznia_lutego_marca_kwietnia_maja_czerwca_lipca_sierpnia_wrzenia_padziernika_listopada_grudnia".split("_");function Gn(e){return e%10<5&&1<e%10&&~~(e/10)%10!=1}function Vn(e,a,t){var s=e+" ";switch(t){case"ss":return s+(Gn(e)?"sekundy":"sekund");case"m":return a?"minuta":"minut";case"mm":return s+(Gn(e)?"minuty":"minut");case"h":return a?"godzina":"godzin";case"hh":return s+(Gn(e)?"godziny":"godzin");case"MM":return s+(Gn(e)?"miesice":"miesicy");case"yy":return s+(Gn(e)?"lata":"lat")}}function Kn(e,a,t){var s=" ";return(20<=e%100||100<=e&&e%100==0)&&(s=" de "),e+s+{ss:"secunde",mm:"minute",hh:"ore",dd:"zile",MM:"luni",yy:"ani"}[t]}function Zn(e,a,t){var s,n;return"m"===t?a?"":"":e+" "+(s=+e,n={ss:a?"__":"__",mm:a?"__":"__",hh:"__",dd:"__",MM:"__",yy:"__"}[t].split("_"),s%10==1&&s%100!=11?n[0]:2<=s%10&&s%10<=4&&(s%100<10||20<=s%100)?n[1]:n[2])}l.defineLocale("pl",{months:function(e,a){return e?""===a?"("+Un[e.month()]+"|"+In[e.month()]+")":/D MMMM/.test(a)?Un[e.month()]:In[e.month()]:In},monthsShort:"sty_lut_mar_kwi_maj_cze_lip_sie_wrz_pa_lis_gru".split("_"),weekdays:"niedziela_poniedziaek_wtorek_roda_czwartek_pitek_sobota".split("_"),weekdaysShort:"ndz_pon_wt_r_czw_pt_sob".split("_"),weekdaysMin:"Nd_Pn_Wt_r_Cz_Pt_So".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD.MM.YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd, D MMMM YYYY HH:mm"},calendar:{sameDay:"[Dzi o] LT",nextDay:"[Jutro o] LT",nextWeek:function(){switch(this.day()){case 0:return"[W niedziel o] LT";case 2:return"[We wtorek o] LT";case 3:return"[W rod o] LT";case 6:return"[W sobot o] LT";default:return"[W] dddd [o] LT"}},lastDay:"[Wczoraj o] LT",lastWeek:function(){switch(this.day()){case 0:return"[W zesz niedziel o] LT";case 3:return"[W zesz rod o] LT";case 6:return"[W zesz sobot o] LT";default:return"[W zeszy] dddd [o] LT"}},sameElse:"L"},relativeTime:{future:"za %s",past:"%s temu",s:"kilka sekund",ss:Vn,m:Vn,mm:Vn,h:Vn,hh:Vn,d:"1 dzie",dd:"%d dni",M:"miesic",MM:Vn,y:"rok",yy:Vn},dayOfMonthOrdinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:4}}),l.defineLocale("pt-br",{months:"Janeiro_Fevereiro_Maro_Abril_Maio_Junho_Julho_Agosto_Setembro_Outubro_Novembro_Dezembro".split("_"),monthsShort:"Jan_Fev_Mar_Abr_Mai_Jun_Jul_Ago_Set_Out_Nov_Dez".split("_"),weekdays:"Domingo_Segunda-feira_Tera-feira_Quarta-feira_Quinta-feira_Sexta-feira_Sbado".split("_"),weekdaysShort:"Dom_Seg_Ter_Qua_Qui_Sex_Sb".split("_"),weekdaysMin:"Do_2_3_4_5_6_S".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D [de] MMMM [de] YYYY",LLL:"D [de] MMMM [de] YYYY [s] HH:mm",LLLL:"dddd, D [de] MMMM [de] YYYY [s] HH:mm"},calendar:{sameDay:"[Hoje s] LT",nextDay:"[Amanh s] LT",nextWeek:"dddd [s] LT",lastDay:"[Ontem s] LT",lastWeek:function(){return 0===this.day()||6===this.day()?"[ltimo] dddd [s] LT":"[ltima] dddd [s] LT"},sameElse:"L"},relativeTime:{future:"em %s",past:"h %s",s:"poucos segundos",ss:"%d segundos",m:"um minuto",mm:"%d minutos",h:"uma hora",hh:"%d horas",d:"um dia",dd:"%d dias",M:"um ms",MM:"%d meses",y:"um ano",yy:"%d anos"},dayOfMonthOrdinalParse:/\d{1,2}\xba/,ordinal:"%d"}),l.defineLocale("pt",{months:"Janeiro_Fevereiro_Maro_Abril_Maio_Junho_Julho_Agosto_Setembro_Outubro_Novembro_Dezembro".split("_"),monthsShort:"Jan_Fev_Mar_Abr_Mai_Jun_Jul_Ago_Set_Out_Nov_Dez".split("_"),weekdays:"Domingo_Segunda-feira_Tera-feira_Quarta-feira_Quinta-feira_Sexta-feira_Sbado".split("_"),weekdaysShort:"Dom_Seg_Ter_Qua_Qui_Sex_Sb".split("_"),weekdaysMin:"Do_2_3_4_5_6_S".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D [de] MMMM [de] YYYY",LLL:"D [de] MMMM [de] YYYY HH:mm",LLLL:"dddd, D [de] MMMM [de] YYYY HH:mm"},calendar:{sameDay:"[Hoje s] LT",nextDay:"[Amanh s] LT",nextWeek:"dddd [s] LT",lastDay:"[Ontem s] LT",lastWeek:function(){return 0===this.day()||6===this.day()?"[ltimo] dddd [s] LT":"[ltima] dddd [s] LT"},sameElse:"L"},relativeTime:{future:"em %s",past:"h %s",s:"segundos",ss:"%d segundos",m:"um minuto",mm:"%d minutos",h:"uma hora",hh:"%d horas",d:"um dia",dd:"%d dias",M:"um ms",MM:"%d meses",y:"um ano",yy:"%d anos"},dayOfMonthOrdinalParse:/\d{1,2}\xba/,ordinal:"%d",week:{dow:1,doy:4}}),l.defineLocale("ro",{months:"ianuarie_februarie_martie_aprilie_mai_iunie_iulie_august_septembrie_octombrie_noiembrie_decembrie".split("_"),monthsShort:"ian._febr._mart._apr._mai_iun._iul._aug._sept._oct._nov._dec.".split("_"),monthsParseExact:!0,weekdays:"duminic_luni_mari_miercuri_joi_vineri_smbt".split("_"),weekdaysShort:"Dum_Lun_Mar_Mie_Joi_Vin_Sm".split("_"),weekdaysMin:"Du_Lu_Ma_Mi_Jo_Vi_S".split("_"),longDateFormat:{LT:"H:mm",LTS:"H:mm:ss",L:"DD.MM.YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY H:mm",LLLL:"dddd, D MMMM YYYY H:mm"},calendar:{sameDay:"[azi la] LT",nextDay:"[mine la] LT",nextWeek:"dddd [la] LT",lastDay:"[ieri la] LT",lastWeek:"[fosta] dddd [la] LT",sameElse:"L"},relativeTime:{future:"peste %s",past:"%s n urm",s:"cteva secunde",ss:Kn,m:"un minut",mm:Kn,h:"o or",hh:Kn,d:"o zi",dd:Kn,M:"o lun",MM:Kn,y:"un an",yy:Kn},week:{dow:1,doy:7}});var $n=[/^\u044f\u043d\u0432/i,/^\u0444\u0435\u0432/i,/^\u043c\u0430\u0440/i,/^\u0430\u043f\u0440/i,/^\u043c\u0430[\u0439\u044f]/i,/^\u0438\u044e\u043d/i,/^\u0438\u044e\u043b/i,/^\u0430\u0432\u0433/i,/^\u0441\u0435\u043d/i,/^\u043e\u043a\u0442/i,/^\u043d\u043e\u044f/i,/^\u0434\u0435\u043a/i];l.defineLocale("ru",{months:{format:"___________".split("_"),standalone:"___________".split("_")},monthsShort:{format:"._._._.____._._._._.".split("_"),standalone:"._.__.____._._._._.".split("_")},weekdays:{standalone:"______".split("_"),format:"______".split("_"),isFormat:/\[ ?[\u0412\u0432] ?(?:\u043f\u0440\u043e\u0448\u043b\u0443\u044e|\u0441\u043b\u0435\u0434\u0443\u044e\u0449\u0443\u044e|\u044d\u0442\u0443)? ?\] ?dddd/},weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),monthsParse:$n,longMonthsParse:$n,shortMonthsParse:$n,monthsRegex:/^(\u044f\u043d\u0432\u0430\u0440[\u044c\u044f]|\u044f\u043d\u0432\.?|\u0444\u0435\u0432\u0440\u0430\u043b[\u044c\u044f]|\u0444\u0435\u0432\u0440?\.?|\u043c\u0430\u0440\u0442\u0430?|\u043c\u0430\u0440\.?|\u0430\u043f\u0440\u0435\u043b[\u044c\u044f]|\u0430\u043f\u0440\.?|\u043c\u0430[\u0439\u044f]|\u0438\u044e\u043d[\u044c\u044f]|\u0438\u044e\u043d\.?|\u0438\u044e\u043b[\u044c\u044f]|\u0438\u044e\u043b\.?|\u0430\u0432\u0433\u0443\u0441\u0442\u0430?|\u0430\u0432\u0433\.?|\u0441\u0435\u043d\u0442\u044f\u0431\u0440[\u044c\u044f]|\u0441\u0435\u043d\u0442?\.?|\u043e\u043a\u0442\u044f\u0431\u0440[\u044c\u044f]|\u043e\u043a\u0442\.?|\u043d\u043e\u044f\u0431\u0440[\u044c\u044f]|\u043d\u043e\u044f\u0431?\.?|\u0434\u0435\u043a\u0430\u0431\u0440[\u044c\u044f]|\u0434\u0435\u043a\.?)/i,monthsShortRegex:/^(\u044f\u043d\u0432\u0430\u0440[\u044c\u044f]|\u044f\u043d\u0432\.?|\u0444\u0435\u0432\u0440\u0430\u043b[\u044c\u044f]|\u0444\u0435\u0432\u0440?\.?|\u043c\u0430\u0440\u0442\u0430?|\u043c\u0430\u0440\.?|\u0430\u043f\u0440\u0435\u043b[\u044c\u044f]|\u0430\u043f\u0440\.?|\u043c\u0430[\u0439\u044f]|\u0438\u044e\u043d[\u044c\u044f]|\u0438\u044e\u043d\.?|\u0438\u044e\u043b[\u044c\u044f]|\u0438\u044e\u043b\.?|\u0430\u0432\u0433\u0443\u0441\u0442\u0430?|\u0430\u0432\u0433\.?|\u0441\u0435\u043d\u0442\u044f\u0431\u0440[\u044c\u044f]|\u0441\u0435\u043d\u0442?\.?|\u043e\u043a\u0442\u044f\u0431\u0440[\u044c\u044f]|\u043e\u043a\u0442\.?|\u043d\u043e\u044f\u0431\u0440[\u044c\u044f]|\u043d\u043e\u044f\u0431?\.?|\u0434\u0435\u043a\u0430\u0431\u0440[\u044c\u044f]|\u0434\u0435\u043a\.?)/i,monthsStrictRegex:/^(\u044f\u043d\u0432\u0430\u0440[\u044f\u044c]|\u0444\u0435\u0432\u0440\u0430\u043b[\u044f\u044c]|\u043c\u0430\u0440\u0442\u0430?|\u0430\u043f\u0440\u0435\u043b[\u044f\u044c]|\u043c\u0430[\u044f\u0439]|\u0438\u044e\u043d[\u044f\u044c]|\u0438\u044e\u043b[\u044f\u044c]|\u0430\u0432\u0433\u0443\u0441\u0442\u0430?|\u0441\u0435\u043d\u0442\u044f\u0431\u0440[\u044f\u044c]|\u043e\u043a\u0442\u044f\u0431\u0440[\u044f\u044c]|\u043d\u043e\u044f\u0431\u0440[\u044f\u044c]|\u0434\u0435\u043a\u0430\u0431\u0440[\u044f\u044c])/i,monthsShortStrictRegex:/^(\u044f\u043d\u0432\.|\u0444\u0435\u0432\u0440?\.|\u043c\u0430\u0440[\u0442.]|\u0430\u043f\u0440\.|\u043c\u0430[\u044f\u0439]|\u0438\u044e\u043d[\u044c\u044f.]|\u0438\u044e\u043b[\u044c\u044f.]|\u0430\u0432\u0433\.|\u0441\u0435\u043d\u0442?\.|\u043e\u043a\u0442\.|\u043d\u043e\u044f\u0431?\.|\u0434\u0435\u043a\.)/i,longDateFormat:{LT:"H:mm",LTS:"H:mm:ss",L:"DD.MM.YYYY",LL:"D MMMM YYYY .",LLL:"D MMMM YYYY ., H:mm",LLLL:"dddd, D MMMM YYYY ., H:mm"},calendar:{sameDay:"[, ] LT",nextDay:"[, ] LT",lastDay:"[, ] LT",nextWeek:function(e){if(e.week()===this.week())return 2===this.day()?"[] dddd, [] LT":"[] dddd, [] LT";switch(this.day()){case 0:return"[ ] dddd, [] LT";case 1:case 2:case 4:return"[ ] dddd, [] LT";case 3:case 5:case 6:return"[ ] dddd, [] LT"}},lastWeek:function(e){if(e.week()===this.week())return 2===this.day()?"[] dddd, [] LT":"[] dddd, [] LT";switch(this.day()){case 0:return"[ ] dddd, [] LT";case 1:case 2:case 4:return"[ ] dddd, [] LT";case 3:case 5:case 6:return"[ ] dddd, [] LT"}},sameElse:"L"},relativeTime:{future:" %s",past:"%s ",s:" ",ss:Zn,m:Zn,mm:Zn,h:"",hh:Zn,d:"",dd:Zn,M:"",MM:Zn,y:"",yy:Zn},meridiemParse:/\u043d\u043e\u0447\u0438|\u0443\u0442\u0440\u0430|\u0434\u043d\u044f|\u0432\u0435\u0447\u0435\u0440\u0430/i,isPM:function(e){return/^(\u0434\u043d\u044f|\u0432\u0435\u0447\u0435\u0440\u0430)$/.test(e)},meridiem:function(e,a,t){return e<4?"":e<12?"":e<17?"":""},dayOfMonthOrdinalParse:/\d{1,2}-(\u0439|\u0433\u043e|\u044f)/,ordinal:function(e,a){switch(a){case"M":case"d":case"DDD":return e+"-";case"D":return e+"-";case"w":case"W":return e+"-";default:return e}},week:{dow:1,doy:4}});var Bn=["","","","","","","","","","","",""],qn=["","","","","","",""];l.defineLocale("sd",{months:Bn,monthsShort:Bn,weekdays:qn,weekdaysShort:qn,weekdaysMin:qn,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd D MMMM YYYY HH:mm"},meridiemParse:/\u0635\u0628\u062d|\u0634\u0627\u0645/,isPM:function(e){return""===e},meridiem:function(e,a,t){return e<12?"":""},calendar:{sameDay:"[] LT",nextDay:"[] LT",nextWeek:"dddd [  ] LT",lastDay:"[] LT",lastWeek:"[ ] dddd [] LT",sameElse:"L"},relativeTime:{future:"%s ",past:"%s ",s:" ",ss:"%d ",m:" ",mm:"%d ",h:" ",hh:"%d ",d:" ",dd:"%d ",M:" ",MM:"%d ",y:" ",yy:"%d "},preparse:function(e){return e.replace(/\u060c/g,",")},postformat:function(e){return e.replace(/,/g,"")},week:{dow:1,doy:4}}),l.defineLocale("se",{months:"oajagemnnu_guovvamnnu_njukamnnu_cuoomnnu_miessemnnu_geassemnnu_suoidnemnnu_borgemnnu_akamnnu_golggotmnnu_skbmamnnu_juovlamnnu".split("_"),monthsShort:"oj_guov_njuk_cuo_mies_geas_suoi_borg_ak_golg_skb_juov".split("_"),weekdays:"sotnabeaivi_vuossrga_maebrga_gaskavahkku_duorastat_bearjadat_lvvardat".split("_"),weekdaysShort:"sotn_vuos_ma_gask_duor_bear_lv".split("_"),weekdaysMin:"s_v_m_g_d_b_L".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD.MM.YYYY",LL:"MMMM D. [b.] YYYY",LLL:"MMMM D. [b.] YYYY [ti.] HH:mm",LLLL:"dddd, MMMM D. [b.] YYYY [ti.] HH:mm"},calendar:{sameDay:"[otne ti] LT",nextDay:"[ihttin ti] LT",nextWeek:"dddd [ti] LT",lastDay:"[ikte ti] LT",lastWeek:"[ovddit] dddd [ti] LT",sameElse:"L"},relativeTime:{future:"%s geaes",past:"mait %s",s:"moadde sekunddat",ss:"%d sekunddat",m:"okta minuhta",mm:"%d minuhtat",h:"okta diimmu",hh:"%d diimmut",d:"okta beaivi",dd:"%d beaivvit",M:"okta mnnu",MM:"%d mnut",y:"okta jahki",yy:"%d jagit"},dayOfMonthOrdinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:4}}),l.defineLocale("si",{months:"___________".split("_"),monthsShort:"___________".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"a h:mm",LTS:"a h:mm:ss",L:"YYYY/MM/DD",LL:"YYYY MMMM D",LLL:"YYYY MMMM D, a h:mm",LLLL:"YYYY MMMM D [] dddd, a h:mm:ss"},calendar:{sameDay:"[] LT[]",nextDay:"[] LT[]",nextWeek:"dddd LT[]",lastDay:"[] LT[]",lastWeek:"[] dddd LT[]",sameElse:"L"},relativeTime:{future:"%s",past:"%s ",s:" ",ss:" %d",m:"",mm:" %d",h:"",hh:" %d",d:"",dd:" %d",M:"",MM:" %d",y:"",yy:" %d"},dayOfMonthOrdinalParse:/\d{1,2} \u0dc0\u0dd0\u0db1\u0dd2/,ordinal:function(e){return e+" "},meridiemParse:/\u0db4\u0dd9\u0dbb \u0dc0\u0dbb\u0dd4|\u0db4\u0dc3\u0dca \u0dc0\u0dbb\u0dd4|\u0db4\u0dd9.\u0dc0|\u0db4.\u0dc0./,isPM:function(e){return".."===e||" "===e},meridiem:function(e,a,t){return 11<e?t?"..":" ":t?"..":" "}});var Qn="janur_februr_marec_aprl_mj_jn_jl_august_september_oktber_november_december".split("_"),Xn="jan_feb_mar_apr_mj_jn_jl_aug_sep_okt_nov_dec".split("_");function ed(e){return 1<e&&e<5}function ad(e,a,t,s){var n=e+" ";switch(t){case"s":return a||s?"pr seknd":"pr sekundami";case"ss":return a||s?n+(ed(e)?"sekundy":"seknd"):n+"sekundami";case"m":return a?"minta":s?"mintu":"mintou";case"mm":return a||s?n+(ed(e)?"minty":"mint"):n+"mintami";case"h":return a?"hodina":s?"hodinu":"hodinou";case"hh":return a||s?n+(ed(e)?"hodiny":"hodn"):n+"hodinami";case"d":return a||s?"de":"dom";case"dd":return a||s?n+(ed(e)?"dni":"dn"):n+"dami";case"M":return a||s?"mesiac":"mesiacom";case"MM":return a||s?n+(ed(e)?"mesiace":"mesiacov"):n+"mesiacmi";case"y":return a||s?"rok":"rokom";case"yy":return a||s?n+(ed(e)?"roky":"rokov"):n+"rokmi"}}function td(e,a,t,s){var n=e+" ";switch(t){case"s":return a||s?"nekaj sekund":"nekaj sekundami";case"ss":return n+(1===e?a?"sekundo":"sekundi":2===e?a||s?"sekundi":"sekundah":e<5?a||s?"sekunde":"sekundah":"sekund");case"m":return a?"ena minuta":"eno minuto";case"mm":return n+(1===e?a?"minuta":"minuto":2===e?a||s?"minuti":"minutama":e<5?a||s?"minute":"minutami":a||s?"minut":"minutami");case"h":return a?"ena ura":"eno uro";case"hh":return n+(1===e?a?"ura":"uro":2===e?a||s?"uri":"urama":e<5?a||s?"ure":"urami":a||s?"ur":"urami");case"d":return a||s?"en dan":"enim dnem";case"dd":return n+(1===e?a||s?"dan":"dnem":2===e?a||s?"dni":"dnevoma":a||s?"dni":"dnevi");case"M":return a||s?"en mesec":"enim mesecem";case"MM":return n+(1===e?a||s?"mesec":"mesecem":2===e?a||s?"meseca":"mesecema":e<5?a||s?"mesece":"meseci":a||s?"mesecev":"meseci");case"y":return a||s?"eno leto":"enim letom";case"yy":return n+(1===e?a||s?"leto":"letom":2===e?a||s?"leti":"letoma":e<5?a||s?"leta":"leti":a||s?"let":"leti")}}l.defineLocale("sk",{months:Qn,monthsShort:Xn,weekdays:"nedea_pondelok_utorok_streda_tvrtok_piatok_sobota".split("_"),weekdaysShort:"ne_po_ut_st_t_pi_so".split("_"),weekdaysMin:"ne_po_ut_st_t_pi_so".split("_"),longDateFormat:{LT:"H:mm",LTS:"H:mm:ss",L:"DD.MM.YYYY",LL:"D. MMMM YYYY",LLL:"D. MMMM YYYY H:mm",LLLL:"dddd D. MMMM YYYY H:mm"},calendar:{sameDay:"[dnes o] LT",nextDay:"[zajtra o] LT",nextWeek:function(){switch(this.day()){case 0:return"[v nedeu o] LT";case 1:case 2:return"[v] dddd [o] LT";case 3:return"[v stredu o] LT";case 4:return"[vo tvrtok o] LT";case 5:return"[v piatok o] LT";case 6:return"[v sobotu o] LT"}},lastDay:"[vera o] LT",lastWeek:function(){switch(this.day()){case 0:return"[minul nedeu o] LT";case 1:case 2:return"[minul] dddd [o] LT";case 3:return"[minul stredu o] LT";case 4:case 5:return"[minul] dddd [o] LT";case 6:return"[minul sobotu o] LT"}},sameElse:"L"},relativeTime:{future:"za %s",past:"pred %s",s:ad,ss:ad,m:ad,mm:ad,h:ad,hh:ad,d:ad,dd:ad,M:ad,MM:ad,y:ad,yy:ad},dayOfMonthOrdinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:4}}),l.defineLocale("sl",{months:"januar_februar_marec_april_maj_junij_julij_avgust_september_oktober_november_december".split("_"),monthsShort:"jan._feb._mar._apr._maj._jun._jul._avg._sep._okt._nov._dec.".split("_"),monthsParseExact:!0,weekdays:"nedelja_ponedeljek_torek_sreda_etrtek_petek_sobota".split("_"),weekdaysShort:"ned._pon._tor._sre._et._pet._sob.".split("_"),weekdaysMin:"ne_po_to_sr_e_pe_so".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"H:mm",LTS:"H:mm:ss",L:"DD.MM.YYYY",LL:"D. MMMM YYYY",LLL:"D. MMMM YYYY H:mm",LLLL:"dddd, D. MMMM YYYY H:mm"},calendar:{sameDay:"[danes ob] LT",nextDay:"[jutri ob] LT",nextWeek:function(){switch(this.day()){case 0:return"[v] [nedeljo] [ob] LT";case 3:return"[v] [sredo] [ob] LT";case 6:return"[v] [soboto] [ob] LT";case 1:case 2:case 4:case 5:return"[v] dddd [ob] LT"}},lastDay:"[veraj ob] LT",lastWeek:function(){switch(this.day()){case 0:return"[prejnjo] [nedeljo] [ob] LT";case 3:return"[prejnjo] [sredo] [ob] LT";case 6:return"[prejnjo] [soboto] [ob] LT";case 1:case 2:case 4:case 5:return"[prejnji] dddd [ob] LT"}},sameElse:"L"},relativeTime:{future:"ez %s",past:"pred %s",s:td,ss:td,m:td,mm:td,h:td,hh:td,d:td,dd:td,M:td,MM:td,y:td,yy:td},dayOfMonthOrdinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:7}}),l.defineLocale("sq",{months:"Janar_Shkurt_Mars_Prill_Maj_Qershor_Korrik_Gusht_Shtator_Tetor_Nntor_Dhjetor".split("_"),monthsShort:"Jan_Shk_Mar_Pri_Maj_Qer_Kor_Gus_Sht_Tet_Nn_Dhj".split("_"),weekdays:"E Diel_E Hn_E Mart_E Mrkur_E Enjte_E Premte_E Shtun".split("_"),weekdaysShort:"Die_Hn_Mar_Mr_Enj_Pre_Sht".split("_"),weekdaysMin:"D_H_Ma_M_E_P_Sh".split("_"),weekdaysParseExact:!0,meridiemParse:/PD|MD/,isPM:function(e){return"M"===e.charAt(0)},meridiem:function(e,a,t){return e<12?"PD":"MD"},longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd, D MMMM YYYY HH:mm"},calendar:{sameDay:"[Sot n] LT",nextDay:"[Nesr n] LT",nextWeek:"dddd [n] LT",lastDay:"[Dje n] LT",lastWeek:"dddd [e kaluar n] LT",sameElse:"L"},relativeTime:{future:"n %s",past:"%s m par",s:"disa sekonda",ss:"%d sekonda",m:"nj minut",mm:"%d minuta",h:"nj or",hh:"%d or",d:"nj dit",dd:"%d dit",M:"nj muaj",MM:"%d muaj",y:"nj vit",yy:"%d vite"},dayOfMonthOrdinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:4}});var sd={words:{ss:["","",""],m:[" "," "],mm:["","",""],h:[" "," "],hh:["","",""],dd:["","",""],MM:["","",""],yy:["","",""]},correctGrammaticalCase:function(e,a){return 1===e?a[0]:2<=e&&e<=4?a[1]:a[2]},translate:function(e,a,t){var s=sd.words[t];return 1===t.length?a?s[0]:s[1]:e+" "+sd.correctGrammaticalCase(e,s)}};l.defineLocale("sr-cyrl",{months:"___________".split("_"),monthsShort:"._._._.____._._._._.".split("_"),monthsParseExact:!0,weekdays:"______".split("_"),weekdaysShort:"._._._._._._.".split("_"),weekdaysMin:"______".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"H:mm",LTS:"H:mm:ss",L:"DD.MM.YYYY",LL:"D. MMMM YYYY",LLL:"D. MMMM YYYY H:mm",LLLL:"dddd, D. MMMM YYYY H:mm"},calendar:{sameDay:"[ ] LT",nextDay:"[ ] LT",nextWeek:function(){switch(this.day()){case 0:return"[] [] [] LT";case 3:return"[] [] [] LT";case 6:return"[] [] [] LT";case 1:case 2:case 4:case 5:return"[] dddd [] LT"}},lastDay:"[ ] LT",lastWeek:function(){return["[] [] [] LT","[] [] [] LT","[] [] [] LT","[] [] [] LT","[] [] [] LT","[] [] [] LT","[] [] [] LT"][this.day()]},sameElse:"L"},relativeTime:{future:" %s",past:" %s",s:" ",ss:sd.translate,m:sd.translate,mm:sd.translate,h:sd.translate,hh:sd.translate,d:"",dd:sd.translate,M:"",MM:sd.translate,y:"",yy:sd.translate},dayOfMonthOrdinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:7}});var nd={words:{ss:["sekunda","sekunde","sekundi"],m:["jedan minut","jedne minute"],mm:["minut","minute","minuta"],h:["jedan sat","jednog sata"],hh:["sat","sata","sati"],dd:["dan","dana","dana"],MM:["mesec","meseca","meseci"],yy:["godina","godine","godina"]},correctGrammaticalCase:function(e,a){return 1===e?a[0]:2<=e&&e<=4?a[1]:a[2]},translate:function(e,a,t){var s=nd.words[t];return 1===t.length?a?s[0]:s[1]:e+" "+nd.correctGrammaticalCase(e,s)}};l.defineLocale("sr",{months:"januar_februar_mart_april_maj_jun_jul_avgust_septembar_oktobar_novembar_decembar".split("_"),monthsShort:"jan._feb._mar._apr._maj_jun_jul_avg._sep._okt._nov._dec.".split("_"),monthsParseExact:!0,weekdays:"nedelja_ponedeljak_utorak_sreda_etvrtak_petak_subota".split("_"),weekdaysShort:"ned._pon._uto._sre._et._pet._sub.".split("_"),weekdaysMin:"ne_po_ut_sr_e_pe_su".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"H:mm",LTS:"H:mm:ss",L:"DD.MM.YYYY",LL:"D. MMMM YYYY",LLL:"D. MMMM YYYY H:mm",LLLL:"dddd, D. MMMM YYYY H:mm"},calendar:{sameDay:"[danas u] LT",nextDay:"[sutra u] LT",nextWeek:function(){switch(this.day()){case 0:return"[u] [nedelju] [u] LT";case 3:return"[u] [sredu] [u] LT";case 6:return"[u] [subotu] [u] LT";case 1:case 2:case 4:case 5:return"[u] dddd [u] LT"}},lastDay:"[jue u] LT",lastWeek:function(){return["[prole] [nedelje] [u] LT","[prolog] [ponedeljka] [u] LT","[prolog] [utorka] [u] LT","[prole] [srede] [u] LT","[prolog] [etvrtka] [u] LT","[prolog] [petka] [u] LT","[prole] [subote] [u] LT"][this.day()]},sameElse:"L"},relativeTime:{future:"za %s",past:"pre %s",s:"nekoliko sekundi",ss:nd.translate,m:nd.translate,mm:nd.translate,h:nd.translate,hh:nd.translate,d:"dan",dd:nd.translate,M:"mesec",MM:nd.translate,y:"godinu",yy:nd.translate},dayOfMonthOrdinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:7}}),l.defineLocale("ss",{months:"Bhimbidvwane_Indlovana_Indlov'lenkhulu_Mabasa_Inkhwekhweti_Inhlaba_Kholwane_Ingci_Inyoni_Imphala_Lweti_Ingongoni".split("_"),monthsShort:"Bhi_Ina_Inu_Mab_Ink_Inh_Kho_Igc_Iny_Imp_Lwe_Igo".split("_"),weekdays:"Lisontfo_Umsombuluko_Lesibili_Lesitsatfu_Lesine_Lesihlanu_Umgcibelo".split("_"),weekdaysShort:"Lis_Umb_Lsb_Les_Lsi_Lsh_Umg".split("_"),weekdaysMin:"Li_Us_Lb_Lt_Ls_Lh_Ug".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"h:mm A",LTS:"h:mm:ss A",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY h:mm A",LLLL:"dddd, D MMMM YYYY h:mm A"},calendar:{sameDay:"[Namuhla nga] LT",nextDay:"[Kusasa nga] LT",nextWeek:"dddd [nga] LT",lastDay:"[Itolo nga] LT",lastWeek:"dddd [leliphelile] [nga] LT",sameElse:"L"},relativeTime:{future:"nga %s",past:"wenteka nga %s",s:"emizuzwana lomcane",ss:"%d mzuzwana",m:"umzuzu",mm:"%d emizuzu",h:"lihora",hh:"%d emahora",d:"lilanga",dd:"%d emalanga",M:"inyanga",MM:"%d tinyanga",y:"umnyaka",yy:"%d iminyaka"},meridiemParse:/ekuseni|emini|entsambama|ebusuku/,meridiem:function(e,a,t){return e<11?"ekuseni":e<15?"emini":e<19?"entsambama":"ebusuku"},meridiemHour:function(e,a){return 12===e&&(e=0),"ekuseni"===a?e:"emini"===a?11<=e?e:e+12:"entsambama"===a||"ebusuku"===a?0===e?0:e+12:void 0},dayOfMonthOrdinalParse:/\d{1,2}/,ordinal:"%d",week:{dow:1,doy:4}}),l.defineLocale("sv",{months:"januari_februari_mars_april_maj_juni_juli_augusti_september_oktober_november_december".split("_"),monthsShort:"jan_feb_mar_apr_maj_jun_jul_aug_sep_okt_nov_dec".split("_"),weekdays:"sndag_mndag_tisdag_onsdag_torsdag_fredag_lrdag".split("_"),weekdaysShort:"sn_mn_tis_ons_tor_fre_lr".split("_"),weekdaysMin:"s_m_ti_on_to_fr_l".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"YYYY-MM-DD",LL:"D MMMM YYYY",LLL:"D MMMM YYYY [kl.] HH:mm",LLLL:"dddd D MMMM YYYY [kl.] HH:mm",lll:"D MMM YYYY HH:mm",llll:"ddd D MMM YYYY HH:mm"},calendar:{sameDay:"[Idag] LT",nextDay:"[Imorgon] LT",lastDay:"[Igr] LT",nextWeek:"[P] dddd LT",lastWeek:"[I] dddd[s] LT",sameElse:"L"},relativeTime:{future:"om %s",past:"fr %s sedan",s:"ngra sekunder",ss:"%d sekunder",m:"en minut",mm:"%d minuter",h:"en timme",hh:"%d timmar",d:"en dag",dd:"%d dagar",M:"en mnad",MM:"%d mnader",y:"ett r",yy:"%d r"},dayOfMonthOrdinalParse:/\d{1,2}(e|a)/,ordinal:function(e){var a=e%10;return e+(1==~~(e%100/10)?"e":1==a?"a":2==a?"a":"e")},week:{dow:1,doy:4}}),l.defineLocale("sw",{months:"Januari_Februari_Machi_Aprili_Mei_Juni_Julai_Agosti_Septemba_Oktoba_Novemba_Desemba".split("_"),monthsShort:"Jan_Feb_Mac_Apr_Mei_Jun_Jul_Ago_Sep_Okt_Nov_Des".split("_"),weekdays:"Jumapili_Jumatatu_Jumanne_Jumatano_Alhamisi_Ijumaa_Jumamosi".split("_"),weekdaysShort:"Jpl_Jtat_Jnne_Jtan_Alh_Ijm_Jmos".split("_"),weekdaysMin:"J2_J3_J4_J5_Al_Ij_J1".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD.MM.YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd, D MMMM YYYY HH:mm"},calendar:{sameDay:"[leo saa] LT",nextDay:"[kesho saa] LT",nextWeek:"[wiki ijayo] dddd [saat] LT",lastDay:"[jana] LT",lastWeek:"[wiki iliyopita] dddd [saat] LT",sameElse:"L"},relativeTime:{future:"%s baadaye",past:"tokea %s",s:"hivi punde",ss:"sekunde %d",m:"dakika moja",mm:"dakika %d",h:"saa limoja",hh:"masaa %d",d:"siku moja",dd:"masiku %d",M:"mwezi mmoja",MM:"miezi %d",y:"mwaka mmoja",yy:"miaka %d"},week:{dow:1,doy:7}});var dd={1:"",2:"",3:"",4:"",5:"",6:"",7:"",8:"",9:"",0:""},rd={"":"1","":"2","":"3","":"4","":"5","":"6","":"7","":"8","":"9","":"0"};l.defineLocale("ta",{months:"___________".split("_"),monthsShort:"___________".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY, HH:mm",LLLL:"dddd, D MMMM YYYY, HH:mm"},calendar:{sameDay:"[] LT",nextDay:"[] LT",nextWeek:"dddd, LT",lastDay:"[] LT",lastWeek:"[ ] dddd, LT",sameElse:"L"},relativeTime:{future:"%s ",past:"%s ",s:"  ",ss:"%d ",m:" ",mm:"%d ",h:"  ",hh:"%d  ",d:" ",dd:"%d ",M:" ",MM:"%d ",y:" ",yy:"%d "},dayOfMonthOrdinalParse:/\d{1,2}\u0bb5\u0ba4\u0bc1/,ordinal:function(e){return e+""},preparse:function(e){return e.replace(/[\u0be7\u0be8\u0be9\u0bea\u0beb\u0bec\u0bed\u0bee\u0bef\u0be6]/g,function(e){return rd[e]})},postformat:function(e){return e.replace(/\d/g,function(e){return dd[e]})},meridiemParse:/\u0baf\u0bbe\u0bae\u0bae\u0bcd|\u0bb5\u0bc8\u0b95\u0bb1\u0bc8|\u0b95\u0bbe\u0bb2\u0bc8|\u0ba8\u0ba3\u0bcd\u0baa\u0b95\u0bb2\u0bcd|\u0b8e\u0bb1\u0bcd\u0baa\u0bbe\u0b9f\u0bc1|\u0bae\u0bbe\u0bb2\u0bc8/,meridiem:function(e,a,t){return e<2?" ":e<6?" ":e<10?" ":e<14?" ":e<18?" ":e<22?" ":" "},meridiemHour:function(e,a){return 12===e&&(e=0),""===a?e<2?e:e+12:""===a||""===a?e:""===a&&10<=e?e:e+12},week:{dow:0,doy:6}}),l.defineLocale("te",{months:"___________".split("_"),monthsShort:"._.__.____._._._._.".split("_"),monthsParseExact:!0,weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"A h:mm",LTS:"A h:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY, A h:mm",LLLL:"dddd, D MMMM YYYY, A h:mm"},calendar:{sameDay:"[] LT",nextDay:"[] LT",nextWeek:"dddd, LT",lastDay:"[] LT",lastWeek:"[] dddd, LT",sameElse:"L"},relativeTime:{future:"%s ",past:"%s ",s:" ",ss:"%d ",m:" ",mm:"%d ",h:" ",hh:"%d ",d:" ",dd:"%d ",M:" ",MM:"%d ",y:" ",yy:"%d "},dayOfMonthOrdinalParse:/\d{1,2}\u0c35/,ordinal:"%d",meridiemParse:/\u0c30\u0c3e\u0c24\u0c4d\u0c30\u0c3f|\u0c09\u0c26\u0c2f\u0c02|\u0c2e\u0c27\u0c4d\u0c2f\u0c3e\u0c39\u0c4d\u0c28\u0c02|\u0c38\u0c3e\u0c2f\u0c02\u0c24\u0c4d\u0c30\u0c02/,meridiemHour:function(e,a){return 12===e&&(e=0),""===a?e<4?e:e+12:""===a?e:""===a?10<=e?e:e+12:""===a?e+12:void 0},meridiem:function(e,a,t){return e<4?"":e<10?"":e<17?"":e<20?"":""},week:{dow:0,doy:6}}),l.defineLocale("tet",{months:"Janeiru_Fevereiru_Marsu_Abril_Maiu_Juu_Jullu_Agustu_Setembru_Outubru_Novembru_Dezembru".split("_"),monthsShort:"Jan_Fev_Mar_Abr_Mai_Jun_Jul_Ago_Set_Out_Nov_Dez".split("_"),weekdays:"Domingu_Segunda_Tersa_Kuarta_Kinta_Sesta_Sabadu".split("_"),weekdaysShort:"Dom_Seg_Ters_Kua_Kint_Sest_Sab".split("_"),weekdaysMin:"Do_Seg_Te_Ku_Ki_Ses_Sa".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd, D MMMM YYYY HH:mm"},calendar:{sameDay:"[Ohin iha] LT",nextDay:"[Aban iha] LT",nextWeek:"dddd [iha] LT",lastDay:"[Horiseik iha] LT",lastWeek:"dddd [semana kotuk] [iha] LT",sameElse:"L"},relativeTime:{future:"iha %s",past:"%s liuba",s:"minutu balun",ss:"minutu %d",m:"minutu ida",mm:"minutu %d",h:"oras ida",hh:"oras %d",d:"loron ida",dd:"loron %d",M:"fulan ida",MM:"fulan %d",y:"tinan ida",yy:"tinan %d"},dayOfMonthOrdinalParse:/\d{1,2}(st|nd|rd|th)/,ordinal:function(e){var a=e%10;return e+(1==~~(e%100/10)?"th":1==a?"st":2==a?"nd":3==a?"rd":"th")},week:{dow:1,doy:4}});var _d={0:"-",1:"-",2:"-",3:"-",4:"-",5:"-",6:"-",7:"-",8:"-",9:"-",10:"-",12:"-",13:"-",20:"-",30:"-",40:"-",50:"-",60:"-",70:"-",80:"-",90:"-",100:"-"};l.defineLocale("tg",{months:"___________".split("_"),monthsShort:"___________".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd, D MMMM YYYY HH:mm"},calendar:{sameDay:"[ ] LT",nextDay:"[ ] LT",lastDay:"[ ] LT",nextWeek:"dddd[] [  ] LT",lastWeek:"dddd[] [  ] LT",sameElse:"L"},relativeTime:{future:" %s",past:"%s ",s:" ",m:" ",mm:"%d ",h:" ",hh:"%d ",d:" ",dd:"%d ",M:" ",MM:"%d ",y:" ",yy:"%d "},meridiemParse:/\u0448\u0430\u0431|\u0441\u0443\u0431\u04b3|\u0440\u04ef\u0437|\u0431\u0435\u0433\u043e\u04b3/,meridiemHour:function(e,a){return 12===e&&(e=0),""===a?e<4?e:e+12:""===a?e:""===a?11<=e?e:e+12:""===a?e+12:void 0},meridiem:function(e,a,t){return e<4?"":e<11?"":e<16?"":e<19?"":""},dayOfMonthOrdinalParse:/\d{1,2}-(\u0443\u043c|\u044e\u043c)/,ordinal:function(e){return e+(_d[e]||_d[e%10]||_d[100<=e?100:null])},week:{dow:1,doy:7}}),l.defineLocale("th",{months:"___________".split("_"),monthsShort:".._.._.._.._.._.._.._.._.._.._.._..".split("_"),monthsParseExact:!0,weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"._._._._._._.".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"H:mm",LTS:"H:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY  H:mm",LLLL:"dddd D MMMM YYYY  H:mm"},meridiemParse:/\u0e01\u0e48\u0e2d\u0e19\u0e40\u0e17\u0e35\u0e48\u0e22\u0e07|\u0e2b\u0e25\u0e31\u0e07\u0e40\u0e17\u0e35\u0e48\u0e22\u0e07/,isPM:function(e){return""===e},meridiem:function(e,a,t){return e<12?"":""},calendar:{sameDay:"[ ] LT",nextDay:"[ ] LT",nextWeek:"dddd[ ] LT",lastDay:"[ ] LT",lastWeek:"[]dddd[ ] LT",sameElse:"L"},relativeTime:{future:" %s",past:"%s",s:"",ss:"%d ",m:"1 ",mm:"%d ",h:"1 ",hh:"%d ",d:"1 ",dd:"%d ",M:"1 ",MM:"%d ",y:"1 ",yy:"%d "}}),l.defineLocale("tl-ph",{months:"Enero_Pebrero_Marso_Abril_Mayo_Hunyo_Hulyo_Agosto_Setyembre_Oktubre_Nobyembre_Disyembre".split("_"),monthsShort:"Ene_Peb_Mar_Abr_May_Hun_Hul_Ago_Set_Okt_Nob_Dis".split("_"),weekdays:"Linggo_Lunes_Martes_Miyerkules_Huwebes_Biyernes_Sabado".split("_"),weekdaysShort:"Lin_Lun_Mar_Miy_Huw_Biy_Sab".split("_"),weekdaysMin:"Li_Lu_Ma_Mi_Hu_Bi_Sab".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"MM/D/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY HH:mm",LLLL:"dddd, MMMM DD, YYYY HH:mm"},calendar:{sameDay:"LT [ngayong araw]",nextDay:"[Bukas ng] LT",nextWeek:"LT [sa susunod na] dddd",lastDay:"LT [kahapon]",lastWeek:"LT [noong nakaraang] dddd",sameElse:"L"},relativeTime:{future:"sa loob ng %s",past:"%s ang nakalipas",s:"ilang segundo",ss:"%d segundo",m:"isang minuto",mm:"%d minuto",h:"isang oras",hh:"%d oras",d:"isang araw",dd:"%d araw",M:"isang buwan",MM:"%d buwan",y:"isang taon",yy:"%d taon"},dayOfMonthOrdinalParse:/\d{1,2}/,ordinal:function(e){return e},week:{dow:1,doy:4}});var id="pagh_wa_cha_wej_loS_vagh_jav_Soch_chorgh_Hut".split("_");function od(e,a,t,s){var n=function(e){var a=Math.floor(e%1e3/100),t=Math.floor(e%100/10),s=e%10,n="";return 0<a&&(n+=id[a]+"vatlh"),0<t&&(n+=(""!==n?" ":"")+id[t]+"maH"),0<s&&(n+=(""!==n?" ":"")+id[s]),""===n?"pagh":n}(e);switch(t){case"ss":return n+" lup";case"mm":return n+" tup";case"hh":return n+" rep";case"dd":return n+" jaj";case"MM":return n+" jar";case"yy":return n+" DIS"}}l.defineLocale("tlh",{months:"tera jar wa_tera jar cha_tera jar wej_tera jar loS_tera jar vagh_tera jar jav_tera jar Soch_tera jar chorgh_tera jar Hut_tera jar wamaH_tera jar wamaH wa_tera jar wamaH cha".split("_"),monthsShort:"jar wa_jar cha_jar wej_jar loS_jar vagh_jar jav_jar Soch_jar chorgh_jar Hut_jar wamaH_jar wamaH wa_jar wamaH cha".split("_"),monthsParseExact:!0,weekdays:"lojmItjaj_DaSjaj_povjaj_ghItlhjaj_loghjaj_buqjaj_ghInjaj".split("_"),weekdaysShort:"lojmItjaj_DaSjaj_povjaj_ghItlhjaj_loghjaj_buqjaj_ghInjaj".split("_"),weekdaysMin:"lojmItjaj_DaSjaj_povjaj_ghItlhjaj_loghjaj_buqjaj_ghInjaj".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD.MM.YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd, D MMMM YYYY HH:mm"},calendar:{sameDay:"[DaHjaj] LT",nextDay:"[waleS] LT",nextWeek:"LLL",lastDay:"[waHu] LT",lastWeek:"LLL",sameElse:"L"},relativeTime:{future:function(e){var a=e;return-1!==e.indexOf("jaj")?a.slice(0,-3)+"leS":-1!==e.indexOf("jar")?a.slice(0,-3)+"waQ":-1!==e.indexOf("DIS")?a.slice(0,-3)+"nem":a+" pIq"},past:function(e){var a=e;return-1!==e.indexOf("jaj")?a.slice(0,-3)+"Hu":-1!==e.indexOf("jar")?a.slice(0,-3)+"wen":-1!==e.indexOf("DIS")?a.slice(0,-3)+"ben":a+" ret"},s:"puS lup",ss:od,m:"wa tup",mm:od,h:"wa rep",hh:od,d:"wa jaj",dd:od,M:"wa jar",MM:od,y:"wa DIS",yy:od},dayOfMonthOrdinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:4}});var md={1:"'inci",5:"'inci",8:"'inci",70:"'inci",80:"'inci",2:"'nci",7:"'nci",20:"'nci",50:"'nci",3:"'nc",4:"'nc",100:"'nc",6:"'nc",9:"'uncu",10:"'uncu",30:"'uncu",60:"'nc",90:"'nc"};function ud(e,a,t,s){var n={s:["viensas secunds","'iensas secunds"],ss:[e+" secunds",e+" secunds"],m:["'n mut","'iens mut"],mm:[e+" muts",e+" muts"],h:["'n ora","'iensa ora"],hh:[e+" oras",e+" oras"],d:["'n ziua","'iensa ziua"],dd:[e+" ziuas",e+" ziuas"],M:["'n mes","'iens mes"],MM:[e+" mesen",e+" mesen"],y:["'n ar","'iens ar"],yy:[e+" ars",e+" ars"]};return s?n[t][0]:a?n[t][0]:n[t][1]}function ld(e,a,t){var s,n;return"m"===t?a?"":"":"h"===t?a?"":"":e+" "+(s=+e,n={ss:a?"__":"__",mm:a?"__":"__",hh:a?"__":"__",dd:"__",MM:"__",yy:"__"}[t].split("_"),s%10==1&&s%100!=11?n[0]:2<=s%10&&s%10<=4&&(s%100<10||20<=s%100)?n[1]:n[2])}function Md(e){return function(){return e+""+(11===this.hours()?"":"")+"] LT"}}l.defineLocale("tr",{months:"Ocak_ubat_Mart_Nisan_Mays_Haziran_Temmuz_Austos_Eyll_Ekim_Kasm_Aralk".split("_"),monthsShort:"Oca_ub_Mar_Nis_May_Haz_Tem_Au_Eyl_Eki_Kas_Ara".split("_"),weekdays:"Pazar_Pazartesi_Sal_aramba_Perembe_Cuma_Cumartesi".split("_"),weekdaysShort:"Paz_Pts_Sal_ar_Per_Cum_Cts".split("_"),weekdaysMin:"Pz_Pt_Sa_a_Pe_Cu_Ct".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD.MM.YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd, D MMMM YYYY HH:mm"},calendar:{sameDay:"[bugn saat] LT",nextDay:"[yarn saat] LT",nextWeek:"[gelecek] dddd [saat] LT",lastDay:"[dn] LT",lastWeek:"[geen] dddd [saat] LT",sameElse:"L"},relativeTime:{future:"%s sonra",past:"%s nce",s:"birka saniye",ss:"%d saniye",m:"bir dakika",mm:"%d dakika",h:"bir saat",hh:"%d saat",d:"bir gn",dd:"%d gn",M:"bir ay",MM:"%d ay",y:"bir yl",yy:"%d yl"},ordinal:function(e,a){switch(a){case"d":case"D":case"Do":case"DD":return e;default:if(0===e)return e+"'nc";var t=e%10;return e+(md[t]||md[e%100-t]||md[100<=e?100:null])}},week:{dow:1,doy:7}}),l.defineLocale("tzl",{months:"Januar_Fevraglh_Mar_Avru_Mai_Gn_Julia_Guscht_Setemvar_Listopts_Noemvar_Zecemvar".split("_"),monthsShort:"Jan_Fev_Mar_Avr_Mai_Gn_Jul_Gus_Set_Lis_Noe_Zec".split("_"),weekdays:"Sladi_Lnei_Maitzi_Mrcuri_Xhadi_Vineri_Sturi".split("_"),weekdaysShort:"Sl_Ln_Mai_Mr_Xh_Vi_St".split("_"),weekdaysMin:"S_L_Ma_M_Xh_Vi_S".split("_"),longDateFormat:{LT:"HH.mm",LTS:"HH.mm.ss",L:"DD.MM.YYYY",LL:"D. MMMM [dallas] YYYY",LLL:"D. MMMM [dallas] YYYY HH.mm",LLLL:"dddd, [li] D. MMMM [dallas] YYYY HH.mm"},meridiemParse:/d\'o|d\'a/i,isPM:function(e){return"d'o"===e.toLowerCase()},meridiem:function(e,a,t){return 11<e?t?"d'o":"D'O":t?"d'a":"D'A"},calendar:{sameDay:"[oxhi ] LT",nextDay:"[dem ] LT",nextWeek:"dddd [] LT",lastDay:"[ieiri ] LT",lastWeek:"[sr el] dddd [lasteu ] LT",sameElse:"L"},relativeTime:{future:"osprei %s",past:"ja%s",s:ud,ss:ud,m:ud,mm:ud,h:ud,hh:ud,d:ud,dd:ud,M:ud,MM:ud,y:ud,yy:ud},dayOfMonthOrdinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:4}}),l.defineLocale("tzm-latn",{months:"innayr_brayr_mars_ibrir_mayyw_ywnyw_ywlywz_wt_wtanbir_ktwbr_nwwanbir_dwjnbir".split("_"),monthsShort:"innayr_brayr_mars_ibrir_mayyw_ywnyw_ywlywz_wt_wtanbir_ktwbr_nwwanbir_dwjnbir".split("_"),weekdays:"asamas_aynas_asinas_akras_akwas_asimwas_asiyas".split("_"),weekdaysShort:"asamas_aynas_asinas_akras_akwas_asimwas_asiyas".split("_"),weekdaysMin:"asamas_aynas_asinas_akras_akwas_asimwas_asiyas".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd D MMMM YYYY HH:mm"},calendar:{sameDay:"[asdkh g] LT",nextDay:"[aska g] LT",nextWeek:"dddd [g] LT",lastDay:"[assant g] LT",lastWeek:"dddd [g] LT",sameElse:"L"},relativeTime:{future:"dadkh s yan %s",past:"yan %s",s:"imik",ss:"%d imik",m:"minu",mm:"%d minu",h:"saa",hh:"%d tassain",d:"ass",dd:"%d ossan",M:"ayowr",MM:"%d iyyirn",y:"asgas",yy:"%d isgasn"},week:{dow:6,doy:12}}),l.defineLocale("tzm",{months:"___________".split("_"),monthsShort:"___________".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd D MMMM YYYY HH:mm"},calendar:{sameDay:"[ ] LT",nextDay:"[ ] LT",nextWeek:"dddd [] LT",lastDay:"[ ] LT",lastWeek:"dddd [] LT",sameElse:"L"},relativeTime:{future:"   %s",past:" %s",s:"",ss:"%d ",m:"",mm:"%d ",h:"",hh:"%d ",d:"",dd:"%d o",M:"o",MM:"%d ",y:"",yy:"%d "},week:{dow:6,doy:12}}),l.defineLocale("ug-cn",{months:"___________".split("_"),monthsShort:"___________".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"YYYY-MM-DD",LL:"YYYY-M-D-",LLL:"YYYY-M-D- HH:mm",LLLL:"dddd YYYY-M-D- HH:mm"},meridiemParse:/\u064a\u06d0\u0631\u0649\u0645 \u0643\u06d0\u0686\u06d5|\u0633\u06d5\u06be\u06d5\u0631|\u0686\u06c8\u0634\u062a\u0649\u0646 \u0628\u06c7\u0631\u06c7\u0646|\u0686\u06c8\u0634|\u0686\u06c8\u0634\u062a\u0649\u0646 \u0643\u06d0\u064a\u0649\u0646|\u0643\u06d5\u0686/,meridiemHour:function(e,a){return 12===e&&(e=0)," "===a||""===a||" "===a?e:" "===a||""===a?e+12:11<=e?e:e+12},meridiem:function(e,a,t){var s=100*e+a;return s<600?" ":s<900?"":s<1130?" ":s<1230?"":s<1800?" ":""},calendar:{sameDay:"[ ] LT",nextDay:"[ ] LT",nextWeek:"[] dddd [] LT",lastDay:"[] LT",lastWeek:"[] dddd [] LT",sameElse:"L"},relativeTime:{future:"%s ",past:"%s ",s:" ",ss:"%d ",m:" ",mm:"%d ",h:" ",hh:"%d ",d:" ",dd:"%d ",M:" ",MM:"%d ",y:" ",yy:"%d "},dayOfMonthOrdinalParse:/\d{1,2}(-\u0643\u06c8\u0646\u0649|-\u0626\u0627\u064a|-\u06be\u06d5\u067e\u062a\u06d5)/,ordinal:function(e,a){switch(a){case"d":case"D":case"DDD":return e+"-";case"w":case"W":return e+"-";default:return e}},preparse:function(e){return e.replace(/\u060c/g,",")},postformat:function(e){return e.replace(/,/g,"")},week:{dow:1,doy:7}}),l.defineLocale("uk",{months:{format:"___________".split("_"),standalone:"___________".split("_")},monthsShort:"___________".split("_"),weekdays:function(e,a){var t={nominative:"______".split("_"),accusative:"______".split("_"),genitive:"______".split("_")};return!0===e?t.nominative.slice(1,7).concat(t.nominative.slice(0,1)):e?t[/(\[[\u0412\u0432\u0423\u0443]\]) ?dddd/.test(a)?"accusative":/\[?(?:\u043c\u0438\u043d\u0443\u043b\u043e\u0457|\u043d\u0430\u0441\u0442\u0443\u043f\u043d\u043e\u0457)? ?\] ?dddd/.test(a)?"genitive":"nominative"][e.day()]:t.nominative},weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD.MM.YYYY",LL:"D MMMM YYYY .",LLL:"D MMMM YYYY ., HH:mm",LLLL:"dddd, D MMMM YYYY ., HH:mm"},calendar:{sameDay:Md("[ "),nextDay:Md("[ "),lastDay:Md("[ "),nextWeek:Md("[] dddd ["),lastWeek:function(){switch(this.day()){case 0:case 3:case 5:case 6:return Md("[] dddd [").call(this);case 1:case 2:case 4:return Md("[] dddd [").call(this)}},sameElse:"L"},relativeTime:{future:" %s",past:"%s ",s:" ",ss:ld,m:ld,mm:ld,h:"",hh:ld,d:"",dd:ld,M:"",MM:ld,y:"",yy:ld},meridiemParse:/\u043d\u043e\u0447\u0456|\u0440\u0430\u043d\u043a\u0443|\u0434\u043d\u044f|\u0432\u0435\u0447\u043e\u0440\u0430/,isPM:function(e){return/^(\u0434\u043d\u044f|\u0432\u0435\u0447\u043e\u0440\u0430)$/.test(e)},meridiem:function(e,a,t){return e<4?"":e<12?"":e<17?"":""},dayOfMonthOrdinalParse:/\d{1,2}-(\u0439|\u0433\u043e)/,ordinal:function(e,a){switch(a){case"M":case"d":case"DDD":case"w":case"W":return e+"-";case"D":return e+"-";default:return e}},week:{dow:1,doy:7}});var hd=["","","","","","","","","","","",""],Ld=["","","","","","",""];return l.defineLocale("ur",{months:hd,monthsShort:hd,weekdays:Ld,weekdaysShort:Ld,weekdaysMin:Ld,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd D MMMM YYYY HH:mm"},meridiemParse:/\u0635\u0628\u062d|\u0634\u0627\u0645/,isPM:function(e){return""===e},meridiem:function(e,a,t){return e<12?"":""},calendar:{sameDay:"[ ] LT",nextDay:"[ ] LT",nextWeek:"dddd [] LT",lastDay:"[  ] LT",lastWeek:"[] dddd [] LT",sameElse:"L"},relativeTime:{future:"%s ",past:"%s ",s:" ",ss:"%d ",m:" ",mm:"%d ",h:" ",hh:"%d ",d:" ",dd:"%d ",M:" ",MM:"%d ",y:" ",yy:"%d "},preparse:function(e){return e.replace(/\u060c/g,",")},postformat:function(e){return e.replace(/,/g,"")},week:{dow:1,doy:4}}),l.defineLocale("uz-latn",{months:"Yanvar_Fevral_Mart_Aprel_May_Iyun_Iyul_Avgust_Sentabr_Oktabr_Noyabr_Dekabr".split("_"),monthsShort:"Yan_Fev_Mar_Apr_May_Iyun_Iyul_Avg_Sen_Okt_Noy_Dek".split("_"),weekdays:"Yakshanba_Dushanba_Seshanba_Chorshanba_Payshanba_Juma_Shanba".split("_"),weekdaysShort:"Yak_Dush_Sesh_Chor_Pay_Jum_Shan".split("_"),weekdaysMin:"Ya_Du_Se_Cho_Pa_Ju_Sha".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"D MMMM YYYY, dddd HH:mm"},calendar:{sameDay:"[Bugun soat] LT [da]",nextDay:"[Ertaga] LT [da]",nextWeek:"dddd [kuni soat] LT [da]",lastDay:"[Kecha soat] LT [da]",lastWeek:"[O'tgan] dddd [kuni soat] LT [da]",sameElse:"L"},relativeTime:{future:"Yaqin %s ichida",past:"Bir necha %s oldin",s:"soniya",ss:"%d soniya",m:"bir daqiqa",mm:"%d daqiqa",h:"bir soat",hh:"%d soat",d:"bir kun",dd:"%d kun",M:"bir oy",MM:"%d oy",y:"bir yil",yy:"%d yil"},week:{dow:1,doy:7}}),l.defineLocale("uz",{months:"___________".split("_"),monthsShort:"___________".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"D MMMM YYYY, dddd HH:mm"},calendar:{sameDay:"[ ] LT []",nextDay:"[] LT []",nextWeek:"dddd [ ] LT []",lastDay:"[ ] LT []",lastWeek:"[] dddd [ ] LT []",sameElse:"L"},relativeTime:{future:" %s ",past:"  %s ",s:"",ss:"%d ",m:" ",mm:"%d ",h:" ",hh:"%d ",d:" ",dd:"%d ",M:" ",MM:"%d ",y:" ",yy:"%d "},week:{dow:1,doy:7}}),l.defineLocale("vi",{months:"thng 1_thng 2_thng 3_thng 4_thng 5_thng 6_thng 7_thng 8_thng 9_thng 10_thng 11_thng 12".split("_"),monthsShort:"Th01_Th02_Th03_Th04_Th05_Th06_Th07_Th08_Th09_Th10_Th11_Th12".split("_"),monthsParseExact:!0,weekdays:"ch nht_th hai_th ba_th t_th nm_th su_th by".split("_"),weekdaysShort:"CN_T2_T3_T4_T5_T6_T7".split("_"),weekdaysMin:"CN_T2_T3_T4_T5_T6_T7".split("_"),weekdaysParseExact:!0,meridiemParse:/sa|ch/i,isPM:function(e){return/^ch$/i.test(e)},meridiem:function(e,a,t){return e<12?t?"sa":"SA":t?"ch":"CH"},longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM [nm] YYYY",LLL:"D MMMM [nm] YYYY HH:mm",LLLL:"dddd, D MMMM [nm] YYYY HH:mm",l:"DD/M/YYYY",ll:"D MMM YYYY",lll:"D MMM YYYY HH:mm",llll:"ddd, D MMM YYYY HH:mm"},calendar:{sameDay:"[Hm nay lc] LT",nextDay:"[Ngy mai lc] LT",nextWeek:"dddd [tun ti lc] LT",lastDay:"[Hm qua lc] LT",lastWeek:"dddd [tun ri lc] LT",sameElse:"L"},relativeTime:{future:"%s ti",past:"%s trc",s:"vi giy",ss:"%d giy",m:"mt pht",mm:"%d pht",h:"mt gi",hh:"%d gi",d:"mt ngy",dd:"%d ngy",M:"mt thng",MM:"%d thng",y:"mt nm",yy:"%d nm"},dayOfMonthOrdinalParse:/\d{1,2}/,ordinal:function(e){return e},week:{dow:1,doy:4}}),l.defineLocale("x-pseudo",{months:"J~~r_F~br~r_~Mrc~h_p~rl_~M_~J~_Jl~_~gst~_Sp~tmb~r_~ctb~r_~vm~br_~Dc~mbr".split("_"),monthsShort:"J~_~Fb_~Mr_~pr_~M_~J_~Jl_~g_~Sp_~ct_~v_~Dc".split("_"),monthsParseExact:!0,weekdays:"S~d~_M~d~_T~sd~_Wd~sd~_T~hrs~d_~Frd~_S~tr~d".split("_"),weekdaysShort:"S~_~M_~T_~Wd_~Th_~Fr_~St".split("_"),weekdaysMin:"S~_M~_T_~W_T~h_Fr~_S".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd, D MMMM YYYY HH:mm"},calendar:{sameDay:"[T~d~ t] LT",nextDay:"[T~m~rr~w t] LT",nextWeek:"dddd [t] LT",lastDay:"[~st~rd~ t] LT",lastWeek:"[L~st] dddd [t] LT",sameElse:"L"},relativeTime:{future:"~ %s",past:"%s ~g",s:" ~fw ~sc~ds",ss:"%d s~c~ds",m:" ~m~t",mm:"%d m~~ts",h:"~ h~r",hh:"%d h~rs",d:" ~d",dd:"%d d~s",M:" ~m~th",MM:"%d m~t~hs",y:" ~r",yy:"%d ~rs"},dayOfMonthOrdinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(e){var a=e%10;return e+(1==~~(e%100/10)?"th":1==a?"st":2==a?"nd":3==a?"rd":"th")},week:{dow:1,doy:4}}),l.defineLocale("yo",{months:"Sr_Erele_rna_Igbe_Ebibi_Okudu_Agmo_Ogun_Owewe_wara_Belu_p".split("_"),monthsShort:"Sr_Erl_rn_Igb_Ebi_Oku_Ag_Ogu_Owe_wa_Bel_p".split("_"),weekdays:"Aiku_Aje_Isgun_jru_jb_ti_Abamta".split("_"),weekdaysShort:"Aik_Aje_Is_jr_jb_ti_Aba".split("_"),weekdaysMin:"Ai_Aj_Is_r_b_t_Ab".split("_"),longDateFormat:{LT:"h:mm A",LTS:"h:mm:ss A",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY h:mm A",LLLL:"dddd, D MMMM YYYY h:mm A"},calendar:{sameDay:"[Oni ni] LT",nextDay:"[la ni] LT",nextWeek:"dddd [s ton'b] [ni] LT",lastDay:"[Ana ni] LT",lastWeek:"dddd [s tol] [ni] LT",sameElse:"L"},relativeTime:{future:"ni %s",past:"%s kja",s:"isju aaya die",ss:"aaya %d",m:"isju kan",mm:"isju %d",h:"wakati kan",hh:"wakati %d",d:"j kan",dd:"j %d",M:"osu kan",MM:"osu %d",y:"dun kan",yy:"dun %d"},dayOfMonthOrdinalParse:/\u1ecdj\u1ecd\u0301\s\d{1,2}/,ordinal:"j %d",week:{dow:1,doy:4}}),l.defineLocale("zh-cn",{months:"___________".split("_"),monthsShort:"1_2_3_4_5_6_7_8_9_10_11_12".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"YYYY/MM/DD",LL:"YYYYMD",LLL:"YYYYMDAhmm",LLLL:"YYYYMDddddAhmm",l:"YYYY/M/D",ll:"YYYYMD",lll:"YYYYMD HH:mm",llll:"YYYYMDdddd HH:mm"},meridiemParse:/\u51cc\u6668|\u65e9\u4e0a|\u4e0a\u5348|\u4e2d\u5348|\u4e0b\u5348|\u665a\u4e0a/,meridiemHour:function(e,a){return 12===e&&(e=0),""===a||""===a||""===a?e:""===a||""===a?e+12:11<=e?e:e+12},meridiem:function(e,a,t){var s=100*e+a;return s<600?"":s<900?"":s<1130?"":s<1230?"":s<1800?"":""},calendar:{sameDay:"[]LT",nextDay:"[]LT",nextWeek:"[]ddddLT",lastDay:"[]LT",lastWeek:"[]ddddLT",sameElse:"L"},dayOfMonthOrdinalParse:/\d{1,2}(\u65e5|\u6708|\u5468)/,ordinal:function(e,a){switch(a){case"d":case"D":case"DDD":return e+"";case"M":return e+"";case"w":case"W":return e+"";default:return e}},relativeTime:{future:"%s",past:"%s",s:"",ss:"%d ",m:"1 ",mm:"%d ",h:"1 ",hh:"%d ",d:"1 ",dd:"%d ",M:"1 ",MM:"%d ",y:"1 ",yy:"%d "},week:{dow:1,doy:4}}),l.defineLocale("zh-hk",{months:"___________".split("_"),monthsShort:"1_2_3_4_5_6_7_8_9_10_11_12".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"YYYY/MM/DD",LL:"YYYYMD",LLL:"YYYYMD HH:mm",LLLL:"YYYYMDdddd HH:mm",l:"YYYY/M/D",ll:"YYYYMD",lll:"YYYYMD HH:mm",llll:"YYYYMDdddd HH:mm"},meridiemParse:/\u51cc\u6668|\u65e9\u4e0a|\u4e0a\u5348|\u4e2d\u5348|\u4e0b\u5348|\u665a\u4e0a/,meridiemHour:function(e,a){return 12===e&&(e=0),""===a||""===a||""===a?e:""===a?11<=e?e:e+12:""===a||""===a?e+12:void 0},meridiem:function(e,a,t){var s=100*e+a;return s<600?"":s<900?"":s<1130?"":s<1230?"":s<1800?"":""},calendar:{sameDay:"[]LT",nextDay:"[]LT",nextWeek:"[]ddddLT",lastDay:"[]LT",lastWeek:"[]ddddLT",sameElse:"L"},dayOfMonthOrdinalParse:/\d{1,2}(\u65e5|\u6708|\u9031)/,ordinal:function(e,a){switch(a){case"d":case"D":case"DDD":return e+"";case"M":return e+"";case"w":case"W":return e+"";default:return e}},relativeTime:{future:"%s",past:"%s",s:"",ss:"%d ",m:"1 ",mm:"%d ",h:"1 ",hh:"%d ",d:"1 ",dd:"%d ",M:"1 ",MM:"%d ",y:"1 ",yy:"%d "}}),l.defineLocale("zh-tw",{months:"___________".split("_"),monthsShort:"1_2_3_4_5_6_7_8_9_10_11_12".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"YYYY/MM/DD",LL:"YYYYMD",LLL:"YYYYMD HH:mm",LLLL:"YYYYMDdddd HH:mm",l:"YYYY/M/D",ll:"YYYYMD",lll:"YYYYMD HH:mm",llll:"YYYYMDdddd HH:mm"},meridiemParse:/\u51cc\u6668|\u65e9\u4e0a|\u4e0a\u5348|\u4e2d\u5348|\u4e0b\u5348|\u665a\u4e0a/,meridiemHour:function(e,a){return 12===e&&(e=0),""===a||""===a||""===a?e:""===a?11<=e?e:e+12:""===a||""===a?e+12:void 0},meridiem:function(e,a,t){var s=100*e+a;return s<600?"":s<900?"":s<1130?"":s<1230?"":s<1800?"":""},calendar:{sameDay:"[] LT",nextDay:"[] LT",nextWeek:"[]dddd LT",lastDay:"[] LT",lastWeek:"[]dddd LT",sameElse:"L"},dayOfMonthOrdinalParse:/\d{1,2}(\u65e5|\u6708|\u9031)/,ordinal:function(e,a){switch(a){case"d":case"D":case"DDD":return e+"";case"M":return e+"";case"w":case"W":return e+"";default:return e}},relativeTime:{future:"%s",past:"%s",s:"",ss:"%d ",m:"1 ",mm:"%d ",h:"1 ",hh:"%d ",d:"1 ",dd:"%d ",M:"1 ",MM:"%d ",y:"1 ",yy:"%d "}}),l.locale("en"),l}),function(a){function i(a,b){return a-b}function k(){for(var a=0,b=this.length;a<b;a++)if(void 0!==this[a])return this[a]}function l(){for(var a=this.length;--a;)if(void 0!==this[a])return this[a]}var b,c,d="0.4.2",e="hasOwnProperty",f=/[\.\/]/,g=/\s*,\s*/,j={n:{}},m=function(a,d){a=String(a);var e,f=c,g=Array.prototype.slice.call(arguments,2),h=m.listeners(a),j=0,n=[],o={},p=[],q=b;p.firstDefined=k,p.lastDefined=l,b=a;for(var r=c=0,s=h.length;r<s;r++)"zIndex"in h[r]&&(n.push(h[r].zIndex),h[r].zIndex<0&&(o[h[r].zIndex]=h[r]));for(n.sort(i);n[j]<0;)if(e=o[n[j++]],p.push(e.apply(d,g)),c)return c=f,p;for(r=0;r<s;r++)if("zIndex"in(e=h[r]))if(e.zIndex==n[j]){if(p.push(e.apply(d,g)),c)break;do{if((e=o[n[++j]])&&p.push(e.apply(d,g)),c)break}while(e)}else o[e.zIndex]=e;else if(p.push(e.apply(d,g)),c)break;return c=f,b=q,p};m._events=j,m.listeners=function(a){var b,c,d,e,g,i,k,l,m=a.split(f),n=j,o=[n],p=[];for(e=0,g=m.length;e<g;e++){for(l=[],i=0,k=o.length;i<k;i++)for(c=[(n=o[i].n)[m[e]],n["*"]],d=2;d--;)(b=c[d])&&(l.push(b),p=p.concat(b.f||[]));o=l}return p},m.on=function(a,b){if(a=String(a),"function"!=typeof b)return function(){};for(var c=a.split(g),d=0,e=c.length;d<e;d++)!function(a){for(var c,d=a.split(f),e=j,g=0,h=d.length;g<h;g++)e=(e=e.n).hasOwnProperty(d[g])&&e[d[g]]||(e[d[g]]={n:{}});for(e.f=e.f||[],g=0,h=e.f.length;g<h;g++)if(e.f[g]==b){c=!0;break}c||e.f.push(b)}(c[d]);return function(a){+a==+a&&(b.zIndex=+a)}},m.f=function(a){var b=[].slice.call(arguments,1);return function(){m.apply(null,[a,null].concat(b).concat([].slice.call(arguments,0)))}},m.stop=function(){c=1},m.nt=function(a){return a?new RegExp("(?:\\.|\\/|^)"+a+"(?:\\.|\\/|$)").test(b):b},m.nts=function(){return b.split(f)},m.off=m.unbind=function(a,b){if(a){var c=a.split(g);if(1<c.length)for(var d=0,i=c.length;d<i;d++)m.off(c[d],b);else{c=a.split(f);var k,l,n,o,p,q=[j];for(d=0,i=c.length;d<i;d++)for(o=0;o<q.length;o+=n.length-2){if(n=[o,1],k=q[o].n,"*"!=c[d])k[c[d]]&&n.push(k[c[d]]);else for(l in k)k[e](l)&&n.push(k[l]);q.splice.apply(q,n)}for(d=0,i=q.length;d<i;d++)for(k=q[d];k.n;){if(b){if(k.f){for(o=0,p=k.f.length;o<p;o++)if(k.f[o]==b){k.f.splice(o,1);break}k.f.length||delete k.f}for(l in k.n)if(k.n[e](l)&&k.n[l].f){var r=k.n[l].f;for(o=0,p=r.length;o<p;o++)if(r[o]==b){r.splice(o,1);break}r.length||delete k.n[l].f}}else for(l in delete k.f,k.n)k.n[e](l)&&k.n[l].f&&delete k.n[l].f;k=k.n}}}else m._events=j={n:{}}},m.once=function(a,b){var c=function(){return m.unbind(a,c),b.apply(this,arguments)};return m.on(a,c)},m.version=d,m.toString=function(){return"You are running Eve "+d},"undefined"!=typeof module&&module.exports?module.exports=m:"function"==typeof define&&define.amd?define("eve",[],function(){return m}):a.eve=m}(this),function(a,b){if("function"==typeof define&&define.amd)define(["eve"],function(c){return b(a,c)});else if("undefined"!=typeof exports){var c=require("eve");module.exports=b(a,c)}else b(a,a.eve)}(window||this,function(a,b){var c=function(b){function h(){return g+(f++).toString(36)}function j(a){var b=this;if(null==a)return b.s;var c=b.s-a;b.b+=b.dur*c,b.B+=b.dur*c,b.s=a}function k(a){return null==a?this.spd:void(this.spd=a)}function l(a){var b=this;return null==a?b.dur:(b.s=b.s*a/b.dur,void(b.dur=a))}function m(){var a=this;delete c[a.id],a.update(),b("mina.stop."+a.id,a)}function n(){var a=this;a.pdif||(delete c[a.id],a.update(),a.pdif=a.get()-a.b)}function o(){var a=this;a.pdif&&(a.b=a.get()-a.pdif,delete a.pdif,c[a.id]=a)}function p(){var a,b=this;if(e(b.start)){a=[];for(var c=0,d=b.start.length;c<d;c++)a[c]=+b.start[c]+(b.end[c]-b.start[c])*b.easing(b.s)}else a=+b.start+(b.end-b.start)*b.easing(b.s);b.set(a)}var c={},d=a.requestAnimationFrame||a.webkitRequestAnimationFrame||a.mozRequestAnimationFrame||a.oRequestAnimationFrame||a.msRequestAnimationFrame||function(a){setTimeout(a,16)},e=Array.isArray||function(a){return a instanceof Array||"[object Array]"==Object.prototype.toString.call(a)},f=0,g="M"+(+new Date).toString(36),i=Date.now||function(){return+new Date},q=function(){var a=0;for(var e in c)if(c.hasOwnProperty(e)){var f=c[e],g=f.get();a++,f.s=(g-f.b)/(f.dur/f.spd),1<=f.s&&(delete c[e],f.s=1,a--,function(a){setTimeout(function(){b("mina.finish."+a.id,a)})}(f)),f.update()}a&&d(q)},r=function(a,b,e,f,g,i,s){var t={id:h(),start:a,end:b,b:e,s:0,dur:f-e,spd:1,get:g,set:i,easing:s||r.linear,status:j,speed:k,duration:l,stop:m,pause:n,resume:o,update:p};c[t.id]=t;var u,v=0;for(u in c)if(c.hasOwnProperty(u)&&2==++v)break;return 1==v&&d(q),t};return r.time=i,r.getById=function(a){return c[a]||null},r.linear=function(a){return a},r.easeout=function(a){return Math.pow(a,1.7)},r.easein=function(a){return Math.pow(a,.48)},r.easeinout=function(a){if(1==a)return 1;if(0==a)return 0;var b=.48-a/1.04,c=Math.sqrt(.1734+b*b),d=c-b,f=-c-b,h=Math.pow(Math.abs(d),1/3)*(d<0?-1:1)+Math.pow(Math.abs(f),1/3)*(f<0?-1:1)+.5;return 3*(1-h)*h*h+h*h*h},r.backin=function(a){if(1==a)return 1;var b=1.70158;return a*a*((1+b)*a-b)},r.backout=function(a){if(0==a)return 0;var b=1.70158;return(a-=1)*a*((1+b)*a+b)+1},r.elastic=function(a){return a==!!a?a:Math.pow(2,-10*a)*Math.sin(2*(a-.075)*Math.PI/.3)+1},r.bounce=function(a){var c=7.5625,d=2.75;return a<1/d?c*a*a:a<2/d?c*(a-=1.5/d)*a+.75:a<2.5/d?c*(a-=2.25/d)*a+.9375:c*(a-=2.625/d)*a+.984375},a.mina=r}(void 0===b?function(){}:b),d=function(a){function c(a,b){if(a){if(a.nodeType)return w(a);if(e(a,"array")&&c.set)return c.set.apply(c,a);if(a instanceof s)return a;if(null==b)return w(a=y.doc.querySelector(String(a)))}return new v(a=null==a?"100%":a,b=null==b?"100%":b)}function d(a,b){if(b){if("#text"==a&&(a=y.doc.createTextNode(b.text||b["#text"]||"")),"#comment"==a&&(a=y.doc.createComment(b.text||b["#text"]||"")),"string"==typeof a&&(a=d(a)),"string"==typeof b)return 1==a.nodeType?"xlink:"==b.substring(0,6)?a.getAttributeNS(T,b.substring(6)):"xml:"==b.substring(0,4)?a.getAttributeNS(U,b.substring(4)):a.getAttribute(b):"text"==b?a.nodeValue:null;if(1==a.nodeType){for(var c in b)if(b[z](c)){var e=A(b[c]);e?"xlink:"==c.substring(0,6)?a.setAttributeNS(T,c.substring(6),e):"xml:"==c.substring(0,4)?a.setAttributeNS(U,c.substring(4),e):a.setAttribute(c,e):a.removeAttribute(c)}}else"text"in b&&(a.nodeValue=b.text)}else a=y.doc.createElementNS(U,a);return a}function e(a,b){return"finite"==(b=A.prototype.toLowerCase.call(b))?isFinite(a):!("array"!=b||!(a instanceof Array||Array.isArray&&Array.isArray(a)))||("null"==b&&null===a||b==typeof a&&null!==a||"object"==b&&a===Object(a)||J.call(a).slice(8,-1).toLowerCase()==b)}function i(a,b,c){return function d(){var e=Array.prototype.slice.call(arguments,0),f=e.join(""),g=d.cache=d.cache||{},i=d.count=d.count||[];return g[z](f)?function(a,b){for(var c=0,d=a.length;c<d;c++)if(a[c]===b)return a.push(a.splice(c,1)[0])}(i,f):(1e3<=i.length&&delete g[i.shift()],i.push(f),g[f]=a.apply(b,e)),c?c(g[f]):g[f]}}function k(a){return a%360*H/180}function p(a){return a.node.ownerSVGElement&&w(a.node.ownerSVGElement)||c.select("svg")}function r(a){e(a,"array")||(a=Array.prototype.slice.call(arguments,0));for(var b=0,c=0,d=this.node;this[b];)delete this[b++];for(b=0;b<a.length;b++)"set"==a[b].type?a[b].forEach(function(a){d.appendChild(a.node)}):d.appendChild(a[b].node);var f=d.childNodes;for(b=0;b<f.length;b++)this[c++]=w(f[b]);return this}function s(a){if(a.snap in V)return V[a.snap];var b;try{b=a.ownerSVGElement}catch(c){}this.node=a,b&&(this.paper=new v(b)),this.type=a.tagName||a.nodeName;var d=this.id=S(this);if(this.anims={},this._={transform:[]},a.snap=d,"g"==(V[d]=this).type&&(this.add=r),this.type in{g:1,mask:1,pattern:1,symbol:1})for(var e in v.prototype)v.prototype[z](e)&&(this[e]=v.prototype[e])}function t(a){this.node=a}function u(a,b){var c=d(a);return b.appendChild(c),w(c)}function v(a,b){var c,e,f,g=v.prototype;if(a&&"svg"==a.tagName){if(a.snap in V)return V[a.snap];var h=a.ownerDocument;for(var i in c=new s(a),e=a.getElementsByTagName("desc")[0],f=a.getElementsByTagName("defs")[0],e||((e=d("desc")).appendChild(h.createTextNode("Created with Snap")),c.node.appendChild(e)),f||(f=d("defs"),c.node.appendChild(f)),c.defs=f,g)g[z](i)&&(c[i]=g[i]);c.paper=c.root=c}else d((c=u("svg",y.doc.body)).node,{height:b,version:1.1,width:a,xmlns:U});return c}function w(a){return a?a instanceof s||a instanceof t?a:a.tagName&&"svg"==a.tagName.toLowerCase()?new v(a):a.tagName&&"object"==a.tagName.toLowerCase()&&"image/svg+xml"==a.type?new v(a.contentDocument.getElementsByTagName("svg")[0]):new s(a):a}c.version="0.4.0",c.toString=function(){return"Snap v"+this.version},c._={};var y={win:a.window,doc:a.window.document};c._.glob=y;var z="hasOwnProperty",A=String,B=parseFloat,C=parseInt,D=Math,E=D.max,F=D.min,G=D.abs,H=(D.pow,D.PI),I=(D.round,""),J=Object.prototype.toString,K=/^\s*((#[a-f\d]{6})|(#[a-f\d]{3})|rgba?\(\s*([\d\.]+%?\s*,\s*[\d\.]+%?\s*,\s*[\d\.]+%?(?:\s*,\s*[\d\.]+%?)?)\s*\)|hsba?\(\s*([\d\.]+(?:deg|\xb0|%)?\s*,\s*[\d\.]+%?\s*,\s*[\d\.]+(?:%?\s*,\s*[\d\.]+)?%?)\s*\)|hsla?\(\s*([\d\.]+(?:deg|\xb0|%)?\s*,\s*[\d\.]+%?\s*,\s*[\d\.]+(?:%?\s*,\s*[\d\.]+)?%?)\s*\))\s*$/i,L=(c._.separator=/[,\s]+/,/[\s]*,[\s]*/),M={hs:1,rg:1},N=/([a-z])[\s,]*((-?\d*\.?\d*(?:e[\-+]?\d+)?[\s]*,?[\s]*)+)/gi,O=/([rstm])[\s,]*((-?\d*\.?\d*(?:e[\-+]?\d+)?[\s]*,?[\s]*)+)/gi,P=/(-?\d*\.?\d*(?:e[\-+]?\\d+)?)[\s]*,?[\s]*/gi,Q=0,R="S"+(+new Date).toString(36),S=function(a){return(a&&a.type?a.type:I)+R+(Q++).toString(36)},T="http://www.w3.org/1999/xlink",U="http://www.w3.org/2000/svg",V={};c.url=function(a){return"url('#"+a+"')"},c._.$=d,c._.id=S,c.format=function(){var a=/\{([^\}]+)\}/g,b=/(?:(?:^|\.)(.+?)(?=\[|\.|$|\()|\[('|")(.+?)\2\])(\(\))?/g,c=function(a,c,d){var e=d;return c.replace(b,function(a,b,c,d,f){b=b||d,e&&(b in e&&(e=e[b]),"function"==typeof e&&f&&(e=e()))}),e=(null==e||e==d?a:e)+""};return function(b,d){return A(b).replace(a,function(a,b){return c(a,b,d)})}}(),c._.clone=function f(a){if("function"==typeof a||Object(a)!==a)return a;var b=new a.constructor;for(var c in a)a[z](c)&&(b[c]=f(a[c]));return b},c._.cacher=i,c.rad=k,c.deg=function(a){return 180*a/H%360},c.sin=function(a){return D.sin(c.rad(a))},c.tan=function(a){return D.tan(c.rad(a))},c.cos=function(a){return D.cos(c.rad(a))},c.asin=function(a){return c.deg(D.asin(a))},c.acos=function(a){return c.deg(D.acos(a))},c.atan=function(a){return c.deg(D.atan(a))},c.atan2=function(a){return c.deg(D.atan2(a))},c.angle=function j(a,b,c,d,e,f){if(null!=e)return j(a,b,e,f)-j(c,d,e,f);var g=a-c,h=b-d;return g||h?(180+180*D.atan2(-h,-g)/H+360)%360:0},c.len=function(a,b,d,e){return Math.sqrt(c.len2(a,b,d,e))},c.len2=function(a,b,c,d){return(a-c)*(a-c)+(b-d)*(b-d)},c.closestPoint=function(a,b,c){function d(a){var d=a.x-b,e=a.y-c;return d*d+e*e}for(var e,f,g,h,i=a.node,j=i.getTotalLength(),k=j/i.pathSegList.numberOfItems*.125,l=1/0,m=0;m<=j;m+=k)(h=d(g=i.getPointAtLength(m)))<l&&(e=g,f=m,l=h);for(k*=.5;.5<k;){var n,o,p,q,r,s;0<=(p=f-k)&&(r=d(n=i.getPointAtLength(p)))<l?(e=n,f=p,l=r):(q=f+k)<=j&&(s=d(o=i.getPointAtLength(q)))<l?(e=o,f=q,l=s):k*=.5}return{x:e.x,y:e.y,length:f,distance:Math.sqrt(l)}},c.is=e,c.snapTo=function(a,b,c){if(c=e(c,"finite")?c:10,e(a,"array")){for(var d=a.length;d--;)if(G(a[d]-b)<=c)return a[d]}else{var f=b%(a=+a);if(f<c)return b-f;if(a-c<f)return b-f+a}return b},c.getRGB=i(function(a){if(!a||(a=A(a)).indexOf("-")+1)return{r:-1,g:-1,b:-1,hex:"none",error:1,toString:Z};if("none"==a)return{r:-1,g:-1,b:-1,hex:"none",toString:Z};if(M[z](a.toLowerCase().substring(0,2))||"#"==a.charAt()||(a=W(a)),!a)return{r:-1,g:-1,b:-1,hex:"none",error:1,toString:Z};var b,d,f,g,h,i,j=a.match(K);return j?(j[2]&&(f=C(j[2].substring(5),16),d=C(j[2].substring(3,5),16),b=C(j[2].substring(1,3),16)),j[3]&&(f=C((h=j[3].charAt(3))+h,16),d=C((h=j[3].charAt(2))+h,16),b=C((h=j[3].charAt(1))+h,16)),j[4]&&(i=j[4].split(L),b=B(i[0]),"%"==i[0].slice(-1)&&(b*=2.55),d=B(i[1]),"%"==i[1].slice(-1)&&(d*=2.55),f=B(i[2]),"%"==i[2].slice(-1)&&(f*=2.55),"rgba"==j[1].toLowerCase().slice(0,4)&&(g=B(i[3])),i[3]&&"%"==i[3].slice(-1)&&(g/=100)),j[5]?(i=j[5].split(L),b=B(i[0]),"%"==i[0].slice(-1)&&(b/=100),d=B(i[1]),"%"==i[1].slice(-1)&&(d/=100),f=B(i[2]),"%"==i[2].slice(-1)&&(f/=100),"deg"!=i[0].slice(-3)&&""!=i[0].slice(-1)||(b/=360),"hsba"==j[1].toLowerCase().slice(0,4)&&(g=B(i[3])),i[3]&&"%"==i[3].slice(-1)&&(g/=100),c.hsb2rgb(b,d,f,g)):j[6]?(i=j[6].split(L),b=B(i[0]),"%"==i[0].slice(-1)&&(b/=100),d=B(i[1]),"%"==i[1].slice(-1)&&(d/=100),f=B(i[2]),"%"==i[2].slice(-1)&&(f/=100),"deg"!=i[0].slice(-3)&&""!=i[0].slice(-1)||(b/=360),"hsla"==j[1].toLowerCase().slice(0,4)&&(g=B(i[3])),i[3]&&"%"==i[3].slice(-1)&&(g/=100),c.hsl2rgb(b,d,f,g)):(b=F(D.round(b),255),d=F(D.round(d),255),f=F(D.round(f),255),g=F(E(g,0),1),(j={r:b,g:d,b:f,toString:Z}).hex="#"+(16777216|f|d<<8|b<<16).toString(16).slice(1),j.opacity=e(g,"finite")?g:1,j)):{r:-1,g:-1,b:-1,hex:"none",error:1,toString:Z}},c),c.hsb=i(function(a,b,d){return c.hsb2rgb(a,b,d).hex}),c.hsl=i(function(a,b,d){return c.hsl2rgb(a,b,d).hex}),c.rgb=i(function(a,b,c,d){if(e(d,"finite")){var f=D.round;return"rgba("+[f(a),f(b),f(c),+d.toFixed(2)]+")"}return"#"+(16777216|c|b<<8|a<<16).toString(16).slice(1)});function X(){return"hsb("+[this.h,this.s,this.b]+")"}function Y(){return"hsl("+[this.h,this.s,this.l]+")"}function $(a,b,d){if(null==b&&e(a,"object")&&"r"in a&&"g"in a&&"b"in a&&(d=a.b,b=a.g,a=a.r),null==b&&e(a,string)){var f=c.getRGB(a);a=f.r,b=f.g,d=f.b}return(1<a||1<b||1<d)&&(a/=255,b/=255,d/=255),[a,b,d]}function _(a,b,d,f){var g={r:a=D.round(255*a),g:b=D.round(255*b),b:d=D.round(255*d),opacity:e(f,"finite")?f:1,hex:c.rgb(a,b,d),toString:Z};return e(f,"finite")&&(g.opacity=f),g}var W=function(a){var b=y.doc.getElementsByTagName("head")[0]||y.doc.getElementsByTagName("svg")[0],c="rgb(255, 0, 0)";return(W=i(function(a){if("red"==a.toLowerCase())return c;b.style.color=c,b.style.color=a;var d=y.doc.defaultView.getComputedStyle(b,I).getPropertyValue("color");return d==c?null:d}))(a)},Z=function(){return 1==this.opacity||null==this.opacity?this.hex:"rgba("+[this.r,this.g,this.b,this.opacity]+")"};c.color=function(a){var b;return e(a,"object")&&"h"in a&&"s"in a&&"b"in a?(b=c.hsb2rgb(a),a.r=b.r,a.g=b.g,a.b=b.b,a.opacity=1,a.hex=b.hex):e(a,"object")&&"h"in a&&"s"in a&&"l"in a?(b=c.hsl2rgb(a),a.r=b.r,a.g=b.g,a.b=b.b,a.opacity=1,a.hex=b.hex):(e(a,"string")&&(a=c.getRGB(a)),e(a,"object")&&"r"in a&&"g"in a&&"b"in a&&!("error"in a)?(b=c.rgb2hsl(a),a.h=b.h,a.s=b.s,a.l=b.l,b=c.rgb2hsb(a),a.v=b.b):((a={hex:"none"}).r=a.g=a.b=a.h=a.s=a.v=a.l=-1,a.error=1)),a.toString=Z,a},c.hsb2rgb=function(a,b,c,d){var f,g,h,i,j;return e(a,"object")&&"h"in a&&"s"in a&&"b"in a&&(c=a.b,b=a.s,d=a.o,a=a.h),i=(j=c*b)*(1-G((a=(a*=360)%360/60)%2-1)),f=g=h=c-j,_(f+=[j,i,0,0,i,j][a=~~a],g+=[i,j,j,i,0,0][a],h+=[0,0,i,j,j,i][a],d)},c.hsl2rgb=function(a,b,c,d){var f,g,h,i,j;return e(a,"object")&&"h"in a&&"s"in a&&"l"in a&&(c=a.l,b=a.s,a=a.h),(1<a||1<b||1<c)&&(a/=360,b/=100,c/=100),i=(j=2*b*(c<.5?c:1-c))*(1-G((a=(a*=360)%360/60)%2-1)),f=g=h=c-j/2,_(f+=[j,i,0,0,i,j][a=~~a],g+=[i,j,j,i,0,0][a],h+=[0,0,i,j,j,i][a],d)},c.rgb2hsb=function(a,b,c){var f,g;return a=(c=$(a,b,c))[0],b=c[1],c=c[2],{h:((0==(g=(f=E(a,b,c))-F(a,b,c))?null:f==a?(b-c)/g:f==b?(c-a)/g+2:(a-b)/g+4)+360)%6*60/360,s:0==g?0:g/f,b:f,toString:X}},c.rgb2hsl=function(a,b,c){var f,g,h,i;return a=(c=$(a,b,c))[0],b=c[1],c=c[2],f=((g=E(a,b,c))+(h=F(a,b,c)))/2,{h:((0==(i=g-h)?null:g==a?(b-c)/i:g==b?(c-a)/i+2:(a-b)/i+4)+360)%6*60/360,s:0==i?0:f<.5?i/(2*f):i/(2-2*f),l:f,toString:Y}},c.parsePathString=function(a){if(!a)return null;var b=c.path(a);if(b.arr)return c.path.clone(b.arr);var d={a:7,c:6,o:2,h:1,l:2,m:2,r:4,q:4,s:4,t:2,v:1,u:3,z:0},f=[];return e(a,"array")&&e(a[0],"array")&&(f=c.path.clone(a)),f.length||A(a).replace(N,function(a,b,c){var e=[],g=b.toLowerCase();if(c.replace(P,function(a,b){b&&e.push(+b)}),"m"==g&&2<e.length&&(f.push([b].concat(e.splice(0,2))),g="l",b="m"==b?"l":"L"),"o"==g&&1==e.length&&f.push([b,e[0]]),"r"==g)f.push([b].concat(e));else for(;e.length>=d[g]&&(f.push([b].concat(e.splice(0,d[g]))),d[g]););}),f.toString=c.path.toString,b.arr=c.path.clone(f),f};var ab=c.parseTransformString=function(a){if(!a)return null;var b=[];return e(a,"array")&&e(a[0],"array")&&(b=c.path.clone(a)),b.length||A(a).replace(O,function(a,c,d){var e=[];c.toLowerCase(),d.replace(P,function(a,b){b&&e.push(+b)}),b.push([c].concat(e))}),b.toString=c.path.toString,b};c._.svgTransform2string=function(a){var b=[];return a=a.replace(/(?:^|\s)(\w+)\(([^)]+)\)/g,function(a,c,d){return d=d.split(/\s*,\s*|\s+/),"rotate"==c&&1==d.length&&d.push(0,0),"scale"==c&&(2<d.length?d=d.slice(0,2):2==d.length&&d.push(0,0),1==d.length&&d.push(d[0],0,0)),b.push("skewX"==c?["m",1,0,D.tan(k(d[0])),1,0,0]:"skewY"==c?["m",1,D.tan(k(d[0])),0,1,0,0]:[c.charAt(0)].concat(d)),a}),b},c._.rgTransform=/^[a-z][\s]*-?\.?\d/i,c._.transform2matrix=function(a,b){var d=ab(a),e=new c.Matrix;if(d)for(var f=0,g=d.length;f<g;f++){var h,i,j,k,l,m=d[f],n=m.length,o=A(m[0]).toLowerCase(),p=m[0]!=o,q=p?e.invert():0;"t"==o&&2==n?e.translate(m[1],0):"t"==o&&3==n?p?(h=q.x(0,0),i=q.y(0,0),j=q.x(m[1],m[2]),k=q.y(m[1],m[2]),e.translate(j-h,k-i)):e.translate(m[1],m[2]):"r"==o?2==n?(l=l||b,e.rotate(m[1],l.x+l.width/2,l.y+l.height/2)):4==n&&(p?(j=q.x(m[2],m[3]),k=q.y(m[2],m[3]),e.rotate(m[1],j,k)):e.rotate(m[1],m[2],m[3])):"s"==o?2==n||3==n?(l=l||b,e.scale(m[1],m[n-1],l.x+l.width/2,l.y+l.height/2)):4==n?p?(j=q.x(m[2],m[3]),k=q.y(m[2],m[3]),e.scale(m[1],m[1],j,k)):e.scale(m[1],m[1],m[2],m[3]):5==n&&(p?(j=q.x(m[3],m[4]),k=q.y(m[3],m[4]),e.scale(m[1],m[2],j,k)):e.scale(m[1],m[2],m[3],m[4])):"m"==o&&7==n&&e.add(m[1],m[2],m[3],m[4],m[5],m[6])}return e},c._unit2px=function(a,b,c){function e(a){if(null==a)return I;if(a==+a)return a;d(j,{width:a});try{return j.getBBox().width}catch(b){return 0}}function f(a){if(null==a)return I;if(a==+a)return a;d(j,{height:a});try{return j.getBBox().height}catch(b){return 0}}function g(d,e){null==b?i[d]=e(a.attr(d)||0):d==b&&(i=e(null==c?a.attr(d)||0:c))}var h=p(a).node,i={},j=h.querySelector(".svg---mgr");switch(j||(j=d("rect"),d(j,{x:-9e9,y:-9e9,width:10,height:10,class:"svg---mgr",fill:"none"}),h.appendChild(j)),a.type){case"rect":g("rx",e),g("ry",f);case"image":g("width",e),g("height",f);case"text":g("x",e),g("y",f);break;case"circle":g("cx",e),g("cy",f),g("r",e);break;case"ellipse":g("cx",e),g("cy",f),g("rx",e),g("ry",f);break;case"line":g("x1",e),g("x2",e),g("y1",f),g("y2",f);break;case"marker":g("refX",e),g("markerWidth",e),g("refY",f),g("markerHeight",f);break;case"radialGradient":g("fx",e),g("fy",f);break;case"tspan":g("dx",e),g("dy",f);break;default:g(b,e)}return h.removeChild(j),i},y.doc.contains||y.doc.compareDocumentPosition,c._.getSomeDefs=function(a){var b=a.node.ownerSVGElement&&w(a.node.ownerSVGElement)||a.node.parentNode&&w(a.node.parentNode)||c.select("svg")||c(0,0),d=b.select("defs"),e=null!=d&&d.node;return e=e||u("defs",b.node).node},c._.getSomeSVG=p,c.select=function(a){return a=A(a).replace(/([^\\]):/g,"$1\\:"),w(y.doc.querySelector(a))},c.selectAll=function(a){for(var b=y.doc.querySelectorAll(a),d=(c.set||Array)(),e=0;e<b.length;e++)d.push(w(b[e]));return d},setInterval(function(){for(var a in V)if(V[z](a)){var b=V[a],c=b.node;("svg"!=b.type&&!c.ownerSVGElement||"svg"==b.type&&(!c.parentNode||"ownerSVGElement"in c.parentNode&&!c.ownerSVGElement))&&delete V[a]}},1e4),s.prototype.attr=function(a,c){var d=this,f=d.node;if(!a){if(1!=f.nodeType)return{text:f.nodeValue};for(var g=f.attributes,h={},i=0,j=g.length;i<j;i++)h[g[i].nodeName]=g[i].nodeValue;return h}if(e(a,"string")){if(!(1<arguments.length))return b("snap.util.getattr."+a,d).firstDefined();var k={};k[a]=c,a=k}for(var l in a)a[z](l)&&b("snap.util.attr."+l,d,a[l]);return d},c.parse=function(a){var b=y.doc.createDocumentFragment(),c=!0,d=y.doc.createElement("div");if((a=A(a)).match(/^\s*<\s*svg(?:\s|>)/)||(a="<svg>"+a+"</svg>",c=!1),d.innerHTML=a,a=d.getElementsByTagName("svg")[0])if(c)b=a;else for(;a.firstChild;)b.appendChild(a.firstChild);return new t(b)},c.fragment=function(){for(var a=Array.prototype.slice.call(arguments,0),b=y.doc.createDocumentFragment(),d=0,e=a.length;d<e;d++){var f=a[d];f.node&&f.node.nodeType&&b.appendChild(f.node),f.nodeType&&b.appendChild(f),"string"==typeof f&&b.appendChild(c.parse(f).node)}return new t(b)},c._.make=u,c._.wrap=w,v.prototype.el=function(a,b){var c=u(a,this.node);return b&&c.attr(b),c},s.prototype.children=function(){for(var a=[],b=this.node.childNodes,d=0,e=b.length;d<e;d++)a[d]=c(b[d]);return a},s.prototype.toJSON=function(){var a=[];return function x(a,b){for(var c=0,d=a.length;c<d;c++){var e={type:a[c].type,attr:a[c].attr()},f=a[c].children();b.push(e),f.length&&x(f,e.childNodes=[])}}([this],a),a[0]},b.on("snap.util.getattr",function(){var a=b.nt(),c=(a=a.substring(a.lastIndexOf(".")+1)).replace(/[A-Z]/g,function(a){return"-"+a.toLowerCase()});return bb[z](c)?this.node.ownerDocument.defaultView.getComputedStyle(this.node,null).getPropertyValue(c):d(this.node,a)});var bb={"alignment-baseline":0,"baseline-shift":0,clip:0,"clip-path":0,"clip-rule":0,color:0,"color-interpolation":0,"color-interpolation-filters":0,"color-profile":0,"color-rendering":0,cursor:0,direction:0,display:0,"dominant-baseline":0,"enable-background":0,fill:0,"fill-opacity":0,"fill-rule":0,filter:0,"flood-color":0,"flood-opacity":0,font:0,"font-family":0,"font-size":0,"font-size-adjust":0,"font-stretch":0,"font-style":0,"font-variant":0,"font-weight":0,"glyph-orientation-horizontal":0,"glyph-orientation-vertical":0,"image-rendering":0,kerning:0,"letter-spacing":0,"lighting-color":0,marker:0,"marker-end":0,"marker-mid":0,"marker-start":0,mask:0,opacity:0,overflow:0,"pointer-events":0,"shape-rendering":0,"stop-color":0,"stop-opacity":0,stroke:0,"stroke-dasharray":0,"stroke-dashoffset":0,"stroke-linecap":0,"stroke-linejoin":0,"stroke-miterlimit":0,"stroke-opacity":0,"stroke-width":0,"text-anchor":0,"text-decoration":0,"text-rendering":0,"unicode-bidi":0,visibility:0,"word-spacing":0,"writing-mode":0};b.on("snap.util.attr",function(a){var c=b.nt(),e={};e[c=c.substring(c.lastIndexOf(".")+1)]=a;var f=c.replace(/-(\w)/gi,function(a,b){return b.toUpperCase()}),g=c.replace(/[A-Z]/g,function(a){return"-"+a.toLowerCase()});bb[z](g)?this.node.style[f]=null==a?I:a:d(this.node,e)}),c.ajax=function(a,c,d,f){var g=new XMLHttpRequest,h=S();if(g){if(e(c,"function"))f=d,d=c,c=null;else if(e(c,"object")){var i=[];for(var j in c)c.hasOwnProperty(j)&&i.push(encodeURIComponent(j)+"="+encodeURIComponent(c[j]));c=i.join("&")}return g.open(c?"POST":"GET",a,!0),c&&(g.setRequestHeader("X-Requested-With","XMLHttpRequest"),g.setRequestHeader("Content-type","application/x-www-form-urlencoded")),d&&(b.once("snap.ajax."+h+".0",d),b.once("snap.ajax."+h+".200",d),b.once("snap.ajax."+h+".304",d)),g.onreadystatechange=function(){4==g.readyState&&b("snap.ajax."+h+"."+g.status,f,g)},4==g.readyState||g.send(c),g}},c.load=function(a,b,d){c.ajax(a,function(a){var e=c.parse(a.responseText);d?b.call(d,e):b(e)})};function cb(a){var b=a.getBoundingClientRect(),c=a.ownerDocument,d=c.body,e=c.documentElement,f=e.clientTop||d.clientTop||0,h=e.clientLeft||d.clientLeft||0;return{y:b.top+(g.win.pageYOffset||e.scrollTop||d.scrollTop)-f,x:b.left+(g.win.pageXOffset||e.scrollLeft||d.scrollLeft)-h}}return c.getElementByPoint=function(a,b){var d=(this.canvas,y.doc.elementFromPoint(a,b));if(y.win.opera&&"svg"==d.tagName){var e=cb(d),f=d.createSVGRect();f.x=a-e.x,f.y=b-e.y,f.width=f.height=1;var g=d.getIntersectionList(f,null);g.length&&(d=g[g.length-1])}return d?w(d):null},c.plugin=function(a){a(c,s,v,y,t)},y.win.Snap=c}(a||this);return d.plugin(function(d,e,f,g,h){function i(a,b){if(null==b){var c=!0;if(!(b=a.node.getAttribute("linearGradient"==a.type||"radialGradient"==a.type?"gradientTransform":"pattern"==a.type?"patternTransform":"transform")))return new d.Matrix;b=d._.svgTransform2string(b)}else b=d._.rgTransform.test(b)?o(b).replace(/\.{3}|\u2026/g,a._.transform||E):d._.svgTransform2string(b),n(b,"array")&&(b=d.path?d.path.toString.call(b):o(b)),a._.transform=b;var e=d._.transform2matrix(b,a.getBBox(1));return c?e:void(a.matrix=e)}function k(a,b,c){return function(d){var e=d.slice(a,b);return 1==e.length&&(e=e[0]),c?c(e):e}}function l(a){return function(){var b=a?"<"+this.type:"",c=this.node.attributes,d=this.node.childNodes;if(a)for(var e=0,f=c.length;e<f;e++)b+=" "+c[e].name+'="'+c[e].value.replace(/"/g,'\\"')+'"';if(d.length){for(a&&(b+=">"),e=0,f=d.length;e<f;e++)3==d[e].nodeType?b+=d[e].nodeValue:1==d[e].nodeType&&(b+=u(d[e]).toString());a&&(b+="</"+this.type+">")}else a&&(b+="/>");return b}}var m=e.prototype,n=d.is,o=String,p=d._unit2px,q=d._.$,r=d._.make,s=d._.getSomeDefs,t="hasOwnProperty",u=d._.wrap;m.getBBox=function(a){if(!d.Matrix||!d.path)return this.node.getBBox();var b=this,c=new d.Matrix;if(b.removed)return d._.box();for(;"use"==b.type;)if(a||(c=c.add(b.transform().localMatrix.translate(b.attr("x")||0,b.attr("y")||0))),b.original)b=b.original;else{var e=b.attr("xlink:href");b=b.original=b.node.ownerDocument.getElementById(e.substring(e.indexOf("#")+1))}var f=b._,g=d.path.get[b.type]||d.path.get.deflt;try{return a?(f.bboxwt=g?d.path.getBBox(b.realPath=g(b)):d._.box(b.node.getBBox()),d._.box(f.bboxwt)):(b.realPath=g(b),b.matrix=b.transform().localMatrix,f.bbox=d.path.getBBox(d.path.map(b.realPath,c.add(b.matrix))),d._.box(f.bbox))}catch(h){return d._.box()}};function v(){return this.string}m.transform=function(a){var b=this._;if(null!=a)return a instanceof d.Matrix?(this.matrix=a,this._.transform=a.toTransformString()):i(this,a),this.node&&("linearGradient"==this.type||"radialGradient"==this.type?q(this.node,{gradientTransform:this.matrix}):"pattern"==this.type?q(this.node,{patternTransform:this.matrix}):q(this.node,{transform:this.matrix})),this;for(var c,e=this,f=new d.Matrix(this.node.getCTM()),g=i(this),h=[g],j=new d.Matrix,k=g.toTransformString(),l=o(g)==o(this.matrix)?o(b.transform):k;"svg"!=e.type&&(e=e.parent());)h.push(i(e));for(c=h.length;c--;)j.add(h[c]);return{string:l,globalMatrix:f,totalMatrix:j,localMatrix:g,diffMatrix:f.clone().add(g.invert()),global:f.toTransformString(),total:j.toTransformString(),local:k,toString:v}},m.parent=function(){return u(this.node.parentNode)},m.append=m.add=function(a){if(a){if("set"==a.type){var b=this;return a.forEach(function(a){b.add(a)}),this}a=u(a),this.node.appendChild(a.node),a.paper=this.paper}return this},m.appendTo=function(a){return a&&(a=u(a)).append(this),this},m.prepend=function(a){if(a){if("set"==a.type){var b,c=this;return a.forEach(function(a){b?b.after(a):c.prepend(a),b=a}),this}var d=(a=u(a)).parent();this.node.insertBefore(a.node,this.node.firstChild),this.add&&this.add(),a.paper=this.paper,this.parent()&&this.parent().add(),d&&d.add()}return this},m.prependTo=function(a){return(a=u(a)).prepend(this),this},m.before=function(a){if("set"==a.type){var b=this;return a.forEach(function(a){var c=a.parent();b.node.parentNode.insertBefore(a.node,b.node),c&&c.add()}),this.parent().add(),this}var c=(a=u(a)).parent();return this.node.parentNode.insertBefore(a.node,this.node),this.parent()&&this.parent().add(),c&&c.add(),a.paper=this.paper,this},m.after=function(a){var b=(a=u(a)).parent();return this.node.nextSibling?this.node.parentNode.insertBefore(a.node,this.node.nextSibling):this.node.parentNode.appendChild(a.node),this.parent()&&this.parent().add(),b&&b.add(),a.paper=this.paper,this},m.insertBefore=function(a){a=u(a);var b=this.parent();return a.node.parentNode.insertBefore(this.node,a.node),this.paper=a.paper,b&&b.add(),a.parent()&&a.parent().add(),this},m.insertAfter=function(a){a=u(a);var b=this.parent();return a.node.parentNode.insertBefore(this.node,a.node.nextSibling),this.paper=a.paper,b&&b.add(),a.parent()&&a.parent().add(),this},m.remove=function(){var a=this.parent();return this.node.parentNode&&this.node.parentNode.removeChild(this.node),delete this.paper,this.removed=!0,a&&a.add(),this},m.select=function(a){return a=o(a).replace(/([^\\]):/g,"$1\\:"),u(this.node.querySelector(a))},m.selectAll=function(a){for(var b=this.node.querySelectorAll(a),c=(d.set||Array)(),e=0;e<b.length;e++)c.push(u(b[e]));return c},m.asPX=function(a,b){return null==b&&(b=this.attr(a)),+p(this,a,b)},m.use=function(){var a,b=this.node.id;return b||(b=this.id,q(this.node,{id:b})),a="linearGradient"==this.type||"radialGradient"==this.type||"pattern"==this.type?r(this.type,this.node.parentNode):r("use",this.node.parentNode),q(a.node,{"xlink:href":"#"+b}),a.original=this,a},m.clone=function(){var a=u(this.node.cloneNode(!0));return q(a.node,"id")&&q(a.node,{id:a.id}),function(a){function b(a,b){var c=q(a.node,b);!(c=(c=c&&c.match(f))&&c[2])||"#"!=c.charAt()||(c=c.substring(1))&&(h[c]=(h[c]||[]).concat(function(c){var d={};d[b]=URL(c),q(a.node,d)}))}function c(a){var b=q(a.node,"xlink:href");!b||"#"!=b.charAt()||(b=b.substring(1))&&(h[b]=(h[b]||[]).concat(function(b){a.attr("xlink:href","#"+b)}))}for(var d,e=a.selectAll("*"),f=/^\s*url\(("|'|)(.*)\1\)\s*$/,g=[],h={},i=0,j=e.length;i<j;i++){b(d=e[i],"fill"),b(d,"stroke"),b(d,"filter"),b(d,"mask"),b(d,"clip-path"),c(d);var k=q(d.node,"id");k&&(q(d.node,{id:d.id}),g.push({old:k,id:d.id}))}for(i=0,j=g.length;i<j;i++){var l=h[g[i].old];if(l)for(var m=0,n=l.length;m<n;m++)l[m](g[i].id)}}(a),a.insertAfter(this),a},m.toDefs=function(){return s(this).appendChild(this.node),this},m.pattern=m.toPattern=function(a,b,c,d){var e=r("pattern",s(this));return null==a&&(a=this.getBBox()),n(a,"object")&&"x"in a&&(b=a.y,c=a.width,d=a.height,a=a.x),q(e.node,{x:a,y:b,width:c,height:d,patternUnits:"userSpaceOnUse",id:e.id,viewBox:[a,b,c,d].join(" ")}),e.node.appendChild(this.node),e},m.marker=function(a,b,c,d,e,f){var g=r("marker",s(this));return null==a&&(a=this.getBBox()),n(a,"object")&&"x"in a&&(b=a.y,c=a.width,d=a.height,e=a.refX||a.cx,f=a.refY||a.cy,a=a.x),q(g.node,{viewBox:[a,b,c,d].join(" "),markerWidth:c,markerHeight:d,orient:"auto",refX:e||0,refY:f||0,id:g.id}),g.node.appendChild(this.node),g};function w(a,b,d,e){"function"!=typeof d||d.length||(e=d,d=c.linear),this.attr=a,this.dur=b,d&&(this.easing=d),e&&(this.callback=e)}d._.Animation=w,d.animation=function(a,b,c,d){return new w(a,b,c,d)},m.inAnim=function(){var a=this,b=[];for(var c in a.anims)a.anims[t](c)&&function(a){b.push({anim:new w(a._attrs,a.dur,a.easing,a._callback),mina:a,curStatus:a.status(),status:function(b){return a.status(b)},stop:function(){a.stop()}})}(a.anims[c]);return b},d.animate=function(a,d,e,f,g,h){"function"!=typeof g||g.length||(h=g,g=c.linear);var i=c.time(),j=c(a,d,i,i+f,c.time,e,g);return h&&b.once("mina.finish."+j.id,h),j},m.stop=function(){for(var a=this.inAnim(),b=0,c=a.length;b<c;b++)a[b].stop();return this},m.animate=function(a,d,e,f){"function"!=typeof e||e.length||(f=e,e=c.linear),a instanceof w&&(f=a.callback,d=(e=a.easing).dur,a=a.attr);var g,h,i,j,l=[],m=[],p={},q=this;for(var r in a)if(a[t](r)){q.equal?(g=(j=q.equal(r,o(a[r]))).from,h=j.to,i=j.f):(g=+q.attr(r),h=+a[r]);var s=n(g,"array")?g.length:1;p[r]=k(l.length,l.length+s,i),l=l.concat(g),m=m.concat(h)}var u=c.time(),v=c(l,m,u,u+d,c.time,function(a){var b={};for(var c in p)p[t](c)&&(b[c]=p[c](a));q.attr(b)},e);return(q.anims[v.id]=v)._attrs=a,v._callback=f,b("snap.animcreated."+q.id,v),b.once("mina.finish."+v.id,function(){delete q.anims[v.id],f&&f.call(q)}),b.once("mina.stop."+v.id,function(){delete q.anims[v.id]}),q};var x={};m.data=function(a,c){var e=x[this.id]=x[this.id]||{};if(0==arguments.length)return b("snap.data.get."+this.id,this,e,null),e;if(1!=arguments.length)return e[a]=c,b("snap.data.set."+this.id,this,c,a),this;if(d.is(a,"object")){for(var f in a)a[t](f)&&this.data(f,a[f]);return this}return b("snap.data.get."+this.id,this,e[a],a),e[a]},m.removeData=function(a){return null==a?x[this.id]={}:x[this.id]&&delete x[this.id][a],this},m.outerSVG=m.toString=l(1),m.innerSVG=l(),m.toDataURL=function(){if(a&&a.btoa){var b=this.getBBox(),c=d.format('<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="{width}" height="{height}" viewBox="{x} {y} {width} {height}">{contents}</svg>',{x:+b.x.toFixed(3),y:+b.y.toFixed(3),width:+b.width.toFixed(3),height:+b.height.toFixed(3),contents:this.outerSVG()});return"data:image/svg+xml;base64,"+btoa(unescape(encodeURIComponent(c)))}},h.prototype.select=m.select,h.prototype.selectAll=m.selectAll}),d.plugin(function(a){function b(a,b,d,e,f,g){return null==b&&"[object SVGMatrix]"==c.call(a)?(this.a=a.a,this.b=a.b,this.c=a.c,this.d=a.d,this.e=a.e,void(this.f=a.f)):void(null!=a?(this.a=+a,this.b=+b,this.c=+d,this.d=+e,this.e=+f,this.f=+g):(this.a=1,this.b=0,this.c=0,this.d=1,this.e=0,this.f=0))}var c=Object.prototype.toString,d=String,e=Math;!function(c){function g(a){return a[0]*a[0]+a[1]*a[1]}function h(a){var b=e.sqrt(g(a));a[0]&&(a[0]/=b),a[1]&&(a[1]/=b)}c.add=function(a,c,d,e,f,g){var h,i,j,k,l=[[],[],[]],m=[[this.a,this.c,this.e],[this.b,this.d,this.f],[0,0,1]],n=[[a,d,f],[c,e,g],[0,0,1]];for(a&&a instanceof b&&(n=[[a.a,a.c,a.e],[a.b,a.d,a.f],[0,0,1]]),h=0;h<3;h++)for(i=0;i<3;i++){for(j=k=0;j<3;j++)k+=m[h][j]*n[j][i];l[h][i]=k}return this.a=l[0][0],this.b=l[1][0],this.c=l[0][1],this.d=l[1][1],this.e=l[0][2],this.f=l[1][2],this},c.invert=function(){var a=this,c=a.a*a.d-a.b*a.c;return new b(a.d/c,-a.b/c,-a.c/c,a.a/c,(a.c*a.f-a.d*a.e)/c,(a.b*a.e-a.a*a.f)/c)},c.clone=function(){return new b(this.a,this.b,this.c,this.d,this.e,this.f)},c.translate=function(a,b){return this.add(1,0,0,1,a,b)},c.scale=function(a,b,c,d){return null==b&&(b=a),(c||d)&&this.add(1,0,0,1,c,d),this.add(a,0,0,b,0,0),(c||d)&&this.add(1,0,0,1,-c,-d),this},c.rotate=function(b,c,d){b=a.rad(b),c=c||0,d=d||0;var f=+e.cos(b).toFixed(9),g=+e.sin(b).toFixed(9);return this.add(f,g,-g,f,c,d),this.add(1,0,0,1,-c,-d)},c.x=function(a,b){return a*this.a+b*this.c+this.e},c.y=function(a,b){return a*this.b+b*this.d+this.f},c.get=function(a){return+this[d.fromCharCode(97+a)].toFixed(4)},c.toString=function(){return"matrix("+[this.get(0),this.get(1),this.get(2),this.get(3),this.get(4),this.get(5)].join()+")"},c.offset=function(){return[this.e.toFixed(4),this.f.toFixed(4)]},c.determinant=function(){return this.a*this.d-this.b*this.c},c.split=function(){var b={};b.dx=this.e,b.dy=this.f;var c=[[this.a,this.c],[this.b,this.d]];b.scalex=e.sqrt(g(c[0])),h(c[0]),b.shear=c[0][0]*c[1][0]+c[0][1]*c[1][1],c[1]=[c[1][0]-c[0][0]*b.shear,c[1][1]-c[0][1]*b.shear],b.scaley=e.sqrt(g(c[1])),h(c[1]),b.shear/=b.scaley,this.determinant()<0&&(b.scalex=-b.scalex);var d=-c[0][1],f=c[1][1];return f<0?(b.rotate=a.deg(e.acos(f)),d<0&&(b.rotate=360-b.rotate)):b.rotate=a.deg(e.asin(d)),b.isSimple=!(+b.shear.toFixed(9)||b.scalex.toFixed(9)!=b.scaley.toFixed(9)&&b.rotate),b.isSuperSimple=!+b.shear.toFixed(9)&&b.scalex.toFixed(9)==b.scaley.toFixed(9)&&!b.rotate,b.noRotation=!+b.shear.toFixed(9)&&!b.rotate,b},c.toTransformString=function(a){var b=a||this.split();return+b.shear.toFixed(9)?"m"+[this.get(0),this.get(1),this.get(2),this.get(3),this.get(4),this.get(5)]:(b.scalex=+b.scalex.toFixed(4),b.scaley=+b.scaley.toFixed(4),b.rotate=+b.rotate.toFixed(4),(b.dx||b.dy?"t"+[+b.dx.toFixed(4),+b.dy.toFixed(4)]:"")+(1!=b.scalex||1!=b.scaley?"s"+[b.scalex,b.scaley,0,0]:"")+(b.rotate?"r"+[+b.rotate.toFixed(4),0,0]:""))}}(b.prototype),a.Matrix=b,a.matrix=function(a,c,d,e,f,g){return new b(a,c,d,e,f,g)}}),d.plugin(function(a,c,d,e,f){function g(d){return function(e){if(b.stop(),e instanceof f&&1==e.node.childNodes.length&&("radialGradient"==e.node.firstChild.tagName||"linearGradient"==e.node.firstChild.tagName||"pattern"==e.node.firstChild.tagName)&&(e=e.node.firstChild,n(this).appendChild(e),e=l(e)),e instanceof c)if("radialGradient"==e.type||"linearGradient"==e.type||"pattern"==e.type){e.node.id||p(e.node,{id:e.id});var g=q(e.node.id)}else g=e.attr(d);else if((g=a.color(e)).error){var h=a(n(this).ownerSVGElement).gradient(e);g=h?(h.node.id||p(h.node,{id:h.id}),q(h.node.id)):e}else g=r(g);var i={};i[d]=g,p(this.node,i),this.node.style[d]=""}}function h(a){b.stop(),a==+a&&(a+="px"),this.node.style.fontSize=a}function j(){return b.stop(),this.node.style.fontSize}var k=a._.make,l=a._.wrap,m=a.is,n=a._.getSomeDefs,o=/^url\(#?([^)]+)\)$/,p=a._.$,q=a.url,r=String,s=a._.separator;b.on("snap.util.attr.mask",function(a){if(a instanceof c||a instanceof f){if(b.stop(),a instanceof f&&1==a.node.childNodes.length&&(a=a.node.firstChild,n(this).appendChild(a),a=l(a)),"mask"==a.type)var d=a;else(d=k("mask",n(this))).node.appendChild(a.node);d.node.id||p(d.node,{id:d.id}),p(this.node,{mask:q(d.id)})}}),function(a){b.on("snap.util.attr.clip",a),b.on("snap.util.attr.clip-path",a),b.on("snap.util.attr.clipPath",a)}(function(a){if(a instanceof c||a instanceof f){if(b.stop(),"clipPath"==a.type)var d=a;else(d=k("clipPath",n(this))).node.appendChild(a.node),d.node.id||p(d.node,{id:d.id});p(this.node,{"clip-path":q(d.node.id||d.id)})}}),b.on("snap.util.attr.fill",g("fill")),b.on("snap.util.attr.stroke",g("stroke"));var u=/^([lr])(?:\(([^)]*)\))?(.*)$/i;b.on("snap.util.grad.parse",function(a){var b=(a=r(a)).match(u);if(!b)return null;var c=b[1],d=b[2],e=b[3];return 1==(d=d.split(/\s*,\s*/).map(function(a){return+a==a?+a:a})).length&&0==d[0]&&(d=[]),{type:c,params:d,stops:e=(e=e.split("-")).map(function(a){var b={color:(a=a.split(":"))[0]};return a[1]&&(b.offset=parseFloat(a[1])),b})}}),b.on("snap.util.attr.d",function(c){b.stop(),m(c,"array")&&m(c[0],"array")&&(c=a.path.toString.call(c)),(c=r(c)).match(/[ruo]/i)&&(c=a.path.toAbsolute(c)),p(this.node,{d:c})})(-1),b.on("snap.util.attr.#text",function(a){b.stop(),a=r(a);for(var c=e.doc.createTextNode(a);this.node.firstChild;)this.node.removeChild(this.node.firstChild);this.node.appendChild(c)})(-1),b.on("snap.util.attr.path",function(a){b.stop(),this.attr({d:a})})(-1),b.on("snap.util.attr.class",function(a){b.stop(),this.node.className.baseVal=a})(-1),b.on("snap.util.attr.viewBox",function(a){var c;c=m(a,"object")&&"x"in a?[a.x,a.y,a.width,a.height].join(" "):m(a,"array")?a.join(" "):a,p(this.node,{viewBox:c}),b.stop()})(-1),b.on("snap.util.attr.transform",function(a){this.transform(a),b.stop()})(-1),b.on("snap.util.attr.r",function(a){"rect"==this.type&&(b.stop(),p(this.node,{rx:a,ry:a}))})(-1),b.on("snap.util.attr.textpath",function(a){if(b.stop(),"text"==this.type){var d,e,f;if(!a&&this.textPath){for(e=this.textPath;e.node.firstChild;)this.node.appendChild(e.node.firstChild);return e.remove(),void delete this.textPath}if(m(a,"string")){var g=n(this),h=l(g.parentNode).path(a);g.appendChild(h.node),d=h.id,h.attr({id:d})}else(a=l(a))instanceof c&&((d=a.attr("id"))||(d=a.id,a.attr({id:d})));if(d)if(e=this.textPath,f=this.node,e)e.attr({"xlink:href":"#"+d});else{for(e=p("textPath",{"xlink:href":"#"+d});f.firstChild;)e.appendChild(f.firstChild);f.appendChild(e),this.textPath=l(e)}}})(-1),b.on("snap.util.attr.text",function(a){if("text"==this.type){for(var c=this.node,d=function(a){var b=p("tspan");if(m(a,"array"))for(var c=0;c<a.length;c++)b.appendChild(d(a[c]));else b.appendChild(e.doc.createTextNode(a));return b.normalize&&b.normalize(),b};c.firstChild;)c.removeChild(c.firstChild);for(var f=d(a);f.firstChild;)c.appendChild(f.firstChild)}b.stop()})(-1),b.on("snap.util.attr.fontSize",h)(-1),b.on("snap.util.attr.font-size",h)(-1),b.on("snap.util.getattr.transform",function(){return b.stop(),this.transform()})(-1),b.on("snap.util.getattr.textpath",function(){return b.stop(),this.textPath})(-1),function(){function c(c){return function(){b.stop();var d=e.doc.defaultView.getComputedStyle(this.node,null).getPropertyValue("marker-"+c);return"none"==d?d:a(e.doc.getElementById(d.match(o)[1]))}}function d(a){return function(c){b.stop();var d="marker"+a.charAt(0).toUpperCase()+a.substring(1);if(""!=c&&c){if("marker"==c.type){var e=c.node.id;return e||p(c.node,{id:c.id}),void(this.node.style[d]=q(e))}}else this.node.style[d]="none"}}b.on("snap.util.getattr.marker-end",c("end"))(-1),b.on("snap.util.getattr.markerEnd",c("end"))(-1),b.on("snap.util.getattr.marker-start",c("start"))(-1),b.on("snap.util.getattr.markerStart",c("start"))(-1),b.on("snap.util.getattr.marker-mid",c("mid"))(-1),b.on("snap.util.getattr.markerMid",c("mid"))(-1),b.on("snap.util.attr.marker-end",d("end"))(-1),b.on("snap.util.attr.markerEnd",d("end"))(-1),b.on("snap.util.attr.marker-start",d("start"))(-1),b.on("snap.util.attr.markerStart",d("start"))(-1),b.on("snap.util.attr.marker-mid",d("mid"))(-1),b.on("snap.util.attr.markerMid",d("mid"))(-1)}(),b.on("snap.util.getattr.r",function(){return"rect"==this.type&&p(this.node,"rx")==p(this.node,"ry")?(b.stop(),p(this.node,"rx")):void 0})(-1),b.on("snap.util.getattr.text",function(){if("text"==this.type||"tspan"==this.type){b.stop();var a=function i(a){for(var b=[],c=a.childNodes,d=0,e=c.length;d<e;d++){var f=c[d];3==f.nodeType&&b.push(f.nodeValue),"tspan"==f.tagName&&b.push(1==f.childNodes.length&&3==f.firstChild.nodeType?f.firstChild.nodeValue:i(f))}return b}(this.node);return 1==a.length?a[0]:a}})(-1),b.on("snap.util.getattr.#text",function(){return this.node.textContent})(-1),b.on("snap.util.getattr.viewBox",function(){b.stop();var c=p(this.node,"viewBox");return c?(c=c.split(s),a._.box(+c[0],+c[1],+c[2],+c[3])):void 0})(-1),b.on("snap.util.getattr.points",function(){var a=p(this.node,"points");return b.stop(),a?a.split(s):void 0})(-1),b.on("snap.util.getattr.path",function(){var a=p(this.node,"d");return b.stop(),a})(-1),b.on("snap.util.getattr.class",function(){return this.node.className.baseVal})(-1),b.on("snap.util.getattr.fontSize",j)(-1),b.on("snap.util.getattr.font-size",j)(-1)}),d.plugin(function(a,b){var c=/\S+/g,d=String,e=b.prototype;e.addClass=function(a){var b,f,g,h=d(a||"").match(c)||[],i=this.node,j=i.className.baseVal,k=j.match(c)||[];if(h.length){for(b=0;f=h[b++];)~k.indexOf(f)||k.push(f);j!=(g=k.join(" "))&&(i.className.baseVal=g)}return this},e.removeClass=function(a){var b,e,f,g,h=d(a||"").match(c)||[],i=this.node,j=i.className.baseVal,k=j.match(c)||[];if(k.length){for(b=0;f=h[b++];)~(e=k.indexOf(f))&&k.splice(e,1);j!=(g=k.join(" "))&&(i.className.baseVal=g)}return this},e.hasClass=function(a){return!!~(this.node.className.baseVal.match(c)||[]).indexOf(a)},e.toggleClass=function(a,b){if(null!=b)return b?this.addClass(a):this.removeClass(a);var d,e,f,g,h=(a||"").match(c)||[],i=this.node,j=i.className.baseVal,k=j.match(c)||[];for(d=0;f=h[d++];)~(e=k.indexOf(f))?k.splice(e,1):k.push(f);return j!=(g=k.join(" "))&&(i.className.baseVal=g),this}}),d.plugin(function(){function a(a){return a}var d={"+":function(a,b){return a+b},"-":function(a,b){return a-b},"/":function(a,b){return a/b},"*":function(a,b){return a*b}},e=String,f=/[a-z]+$/i,g=/^\s*([+\-\/*])\s*=\s*([\d.eE+\-]+)\s*([^\d\s]+)?\s*$/;b.on("snap.util.attr",function(a){var c=e(a).match(g);if(c){var h=b.nt(),i=h.substring(h.lastIndexOf(".")+1),j=this.attr(i),k={};b.stop();var l=c[3]||"",m=j.match(f),n=d[c[1]];if(a=m&&m==l?n(parseFloat(j),+c[2]):(j=this.asPX(i),n(this.asPX(i),this.asPX(i,c[2]+l))),isNaN(j)||isNaN(a))return;k[i]=a,this.attr(k)}})(-10),b.on("snap.util.equal",function(h,i){var j=e(this.attr(h)||""),k=e(i).match(g);if(k){b.stop();var l=k[3]||"",m=j.match(f),n=d[k[1]];return m&&m==l?{from:parseFloat(j),to:n(parseFloat(j),+k[2]),f:function(a){return function(b){return+b.toFixed(3)+a}}(m)}:{from:j=this.asPX(h),to:n(j,this.asPX(h,k[2]+l)),f:a}}})(-10)}),d.plugin(function(c,d,e,f){var g=e.prototype,h=c.is;g.rect=function(a,b,c,d,e,f){var g;return null==f&&(f=e),h(a,"object")&&"[object Object]"==a?g=a:null!=a&&(g={x:a,y:b,width:c,height:d},null!=e&&(g.rx=e,g.ry=f)),this.el("rect",g)},g.circle=function(a,b,c){var d;return h(a,"object")&&"[object Object]"==a?d=a:null!=a&&(d={cx:a,cy:b,r:c}),this.el("circle",d)};var i=function(){function a(){this.parentNode.removeChild(this)}return function(b,c){var d=f.doc.createElement("img"),e=f.doc.body;d.style.cssText="position:absolute;left:-9999em;top:-9999em",d.onload=function(){c.call(d),d.onload=d.onerror=null,e.removeChild(d)},d.onerror=a,e.appendChild(d),d.src=b}}();g.image=function(a,b,d,e,f){var g=this.el("image");if(h(a,"object")&&"src"in a)g.attr(a);else if(null!=a){var j={"xlink:href":a,preserveAspectRatio:"none"};null!=b&&null!=d&&(j.x=b,j.y=d),null!=e&&null!=f?(j.width=e,j.height=f):i(a,function(){c._.$(g.node,{width:this.offsetWidth,height:this.offsetHeight})}),c._.$(g.node,j)}return g},g.ellipse=function(a,b,c,d){var e;return h(a,"object")&&"[object Object]"==a?e=a:null!=a&&(e={cx:a,cy:b,rx:c,ry:d}),this.el("ellipse",e)},g.path=function(a){var b;return h(a,"object")&&!h(a,"array")?b=a:a&&(b={d:a}),this.el("path",b)},g.group=g.g=function(a){var b=this.el("g");return 1==arguments.length&&a&&!a.type?b.attr(a):arguments.length&&b.add(Array.prototype.slice.call(arguments,0)),b},g.svg=function(a,b,c,d,e,f,g,i){var j={};return h(a,"object")&&null==b?j=a:(null!=a&&(j.x=a),null!=b&&(j.y=b),null!=c&&(j.width=c),null!=d&&(j.height=d),null!=e&&null!=f&&null!=g&&null!=i&&(j.viewBox=[e,f,g,i])),this.el("svg",j)},g.mask=function(a){var b=this.el("mask");return 1==arguments.length&&a&&!a.type?b.attr(a):arguments.length&&b.add(Array.prototype.slice.call(arguments,0)),b},g.ptrn=function(a,b,c,d,e,f,g,i){if(h(a,"object"))var j=a;else j={patternUnits:"userSpaceOnUse"},a&&(j.x=a),b&&(j.y=b),null!=c&&(j.width=c),null!=d&&(j.height=d),j.viewBox=null!=e&&null!=f&&null!=g&&null!=i?[e,f,g,i]:[a||0,b||0,c||0,d||0];return this.el("pattern",j)},g.use=function(a){return null!=a?(a instanceof d&&(a.attr("id")||a.attr({id:c._.id(a)}),a=a.attr("id")),"#"==String(a).charAt()&&(a=a.substring(1)),this.el("use",{"xlink:href":"#"+a})):d.prototype.use.call(this)},g.symbol=function(a,b,c,d){var e={};return null!=a&&null!=b&&null!=c&&null!=d&&(e.viewBox=[a,b,c,d]),this.el("symbol",e)},g.text=function(a,b,c){var d={};return h(a,"object")?d=a:null!=a&&(d={x:a,y:b,text:c||""}),this.el("text",d)},g.line=function(a,b,c,d){var e={};return h(a,"object")?e=a:null!=a&&(e={x1:a,x2:c,y1:b,y2:d}),this.el("line",e)},g.polyline=function(a){1<arguments.length&&(a=Array.prototype.slice.call(arguments,0));var b={};return h(a,"object")&&!h(a,"array")?b=a:null!=a&&(b={points:a}),this.el("polyline",b)},g.polygon=function(a){1<arguments.length&&(a=Array.prototype.slice.call(arguments,0));var b={};return h(a,"object")&&!h(a,"array")?b=a:null!=a&&(b={points:a}),this.el("polygon",b)},function(){function d(){return this.selectAll("stop")}function e(a,b){var d=k("stop"),e={offset:+b+"%"};return a=c.color(a),e["stop-color"]=a.hex,a.opacity<1&&(e["stop-opacity"]=a.opacity),k(d,e),this.node.appendChild(d),this}function f(){if("linearGradient"==this.type){var a=k(this.node,"x1")||0,b=k(this.node,"x2")||1,d=k(this.node,"y1")||0,e=k(this.node,"y2")||0;return c._.box(a,d,math.abs(b-a),math.abs(e-d))}var f=this.node.cx||.5,g=this.node.cy||.5,h=this.node.r||0;return c._.box(f-h,g-h,2*h,2*h)}function i(a,b,g,h,i){var j=c._.make("linearGradient",a);return j.stops=d,j.addStop=e,j.getBBox=f,null!=b&&k(j.node,{x1:b,y1:g,x2:h,y2:i}),j}function j(a,b,g,h,i,j){var l=c._.make("radialGradient",a);return l.stops=d,l.addStop=e,l.getBBox=f,null!=b&&k(l.node,{cx:b,cy:g,r:h}),null!=i&&null!=j&&k(l.node,{fx:i,fy:j}),l}var k=c._.$;g.gradient=function(a){return function(a,c){function d(a,b){for(var c=(b-l)/(a-m),d=m;d<a;d++)g[d].offset=+(+l+c*(d-m)).toFixed(2);m=a,l=b}var e,f=b("snap.util.grad.parse",null,c).firstDefined();if(!f)return null;f.params.unshift(a),e="l"==f.type.toLowerCase()?i.apply(0,f.params):j.apply(0,f.params),f.type!=f.type.toLowerCase()&&k(e.node,{gradientUnits:"userSpaceOnUse"});var g=f.stops,h=g.length,l=0,m=0;h--;for(var n=0;n<h;n++)"offset"in g[n]&&d(n,g[n].offset);for(g[h].offset=g[h].offset||100,d(h,g[h].offset),n=0;n<=h;n++){var o=g[n];e.addStop(o.color,o.offset)}return e}(this.defs,a)},g.gradientLinear=function(a,b,c,d){return i(this.defs,a,b,c,d)},g.gradientRadial=function(a,b,c,d,e){return j(this.defs,a,b,c,d,e)},g.toString=function(){var a,b=this.node.ownerDocument,d=b.createDocumentFragment(),e=b.createElement("div"),f=this.node.cloneNode(!0);return d.appendChild(e),e.appendChild(f),c._.$(f,{xmlns:"http://www.w3.org/2000/svg"}),a=e.innerHTML,d.removeChild(d.firstChild),a},g.toDataURL=function(){return a&&a.btoa?"data:image/svg+xml;base64,"+btoa(unescape(encodeURIComponent(this))):void 0},g.clear=function(){for(var a,b=this.node.firstChild;b;)a=b.nextSibling,"defs"!=b.tagName?b.parentNode.removeChild(b):g.clear.call({node:b}),b=a}}()}),d.plugin(function(a,b){function c(a){var b=c.ps=c.ps||{};return b[a]?b[a].sleep=100:b[a]={sleep:100},setTimeout(function(){for(var c in b)b[K](c)&&c!=a&&(b[c].sleep--,b[c].sleep||delete b[c])}),b[a]}function d(a,b,c,d){return null==a&&(a=b=c=d=0),null==b&&(b=a.y,c=a.width,d=a.height,a=a.x),{x:a,y:b,width:c,w:c,height:d,h:d,x2:a+c,y2:b+d,cx:a+c/2,cy:b+d/2,r1:N.min(c,d)/2,r2:N.max(c,d)/2,r0:N.sqrt(c*c+d*d)/2,path:w(a,b,c,d),vb:[a,b,c,d].join(" ")}}function e(){return this.join(",").replace(L,"$1")}function f(a){var b=J(a);return b.toString=e,b}function g(a,b,c,d,e,f,g,h,j){return null==j?n(a,b,c,d,e,f,g,h):i(a,b,c,d,e,f,g,h,function(a,b,c,d,e,f,g,h,i){if(!(i<0||n(a,b,c,d,e,f,g,h)<i)){var j,l=.5,m=1-l;for(j=n(a,b,c,d,e,f,g,h,m);.01<S(j-i);)j=n(a,b,c,d,e,f,g,h,m+=(j<i?1:-1)*(l/=2));return m}}(a,b,c,d,e,f,g,h,j))}function h(c,d){function e(a){return+(+a).toFixed(3)}return a._.cacher(function(a,f,h){a instanceof b&&(a=a.attr("d"));for(var j,k,l,m,n,o="",p={},q=0,r=0,s=(a=E(a)).length;r<s;r++){if("M"==(l=a[r])[0])j=+l[1],k=+l[2];else{if(f<q+(m=g(j,k,l[1],l[2],l[3],l[4],l[5],l[6]))){if(d&&!p.start){if(o+=["C"+e((n=g(j,k,l[1],l[2],l[3],l[4],l[5],l[6],f-q)).start.x),e(n.start.y),e(n.m.x),e(n.m.y),e(n.x),e(n.y)],h)return o;p.start=o,o=["M"+e(n.x),e(n.y)+"C"+e(n.n.x),e(n.n.y),e(n.end.x),e(n.end.y),e(l[5]),e(l[6])].join(),q+=m,j=+l[5],k=+l[6];continue}if(!c&&!d)return g(j,k,l[1],l[2],l[3],l[4],l[5],l[6],f-q)}q+=m,j=+l[5],k=+l[6]}o+=l.shift()+l}return p.end=o,c?q:d?p:i(j,k,l[0],l[1],l[2],l[3],l[4],l[5],1)},null,a._.clone)}function i(a,b,c,d,e,f,g,h,i){var j=1-i,k=R(j,3),l=R(j,2),m=i*i,n=m*i,q=a+2*i*(c-a)+m*(e-2*c+a),r=b+2*i*(d-b)+m*(f-2*d+b),s=c+2*i*(e-c)+m*(g-2*e+c),t=d+2*i*(f-d)+m*(h-2*f+d);return{x:k*a+3*l*i*c+3*j*i*i*e+n*g,y:k*b+3*l*i*d+3*j*i*i*f+n*h,m:{x:q,y:r},n:{x:s,y:t},start:{x:j*a+i*c,y:j*b+i*d},end:{x:j*e+i*g,y:j*f+i*h},alpha:90-180*N.atan2(q-s,r-t)/O}}function j(b,c,e,f,g,h,i,j){a.is(b,"array")||(b=[b,c,e,f,g,h,i,j]);var k=D.apply(null,b);return d(k.min.x,k.min.y,k.max.x-k.min.x,k.max.y-k.min.y)}function k(a,b,c){return b>=a.x&&b<=a.x+a.width&&c>=a.y&&c<=a.y+a.height}function l(a,b){return a=d(a),k(b=d(b),a.x,a.y)||k(b,a.x2,a.y)||k(b,a.x,a.y2)||k(b,a.x2,a.y2)||k(a,b.x,b.y)||k(a,b.x2,b.y)||k(a,b.x,b.y2)||k(a,b.x2,b.y2)||(a.x<b.x2&&a.x>b.x||b.x<a.x2&&b.x>a.x)&&(a.y<b.y2&&a.y>b.y||b.y<a.y2&&b.y>a.y)}function m(a,b,c,d,e){return a*(a*(-3*b+9*c-9*d+3*e)+6*b-12*c+6*d)-3*b+3*c}function n(a,b,c,d,e,f,g,h,i){null==i&&(i=1);for(var j=(i=1<i?1:i<0?0:i)/2,l=[-.1252,.1252,-.3678,.3678,-.5873,.5873,-.7699,.7699,-.9041,.9041,-.9816,.9816],n=[.2491,.2491,.2335,.2335,.2032,.2032,.1601,.1601,.1069,.1069,.0472,.0472],o=0,p=0;p<12;p++){var q=j*l[p]+j,r=m(q,a,c,e,g),s=m(q,b,d,f,h),t=r*r+s*s;o+=n[p]*N.sqrt(t)}return j*o}function p(a,b,c,d,e,f,g,h){if(!(Q(a,c)<P(e,g)||P(a,c)>Q(e,g)||Q(b,d)<P(f,h)||P(b,d)>Q(f,h))){var k=(a-c)*(f-h)-(b-d)*(e-g);if(k){var l=((a*d-b*c)*(e-g)-(a-c)*(e*h-f*g))/k,m=((a*d-b*c)*(f-h)-(b-d)*(e*h-f*g))/k,n=+l.toFixed(2),o=+m.toFixed(2);if(!(n<+P(a,c).toFixed(2)||n>+Q(a,c).toFixed(2)||n<+P(e,g).toFixed(2)||n>+Q(e,g).toFixed(2)||o<+P(b,d).toFixed(2)||o>+Q(b,d).toFixed(2)||o<+P(f,h).toFixed(2)||o>+Q(f,h).toFixed(2)))return{x:l,y:m}}}}function q(a,b,c){if(!l(j(a),j(b)))return c?0:[];for(var h=~~(n.apply(0,a)/8),k=~~(n.apply(0,b)/8),m=[],o=[],q={},r=c?0:[],s=0;s<1+h;s++){var t=i.apply(0,a.concat(s/h));m.push({x:t.x,y:t.y,t:s/h})}for(s=0;s<1+k;s++)t=i.apply(0,b.concat(s/k)),o.push({x:t.x,y:t.y,t:s/k});for(s=0;s<h;s++)for(var u=0;u<k;u++){var v=m[s],w=m[s+1],x=o[u],y=o[u+1],z=S(w.x-v.x)<.001?"y":"x",A=S(y.x-x.x)<.001?"y":"x",B=p(v.x,v.y,w.x,w.y,x.x,x.y,y.x,y.y);if(B){if(q[B.x.toFixed(4)]==B.y.toFixed(4))continue;q[B.x.toFixed(4)]=B.y.toFixed(4);var C=v.t+S((B[z]-v[z])/(w[z]-v[z]))*(w.t-v.t),D=x.t+S((B[A]-x[A])/(y[A]-x[A]))*(y.t-x.t);0<=C&&C<=1&&0<=D&&D<=1&&(c?r++:r.push({x:B.x,y:B.y,t1:C,t2:D}))}}return r}function t(a,b,c){a=E(a),b=E(b);for(var d,e,f,g,h,i,j,k,l,m,n=c?0:[],o=0,p=a.length;o<p;o++){var r=a[o];if("M"==r[0])d=h=r[1],e=i=r[2];else{e="C"==r[0]?(d=(l=[d,e].concat(r.slice(1)))[6],l[7]):(l=[d,e,d,e,h,i,h,i],d=h,i);for(var s=0,t=b.length;s<t;s++){var u=b[s];if("M"==u[0])f=j=u[1],g=k=u[2];else{g="C"==u[0]?(f=(m=[f,g].concat(u.slice(1)))[6],m[7]):(m=[f,g,f,g,j,k,j,k],f=j,k);var v=q(l,m,c);if(c)n+=v;else{for(var w=0,x=v.length;w<x;w++)v[w].segment1=o,v[w].segment2=s,v[w].bez1=l,v[w].bez2=m;n=n.concat(v)}}}}}return n}function v(a){var b=c(a);if(b.bbox)return J(b.bbox);if(!a)return d();for(var e,f=0,g=0,h=[],i=[],j=0,k=(a=E(a)).length;j<k;j++)if("M"==(e=a[j])[0])f=e[1],g=e[2],h.push(f),i.push(g);else{var l=D(f,g,e[1],e[2],e[3],e[4],e[5],e[6]);h=h.concat(l.min.x,l.max.x),i=i.concat(l.min.y,l.max.y),f=e[5],g=e[6]}var m=P.apply(0,h),n=P.apply(0,i),q=d(m,n,Q.apply(0,h)-m,Q.apply(0,i)-n);return b.bbox=J(q),q}function w(a,b,c,d,f){if(f)return[["M",+a+ +f,b],["l",c-2*f,0],["a",f,f,0,0,1,f,f],["l",0,d-2*f],["a",f,f,0,0,1,-f,f],["l",2*f-c,0],["a",f,f,0,0,1,-f,-f],["l",0,2*f-d],["a",f,f,0,0,1,f,-f],["z"]];var g=[["M",a,b],["l",c,0],["l",0,d],["l",-c,0],["z"]];return g.toString=e,g}function x(a,b,c,d,f){if(null==f&&null==d&&(d=c),a=+a,b=+b,c=+c,d=+d,null!=f)var g=Math.PI/180,h=a+c*Math.cos(-d*g),i=a+c*Math.cos(-f*g),l=[["M",h,b+c*Math.sin(-d*g)],["A",c,c,0,+(180<f-d),0,i,b+c*Math.sin(-f*g)]];else l=[["M",a,b],["m",0,-d],["a",c,d,0,1,1,0,2*d],["a",c,d,0,1,1,0,-2*d],["z"]];return l.toString=e,l}function z(b){var d=c(b);if(d.abs)return f(d.abs);if(I(b,"array")&&I(b&&b[0],"array")||(b=a.parsePathString(b)),!b||!b.length)return[["M",0,0]];var g,h=[],i=0,j=0,k=0,l=0,m=0;"M"==b[0][0]&&(k=i=+b[0][1],l=j=+b[0][2],m++,h[0]=["M",i,j]);for(var n,o,p=3==b.length&&"M"==b[0][0]&&"R"==b[1][0].toUpperCase()&&"Z"==b[2][0].toUpperCase(),q=m,r=b.length;q<r;q++){if(h.push(n=[]),(g=(o=b[q])[0])!=g.toUpperCase())switch(n[0]=g.toUpperCase(),n[0]){case"A":n[1]=o[1],n[2]=o[2],n[3]=o[3],n[4]=o[4],n[5]=o[5],n[6]=+o[6]+i,n[7]=+o[7]+j;break;case"V":n[1]=+o[1]+j;break;case"H":n[1]=+o[1]+i;break;case"R":for(var s=[i,j].concat(o.slice(1)),t=2,u=s.length;t<u;t++)s[t]=+s[t]+i,s[++t]=+s[t]+j;h.pop(),h=h.concat(G(s,p));break;case"O":h.pop(),(s=x(i,j,o[1],o[2])).push(s[0]),h=h.concat(s);break;case"U":h.pop(),h=h.concat(x(i,j,o[1],o[2],o[3])),n=["U"].concat(h[h.length-1].slice(-2));break;case"M":k=+o[1]+i,l=+o[2]+j;default:for(t=1,u=o.length;t<u;t++)n[t]=+o[t]+(t%2?i:j)}else if("R"==g)s=[i,j].concat(o.slice(1)),h.pop(),h=h.concat(G(s,p)),n=["R"].concat(o.slice(-2));else if("O"==g)h.pop(),(s=x(i,j,o[1],o[2])).push(s[0]),h=h.concat(s);else if("U"==g)h.pop(),h=h.concat(x(i,j,o[1],o[2],o[3])),n=["U"].concat(h[h.length-1].slice(-2));else for(var v=0,w=o.length;v<w;v++)n[v]=o[v];if("O"!=(g=g.toUpperCase()))switch(n[0]){case"Z":i=+k,j=+l;break;case"H":i=n[1];break;case"V":j=n[1];break;case"M":k=n[n.length-2],l=n[n.length-1];default:i=n[n.length-2],j=n[n.length-1]}}return h.toString=e,d.abs=f(h),h}function A(a,b,c,d){return[a,b,c,d,c,d]}function B(a,b,c,d,e,f){var g=1/3,h=2/3;return[g*a+h*c,g*b+h*d,g*e+h*c,g*f+h*d,e,f]}function C(b,c,d,e,f,g,h,i,j,k){var l,m=120*O/180,n=O/180*(+f||0),o=[],p=a._.cacher(function(a,b,c){return{x:a*N.cos(c)-b*N.sin(c),y:a*N.sin(c)+b*N.cos(c)}});if(k)y=k[0],z=k[1],w=k[2],x=k[3];else{b=(l=p(b,c,-n)).x,c=l.y,i=(l=p(i,j,-n)).x,j=l.y;var q=(N.cos(O/180*f),N.sin(O/180*f),(b-i)/2),r=(c-j)/2,s=q*q/(d*d)+r*r/(e*e);1<s&&(d*=s=N.sqrt(s),e*=s);var t=d*d,u=e*e,v=(g==h?-1:1)*N.sqrt(S((t*u-t*r*r-u*q*q)/(t*r*r+u*q*q))),w=v*d*r/e+(b+i)/2,x=v*-e*q/d+(c+j)/2,y=N.asin(((c-x)/e).toFixed(9)),z=N.asin(((j-x)/e).toFixed(9));(y=b<w?O-y:y)<0&&(y=2*O+y),(z=i<w?O-z:z)<0&&(z=2*O+z),h&&z<y&&(y-=2*O),!h&&y<z&&(z-=2*O)}var A=z-y;if(S(A)>m){var B=z,D=i,E=j;z=y+m*(h&&y<z?1:-1),o=C(i=w+d*N.cos(z),j=x+e*N.sin(z),d,e,f,0,h,D,E,[z,B,w,x])}A=z-y;var F=N.cos(y),G=N.sin(y),H=N.cos(z),I=N.sin(z),J=N.tan(A/4),K=4/3*d*J,L=4/3*e*J,M=[b,c],P=[b+K*G,c-L*F],Q=[i+K*I,j-L*H],R=[i,j];if(P[0]=2*M[0]-P[0],P[1]=2*M[1]-P[1],k)return[P,Q,R].concat(o);for(var T=[],U=0,V=(o=[P,Q,R].concat(o).join().split(",")).length;U<V;U++)T[U]=U%2?p(o[U-1],o[U],n).y:p(o[U],o[U+1],n).x;return T}function D(a,b,c,d,e,f,g,h){for(var i,j,k,l,m,n,o,p,q=[],r=[[],[]],s=0;s<2;++s)if(k=0==s?(j=6*a-12*c+6*e,i=-3*a+9*c-9*e+3*g,3*c-3*a):(j=6*b-12*d+6*f,i=-3*b+9*d-9*f+3*h,3*d-3*b),S(i)<1e-12){if(S(j)<1e-12)continue;0<(l=-k/j)&&l<1&&q.push(l)}else o=j*j-4*k*i,p=N.sqrt(o),o<0||(0<(m=(-j+p)/(2*i))&&m<1&&q.push(m),0<(n=(-j-p)/(2*i))&&n<1&&q.push(n));for(var t,u=q.length,v=u;u--;)t=1-(l=q[u]),r[0][u]=t*t*t*a+3*t*t*l*c+3*t*l*l*e+l*l*l*g,r[1][u]=t*t*t*b+3*t*t*l*d+3*t*l*l*f+l*l*l*h;return r[0][v]=a,r[1][v]=b,r[0][v+1]=g,r[1][v+1]=h,r[0].length=r[1].length=v+2,{min:{x:P.apply(0,r[0]),y:P.apply(0,r[1])},max:{x:Q.apply(0,r[0]),y:Q.apply(0,r[1])}}}function E(a,b){var d=!b&&c(a);if(!b&&d.curve)return f(d.curve);function j(a,b,c){var d,e;if(!a)return["C",b.x,b.y,b.x,b.y,b.x,b.y];switch(a[0]in{T:1,Q:1}||(b.qx=b.qy=null),a[0]){case"M":b.X=a[1],b.Y=a[2];break;case"A":a=["C"].concat(C.apply(0,[b.x,b.y].concat(a.slice(1))));break;case"S":e="C"==c||"S"==c?(d=2*b.x-b.bx,2*b.y-b.by):(d=b.x,b.y),a=["C",d,e].concat(a.slice(1));break;case"T":"Q"==c||"T"==c?(b.qx=2*b.x-b.qx,b.qy=2*b.y-b.qy):(b.qx=b.x,b.qy=b.y),a=["C"].concat(B(b.x,b.y,b.qx,b.qy,a[1],a[2]));break;case"Q":b.qx=a[1],b.qy=a[2],a=["C"].concat(B(b.x,b.y,a[1],a[2],a[3],a[4]));break;case"L":a=["C"].concat(A(b.x,b.y,a[1],a[2]));break;case"H":a=["C"].concat(A(b.x,b.y,a[1],b.y));break;case"V":a=["C"].concat(A(b.x,b.y,b.x,a[1]));break;case"Z":a=["C"].concat(A(b.x,b.y,b.X,b.Y))}return a}function k(a,b){if(7<a[b].length){a[b].shift();for(var c=a[b];c.length;)m[b]="A",g&&(n[b]="A"),a.splice(b++,0,["C"].concat(c.splice(0,6)));a.splice(b,1),r=Q(e.length,g&&g.length||0)}}function l(a,b,c,d,f){a&&b&&"M"==a[f][0]&&"M"!=b[f][0]&&(b.splice(f,0,["M",d.x,d.y]),c.bx=0,c.by=0,c.x=a[f][1],c.y=a[f][2],r=Q(e.length,g&&g.length||0))}for(var e=z(a),g=b&&z(b),h={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null},i={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null},m=[],n=[],o="",p="",q=0,r=Q(e.length,g&&g.length||0);q<r;q++){e[q]&&(o=e[q][0]),"C"!=o&&(m[q]=o,q&&(p=m[q-1])),e[q]=j(e[q],h,p),"A"!=m[q]&&"C"==o&&(m[q]="C"),k(e,q),g&&(g[q]&&(o=g[q][0]),"C"!=o&&(n[q]=o,q&&(p=n[q-1])),g[q]=j(g[q],i,p),"A"!=n[q]&&"C"==o&&(n[q]="C"),k(g,q)),l(e,g,h,i,q),l(g,e,i,h,q);var s=e[q],t=g&&g[q],u=s.length,v=g&&t.length;h.x=s[u-2],h.y=s[u-1],h.bx=M(s[u-4])||h.x,h.by=M(s[u-3])||h.y,i.bx=g&&(M(t[v-4])||i.x),i.by=g&&(M(t[v-3])||i.y),i.x=g&&t[v-2],i.y=g&&t[v-1]}return g||(d.curve=f(e)),g?[e,g]:e}function G(a,b){for(var c=[],d=0,e=a.length;d<e-2*!b;d+=2){var f=[{x:+a[d-2],y:+a[d-1]},{x:+a[d],y:+a[d+1]},{x:+a[d+2],y:+a[d+3]},{x:+a[d+4],y:+a[d+5]}];b?d?e-4==d?f[3]={x:+a[0],y:+a[1]}:e-2==d&&(f[2]={x:+a[0],y:+a[1]},f[3]={x:+a[2],y:+a[3]}):f[0]={x:+a[e-2],y:+a[e-1]}:e-4==d?f[3]=f[2]:d||(f[0]={x:+a[d],y:+a[d+1]}),c.push(["C",(-f[0].x+6*f[1].x+f[2].x)/6,(-f[0].y+6*f[1].y+f[2].y)/6,(f[1].x+6*f[2].x-f[3].x)/6,(f[1].y+6*f[2].y-f[3].y)/6,f[2].x,f[2].y])}return c}var H=b.prototype,I=a.is,J=a._.clone,K="hasOwnProperty",L=/,?([a-z]),?/gi,M=parseFloat,N=Math,O=N.PI,P=N.min,Q=N.max,R=N.pow,S=N.abs,T=h(1),U=h(),V=h(0,1),W=a._unit2px,X={path:function(a){return a.attr("path")},circle:function(a){var b=W(a);return x(b.cx,b.cy,b.r)},ellipse:function(a){var b=W(a);return x(b.cx||0,b.cy||0,b.rx,b.ry)},rect:function(a){var b=W(a);return w(b.x||0,b.y||0,b.width,b.height,b.rx,b.ry)},image:function(a){var b=W(a);return w(b.x||0,b.y||0,b.width,b.height)},line:function(a){return"M"+[a.attr("x1")||0,a.attr("y1")||0,a.attr("x2"),a.attr("y2")]},polyline:function(a){return"M"+a.attr("points")},polygon:function(a){return"M"+a.attr("points")+"z"},deflt:function(a){var b=a.node.getBBox();return w(b.x,b.y,b.width,b.height)}};a.path=c,a.path.getTotalLength=T,a.path.getPointAtLength=U,a.path.getSubpath=function(a,b,c){if(this.getTotalLength(a)-c<1e-6)return V(a,b).end;var d=V(a,c,1);return b?V(d,b).end:d},H.getTotalLength=function(){return this.node.getTotalLength?this.node.getTotalLength():void 0},H.getPointAtLength=function(a){return U(this.attr("d"),a)},H.getSubpath=function(b,c){return a.path.getSubpath(this.attr("d"),b,c)},a._.box=d,a.path.findDotsAtSegment=i,a.path.bezierBBox=j,a.path.isPointInsideBBox=k,a.closest=function(b,c,e,f){for(var g=100,h=d(b-g/2,c-g/2,g,g),i=[],j=e[0].hasOwnProperty("x")?function(a){return{x:e[a].x,y:e[a].y}}:function(a){return{x:e[a],y:f[a]}},l=0;g<=1e6&&!l;){for(var m=0,n=e.length;m<n;m++){var o=j(m);if(k(h,o.x,o.y)){l++,i.push(o);break}}l||(h=d(b-(g*=2)/2,c-g/2,g,g))}if(1e6!=g){var p,q=1/0;for(m=0,n=i.length;m<n;m++){var r=a.len(b,c,i[m].x,i[m].y);r<q&&(q=r,i[m].len=r,p=i[m])}return p}},a.path.isBBoxIntersect=l,a.path.intersection=function(a,b){return t(a,b)},a.path.intersectionNumber=function(a,b){return t(a,b,1)},a.path.isPointInside=function(a,b,c){var d=v(a);return k(d,b,c)&&t(a,[["M",b,c],["H",d.x2+10]],1)%2==1},a.path.getBBox=v,a.path.get=X,a.path.toRelative=function(b){var d=c(b),g=String.prototype.toLowerCase;if(d.rel)return f(d.rel);a.is(b,"array")&&a.is(b&&b[0],"array")||(b=a.parsePathString(b));var h=[],i=0,j=0,k=0,l=0,m=0;"M"==b[0][0]&&(k=i=b[0][1],l=j=b[0][2],m++,h.push(["M",i,j]));for(var n=m,o=b.length;n<o;n++){var p=h[n]=[],q=b[n];if(q[0]!=g.call(q[0]))switch(p[0]=g.call(q[0]),p[0]){case"a":p[1]=q[1],p[2]=q[2],p[3]=q[3],p[4]=q[4],p[5]=q[5],p[6]=+(q[6]-i).toFixed(3),p[7]=+(q[7]-j).toFixed(3);break;case"v":p[1]=+(q[1]-j).toFixed(3);break;case"m":k=q[1],l=q[2];default:for(var r=1,s=q.length;r<s;r++)p[r]=+(q[r]-(r%2?i:j)).toFixed(3)}else{p=h[n]=[],"m"==q[0]&&(k=q[1]+i,l=q[2]+j);for(var t=0,u=q.length;t<u;t++)h[n][t]=q[t]}var v=h[n].length;switch(h[n][0]){case"z":i=k,j=l;break;case"h":i+=+h[n][v-1];break;case"v":j+=+h[n][v-1];break;default:i+=+h[n][v-2],j+=+h[n][v-1]}}return h.toString=e,d.rel=f(h),h},a.path.toAbsolute=z,a.path.toCubic=E,a.path.map=function(a,b){if(!b)return a;var c,d,e,f,g,h,i;for(e=0,g=(a=E(a)).length;e<g;e++)for(f=1,h=(i=a[e]).length;f<h;f+=2)c=b.x(i[f],i[f+1]),d=b.y(i[f],i[f+1]),i[f]=c,i[f+1]=d;return a},a.path.toString=e,a.path.clone=f}),d.plugin(function(a){function f(a){if(this.items=[],this.bindings={},this.length=0,this.type="set",a)for(var b=0,c=a.length;b<c;b++)a[b]&&(this[this.items.length]=this.items[this.items.length]=a[b],this.length++)}var d=Math.max,e=Math.min,g=f.prototype;g.push=function(){for(var a,b,c=0,d=arguments.length;c<d;c++)(a=arguments[c])&&(this[b=this.items.length]=this.items[b]=a,this.length++);return this},g.pop=function(){return this.length&&delete this[this.length--],this.items.pop()},g.forEach=function(a,b){for(var c=0,d=this.items.length;c<d;c++)if(!1===a.call(b,this.items[c],c))return this;return this},g.animate=function(d,e,f,g){"function"!=typeof f||f.length||(g=f,f=c.linear),d instanceof a._.Animation&&(g=d.callback,f=d.easing,e=f.dur,d=d.attr);var h=arguments;if(a.is(d,"array")&&a.is(h[h.length-1],"array"))var i=!0;function k(){j?this.b=j:j=this.b}var j,l=0,m=this,n=g&&function(){++l==m.length&&g.call(this)};return this.forEach(function(a,c){b.once("snap.animcreated."+a.id,k),i?h[c]&&a.animate.apply(a,h[c]):a.animate(d,e,f,n)})},g.remove=function(){for(;this.length;)this.pop().remove();return this},g.bind=function(a,b,c){var d={};if("function"==typeof b)this.bindings[a]=b;else{var e=c||a;this.bindings[a]=function(a){d[e]=a,b.attr(d)}}return this},g.attr=function(a){var b={};for(var c in a)this.bindings[c]?this.bindings[c](a[c]):b[c]=a[c];for(var d=0,e=this.items.length;d<e;d++)this.items[d].attr(b);return this},g.clear=function(){for(;this.length;)this.pop()},g.splice=function(a,b){a=a<0?d(this.length+a,0):a,b=d(0,e(this.length-a,b));var c,g=[],h=[],i=[];for(c=2;c<arguments.length;c++)i.push(arguments[c]);for(c=0;c<b;c++)h.push(this[a+c]);for(;c<this.length-a;c++)g.push(this[a+c]);var j=i.length;for(c=0;c<j+g.length;c++)this.items[a+c]=this[a+c]=c<j?i[c]:g[c-j];for(c=this.items.length=this.length-=b-j;this[c];)delete this[c++];return new f(h)},g.exclude=function(a){for(var b=0,c=this.length;b<c;b++)if(this[b]==a)return this.splice(b,1),!0;return!1},g.insertAfter=function(a){for(var b=this.items.length;b--;)this.items[b].insertAfter(a);return this},g.getBBox=function(){for(var a=[],b=[],c=[],f=[],g=this.items.length;g--;)if(!this.items[g].removed){var h=this.items[g].getBBox();a.push(h.x),b.push(h.y),c.push(h.x+h.width),f.push(h.y+h.height)}return{x:a=e.apply(0,a),y:b=e.apply(0,b),x2:c=d.apply(0,c),y2:f=d.apply(0,f),width:c-a,height:f-b,cx:a+(c-a)/2,cy:b+(f-b)/2}},g.clone=function(a){a=new f;for(var b=0,c=this.items.length;b<c;b++)a.push(this.items[b].clone());return a},g.toString=function(){return"Snaps set"},g.type="set",a.Set=f,a.set=function(){var a=new f;return arguments.length&&a.push.apply(a,Array.prototype.slice.call(arguments,0)),a}}),d.plugin(function(a,c){function d(a){var b=a[0];switch(b.toLowerCase()){case"t":return[b,0,0];case"m":return[b,1,0,0,1,0,0];case"r":return 4==a.length?[b,0,a[2],a[3]]:[b,0];case"s":return 5==a.length?[b,1,1,a[3],a[4]]:3==a.length?[b,1,1]:[b,1]}}function e(b,c,e){c=p(c).replace(/\.{3}|\u2026/g,b),b=a.parseTransformString(b)||[],c=a.parseTransformString(c)||[];for(var f,g,h,i,l=Math.max(b.length,c.length),m=[],n=[],o=0;o<l;o++){if(h=b[o]||d(c[o]),i=c[o]||d(h),h[0]!=i[0]||"r"==h[0].toLowerCase()&&(h[2]!=i[2]||h[3]!=i[3])||"s"==h[0].toLowerCase()&&(h[3]!=i[3]||h[4]!=i[4])){b=a._.transform2matrix(b,e()),c=a._.transform2matrix(c,e()),m=[["m",b.a,b.b,b.c,b.d,b.e,b.f]],n=[["m",c.a,c.b,c.c,c.d,c.e,c.f]];break}for(m[o]=[],n[o]=[],f=0,g=Math.max(h.length,i.length);f<g;f++)f in h&&(m[o][f]=h[f]),f in i&&(n[o][f]=i[f])}return{from:k(m),to:k(n),f:j(m)}}function f(a){return a}function h(a){return a.join(" ")}function i(b){return a.rgb(b[0],b[1],b[2])}function j(a){var b,c,d,e,f,g,h=0,i=[];for(b=0,c=a.length;b<c;b++){for(f="[",g=['"'+a[b][0]+'"'],d=1,e=a[b].length;d<e;d++)g[d]="val["+h+++"]";f+=g+"]",i[b]=f}return Function("val","return Snap.path.toString.call(["+i+"])")}function k(a){for(var b=[],c=0,d=a.length;c<d;c++)for(var e=1,f=a[c].length;e<f;e++)b.push(a[c][e]);return b}function l(a){return isFinite(parseFloat(a))}var n={},o=/[a-z]+$/i,p=String;n.stroke=n.fill="colour",c.prototype.equal=function(a,c){return b("snap.util.equal",this,a,c).firstDefined()},b.on("snap.util.equal",function(b,c){var d,q,r=p(this.attr(b)||""),s=this;if(l(r)&&l(c))return{from:parseFloat(r),to:parseFloat(c),f:f};if("colour"==n[b])return d=a.color(r),q=a.color(c),{from:[d.r,d.g,d.b,d.opacity],to:[q.r,q.g,q.b,q.opacity],f:i};if("viewBox"==b)return{from:d=this.attr(b).vb.split(" ").map(Number),to:q=c.split(" ").map(Number),f:h};if("transform"==b||"gradientTransform"==b||"patternTransform"==b)return c instanceof a.Matrix&&(c=c.toTransformString()),a._.rgTransform.test(c)||(c=a._.svgTransform2string(c)),e(r,c,function(){return s.getBBox(1)});if("d"==b||"path"==b)return{from:k((d=a.path.toCubic(r,c))[0]),to:k(d[1]),f:j(d[0])};if("points"==b)return{from:d=p(r).split(a._.separator),to:q=p(c).split(a._.separator),f:function(a){return a}};var t=r.match(o),u=p(c).match(o);return t&&function(b,c){return!(!a.is(b,"array")||!a.is(c,"array"))&&b.toString()==c.toString()}(t,u)?{from:parseFloat(r),to:parseFloat(c),f:function(a){return function(b){return+b.toFixed(3)+a}}(t)}:{from:this.asPX(b),to:this.asPX(b,c),f:f}})}),d.plugin(function(a,c,d,e){function k(a,b){var c="y"==a?"scrollTop":"scrollLeft",d=b&&b.node?b.node.ownerDocument:e.doc;return d[c in d.documentElement?"documentElement":"body"][c]}function l(){return this.originalEvent.preventDefault()}function m(){return this.originalEvent.stopPropagation()}function n(a,b,c,d){var e=h&&j[b]?j[b]:b,f=function(e){var f=k("y",d),i=k("x",d);if(h&&j.hasOwnProperty(b))for(var n=0,o=e.targetTouches&&e.targetTouches.length;n<o;n++)if(e.targetTouches[n].target==a||a.contains(e.targetTouches[n].target)){var p=e;(e=e.targetTouches[n]).originalEvent=p,e.preventDefault=l,e.stopPropagation=m;break}var q=e.clientX+i,r=e.clientY+f;return c.call(d,e,q,r)};return b!==e&&a.addEventListener(b,f,!1),a.addEventListener(e,f,!1),function(){return b!==e&&a.removeEventListener(b,f,!1),a.removeEventListener(e,f,!1),!0}}function p(a){for(var c,d=a.clientX,e=a.clientY,f=k("y"),g=k("x"),i=o.length;i--;){if(c=o[i],h){for(var j,l=a.touches&&a.touches.length;l--;)if((j=a.touches[l]).identifier==c.el._drag.id||c.el.node.contains(j.target)){d=j.clientX,e=j.clientY,(a.originalEvent?a.originalEvent:a).preventDefault();break}}else a.preventDefault();var m=c.el.node;m.nextSibling,m.parentNode,m.style.display,d+=g,e+=f,b("snap.drag.move."+c.el.id,c.move_scope||c.el,d-c.el._drag.x,e-c.el._drag.y,d,e,a)}}for(var f=c.prototype,h=("createTouch"in e.doc),i=["click","dblclick","mousedown","mousemove","mouseout","mouseover","mouseup","touchstart","touchmove","touchend","touchcancel"],j={mousedown:"touchstart",mousemove:"touchmove",mouseup:"touchend"},o=[],q=function(c){a.unmousemove(p).unmouseup(q);for(var d,e=o.length;e--;)(d=o[e]).el._drag={},b("snap.drag.end."+d.el.id,d.end_scope||d.start_scope||d.move_scope||d.el,c),b.off("snap.drag.*."+d.el.id);o=[]},r=i.length;r--;)!function(b){a[b]=f[b]=function(c,d){if(a.is(c,"function"))this.events=this.events||[],this.events.push({name:b,f:c,unbind:n(this.node||document,b,c,d||this)});else for(var e=0,f=this.events.length;e<f;e++)if(this.events[e].name==b)try{this.events[e].f.call(this)}catch(g){}return this},a["un"+b]=f["un"+b]=function(a){for(var c=this.events||[],d=c.length;d--;)if(c[d].name==b&&(c[d].f==a||!a))return c[d].unbind(),c.splice(d,1),c.length||delete this.events,this;return this}}(i[r]);f.hover=function(a,b,c,d){return this.mouseover(a,c).mouseout(b,d||c)},f.unhover=function(a,b){return this.unmouseover(a).unmouseout(b)};var s=[];f.drag=function(c,d,e,f,g,h){function i(i,j,l){(i.originalEvent||i).preventDefault(),k._drag.x=j,k._drag.y=l,k._drag.id=i.identifier,o.length||a.mousemove(p).mouseup(q),o.push({el:k,move_scope:f,start_scope:g,end_scope:h}),d&&b.on("snap.drag.start."+k.id,d),c&&b.on("snap.drag.move."+k.id,c),e&&b.on("snap.drag.end."+k.id,e),b("snap.drag.start."+k.id,g||f||k,j,l,i)}function j(a,c,d){b("snap.draginit."+k.id,k,a,c,d)}var l,k=this;return arguments.length?(b.on("snap.draginit."+k.id,i),k._drag={},s.push({el:k,start:i,init:j}),k.mousedown(j),k):k.drag(function(a,b){this.attr({transform:l+(l?"T":"t")+[a,b]})},function(){l=this.transform().local})},f.undrag=function(){for(var c=s.length;c--;)s[c].el==this&&(this.unmousedown(s[c].init),s.splice(c,1),b.unbind("snap.drag.*."+this.id),b.unbind("snap.draginit."+this.id));return s.length||a.unmousemove(p).unmouseup(q),this}}),d.plugin(function(a,c,d){var e=(c.prototype,d.prototype),f=/^\s*url\((.+)\)/,g=String,h=a._.$;a.filter={},e.filter=function(b){var d=this;"svg"!=d.type&&(d=d.paper);var e=a.parse(g(b)),f=a._.id(),i=(d.node.offsetWidth,d.node.offsetHeight,h("filter"));return h(i,{id:f,filterUnits:"userSpaceOnUse"}),i.appendChild(e.node),d.defs.appendChild(i),new c(i)},b.on("snap.util.getattr.filter",function(){b.stop();var c=h(this.node,"filter");if(c){var d=g(c).match(f);return d&&a.select(d[1])}}),b.on("snap.util.attr.filter",function(d){if(d instanceof c&&"filter"==d.type){b.stop();var e=d.node.id;e||(h(d.node,{id:d.id}),e=d.id),h(this.node,{filter:a.url(e)})}d&&"none"!=d||(b.stop(),this.node.removeAttribute("filter"))}),a.filter.blur=function(b,c){null==b&&(b=2);var d=null==c?b:[b,c];return a.format('<feGaussianBlur stdDeviation="{def}"/>',{def:d})},a.filter.blur.toString=function(){return this()},a.filter.shadow=function(b,c,d,e,f){return"string"==typeof d&&(f=e=d,d=4),"string"!=typeof e&&(f=e,e="#000"),e=e||"#000",null==d&&(d=4),null==f&&(f=1),null==b&&(b=0,c=2),null==c&&(c=b),e=a.color(e),a.format('<feGaussianBlur in="SourceAlpha" stdDeviation="{blur}"/><feOffset dx="{dx}" dy="{dy}" result="offsetblur"/><feFlood flood-color="{color}"/><feComposite in2="offsetblur" operator="in"/><feComponentTransfer><feFuncA type="linear" slope="{opacity}"/></feComponentTransfer><feMerge><feMergeNode/><feMergeNode in="SourceGraphic"/></feMerge>',{color:e,dx:b,dy:c,blur:d,opacity:f})},a.filter.shadow.toString=function(){return this()},a.filter.grayscale=function(b){return null==b&&(b=1),a.format('<feColorMatrix type="matrix" values="{a} {b} {c} 0 0 {d} {e} {f} 0 0 {g} {b} {h} 0 0 0 0 0 1 0"/>',{a:.2126+.7874*(1-b),b:.7152-.7152*(1-b),c:.0722-.0722*(1-b),d:.2126-.2126*(1-b),e:.7152+.2848*(1-b),f:.0722-.0722*(1-b),g:.2126-.2126*(1-b),h:.0722+.9278*(1-b)})},a.filter.grayscale.toString=function(){return this()},a.filter.sepia=function(b){return null==b&&(b=1),a.format('<feColorMatrix type="matrix" values="{a} {b} {c} 0 0 {d} {e} {f} 0 0 {g} {h} {i} 0 0 0 0 0 1 0"/>',{a:.393+.607*(1-b),b:.769-.769*(1-b),c:.189-.189*(1-b),d:.349-.349*(1-b),e:.686+.314*(1-b),f:.168-.168*(1-b),g:.272-.272*(1-b),h:.534-.534*(1-b),i:.131+.869*(1-b)})},a.filter.sepia.toString=function(){return this()},a.filter.saturate=function(b){return null==b&&(b=1),a.format('<feColorMatrix type="saturate" values="{amount}"/>',{amount:1-b})},a.filter.saturate.toString=function(){return this()},a.filter.hueRotate=function(b){return b=b||0,a.format('<feColorMatrix type="hueRotate" values="{angle}"/>',{angle:b})},a.filter.hueRotate.toString=function(){return this()},a.filter.invert=function(b){return null==b&&(b=1),a.format('<feComponentTransfer><feFuncR type="table" tableValues="{amount} {amount2}"/><feFuncG type="table" tableValues="{amount} {amount2}"/><feFuncB type="table" tableValues="{amount} {amount2}"/></feComponentTransfer>',{amount:b,amount2:1-b})},a.filter.invert.toString=function(){return this()},a.filter.brightness=function(b){return null==b&&(b=1),a.format('<feComponentTransfer><feFuncR type="linear" slope="{amount}"/><feFuncG type="linear" slope="{amount}"/><feFuncB type="linear" slope="{amount}"/></feComponentTransfer>',{amount:b})},a.filter.brightness.toString=function(){return this()},a.filter.contrast=function(b){return null==b&&(b=1),a.format('<feComponentTransfer><feFuncR type="linear" slope="{amount}" intercept="{amount2}"/><feFuncG type="linear" slope="{amount}" intercept="{amount2}"/><feFuncB type="linear" slope="{amount}" intercept="{amount2}"/></feComponentTransfer>',{amount:b,amount2:.5-b/2})},a.filter.contrast.toString=function(){return this()}}),d.plugin(function(a,b){function f(){return"T"+this.dx+","+this.dy}var c=a._.box,d=a.is,e=/^[^a-z]*([tbmlrc])/i;b.prototype.getAlign=function(a,b){null==b&&d(a,"string")&&(b=a,a=null);var g=(a=a||this.paper).getBBox?a.getBBox():c(a),h=this.getBBox(),i={};switch(b=(b=b&&b.match(e))?b[1].toLowerCase():"c"){case"t":i.dx=0,i.dy=g.y-h.y;break;case"b":i.dx=0,i.dy=g.y2-h.y2;break;case"m":i.dx=0,i.dy=g.cy-h.cy;break;case"l":i.dx=g.x-h.x,i.dy=0;break;case"r":i.dx=g.x2-h.x2,i.dy=0;break;default:i.dx=g.cx-h.cx,i.dy=0}return i.toString=f,i},b.prototype.align=function(a,b){return this.transform("..."+this.getAlign(a,b))}}),d}),function(root,factory){"object"==typeof exports&&"object"==typeof module?module.exports=factory():"function"==typeof define&&define.amd?define("Gantt",[],factory):"object"==typeof exports?exports.Gantt=factory():root.Gantt=factory()}(this,function(){return modules=[function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(element,tasks,config){var self={};function reset_variables(tasks){self.element=element,self._tasks=tasks,self._bars=[],self._arrows=[],self.element_groups={}}function refresh(updated_tasks){reset_variables(updated_tasks),change_view_mode(self.config.view_mode)}function change_view_mode(mode){!function(scale){"Day"===(self.config.view_mode=scale)?(self.config.step=24,self.config.column_width=38):"Half Day"===scale?(self.config.step=12,self.config.column_width=38):"Quarter Day"===scale?(self.config.step=6,self.config.column_width=38):"Week"===scale?(self.config.step=168,self.config.column_width=140):"Month"===scale&&(self.config.step=720,self.config.column_width=120)}(mode),self.tasks=self._tasks.map(function(task,i){if(task._start=moment(task.start,self.config.date_format),task._end=moment(task.end,self.config.date_format),task._index=i,task.start||task.end||(task._start=moment().startOf("day"),task._end=moment().startOf("day").add(2,"days")),!task.start&&task.end&&(task._start=task._end.clone().add(-2,"days")),task.start&&!task.end&&(task._end=task._start.clone().add(2,"days")),task.start&&task.end||(task.invalid=!0),"string"==typeof task.dependencies||!task.dependencies){var deps=[];task.dependencies&&(deps=task.dependencies.split(",").map(function(d){return d.trim()}).filter(function(d){return d})),task.dependencies=deps}return task.id||(task.id=function(task){return task.name+"_"+Math.random().toString(36).slice(2,12)}(task)),task}),function(){self.dependency_map={};var _iteratorNormalCompletion=!0,_didIteratorError=!1,_iteratorError=void 0;try{for(var _step,_iterator=self.tasks[Symbol.iterator]();!(_iteratorNormalCompletion=(_step=_iterator.next()).done);_iteratorNormalCompletion=!0){var t=_step.value,_iteratorNormalCompletion2=!0,_didIteratorError2=!1,_iteratorError2=void 0;try{for(var _step2,_iterator2=t.dependencies[Symbol.iterator]();!(_iteratorNormalCompletion2=(_step2=_iterator2.next()).done);_iteratorNormalCompletion2=!0){var d=_step2.value;self.dependency_map[d]=self.dependency_map[d]||[],self.dependency_map[d].push(t.id)}}catch(err){_didIteratorError2=!0,_iteratorError2=err}finally{try{!_iteratorNormalCompletion2&&_iterator2.return&&_iterator2.return()}finally{if(_didIteratorError2)throw _iteratorError2}}}}catch(err){_didIteratorError=!0,_iteratorError=err}finally{try{!_iteratorNormalCompletion&&_iterator.return&&_iterator.return()}finally{if(_didIteratorError)throw _iteratorError}}}(),function(){self.gantt_start=self.gantt_end=null;var _iteratorNormalCompletion3=!0,_didIteratorError3=!1,_iteratorError3=void 0;try{for(var _step3,_iterator3=self.tasks[Symbol.iterator]();!(_iteratorNormalCompletion3=(_step3=_iterator3.next()).done);_iteratorNormalCompletion3=!0){var task=_step3.value;(!self.gantt_start||task._start<self.gantt_start)&&(self.gantt_start=task._start),(!self.gantt_end||task._end>self.gantt_end)&&(self.gantt_end=task._end)}}catch(err){_didIteratorError3=!0,_iteratorError3=err}finally{try{!_iteratorNormalCompletion3&&_iterator3.return&&_iterator3.return()}finally{if(_didIteratorError3)throw _iteratorError3}}view_is(["Quarter Day","Half Day","Day"])?(self.gantt_start=self.gantt_start.clone().subtract(14,"day"),self.gantt_end=self.gantt_end.clone().add(7,"day")):view_is("Month")?(self.gantt_start=self.gantt_start.clone().startOf("year").subtract(1,"month"),self.gantt_end=self.gantt_end.clone().endOf("month").add(1,"year")):(self.gantt_start=self.gantt_start.clone().startOf("month").subtract(1,"month"),self.gantt_end=self.gantt_end.clone().endOf("month").add(1,"month")),function(){self.dates=[];var cur_date=null;for(;null===cur_date||cur_date<self.gantt_end;)cur_date=cur_date?view_is("Month")?cur_date.clone().add(1,"month"):cur_date.clone().add(self.config.step,"hours"):self.gantt_start.clone(),self.dates.push(cur_date)}()}(),function(){if(self.canvas)return;self.canvas=Snap(self.element).addClass("gantt")}(),self.canvas.clear(),self._bars=[],self._arrows=[],function(){var _iteratorNormalCompletion4=!0,_didIteratorError4=!1,_iteratorError4=void 0;try{for(var _step4,_iterator4=["grid","date","arrow","progress","bar","details"][Symbol.iterator]();!(_iteratorNormalCompletion4=(_step4=_iterator4.next()).done);_iteratorNormalCompletion4=!0){var group=_step4.value;self.element_groups[group]=self.canvas.group().attr({id:group})}}catch(err){_didIteratorError4=!0,_iteratorError4=err}finally{try{!_iteratorNormalCompletion4&&_iterator4.return&&_iterator4.return()}finally{if(_didIteratorError4)throw _iteratorError4}}}(),function(){var grid_width=self.dates.length*self.config.column_width,grid_height=self.config.header_height+self.config.padding+(self.config.bar.height+self.config.padding)*self.tasks.length;self.canvas.rect(0,0,grid_width,grid_height).addClass("grid-background").appendTo(self.element_groups.grid),self.canvas.attr({height:grid_height+self.config.padding+100,width:"100%"})}(),function(){var rows=self.canvas.group().appendTo(self.element_groups.grid),lines=self.canvas.group().appendTo(self.element_groups.grid),row_width=self.dates.length*self.config.column_width,row_height=self.config.bar.height+self.config.padding,row_y=self.config.header_height+self.config.padding/2,_iteratorNormalCompletion5=!0,_didIteratorError5=!1,_iteratorError5=void 0;try{for(var _step5,_iterator5=self.tasks[Symbol.iterator]();!(_iteratorNormalCompletion5=(_step5=_iterator5.next()).done);_iteratorNormalCompletion5=!0){_step5.value;self.canvas.rect(0,row_y,row_width,row_height).addClass("grid-row").appendTo(rows),self.canvas.line(0,row_y+row_height,row_width,row_y+row_height).addClass("row-line").appendTo(lines),row_y+=self.config.bar.height+self.config.padding}}catch(err){_didIteratorError5=!0,_iteratorError5=err}finally{try{!_iteratorNormalCompletion5&&_iterator5.return&&_iterator5.return()}finally{if(_didIteratorError5)throw _iteratorError5}}}(),function(){var header_width=self.dates.length*self.config.column_width,header_height=self.config.header_height+10;self.canvas.rect(0,0,header_width,header_height).addClass("grid-header").appendTo(self.element_groups.grid)}(),function(){var tick_x=0,tick_y=self.config.header_height+self.config.padding/2,tick_height=(self.config.bar.height+self.config.padding)*self.tasks.length,_iteratorNormalCompletion6=!0,_didIteratorError6=!1,_iteratorError6=void 0;try{for(var _step6,_iterator6=self.dates[Symbol.iterator]();!(_iteratorNormalCompletion6=(_step6=_iterator6.next()).done);_iteratorNormalCompletion6=!0){var date=_step6.value,tick_class="tick";view_is("Day")&&1===date.day()&&(tick_class+=" thick"),view_is("Week")&&1<=date.date()&&date.date()<8&&(tick_class+=" thick"),view_is("Month")&&date.month()%3==0&&(tick_class+=" thick"),self.canvas.path(Snap.format("M {x} {y} v {height}",{x:tick_x,y:tick_y,height:tick_height})).addClass(tick_class).appendTo(self.element_groups.grid),view_is("Month")?tick_x+=date.daysInMonth()*self.config.column_width/30:tick_x+=self.config.column_width}}catch(err){_didIteratorError6=!0,_iteratorError6=err}finally{try{!_iteratorNormalCompletion6&&_iterator6.return&&_iterator6.return()}finally{if(_didIteratorError6)throw _iteratorError6}}}(),function(){if(view_is("Day")){var x=moment().startOf("day").diff(self.gantt_start,"hours")/self.config.step*self.config.column_width+2,y=30,width=self.config.column_width,height=(self.config.bar.height+self.config.padding)*self.tasks.length+self.config.header_height+self.config.padding/2-30;self.canvas.rect(x-3,y,width,height).addClass("today-highlight").appendTo(self.element_groups.grid)}else if(view_is("Week")){x=moment().startOf("day").diff(self.gantt_start,"hours")/self.config.step*self.config.column_width,y=52,width=2,height=(self.config.bar.height+self.config.padding)*self.tasks.length+self.config.header_height+self.config.padding/2-52;self.canvas.rect(x-2,y,width,height).addClass("today-highlight").appendTo(self.element_groups.grid)}else if(view_is("Month")){x=moment().startOf("day").diff(self.gantt_start,"hours")/self.config.step*self.config.column_width,y=52,width=2,height=(self.config.bar.height+self.config.padding)*self.tasks.length+self.config.header_height+self.config.padding/2-52;self.canvas.rect(x,y,width,height).addClass("today-highlight").appendTo(self.element_groups.grid)}}(),function(){var _iteratorNormalCompletion7=!0,_didIteratorError7=!1,_iteratorError7=void 0;try{for(var _step7,_iterator7=function(){var last_date=null;return self.dates.map(function(date,i){var d=function(date,last_date,i){last_date=last_date||date.clone().add(1,"year");var date_text={"Quarter Day_lower":date.format("HH"),"Half Day_lower":date.format("HH"),Day_lower:date.date()!==last_date.date()?date.format("D"):"",Week_lower:date.month()!==last_date.month()?date.format("D MMM"):date.format("D"),Month_lower:date.format("MMMM"),"Quarter Day_upper":date.date()!==last_date.date()?date.format("D MMM"):"","Half Day_upper":date.date()!==last_date.date()?date.month()!==last_date.month()?date.format("D MMM"):date.format("D"):"",Day_upper:date.month()!==last_date.month()?date.format("MMMM"):"",Week_upper:date.month()!==last_date.month()?date.format("MMMM"):"",Month_upper:date.year()!==last_date.year()?date.format("YYYY"):""},base_pos={x:i*self.config.column_width,lower_y:self.config.header_height,upper_y:self.config.header_height-25},x_pos={"Quarter Day_lower":4*self.config.column_width/2,"Quarter Day_upper":0,"Half Day_lower":2*self.config.column_width/2,"Half Day_upper":0,Day_lower:self.config.column_width/2,Day_upper:30*self.config.column_width/2,Week_lower:0,Week_upper:4*self.config.column_width/2,Month_lower:self.config.column_width/2,Month_upper:self.config.column_width*(12-date.month())/2};return{upper_text:date_text[self.config.view_mode+"_upper"],lower_text:date_text[self.config.view_mode+"_lower"],upper_x:base_pos.x+x_pos[self.config.view_mode+"_upper"],upper_y:base_pos.upper_y,lower_x:base_pos.x+x_pos[self.config.view_mode+"_lower"],lower_y:base_pos.lower_y}}(date,last_date,i);return last_date=date,d})}()[Symbol.iterator]();!(_iteratorNormalCompletion7=(_step7=_iterator7.next()).done);_iteratorNormalCompletion7=!0){var date=_step7.value;if(self.canvas.text(date.lower_x,date.lower_y,date.lower_text).addClass("lower-text").appendTo(self.element_groups.date),date.upper_text){var $upper_text=self.canvas.text(date.upper_x,date.upper_y,date.upper_text).addClass("upper-text").appendTo(self.element_groups.date);$upper_text.getBBox().x2>self.element_groups.grid.getBBox().width&&$upper_text.remove()}}}catch(err){_didIteratorError7=!0,_iteratorError7=err}finally{try{!_iteratorNormalCompletion7&&_iterator7.return&&_iterator7.return()}finally{if(_didIteratorError7)throw _iteratorError7}}}(),self._bars=self.tasks.map(function(task){var bar=(0,_Bar2.default)(self,task);return self.element_groups.bar.add(bar.group),bar}),function(){self._arrows=[];var _iteratorNormalCompletion8=!0,_didIteratorError8=!1,_iteratorError8=void 0;try{for(var _step8,_loop=function(){var arrows,task=_step8.value;arrows=task.dependencies.map(function(dep){var dependency=function(id){return self.tasks.find(function(task){return task.id===id})}(dep);if(dependency){var arrow=(0,_Arrow2.default)(self,self._bars[dependency._index],self._bars[task._index]);return self.element_groups.arrow.add(arrow.element),arrow}}).filter(function(arr){return arr}),self._arrows=self._arrows.concat(arrows)},_iterator8=self.tasks[Symbol.iterator]();!(_iteratorNormalCompletion8=(_step8=_iterator8.next()).done);_iteratorNormalCompletion8=!0)_loop()}catch(err){_didIteratorError8=!0,_iteratorError8=err}finally{try{!_iteratorNormalCompletion8&&_iterator8.return&&_iterator8.return()}finally{if(_didIteratorError8)throw _iteratorError8}}}(),function(){var _iteratorNormalCompletion9=!0,_didIteratorError9=!1,_iteratorError9=void 0;try{for(var _step9,_loop2=function(){var bar=_step9.value;bar.arrows=self._arrows.filter(function(arrow){return arrow.from_task.task.id===bar.task.id||arrow.to_task.task.id===bar.task.id})},_iterator9=self._bars[Symbol.iterator]();!(_iteratorNormalCompletion9=(_step9=_iterator9.next()).done);_iteratorNormalCompletion9=!0)_loop2()}catch(err){_didIteratorError9=!0,_iteratorError9=err}finally{try{!_iteratorNormalCompletion9&&_iterator9.return&&_iterator9.return()}finally{if(_didIteratorError9)throw _iteratorError9}}}(),function(){var cur_width=self.canvas.node.getBoundingClientRect().width,actual_width=self.canvas.select("#grid .grid-row").attr("width");cur_width<actual_width&&self.canvas.attr("width",actual_width)}(),function(){var parent_element=document.querySelector(self.element).parentElement;if(!parent_element)return;var scroll_pos=moment().diff(self.gantt_start,"hours")/self.config.step*self.config.column_width-self.config.column_width,containerWidth=parent_element.offsetWidth,scrollAdjustment=Math.round(containerWidth/2)-150;parent_element.scrollLeft=scroll_pos-scrollAdjustment}(),self.element_groups.grid.click(function(){unselect_all(),self.element_groups.details.selectAll(".details-wrapper").forEach(function(el){return el.addClass("hide")})}),trigger_event("view_change",[mode])}function unselect_all(){self.canvas.selectAll(".bar-wrapper").forEach(function(el){el.removeClass("active")})}function view_is(modes){if("string"==typeof modes)return self.config.view_mode===modes;if(Array.isArray(modes)){var _iteratorNormalCompletion10=!0,_didIteratorError10=!1,_iteratorError10=void 0;try{for(var _step10,_iterator10=modes[Symbol.iterator]();!(_iteratorNormalCompletion10=(_step10=_iterator10.next()).done);_iteratorNormalCompletion10=!0){var mode=_step10.value;if(self.config.view_mode===mode)return!0}}catch(err){_didIteratorError10=!0,_iteratorError10=err}finally{try{!_iteratorNormalCompletion10&&_iterator10.return&&_iterator10.return()}finally{if(_didIteratorError10)throw _iteratorError10}}return!1}}function get_bar(id){return self._bars.find(function(bar){return bar.task.id===id})}function trigger_event(event,args){self.config["on_"+event]&&self.config["on_"+event].apply(null,args)}return function(){self.config=Object.assign({},{header_height:50,column_width:30,step:24,view_modes:["Quarter Day","Half Day","Day","Week","Month","Quarter"],bar:{height:40},arrow:{curve:5},padding:18,view_mode:"Day",date_format:"YYYY-MM-DD",custom_popup_html:null},config),reset_variables(tasks),self.change_view_mode=change_view_mode,self.unselect_all=unselect_all,self.view_is=view_is,self.get_bar=get_bar,self.trigger_event=trigger_event,self.refresh=refresh,change_view_mode(self.config.view_mode)}(),self},__webpack_require__(1);var _Bar2=_interopRequireDefault(__webpack_require__(5)),_Arrow2=_interopRequireDefault(__webpack_require__(6));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}module.exports=exports.default},function(module,exports,__webpack_require__){var content=__webpack_require__(2);"string"==typeof content&&(content=[[module.id,content,""]]);__webpack_require__(4)(content,{});content.locals&&(module.exports=content.locals)},function(module,exports,__webpack_require__){(module.exports=__webpack_require__(3)()).push([module.id,".gantt .grid-background {\n  fill: none; }\n\n.gantt .grid-header {\n  fill: #ffffff;\n  stroke: #e0e0e0;\n  stroke-width: 1.4; }\n\n.gantt .grid-row {\n  fill: #ffffff; }\n\n.gantt .grid-row:nth-child(even) {\n  fill: #f5f5f5; }\n\n.gantt .row-line {\n  stroke: #ebeff2; }\n\n.gantt .tick {\n  stroke: #e0e0e0;\n  stroke-width: 0.2; }\n  .gantt .tick.thick {\n    stroke-width: 0.4; }\n\n.gantt .today-highlight {\n  fill: #1b75bb;\n  opacity: 1; }\n\n.gantt #arrow {\n  fill: none;\n  stroke: #666;\n  stroke-width: 1.4; }\n\n.gantt .bar {\n   stroke: #8D99A6;\n  stroke-width: 0;\n  transition: stroke-width .3s ease; }\n\n.gantt .bar-progress {\n  fill: #a3a3ff; }\n\n.gantt .bar-invalid {\n  fill: transparent;\n  stroke: #8D99A6;\n  stroke-width: 1;\n  stroke-dasharray: 5; }\n  .gantt .bar-invalid ~ .bar-label {\n    fill: #555; }\n\n.gantt .bar-label {\n  fill: #fff;\n  dominant-baseline: central;\n  text-anchor: middle;\n  font-size: 12px;\n  font-weight: lighter;\n  letter-spacing: 0.8px; }\n  .gantt .bar-label.big {\n    fill: #555;\n    text-anchor: start; }\n\n.gantt .handle {\n  fill: #ddd;\n  cursor: ew-resize;\n  opacity: 0;\n  visibility: hidden;\n  transition: opacity .3s ease; }\n\n.gantt .bar-wrapper {\n  cursor: pointer; }\n  .gantt .bar-wrapper:hover .bar {\n    stroke-width: 2; }\n  .gantt .bar-wrapper:hover .handle {\n    visibility: visible;\n    opacity: 1; }\n  .gantt .bar-wrapper.active .bar {\n    stroke-width: 2; }\n\n.gantt .lower-text, .gantt .upper-text {\n  font-size: 12px;\n  text-anchor: middle; }\n\n.gantt .upper-text {\n  fill: #555; }\n\n.gantt .lower-text {\n  fill: #333; }\n\n.gantt #details .details-container {\n  background: #fff;\n  display: inline-block;\n  padding: 12px; }\n  .gantt #details .details-container h5, .gantt #details .details-container p {\n    margin: 0; }\n  .gantt #details .details-container h5 {\n    font-size: 12px;\n    font-weight: bold;\n    margin-bottom: 10px;\n    color: #555; }\n  .gantt #details .details-container p {\n    font-size: 12px;\n    margin-bottom: 6px;\n    color: #666; }\n  .gantt #details .details-container p:last-child {\n    margin-bottom: 0; }\n\n.gantt .hide {\n  display: none; }\n","",{version:3,sources:["/./src/src/gantt.scss"],names:[],mappings:"AAYA;EAGE,WAAU,EACV;;AAJF;EAME,cAAa;EACb,gBAjBoB;EAkBpB,kBAAiB,EACjB;;AATF;EAWE,cAAa,EACb;;AAZF;EAcE,cAvBgB,EAwBhB;;AAfF;EAiBE,gBAzB0B,EA0B1B;;AAlBF;EAoBE,gBA9BoB;EA+BpB,kBAAiB,EAIjB;EAzBF;IAuBG,kBAAiB,EACjB;;AAxBH;EA2BE,cAlCoB;EAmCpB,aAAY,EACZ;;AA7BF;EAgCE,WAAU;EACV,aAvCe;EAwCf,kBAAiB,EACjB;;AAnCF;EAsCE,cAlDiB;EAmDjB,gBAlDkB;EAmDlB,gBAAe;EACf,kCAAiC,EACjC;;AA1CF;EA4CE,cA/CY,EAgDZ;;AA7CF;EA+CE,kBAAiB;EACjB,gBA3DkB;EA4DlB,gBAAe;EACf,oBAAmB,EAKnB;EAvDF;IAqDG,WA1Dc,EA2Dd;;AAtDH;EAyDE,WAAU;EACV,2BAA0B;EAC1B,oBAAmB;EACnB,gBAAe;EACf,qBAAoB;EACpB,sBAAqB,EAMrB;EApEF;IAiEG,WAtEc;IAuEd,mBAAkB,EAClB;;AAnEH;EAuEE,WAzEiB;EA0EjB,kBAAiB;EACjB,WAAU;EACV,mBAAkB;EAClB,6BAA4B,EAC5B;;AA5EF;EA+EE,gBAAe,EAkBf;EAjGF;IAmFI,gBAAe,EACf;EApFJ;IAuFI,oBAAmB;IACnB,WAAU,EACV;EAzFJ;IA8FI,gBAAe,EACf;;AA/FJ;EAoGE,gBAAe;EACf,oBAAmB,EACnB;;AAtGF;EAwGE,WA7Ge,EA8Gf;;AAzGF;EA2GE,WA/Ge,EAgHf;;AA5GF;EA+GE,iBAAgB;EAChB,sBAAqB;EACrB,cAAa,EAsBb;EAvIF;IAoHG,UAAS,EACT;EArHH;IAwHG,gBAAe;IACf,kBAAiB;IACjB,oBAAmB;IACnB,YAhIc,EAiId;EA5HH;IA+HG,gBAAe;IACf,mBAAkB;IAClB,YAvIc,EAwId;EAlIH;IAqIG,iBAAgB,EAChB;;AAtIH;EA0IE,cAAa,EACb",file:"gantt.scss",sourcesContent:["$bar-color: #b8c2cc;\n$bar-stroke: #8D99A6;\n$border-color: #e0e0e0;\n$light-bg: #f5f5f5;\n$light-border-color: #ebeff2;\n$light-yellow: #fcf8e3;\n$text-muted: #666;\n$text-light: #555;\n$text-color: #333;\n$blue: #a3a3ff;\n$handle-color: #ddd;\n\n.gantt {\n\n\t.grid-background {\n\t\tfill: none;\n\t}\n\t.grid-header {\n\t\tfill: #ffffff;\n\t\tstroke: $border-color;\n\t\tstroke-width: 1.4;\n\t}\n\t.grid-row {\n\t\tfill: #ffffff;\n\t}\n\t.grid-row:nth-child(even) {\n\t\tfill: $light-bg;\n\t}\n\t.row-line {\n\t\tstroke: $light-border-color;\n\t}\n\t.tick {\n\t\tstroke: $border-color;\n\t\tstroke-width: 0.2;\n\t\t&.thick {\n\t\t\tstroke-width: 0.4;\n\t\t}\n\t}\n\t.today-highlight {\n\t\tfill: $light-yellow;\n\t\topacity: 0.5;\n\t}\n\n\t#arrow {\n\t\tfill: none;\n\t\tstroke: $text-muted;\n\t\tstroke-width: 1.4;\n\t}\n\n\t.bar {\n\t\tfill: $bar-color;\n\t\tstroke: $bar-stroke;\n\t\tstroke-width: 0;\n\t\ttransition: stroke-width .3s ease;\n\t}\n\t.bar-progress {\n\t\tfill: $blue;\n\t}\n\t.bar-invalid {\n\t\tfill: transparent;\n\t\tstroke: $bar-stroke;\n\t\tstroke-width: 1;\n\t\tstroke-dasharray: 5;\n\n\t\t&~.bar-label {\n\t\t\tfill: $text-light;\n\t\t}\n\t}\n\t.bar-label {\n\t\tfill: #fff;\n\t\tdominant-baseline: central;\n\t\ttext-anchor: middle;\n\t\tfont-size: 12px;\n\t\tfont-weight: lighter;\n\t\tletter-spacing: 0.8px;\n\n\t\t&.big {\n\t\t\tfill: $text-light;\n\t\t\ttext-anchor: start;\n\t\t}\n\t}\n\n\t.handle {\n\t\tfill: $handle-color;\n\t\tcursor: ew-resize;\n\t\topacity: 0;\n\t\tvisibility: hidden;\n\t\ttransition: opacity .3s ease;\n\t}\n\n\t.bar-wrapper {\n\t\tcursor: pointer;\n\n\t\t&:hover {\n\t\t\t.bar {\n\t\t\t\tstroke-width: 2;\n\t\t\t}\n\n\t\t\t.handle {\n\t\t\t\tvisibility: visible;\n\t\t\t\topacity: 1;\n\t\t\t}\n\t\t}\n\n\t\t&.active {\n\t\t\t.bar {\n\t\t\t\tstroke-width: 2;\n\t\t\t}\n\t\t}\n\t}\n\n\t.lower-text, .upper-text {\n\t\tfont-size: 12px;\n\t\ttext-anchor: middle;\n\t}\n\t.upper-text {\n\t\tfill: $text-light;\n\t}\n\t.lower-text {\n\t\tfill: $text-color;\n\t}\n\n\t#details .details-container {\n\t\tbackground: #fff;\n\t\tdisplay: inline-block;\n\t\tpadding: 12px;\n\n\t\th5, p {\n\t\t\tmargin: 0;\n\t\t}\n\n\t\th5 {\n\t\t\tfont-size: 12px;\n\t\t\tfont-weight: bold;\n\t\t\tmargin-bottom: 10px;\n\t\t\tcolor: $text-light;\n\t\t}\n\n\t\tp {\n\t\t\tfont-size: 12px;\n\t\t\tmargin-bottom: 6px;\n\t\t\tcolor: $text-muted;\n\t\t}\n\n\t\tp:last-child {\n\t\t\tmargin-bottom: 0;\n\t\t}\n\t}\n\n\t.hide {\n\t\tdisplay: none;\n\t}\n}"],sourceRoot:"webpack://"}])},function(module,exports){module.exports=function(){var list=[];return list.toString=function(){for(var result=[],i=0;i<this.length;i++){var item=this[i];item[2]?result.push("@media "+item[2]+"{"+item[1]+"}"):result.push(item[1])}return result.join("")},list.i=function(modules,mediaQuery){"string"==typeof modules&&(modules=[[null,modules,""]]);for(var alreadyImportedModules={},i=0;i<this.length;i++){var id=this[i][0];"number"==typeof id&&(alreadyImportedModules[id]=!0)}for(i=0;i<modules.length;i++){var item=modules[i];"number"==typeof item[0]&&alreadyImportedModules[item[0]]||(mediaQuery&&!item[2]?item[2]=mediaQuery:mediaQuery&&(item[2]="("+item[2]+") and ("+mediaQuery+")"),list.push(item))}},list}},function(module,exports,__webpack_require__){function memoize(fn){var memo;return function(){return void 0===memo&&(memo=fn.apply(this,arguments)),memo}}var stylesInDom={},isOldIE=memoize(function(){return/msie [6-9]\b/.test(window.navigator.userAgent.toLowerCase())}),getHeadElement=memoize(function(){return document.head||document.getElementsByTagName("head")[0]}),singletonElement=null,singletonCounter=0,styleElementsInsertedAtTop=[];function addStylesToDom(styles,options){for(var i=0;i<styles.length;i++){var item=styles[i],domStyle=stylesInDom[item.id];if(domStyle){domStyle.refs++;for(var j=0;j<domStyle.parts.length;j++)domStyle.parts[j](item.parts[j]);for(;j<item.parts.length;j++)domStyle.parts.push(addStyle(item.parts[j],options))}else{var parts=[];for(j=0;j<item.parts.length;j++)parts.push(addStyle(item.parts[j],options));stylesInDom[item.id]={id:item.id,refs:1,parts:parts}}}}function listToStyles(list){for(var styles=[],newStyles={},i=0;i<list.length;i++){var item=list[i],id=item[0],part={css:item[1],media:item[2],sourceMap:item[3]};newStyles[id]?newStyles[id].parts.push(part):styles.push(newStyles[id]={id:id,parts:[part]})}return styles}function insertStyleElement(options,styleElement){var head=getHeadElement(),lastStyleElementInsertedAtTop=styleElementsInsertedAtTop[styleElementsInsertedAtTop.length-1];if("top"===options.insertAt)lastStyleElementInsertedAtTop?lastStyleElementInsertedAtTop.nextSibling?head.insertBefore(styleElement,lastStyleElementInsertedAtTop.nextSibling):head.appendChild(styleElement):head.insertBefore(styleElement,head.firstChild),styleElementsInsertedAtTop.push(styleElement);else{if("bottom"!==options.insertAt)throw new Error("Invalid value for parameter 'insertAt'. Must be 'top' or 'bottom'.");head.appendChild(styleElement)}}function removeStyleElement(styleElement){styleElement.parentNode.removeChild(styleElement);var idx=styleElementsInsertedAtTop.indexOf(styleElement);0<=idx&&styleElementsInsertedAtTop.splice(idx,1)}function createStyleElement(options){var styleElement=document.createElement("style");return styleElement.type="text/css",insertStyleElement(options,styleElement),styleElement}function addStyle(obj,options){var styleElement,update,remove;if(options.singleton){var styleIndex=singletonCounter++;styleElement=singletonElement=singletonElement||createStyleElement(options),update=applyToSingletonTag.bind(null,styleElement,styleIndex,!1),remove=applyToSingletonTag.bind(null,styleElement,styleIndex,!0)}else remove=obj.sourceMap&&"function"==typeof URL&&"function"==typeof URL.createObjectURL&&"function"==typeof URL.revokeObjectURL&&"function"==typeof Blob&&"function"==typeof btoa?(styleElement=function(options){var linkElement=document.createElement("link");return linkElement.rel="stylesheet",insertStyleElement(options,linkElement),linkElement}(options),update=function(linkElement,obj){var css=obj.css,sourceMap=obj.sourceMap;sourceMap&&(css+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(sourceMap))))+" */");var blob=new Blob([css],{type:"text/css"}),oldSrc=linkElement.href;linkElement.href=URL.createObjectURL(blob),oldSrc&&URL.revokeObjectURL(oldSrc)}.bind(null,styleElement),function(){removeStyleElement(styleElement),styleElement.href&&URL.revokeObjectURL(styleElement.href)}):(styleElement=createStyleElement(options),update=function(styleElement,obj){var css=obj.css,media=obj.media;media&&styleElement.setAttribute("media",media);if(styleElement.styleSheet)styleElement.styleSheet.cssText=css;else{for(;styleElement.firstChild;)styleElement.removeChild(styleElement.firstChild);styleElement.appendChild(document.createTextNode(css))}}.bind(null,styleElement),function(){removeStyleElement(styleElement)});return update(obj),function(newObj){if(newObj){if(newObj.css===obj.css&&newObj.media===obj.media&&newObj.sourceMap===obj.sourceMap)return;update(obj=newObj)}else remove()}}module.exports=function(list,options){void 0===(options=options||{}).singleton&&(options.singleton=isOldIE()),void 0===options.insertAt&&(options.insertAt="bottom");var styles=listToStyles(list);return addStylesToDom(styles,options),function(newList){for(var mayRemove=[],i=0;i<styles.length;i++){var item=styles[i];(domStyle=stylesInDom[item.id]).refs--,mayRemove.push(domStyle)}newList&&addStylesToDom(listToStyles(newList),options);for(i=0;i<mayRemove.length;i++){var domStyle;if(0===(domStyle=mayRemove[i]).refs){for(var j=0;j<domStyle.parts.length;j++)domStyle.parts[j]();delete stylesInDom[domStyle.id]}}}};var textStore,replaceText=(textStore=[],function(index,replacement){return textStore[index]=replacement,textStore.filter(Boolean).join("\n")});function applyToSingletonTag(styleElement,index,remove,obj){var css=remove?"":obj.css;if(styleElement.styleSheet)styleElement.styleSheet.cssText=replaceText(index,css);else{var cssNode=document.createTextNode(css),childNodes=styleElement.childNodes;childNodes[index]&&styleElement.removeChild(childNodes[index]),childNodes.length?styleElement.insertBefore(cssNode,childNodes[index]):styleElement.appendChild(cssNode)}}},function(module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(gt,task){var self={};function get_progress_polygon_points(){var bar_progress=self.$bar_progress;return[bar_progress.getEndX()-5,bar_progress.getY()+bar_progress.getHeight(),bar_progress.getEndX()+5,bar_progress.getY()+bar_progress.getHeight(),bar_progress.getEndX(),bar_progress.getY()+bar_progress.getHeight()-8.66]}function render_details(){var _get_details_position=get_details_position(),x=_get_details_position.x,y=_get_details_position.y;self.details_box.transform("t"+x+","+y),self.details_box.clear();var html=function(){if(gt.config.custom_popup_html){var _html=gt.config.custom_popup_html;if("string"==typeof _html)return _html;if(function(functionToCheck){return functionToCheck&&"[object Function]"==={}.toString.call(functionToCheck)}(_html))return _html(task)}var start_date=self.task._start.format("MMM D"),end_date=self.task._end.format("MMM D"),heading=self.task.name+": "+start_date+" - "+end_date,line_1="Duration: "+self.duration+" days",line_2=self.task.progress?"Progress: "+self.task.progress:null;return'\n\t\t\t<div class="details-container">\n\t\t\t\t<h5>'+heading+"</h5>\n\t\t\t\t<p>"+line_1+"</p>\n\t\t\t\t"+(line_2?"<p>"+line_2+"</p>":"")+"\n\t\t\t</div>\n\t\t"}(),foreign_object=Snap.parse('<foreignObject width="5000" height="2000">\n\t\t\t\t<body xmlns="http://www.w3.org/1999/xhtml">\n\t\t\t\t\t'+html+"\n\t\t\t\t</body>\n\t\t\t\t</foreignObject>");self.details_box.append(foreign_object)}function get_details_position(){return{x:self.$bar.getEndX()+2,y:self.$bar.getY()-10}}function onstart(){var bar=self.$bar;bar.ox=bar.getX(),bar.oy=bar.getY(),bar.owidth=bar.getWidth(),bar.finaldx=0,run_method_for_dependencies("onstart")}function onmove(dx,dy){var bar=self.$bar;bar.finaldx=get_snap_position(dx),update_bar_position({x:bar.ox+bar.finaldx}),run_method_for_dependencies("onmove",[dx,dy])}function onstop(){self.$bar.finaldx&&(date_changed(),set_action_completed(),run_method_for_dependencies("onstop"))}function onmove_handle_left(dx,dy){var bar=self.$bar;bar.finaldx=get_snap_position(dx),update_bar_position({x:bar.ox+bar.finaldx,width:bar.owidth-bar.finaldx}),run_method_for_dependencies("onmove",[dx,dy])}function onstop_handle_left(){self.$bar.finaldx&&date_changed(),set_action_completed(),run_method_for_dependencies("onstop")}function run_method_for_dependencies(fn,args){var dm=gt.dependency_map;if(dm[self.task.id]){var _iteratorNormalCompletion=!0,_didIteratorError=!1,_iteratorError=void 0;try{for(var _step,_iterator=dm[self.task.id][Symbol.iterator]();!(_iteratorNormalCompletion=(_step=_iterator.next()).done);_iteratorNormalCompletion=!0){var deptask=_step.value,dt=gt.get_bar(deptask);dt[fn].apply(dt,args)}}catch(err){_didIteratorError=!0,_iteratorError=err}finally{try{!_iteratorNormalCompletion&&_iterator.return&&_iterator.return()}finally{if(_didIteratorError)throw _iteratorError}}}}function update_bar_position(_ref){var _ref$x=_ref.x,x=void 0===_ref$x?null:_ref$x,_ref$width=_ref.width,width=void 0===_ref$width?null:_ref$width,bar=self.$bar;if(x){if(!task.dependencies.map(function(dep){return gt.get_bar(dep).$bar.getX()}).reduce(function(prev,curr){return curr<=x},x))return void(width=null);update_attr(bar,"x",x)}width&&width>=gt.config.column_width&&update_attr(bar,"width",width),update_label_position(),function(){var bar=self.$bar;self.handle_group.select(".handle.left").attr({x:bar.getX()+1}),self.handle_group.select(".handle.right").attr({x:bar.getEndX()-9});var handle=self.group.select(".handle.progress");handle&&handle.attr("points",get_progress_polygon_points())}(),self.$bar_progress.attr("x",self.$bar.getX()),self.$bar_progress.attr("width",self.$bar.getWidth()*(self.task.progress/100)),function(){var _iteratorNormalCompletion2=!0,_didIteratorError2=!1,_iteratorError2=void 0;try{for(var _step2,_iterator2=self.arrows[Symbol.iterator]();!(_iteratorNormalCompletion2=(_step2=_iterator2.next()).done);_iteratorNormalCompletion2=!0){_step2.value.update()}}catch(err){_didIteratorError2=!0,_iteratorError2=err}finally{try{!_iteratorNormalCompletion2&&_iterator2.return&&_iterator2.return()}finally{if(_didIteratorError2)throw _iteratorError2}}}(),function(){var _get_details_position2=get_details_position(),x=_get_details_position2.x,y=_get_details_position2.y;self.details_box&&self.details_box.transform("t"+x+","+y)}()}function date_changed(){var _compute_start_end_da=function(){var bar=self.$bar,x_in_units=bar.getX()/gt.config.column_width,new_start_date=gt.gantt_start.clone().add(x_in_units*gt.config.step,"hours"),width_in_units=bar.getWidth()/gt.config.column_width,new_end_date=new_start_date.clone().add(width_in_units*gt.config.step,"hours");return new_end_date.add("-1","seconds"),{new_start_date:new_start_date,new_end_date:new_end_date}}(),new_start_date=_compute_start_end_da.new_start_date,new_end_date=_compute_start_end_da.new_end_date;self.task._start=new_start_date,self.task._end=new_end_date,render_details(),gt.trigger_event("date_change",[self.task,new_start_date,new_end_date])}function set_action_completed(){self.action_completed=!0,setTimeout(function(){return self.action_completed=!1},2e3)}function get_snap_position(dx){var odx=dx,rem=void 0;return gt.view_is("Week")?odx-(rem=dx%(gt.config.column_width/7))+(rem<gt.config.column_width/14?0:gt.config.column_width/7):gt.view_is("Month")?odx-(rem=dx%(gt.config.column_width/30))+(rem<gt.config.column_width/60?0:gt.config.column_width/30):odx-(rem=dx%gt.config.column_width)+(rem<gt.config.column_width/2?0:gt.config.column_width)}function update_attr(element,attr,value){return value=+value,isNaN(value)||element.attr(attr,value),element}function update_label_position(){var bar=self.$bar,label=self.group.select(".bar-label");label.getBBox().width>bar.getWidth()?label.addClass("big").attr("x",bar.getX()+bar.getWidth()+5):label.removeClass("big").attr("x",bar.getX()+bar.getWidth()/2)}return self.onstart=onstart,self.onmove=onmove,self.onstop=onstop,self.onmove_handle_left=onmove_handle_left,self.onstop_handle_left=onstop_handle_left,function(){self.action_completed=!1,self.task=task,self.invalid=self.task.invalid,self.height=gt.config.bar.height,self.x=function(){var x=self.task._start.diff(gt.gantt_start,"hours")/gt.config.step*gt.config.column_width;gt.view_is("Month")&&(x=self.task._start.diff(gt.gantt_start,"days")*gt.config.column_width/30);return x}(),self.y=gt.config.header_height+gt.config.padding+self.task._index*(self.height+gt.config.padding),self.corner_radius=3,self.color=self.task.color,self.duration=(self.task._end.diff(self.task._start,"hours")+24)/gt.config.step,self.width=gt.config.column_width*self.duration,self.progress_width=gt.config.column_width*self.duration*(self.task.progress/100)||0,self.group=gt.canvas.group().addClass("bar-wrapper").addClass(self.task.custom_class||""),self.bar_group=gt.canvas.group().addClass("bar-group").appendTo(self.group),self.handle_group=gt.canvas.group().addClass("handle-group").appendTo(self.group),Snap.plugin(function(Snap,Element,Paper,global,Fragment){Element.prototype.getX=function(){return+this.attr("x")},Element.prototype.getY=function(){return+this.attr("y")},Element.prototype.getWidth=function(){return+this.attr("width")},Element.prototype.getHeight=function(){return+this.attr("height")},Element.prototype.getEndX=function(){return this.getX()+this.getWidth()}}),function(){""==self.color&&(self.color="#b8c2cc");self.$bar=gt.canvas.rect(self.x,self.y,self.width,self.height,self.corner_radius,self.corner_radius).addClass("bar").attr("fill",self.color).appendTo(self.bar_group),self.invalid&&self.$bar.addClass("bar-invalid")}(),function(){if(self.invalid)return;""==self.color&&(self.color="#1b75bb");var color=function(color,percent){var f=parseInt(color.slice(1),16),t=percent<0?0:255,p=percent<0?-1*percent:percent,R=f>>16,G=f>>8&255,B=255&f;return"#"+(16777216+65536*(Math.round((t-R)*p)+R)+256*(Math.round((t-G)*p)+G)+(Math.round((t-B)*p)+B)).toString(16).slice(1)}(self.color,-.25);self.$bar_progress=gt.canvas.rect(self.x,self.y,self.progress_width,self.height,self.corner_radius,self.corner_radius).attr("fill",color).appendTo(self.bar_group)}(),function(){gt.canvas.text(self.x+self.width/2,self.y+self.height/2,self.task.name).addClass("bar-label").appendTo(self.bar_group);new Image;update_label_position()}(),function(){if(self.invalid)return;var bar=self.$bar;gt.canvas.rect(bar.getX()+bar.getWidth()-9,bar.getY()+1,8,self.height-2,self.corner_radius,self.corner_radius).addClass("handle right").appendTo(self.handle_group),gt.canvas.rect(bar.getX()+1,bar.getY()+1,8,self.height-2,self.corner_radius,self.corner_radius).addClass("handle left").appendTo(self.handle_group),self.task.progress&&self.task.progress}(),function(){if(self.invalid)return;(function(){var popover_group=gt.element_groups.details;if(self.details_box=popover_group.select(".details-wrapper[data-task='"+self.task.id+"']"),!self.details_box){self.details_box=gt.canvas.group().addClass("details-wrapper hide").attr("data-task",self.task.id).appendTo(popover_group),render_details();var f=gt.canvas.filter(Snap.filter.shadow(0,1,1,"#666",.6));self.details_box.attr({filter:f})}self.group.click(function(e){self.action_completed||(popover_group.selectAll(".details-wrapper").forEach(function(el){return el.addClass("hide")}),self.details_box.removeClass("hide"))})})(),function(){var _get_handles={left:self.handle_group.select(".handle.left"),right:self.handle_group.select(".handle.right")},left=_get_handles.left,right=_get_handles.right;left.drag(function(dx,dy){onmove_handle_left(dx,dy)},onstart,function(){onstop_handle_left()}),right.drag(function(dx,dy){!function(dx){var bar=self.$bar;bar.finaldx=get_snap_position(dx),update_bar_position({width:bar.owidth+bar.finaldx})}(dx)},onstart,function(){!function(){self.$bar.finaldx&&date_changed();set_action_completed()}()})}(),self.bar_group.drag(onmove,onstart,onstop),function(){var bar=self.$bar,bar_progress=self.$bar_progress,handle=self.group.select(".handle.progress");handle&&handle.drag(function(dx,dy){dx>bar_progress.max_dx&&(dx=bar_progress.max_dx),dx<bar_progress.min_dx&&(dx=bar_progress.min_dx),bar_progress.attr("width",bar_progress.owidth+dx),handle.attr("points",get_progress_polygon_points()),bar_progress.finaldx=dx},function(){bar_progress.finaldx=0,bar_progress.owidth=bar_progress.getWidth(),bar_progress.min_dx=-bar_progress.getWidth(),bar_progress.max_dx=bar.getWidth()-bar_progress.getWidth()},function(){bar_progress.finaldx&&(function(){var new_progress=function(){var progress=self.$bar_progress.getWidth()/self.$bar.getWidth()*100;return parseInt(progress,10)}();self.task.progress=new_progress,render_details(),gt.trigger_event("progress_change",[self.task,new_progress])}(),set_action_completed())})}(),self.group.click(function(){self.group.hasClass("active")&&gt.trigger_event("click",[self.task]),self.action_completed||(gt.unselect_all(),self.group.toggleClass("active"))})}()}(),self},module.exports=exports.default},function(module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(gt,from_task,to_task){var self={};function prepare(){self.start_x=from_task.$bar.getX()+from_task.$bar.getWidth()/2;for(;to_task.$bar.getX()<self.start_x+gt.config.padding&&self.start_x>from_task.$bar.getX()+gt.config.padding;)self.start_x-=10;self.start_y=gt.config.header_height+gt.config.bar.height+(gt.config.padding+gt.config.bar.height)*from_task.task._index+gt.config.padding,self.end_x=to_task.$bar.getX()-gt.config.padding/2,self.end_y=gt.config.header_height+gt.config.bar.height/2+(gt.config.padding+gt.config.bar.height)*to_task.task._index+gt.config.padding;var from_is_below_to=from_task.task._index>to_task.task._index;self.curve=gt.config.arrow.curve,self.clockwise=from_is_below_to?1:0,self.curve_y=from_is_below_to?-self.curve:self.curve,self.offset=from_is_below_to?self.end_y+gt.config.arrow.curve:self.end_y-gt.config.arrow.curve,self.path=Snap.format("M {start_x} {start_y} V {offset} a {curve} {curve} 0 0 {clockwise} {curve} {curve_y} L {end_x} {end_y} m -5 -5 l 5 5 l -5 5",{start_x:self.start_x,start_y:self.start_y,end_x:self.end_x,end_y:self.end_y,offset:self.offset,curve:self.curve,clockwise:self.clockwise,curve_y:self.curve_y}),to_task.$bar.getX()<from_task.$bar.getX()+gt.config.padding&&(self.path=Snap.format("M {start_x} {start_y} v {down_1} a {curve} {curve} 0 0 1 -{curve} {curve} H {left} a {curve} {curve} 0 0 {clockwise} -{curve} {curve_y} V {down_2} a {curve} {curve} 0 0 {clockwise} {curve} {curve_y} L {end_x} {end_y} m -5 -5 l 5 5 l -5 5",{start_x:self.start_x,start_y:self.start_y,end_x:self.end_x,end_y:self.end_y,down_1:gt.config.padding/2-self.curve,down_2:to_task.$bar.getY()+to_task.$bar.getHeight()/2-self.curve_y,left:to_task.$bar.getX()-gt.config.padding,offset:self.offset,curve:self.curve,clockwise:self.clockwise,curve_y:self.curve_y}))}return self.update=function(){prepare(),self.element.attr("d",self.path)},function(){self.from_task=from_task,self.to_task=to_task,prepare(),self.element=gt.canvas.path(self.path).attr("data-from",self.from_task.task.id).attr("data-to",self.to_task.task.id)}(),self},module.exports=exports.default}],installedModules={},__webpack_require__.m=modules,__webpack_require__.c=installedModules,__webpack_require__.p="",__webpack_require__(0);function __webpack_require__(moduleId){if(installedModules[moduleId])return installedModules[moduleId].exports;var module=installedModules[moduleId]={exports:{},id:moduleId,loaded:!1};return modules[moduleId].call(module.exports,module,module.exports,__webpack_require__),module.loaded=!0,module.exports}var modules,installedModules}),jQuery(function($,undefined){$.curCSS=function(element,attrib,val){$(element).css(attrib,val)};var $w=$(window),$d=$(document),$b=$("body"),baseHref=$("base").attr("href"),_nmObj={filters:[],callbacks:{},loadFilter:undefined,modal:!1,closeOnEscape:!0,closeOnClick:!0,useKeyHandler:!1,showCloseButton:!0,closeButton:'<a href="#" class="nyroModalClose nyroModalCloseButton nmReposition" title="close"></a>',stack:!1,nonStackable:"form",header:undefined,footer:undefined,galleryLoop:!0,galleryCounts:!0,ltr:!0,imageRegex:"[^.].(jpg|jpeg|png|tiff|gif|bmp)s*$",selIndicator:"nyroModalSel",swfObjectId:undefined,swf:{allowFullScreen:"true",allowscriptaccess:"always",wmode:"transparent"},store:{},errorMsg:"An error occured",elts:{all:undefined,bg:undefined,load:undefined,cont:undefined,hidden:undefined},sizes:{mode:"custom",initW:undefined,initH:undefined,w:undefined,h:undefined,minW:200,minH:200,wMargin:undefined,hMargin:undefined},anim:{def:undefined,showBg:undefined,hideBg:undefined,showLoad:undefined,hideLoad:undefined,showCont:undefined,hideCont:undefined,showTrans:undefined,hideTrans:undefined,resize:undefined},_open:!1,_bgReady:!1,_opened:!1,_loading:!1,_animated:!1,_transition:!1,_nmOpener:undefined,_nbContentLoading:0,_scripts:"",_scriptsShown:"",saveObj:function(){this.opener.data("nmObj",this)},open:function(){this._nmOpener&&this._nmOpener._close(),this.getInternal()._pushStack(this.opener),this._opened=!1,this._bgReady=!1,this._open=!0,this._initElts(),this._load(),this._nbContentLoading=0,this._callAnim("showBg",$.proxy(function(){this._bgReady=!0,this._nmOpener&&(this._nmOpener._bgReady=!1,this._nmOpener._loading=!1,this._nmOpener._animated=!1,this._nmOpener._opened=!1,this._nmOpener._open=!1,this._nmOpener.elts.cont=this._nmOpener.elts.hidden=this._nmOpener.elts.load=this._nmOpener.elts.bg=this._nmOpener.elts.all=undefined,this._nmOpener.saveObj(),this._nmOpener=undefined),this._contentLoading()},this))},resize:function(recalc){recalc?(this.elts.hidden.append(this.elts.cont.children().first().clone()),this.sizes.initW=this.sizes.w=this.elts.hidden.width(),this.sizes.initH=this.sizes.h=this.elts.hidden.height(),this.elts.hidden.empty()):(this.sizes.w=this.sizes.initW,this.sizes.h=this.sizes.initH+100),this._unreposition(),this.size(),this._callAnim("resize",$.proxy(function(){this._reposition()},this))},size:function(){var maxHeight=this.getInternal().fullSize.viewH-this.sizes.hMargin,maxWidth=this.getInternal().fullSize.viewW-this.sizes.wMargin;"rightHalf"==this.sizes.mode?(this.sizes.h=maxHeight,this.sizes.w=maxWidth/2):(this.sizes.minW&&this.sizes.minW>this.sizes.w&&(this.sizes.w=this.sizes.minW),this.sizes.minH&&this.sizes.minH>this.sizes.h&&(this.sizes.h=this.sizes.minH),(this.sizes.h>maxHeight||this.sizes.w>maxWidth)&&(this.sizes.h=Math.min(this.sizes.h,maxHeight),this.sizes.w=Math.min(this.sizes.w,maxWidth))),this._callFilters("size")},getForNewLinks:function(elt){var ret;return!this.stack||elt&&!this.isStackable(elt)?(ret=$.extend({},this))._nmOpener=this:((ret=$.extend(!0,{},this))._nmOpener=undefined,ret.elts.all=undefined),ret.filters=[],ret.opener=undefined,ret._open=!1,ret},isStackable:function(elt){return!elt.is(this.nonStackable)},keyHandle:function(e){this.keyEvent=e,this._callFilters("keyHandle"),this.keyEvent=undefined,delete this.keyEvent},getInternal:function(){return _internal},_close:function(){this.getInternal()._removeStack(this.opener),this._opened=!1,this._open=!1,this._callFilters("close")},close:function(){this._close(),this._callFilters("beforeClose");var self=this;this._unreposition(),self._callAnim("hideCont",function(){self._callAnim("hideLoad",function(){self._callAnim("hideBg",function(){self._callFilters("afterClose"),self.elts.cont.remove(),self.elts.hidden.remove(),self.elts.load.remove(),self.elts.bg.remove(),self.elts.all.remove(),self.elts.cont=self.elts.hidden=self.elts.load=self.elts.bg=self.elts.all=undefined})})})},_initElts:function(){!this.stack&&1<this.getInternal().stack.length&&(this.elts=this.getInternal().stack[this.getInternal().stack.length-2].nmObj.elts),this.elts.all&&0!=this.elts.all.closest("body").length||(this.elts.all=this.elts.bg=this.elts.cont=this.elts.hidden=this.elts.load=undefined),this.elts.all||(this.elts.all=$("<div />").appendTo(this.getInternal()._container)),this.elts.bg||(this.elts.bg=$("<div />").hide().appendTo(this.elts.all)),this.elts.cont||(this.elts.cont=$("<div />").hide().appendTo(this.elts.all)),this.elts.hidden||(this.elts.hidden=$("<div />").hide().appendTo(this.elts.all)),this.elts.hidden.empty(),this.elts.load||(this.elts.load=$("<div />").hide().appendTo(this.elts.all)),this._callFilters("initElts")},_error:function(){this._callFilters("error")},_setCont:function(html,selector){if(selector){var tmp=[],i=0;html=html.replace(/\r\n/gi,"nyroModalLN").replace(/<script(.|\s)*?\/script>/gi,function(x){return tmp[i]=x,'<pre class=nyroModalScript rel="'+i+++'"></pre>'});var cur=$("<div>"+html+"</div>").find(selector);if(!cur.length)return void this._error();html=cur.html().replace(/<pre class="?nyroModalScript"? rel="?(.?)"?><\/pre>/gi,function(x,y,z){return tmp[y]}).replace(/nyroModalLN/gi,"\r\n")}this.elts.hidden.append(this._filterScripts(html)).prepend(this.header).append(this.footer).wrapInner('<div class="nyroModal'+ucfirst(this.loadFilter)+'" />'),this.sizes.initW=this.sizes.w=this.elts.hidden.width(),this.sizes.initH=this.sizes.h=this.elts.hidden.height();var outer=this.getInternal()._getOuter(this.elts.cont);this.sizes.hMargin=outer.h.total,this.sizes.wMargin=outer.w.total,this.size(),this.loading=!1,this._callFilters("filledContent"),this._contentLoading()},_filterScripts:function(data){if("string"!=typeof data)return data;this._scripts=[],this._scriptsShown=[];for(var pos,pos2,tmp,start=0,endLn="<\/script>".length;-1<(pos=data.indexOf("<script",start));)pos2=data.indexOf("<\/script>")+endLn,(tmp=$(data.substring(pos,pos2))).attr("src")&&"forceLoad"!=tmp.attr("rel")||("shown"==tmp.attr("rev")?this._scriptsShown.push(tmp.get(0)):this._scripts.push(tmp.get(0))),data=data.substring(0,pos)+data.substr(pos2),start=pos;return data},_hasFilter:function(filter){var ret=!1;return $.each(this.filters,function(i,f){ret=ret||f==filter}),ret},_delFilter:function(filter){this.filters=$.map(this.filters,function(v){if(v!=filter)return v})},_callFilters:function(fct){this.getInternal()._debug(fct);var ret=[],self=this;return $.each(this.filters,function(i,f){ret[f]=self._callFilter(f,fct)}),this.callbacks[fct]&&$.isFunction(this.callbacks[fct])&&this.callbacks[fct](this),ret},_callFilter:function(f,fct){return _filters[f]&&_filters[f][fct]&&$.isFunction(_filters[f][fct])?_filters[f][fct](this):undefined},_callAnim:function(fct,clb){if(this.getInternal()._debug(fct),this._callFilters("before"+ucfirst(fct)),!this._animated){this._animated=!0,$.isFunction(clb)||(clb=$.noop);var set=this.anim[fct]||this.anim.def||"basic";_animations[set]&&_animations[set][fct]&&$.isFunction(_animations[set][fct])||(set="basic"),_animations[set][fct](this,$.proxy(function(){this._animated=!1,this._callFilters("after"+ucfirst(fct)),clb()},this))}},_load:function(){this.getInternal()._debug("_load"),!this.loading&&this.loadFilter&&(this.loading=!0,this._callFilter(this.loadFilter,"load"))},_contentLoading:function(){if(!this._animated&&this._bgReady)if(!this._transition&&0<this.elts.cont.html().length&&(this._transition=!0),this._nbContentLoading++,this.loading){if(1==this._nbContentLoading){var outer=this.getInternal()._getOuter(this.elts.load);this.elts.load.css({position:"fixed",top:(this.getInternal().fullSize.viewH-this.elts.load.height()-outer.h.margin)/2,left:(this.getInternal().fullSize.viewW-this.elts.load.width()-outer.w.margin)/2}),this._transition?(this._unreposition(),this._callAnim("showTrans",$.proxy(function(){this._contentLoading()},this))):this._callAnim("showLoad",$.proxy(function(){this._contentLoading()},this))}}else if(!this._opened)if(this._opened=!0,this._transition){var fct=$.proxy(function(){this._writeContent(),this._callFilters("beforeShowCont"),this._callAnim("hideTrans",$.proxy(function(){this._transition=!1,this._callFilters("afterShowCont"),this.elts.cont.append(this._scriptsShown),this._reposition()},this))},this);1==this._nbContentLoading?(this._unreposition(),this._callAnim("showTrans",fct)):fct()}else this._callAnim("hideLoad",$.proxy(function(){this._writeContent(),this._callAnim("showCont",$.proxy(function(){this.elts.cont.append(this._scriptsShown),this._reposition()},this))},this))},_writeContent:function(){this.elts.cont.empty().append(this.elts.hidden.contents()).append(this._scripts).append(this.showCloseButton?this.closeButton:"").css({position:"fixed",width:this.sizes.w,height:this.sizes.h+32,top:(this.getInternal().fullSize.viewH-this.sizes.h-32-this.sizes.hMargin)/2,left:(this.getInternal().fullSize.viewW-this.sizes.w-this.sizes.wMargin)/2})},_reposition:function(){var elts=this.elts.cont.find(".nmReposition");if(elts.length){var space=this.getInternal()._getSpaceReposition();elts.each(function(){var me=$(this),offset=me.offset();me.css({position:"fixed",top:offset.top-space.top,left:offset.left-space.left,visibility:"visible"})}),this.elts.cont.after(elts)}this.elts.cont.css("overflow","auto"),this._callFilters("afterReposition")},_unreposition:function(){this.elts.cont.css("overflow","");var elts=this.elts.all.find(".nmReposition");elts.length&&this.elts.cont.append(elts.removeAttr("style")),this._callFilters("afterUnreposition")}},_internal={firstInit:!0,debug:!1,stack:[],fullSize:{w:0,h:0,wW:0,wH:0,viewW:0,viewH:0},nyroModal:function(opts,fullObj){return _internal.firstInit&&(_internal._container=$("<div />").appendTo($b),$w.smartresize($.proxy(_internal._resize,_internal)),$d.bind("keydown.nyroModal",$.proxy(_internal._keyHandler,_internal)),_internal._calculateFullSize(),_internal.firstInit=!1),this.nmInit(opts,fullObj).each(function(){_internal._init($(this).data("nmObj"))})},nmInit:function(opts,fullObj){return this.each(function(){var me=$(this);fullObj?me.data("nmObj",$.extend(!0,{opener:me},opts)):me.data("nmObj",me.data("nmObj")?$.extend(!0,me.data("nmObj"),opts):$.extend(!0,{opener:me},_nmObj,opts))})},nmCall:function(){return this.trigger("nyroModal")},nmManual:function(url,opts){$('<a href="'+url+'"></a>').nyroModal(opts).trigger("nyroModal")},nmData:function(data,opts){this.nmManual("#",$.extend({data:data},opts))},nmObj:function(opts){$.extend(!0,_nmObj,opts)},nmInternal:function(opts){$.extend(!0,_internal,opts)},nmAnims:function(opts){$.extend(!0,_animations,opts)},nmFilters:function(opts){$.extend(!0,_filters,opts)},nmTop:function(){return _internal.stack.length?_internal.stack[_internal.stack.length-1].nmObj:undefined},_debug:function(msg){this.debug&&window.console&&window.console.log&&window.console.log(msg)},_container:undefined,_init:function(nm){nm.filters=[],$.each(_filters,function(f,obj){obj.is&&$.isFunction(obj.is)&&obj.is(nm)&&nm.filters.push(f)}),nm._callFilters("initFilters"),nm._callFilters("init"),nm.opener.unbind("nyroModal.nyroModal nmClose.nyroModal nmResize.nyroModal").bind({"nyroModal.nyroModal":function(e){return nm.open(),!1},"nmClose.nyroModal":function(){return nm.close(),!1},"nmResize.nyroModal":function(){return nm.resize(),!1}})},_scrollWidth:function(){var scrollbarWidth;if($.browser.msie){var $textarea1=$('<textarea cols="10" rows="2"></textarea>').css({position:"absolute",top:-1e3,left:-1e3}).appendTo($b),$textarea2=$('<textarea cols="10" rows="2" style="overflow: hidden;"></textarea>').css({position:"absolute",top:-1e3,left:-1e3}).appendTo($b);scrollbarWidth=$textarea1.width()-$textarea2.width(),$textarea1.add($textarea2).remove()}else{var $div=$("<div />").css({width:100,height:100,overflow:"auto",position:"absolute",top:-1e3,left:-1e3}).prependTo($b).append("<div />").find("div").css({width:"100%",height:200});scrollbarWidth=100-$div.width(),$div.parent().remove()}return scrollbarWidth}(),_selNyroModal:function(obj){return!!$(obj).data("nmObj")},_selNyroModalOpen:function(obj){var me=$(obj);return!!me.data("nmObj")&&me.data("nmObj")._open},_keyHandler:function(e){var nmTop=$.nmTop();if(nmTop&&nmTop.useKeyHandler)return nmTop.keyHandle(e)},_pushStack:function(obj){this.stack=$.map(this.stack,function(elA){if(elA.nmOpener!=obj.get(0))return elA}),this.stack.push({nmOpener:obj.get(0),nmObj:$(obj).data("nmObj")})},_removeStack:function(obj){this.stack=$.map(this.stack,function(elA){if(elA.nmOpener!=obj.get(0))return elA})},_resize:function(){var opens=$(":nmOpen").each(function(){$(this).data("nmObj")._unreposition()});this._calculateFullSize(),opens.trigger("nmResize")},_calculateFullSize:function(){this.fullSize={w:$d.width(),h:$d.height(),wW:$w.width(),wH:$w.height()},this.fullSize.viewW=Math.min(this.fullSize.w,this.fullSize.wW),this.fullSize.viewH=Math.min(this.fullSize.h,this.fullSize.wH)},_getCurCSS:function(elm,name){var ret=parseInt($.curCSS(elm,name,!0));return isNaN(ret)?0:ret},_getOuter:function(elm){elm=elm.get(0);var ret={h:{margin:this._getCurCSS(elm,"marginTop")+this._getCurCSS(elm,"marginBottom"),border:this._getCurCSS(elm,"borderTopWidth")+this._getCurCSS(elm,"borderBottomWidth"),padding:this._getCurCSS(elm,"paddingTop")+this._getCurCSS(elm,"paddingBottom")},w:{margin:this._getCurCSS(elm,"marginLeft")+this._getCurCSS(elm,"marginRight"),border:this._getCurCSS(elm,"borderLeftWidth")+this._getCurCSS(elm,"borderRightWidth"),padding:this._getCurCSS(elm,"paddingLeft")+this._getCurCSS(elm,"paddingRight")}};return ret.h.outer=ret.h.margin+ret.h.border,ret.w.outer=ret.w.margin+ret.w.border,ret.h.inner=ret.h.padding+ret.h.border,ret.w.inner=ret.w.padding+ret.w.border,ret.h.total=ret.h.outer+ret.h.padding,ret.w.total=ret.w.outer+ret.w.padding,ret},_getSpaceReposition:function(){var outer=this._getOuter($b),ie7=$.browser.msie&&$.browser.version<8&&!(screen.height<=$w.height()+23);return{top:$w.scrollTop()-(ie7?0:outer.h.border/2),left:$w.scrollLeft()-(ie7?0:outer.w.border/2)}},_getHash:function(url){if("string"==typeof url){var hashPos=url.indexOf("#");if(-1<hashPos)return url.substring(hashPos)}return""},_extractUrl:function(url){var ret={url:undefined,sel:undefined};if(url){var hash=this._getHash(url),hashLoc=this._getHash(window.location.href),curLoc=window.location.href.substring(0,window.location.href.length-hashLoc.length),req=url.substring(0,url.length-hash.length);ret.sel=hash,req!=curLoc&&req!=baseHref&&(ret.url=req)}return ret}},_animations={basic:{showBg:function(nm,clb){nm.elts.bg.css({opacity:.7}).show(),clb()},hideBg:function(nm,clb){nm.elts.bg.hide(),clb()},showLoad:function(nm,clb){nm.elts.load.show(),clb()},hideLoad:function(nm,clb){nm.elts.load.hide(),clb()},showCont:function(nm,clb){nm.elts.cont.show(),clb()},hideCont:function(nm,clb){nm.elts.cont.hide(),clb()},showTrans:function(nm,clb){nm.elts.cont.hide(),nm.elts.load.show(),clb()},hideTrans:function(nm,clb){nm.elts.cont.show(),nm.elts.load.hide(),clb()},resize:function(nm,clb){nm.elts.cont.css({width:nm.sizes.w,height:nm.sizes.h,top:(nm.getInternal().fullSize.viewH-nm.sizes.h-nm.sizes.hMargin)/2,left:(nm.getInternal().fullSize.viewW-nm.sizes.w-nm.sizes.wMargin)/2}),clb()}}},_filters={basic:{is:function(nm){return!0},init:function(nm){"modal"==nm.opener.attr("rev")&&(nm.modal=!0),nm.modal&&(nm.closeOnEscape=nm.closeOnClick=nm.showCloseButton=!1),nm.closeOnEscape&&(nm.useKeyHandler=!0)},initElts:function(nm){nm.elts.bg.addClass("nyroModalBg"),nm.closeOnClick&&nm.elts.bg.unbind("click.nyroModal").bind("click.nyroModal",function(e){e.preventDefault(),nm.close()}),nm.elts.cont.addClass("nyroModalCont"),nm.elts.hidden.addClass("nyroModalCont nyroModalHidden"),nm.elts.load.addClass("nyroModalCont nyroModalLoad")},error:function(nm){nm.elts.hidden.addClass("nyroModalError"),nm.elts.cont.addClass("nyroModalError"),nm._setCont(nm.errorMsg)},beforeShowCont:function(nm){nm.elts.cont.find(".nyroModal").each(function(){var cur=$(this);cur.nyroModal(nm.getForNewLinks(cur),!0)}).end().find(".nyroModalClose").bind("click.nyroModal",function(e){e.preventDefault(),nm.close()})},keyHandle:function(nm){27==nm.keyEvent.keyCode&&nm.closeOnEscape&&(nm.keyEvent.preventDefault(),nm.close())}},custom:{is:function(nm){return!0}}};$.fn.extend({nm:_internal.nyroModal,nyroModal:_internal.nyroModal,nmInit:_internal.nmInit,nmCall:_internal.nmCall}),$.extend({nmManual:_internal.nmManual,nmData:_internal.nmData,nmObj:_internal.nmObj,nmInternal:_internal.nmInternal,nmAnims:_internal.nmAnims,nmFilters:_internal.nmFilters,nmTop:_internal.nmTop}),$.expr[":"].nyroModal=$.expr[":"].nm=_internal._selNyroModal,$.expr[":"].nmOpen=_internal._selNyroModalOpen}),function($,sr){jQuery.fn[sr]=function(fn){return fn?this.bind("resize",function(func,threshold,execAsap){var timeout;return function(){var obj=this,args=arguments;timeout?clearTimeout(timeout):execAsap&&func.apply(obj,args),timeout=setTimeout(function(){execAsap||func.apply(obj,args),timeout=null},threshold||100)}}(fn)):this.trigger(sr)}}(jQuery,"smartresize"),jQuery(function($,undefined){$.nmAnims({fade:{showBg:function(nm,clb){nm.elts.bg.fadeTo(250,.7,clb)},hideBg:function(nm,clb){nm.elts.bg.fadeOut(clb)},showLoad:function(nm,clb){nm.elts.load.fadeIn(clb)},hideLoad:function(nm,clb){nm.elts.load.fadeOut(clb)},showCont:function(nm,clb){nm.elts.cont.fadeIn(clb)},hideCont:function(nm,clb){nm.elts.cont.css("overflow","hidden").fadeOut(clb)},showTrans:function(nm,clb){nm.elts.load.css({position:nm.elts.cont.css("position"),top:nm.elts.cont.css("top"),left:nm.elts.cont.css("left"),width:nm.elts.cont.css("width"),height:nm.elts.cont.css("height"),marginTop:nm.elts.cont.css("marginTop"),marginLeft:nm.elts.cont.css("marginLeft")}).fadeIn(function(){nm.elts.cont.hide(),clb()})},hideTrans:function(nm,clb){nm.elts.cont.css("visibility","hidden").show(),nm.elts.load.css("position",nm.elts.cont.css("position")).animate({top:nm.elts.cont.css("top"),left:nm.elts.cont.css("left"),width:nm.elts.cont.css("width"),height:nm.elts.cont.css("height"),marginTop:nm.elts.cont.css("marginTop"),marginLeft:nm.elts.cont.css("marginLeft")},function(){nm.elts.cont.css("visibility",""),nm.elts.load.fadeOut(clb)})},resize:function(nm,clb){nm.elts.cont.animate({width:nm.sizes.w,height:nm.sizes.h,top:(nm.getInternal().fullSize.viewH-nm.sizes.h-nm.sizes.hMargin)/2,left:(nm.getInternal().fullSize.viewW-nm.sizes.w-nm.sizes.wMargin)/2},clb)}}}),$.nmObj({anim:{def:"fade"}})}),jQuery(function($,undefined){$.nmFilters({title:{is:function(nm){return nm.opener.is("[title]")},beforeShowCont:function(nm){nm.elts.cont.offset();nm.store.title=$("<h1 />",{text:nm.opener.attr("title")}).addClass("nyroModalTitle nmReposition"),nm.elts.cont.prepend(nm.store.title)},close:function(nm){nm.store.title&&(nm.store.title.remove(),nm.store.title=undefined,delete nm.store.title)}}})}),jQuery(function($,undefined){$.nmFilters({gallery:{is:function(nm){var ret=nm.opener.is("[rel]:not([rel=external], [rel=nofollow])");if(ret){var rel=nm.opener.attr("rel"),indexSpace=rel.indexOf(" "),gal=0<indexSpace?rel.substr(0,indexSpace):rel;$('[href][rel="'+gal+'"], [href][rel^="'+gal+' "]').length<2&&(ret=!1),ret&&nm.galleryCounts&&!nm._hasFilter("title")&&nm.filters.push("title")}return ret},init:function(nm){nm.useKeyHandler=!0},keyHandle:function(nm){!nm._animated&&nm._opened&&(39==nm.keyEvent.keyCode||40==nm.keyEvent.keyCode?(nm.keyEvent.preventDefault(),nm._callFilters("galleryNext")):37!=nm.keyEvent.keyCode&&38!=nm.keyEvent.keyCode||(nm.keyEvent.preventDefault(),nm._callFilters("galleryPrev")))},initElts:function(nm){var rel=nm.opener.attr("rel"),indexSpace=rel.indexOf(" ");nm.store.gallery=0<indexSpace?rel.substr(0,indexSpace):rel,nm.store.galleryLinks=$('[href][rel="'+nm.store.gallery+'"], [href][rel^="'+nm.store.gallery+' "]'),nm.store.galleryIndex=nm.store.galleryLinks.index(nm.opener)},beforeShowCont:function(nm){if(nm.galleryCounts&&nm.store.title&&nm.store.galleryLinks&&1<nm.store.galleryLinks.length){var curTitle=nm.store.title.html();nm.store.title.html((curTitle.length?curTitle+" - ":"")+(nm.store.galleryIndex+1)+"/"+nm.store.galleryLinks.length)}},filledContent:function(nm){var link=this._getGalleryLink(nm,-1),append=nm.elts.hidden.find(" > div");link&&$("<a />",{text:"previous",href:"#"}).addClass("nyroModalPrev").bind("click",function(e){e.preventDefault(),nm._callFilters("galleryPrev")}).appendTo(append),(link=this._getGalleryLink(nm,1))&&$("<a />",{text:"next",href:"#"}).addClass("nyroModalNext").bind("click",function(e){e.preventDefault(),nm._callFilters("galleryNext")}).appendTo(append)},close:function(nm){nm.store.gallery=undefined,nm.store.galleryLinks=undefined,nm.store.galleryIndex=undefined,delete nm.store.gallery,delete nm.store.galleryLinks,delete nm.store.galleryIndex,nm.elts.cont&&nm.elts.cont.find(".nyroModalNext, .nyroModalPrev").remove()},galleryNext:function(nm){this._getGalleryLink(nm,1).nyroModal(nm.getForNewLinks(),!0).click()},galleryPrev:function(nm){this._getGalleryLink(nm,-1).nyroModal(nm.getForNewLinks(),!0).click()},_getGalleryLink:function(nm,dir){if(nm.store.gallery){nm.ltr||(dir*=-1);var index=nm.store.galleryIndex+dir;if(nm.store.galleryLinks&&0<=index&&index<nm.store.galleryLinks.length)return nm.store.galleryLinks.eq(index);if(nm.galleryLoop&&nm.store.galleryLinks)return nm.store.galleryLinks.eq(index<0?nm.store.galleryLinks.length-1:0)}return undefined}}})}),jQuery(function($,undefined){$.nmFilters({link:{is:function(nm){var ret=nm.opener.is("[href]");return ret&&(nm.store.link=nm.getInternal()._extractUrl(nm.opener.attr("href"))),ret},init:function(nm){nm.loadFilter="link",nm.opener.unbind("click.nyroModal").bind("click.nyroModal",function(e){e.preventDefault(),nm.opener.trigger("nyroModal")})},load:function(nm){$.ajax({url:nm.store.link.url,data:nm.store.link.sel?[{name:nm.selIndicator,value:nm.store.link.sel.substring(1)}]:undefined,success:function(data){nm._setCont(data,nm.store.link.sel)},error:function(){nm._error()}})}}})}),jQuery(function($,undefined){$.nmFilters({dom:{is:function(nm){return nm._hasFilter("link")&&!nm.store.link.url&&nm.store.link.sel},init:function(nm){nm.loadFilter="dom"},load:function(nm){nm.store.domEl=$(nm.store.link.sel),nm.store.domEl.length?nm._setCont(nm.store.domEl.contents()):nm._error()},close:function(nm){nm.store.domEl&&nm.elts.cont&&nm.store.domEl.append(nm.elts.cont.find(".nyroModalDom").contents())}}})}),jQuery(function($,undefined){$.nmFilters({data:{is:function(nm){var ret=!!nm.data;return ret&&nm._delFilter("dom"),ret},init:function(nm){nm.loadFilter="data"},load:function(nm){nm._setCont(nm.data)}}})}),jQuery(function($,undefined){$.nmFilters({image:{is:function(nm){return!!(new RegExp(nm.imageRegex,"i").test(nm.opener.attr("href"))||nm.opener.attr("href")!=undefined&&0<nm.opener.attr("href").indexOf("download.php"))},init:function(nm){nm.loadFilter="image"},load:function(nm){var url=nm.opener.attr("href");$("<img />").load(function(){nm.elts.cont.addClass("nyroModalImg"),nm.elts.hidden.addClass("nyroModalImg"),nm._setCont(this)}).error(function(){nm._error()}).attr("src",url)},size:function(nm){if(nm.sizes.w!=nm.sizes.initW||nm.sizes.h!=nm.sizes.initH){var ratio=Math.min(nm.sizes.w/nm.sizes.initW,nm.sizes.h/nm.sizes.initH);nm.sizes.w=nm.sizes.initW*ratio,nm.sizes.h=nm.sizes.initH*ratio}(nm.loading?nm.elts.hidden.find("img"):nm.elts.cont.find("img")).attr({width:nm.sizes.w,height:nm.sizes.h})},close:function(nm){nm.elts.cont&&(nm.elts.cont.removeClass("nyroModalImg"),nm.elts.hidden.removeClass("nyroModalImg"))}}})}),jQuery(function($,undefined){$.nmFilters({swf:{idCounter:1,is:function(nm){return nm._hasFilter("link")&&nm.opener.is('[href$=".swf"]')},init:function(nm){nm.loadFilter="swf"},load:function(nm){nm.swfObjectId||(nm.swfObjectId="nyroModalSwf-"+this.idCounter++);var url=nm.store.link.url,cont='<div><object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" id="'+nm.swfObjectId+'" width="'+nm.sizes.w+'" height="'+nm.sizes.h+'"><param name="movie" value="'+url+'"></param>',tmp="";$.each(nm.swf,function(name,val){cont+='<param name="'+name+'" value="'+val+'"></param>',tmp+=" "+name+'="'+val+'"'}),cont+='<embed src="'+url+'" type="application/x-shockwave-flash" width="'+nm.sizes.w+'" height="'+nm.sizes.h+'"'+tmp+"></embed></object></div>",nm._setCont(cont)}}})}),jQuery(function($,undefined){$.nmFilters({form:{is:function(nm){var ret=nm.opener.is("form");return ret&&(nm.store.form=nm.getInternal()._extractUrl(nm.opener.attr("action"))),ret},init:function(nm){nm.loadFilter="form",nm.opener.unbind("submit.nyroModal").bind("submit.nyroModal",function(e){e.preventDefault(),nm.opener.trigger("nyroModal")})},load:function(nm){var data=nm.opener.serializeArray();nm.store.form.sel&&data.push({name:nm.selIndicator,value:nm.store.form.sel.substring(1)}),$.ajax({url:nm.store.form.url,data:data,type:nm.opener.attr("method")?nm.opener.attr("method"):"get",success:function(data){nm._setCont(data,nm.store.form.sel)},error:function(){nm._error()}})}}})}),jQuery(function($,undefined){$.nmFilters({formFile:{is:function(nm){var ret=nm.opener.is('form[enctype="multipart/form-data"]');return ret&&(nm._delFilter("form"),nm.store.form||(nm.store.form=nm.getInternal()._extractUrl(nm.opener.attr("action")))),ret},init:function(nm){nm.loadFilter="formFile",nm.store.formFileLoading=!1,nm.opener.unbind("submit.nyroModal").bind("submit.nyroModal",function(e){nm.store.formFileIframe?nm.store.formFileLoading=!0:(e.preventDefault(),nm.opener.trigger("nyroModal"))})},initElts:function(nm){var inputSel;function rmFormFileElts(){inputSel&&(inputSel.remove(),inputSel=undefined,delete inputSel),nm.store.formFileIframe.attr("src","about:blank").remove(),nm.store.formFileIframe=undefined,delete nm.store.formFileIframe}nm.store.form.sel&&(inputSel=$("<input />",{type:"hidden",name:nm.selIndicator,value:nm.store.form.sel.substring(1)}).appendTo(nm.opener)),nm.store.formFileIframe=$('<iframe name="nyroModalFormFile" src="javascript:\'\';" id="nyromodal-iframe-'+(new Date).getTime()+'"></iframe>').hide().load(function(){if(nm.store.formFileLoading){nm.store.formFileLoading=!1;var content=nm.store.formFileIframe.unbind("load error").contents().find("body").not("script[src]");if(content&&content.html()&&content.html().length)rmFormFileElts(),nm._setCont(content.html(),nm.store.form.sel);else{var nbTry=0;fct=function(){nbTry++;var content=nm.store.formFileIframe.unbind("load error").contents().find("body").not("script[src]");content&&content.html()&&content.html().length?(nm._setCont(content.html(),nm.store.form.sel),rmFormFileElts()):nbTry<5?setTimeout(fct,25):(rmFormFileElts(),nm._error())},setTimeout(fct,25)}}}).error(function(){rmFormFileElts(),nm._error()}),nm.elts.all.append(nm.store.formFileIframe),nm.opener.attr("target","nyroModalFormFile").submit()},close:function(nm){nm.store.formFileLoading=!1,nm.store.formFileIframe&&(nm.store.formFileIframe.remove(),nm.store.formFileIframe=undefined,delete nm.store.formFileIframe)}}})}),jQuery(function($,undefined){$.nmFilters({iframe:{is:function(nm){var target=nm.opener.attr("target")||"",rel=nm.opener.attr("rel")||"",opener=nm.opener.get(0);return!nm._hasFilter("image")&&("_blank"==target.toLowerCase()||-1<rel.toLowerCase().indexOf("external")||opener.hostname&&opener.hostname.replace(/:\d*$/,"")!=window.location.hostname.replace(/:\d*$/,""))},init:function(nm){nm.loadFilter="iframe"},load:function(nm){nm.store.iframe=$('<iframe src="javascript:\'\';" id="nyromodal-iframe-'+(new Date).getTime()+'"></iframe>'),nm._setCont(nm.store.iframe)},afterShowCont:function(nm){nm.store.iframe.attr("src",nm.opener.attr("href"))},close:function(nm){nm.store.iframe&&(nm.store.iframe.remove(),nm.store.iframe=undefined,delete nm.store.iframe)}}})}),jQuery(function($,undefined){$.nmFilters({iframeForm:{is:function(nm){var ret=nm._hasFilter("iframe")&&nm.opener.is("form");return ret&&(nm._delFilter("iframe"),nm._delFilter("form")),ret},init:function(nm){nm.loadFilter="iframeForm",nm.store.iframeFormLoading=!1,nm.store.iframeFormOrgTarget=nm.opener.attr("target"),nm.opener.unbind("submit.nyroModal").bind("submit.nyroModal",function(e){nm.store.iframeFormIframe?nm.store.iframeFormLoading=!0:(e.preventDefault(),nm.opener.trigger("nyroModal"))})},load:function(nm){nm.store.iframeFormIframe=$('<iframe name="nyroModalIframeForm" src="javascript:\'\';" id="nyromodal-iframe-'+(new Date).getTime()+'"></iframe>'),nm._setCont(nm.store.iframeFormIframe)},afterShowCont:function(nm){nm.opener.attr("target","nyroModalIframeForm").submit()},close:function(nm){nm.store.iframeFormOrgTarget?nm.opener.attr("target",nm.store.iframeFormOrgTarget):nm.opener.removeAttr("target"),delete nm.store.formFileLoading,delete nm.store.iframeFormOrgTarget,nm.store.iframeFormIframe&&(nm.store.iframeFormIframe.remove(),nm.store.iframeFormIframe=undefined,delete nm.store.iframeFormIframe)}}})}),jQuery(function($,undefined){$.nmFilters({embedly:{is:function(nm){var ret=nm._hasFilter("link")&&nm.opener.attr("href")&&null!==nm.opener.attr("href").match(/http:\/\/(.*youtube\.com\/watch.*|.*\.youtube\.com\/v\/.*|youtu\.be\/.*|.*\.youtube\.com\/user\/.*|.*\.youtube\.com\/.*#.*\/.*|m\.youtube\.com\/watch.*|m\.youtube\.com\/index.*|.*\.youtube\.com\/profile.*|.*justin\.tv\/.*|.*justin\.tv\/.*\/b\/.*|.*justin\.tv\/.*\/w\/.*|www\.ustream\.tv\/recorded\/.*|www\.ustream\.tv\/channel\/.*|www\.ustream\.tv\/.*|qik\.com\/video\/.*|qik\.com\/.*|qik\.ly\/.*|.*revision3\.com\/.*|.*\.dailymotion\.com\/video\/.*|.*\.dailymotion\.com\/.*\/video\/.*|www\.collegehumor\.com\/video:.*|.*twitvid\.com\/.*|www\.break\.com\/.*\/.*|vids\.myspace\.com\/index\.cfm\?fuseaction=vids\.individual&videoid.*|www\.myspace\.com\/index\.cfm\?fuseaction=.*&videoid.*|www\.metacafe\.com\/watch\/.*|www\.metacafe\.com\/w\/.*|blip\.tv\/file\/.*|.*\.blip\.tv\/file\/.*|video\.google\.com\/videoplay\?.*|.*revver\.com\/video\/.*|video\.yahoo\.com\/watch\/.*\/.*|video\.yahoo\.com\/network\/.*|.*viddler\.com\/explore\/.*\/videos\/.*|liveleak\.com\/view\?.*|www\.liveleak\.com\/view\?.*|animoto\.com\/play\/.*|dotsub\.com\/view\/.*|www\.overstream\.net\/view\.php\?oid=.*|www\.livestream\.com\/.*|www\.worldstarhiphop\.com\/videos\/video.*\.php\?v=.*|worldstarhiphop\.com\/videos\/video.*\.php\?v=.*|teachertube\.com\/viewVideo\.php.*|www\.teachertube\.com\/viewVideo\.php.*|www1\.teachertube\.com\/viewVideo\.php.*|www2\.teachertube\.com\/viewVideo\.php.*|bambuser\.com\/v\/.*|bambuser\.com\/channel\/.*|bambuser\.com\/channel\/.*\/broadcast\/.*|www\.schooltube\.com\/video\/.*\/.*|bigthink\.com\/ideas\/.*|bigthink\.com\/series\/.*|sendables\.jibjab\.com\/view\/.*|sendables\.jibjab\.com\/originals\/.*|www\.xtranormal\.com\/watch\/.*|socialcam\.com\/v\/.*|www\.socialcam\.com\/v\/.*|dipdive\.com\/media\/.*|dipdive\.com\/member\/.*\/media\/.*|dipdive\.com\/v\/.*|.*\.dipdive\.com\/media\/.*|.*\.dipdive\.com\/v\/.*|v\.youku\.com\/v_show\/.*\.html|v\.youku\.com\/v_playlist\/.*\.html|www\.snotr\.com\/video\/.*|snotr\.com\/video\/.*|video\.jardenberg\.se\/.*|.*yfrog\..*\/.*|tweetphoto\.com\/.*|www\.flickr\.com\/photos\/.*|flic\.kr\/.*|twitpic\.com\/.*|www\.twitpic\.com\/.*|twitpic\.com\/photos\/.*|www\.twitpic\.com\/photos\/.*|.*imgur\.com\/.*|.*\.posterous\.com\/.*|post\.ly\/.*|twitgoo\.com\/.*|i.*\.photobucket\.com\/albums\/.*|s.*\.photobucket\.com\/albums\/.*|phodroid\.com\/.*\/.*\/.*|www\.mobypicture\.com\/user\/.*\/view\/.*|moby\.to\/.*|xkcd\.com\/.*|www\.xkcd\.com\/.*|imgs\.xkcd\.com\/.*|www\.asofterworld\.com\/index\.php\?id=.*|www\.asofterworld\.com\/.*\.jpg|asofterworld\.com\/.*\.jpg|www\.qwantz\.com\/index\.php\?comic=.*|23hq\.com\/.*\/photo\/.*|www\.23hq\.com\/.*\/photo\/.*|.*dribbble\.com\/shots\/.*|drbl\.in\/.*|.*\.smugmug\.com\/.*|.*\.smugmug\.com\/.*#.*|emberapp\.com\/.*\/images\/.*|emberapp\.com\/.*\/images\/.*\/sizes\/.*|emberapp\.com\/.*\/collections\/.*\/.*|emberapp\.com\/.*\/categories\/.*\/.*\/.*|embr\.it\/.*|picasaweb\.google\.com.*\/.*\/.*#.*|picasaweb\.google\.com.*\/lh\/photo\/.*|picasaweb\.google\.com.*\/.*\/.*|dailybooth\.com\/.*\/.*|brizzly\.com\/pic\/.*|pics\.brizzly\.com\/.*\.jpg|img\.ly\/.*|www\.tinypic\.com\/view\.php.*|tinypic\.com\/view\.php.*|www\.tinypic\.com\/player\.php.*|tinypic\.com\/player\.php.*|www\.tinypic\.com\/r\/.*\/.*|tinypic\.com\/r\/.*\/.*|.*\.tinypic\.com\/.*\.jpg|.*\.tinypic\.com\/.*\.png|meadd\.com\/.*\/.*|meadd\.com\/.*|.*\.deviantart\.com\/art\/.*|.*\.deviantart\.com\/gallery\/.*|.*\.deviantart\.com\/#\/.*|fav\.me\/.*|.*\.deviantart\.com|.*\.deviantart\.com\/gallery|.*\.deviantart\.com\/.*\/.*\.jpg|.*\.deviantart\.com\/.*\/.*\.gif|.*\.deviantart\.net\/.*\/.*\.jpg|.*\.deviantart\.net\/.*\/.*\.gif|plixi\.com\/p\/.*|plixi\.com\/profile\/home\/.*|plixi\.com\/.*|www\.fotopedia\.com\/.*\/.*|fotopedia\.com\/.*\/.*|photozou\.jp\/photo\/show\/.*\/.*|photozou\.jp\/photo\/photo_only\/.*\/.*|instagr\.am\/p\/.*|instagram\.com\/p\/.*|skitch\.com\/.*\/.*\/.*|img\.skitch\.com\/.*|https:\/\/skitch\.com\/.*\/.*\/.*|https:\/\/img\.skitch\.com\/.*|share\.ovi\.com\/media\/.*\/.*|www\.questionablecontent\.net\/|questionablecontent\.net\/|www\.questionablecontent\.net\/view\.php.*|questionablecontent\.net\/view\.php.*|questionablecontent\.net\/comics\/.*\.png|www\.questionablecontent\.net\/comics\/.*\.png|picplz\.com\/user\/.*\/pic\/.*\/|twitrpix\.com\/.*|.*\.twitrpix\.com\/.*|www\.someecards\.com\/.*\/.*|someecards\.com\/.*\/.*|some\.ly\/.*|www\.some\.ly\/.*|pikchur\.com\/.*|achewood\.com\/.*|www\.achewood\.com\/.*|achewood\.com\/index\.php.*|www\.achewood\.com\/index\.php.*|www\.whosay\.com\/content\/.*|www\.whosay\.com\/photos\/.*|www\.whosay\.com\/videos\/.*|say\.ly\/.*|www\.whitehouse\.gov\/photos-and-video\/video\/.*|www\.whitehouse\.gov\/video\/.*|wh\.gov\/photos-and-video\/video\/.*|wh\.gov\/video\/.*|www\.hulu\.com\/watch.*|www\.hulu\.com\/w\/.*|hulu\.com\/watch.*|hulu\.com\/w\/.*|.*crackle\.com\/c\/.*|www\.fancast\.com\/.*\/videos|www\.funnyordie\.com\/videos\/.*|www\.funnyordie\.com\/m\/.*|funnyordie\.com\/videos\/.*|funnyordie\.com\/m\/.*|www\.vimeo\.com\/groups\/.*\/videos\/.*|www\.vimeo\.com\/.*|vimeo\.com\/groups\/.*\/videos\/.*|vimeo\.com\/.*|vimeo\.com\/m\/#\/.*|www\.ted\.com\/talks\/.*\.html.*|www\.ted\.com\/talks\/lang\/.*\/.*\.html.*|www\.ted\.com\/index\.php\/talks\/.*\.html.*|www\.ted\.com\/index\.php\/talks\/lang\/.*\/.*\.html.*|.*nfb\.ca\/film\/.*|www\.thedailyshow\.com\/watch\/.*|www\.thedailyshow\.com\/full-episodes\/.*|www\.thedailyshow\.com\/collection\/.*\/.*\/.*|movies\.yahoo\.com\/movie\/.*\/video\/.*|movies\.yahoo\.com\/movie\/.*\/trailer|movies\.yahoo\.com\/movie\/.*\/video|www\.colbertnation\.com\/the-colbert-report-collections\/.*|www\.colbertnation\.com\/full-episodes\/.*|www\.colbertnation\.com\/the-colbert-report-videos\/.*|www\.comedycentral\.com\/videos\/index\.jhtml\?.*|www\.theonion\.com\/video\/.*|theonion\.com\/video\/.*|wordpress\.tv\/.*\/.*\/.*\/.*\/|www\.traileraddict\.com\/trailer\/.*|www\.traileraddict\.com\/clip\/.*|www\.traileraddict\.com\/poster\/.*|www\.escapistmagazine\.com\/videos\/.*|www\.trailerspy\.com\/trailer\/.*\/.*|www\.trailerspy\.com\/trailer\/.*|www\.trailerspy\.com\/view_video\.php.*|www\.atom\.com\/.*\/.*\/|fora\.tv\/.*\/.*\/.*\/.*|www\.spike\.com\/video\/.*|www\.gametrailers\.com\/video\/.*|gametrailers\.com\/video\/.*|www\.koldcast\.tv\/video\/.*|www\.koldcast\.tv\/#video:.*|techcrunch\.tv\/watch.*|techcrunch\.tv\/.*\/watch.*|mixergy\.com\/.*|video\.pbs\.org\/video\/.*|www\.zapiks\.com\/.*|tv\.digg\.com\/diggnation\/.*|tv\.digg\.com\/diggreel\/.*|tv\.digg\.com\/diggdialogg\/.*|www\.trutv\.com\/video\/.*|www\.nzonscreen\.com\/title\/.*|nzonscreen\.com\/title\/.*|app\.wistia\.com\/embed\/medias\/.*|https:\/\/app\.wistia\.com\/embed\/medias\/.*|hungrynation\.tv\/.*\/episode\/.*|www\.hungrynation\.tv\/.*\/episode\/.*|hungrynation\.tv\/episode\/.*|www\.hungrynation\.tv\/episode\/.*|indymogul\.com\/.*\/episode\/.*|www\.indymogul\.com\/.*\/episode\/.*|indymogul\.com\/episode\/.*|www\.indymogul\.com\/episode\/.*|channelfrederator\.com\/.*\/episode\/.*|www\.channelfrederator\.com\/.*\/episode\/.*|channelfrederator\.com\/episode\/.*|www\.channelfrederator\.com\/episode\/.*|tmiweekly\.com\/.*\/episode\/.*|www\.tmiweekly\.com\/.*\/episode\/.*|tmiweekly\.com\/episode\/.*|www\.tmiweekly\.com\/episode\/.*|99dollarmusicvideos\.com\/.*\/episode\/.*|www\.99dollarmusicvideos\.com\/.*\/episode\/.*|99dollarmusicvideos\.com\/episode\/.*|www\.99dollarmusicvideos\.com\/episode\/.*|ultrakawaii\.com\/.*\/episode\/.*|www\.ultrakawaii\.com\/.*\/episode\/.*|ultrakawaii\.com\/episode\/.*|www\.ultrakawaii\.com\/episode\/.*|barelypolitical\.com\/.*\/episode\/.*|www\.barelypolitical\.com\/.*\/episode\/.*|barelypolitical\.com\/episode\/.*|www\.barelypolitical\.com\/episode\/.*|barelydigital\.com\/.*\/episode\/.*|www\.barelydigital\.com\/.*\/episode\/.*|barelydigital\.com\/episode\/.*|www\.barelydigital\.com\/episode\/.*|threadbanger\.com\/.*\/episode\/.*|www\.threadbanger\.com\/.*\/episode\/.*|threadbanger\.com\/episode\/.*|www\.threadbanger\.com\/episode\/.*|vodcars\.com\/.*\/episode\/.*|www\.vodcars\.com\/.*\/episode\/.*|vodcars\.com\/episode\/.*|www\.vodcars\.com\/episode\/.*|confreaks\.net\/videos\/.*|www\.confreaks\.net\/videos\/.*|video\.allthingsd\.com\/video\/.*|aniboom\.com\/animation-video\/.*|www\.aniboom\.com\/animation-video\/.*|clipshack\.com\/Clip\.aspx\?.*|www\.clipshack\.com\/Clip\.aspx\?.*|grindtv\.com\/.*\/video\/.*|www\.grindtv\.com\/.*\/video\/.*|ifood\.tv\/recipe\/.*|ifood\.tv\/video\/.*|ifood\.tv\/channel\/user\/.*|www\.ifood\.tv\/recipe\/.*|www\.ifood\.tv\/video\/.*|www\.ifood\.tv\/channel\/user\/.*|logotv\.com\/video\/.*|www\.logotv\.com\/video\/.*|lonelyplanet\.com\/Clip\.aspx\?.*|www\.lonelyplanet\.com\/Clip\.aspx\?.*|streetfire\.net\/video\/.*\.htm.*|www\.streetfire\.net\/video\/.*\.htm.*|trooptube\.tv\/videos\/.*|www\.trooptube\.tv\/videos\/.*|www\.godtube\.com\/featured\/video\/.*|godtube\.com\/featured\/video\/.*|www\.godtube\.com\/watch\/.*|godtube\.com\/watch\/.*|www\.tangle\.com\/view_video.*|mediamatters\.org\/mmtv\/.*|www\.clikthrough\.com\/theater\/video\/.*|soundcloud\.com\/.*|soundcloud\.com\/.*\/.*|soundcloud\.com\/.*\/sets\/.*|soundcloud\.com\/groups\/.*|snd\.sc\/.*|www\.last\.fm\/music\/.*|www\.last\.fm\/music\/+videos\/.*|www\.last\.fm\/music\/+images\/.*|www\.last\.fm\/music\/.*\/_\/.*|www\.last\.fm\/music\/.*\/.*|www\.mixcloud\.com\/.*\/.*\/|www\.radionomy\.com\/.*\/radio\/.*|radionomy\.com\/.*\/radio\/.*|www\.entertonement\.com\/clips\/.*|www\.rdio\.com\/#\/artist\/.*\/album\/.*|www\.rdio\.com\/artist\/.*\/album\/.*|www\.zero-inch\.com\/.*|.*\.bandcamp\.com\/|.*\.bandcamp\.com\/track\/.*|.*\.bandcamp\.com\/album\/.*|freemusicarchive\.org\/music\/.*|www\.freemusicarchive\.org\/music\/.*|freemusicarchive\.org\/curator\/.*|www\.freemusicarchive\.org\/curator\/.*|www\.npr\.org\/.*\/.*\/.*\/.*\/.*|www\.npr\.org\/.*\/.*\/.*\/.*\/.*\/.*|www\.npr\.org\/.*\/.*\/.*\/.*\/.*\/.*\/.*|www\.npr\.org\/templates\/story\/story\.php.*|huffduffer\.com\/.*\/.*|www\.audioboo\.fm\/boos\/.*|audioboo\.fm\/boos\/.*|boo\.fm\/b.*|www\.xiami\.com\/song\/.*|xiami\.com\/song\/.*|www\.saynow\.com\/playMsg\.html.*|www\.saynow\.com\/playMsg\.html.*|listen\.grooveshark\.com\/s\/.*|radioreddit\.com\/songs.*|www\.radioreddit\.com\/songs.*|radioreddit\.com\/\?q=songs.*|www\.radioreddit\.com\/\?q=songs.*|espn\.go\.com\/video\/clip.*|espn\.go\.com\/.*\/story.*|abcnews\.com\/.*\/video\/.*|abcnews\.com\/video\/playerIndex.*|washingtonpost\.com\/wp-dyn\/.*\/video\/.*\/.*\/.*\/.*|www\.washingtonpost\.com\/wp-dyn\/.*\/video\/.*\/.*\/.*\/.*|www\.boston\.com\/video.*|boston\.com\/video.*|www\.facebook\.com\/photo\.php.*|www\.facebook\.com\/video\/video\.php.*|www\.facebook\.com\/v\/.*|cnbc\.com\/id\/.*\?.*video.*|www\.cnbc\.com\/id\/.*\?.*video.*|cnbc\.com\/id\/.*\/play\/1\/video\/.*|www\.cnbc\.com\/id\/.*\/play\/1\/video\/.*|cbsnews\.com\/video\/watch\/.*|www\.google\.com\/buzz\/.*\/.*\/.*|www\.google\.com\/buzz\/.*|www\.google\.com\/profiles\/.*|google\.com\/buzz\/.*\/.*\/.*|google\.com\/buzz\/.*|google\.com\/profiles\/.*|www\.cnn\.com\/video\/.*|edition\.cnn\.com\/video\/.*|money\.cnn\.com\/video\/.*|today\.msnbc\.msn\.com\/id\/.*\/vp\/.*|www\.msnbc\.msn\.com\/id\/.*\/vp\/.*|www\.msnbc\.msn\.com\/id\/.*\/ns\/.*|today\.msnbc\.msn\.com\/id\/.*\/ns\/.*|multimedia\.foxsports\.com\/m\/video\/.*\/.*|msn\.foxsports\.com\/video.*|www\.globalpost\.com\/video\/.*|www\.globalpost\.com\/dispatch\/.*|guardian\.co\.uk\/.*\/video\/.*\/.*\/.*\/.*|www\.guardian\.co\.uk\/.*\/video\/.*\/.*\/.*\/.*|bravotv\.com\/.*\/.*\/videos\/.*|www\.bravotv\.com\/.*\/.*\/videos\/.*|video\.nationalgeographic\.com\/.*\/.*\/.*\.html|dsc\.discovery\.com\/videos\/.*|animal\.discovery\.com\/videos\/.*|health\.discovery\.com\/videos\/.*|investigation\.discovery\.com\/videos\/.*|military\.discovery\.com\/videos\/.*|planetgreen\.discovery\.com\/videos\/.*|science\.discovery\.com\/videos\/.*|tlc\.discovery\.com\/videos\/.*|.*amazon\..*\/gp\/product\/.*|.*amazon\..*\/.*\/dp\/.*|.*amazon\..*\/dp\/.*|.*amazon\..*\/o\/ASIN\/.*|.*amazon\..*\/gp\/offer-listing\/.*|.*amazon\..*\/.*\/ASIN\/.*|.*amazon\..*\/gp\/product\/images\/.*|.*amazon\..*\/gp\/aw\/d\/.*|www\.amzn\.com\/.*|amzn\.com\/.*|www\.shopstyle\.com\/browse.*|www\.shopstyle\.com\/action\/apiVisitRetailer.*|api\.shopstyle\.com\/action\/apiVisitRetailer.*|www\.shopstyle\.com\/action\/viewLook.*|gist\.github\.com\/.*|twitter\.com\/.*\/status\/.*|twitter\.com\/.*\/statuses\/.*|www\.twitter\.com\/.*\/status\/.*|www\.twitter\.com\/.*\/statuses\/.*|mobile\.twitter\.com\/.*\/status\/.*|mobile\.twitter\.com\/.*\/statuses\/.*|https:\/\/twitter\.com\/.*\/status\/.*|https:\/\/twitter\.com\/.*\/statuses\/.*|https:\/\/www\.twitter\.com\/.*\/status\/.*|https:\/\/www\.twitter\.com\/.*\/statuses\/.*|https:\/\/mobile\.twitter\.com\/.*\/status\/.*|https:\/\/mobile\.twitter\.com\/.*\/statuses\/.*|www\.crunchbase\.com\/.*\/.*|crunchbase\.com\/.*\/.*|www\.slideshare\.net\/.*\/.*|www\.slideshare\.net\/mobile\/.*\/.*|slidesha\.re\/.*|scribd\.com\/doc\/.*|www\.scribd\.com\/doc\/.*|scribd\.com\/mobile\/documents\/.*|www\.scribd\.com\/mobile\/documents\/.*|screenr\.com\/.*|polldaddy\.com\/community\/poll\/.*|polldaddy\.com\/poll\/.*|answers\.polldaddy\.com\/poll\/.*|www\.5min\.com\/Video\/.*|www\.howcast\.com\/videos\/.*|www\.screencast\.com\/.*\/media\/.*|screencast\.com\/.*\/media\/.*|www\.screencast\.com\/t\/.*|screencast\.com\/t\/.*|issuu\.com\/.*\/docs\/.*|www\.kickstarter\.com\/projects\/.*\/.*|www\.scrapblog\.com\/viewer\/viewer\.aspx.*|ping\.fm\/p\/.*|chart\.ly\/symbols\/.*|chart\.ly\/.*|maps\.google\.com\/maps\?.*|maps\.google\.com\/\?.*|maps\.google\.com\/maps\/ms\?.*|.*\.craigslist\.org\/.*\/.*|my\.opera\.com\/.*\/albums\/show\.dml\?id=.*|my\.opera\.com\/.*\/albums\/showpic\.dml\?album=.*&picture=.*|tumblr\.com\/.*|.*\.tumblr\.com\/post\/.*|www\.polleverywhere\.com\/polls\/.*|www\.polleverywhere\.com\/multiple_choice_polls\/.*|www\.polleverywhere\.com\/free_text_polls\/.*|www\.quantcast\.com\/wd:.*|www\.quantcast\.com\/.*|siteanalytics\.compete\.com\/.*|statsheet\.com\/statplot\/charts\/.*\/.*\/.*\/.*|statsheet\.com\/statplot\/charts\/e\/.*|statsheet\.com\/.*\/teams\/.*\/.*|statsheet\.com\/tools\/chartlets\?chart=.*|.*\.status\.net\/notice\/.*|identi\.ca\/notice\/.*|brainbird\.net\/notice\/.*|shitmydadsays\.com\/notice\/.*|www\.studivz\.net\/Profile\/.*|www\.studivz\.net\/l\/.*|www\.studivz\.net\/Groups\/Overview\/.*|www\.studivz\.net\/Gadgets\/Info\/.*|www\.studivz\.net\/Gadgets\/Install\/.*|www\.studivz\.net\/.*|www\.meinvz\.net\/Profile\/.*|www\.meinvz\.net\/l\/.*|www\.meinvz\.net\/Groups\/Overview\/.*|www\.meinvz\.net\/Gadgets\/Info\/.*|www\.meinvz\.net\/Gadgets\/Install\/.*|www\.meinvz\.net\/.*|www\.schuelervz\.net\/Profile\/.*|www\.schuelervz\.net\/l\/.*|www\.schuelervz\.net\/Groups\/Overview\/.*|www\.schuelervz\.net\/Gadgets\/Info\/.*|www\.schuelervz\.net\/Gadgets\/Install\/.*|www\.schuelervz\.net\/.*|myloc\.me\/.*|pastebin\.com\/.*|pastie\.org\/.*|www\.pastie\.org\/.*|redux\.com\/stream\/item\/.*\/.*|redux\.com\/f\/.*\/.*|www\.redux\.com\/stream\/item\/.*\/.*|www\.redux\.com\/f\/.*\/.*|cl\.ly\/.*|cl\.ly\/.*\/content|speakerdeck\.com\/u\/.*\/p\/.*|www\.kiva\.org\/lend\/.*|www\.timetoast\.com\/timelines\/.*|storify\.com\/.*\/.*|.*meetup\.com\/.*|meetu\.ps\/.*|www\.dailymile\.com\/people\/.*\/entries\/.*|.*\.kinomap\.com\/.*|www\.metacdn\.com\/api\/users\/.*\/content\/.*|www\.metacdn\.com\/api\/users\/.*\/media\/.*|prezi\.com\/.*\/.*|.*\.uservoice\.com\/.*\/suggestions\/.*|formspring\.me\/.*|www\.formspring\.me\/.*|formspring\.me\/.*\/q\/.*|www\.formspring\.me\/.*\/q\/.*|twitlonger\.com\/show\/.*|www\.twitlonger\.com\/show\/.*|tl\.gd\/.*|www\.qwiki\.com\/q\/.*|crocodoc\.com\/.*|.*\.crocodoc\.com\/.*|https:\/\/crocodoc\.com\/.*|https:\/\/.*\.crocodoc\.com\/.*)/i);return ret&&nm._delFilter("iframe"),ret},init:function(nm){nm.loadFilter="embedly",nm.store.embedly={}},load:function(nm){$.ajax({url:"http://api.embed.ly/1/oembed",dataType:"jsonp",data:"wmode=transparent&url="+nm.opener.attr("href"),success:function(data){"error"==data.type?nm._error():"photo"==data.type?(nm.filters.push("image"),$("<img />").load(function(){nm.elts.cont.addClass("nyroModalImg"),nm.elts.hidden.addClass("nyroModalImg"),nm._setCont(this)}).error(function(){nm._error()}).attr("src",data.url)):(nm.store.embedly.w=data.width,nm.store.embedly.h=data.height,nm._setCont("<div>"+data.html+"</div>"))}})},size:function(nm){nm.store.embedly.w&&!nm.sizes.h&&(nm.sizes.w=nm.store.embedly.w,nm.sizes.h=nm.store.embedly.h)}}})});
//# sourceMappingURL=jsSourceMapExtendedSrc.map